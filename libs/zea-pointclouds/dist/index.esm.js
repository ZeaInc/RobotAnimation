import{Box3 as l,Points as t,RGBA as i,Vec3 as c,AssetItem as d,NumberParameter as e,Registry as s,GLPass as n,GLPoints as F,GLShader as U,shaderLibrary as X,GLTexture2D as Q,Frustum as R}from"@zeainc/zea-engine";const x={POSITION_CARTESIAN:0,COLOR_PACKED:1,COLOR_FLOATS_1:2,COLOR_FLOATS_255:3,NORMAL_FLOATS:4,FILLER:5,INTENSITY:6,CLASSIFICATION:7,NORMAL_SPHEREMAPPED:8,NORMAL_OCT16:9,NORMAL:10,RETURN_NUMBER:11,NUMBER_OF_RETURNS:12,SOURCE_ID:13,INDICES:14,SPACING:15,GPS_TIME:16},V={DATA_TYPE_DOUBLE:{ordinal:0,size:8},DATA_TYPE_FLOAT:{ordinal:1,size:4},DATA_TYPE_INT8:{ordinal:2,size:1},DATA_TYPE_UINT8:{ordinal:3,size:1},DATA_TYPE_INT16:{ordinal:4,size:2},DATA_TYPE_UINT16:{ordinal:5,size:2},DATA_TYPE_INT32:{ordinal:6,size:4},DATA_TYPE_UINT32:{ordinal:7,size:4},DATA_TYPE_INT64:{ordinal:8,size:8},DATA_TYPE_UINT64:{ordinal:9,size:8}};let B=0;for(let l in V)V[B]=V[l],B++;class o{constructor(l,t,i){this.name=l,this.type=t,this.numElements=i,this.byteSize=this.numElements*this.type.size}}o.POSITION_CARTESIAN=new o(x.POSITION_CARTESIAN,V.DATA_TYPE_FLOAT,3),o.RGBA_PACKED=new o(x.COLOR_PACKED,V.DATA_TYPE_INT8,4),o.COLOR_PACKED=o.RGBA_PACKED,o.RGB_PACKED=new o(x.COLOR_PACKED,V.DATA_TYPE_INT8,3),o.NORMAL_FLOATS=new o(x.NORMAL_FLOATS,V.DATA_TYPE_FLOAT,3),o.FILLER_1B=new o(x.FILLER,V.DATA_TYPE_UINT8,1),o.INTENSITY=new o(x.INTENSITY,V.DATA_TYPE_UINT16,1),o.CLASSIFICATION=new o(x.CLASSIFICATION,V.DATA_TYPE_UINT8,1),o.NORMAL_SPHEREMAPPED=new o(x.NORMAL_SPHEREMAPPED,V.DATA_TYPE_UINT8,2),o.NORMAL_OCT16=new o(x.NORMAL_OCT16,V.DATA_TYPE_UINT8,2),o.NORMAL=new o(x.NORMAL,V.DATA_TYPE_FLOAT,3),o.RETURN_NUMBER=new o(x.RETURN_NUMBER,V.DATA_TYPE_UINT8,1),o.NUMBER_OF_RETURNS=new o(x.NUMBER_OF_RETURNS,V.DATA_TYPE_UINT8,1),o.SOURCE_ID=new o(x.SOURCE_ID,V.DATA_TYPE_UINT16,1),o.INDICES=new o(x.INDICES,V.DATA_TYPE_UINT32,1),o.SPACING=new o(x.SPACING,V.DATA_TYPE_FLOAT,1),o.GPS_TIME=new o(x.GPS_TIME,V.DATA_TYPE_DOUBLE,1);class a{constructor(l){if(this.attributes=[],this.byteSize=0,this.size=0,null!=l)for(let t=0;t<l.length;t++){let i=l[t],c=o[i];this.attributes.push(c),this.byteSize+=c.byteSize,this.size++}}add(l){this.attributes.push(l),this.byteSize+=l.byteSize,this.size++}hasColors(){for(let l in this.attributes){if(this.attributes[l].name===x.COLOR_PACKED)return!0}return!1}hasNormals(){for(let l in this.attributes){let t=this.attributes[l];if(t===o.NORMAL_SPHEREMAPPED||t===o.NORMAL_FLOATS||t===o.NORMAL||t===o.NORMAL_OCT16)return!0}return!1}}const u={config:{withCredentials:!1,customHeaders:[{header:null,value:null}]},createXMLHttpRequest:function(){let l=new XMLHttpRequest;if(this.config.customHeaders&&Array.isArray(this.config.customHeaders)&&this.config.customHeaders.length>0){let t=l.open,i=this.config.customHeaders;l.open=function(){t.apply(this,[].slice.call(arguments)),i.forEach((function(t){t.header&&t.value&&l.setRequestHeader(t.header,t.value)}))}}return l}};class b{static createWorker(l){let t=new Blob([l],{type:"application/javascript"});return new Worker(URL.createObjectURL(t))}static createChildAABB(t,i){let c=t.min.clone(),d=t.max.clone(),e=d.subtract(c);return(1&i)>0?c.z+=e.z/2:d.z-=e.z/2,(2&i)>0?c.y+=e.y/2:d.y-=e.y/2,(4&i)>0?c.x+=e.x/2:d.x-=e.x/2,new l(c,d)}}class r{constructor(){this.url=null,this.octreeDir=null,this.spacing=0,this.boundingBox=null,this.root=null,this.nodes=null,this.pointAttributes=null,this.hierarchyStepSize=-1,this.loader=null}}class H extends class extends class{constructor(){this._listeners={}}addEventListener(l,t){const i=this._listeners;void 0===i[l]&&(i[l]=[]),-1===i[l].indexOf(t)&&i[l].push(t)}hasEventListener(l,t){const i=this._listeners;return void 0!==i[l]&&-1!==i[l].indexOf(t)}removeEventListener(l,t){let i=this._listeners[l];if(void 0!==i){let l=i.indexOf(t);-1!==l&&i.splice(l,1)}}removeEventListeners(l){void 0!==this._listeners[l]&&delete this._listeners[l]}dispatchEvent(l){let t=this._listeners[l.type];if(void 0!==t){l.target=this;for(let i of t.slice(0))i.call(this,l)}}}{constructor(){super()}getChildren(){throw new Error("override function")}getBoundingBox(){throw new Error("override function")}isLoaded(){throw new Error("override function")}isGeometryNode(){throw new Error("override function")}isTreeNode(){throw new Error("override function")}getLevel(){throw new Error("override function")}getBoundingSphere(){throw new Error("override function")}}{constructor(l,t,i){super(),this.id=H.IDCount++,this.name=l,this.index=parseInt(l.charAt(l.length-1)),this.pcoGeometry=t,this.geometry=null,this.boundingBox=i,this.boundingSphere=i.getBoundingSphere(),this.children={},this.numPoints=0,this.level=null,this.loaded=!1,this.oneTimeDisposeHandlers=[],this.offset=this.boundingBox.min.clone()}getLevel(){return this.level}isLoaded(){return this.loaded}getBoundingSphere(){return this.boundingSphere}getBoundingBox(){return this.boundingBox}getChildren(){let l=[];for(let t=0;t<8;t++)this.children[t]&&l.push(this.children[t]);return l}getURL(){let l="",t=this.pcoGeometry.loader.version;return t.equalOrHigher("1.5")?l=this.pcoGeometry.octreeDir+"/"+this.getHierarchyPath()+"/"+this.name:(t.equalOrHigher("1.4")||t.upTo("1.3"))&&(l=this.pcoGeometry.octreeDir+"/"+this.name),l}getHierarchyPath(){let l="r/",t=this.pcoGeometry.hierarchyStepSize,i=this.name.substr(1),c=Math.floor(i.length/t);for(let d=0;d<c;d++)l+=i.substr(d*t,t)+"/";return l=l.slice(0,-1),l}addChild(l){this.children[l.index]=l,l.parent=this}shouldLoad(){return!0!==this.loading&&!0!==this.loaded}load(){return this.loading=!0,this.loadPromise||(this.loadPromise=new Promise((l,t)=>{this.pcoGeometry.loader.version.equalOrHigher("1.5")&&this.level%this.pcoGeometry.hierarchyStepSize==0&&this.hasChildren?this.loadHierachyThenPoints().then(l):this.loadPoints().then(l)})),this.loadPromise}loadPoints(){return this.pcoGeometry.loader.load(this)}parse(d,e){const s=d.attributeBuffers,n=new t;for(let l in s){const t=s[l].buffer,c=parseInt(l);if(c===x.POSITION_CARTESIAN){const l=n.getVertexAttribute("positions");l.data=new Float32Array(t),n.setNumVertices(l.getCount())}else if(c===x.COLOR_PACKED)n.addVertexAttribute("colors",i,new Uint8Array(t));else if(c===x.INDICES);else{let l;for(let t in x)if(x[t]==c){l=t;break}console.warn("Unandled Point Attribute:",l)}}this.points=n;const F=new l(new c(...d.tightBoundingBox.min),new c(...d.tightBoundingBox.max));F.max.subtract(F.min),F.min.set(0,0,0);let U=this.pcoGeometry.pointAttributes;const X=d.buffer.byteLength/U.byteSize;this.numPoints=X,this.mean=new c(...d.mean),this.tightBoundingBox=F,this.loaded=!0,this.loading=!1,this.estimatedSpacing=d.estimatedSpacing,this.dispatchEvent("loaded",{numPoints:X})}loadHierachyThenPoints(){return new Promise((l,t)=>{let i=this;if(i.level%i.pcoGeometry.hierarchyStepSize==0){let c=i.pcoGeometry.octreeDir+"/"+i.getHierarchyPath()+"/"+i.name+".hrc",d=u.createXMLHttpRequest();d.open("GET",c,!0),d.responseType="arraybuffer",d.overrideMimeType("text/plain; charset=x-user-defined"),d.onreadystatechange=()=>{if(4===d.readyState)if(200===d.status||0===d.status){let t=d.response;!function(t,i){let c=new DataView(i),d=[],e=c.getUint8(0),s=c.getUint32(1,!0);t.numPoints=s,d.push({children:e,numPoints:s,name:t.name});let n=[],F=5;for(;d.length>0;){let l=d.shift(),t=1;for(let i=0;i<8;i++){if(0!=(l.children&t)){let t=l.name+i,e=c.getUint8(F),s=c.getUint32(F+1,!0);d.push({children:e,numPoints:s,name:t}),n.push({children:e,numPoints:s,name:t}),F+=5}t*=2}if(F===i.byteLength)break}let U={};U[t.name]=t;let X=t.pcoGeometry;for(let l=0;l<n.length;l++){let t=n[l].name,i=n[l].numPoints,c=parseInt(t.charAt(t.length-1)),d=U[t.substring(0,t.length-1)],e=t.length-1,s=b.createChildAABB(d.boundingBox,c),F=new H(t,X,s);F.level=e,F.numPoints=i,F.hasChildren=n[l].children>0,F.spacing=X.spacing/Math.pow(2,e),d.addChild(F),U[t]=F}t.loadPoints().then(()=>{l()})}(i,t)}else{const l="Failed to load file! HTTP status: "+d.status+", file: "+c;console.log(l),t(l)}};try{d.send(null)}catch(l){console.log("fehler beim laden der punktwolke: "+l),t("fehler beim laden der punktwolke: "+l)}}})}getNumPoints(){return this.numPoints}dispose(){if(this.geometry&&null!=this.parent){this.geometry.dispose(),this.geometry=null,this.loaded=!1,this.loadPromise=null;for(let l=0;l<this.oneTimeDisposeHandlers.length;l++){(0,this.oneTimeDisposeHandlers[l])()}this.oneTimeDisposeHandlers=[]}}}H.IDCount=0;class m{constructor(l){this.version=l;let t=-1===l.indexOf(".")?l.length:l.indexOf(".");this.versionMajor=parseInt(l.substr(0,t)),this.versionMinor=parseInt(l.substr(t+1)),0===this.versionMinor.length&&(this.versionMinor=0)}newerThan(l){let t=new m(l);return this.versionMajor>t.versionMajor||this.versionMajor===t.versionMajor&&this.versionMinor>t.versionMinor}equalOrHigher(l){let t=new m(l);return this.versionMajor>t.versionMajor||this.versionMajor===t.versionMajor&&this.versionMinor>=t.versionMinor}upTo(l){return!this.newerThan(l)}}class Z{constructor(l){this.version="string"==typeof l?new m(l):l}static progressCB(){}load(l){if(l.loaded)return;let t=l.pcoGeometry.pointAttributes,i=l.getURL();this.version.equalOrHigher("1.4")&&(i+="."+t.toLowerCase());let c=u.createXMLHttpRequest();c.open("GET",i,!0),c.responseType="arraybuffer",c.overrideMimeType("text/plain; charset=x-user-defined"),c.onreadystatechange=()=>{if(4===c.readyState)if(200===c.status||0===c.status){let t=c.response;this.parse(l,t)}else console.log("Failed to load file! HTTP status: "+c.status+", file: "+i)},c.send(null)}parse(l,t){let i=new LASFile(t),c=new h(l);i.open().then(l=>(i.isOpen=!0,i)).catch(l=>{console.log("failed to open file. :(")}).then(l=>l.getHeader().then((function(t){return[l,t]}))).then(l=>{let t=l[0],i=l[1],d=0,e=i.pointsCount,s=function(){return t.readData(1e6,0,1).then((function(l){return c.push(new LASDecoder(l.buffer,i.pointsFormatId,i.pointsStructSize,l.count,i.scale,i.offset,i.mins,i.maxs)),d+=l.count,Z.progressCB(d/e),l.hasMoreData?s():(i.totalRead=d,i.versionAsString=t.versionAsString,i.isCompressed=t.isCompressed,[t,i,c])}))};return s()}).then(l=>{let t=l[0];return Z.progressCB(1),t.close().then((function(){return t.isOpen=!1,l.slice(1)})).catch(l=>{if(t.isOpen)return t.close().then((function(){throw t.isOpen=!1,l}));throw l})})}handle(l,t){}}class h{constructor(l){this.node=l}push(l){let t=Potree.scriptPath+"/workers/LASDecoderWorker.js",i=Potree.workerPool.getWorker(t);this.node;i.onmessage=c=>{let d=new THREE.BufferGeometry,e=l.pointsCount,s=new Float32Array(c.data.position),n=new Uint8Array(c.data.color),F=new Float32Array(c.data.intensity),U=new Uint8Array(c.data.classification),X=new Uint8Array(c.data.returnNumber),Q=new Uint8Array(c.data.numberOfReturns),R=new Uint16Array(c.data.pointSourceID),x=new Uint8Array(c.data.indices);d.addAttribute("position",new THREE.BufferAttribute(s,3)),d.addAttribute("color",new THREE.BufferAttribute(n,4,!0)),d.addAttribute("intensity",new THREE.BufferAttribute(F,1)),d.addAttribute("classification",new THREE.BufferAttribute(U,1)),d.addAttribute("returnNumber",new THREE.BufferAttribute(X,1)),d.addAttribute("numberOfReturns",new THREE.BufferAttribute(Q,1)),d.addAttribute("pointSourceID",new THREE.BufferAttribute(R,1)),d.addAttribute("indices",new THREE.BufferAttribute(x,4)),d.attributes.indices.normalized=!0;let V=new THREE.Box3((new THREE.Vector3).fromArray(c.data.tightBoundingBox.min),(new THREE.Vector3).fromArray(c.data.tightBoundingBox.max));d.boundingBox=this.node.boundingBox,this.node.tightBoundingBox=V,this.node.geometry=d,this.node.numPoints=e,this.node.loaded=!0,this.node.loading=!1,Potree.numNodesLoading--,this.node.mean=new THREE.Vector3(...c.data.mean),Potree.workerPool.returnWorker(t,i)};let c={buffer:l.arrayb,numPoints:l.pointsCount,pointSize:l.pointSize,pointFormatID:2,scale:l.scale,offset:l.offset,mins:l.mins,maxs:l.maxs};i.postMessage(c,[c.buffer])}}const G=new class{constructor(){this.workers={}}getWorker(l){if(this.workers[l]||(this.workers[l]=[]),0===this.workers[l].length){let t=new l;this.workers[l].push(t)}return this.workers[l].pop()}returnWorker(l,t){this.workers[l].push(t)}};var S=null;try{var y="undefined"!=typeof module&&"function"==typeof module.require&&module.require("worker_threads")||"function"==typeof __non_webpack_require__&&__non_webpack_require__("worker_threads")||"function"==typeof require&&require("worker_threads");S=y.Worker}catch(l){}function E(l,t,i){var c=void 0===t?null:t,d=function(l,t){return Buffer.from(l,"base64").toString(t?"utf16":"utf8")}(l,void 0!==i&&i),e=d.indexOf("\n",10)+1,s=d.substring(e)+(c?"//# sourceMappingURL="+c:"");return function(l){return new S(s,Object.assign({},l,{eval:!0}))}}function g(l,t,i){var c=void 0===t?null:t,d=function(l,t){var i=atob(l);if(t){for(var c=new Uint8Array(i.length),d=0,e=i.length;d<e;++d)c[d]=i.charCodeAt(d);return String.fromCharCode.apply(null,new Uint16Array(c.buffer))}return i}(l,void 0!==i&&i),e=d.indexOf("\n",10)+1,s=d.substring(e)+(c?"//# sourceMappingURL="+c:""),n=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(n)}var L="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);var I,J,p,W=(I="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpjbGFzcyBle2NvbnN0cnVjdG9yKGUpe3RoaXMudmVyc2lvbj1lO2xldCB0PS0xPT09ZS5pbmRleE9mKCIuIik/ZS5sZW5ndGg6ZS5pbmRleE9mKCIuIik7dGhpcy52ZXJzaW9uTWFqb3I9cGFyc2VJbnQoZS5zdWJzdHIoMCx0KSksdGhpcy52ZXJzaW9uTWlub3I9cGFyc2VJbnQoZS5zdWJzdHIodCsxKSksMD09PXRoaXMudmVyc2lvbk1pbm9yLmxlbmd0aCYmKHRoaXMudmVyc2lvbk1pbm9yPTApfW5ld2VyVGhhbih0KXtsZXQgcj1uZXcgZSh0KTtyZXR1cm4gdGhpcy52ZXJzaW9uTWFqb3I+ci52ZXJzaW9uTWFqb3J8fHRoaXMudmVyc2lvbk1ham9yPT09ci52ZXJzaW9uTWFqb3ImJnRoaXMudmVyc2lvbk1pbm9yPnIudmVyc2lvbk1pbm9yfWVxdWFsT3JIaWdoZXIodCl7bGV0IHI9bmV3IGUodCk7cmV0dXJuIHRoaXMudmVyc2lvbk1ham9yPnIudmVyc2lvbk1ham9yfHx0aGlzLnZlcnNpb25NYWpvcj09PXIudmVyc2lvbk1ham9yJiZ0aGlzLnZlcnNpb25NaW5vcj49ci52ZXJzaW9uTWlub3J9dXBUbyhlKXtyZXR1cm4hdGhpcy5uZXdlclRoYW4oZSl9fWNvbnN0IHQ9MCxyPTEsbj00LGk9NSxhPTYscz03LEE9OCxmPTksVD0xMCxvPTExLHU9MTIsbD0xMyxfPTE0LEk9MTUsYj0xNixFPXtEQVRBX1RZUEVfRE9VQkxFOntvcmRpbmFsOjAsc2l6ZTo4fSxEQVRBX1RZUEVfRkxPQVQ6e29yZGluYWw6MSxzaXplOjR9LERBVEFfVFlQRV9JTlQ4OntvcmRpbmFsOjIsc2l6ZToxfSxEQVRBX1RZUEVfVUlOVDg6e29yZGluYWw6MyxzaXplOjF9LERBVEFfVFlQRV9JTlQxNjp7b3JkaW5hbDo0LHNpemU6Mn0sREFUQV9UWVBFX1VJTlQxNjp7b3JkaW5hbDo1LHNpemU6Mn0sREFUQV9UWVBFX0lOVDMyOntvcmRpbmFsOjYsc2l6ZTo0fSxEQVRBX1RZUEVfVUlOVDMyOntvcmRpbmFsOjcsc2l6ZTo0fSxEQVRBX1RZUEVfSU5UNjQ6e29yZGluYWw6OCxzaXplOjh9LERBVEFfVFlQRV9VSU5UNjQ6e29yZGluYWw6OSxzaXplOjh9fTtsZXQgaD0wO2ZvcihsZXQgZSBpbiBFKUVbaF09RVtlXSxoKys7Y2xhc3MgTntjb25zdHJ1Y3RvcihlLHQscil7dGhpcy5uYW1lPWUsdGhpcy50eXBlPXQsdGhpcy5udW1FbGVtZW50cz1yLHRoaXMuYnl0ZVNpemU9dGhpcy5udW1FbGVtZW50cyp0aGlzLnR5cGUuc2l6ZX19ZnVuY3Rpb24gbShlKXt0aGlzLmJ1ZmZlcj1lLHRoaXMudTg9bmV3IFVpbnQ4QXJyYXkoZSk7bGV0IHQ9bmV3IEFycmF5QnVmZmVyKDgpLHI9bmV3IEZsb2F0MzJBcnJheSh0KSxuPW5ldyBGbG9hdDY0QXJyYXkodCksaT1uZXcgVWludDhBcnJheSh0KTt0aGlzLmdldFVpbnQzMj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy51OFtlKzNdPDwyNHx0aGlzLnU4W2UrMl08PDE2fHRoaXMudThbZSsxXTw8OHx0aGlzLnU4W2VdfSx0aGlzLmdldFVpbnQxNj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy51OFtlKzFdPDw4fHRoaXMudThbZV19LHRoaXMuZ2V0RmxvYXQzMj1mdW5jdGlvbihlKXtyZXR1cm4gaVswXT10aGlzLnU4W2UrMF0saVsxXT10aGlzLnU4W2UrMV0saVsyXT10aGlzLnU4W2UrMl0saVszXT10aGlzLnU4W2UrM10sclswXX0sdGhpcy5nZXRGbG9hdDY0PWZ1bmN0aW9uKGUpe3JldHVybiBpWzBdPXRoaXMudThbZSswXSxpWzFdPXRoaXMudThbZSsxXSxpWzJdPXRoaXMudThbZSsyXSxpWzNdPXRoaXMudThbZSszXSxpWzRdPXRoaXMudThbZSs0XSxpWzVdPXRoaXMudThbZSs1XSxpWzZdPXRoaXMudThbZSs2XSxpWzddPXRoaXMudThbZSs3XSxuWzBdfSx0aGlzLmdldFVpbnQ4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnU4W2VdfX1OLlBPU0lUSU9OX0NBUlRFU0lBTj1uZXcgTih0LEUuREFUQV9UWVBFX0ZMT0FULDMpLE4uUkdCQV9QQUNLRUQ9bmV3IE4ocixFLkRBVEFfVFlQRV9JTlQ4LDQpLE4uQ09MT1JfUEFDS0VEPU4uUkdCQV9QQUNLRUQsTi5SR0JfUEFDS0VEPW5ldyBOKHIsRS5EQVRBX1RZUEVfSU5UOCwzKSxOLk5PUk1BTF9GTE9BVFM9bmV3IE4obixFLkRBVEFfVFlQRV9GTE9BVCwzKSxOLkZJTExFUl8xQj1uZXcgTihpLEUuREFUQV9UWVBFX1VJTlQ4LDEpLE4uSU5URU5TSVRZPW5ldyBOKGEsRS5EQVRBX1RZUEVfVUlOVDE2LDEpLE4uQ0xBU1NJRklDQVRJT049bmV3IE4ocyxFLkRBVEFfVFlQRV9VSU5UOCwxKSxOLk5PUk1BTF9TUEhFUkVNQVBQRUQ9bmV3IE4oQSxFLkRBVEFfVFlQRV9VSU5UOCwyKSxOLk5PUk1BTF9PQ1QxNj1uZXcgTihmLEUuREFUQV9UWVBFX1VJTlQ4LDIpLE4uTk9STUFMPW5ldyBOKFQsRS5EQVRBX1RZUEVfRkxPQVQsMyksTi5SRVRVUk5fTlVNQkVSPW5ldyBOKG8sRS5EQVRBX1RZUEVfVUlOVDgsMSksTi5OVU1CRVJfT0ZfUkVUVVJOUz1uZXcgTih1LEUuREFUQV9UWVBFX1VJTlQ4LDEpLE4uU09VUkNFX0lEPW5ldyBOKGwsRS5EQVRBX1RZUEVfVUlOVDE2LDEpLE4uSU5ESUNFUz1uZXcgTihfLEUuREFUQV9UWVBFX1VJTlQzMiwxKSxOLlNQQUNJTkc9bmV3IE4oSSxFLkRBVEFfVFlQRV9GTE9BVCwxKSxOLkdQU19USU1FPW5ldyBOKGIsRS5EQVRBX1RZUEVfRE9VQkxFLDEpLG9ubWVzc2FnZT1mdW5jdGlvbih0KXtwZXJmb3JtYW5jZS5tYXJrKCJiaW5hcnktZGVjb2Rlci1zdGFydCIpO2xldCByPXQuZGF0YS5idWZmZXIsbj10LmRhdGEucG9pbnRBdHRyaWJ1dGVzLGk9ci5ieXRlTGVuZ3RoL24uYnl0ZVNpemUsYT1uZXcgbShyKSxzPW5ldyBlKHQuZGF0YS52ZXJzaW9uKSxBPXQuZGF0YS5vZmZzZXQsZj10LmRhdGEuc2NhbGUsVD0odC5kYXRhLnNwYWNpbmcsdC5kYXRhLmhhc0NoaWxkcmVuLHQuZGF0YS5uYW1lLFtOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLE51bWJlci5QT1NJVElWRV9JTkZJTklUWV0pLG89W051bWJlci5ORUdBVElWRV9JTkZJTklUWSxOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZXSx1PVswLDAsMF0sbD17fSxfPTA7Zm9yKGxldCBlIG9mIG4uYXR0cmlidXRlcyl7aWYoZS5uYW1lPT09Ti5QT1NJVElPTl9DQVJURVNJQU4ubmFtZSl7bGV0IHQ9bmV3IEFycmF5QnVmZmVyKDQqaSozKSxyPW5ldyBGbG9hdDMyQXJyYXkodCk7Zm9yKGxldCBlPTA7ZTxpO2UrKyl7bGV0IHQsbCxJO3MubmV3ZXJUaGFuKCIxLjMiKT8odD1hLmdldFVpbnQzMihfK2Uqbi5ieXRlU2l6ZSswLCEwKSpmLGw9YS5nZXRVaW50MzIoXytlKm4uYnl0ZVNpemUrNCwhMCkqZixJPWEuZ2V0VWludDMyKF8rZSpuLmJ5dGVTaXplKzgsITApKmYpOih0PWEuZ2V0RmxvYXQzMihlKm4uYnl0ZVNpemUrMCwhMCkrQVswXSxsPWEuZ2V0RmxvYXQzMihlKm4uYnl0ZVNpemUrNCwhMCkrQVsxXSxJPWEuZ2V0RmxvYXQzMihlKm4uYnl0ZVNpemUrOCwhMCkrQVsyXSksclszKmUrMF09dCxyWzMqZSsxXT1sLHJbMyplKzJdPUksdVswXSs9dC9pLHVbMV0rPWwvaSx1WzJdKz1JL2ksVFswXT1NYXRoLm1pbihUWzBdLHQpLFRbMV09TWF0aC5taW4oVFsxXSxsKSxUWzJdPU1hdGgubWluKFRbMl0sSSksb1swXT1NYXRoLm1heChvWzBdLHQpLG9bMV09TWF0aC5tYXgob1sxXSxsKSxvWzJdPU1hdGgubWF4KG9bMl0sSSl9bFtlLm5hbWVdPXtidWZmZXI6dCxhdHRyaWJ1dGU6ZX19ZWxzZSBpZihlLm5hbWU9PT1OLkNPTE9SX1BBQ0tFRC5uYW1lKXtsZXQgdD1uZXcgQXJyYXlCdWZmZXIoNCppKSxyPW5ldyBVaW50OEFycmF5KHQpO2ZvcihsZXQgZT0wO2U8aTtlKyspcls0KmUrMF09YS5nZXRVaW50OChfK2Uqbi5ieXRlU2l6ZSswKSxyWzQqZSsxXT1hLmdldFVpbnQ4KF8rZSpuLmJ5dGVTaXplKzEpLHJbNCplKzJdPWEuZ2V0VWludDgoXytlKm4uYnl0ZVNpemUrMik7bFtlLm5hbWVdPXtidWZmZXI6dCxhdHRyaWJ1dGU6ZX19ZWxzZSBpZihlLm5hbWU9PT1OLklOVEVOU0lUWS5uYW1lKXtsZXQgdD1uZXcgQXJyYXlCdWZmZXIoNCppKSxyPW5ldyBGbG9hdDMyQXJyYXkodCk7Zm9yKGxldCBlPTA7ZTxpO2UrKyl7bGV0IHQ9YS5nZXRVaW50MTYoXytlKm4uYnl0ZVNpemUsITApO3JbZV09dH1sW2UubmFtZV09e2J1ZmZlcjp0LGF0dHJpYnV0ZTplfX1lbHNlIGlmKGUubmFtZT09PU4uQ0xBU1NJRklDQVRJT04ubmFtZSl7bGV0IHQ9bmV3IEFycmF5QnVmZmVyKGkpLHI9bmV3IFVpbnQ4QXJyYXkodCk7Zm9yKGxldCBlPTA7ZTxpO2UrKyl7bGV0IHQ9YS5nZXRVaW50OChfK2Uqbi5ieXRlU2l6ZSk7cltlXT10fWxbZS5uYW1lXT17YnVmZmVyOnQsYXR0cmlidXRlOmV9fWVsc2UgaWYoZS5uYW1lPT09Ti5SRVRVUk5fTlVNQkVSLm5hbWUpe2xldCB0PW5ldyBBcnJheUJ1ZmZlcihpKSxyPW5ldyBVaW50OEFycmF5KHQpO2ZvcihsZXQgZT0wO2U8aTtlKyspe2xldCB0PWEuZ2V0VWludDgoXytlKm4uYnl0ZVNpemUpO3JbZV09dH1sW2UubmFtZV09e2J1ZmZlcjp0LGF0dHJpYnV0ZTplfX1lbHNlIGlmKGUubmFtZT09PU4uTlVNQkVSX09GX1JFVFVSTlMubmFtZSl7bGV0IHQ9bmV3IEFycmF5QnVmZmVyKGkpLHI9bmV3IFVpbnQ4QXJyYXkodCk7Zm9yKGxldCBlPTA7ZTxpO2UrKyl7bGV0IHQ9YS5nZXRVaW50OChfK2Uqbi5ieXRlU2l6ZSk7cltlXT10fWxbZS5uYW1lXT17YnVmZmVyOnQsYXR0cmlidXRlOmV9fWVsc2UgaWYoZS5uYW1lPT09Ti5TT1VSQ0VfSUQubmFtZSl7bGV0IHQ9bmV3IEFycmF5QnVmZmVyKDIqaSkscj1uZXcgVWludDE2QXJyYXkodCk7Zm9yKGxldCBlPTA7ZTxpO2UrKyl7bGV0IHQ9YS5nZXRVaW50MTYoXytlKm4uYnl0ZVNpemUpO3JbZV09dH1sW2UubmFtZV09e2J1ZmZlcjp0LGF0dHJpYnV0ZTplfX1lbHNlIGlmKGUubmFtZT09PU4uTk9STUFMX1NQSEVSRU1BUFBFRC5uYW1lKXtsZXQgdD1uZXcgQXJyYXlCdWZmZXIoNCppKjMpLHI9bmV3IEZsb2F0MzJBcnJheSh0KTtmb3IobGV0IGU9MDtlPGk7ZSsrKXtsZXQgdD0yKihhLmdldFVpbnQ4KF8rZSpuLmJ5dGVTaXplKzApLzI1NSktMSxpPTIqKGEuZ2V0VWludDgoXytlKm4uYnl0ZVNpemUrMSkvMjU1KS0xLHM9MSxBPXQqLXQraSotaStzKi0gLTE7cz1BLHQqPU1hdGguc3FydChBKSxpKj1NYXRoLnNxcnQoQSksdCo9MixpKj0yLHM9MipzLTEsclszKmUrMF09dCxyWzMqZSsxXT1pLHJbMyplKzJdPXN9bFtlLm5hbWVdPXtidWZmZXI6dCxhdHRyaWJ1dGU6ZX19ZWxzZSBpZihlLm5hbWU9PT1OLk5PUk1BTF9PQ1QxNi5uYW1lKXtsZXQgdD1uZXcgQXJyYXlCdWZmZXIoNCppKjMpLHI9bmV3IEZsb2F0MzJBcnJheSh0KTtmb3IobGV0IGU9MDtlPGk7ZSsrKXtsZXQgdD1hLmdldFVpbnQ4KF8rZSpuLmJ5dGVTaXplKzApLzI1NSoyLTEsaT1hLmdldFVpbnQ4KF8rZSpuLmJ5dGVTaXplKzEpLzI1NSoyLTEscz0xLU1hdGguYWJzKHQpLU1hdGguYWJzKGkpLEE9MCxmPTA7cz49MD8oQT10LGY9aSk6KEE9LShpL01hdGguc2lnbihpKS0xKS9NYXRoLnNpZ24odCksZj0tKHQvTWF0aC5zaWduKHQpLTEpL01hdGguc2lnbihpKSk7bGV0IFQ9TWF0aC5zcXJ0KEEqQStmKmYrcypzKTtBLz1ULGYvPVQscy89VCxyWzMqZSswXT1BLHJbMyplKzFdPWYsclszKmUrMl09c31sW2UubmFtZV09e2J1ZmZlcjp0LGF0dHJpYnV0ZTplfX1lbHNlIGlmKGUubmFtZT09PU4uTk9STUFMLm5hbWUpe2xldCB0PW5ldyBBcnJheUJ1ZmZlcig0KmkqMykscj1uZXcgRmxvYXQzMkFycmF5KHQpO2ZvcihsZXQgZT0wO2U8aTtlKyspe2xldCB0PWEuZ2V0RmxvYXQzMihfK2Uqbi5ieXRlU2l6ZSswLCEwKSxpPWEuZ2V0RmxvYXQzMihfK2Uqbi5ieXRlU2l6ZSs0LCEwKSxzPWEuZ2V0RmxvYXQzMihfK2Uqbi5ieXRlU2l6ZSs4LCEwKTtyWzMqZSswXT10LHJbMyplKzFdPWksclszKmUrMl09c31sW2UubmFtZV09e2J1ZmZlcjp0LGF0dHJpYnV0ZTplfX1lbHNlIGlmKGUubmFtZT09PU4uR1BTX1RJTUUubmFtZSl7bGV0IHQ9bmV3IEFycmF5QnVmZmVyKDgqaSkscj1uZXcgRmxvYXQ2NEFycmF5KHQpO2ZvcihsZXQgZT0wO2U8aTtlKyspe2xldCB0PWEuZ2V0RmxvYXQ2NChfK2Uqbi5ieXRlU2l6ZSwhMCk7cltlXT10fWxbZS5uYW1lXT17YnVmZmVyOnQsYXR0cmlidXRlOmV9fV8rPWUuYnl0ZVNpemV9aWYobFtOLkdQU19USU1FLm5hbWVdKXtsZXQgZT1sW04uR1BTX1RJTUUubmFtZV0sdD1uZXcgRmxvYXQ2NEFycmF5KGUuYnVmZmVyKSxyPW5ldyBBcnJheUJ1ZmZlcig0KmkpLG49bmV3IEZsb2F0MzJBcnJheShyKSxhPTEvMCxzPS0xLzA7Zm9yKGxldCBlPTA7ZTxpO2UrKyl7bGV0IHI9dFtlXTthPU1hdGgubWluKGEscikscz1NYXRoLm1heChzLHIpfWZvcihsZXQgZT0wO2U8aTtlKyspe2xldCByPXRbZV07bltlXT1yLWF9bFtOLkdQU19USU1FLm5hbWVdPXtidWZmZXI6cixhdHRyaWJ1dGU6Ti5HUFNfVElNRSxvZmZzZXQ6YSxyYW5nZTpzLWF9fXtsZXQgZT1uZXcgQXJyYXlCdWZmZXIoNCppKSx0PW5ldyBVaW50MzJBcnJheShlKTtmb3IobGV0IGU9MDtlPGk7ZSsrKXRbZV09ZTtsW04uSU5ESUNFUy5uYW1lXT17YnVmZmVyOmUsYXR0cmlidXRlOk4uSU5ESUNFU319cGVyZm9ybWFuY2UubWFyaygiYmluYXJ5LWRlY29kZXItZW5kIikscGVyZm9ybWFuY2UuY2xlYXJNYXJrcygpLHBlcmZvcm1hbmNlLmNsZWFyTWVhc3VyZXMoKTtsZXQgST17YnVmZmVyOnIsbWVhbjp1LGF0dHJpYnV0ZUJ1ZmZlcnM6bCx0aWdodEJvdW5kaW5nQm94OnttaW46VCxtYXg6b319LGI9W107Zm9yKGxldCBlIGluIEkuYXR0cmlidXRlQnVmZmVycyliLnB1c2goSS5hdHRyaWJ1dGVCdWZmZXJzW2VdLmJ1ZmZlcik7Yi5wdXNoKHIpLHBvc3RNZXNzYWdlKEksYil9OwoK",J="data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmluYXJ5RGVjb2Rlcldvcmtlci5qcyIsInNvdXJjZXMiOlsic3JjL1ZlcnNpb24uanMiLCJzcmMvbG9hZGVyL1BvaW50QXR0cmlidXRlcy5qcyIsInNyYy93b3JrZXJzL0JpbmFyeURlY29kZXJXb3JrZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcbmV4cG9ydCBjbGFzcyBWZXJzaW9ue1xyXG5cclxuXHRjb25zdHJ1Y3Rvcih2ZXJzaW9uKXtcclxuXHRcdHRoaXMudmVyc2lvbiA9IHZlcnNpb247XHJcblx0XHRsZXQgdm1MZW5ndGggPSAodmVyc2lvbi5pbmRleE9mKCcuJykgPT09IC0xKSA/IHZlcnNpb24ubGVuZ3RoIDogdmVyc2lvbi5pbmRleE9mKCcuJyk7XHJcblx0XHR0aGlzLnZlcnNpb25NYWpvciA9IHBhcnNlSW50KHZlcnNpb24uc3Vic3RyKDAsIHZtTGVuZ3RoKSk7XHJcblx0XHR0aGlzLnZlcnNpb25NaW5vciA9IHBhcnNlSW50KHZlcnNpb24uc3Vic3RyKHZtTGVuZ3RoICsgMSkpO1xyXG5cdFx0aWYgKHRoaXMudmVyc2lvbk1pbm9yLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHR0aGlzLnZlcnNpb25NaW5vciA9IDA7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRuZXdlclRoYW4odmVyc2lvbil7XHJcblx0XHRsZXQgdiA9IG5ldyBWZXJzaW9uKHZlcnNpb24pO1xyXG5cclxuXHRcdGlmICh0aGlzLnZlcnNpb25NYWpvciA+IHYudmVyc2lvbk1ham9yKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnZlcnNpb25NYWpvciA9PT0gdi52ZXJzaW9uTWFqb3IgJiYgdGhpcy52ZXJzaW9uTWlub3IgPiB2LnZlcnNpb25NaW5vcikge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGVxdWFsT3JIaWdoZXIodmVyc2lvbil7XHJcblx0XHRsZXQgdiA9IG5ldyBWZXJzaW9uKHZlcnNpb24pO1xyXG5cclxuXHRcdGlmICh0aGlzLnZlcnNpb25NYWpvciA+IHYudmVyc2lvbk1ham9yKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnZlcnNpb25NYWpvciA9PT0gdi52ZXJzaW9uTWFqb3IgJiYgdGhpcy52ZXJzaW9uTWlub3IgPj0gdi52ZXJzaW9uTWlub3IpIHtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR1cFRvKHZlcnNpb24pe1xyXG5cdFx0cmV0dXJuICF0aGlzLm5ld2VyVGhhbih2ZXJzaW9uKTtcclxuXHR9XHJcblxyXG59XHJcblxyXG5cclxuIiwiXHJcblxyXG5leHBvcnQgY29uc3QgUG9pbnRBdHRyaWJ1dGVOYW1lcyA9IHtcclxuXHRQT1NJVElPTl9DQVJURVNJQU46IDAsIC8vIGZsb2F0IHgsIHksIHo7XHJcblx0Q09MT1JfUEFDS0VEOiAxLCAvLyBieXRlIHIsIGcsIGIsIGE7IFx0STogWzAsMV1cclxuXHRDT0xPUl9GTE9BVFNfMTogMiwgLy8gZmxvYXQgciwgZywgYjsgXHRJOiBbMCwxXVxyXG5cdENPTE9SX0ZMT0FUU18yNTU6IDMsIC8vIGZsb2F0IHIsIGcsIGI7IFx0STogWzAsMjU1XVxyXG5cdE5PUk1BTF9GTE9BVFM6IDQsIC8vIGZsb2F0IHgsIHksIHo7XHJcblx0RklMTEVSOiA1LFxyXG5cdElOVEVOU0lUWTogNixcclxuXHRDTEFTU0lGSUNBVElPTjogNyxcclxuXHROT1JNQUxfU1BIRVJFTUFQUEVEOiA4LFxyXG5cdE5PUk1BTF9PQ1QxNjogOSxcclxuXHROT1JNQUw6IDEwLFxyXG5cdFJFVFVSTl9OVU1CRVI6IDExLFxyXG5cdE5VTUJFUl9PRl9SRVRVUk5TOiAxMixcclxuXHRTT1VSQ0VfSUQ6IDEzLFxyXG5cdElORElDRVM6IDE0LFxyXG5cdFNQQUNJTkc6IDE1LFxyXG5cdEdQU19USU1FOiAxNixcclxufTtcclxuXHJcblxyXG4vKipcclxuICogU29tZSB0eXBlcyBvZiBwb3NzaWJsZSBwb2ludCBhdHRyaWJ1dGUgZGF0YSBmb3JtYXRzXHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gKi9cclxuY29uc3QgUG9pbnRBdHRyaWJ1dGVUeXBlcyA9IHtcclxuXHREQVRBX1RZUEVfRE9VQkxFOiB7b3JkaW5hbDogMCwgc2l6ZTogOH0sXHJcblx0REFUQV9UWVBFX0ZMT0FUOiB7b3JkaW5hbDogMSwgc2l6ZTogNH0sXHJcblx0REFUQV9UWVBFX0lOVDg6IHtvcmRpbmFsOiAyLCBzaXplOiAxfSxcclxuXHREQVRBX1RZUEVfVUlOVDg6IHtvcmRpbmFsOiAzLCBzaXplOiAxfSxcclxuXHREQVRBX1RZUEVfSU5UMTY6IHtvcmRpbmFsOiA0LCBzaXplOiAyfSxcclxuXHREQVRBX1RZUEVfVUlOVDE2OiB7b3JkaW5hbDogNSwgc2l6ZTogMn0sXHJcblx0REFUQV9UWVBFX0lOVDMyOiB7b3JkaW5hbDogNiwgc2l6ZTogNH0sXHJcblx0REFUQV9UWVBFX1VJTlQzMjoge29yZGluYWw6IDcsIHNpemU6IDR9LFxyXG5cdERBVEFfVFlQRV9JTlQ2NDoge29yZGluYWw6IDgsIHNpemU6IDh9LFxyXG5cdERBVEFfVFlQRV9VSU5UNjQ6IHtvcmRpbmFsOiA5LCBzaXplOiA4fVxyXG59O1xyXG5cclxubGV0IGkgPSAwO1xyXG5mb3IgKGxldCBvYmogaW4gUG9pbnRBdHRyaWJ1dGVUeXBlcykge1xyXG5cdFBvaW50QXR0cmlidXRlVHlwZXNbaV0gPSBQb2ludEF0dHJpYnV0ZVR5cGVzW29ial07XHJcblx0aSsrO1xyXG59XHJcblxyXG5leHBvcnQge1BvaW50QXR0cmlidXRlVHlwZXN9O1xyXG5cclxuXHJcbmNsYXNzIFBvaW50QXR0cmlidXRle1xyXG5cdFxyXG5cdGNvbnN0cnVjdG9yKG5hbWUsIHR5cGUsIG51bUVsZW1lbnRzKXtcclxuXHRcdHRoaXMubmFtZSA9IG5hbWU7XHJcblx0XHR0aGlzLnR5cGUgPSB0eXBlO1xyXG5cdFx0dGhpcy5udW1FbGVtZW50cyA9IG51bUVsZW1lbnRzO1xyXG5cdFx0dGhpcy5ieXRlU2l6ZSA9IHRoaXMubnVtRWxlbWVudHMgKiB0aGlzLnR5cGUuc2l6ZTtcclxuXHR9XHJcblxyXG59O1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuUE9TSVRJT05fQ0FSVEVTSUFOID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuUE9TSVRJT05fQ0FSVEVTSUFOLFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0ZMT0FULCAzKTtcclxuXHJcblBvaW50QXR0cmlidXRlLlJHQkFfUEFDS0VEID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuQ09MT1JfUEFDS0VELFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0lOVDgsIDQpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuQ09MT1JfUEFDS0VEID0gUG9pbnRBdHRyaWJ1dGUuUkdCQV9QQUNLRUQ7XHJcblxyXG5Qb2ludEF0dHJpYnV0ZS5SR0JfUEFDS0VEID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuQ09MT1JfUEFDS0VELFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0lOVDgsIDMpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuTk9STUFMX0ZMT0FUUyA9IG5ldyBQb2ludEF0dHJpYnV0ZShcclxuXHRQb2ludEF0dHJpYnV0ZU5hbWVzLk5PUk1BTF9GTE9BVFMsXHJcblx0UG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfRkxPQVQsIDMpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuRklMTEVSXzFCID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuRklMTEVSLFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX1VJTlQ4LCAxKTtcclxuXHJcblBvaW50QXR0cmlidXRlLklOVEVOU0lUWSA9IG5ldyBQb2ludEF0dHJpYnV0ZShcclxuXHRQb2ludEF0dHJpYnV0ZU5hbWVzLklOVEVOU0lUWSxcclxuXHRQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UMTYsIDEpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuQ0xBU1NJRklDQVRJT04gPSBuZXcgUG9pbnRBdHRyaWJ1dGUoXHJcblx0UG9pbnRBdHRyaWJ1dGVOYW1lcy5DTEFTU0lGSUNBVElPTixcclxuXHRQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMSk7XHJcblxyXG5Qb2ludEF0dHJpYnV0ZS5OT1JNQUxfU1BIRVJFTUFQUEVEID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuTk9STUFMX1NQSEVSRU1BUFBFRCxcclxuXHRQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UOCwgMik7XHJcblxyXG5Qb2ludEF0dHJpYnV0ZS5OT1JNQUxfT0NUMTYgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoXHJcblx0UG9pbnRBdHRyaWJ1dGVOYW1lcy5OT1JNQUxfT0NUMTYsXHJcblx0UG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfVUlOVDgsIDIpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuTk9STUFMID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuTk9STUFMLFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX0ZMT0FULCAzKTtcclxuXHRcclxuUG9pbnRBdHRyaWJ1dGUuUkVUVVJOX05VTUJFUiA9IG5ldyBQb2ludEF0dHJpYnV0ZShcclxuXHRQb2ludEF0dHJpYnV0ZU5hbWVzLlJFVFVSTl9OVU1CRVIsXHJcblx0UG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfVUlOVDgsIDEpO1xyXG5cdFxyXG5Qb2ludEF0dHJpYnV0ZS5OVU1CRVJfT0ZfUkVUVVJOUyA9IG5ldyBQb2ludEF0dHJpYnV0ZShcclxuXHRQb2ludEF0dHJpYnV0ZU5hbWVzLk5VTUJFUl9PRl9SRVRVUk5TLFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX1VJTlQ4LCAxKTtcclxuXHRcclxuUG9pbnRBdHRyaWJ1dGUuU09VUkNFX0lEID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuU09VUkNFX0lELFxyXG5cdFBvaW50QXR0cmlidXRlVHlwZXMuREFUQV9UWVBFX1VJTlQxNiwgMSk7XHJcblxyXG5Qb2ludEF0dHJpYnV0ZS5JTkRJQ0VTID0gbmV3IFBvaW50QXR0cmlidXRlKFxyXG5cdFBvaW50QXR0cmlidXRlTmFtZXMuSU5ESUNFUyxcclxuXHRQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9VSU5UMzIsIDEpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuU1BBQ0lORyA9IG5ldyBQb2ludEF0dHJpYnV0ZShcclxuXHRQb2ludEF0dHJpYnV0ZU5hbWVzLlNQQUNJTkcsXHJcblx0UG9pbnRBdHRyaWJ1dGVUeXBlcy5EQVRBX1RZUEVfRkxPQVQsIDEpO1xyXG5cclxuUG9pbnRBdHRyaWJ1dGUuR1BTX1RJTUUgPSBuZXcgUG9pbnRBdHRyaWJ1dGUoXHJcblx0UG9pbnRBdHRyaWJ1dGVOYW1lcy5HUFNfVElNRSxcclxuXHRQb2ludEF0dHJpYnV0ZVR5cGVzLkRBVEFfVFlQRV9ET1VCTEUsIDEpO1xyXG5cclxuZXhwb3J0IHtQb2ludEF0dHJpYnV0ZX07XHJcblxyXG5leHBvcnQgY2xhc3MgUG9pbnRBdHRyaWJ1dGVze1xyXG5cclxuXHRjb25zdHJ1Y3Rvcihwb2ludEF0dHJpYnV0ZXMpe1xyXG5cdFx0dGhpcy5hdHRyaWJ1dGVzID0gW107XHJcblx0XHR0aGlzLmJ5dGVTaXplID0gMDtcclxuXHRcdHRoaXMuc2l6ZSA9IDA7XHJcblxyXG5cdFx0aWYgKHBvaW50QXR0cmlidXRlcyAhPSBudWxsKSB7XHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRBdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0bGV0IHBvaW50QXR0cmlidXRlTmFtZSA9IHBvaW50QXR0cmlidXRlc1tpXTtcclxuXHRcdFx0XHRsZXQgcG9pbnRBdHRyaWJ1dGUgPSBQb2ludEF0dHJpYnV0ZVtwb2ludEF0dHJpYnV0ZU5hbWVdO1xyXG5cdFx0XHRcdHRoaXMuYXR0cmlidXRlcy5wdXNoKHBvaW50QXR0cmlidXRlKTtcclxuXHRcdFx0XHR0aGlzLmJ5dGVTaXplICs9IHBvaW50QXR0cmlidXRlLmJ5dGVTaXplO1xyXG5cdFx0XHRcdHRoaXMuc2l6ZSsrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHJcblx0YWRkKHBvaW50QXR0cmlidXRlKXtcclxuXHRcdHRoaXMuYXR0cmlidXRlcy5wdXNoKHBvaW50QXR0cmlidXRlKTtcclxuXHRcdHRoaXMuYnl0ZVNpemUgKz0gcG9pbnRBdHRyaWJ1dGUuYnl0ZVNpemU7XHJcblx0XHR0aGlzLnNpemUrKztcclxuXHR9O1xyXG5cclxuXHRoYXNDb2xvcnMoKXtcclxuXHRcdGZvciAobGV0IG5hbWUgaW4gdGhpcy5hdHRyaWJ1dGVzKSB7XHJcblx0XHRcdGxldCBwb2ludEF0dHJpYnV0ZSA9IHRoaXMuYXR0cmlidXRlc1tuYW1lXTtcclxuXHRcdFx0aWYgKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlTmFtZXMuQ09MT1JfUEFDS0VEKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fTtcclxuXHJcblx0aGFzTm9ybWFscygpe1xyXG5cdFx0Zm9yIChsZXQgbmFtZSBpbiB0aGlzLmF0dHJpYnV0ZXMpIHtcclxuXHRcdFx0bGV0IHBvaW50QXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGVzW25hbWVdO1xyXG5cdFx0XHRpZiAoXHJcblx0XHRcdFx0cG9pbnRBdHRyaWJ1dGUgPT09IFBvaW50QXR0cmlidXRlLk5PUk1BTF9TUEhFUkVNQVBQRUQgfHxcclxuXHRcdFx0XHRwb2ludEF0dHJpYnV0ZSA9PT0gUG9pbnRBdHRyaWJ1dGUuTk9STUFMX0ZMT0FUUyB8fFxyXG5cdFx0XHRcdHBvaW50QXR0cmlidXRlID09PSBQb2ludEF0dHJpYnV0ZS5OT1JNQUwgfHxcclxuXHRcdFx0XHRwb2ludEF0dHJpYnV0ZSA9PT0gUG9pbnRBdHRyaWJ1dGUuTk9STUFMX09DVDE2KSB7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fTtcclxuXHJcbn1cclxuIiwiXHJcblxyXG5pbXBvcnQge1ZlcnNpb259IGZyb20gXCIuLi9WZXJzaW9uLmpzXCI7XHJcbmltcG9ydCB7UG9pbnRBdHRyaWJ1dGVzLCBQb2ludEF0dHJpYnV0ZX0gZnJvbSBcIi4uL2xvYWRlci9Qb2ludEF0dHJpYnV0ZXMuanNcIjtcclxuaW1wb3J0IHtJbnRlcmxlYXZlZEJ1ZmZlcn0gZnJvbSBcIi4uL0ludGVybGVhdmVkQnVmZmVyLmpzXCI7XHJcbmltcG9ydCB7dG9JbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZX0gZnJvbSBcIi4uL3V0aWxzL3RvSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUuanNcIjtcclxuXHJcblxyXG5cclxuLyogZ2xvYmFsIG9ubWVzc2FnZTp0cnVlIHBvc3RNZXNzYWdlOmZhbHNlICovXHJcbi8qIGV4cG9ydGVkIG9ubWVzc2FnZSAqL1xyXG4vLyBodHRwOi8vanNwZXJmLmNvbS91aW50OGFycmF5LXZzLWRhdGF2aWV3My8zXHJcbmZ1bmN0aW9uIEN1c3RvbVZpZXcgKGJ1ZmZlcikge1xyXG5cdHRoaXMuYnVmZmVyID0gYnVmZmVyO1xyXG5cdHRoaXMudTggPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xyXG5cclxuXHRsZXQgdG1wID0gbmV3IEFycmF5QnVmZmVyKDgpO1xyXG5cdGxldCB0bXBmID0gbmV3IEZsb2F0MzJBcnJheSh0bXApO1xyXG5cdGxldCB0bXBkID0gbmV3IEZsb2F0NjRBcnJheSh0bXApO1xyXG5cdGxldCB0bXB1OCA9IG5ldyBVaW50OEFycmF5KHRtcCk7XHJcblxyXG5cdHRoaXMuZ2V0VWludDMyID0gZnVuY3Rpb24gKGkpIHtcclxuXHRcdHJldHVybiAodGhpcy51OFtpICsgM10gPDwgMjQpIHwgKHRoaXMudThbaSArIDJdIDw8IDE2KSB8ICh0aGlzLnU4W2kgKyAxXSA8PCA4KSB8IHRoaXMudThbaV07XHJcblx0fTtcclxuXHJcblx0dGhpcy5nZXRVaW50MTYgPSBmdW5jdGlvbiAoaSkge1xyXG5cdFx0cmV0dXJuICh0aGlzLnU4W2kgKyAxXSA8PCA4KSB8IHRoaXMudThbaV07XHJcblx0fTtcclxuXHJcblx0dGhpcy5nZXRGbG9hdDMyID0gZnVuY3Rpb24gKGkpIHtcclxuXHRcdHRtcHU4WzBdID0gdGhpcy51OFtpICsgMF07XHJcblx0XHR0bXB1OFsxXSA9IHRoaXMudThbaSArIDFdO1xyXG5cdFx0dG1wdThbMl0gPSB0aGlzLnU4W2kgKyAyXTtcclxuXHRcdHRtcHU4WzNdID0gdGhpcy51OFtpICsgM107XHJcblxyXG5cdFx0cmV0dXJuIHRtcGZbMF07XHJcblx0fTtcclxuXHJcblx0dGhpcy5nZXRGbG9hdDY0ID0gZnVuY3Rpb24gKGkpIHtcclxuXHRcdHRtcHU4WzBdID0gdGhpcy51OFtpICsgMF07XHJcblx0XHR0bXB1OFsxXSA9IHRoaXMudThbaSArIDFdO1xyXG5cdFx0dG1wdThbMl0gPSB0aGlzLnU4W2kgKyAyXTtcclxuXHRcdHRtcHU4WzNdID0gdGhpcy51OFtpICsgM107XHJcblx0XHR0bXB1OFs0XSA9IHRoaXMudThbaSArIDRdO1xyXG5cdFx0dG1wdThbNV0gPSB0aGlzLnU4W2kgKyA1XTtcclxuXHRcdHRtcHU4WzZdID0gdGhpcy51OFtpICsgNl07XHJcblx0XHR0bXB1OFs3XSA9IHRoaXMudThbaSArIDddO1xyXG5cclxuXHRcdHJldHVybiB0bXBkWzBdO1xyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0VWludDggPSBmdW5jdGlvbiAoaSkge1xyXG5cdFx0cmV0dXJuIHRoaXMudThbaV07XHJcblx0fTtcclxufVxyXG5cclxub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcblxyXG5cdHBlcmZvcm1hbmNlLm1hcmsoXCJiaW5hcnktZGVjb2Rlci1zdGFydFwiKTtcclxuXHRcclxuXHRsZXQgYnVmZmVyID0gZXZlbnQuZGF0YS5idWZmZXI7XHJcblx0bGV0IHBvaW50QXR0cmlidXRlcyA9IGV2ZW50LmRhdGEucG9pbnRBdHRyaWJ1dGVzO1xyXG5cdGxldCBudW1Qb2ludHMgPSBidWZmZXIuYnl0ZUxlbmd0aCAvIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZTtcclxuXHRsZXQgY3YgPSBuZXcgQ3VzdG9tVmlldyhidWZmZXIpO1xyXG5cdGxldCB2ZXJzaW9uID0gbmV3IFZlcnNpb24oZXZlbnQuZGF0YS52ZXJzaW9uKTtcclxuXHRsZXQgbm9kZU9mZnNldCA9IGV2ZW50LmRhdGEub2Zmc2V0O1xyXG5cdGxldCBzY2FsZSA9IGV2ZW50LmRhdGEuc2NhbGU7XHJcblx0bGV0IHNwYWNpbmcgPSBldmVudC5kYXRhLnNwYWNpbmc7XHJcblx0bGV0IGhhc0NoaWxkcmVuID0gZXZlbnQuZGF0YS5oYXNDaGlsZHJlbjtcclxuXHRsZXQgbmFtZSA9IGV2ZW50LmRhdGEubmFtZTtcclxuXHRcclxuXHRsZXQgdGlnaHRCb3hNaW4gPSBbIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXTtcclxuXHRsZXQgdGlnaHRCb3hNYXggPSBbIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgXTtcclxuXHRsZXQgbWVhbiA9IFswLCAwLCAwXTtcclxuXHRcclxuXHJcblx0bGV0IGF0dHJpYnV0ZUJ1ZmZlcnMgPSB7fTtcclxuXHRsZXQgaW5PZmZzZXQgPSAwO1xyXG5cdGZvciAobGV0IHBvaW50QXR0cmlidXRlIG9mIHBvaW50QXR0cmlidXRlcy5hdHRyaWJ1dGVzKSB7XHJcblx0XHRcclxuXHRcdGlmIChwb2ludEF0dHJpYnV0ZS5uYW1lID09PSBQb2ludEF0dHJpYnV0ZS5QT1NJVElPTl9DQVJURVNJQU4ubmFtZSkge1xyXG5cdFx0XHRsZXQgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0ICogMyk7XHJcblx0XHRcdGxldCBwb3NpdGlvbnMgPSBuZXcgRmxvYXQzMkFycmF5KGJ1ZmYpO1xyXG5cdFx0XHJcblx0XHRcdGZvciAobGV0IGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspIHtcclxuXHRcdFx0XHRsZXQgeCwgeSwgejtcclxuXHJcblx0XHRcdFx0aWYgKHZlcnNpb24ubmV3ZXJUaGFuKCcxLjMnKSkge1xyXG5cdFx0XHRcdFx0eCA9IChjdi5nZXRVaW50MzIoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMCwgdHJ1ZSkgKiBzY2FsZSk7XHJcblx0XHRcdFx0XHR5ID0gKGN2LmdldFVpbnQzMihpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyA0LCB0cnVlKSAqIHNjYWxlKTtcclxuXHRcdFx0XHRcdHogPSAoY3YuZ2V0VWludDMyKGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDgsIHRydWUpICogc2NhbGUpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR4ID0gY3YuZ2V0RmxvYXQzMihqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMCwgdHJ1ZSkgKyBub2RlT2Zmc2V0WzBdO1xyXG5cdFx0XHRcdFx0eSA9IGN2LmdldEZsb2F0MzIoaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDQsIHRydWUpICsgbm9kZU9mZnNldFsxXTtcclxuXHRcdFx0XHRcdHogPSBjdi5nZXRGbG9hdDMyKGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyA4LCB0cnVlKSArIG5vZGVPZmZzZXRbMl07XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRwb3NpdGlvbnNbMyAqIGogKyAwXSA9IHg7XHJcblx0XHRcdFx0cG9zaXRpb25zWzMgKiBqICsgMV0gPSB5O1xyXG5cdFx0XHRcdHBvc2l0aW9uc1szICogaiArIDJdID0gejtcclxuXHJcblx0XHRcdFx0bWVhblswXSArPSB4IC8gbnVtUG9pbnRzO1xyXG5cdFx0XHRcdG1lYW5bMV0gKz0geSAvIG51bVBvaW50cztcclxuXHRcdFx0XHRtZWFuWzJdICs9IHogLyBudW1Qb2ludHM7XHJcblxyXG5cdFx0XHRcdHRpZ2h0Qm94TWluWzBdID0gTWF0aC5taW4odGlnaHRCb3hNaW5bMF0sIHgpO1xyXG5cdFx0XHRcdHRpZ2h0Qm94TWluWzFdID0gTWF0aC5taW4odGlnaHRCb3hNaW5bMV0sIHkpO1xyXG5cdFx0XHRcdHRpZ2h0Qm94TWluWzJdID0gTWF0aC5taW4odGlnaHRCb3hNaW5bMl0sIHopO1xyXG5cclxuXHRcdFx0XHR0aWdodEJveE1heFswXSA9IE1hdGgubWF4KHRpZ2h0Qm94TWF4WzBdLCB4KTtcclxuXHRcdFx0XHR0aWdodEJveE1heFsxXSA9IE1hdGgubWF4KHRpZ2h0Qm94TWF4WzFdLCB5KTtcclxuXHRcdFx0XHR0aWdodEJveE1heFsyXSA9IE1hdGgubWF4KHRpZ2h0Qm94TWF4WzJdLCB6KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0YXR0cmlidXRlQnVmZmVyc1twb2ludEF0dHJpYnV0ZS5uYW1lXSA9IHsgYnVmZmVyOiBidWZmLCBhdHRyaWJ1dGU6IHBvaW50QXR0cmlidXRlIH07XHJcblx0XHR9IGVsc2UgaWYgKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlLkNPTE9SX1BBQ0tFRC5uYW1lKSB7XHJcblx0XHRcdGxldCBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xyXG5cdFx0XHRsZXQgY29sb3JzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZik7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBqID0gMDsgaiA8IG51bVBvaW50czsgaisrKSB7XHJcblx0XHRcdFx0Y29sb3JzWzQgKiBqICsgMF0gPSBjdi5nZXRVaW50OChpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyAwKTtcclxuXHRcdFx0XHRjb2xvcnNbNCAqIGogKyAxXSA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDEpO1xyXG5cdFx0XHRcdGNvbG9yc1s0ICogaiArIDJdID0gY3YuZ2V0VWludDgoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMik7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGF0dHJpYnV0ZUJ1ZmZlcnNbcG9pbnRBdHRyaWJ1dGUubmFtZV0gPSB7IGJ1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZSB9O1xyXG5cdFx0fSBlbHNlIGlmIChwb2ludEF0dHJpYnV0ZS5uYW1lID09PSBQb2ludEF0dHJpYnV0ZS5JTlRFTlNJVFkubmFtZSkge1xyXG5cdFx0XHRsZXQgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0KTtcclxuXHRcdFx0bGV0IGludGVuc2l0aWVzID0gbmV3IEZsb2F0MzJBcnJheShidWZmKTtcclxuXHJcblx0XHRcdGZvciAobGV0IGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspIHtcclxuXHRcdFx0XHRsZXQgaW50ZW5zaXR5ID0gY3YuZ2V0VWludDE2KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSwgdHJ1ZSk7XHJcblx0XHRcdFx0aW50ZW5zaXRpZXNbal0gPSBpbnRlbnNpdHk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGF0dHJpYnV0ZUJ1ZmZlcnNbcG9pbnRBdHRyaWJ1dGUubmFtZV0gPSB7IGJ1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZSB9O1xyXG5cdFx0fSBlbHNlIGlmIChwb2ludEF0dHJpYnV0ZS5uYW1lID09PSBQb2ludEF0dHJpYnV0ZS5DTEFTU0lGSUNBVElPTi5uYW1lKSB7XHJcblx0XHRcdGxldCBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyk7XHJcblx0XHRcdGxldCBjbGFzc2lmaWNhdGlvbnMgPSBuZXcgVWludDhBcnJheShidWZmKTtcclxuXHJcblx0XHRcdGZvciAobGV0IGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspIHtcclxuXHRcdFx0XHRsZXQgY2xhc3NpZmljYXRpb24gPSBjdi5nZXRVaW50OChpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUpO1xyXG5cdFx0XHRcdGNsYXNzaWZpY2F0aW9uc1tqXSA9IGNsYXNzaWZpY2F0aW9uO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0geyBidWZmZXI6IGJ1ZmYsIGF0dHJpYnV0ZTogcG9pbnRBdHRyaWJ1dGUgfTtcclxuXHRcdH0gZWxzZSBpZiAocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuUkVUVVJOX05VTUJFUi5uYW1lKSB7XHJcblx0XHRcdGxldCBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyk7XHJcblx0XHRcdGxldCByZXR1cm5OdW1iZXJzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZik7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBqID0gMDsgaiA8IG51bVBvaW50czsgaisrKSB7XHJcblx0XHRcdFx0bGV0IHJldHVybk51bWJlciA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSk7XHJcblx0XHRcdFx0cmV0dXJuTnVtYmVyc1tqXSA9IHJldHVybk51bWJlcjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0YXR0cmlidXRlQnVmZmVyc1twb2ludEF0dHJpYnV0ZS5uYW1lXSA9IHsgYnVmZmVyOiBidWZmLCBhdHRyaWJ1dGU6IHBvaW50QXR0cmlidXRlIH07XHJcblx0XHR9IGVsc2UgaWYgKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlLk5VTUJFUl9PRl9SRVRVUk5TLm5hbWUpIHtcclxuXHRcdFx0bGV0IGJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzKTtcclxuXHRcdFx0bGV0IG51bWJlck9mUmV0dXJucyA9IG5ldyBVaW50OEFycmF5KGJ1ZmYpO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaiA9IDA7IGogPCBudW1Qb2ludHM7IGorKykge1xyXG5cdFx0XHRcdGxldCBudW1iZXJPZlJldHVybiA9IGN2LmdldFVpbnQ4KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSk7XHJcblx0XHRcdFx0bnVtYmVyT2ZSZXR1cm5zW2pdID0gbnVtYmVyT2ZSZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGF0dHJpYnV0ZUJ1ZmZlcnNbcG9pbnRBdHRyaWJ1dGUubmFtZV0gPSB7IGJ1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZSB9O1xyXG5cdFx0fSBlbHNlIGlmIChwb2ludEF0dHJpYnV0ZS5uYW1lID09PSBQb2ludEF0dHJpYnV0ZS5TT1VSQ0VfSUQubmFtZSkge1xyXG5cdFx0XHRsZXQgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiAyKTtcclxuXHRcdFx0bGV0IHNvdXJjZUlEcyA9IG5ldyBVaW50MTZBcnJheShidWZmKTtcclxuXHJcblx0XHRcdGZvciAobGV0IGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspIHtcclxuXHRcdFx0XHRsZXQgc291cmNlSUQgPSBjdi5nZXRVaW50MTYoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplKTtcclxuXHRcdFx0XHRzb3VyY2VJRHNbal0gPSBzb3VyY2VJRDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0YXR0cmlidXRlQnVmZmVyc1twb2ludEF0dHJpYnV0ZS5uYW1lXSA9IHsgYnVmZmVyOiBidWZmLCBhdHRyaWJ1dGU6IHBvaW50QXR0cmlidXRlIH07XHJcblx0XHR9IGVsc2UgaWYgKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlLk5PUk1BTF9TUEhFUkVNQVBQRUQubmFtZSkge1xyXG5cdFx0XHRsZXQgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA0ICogMyk7XHJcblx0XHRcdGxldCBub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShidWZmKTtcclxuXHJcblx0XHRcdGZvciAobGV0IGogPSAwOyBqIDwgbnVtUG9pbnRzOyBqKyspIHtcclxuXHRcdFx0XHRsZXQgYnggPSBjdi5nZXRVaW50OChpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyAwKTtcclxuXHRcdFx0XHRsZXQgYnkgPSBjdi5nZXRVaW50OChpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyAxKTtcclxuXHJcblx0XHRcdFx0bGV0IGV4ID0gYnggLyAyNTU7XHJcblx0XHRcdFx0bGV0IGV5ID0gYnkgLyAyNTU7XHJcblxyXG5cdFx0XHRcdGxldCBueCA9IGV4ICogMiAtIDE7XHJcblx0XHRcdFx0bGV0IG55ID0gZXkgKiAyIC0gMTtcclxuXHRcdFx0XHRsZXQgbnogPSAxO1xyXG5cdFx0XHRcdGxldCBudyA9IC0xO1xyXG5cclxuXHRcdFx0XHRsZXQgbCA9IChueCAqICgtbngpKSArIChueSAqICgtbnkpKSArIChueiAqICgtbncpKTtcclxuXHRcdFx0XHRueiA9IGw7XHJcblx0XHRcdFx0bnggPSBueCAqIE1hdGguc3FydChsKTtcclxuXHRcdFx0XHRueSA9IG55ICogTWF0aC5zcXJ0KGwpO1xyXG5cclxuXHRcdFx0XHRueCA9IG54ICogMjtcclxuXHRcdFx0XHRueSA9IG55ICogMjtcclxuXHRcdFx0XHRueiA9IG56ICogMiAtIDE7XHJcblxyXG5cdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAwXSA9IG54O1xyXG5cdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAxXSA9IG55O1xyXG5cdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAyXSA9IG56O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0geyBidWZmZXI6IGJ1ZmYsIGF0dHJpYnV0ZTogcG9pbnRBdHRyaWJ1dGUgfTtcclxuXHRcdH0gZWxzZSBpZiAocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuTk9STUFMX09DVDE2Lm5hbWUpIHtcclxuXHRcdFx0bGV0IGJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogNCAqIDMpO1xyXG5cdFx0XHRsZXQgbm9ybWFscyA9IG5ldyBGbG9hdDMyQXJyYXkoYnVmZik7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBqID0gMDsgaiA8IG51bVBvaW50czsgaisrKSB7XHJcblx0XHRcdFx0bGV0IGJ4ID0gY3YuZ2V0VWludDgoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMCk7XHJcblx0XHRcdFx0bGV0IGJ5ID0gY3YuZ2V0VWludDgoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgMSk7XHJcblxyXG5cdFx0XHRcdGxldCB1ID0gKGJ4IC8gMjU1KSAqIDIgLSAxO1xyXG5cdFx0XHRcdGxldCB2ID0gKGJ5IC8gMjU1KSAqIDIgLSAxO1xyXG5cclxuXHRcdFx0XHRsZXQgeiA9IDEgLSBNYXRoLmFicyh1KSAtIE1hdGguYWJzKHYpO1xyXG5cclxuXHRcdFx0XHRsZXQgeCA9IDA7XHJcblx0XHRcdFx0bGV0IHkgPSAwO1xyXG5cdFx0XHRcdGlmICh6ID49IDApIHtcclxuXHRcdFx0XHRcdHggPSB1O1xyXG5cdFx0XHRcdFx0eSA9IHY7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHggPSAtKHYgLyBNYXRoLnNpZ24odikgLSAxKSAvIE1hdGguc2lnbih1KTtcclxuXHRcdFx0XHRcdHkgPSAtKHUgLyBNYXRoLnNpZ24odSkgLSAxKSAvIE1hdGguc2lnbih2KTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGxldCBsZW5ndGggPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTtcclxuXHRcdFx0XHR4ID0geCAvIGxlbmd0aDtcclxuXHRcdFx0XHR5ID0geSAvIGxlbmd0aDtcclxuXHRcdFx0XHR6ID0geiAvIGxlbmd0aDtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMF0gPSB4O1xyXG5cdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAxXSA9IHk7XHJcblx0XHRcdFx0bm9ybWFsc1szICogaiArIDJdID0gejtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0YXR0cmlidXRlQnVmZmVyc1twb2ludEF0dHJpYnV0ZS5uYW1lXSA9IHsgYnVmZmVyOiBidWZmLCBhdHRyaWJ1dGU6IHBvaW50QXR0cmlidXRlIH07XHJcblx0XHR9IGVsc2UgaWYgKHBvaW50QXR0cmlidXRlLm5hbWUgPT09IFBvaW50QXR0cmlidXRlLk5PUk1BTC5uYW1lKSB7XHJcblx0XHRcdGxldCBidWZmID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQgKiAzKTtcclxuXHRcdFx0bGV0IG5vcm1hbHMgPSBuZXcgRmxvYXQzMkFycmF5KGJ1ZmYpO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaiA9IDA7IGogPCBudW1Qb2ludHM7IGorKykge1xyXG5cdFx0XHRcdGxldCB4ID0gY3YuZ2V0RmxvYXQzMihpbk9mZnNldCArIGogKiBwb2ludEF0dHJpYnV0ZXMuYnl0ZVNpemUgKyAwLCB0cnVlKTtcclxuXHRcdFx0XHRsZXQgeSA9IGN2LmdldEZsb2F0MzIoaW5PZmZzZXQgKyBqICogcG9pbnRBdHRyaWJ1dGVzLmJ5dGVTaXplICsgNCwgdHJ1ZSk7XHJcblx0XHRcdFx0bGV0IHogPSBjdi5nZXRGbG9hdDMyKGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSArIDgsIHRydWUpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdG5vcm1hbHNbMyAqIGogKyAwXSA9IHg7XHJcblx0XHRcdFx0bm9ybWFsc1szICogaiArIDFdID0geTtcclxuXHRcdFx0XHRub3JtYWxzWzMgKiBqICsgMl0gPSB6O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhdHRyaWJ1dGVCdWZmZXJzW3BvaW50QXR0cmlidXRlLm5hbWVdID0geyBidWZmZXI6IGJ1ZmYsIGF0dHJpYnV0ZTogcG9pbnRBdHRyaWJ1dGUgfTtcclxuXHRcdH0gZWxzZSBpZiAocG9pbnRBdHRyaWJ1dGUubmFtZSA9PT0gUG9pbnRBdHRyaWJ1dGUuR1BTX1RJTUUubmFtZSkge1xyXG5cdFx0XHRsZXQgYnVmZiA9IG5ldyBBcnJheUJ1ZmZlcihudW1Qb2ludHMgKiA4KTtcclxuXHRcdFx0bGV0IGdwc3RpbWVzID0gbmV3IEZsb2F0NjRBcnJheShidWZmKTtcclxuXHJcblx0XHRcdGZvcihsZXQgaiA9IDA7IGogPCBudW1Qb2ludHM7IGorKyl7XHJcblx0XHRcdFx0bGV0IGdwc3RpbWUgPSBjdi5nZXRGbG9hdDY0KGluT2Zmc2V0ICsgaiAqIHBvaW50QXR0cmlidXRlcy5ieXRlU2l6ZSwgdHJ1ZSk7XHJcblx0XHRcdFx0Z3BzdGltZXNbal0gPSBncHN0aW1lO1xyXG5cdFx0XHR9XHJcblx0XHRcdGF0dHJpYnV0ZUJ1ZmZlcnNbcG9pbnRBdHRyaWJ1dGUubmFtZV0gPSB7IGJ1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBwb2ludEF0dHJpYnV0ZSB9O1xyXG5cdFx0fVxyXG5cclxuXHRcdGluT2Zmc2V0ICs9IHBvaW50QXR0cmlidXRlLmJ5dGVTaXplO1xyXG5cdH1cclxuXHJcblx0Ly8gQ29udmVydCBHUFMgdGltZSBmcm9tIGRvdWJsZSAodW5zdXBwb3J0ZWQgYnkgV2ViR0wpIHRvIG9yaWdpbi1hbGlnbmVkIGZsb2F0c1xyXG5cdGlmKGF0dHJpYnV0ZUJ1ZmZlcnNbUG9pbnRBdHRyaWJ1dGUuR1BTX1RJTUUubmFtZV0peyBcclxuXHRcdGxldCBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVCdWZmZXJzW1BvaW50QXR0cmlidXRlLkdQU19USU1FLm5hbWVdO1xyXG5cdFx0bGV0IHNvdXJjZUY2NCA9IG5ldyBGbG9hdDY0QXJyYXkoYXR0cmlidXRlLmJ1ZmZlcik7XHJcblx0XHRsZXQgdGFyZ2V0ID0gbmV3IEFycmF5QnVmZmVyKG51bVBvaW50cyAqIDQpO1xyXG5cdFx0bGV0IHRhcmdldEYzMiA9IG5ldyBGbG9hdDMyQXJyYXkodGFyZ2V0KTtcclxuXHJcblx0XHRsZXQgbWluID0gSW5maW5pdHk7XHJcblx0XHRsZXQgbWF4ID0gLUluZmluaXR5O1xyXG5cdFx0Zm9yKGxldCBpID0gMDsgaSA8IG51bVBvaW50czsgaSsrKXtcclxuXHRcdFx0bGV0IGdwc3RpbWUgPSBzb3VyY2VGNjRbaV07XHJcblxyXG5cdFx0XHRtaW4gPSBNYXRoLm1pbihtaW4sIGdwc3RpbWUpO1xyXG5cdFx0XHRtYXggPSBNYXRoLm1heChtYXgsIGdwc3RpbWUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvcihsZXQgaSA9IDA7IGkgPCBudW1Qb2ludHM7IGkrKyl7XHJcblx0XHRcdGxldCBncHN0aW1lID0gc291cmNlRjY0W2ldO1xyXG5cdFx0XHR0YXJnZXRGMzJbaV0gPSBncHN0aW1lIC0gbWluO1xyXG5cdFx0fVxyXG5cclxuXHRcdGF0dHJpYnV0ZUJ1ZmZlcnNbUG9pbnRBdHRyaWJ1dGUuR1BTX1RJTUUubmFtZV0gPSB7IFxyXG5cdFx0XHRidWZmZXI6IHRhcmdldCwgXHJcblx0XHRcdGF0dHJpYnV0ZTogUG9pbnRBdHRyaWJ1dGUuR1BTX1RJTUUsXHJcblx0XHRcdG9mZnNldDogbWluLFxyXG5cdFx0XHRyYW5nZTogbWF4IC0gbWlufTtcclxuXHR9XHJcblxyXG5cdC8vbGV0IGRlYnVnTm9kZXMgPSBbXCJyMDI2XCIsIFwicjAyMjZcIixcInIwMjI3NFwiXTtcclxuXHQvL2lmKGRlYnVnTm9kZXMuaW5jbHVkZXMobmFtZSkpe1xyXG5cdGlmKGZhbHNlKXtcclxuXHRcdGNvbnNvbGUubG9nKFwiZXN0aW1hdGUgc3BhY2luZyFcIik7XHJcblxyXG5cclxuXHRcdGxldCBzcGFyc2VHcmlkID0gbmV3IE1hcCgpO1xyXG5cdFx0bGV0IGdyaWRTaXplID0gMTY7XHJcblxyXG5cdFx0bGV0IHRpZ2h0Qm94U2l6ZSA9IHRpZ2h0Qm94TWF4Lm1hcCggKGEsIGkpID0+IGEgLSB0aWdodEJveE1pbltpXSk7XHJcblx0XHRsZXQgY3ViZUxlbmd0aCA9IE1hdGgubWF4KC4uLnRpZ2h0Qm94U2l6ZSk7XHJcblx0XHRsZXQgY3ViZSA9IHtcclxuXHRcdFx0bWluOiB0aWdodEJveE1pbixcclxuXHRcdFx0bWF4OiB0aWdodEJveE1pbi5tYXAodiA9PiB2ICsgY3ViZUxlbmd0aClcclxuXHRcdH07XHJcblxyXG5cdFx0bGV0IHBvc2l0aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoYXR0cmlidXRlQnVmZmVyc1tQb2ludEF0dHJpYnV0ZS5QT1NJVElPTl9DQVJURVNJQU4ubmFtZV0uYnVmZmVyKTtcclxuXHRcdGZvcihsZXQgaSA9IDA7IGkgPCBudW1Qb2ludHM7IGkrKyl7XHJcblx0XHRcdGxldCB4ID0gcG9zaXRpb25zWzMgKiBpICsgMF07XHJcblx0XHRcdGxldCB5ID0gcG9zaXRpb25zWzMgKiBpICsgMV07XHJcblx0XHRcdGxldCB6ID0gcG9zaXRpb25zWzMgKiBpICsgMl07XHJcblxyXG5cdFx0XHRsZXQgaXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihncmlkU2l6ZSAqICh4IC0gY3ViZS5taW5bMF0pIC8gY3ViZUxlbmd0aCwgZ3JpZFNpemUgLSAxKSk7XHJcblx0XHRcdGxldCBpeSA9IE1hdGgubWF4KDAsIE1hdGgubWluKGdyaWRTaXplICogKHkgLSBjdWJlLm1pblsxXSkgLyBjdWJlTGVuZ3RoLCBncmlkU2l6ZSAtIDEpKTtcclxuXHRcdFx0bGV0IGl6ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oZ3JpZFNpemUgKiAoeiAtIGN1YmUubWluWzJdKSAvIGN1YmVMZW5ndGgsIGdyaWRTaXplIC0gMSkpO1xyXG5cclxuXHRcdFx0aXggPSBNYXRoLmZsb29yKGl4KTtcclxuXHRcdFx0aXkgPSBNYXRoLmZsb29yKGl5KTtcclxuXHRcdFx0aXogPSBNYXRoLmZsb29yKGl6KTtcclxuXHJcblx0XHRcdGxldCBjZWxsSW5kZXggPSBpeCB8IChpeSA8PCA4KSB8IChpeiA8PCAxNik7XHJcblx0XHRcdFxyXG5cdFx0XHRpZighc3BhcnNlR3JpZC5oYXMoY2VsbEluZGV4KSl7XHJcblx0XHRcdFx0c3BhcnNlR3JpZC5zZXQoY2VsbEluZGV4LCBbXSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHNwYXJzZUdyaWQuZ2V0KGNlbGxJbmRleCkucHVzaChpKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQga05lYXJlc3QgPSAocG9pbnRJbmRleCwgY2FuZGlkYXRlcywgbnVtTmVhcmVzdCkgPT4ge1xyXG5cdFx0XHRcclxuXHRcdFx0bGV0IHggPSBwb3NpdGlvbnNbMyAqIHBvaW50SW5kZXggKyAwXTtcclxuXHRcdFx0bGV0IHkgPSBwb3NpdGlvbnNbMyAqIHBvaW50SW5kZXggKyAxXTtcclxuXHRcdFx0bGV0IHogPSBwb3NpdGlvbnNbMyAqIHBvaW50SW5kZXggKyAyXTtcclxuXHJcblx0XHRcdGxldCBjYW5kaWRhdGVEaXN0YW5jZXMgPSBbXTtcclxuXHJcblx0XHRcdGZvcihsZXQgY2FuZGlkYXRlSW5kZXggb2YgY2FuZGlkYXRlcyl7XHJcblx0XHRcdFx0aWYoY2FuZGlkYXRlSW5kZXggPT09IHBvaW50SW5kZXgpe1xyXG5cdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRsZXQgY3ggPSBwb3NpdGlvbnNbMyAqIGNhbmRpZGF0ZUluZGV4ICsgMF07XHJcblx0XHRcdFx0bGV0IGN5ID0gcG9zaXRpb25zWzMgKiBjYW5kaWRhdGVJbmRleCArIDFdO1xyXG5cdFx0XHRcdGxldCBjeiA9IHBvc2l0aW9uc1szICogY2FuZGlkYXRlSW5kZXggKyAyXTtcclxuXHJcblx0XHRcdFx0bGV0IHNxdWFyZWREaXN0YW5jZSA9IChjeCAtIHgpICoqIDIgKyAoY3kgLSB5KSAqKiAyICsgKGN6IC0geikgKiogMjtcclxuXHJcblx0XHRcdFx0Y2FuZGlkYXRlRGlzdGFuY2VzLnB1c2goe2NhbmRpZGF0ZUluZGU6IGNhbmRpZGF0ZUluZGV4LCBzcXVhcmVkRGlzdGFuY2U6IHNxdWFyZWREaXN0YW5jZX0pO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRjYW5kaWRhdGVEaXN0YW5jZXMuc29ydCggKGEsIGIpID0+IGEuc3F1YXJlZERpc3RhbmNlIC0gYi5zcXVhcmVkRGlzdGFuY2UpO1xyXG5cdFx0XHRsZXQgbmVhcmVzdCA9IGNhbmRpZGF0ZURpc3RhbmNlcy5zbGljZSgwLCBudW1OZWFyZXN0KTtcclxuXHJcblx0XHRcdHJldHVybiBuZWFyZXN0O1xyXG5cdFx0fTtcclxuXHJcblx0XHRsZXQgbWVhbnNCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogNCk7XHJcblx0XHRsZXQgbWVhbnMgPSBuZXcgRmxvYXQzMkFycmF5KG1lYW5zQnVmZmVyKTtcclxuXHJcblx0XHRmb3IobGV0IFtrZXksIHZhbHVlXSBvZiBzcGFyc2VHcmlkKXtcclxuXHRcdFx0XHJcblx0XHRcdGZvcihsZXQgcG9pbnRJbmRleCBvZiB2YWx1ZSl7XHJcblxyXG5cdFx0XHRcdGlmKHZhbHVlLmxlbmd0aCA9PT0gMSl7XHJcblx0XHRcdFx0XHRtZWFuc1twb2ludEluZGV4XSA9IDA7XHJcblx0XHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGxldCBbaXgsIGl5LCBpel0gPSBbKGtleSAmIDI1NSksICgoa2V5ID4+IDgpICYgMjU1KSwgKChrZXkgPj4gMTYpICYgMjU1KV07XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly9sZXQgY2FuZGlkYXRlcyA9IHZhbHVlO1xyXG5cdFx0XHRcdGxldCBjYW5kaWRhdGVzID0gW107XHJcblx0XHRcdFx0Zm9yKGxldCBpIG9mIFstMSwgMCwgMV0pe1xyXG5cdFx0XHRcdFx0Zm9yKGxldCBqIG9mIFstMSwgMCwgMV0pe1xyXG5cdFx0XHRcdFx0XHRmb3IobGV0IGsgb2YgWy0xLCAwLCAxXSl7XHJcblx0XHRcdFx0XHRcdFx0bGV0IGNlbGxJbmRleCA9IChpeCArIGkpIHwgKChpeSArIGopIDw8IDgpIHwgKChpeiArIGspIDw8IDE2KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0aWYoc3BhcnNlR3JpZC5oYXMoY2VsbEluZGV4KSl7XHJcblx0XHRcdFx0XHRcdFx0XHRjYW5kaWRhdGVzLnB1c2goLi4uc3BhcnNlR3JpZC5nZXQoY2VsbEluZGV4KSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHJcblx0XHRcdFx0bGV0IG5lYXJlc3ROZWlnaGJvcnMgPSBrTmVhcmVzdChwb2ludEluZGV4LCBjYW5kaWRhdGVzLCAxMCk7XHJcblxyXG5cdFx0XHRcdGxldCBzdW0gPSAwO1xyXG5cdFx0XHRcdGZvcihsZXQgbmVpZ2hib3Igb2YgbmVhcmVzdE5laWdoYm9ycyl7XHJcblx0XHRcdFx0XHRzdW0gKz0gTWF0aC5zcXJ0KG5laWdoYm9yLnNxdWFyZWREaXN0YW5jZSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL2xldCBtZWFuID0gc3VtIC8gbmVhcmVzdE5laWdoYm9ycy5sZW5ndGg7XHJcblx0XHRcdFx0bGV0IG1lYW4gPSBNYXRoLnNxcnQoTWF0aC5tYXgoLi4ubmVhcmVzdE5laWdoYm9ycy5tYXAobiA9PiBuLnNxdWFyZWREaXN0YW5jZSkpKTtcclxuXHJcblx0XHRcdFx0aWYoTnVtYmVyLmlzTmFOKG1lYW4pKXtcclxuXHRcdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdH1cclxuXHJcblxyXG5cdFx0XHRcdG1lYW5zW3BvaW50SW5kZXhdID0gbWVhbjtcclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGxldCBtYXhNZWFuID0gTWF0aC5tYXgoLi4ubWVhbnMpO1xyXG5cdFx0bGV0IG1pbk1lYW4gPSBNYXRoLm1pbiguLi5tZWFucyk7XHJcblxyXG5cdFx0Ly9sZXQgY29sb3JzID0gbmV3IFVpbnQ4QXJyYXkoYXR0cmlidXRlQnVmZmVyc1tQb2ludEF0dHJpYnV0ZS5DT0xPUl9QQUNLRUQubmFtZV0uYnVmZmVyKTtcclxuXHRcdC8vZm9yKGxldCBpID0gMDsgaSA8IG51bVBvaW50czsgaSsrKXtcclxuXHRcdC8vXHRsZXQgdiA9IG1lYW5zW2ldIC8gMC4wNTtcclxuXHJcblx0XHQvL1x0Y29sb3JzWzQgKiBpICsgMF0gPSAyNTUgKiB2O1xyXG5cdFx0Ly9cdGNvbG9yc1s0ICogaSArIDFdID0gMjU1ICogdjtcclxuXHRcdC8vXHRjb2xvcnNbNCAqIGkgKyAyXSA9IDI1NSAqIHY7XHJcblx0XHQvL31cclxuXHJcblx0XHRhdHRyaWJ1dGVCdWZmZXJzW1BvaW50QXR0cmlidXRlLlNQQUNJTkcubmFtZV0gPSB7IGJ1ZmZlcjogbWVhbnNCdWZmZXIsIGF0dHJpYnV0ZTogUG9pbnRBdHRyaWJ1dGUuU1BBQ0lORyB9O1xyXG5cclxuXHJcblx0fVxyXG5cclxuXHJcblx0eyAvLyBhZGQgaW5kaWNlc1xyXG5cdFx0bGV0IGJ1ZmYgPSBuZXcgQXJyYXlCdWZmZXIobnVtUG9pbnRzICogNCk7XHJcblx0XHRsZXQgaW5kaWNlcyA9IG5ldyBVaW50MzJBcnJheShidWZmKTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG51bVBvaW50czsgaSsrKSB7XHJcblx0XHRcdGluZGljZXNbaV0gPSBpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRhdHRyaWJ1dGVCdWZmZXJzW1BvaW50QXR0cmlidXRlLklORElDRVMubmFtZV0gPSB7IGJ1ZmZlcjogYnVmZiwgYXR0cmlidXRlOiBQb2ludEF0dHJpYnV0ZS5JTkRJQ0VTIH07XHJcblx0fVxyXG5cclxuXHRwZXJmb3JtYW5jZS5tYXJrKFwiYmluYXJ5LWRlY29kZXItZW5kXCIpO1xyXG5cclxuXHQvL3sgLy8gcHJpbnQgdGltaW5nc1xyXG5cdC8vXHQvL3BlcmZvcm1hbmNlLm1lYXN1cmUoXCJzcGFjaW5nXCIsIFwic3BhY2luZy1zdGFydFwiLCBcInNwYWNpbmctZW5kXCIpO1xyXG5cdC8vXHRwZXJmb3JtYW5jZS5tZWFzdXJlKFwiYmluYXJ5LWRlY29kZXJcIiwgXCJiaW5hcnktZGVjb2Rlci1zdGFydFwiLCBcImJpbmFyeS1kZWNvZGVyLWVuZFwiKTtcclxuXHQvL1x0bGV0IG1lYXN1cmUgPSBwZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwibWVhc3VyZVwiKVswXTtcclxuXHQvL1x0bGV0IGRwcCA9IDEwMDAgKiBtZWFzdXJlLmR1cmF0aW9uIC8gbnVtUG9pbnRzO1xyXG5cdC8vXHRsZXQgZGVidWdNZXNzYWdlID0gYCR7bWVhc3VyZS5kdXJhdGlvbi50b0ZpeGVkKDMpfSBtcywgJHtudW1Qb2ludHN9IHBvaW50cywgJHtkcHAudG9GaXhlZCgzKX0gwrVzIC8gcG9pbnRgO1xyXG5cdC8vXHRjb25zb2xlLmxvZyhkZWJ1Z01lc3NhZ2UpO1xyXG5cdC8vfVxyXG5cclxuXHRwZXJmb3JtYW5jZS5jbGVhck1hcmtzKCk7XHJcblx0cGVyZm9ybWFuY2UuY2xlYXJNZWFzdXJlcygpO1xyXG5cclxuXHRsZXQgbWVzc2FnZSA9IHtcclxuXHRcdGJ1ZmZlcjogYnVmZmVyLFxyXG5cdFx0bWVhbjogbWVhbixcclxuXHRcdGF0dHJpYnV0ZUJ1ZmZlcnM6IGF0dHJpYnV0ZUJ1ZmZlcnMsXHJcblx0XHR0aWdodEJvdW5kaW5nQm94OiB7IG1pbjogdGlnaHRCb3hNaW4sIG1heDogdGlnaHRCb3hNYXggfSxcclxuXHRcdC8vZXN0aW1hdGVkU3BhY2luZzogZXN0aW1hdGVkU3BhY2luZyxcclxuXHR9O1xyXG5cclxuXHRsZXQgdHJhbnNmZXJhYmxlcyA9IFtdO1xyXG5cdGZvciAobGV0IHByb3BlcnR5IGluIG1lc3NhZ2UuYXR0cmlidXRlQnVmZmVycykge1xyXG5cdFx0dHJhbnNmZXJhYmxlcy5wdXNoKG1lc3NhZ2UuYXR0cmlidXRlQnVmZmVyc1twcm9wZXJ0eV0uYnVmZmVyKTtcclxuXHR9XHJcblx0dHJhbnNmZXJhYmxlcy5wdXNoKGJ1ZmZlcik7XHJcblxyXG5cdHBvc3RNZXNzYWdlKG1lc3NhZ2UsIHRyYW5zZmVyYWJsZXMpO1xyXG59O1xyXG4iXSwibmFtZXMiOlsiVmVyc2lvbiIsIltvYmplY3QgT2JqZWN0XSIsInZlcnNpb24iLCJ0aGlzIiwidm1MZW5ndGgiLCJpbmRleE9mIiwibGVuZ3RoIiwidmVyc2lvbk1ham9yIiwicGFyc2VJbnQiLCJzdWJzdHIiLCJ2ZXJzaW9uTWlub3IiLCJ2IiwibmV3ZXJUaGFuIiwiUG9pbnRBdHRyaWJ1dGVOYW1lcyIsIlBvaW50QXR0cmlidXRlVHlwZXMiLCJEQVRBX1RZUEVfRE9VQkxFIiwib3JkaW5hbCIsInNpemUiLCJEQVRBX1RZUEVfRkxPQVQiLCJEQVRBX1RZUEVfSU5UOCIsIkRBVEFfVFlQRV9VSU5UOCIsIkRBVEFfVFlQRV9JTlQxNiIsIkRBVEFfVFlQRV9VSU5UMTYiLCJEQVRBX1RZUEVfSU5UMzIiLCJEQVRBX1RZUEVfVUlOVDMyIiwiREFUQV9UWVBFX0lOVDY0IiwiREFUQV9UWVBFX1VJTlQ2NCIsImkiLCJvYmoiLCJQb2ludEF0dHJpYnV0ZSIsIm5hbWUiLCJ0eXBlIiwibnVtRWxlbWVudHMiLCJieXRlU2l6ZSIsIkN1c3RvbVZpZXciLCJidWZmZXIiLCJ1OCIsIlVpbnQ4QXJyYXkiLCJ0bXAiLCJBcnJheUJ1ZmZlciIsInRtcGYiLCJGbG9hdDMyQXJyYXkiLCJ0bXBkIiwiRmxvYXQ2NEFycmF5IiwidG1wdTgiLCJnZXRVaW50MzIiLCJnZXRVaW50MTYiLCJnZXRGbG9hdDMyIiwiZ2V0RmxvYXQ2NCIsImdldFVpbnQ4IiwiUE9TSVRJT05fQ0FSVEVTSUFOIiwiUkdCQV9QQUNLRUQiLCJDT0xPUl9QQUNLRUQiLCJSR0JfUEFDS0VEIiwiTk9STUFMX0ZMT0FUUyIsIkZJTExFUl8xQiIsIklOVEVOU0lUWSIsIkNMQVNTSUZJQ0FUSU9OIiwiTk9STUFMX1NQSEVSRU1BUFBFRCIsIk5PUk1BTF9PQ1QxNiIsIk5PUk1BTCIsIlJFVFVSTl9OVU1CRVIiLCJOVU1CRVJfT0ZfUkVUVVJOUyIsIlNPVVJDRV9JRCIsIklORElDRVMiLCJTUEFDSU5HIiwiR1BTX1RJTUUiLCJvbm1lc3NhZ2UiLCJldmVudCIsInBlcmZvcm1hbmNlIiwibWFyayIsImRhdGEiLCJwb2ludEF0dHJpYnV0ZXMiLCJudW1Qb2ludHMiLCJieXRlTGVuZ3RoIiwiY3YiLCJub2RlT2Zmc2V0Iiwib2Zmc2V0Iiwic2NhbGUiLCJ0aWdodEJveE1pbiIsInNwYWNpbmciLCJoYXNDaGlsZHJlbiIsIk51bWJlciIsIlBPU0lUSVZFX0lORklOSVRZIiwidGlnaHRCb3hNYXgiLCJORUdBVElWRV9JTkZJTklUWSIsIm1lYW4iLCJhdHRyaWJ1dGVCdWZmZXJzIiwiaW5PZmZzZXQiLCJwb2ludEF0dHJpYnV0ZSIsImF0dHJpYnV0ZXMiLCJidWZmIiwicG9zaXRpb25zIiwiaiIsIngiLCJ5IiwieiIsIk1hdGgiLCJtaW4iLCJtYXgiLCJhdHRyaWJ1dGUiLCJjb2xvcnMiLCJpbnRlbnNpdGllcyIsImludGVuc2l0eSIsImNsYXNzaWZpY2F0aW9ucyIsImNsYXNzaWZpY2F0aW9uIiwicmV0dXJuTnVtYmVycyIsInJldHVybk51bWJlciIsIm51bWJlck9mUmV0dXJucyIsIm51bWJlck9mUmV0dXJuIiwic291cmNlSURzIiwiVWludDE2QXJyYXkiLCJzb3VyY2VJRCIsIm5vcm1hbHMiLCJueCIsIm55IiwibnoiLCJsIiwic3FydCIsInUiLCJhYnMiLCJzaWduIiwiZ3BzdGltZXMiLCJncHN0aW1lIiwic291cmNlRjY0IiwidGFyZ2V0IiwidGFyZ2V0RjMyIiwiSW5maW5pdHkiLCJyYW5nZSIsImluZGljZXMiLCJVaW50MzJBcnJheSIsImNsZWFyTWFya3MiLCJjbGVhck1lYXN1cmVzIiwibWVzc2FnZSIsInRpZ2h0Qm91bmRpbmdCb3giLCJ0cmFuc2ZlcmFibGVzIiwicHJvcGVydHkiLCJwdXNoIiwicG9zdE1lc3NhZ2UiXSwibWFwcGluZ3MiOiJBQUNPLE1BQU1BLEVBRVpDLFlBQVlDLEdBQ1hDLEtBQUtELFFBQVVBLEVBQ2YsSUFBSUUsR0FBc0MsSUFBMUJGLEVBQVFHLFFBQVEsS0FBZUgsRUFBUUksT0FBU0osRUFBUUcsUUFBUSxLQUNoRkYsS0FBS0ksYUFBZUMsU0FBU04sRUFBUU8sT0FBTyxFQUFHTCxJQUMvQ0QsS0FBS08sYUFBZUYsU0FBU04sRUFBUU8sT0FBT0wsRUFBVyxJQUN0QixJQUE3QkQsS0FBS08sYUFBYUosU0FDckJILEtBQUtPLGFBQWUsR0FJdEJULFVBQVVDLEdBQ1QsSUFBSVMsRUFBSSxJQUFJWCxFQUFRRSxHQUVwQixPQUFJQyxLQUFLSSxhQUFlSSxFQUFFSixjQUVmSixLQUFLSSxlQUFpQkksRUFBRUosY0FBZ0JKLEtBQUtPLGFBQWVDLEVBQUVELGFBTzFFVCxjQUFjQyxHQUNiLElBQUlTLEVBQUksSUFBSVgsRUFBUUUsR0FFcEIsT0FBSUMsS0FBS0ksYUFBZUksRUFBRUosY0FFZkosS0FBS0ksZUFBaUJJLEVBQUVKLGNBQWdCSixLQUFLTyxjQUFnQkMsRUFBRUQsYUFPM0VULEtBQUtDLEdBQ0osT0FBUUMsS0FBS1MsVUFBVVYsSUNwQ2xCLE1BQU1XLEVBQ1EsRUFEUkEsRUFFRSxFQUZGQSxFQUtHLEVBTEhBLEVBTUosRUFOSUEsRUFPRCxFQVBDQSxFQVFJLEVBUkpBLEVBU1MsRUFUVEEsRUFVRSxFQVZGQSxFQVdKLEdBWElBLEVBWUcsR0FaSEEsRUFhTyxHQWJQQSxFQWNELEdBZENBLEVBZUgsR0FmR0EsRUFnQkgsR0FoQkdBLEVBaUJGLEdBU0xDLEVBQXNCLENBQzNCQyxpQkFBa0IsQ0FBQ0MsUUFBUyxFQUFHQyxLQUFNLEdBQ3JDQyxnQkFBaUIsQ0FBQ0YsUUFBUyxFQUFHQyxLQUFNLEdBQ3BD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",p=!1,L?E(I,J,p):function(l,t,i){var c;return function(d){return c=c||g(l,t,i),new Worker(c,d)}}(I,J,p));class T{constructor(l,t,i){this.version="string"==typeof l?new m(l):l,this.boundingBox=t,this.scale=i}load(l){return new Promise((t,i)=>{if(l.loaded)return;let c=l.getURL();this.version.equalOrHigher("1.4")&&(c+=".bin");let d=u.createXMLHttpRequest();d.open("GET",c,!0),d.responseType="arraybuffer",d.overrideMimeType("text/plain; charset=x-user-defined"),d.onreadystatechange=()=>{if(4===d.readyState){if(200!==d.status&&0!==d.status||null===d.response)throw new Error(`Failed to load file! HTTP status: ${d.status}, file: ${c}`);{let i=d.response;this.parse(l,i).then(()=>{t()})}}};try{d.send(null)}catch(l){console.log("fehler beim laden der punktwolke: "+l)}})}parse(l,t){return new Promise((i,c)=>{let d=l.pcoGeometry.pointAttributes,e=W,s=G.getWorker(e);const n=this.version;s.onmessage=function(t){G.returnWorker(e,s);let c=t.data;l.parse(c,n),i()};let F={buffer:t,pointAttributes:d,version:this.version.version,min:[l.boundingBox.min.x,l.boundingBox.min.y,l.boundingBox.min.z],offset:[l.pcoGeometry.offset.x,l.pcoGeometry.offset.y,l.pcoGeometry.offset.z],scale:this.scale,spacing:l.spacing,hasChildren:l.hasChildren,name:l.name};s.postMessage(F,[F.buffer])})}}class C extends d{constructor(){super(),this.pointBudget=5e6,this.minimumNodeVSize=.2,this.level=0,this.visibleNodes=[],this.loaded=!1,this.addParameter(new e("Num Points",0)),this.addParameter(new e("Point Size",1)),this.addParameter(new e("Point Size Attenuation",1))}getGlobalMat4(){return this.getParameter("GlobalXfo").getValue().toMat4()}_cleanBoundingBox(t){t=super._cleanBoundingBox(t);const i=this.getGlobalMat4(),c=new l,{min:d,max:e}=this.pcoGeometry.tightBoundingBox;return c.min.set(d.x,d.y,d.z),c.max.set(e.x,e.y,e.z),t.addBox3(c,i),t}setGeometry(l){this.pcoGeometry=l;const t=this.getParameter("GlobalXfo").getValue();t.tr=this.pcoGeometry.offset,this.getParameter("GlobalXfo").setValue(t),l.numPoints&&this.getParameter("Num Points").setValue(l.numPoints),this.loaded=!1,this.emit("loaded")}getGeometry(){return this.pcoGeometry}loadPointCloud(t,i){return new Promise((i,d)=>{(class{static load(t,i){try{let d=new r;d.url=t;let e=u.createXMLHttpRequest();e.open("GET",t,!0),e.onreadystatechange=function(){if(4===e.readyState&&(200===e.status||0===e.status)){let s=JSON.parse(e.responseText),n=new m(s.version);0===s.octreeDir.indexOf("http")?d.octreeDir=s.octreeDir:d.octreeDir=t+"/../"+s.octreeDir,d.numPoints=s.points,d.spacing=s.spacing,d.hierarchyStepSize=s.hierarchyStepSize,d.pointAttributes=s.pointAttributes;let F=new c(s.boundingBox.lx,s.boundingBox.ly,s.boundingBox.lz),U=new c(s.boundingBox.ux,s.boundingBox.uy,s.boundingBox.uz),X=new l(F,U),Q=X.clone();s.tightBoundingBox&&(Q.min.set(s.tightBoundingBox.lx,s.tightBoundingBox.ly,s.tightBoundingBox.lz),Q.max.set(s.tightBoundingBox.ux,s.tightBoundingBox.uy,s.tightBoundingBox.uz));let R=F.clone();X.min.subtractInPlace(R),X.max.subtractInPlace(R),Q.min.subtractInPlace(R),Q.max.subtractInPlace(R),d.projection=s.projection,d.boundingBox=X,d.tightBoundingBox=Q,d.boundingSphere=X.getBoundingSphere(),d.tightBoundingSphere=Q.getBoundingSphere(),d.offset=R,"LAS"===s.pointAttributes||"LAZ"===s.pointAttributes?d.loader=new Z(s.version):(d.loader=new T(s.version,X,s.scale),d.pointAttributes=new a(d.pointAttributes));let x={};{let l="r",t=new H(l,d,X);t.level=0,t.hasChildren=!0,t.spacing=d.spacing,n.upTo("1.5")?t.numPoints=s.hierarchy[0][1]:t.numPoints=0,d.root=t,d.root.load(),x[l]=t}if(n.upTo("1.4"))for(let l=1;l<s.hierarchy.length;l++){let t=s.hierarchy[l][0],i=s.hierarchy[l][1],c=parseInt(t.charAt(t.length-1)),e=x[t.substring(0,t.length-1)],n=t.length-1,F=b.createChildAABB(e.boundingBox,c),U=new H(t,d,F);U.level=n,U.numPoints=i,U.spacing=d.spacing/Math.pow(2,n),e.addChild(U),x[t]=U}d.nodes=x,i(d)}},e.send(null)}catch(l){console.log("loading failed: '"+t+"'"),console.log(l),i()}}loadPointAttributes(l){let t=l.pointAttributes,i=new a;for(let l=0;l<t.length;l++){let c=o[t[l]];i.add(c)}return i}createChildAABB(t,i){let c=t.min.clone(),d=t.max.clone(),e=d.subtract(c);return(1&i)>0?c.z+=e.z/2:d.z-=e.z/2,(2&i)>0?c.y+=e.y/2:d.y-=e.y/2,(4&i)>0?c.x+=e.x/2:d.x-=e.x/2,new l(c,d)}}).load(t,l=>{l?(this.setGeometry(l),i(l)):d("failed to load point cloud from URL: "+t)})})}}s.register("PointCloudAsset",C);let N=0;class M extends F{constructor(l,t){super(l,t.points),this.node=t,this.id=++N,this.loaded=!0,this.children=[]}get numPoints(){return this.node.numPoints}dispose(){this.destroy()}}class Y extends n{constructor(l,t,i){super(),this.gl=l,this.pointcloudAsset=t;const c=t.getParameter("GlobalXfo"),d=()=>{const l=c.getValue();this.spacing=t.pcoGeometry.spacing*Math.max(l.sc.x,l.sc.y,l.sc.z),this.modelMatrixArray=l.toMat4().asArray()};c.on("valueChanged",d),d(),this.visible=t.isVisible(),t.on("visibilityChanged",()=>{this.visible=t.isVisible(),this.emit("updated")}),this.octreeSize=t.pcoGeometry.boundingBox.size().x,this.pointSize=t.getParameter("Point Size").getValue(),t.getParameter("Point Size").on("valueChanged",()=>{this.pointSize=t.getParameter("Point Size").getValue(),this.emit("updated")}),this.pointSizeAttenuation=t.getParameter("Point Size Attenuation").getValue(),t.getParameter("Point Size Attenuation").on("valueChanged",()=>{this.pointSizeAttenuation=t.getParameter("Point Size").getValue(),this.emit("updated")}),this.visibleNodes=[],this.visibleGLNodes=[],this.gloctreenodes=[],this.map=new Map,this.freeList=[]}setVisibleNodes(l,t,i){let c=this.visibleNodes.length!=l.length;if(c||(c=l.some((l,t)=>this.visibleNodes[t]!=l)),c){const c=this.gl;this.visibleGLNodes=[];for(let d=l.length-1;d>=0;d--){const e=l[d];if(!this.map.has(e)){const l=new M(c,e),t=this.freeList.length>0?this.freeList.pop():this.gloctreenodes.length;this.gloctreenodes[t]=l,this.map.set(e,t),l.on("destructing",()=>{this.map.delete(e),this.freeList.push(t),this.gloctreenodes[t]=null;const i=this.visibleGLNodes.indexOf(l);i>=0&&this.visibleGLNodes.splice(i,1)})}const s=this.gloctreenodes[this.map.get(e)];this.visibleGLNodes.push(s),s.vnStart=i.get(e),t.touch(s)}this.emit("updated")}}getGeomItem(){return this.pointcloudAsset}__drawNodes(l){const t=this.gl,{unifs:i}=l,{modelMatrix:c,offset:d,uOctreeSize:e,uOctreeSpacing:s,uVNStart:n,uLevel:F,PointSize:U,PointSizeAttenuation:X}=i;t.uniformMatrix4fv(c.location,!1,this.modelMatrixArray),e&&t.uniform1f(e.location,this.octreeSize),s&&t.uniform1f(s.location,this.spacing),t.uniform1f(U.location,this.pointSize),t.uniform1f(X.location,this.pointSizeAttenuation),this.visibleGLNodes.forEach(c=>{const e=c.node;t.uniform3fv(d.location,e.offset.asArray()),n&&t.uniform1i(n.location,c.vnStart),F&&t.uniform1f(F.location,e.level),c.bind(l),l.bindViewports(i,()=>{c.draw(l)})})}draw(l){0!=this.visibleGLNodes.length&&this.visible&&this.__drawNodes(l)}drawHighlightedGeoms(l){if(0==this.visibleGLNodes.length||!this.visible)return;const t=this.gl,{highlightColor:i}=l.unifs;i&&t.uniform4fv(i.location,this.pointcloudAsset.getHighlight().asArray()),this.__drawNodes(l)}drawGeomData(l){0!=this.visibleGLNodes.length&&this.visible&&this.__drawNodes(l)}}function k(l){this.content=[],this.scoreFunction=l}k.prototype={push:function(l){this.content.push(l),this.bubbleUp(this.content.length-1)},pop:function(){var l=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.sinkDown(0)),l},remove:function(l){for(var t=this.content.length,i=0;i<t;i++)if(this.content[i]==l){var c=this.content.pop();if(i==t-1)break;this.content[i]=c,this.bubbleUp(i),this.sinkDown(i);break}},size:function(){return this.content.length},bubbleUp:function(l){for(var t=this.content[l],i=this.scoreFunction(t);l>0;){var c=Math.floor((l+1)/2)-1,d=this.content[c];if(i>=this.scoreFunction(d))break;this.content[c]=t,this.content[l]=d,l=c}},sinkDown:function(l){for(var t=this.content.length,i=this.content[l],c=this.scoreFunction(i);;){var d=2*(l+1),e=d-1,s=null;if(e<t){var n=this.content[e],F=this.scoreFunction(n);F<c&&(s=e)}if(d<t){var U=this.content[d];this.scoreFunction(U)<(null==s?c:F)&&(s=d)}if(null==s)break;this.content[l]=this.content[s],this.content[s]=i,l=s}}};class D extends U{constructor(l){super(l),this.__shaderStages.VERTEX_SHADER=X.parseShader("PointsShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec3 positions;\ninstancedattribute vec4 colors;\n\nuniform vec3 offset;\nuniform float uOctreeSize;\nuniform int uVNStart;\nuniform float uLevel;\nuniform float uOctreeSpacing;\nuniform sampler2D visibleNodes;\n\n\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform float PointSizeAttenuation;\nuniform float PointSize;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec4 v_color;\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\n\n// ---------------------\n// OCTREE\n// ---------------------\n\n/**\n * number of 1-bits up to inclusive index position\n * number is treated as if it were an integer in the range 0-255\n *\n */\nint numberOfOnes(int number, int index){\n    int numOnes = 0;\n    int tmp = 128;\n    for(int i = 7; i >= 0; i--){\n        \n        if(number >= tmp){\n            number = number - tmp;\n\n            if(i <= index){\n                numOnes++;\n            }\n        }\n        \n        tmp = tmp / 2;\n    }\n\n    return numOnes;\n}\n\n\n/**\n * checks whether the bit at index is 1\n * number is treated as if it were an integer in the range 0-255\n *\n */\nbool isBitSet(int number, int index){\n\n    // weird multi else if due to lack of proper array, int and bitwise support in WebGL 1.0\n    int powi = 1;\n    if(index == 0){\n        powi = 1;\n    }else if(index == 1){\n        powi = 2;\n    }else if(index == 2){\n        powi = 4;\n    }else if(index == 3){\n        powi = 8;\n    }else if(index == 4){\n        powi = 16;\n    }else if(index == 5){\n        powi = 32;\n    }else if(index == 6){\n        powi = 64;\n    }else if(index == 7){\n        powi = 128;\n    }else{\n        return false;\n    }\n\n    int ndp = number / powi;\n\n    return mod(float(ndp), 2.0) != 0.0;\n}\n\n\n/**\n * find the LOD at the point position\n */\nfloat getLOD(vec3 position){\n    \n    vec3 offset = vec3(0.0, 0.0, 0.0);\n    int iOffset = uVNStart;\n    float depth = uLevel;\n    for(float i = 0.0; i <= 30.0; i++){\n        float nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n        \n        vec3 index3d = (position-offset) / nodeSizeAtLevel;\n        index3d = floor(index3d + 0.5);\n        int index = int(round(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n        \n        vec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n        int mask = int(round(value.r * 255.0));\n\n        if(isBitSet(mask, index)){\n            // there are more visible child nodes at this position\n            int advanceG = int(round(value.g * 255.0)) * 256;\n            int advanceB = int(round(value.b * 255.0));\n            int advanceChild = numberOfOnes(mask, index - 1);\n            int advance = advanceG + advanceB + advanceChild;\n\n            iOffset = iOffset + advance;\n            \n            depth++;\n        }else{\n            // no more visible child nodes at this position\n            return value.a * 255.0;\n            //return depth;\n        }\n        \n        offset = offset + (nodeSizeAtLevel * 0.5) * index3d;\n    }\n    \n        \n    return depth;\n}\n\nfloat getPointSizeAttenuation(vec3 position){\n  float lod = getLOD(position);\n  // v_color = vec4(0.0, 0.0, 0.0, 1.0);\n  // v_color.r = lod / 5.0;\n  return mix(1.0, pow(2.0, lod), PointSizeAttenuation);\n}\n\n\nfloat getPointSize(vec3 position){\n\t\n\tfloat r = uOctreeSpacing * PointSize;\n  \n  float pointSize = r / getPointSizeAttenuation(position);\n\n\t// pointSize = clamp(pointSize, minSize, maxSize);\n\t\n\treturn pointSize;\n}\n\n\nvoid main(void) {\n  v_color = colors / 255.0; // Unsigned byte attributes need to be scaled down from 0-255 > 0..1\n  \n  vec2 quadPointPos = getQuadVertexPositionFromID();\n  v_texCoord = quadPointPos + 0.5;\n\n  vec4 pos = vec4(positions + offset, 1.);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  vec4 viewPos = modelViewMatrix * pos;\n\n\tfloat pointSize = getPointSize(positions);\n\n  viewPos += vec4(vec3(quadPointPos, 0.0) * pointSize, 0.);\n  v_viewPos = -viewPos.xyz;\n\n  gl_Position = projectionMatrix * viewPos;\n\n//   gl_PointSize = PointSize;\n\n}\n'),this.__shaderStages.FRAGMENT_SHADER=X.parseShader("PointsShader.fragmentShader","\nprecision highp float;\n\nuniform color BaseColor;\n\n/* VS Outputs */\nvarying vec4 v_color;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  if(length(v_texCoord - 0.5) > 0.5)\n    discard;\n\n  fragColor = v_color;\n  fragColor.a = 1.0;\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n")}static getGeomDataShaderName(){return"PotreePointsGeomDataShader"}static getSelectedShaderName(){return"PotreePointsHilighlightShader"}}s.register("PotreePointsShader",D);class f extends D{constructor(l){super(l),this.__shaderStages.FRAGMENT_SHADER=X.parseShader("PointsShader.fragmentShader","\nprecision highp float;\n\nuniform int passId;\nuniform int assetId;\n\n/* VS Outputs */\nvarying vec4 v_color;\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  if(length(v_texCoord - 0.5) > 0.5)\n    discard;\n\n  float dist = length(v_viewPos);\n\n  fragColor.r = float(passId); \n  fragColor.g = float(assetId);\n  fragColor.b = 0.0;// TODO: store poly-id or something.\n  fragColor.a = dist;\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n")}}s.register("PotreePointsGeomDataShader",f);class v extends D{constructor(l){super(l),this.__shaderStages.FRAGMENT_SHADER=X.parseShader("PointsShader.fragmentShader","\nprecision highp float;\n\nuniform color highlightColor;\n\n/* VS Outputs */\nvarying vec4 v_color;\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  if(length(v_texCoord - 0.5) > 0.5)\n    discard;\n\n  fragColor = highlightColor;\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n")}}s.register("PotreePointsHilighlightShader",v);class A{constructor(l){this.previous=null,this.next=null,this.node=l}}class z{constructor(){this.first=null,this.last=null,this.items={},this.elements=0,this.numPoints=0,this.pointLoadLimit=0}size(){return this.elements}contains(l){return null==this.items[l.id]}touch(l){if(!l.loaded)return;let t;null==this.items[l.id]?(t=new A(l),t.previous=this.last,this.last=t,null!==t.previous&&(t.previous.next=t),this.items[l.id]=t,this.elements++,null===this.first&&(this.first=t),this.numPoints+=l.numPoints):(t=this.items[l.id],null===t.previous?null!==t.next&&(this.first=t.next,this.first.previous=null,t.previous=this.last,t.next=null,this.last=t,t.previous.next=t):null===t.next||(t.previous.next=t.next,t.next.previous=t.previous,t.previous=this.last,t.next=null,this.last=t,t.previous.next=t))}remove(l){let t=this.items[l.id];t&&(1===this.elements?(this.first=null,this.last=null):(t.previous||(this.first=t.next,this.first.previous=null),t.next||(this.last=t.previous,this.last.next=null),t.previous&&t.next&&(t.previous.next=t.next,t.next.previous=t.previous)),delete this.items[l.id],this.elements--,this.numPoints-=l.numPoints)}getLRUItem(){if(null===this.first)return null;return this.first.node}toString(){let l="{ ",t=this.first;for(;null!==t;)l+=t.node.id,null!==t.next&&(l+=", "),t=t.next;return l+="}",l+="("+this.size()+")",l}freeMemory(){if(!(this.elements<=1))for(;this.numPoints>this.pointLoadLimit;){let l=this.first.node;this.disposeDescendants(l)}}disposeDescendants(l){let t=[];for(t.push(l);t.length>0;){let l=t.pop();l.dispose(),this.remove(l);for(let i in l.children)if(l.children.hasOwnProperty(i)){l.children[i].loaded&&t.push(l.children[i])}}}}class P extends n{constructor(){super(),this.visiblePointsTarget=2e6,this.lru=new z,this.minimumNodeVSize=.2,this.glpointcloudAssets=[],this.hilghlightedAssets=[],this.visibleNodesNeedUpdating=!1;const l=this.addParameter(new e("minimumNodeVSize",0));l.on("valueChanged",()=>{this.minimumNodeVSize=l.getValue()});const t=this.addParameter(new e("visiblePointsTarget",0));t.on("valueChanged",()=>{this.pointBudget=t.getValue(),this.lru.pointLoadLimit=2*this.pointBudget}),l.setValue(.2),t.setValue(2e6)}init(l,t){super.init(l,t);const i=l.gl;this.glshader=new D(i),this.glgeomdataShader=new f(i),this.glhighlightShader=new v(i);const c=new Uint8Array(8192);for(let l=0;l<8192;l++)c[l]=255;this.visibleNodesTexture=new Q(i,{format:"RGBA",type:"UNSIGNED_BYTE",width:2048,height:1,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1,data:c}),this.__renderer.registerPass(l=>l instanceof C&&(this.addPotreeasset(l),!0),l=>l instanceof C&&(this.removePotreeasset(l),!0)),this.setViewport(l.getViewport())}addPotreeasset(l){const t=l=>{const t=new Y(this.__gl,l,this.glshader);t.on("updated",()=>this.emit("updated")),l.on("highlightChanged",()=>{l.isHighlighted()?-1==this.hilghlightedAssets.indexOf(t)&&this.hilghlightedAssets.push(t):-1!=this.hilghlightedAssets.indexOf(t)&&this.hilghlightedAssets.splice(this.hilghlightedAssets.indexOf(t),1)}),this.glpointcloudAssets.push(t)};l.isLoaded()?t(l):l.on("loaded",()=>t(l))}removePotreeasset(l){}setViewport(l){this.viewport=l,this.viewport.on("viewChanged",()=>{this.visibleNodesNeedUpdating=!0}),this.viewport.on("resized",()=>{this.visibleNodesNeedUpdating=!0}),this.visibleNodesNeedUpdating=!0}updateVisibilityStructures(l){const t=this.viewport.getCamera().getParameter("GlobalXfo").getValue().toMat4(),i=this.viewport.getViewMatrix(),c=this.viewport.getProjectionMatrix().multiply(i),d=[];return this.glpointcloudAssets.forEach((i,e)=>{const s=i.getGeomItem(),n=s.getGlobalMat4(),F=c.multiply(n),U=new R;U.setFromMatrix(F);const X=n.inverse().multiply(t).translation;s.isVisible()&&null!==s.pcoGeometry&&l.push({index:e,node:s.pcoGeometry.root,weight:Number.MAX_VALUE}),d.push({glpointcloudAsset:i,frustum:U,camObjPos:X})}),d}updateVisibility(){const l=new k((function(l){return 1/l.weight})),t=this.viewport.getCamera();this.numVisiblePoints=0;let i=0;const c=[];let d=[];const e=[],s=this.updateVisibilityStructures(l);for(;l.size()>0;){const n=l.pop(),F=n.index,U=n.node;if(i+U.numPoints>this.pointBudget)break;if(!s[F].frustum.intersectsBox(U.boundingBox))continue;i+=U.numPoints,this.numVisiblePoints+=U.numPoints;const X=n.parent;X&&!X.isLoaded()||(U.isLoaded()?(c[F]||(c[F]=[]),c[F].push(U),d.push(U)):e.push(U));const Q=s[F].camObjPos,R=U.getChildren();for(let i=0;i<R.length;i++){const c=R[i];let d=0;{const l=c.getBoundingSphere(),i=l.pos.distanceTo(Q),e=l.radius;if(i-e<0)d=Number.MAX_VALUE;else{const l=t.getFov(),c=e*(.5/(Math.tan(l/2)*i));if(c<this.minimumNodeVSize)continue;d=c}}l.push({index:F,node:c,parent:U,weight:d})}}const n=this.computeVisibilityTextureData(d);if(c.forEach((l,t)=>{this.glpointcloudAssets[t].setVisibleNodes(l,this.lru,n)}),e.length>0){const l=[];for(let t=0;t<e.length;t++)l.push(e[t].load());l.length>0&&Promise.all(l).then(()=>{this.visibleNodesNeedUpdating=!0,this.emit("updated")})}this.lru.freeMemory()}computeVisibilityTextureData(l){const t=new Uint8Array(4*l.length),i=new Map;(l=l.slice()).sort((function(l,t){const i=l.name,c=t.name;return i.length!==c.length?i.length-c.length:i<c?-1:i>c?1:0}));const c=new Array(l.length).fill(1/0);for(let d=0;d<l.length;d++){const e=l[d];if(i.set(e,d),d>0){const l=e.index,s=e.parent,n=i.get(s),F=d-n,U=Math.min(c[n],F);t[4*n+0]=t[4*n+0]|1<<l,t[4*n+1]=U>>8,t[4*n+2]=U%256,c[n]=U}t[4*d+3]=e.name.length-1}return this.visibleNodesTexture.populate(t,l.length,1),i}draw(l){if(0==this.glpointcloudAssets.length)return;this.visibleNodesNeedUpdating&&(this.updateVisibility(),this.visibleNodesNeedUpdating=!1);const t=this.__gl;t.disable(t.BLEND),t.depthMask(!0),t.enable(t.DEPTH_TEST),this.glshader.bind(l);const{visibleNodes:i}=l.unifs;i&&this.visibleNodesTexture.bindToUniform(l,i),this.glpointcloudAssets.forEach(t=>t.draw(l))}drawHighlightedGeoms(l){if(0==this.hilghlightedAssets.length)return;const t=this.__gl;t.disable(t.BLEND),t.depthMask(!0),t.enable(t.DEPTH_TEST),this.glhighlightShader.bind(l);const{visibleNodes:i,PointSize:c}=l.unifs;i&&this.visibleNodesTexture.bindToUniform(l,i),t.uniform1f(c.location,this.pointSize),this.hilghlightedAssets.forEach(t=>t.drawHighlightedGeoms(l))}drawGeomData(l){if(0==this.glpointcloudAssets.length)return;const t=this.__gl;t.disable(t.BLEND),t.depthMask(!0),t.enable(t.DEPTH_TEST),this.glgeomdataShader.bind(l);const{visibleNodes:i,PointSize:c}=l.unifs;i&&this.visibleNodesTexture.bindToUniform(l,i),t.uniform1f(c.location,this.pointSize),this.glpointcloudAssets.forEach((i,c)=>{const{passId:d,assetId:e}=l.unifs;d&&t.uniform1i(d.location,this.__passIndex),e&&t.uniform1i(e.location,c),i.drawGeomData(l)})}getGeomItemAndDist(l){const t=Math.round(l[1]),i=l[3],c=this.glpointcloudAssets[t];if(c)return{geomItem:c.getGeomItem(),dist:i}}}const w={major:1,minor:6,suffix:""};console.log("ZeaPotree "+w.major+"."+w.minor+w.suffix);export{P as GLPointCloudPass,C as PointCloudAsset,w as version};
