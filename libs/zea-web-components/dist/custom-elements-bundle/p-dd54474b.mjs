const NAMESPACE="zeainc-zea-web-components";let scopeId,contentRef,hostTagName,useNativeShadowDom=!1,checkSlotFallbackVisibility=!1,checkSlotRelocate=!1,isSvgMode=!1,queueCongestion=0,queuePending=!1;const win="undefined"!=typeof window?window:{},doc=win.document||{head:{}},plt={G:0,X:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,n)=>t.addEventListener(e,i,n),rel:(t,e,i,n)=>t.removeEventListener(e,i,n)},supportsShadow=(()=>(doc.head.attachShadow+"").indexOf("[native")>-1)(),promiseResolve=t=>Promise.resolve(t),supportsConstructibleStylesheets=(()=>{try{return new CSSStyleSheet,!0}catch(e){}return!1})(),addHostEventListeners=(t,e,i,n)=>{i&&(i=i.filter(n?([t])=>16&t:([t])=>!(16&t))).map(([i,n,s])=>{const o=getHostListenerTarget(t,i),r=hostListenerProxy(e,s),a=hostListenerOpts(i);plt.ael(o,n,r,a),(e.V=e.V||[]).push(()=>plt.rel(o,n,r,a))})},hostListenerProxy=(t,e)=>i=>{t.I[e](i)},getHostListenerTarget=(t,e)=>4&e?doc:8&e?win:32&e?doc.body:16&e?t.parentElement:t,hostListenerOpts=t=>0!=(2&t),XLINK_NS="http://www.w3.org/1999/xlink",createTime=()=>()=>{},rootAppliedStyles=new WeakMap,registerStyle=(t,e,i)=>{let n=styles.get(t);supportsConstructibleStylesheets&&i?(n=n||new CSSStyleSheet,n.replace(e)):n=e,styles.set(t,n)},addStyle=(t,e,i)=>{let n=getScopeId(e.W,i),s=styles.get(n);if(t=11===t.nodeType?t:doc,s||(n=getScopeId(e.W),s=styles.get(n)),s)if("string"==typeof s){let e,i=rootAppliedStyles.get(t=t.head||t);i||rootAppliedStyles.set(t,i=new Set),i.has(n)||(e=doc.createElement("style"),e.innerHTML=s,t.insertBefore(e,t.querySelector("link")),i&&i.add(n))}else t.adoptedStyleSheets.includes(s)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,s]);return n},attachStyles=t=>{const e=t.F,i=t.I,n=e.G,s=createTime("attachStyles",e.W),o=addStyle(supportsShadow&&i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.T);10&n&&(i["s-sc"]=o,i.classList.add(o+"-h"),2&n&&i.classList.add(o+"-s")),s()},getScopeId=(t,e)=>"sc-"+(e?t+"-"+e:t),computeMode=t=>modeResolutionChain.map(e=>e(t)).find(t=>!!t),setMode=t=>modeResolutionChain.push(t),getMode=t=>getHostRef(t).T,EMPTY_OBJ={},SVG_NS="http://www.w3.org/2000/svg",HTML_NS="http://www.w3.org/1999/xhtml",isDef=t=>null!=t,isComplexType=t=>"object"==(t=typeof t)||"function"===t,h=(t,e,...i)=>{let n=null,s=null,o=null,r=!1,a=!1,l=[];const c=e=>{for(let i=0;i<e.length;i++)n=e[i],Array.isArray(n)?c(n):null!=n&&"boolean"!=typeof n&&((r="function"!=typeof t&&!isComplexType(n))&&(n=String(n)),r&&a?l[l.length-1].Y+=n:l.push(r?newVNode(null,n):n),a=r)};if(c(i),e){e.key&&(s=e.key),e.name&&(o=e.name);{const t=e.className||e.class;t&&(e.class="object"!=typeof t?t:Object.keys(t).filter(e=>t[e]).join(" "))}}if("function"==typeof t)return t(null===e?{}:e,l,vdomFnUtils);const h=newVNode(t,null);return h.K=e,l.length>0&&(h.J=l),h.U=s,h.A=o,h},newVNode=(t,e)=>({G:0,D:t,Y:e,O:null,J:null,K:null,U:null,A:null}),Host={},isHost=t=>t&&t.D===Host,vdomFnUtils={forEach:(t,e)=>t.map(convertToPublic).forEach(e),map:(t,e)=>t.map(convertToPublic).map(e).map(convertToPrivate)},convertToPublic=t=>({vattrs:t.K,vchildren:t.J,vkey:t.U,vname:t.A,vtag:t.D,vtext:t.Y}),convertToPrivate=t=>{const e=newVNode(t.vtag,t.vtext);return e.K=t.vattrs,e.J=t.vchildren,e.U=t.vkey,e.A=t.vname,e},setAccessor=(t,i,n,s,o,r)=>{if(n!==s){let a=isMemberInElement(t,i),l=i.toLowerCase();if("class"===i){const e=t.classList,i=parseClassList(n),o=parseClassList(s);e.remove(...i.filter(t=>t&&!o.includes(t))),e.add(...o.filter(t=>t&&!i.includes(t)))}else if("style"===i){for(const e in n)s&&null!=s[e]||(e.includes("-")?t.style.removeProperty(e):t.style[e]="");for(const e in s)n&&s[e]===n[e]||(e.includes("-")?t.style.setProperty(e,s[e]):t.style[e]=s[e])}else if("key"===i);else if("ref"===i)s&&s(t);else if(t.__lookupSetter__(i)||"o"!==i[0]||"n"!==i[1]){const c=isComplexType(s);if((a||c&&null!==s)&&!o)try{if(t.tagName.includes("-"))t[i]=s;else{let e=null==s?"":s;"list"===i?a=!1:null!=n&&t[i]==e||(t[i]=e)}}catch(e){}let h=!1;l!==(l=l.replace(/^xlink\:?/,""))&&(i=l,h=!0),null==s||!1===s?h?t.removeAttributeNS(XLINK_NS,i):t.removeAttribute(i):(!a||4&r||o)&&!c&&(s=!0===s?"":s,h?t.setAttributeNS(XLINK_NS,i,s):t.setAttribute(i,s))}else i="-"===i[2]?i.slice(3):isMemberInElement(win,l)?l.slice(2):l[2]+i.slice(3),n&&plt.rel(t,i,n,!1),s&&plt.ael(t,i,s,!1)}},parseClassListRegex=/\s/,parseClassList=t=>t?t.split(parseClassListRegex):[],updateElement=(t,e,i,n)=>{const s=11===e.O.nodeType&&e.O.host?e.O.host:e.O,o=t&&t.K||EMPTY_OBJ,r=e.K||EMPTY_OBJ;for(n in o)n in r||setAccessor(s,n,o[n],void 0,i,e.G);for(n in r)setAccessor(s,n,o[n],r[n],i,e.G)},createElm=(t,e,i,n)=>{let s,o,r,a=e.J[i],l=0;if(useNativeShadowDom||(checkSlotRelocate=!0,"slot"===a.D&&(scopeId&&n.classList.add(scopeId+"-s"),a.G|=a.J?2:1)),null!==a.Y)s=a.O=doc.createTextNode(a.Y);else if(1&a.G)s=a.O=doc.createTextNode("");else{if(isSvgMode||(isSvgMode="svg"===a.D),s=a.O=doc.createElementNS(isSvgMode?SVG_NS:HTML_NS,2&a.G?"slot-fb":a.D),isSvgMode&&"foreignObject"===a.D&&(isSvgMode=!1),updateElement(null,a,isSvgMode),isDef(scopeId)&&s["s-si"]!==scopeId&&s.classList.add(s["s-si"]=scopeId),a.J)for(l=0;l<a.J.length;++l)o=createElm(t,a,l,s),o&&s.appendChild(o);"svg"===a.D?isSvgMode=!1:"foreignObject"===s.tagName&&(isSvgMode=!0)}return s["s-hn"]=hostTagName,3&a.G&&(s["s-sr"]=!0,s["s-cr"]=contentRef,s["s-sn"]=a.A||"",r=t&&t.J&&t.J[i],r&&r.D===a.D&&t.O&&putBackInOriginalLocation(t.O,!1)),s},putBackInOriginalLocation=(t,e)=>{plt.G|=1;const i=t.childNodes;for(let n=i.length-1;n>=0;n--){const t=i[n];t["s-hn"]!==hostTagName&&t["s-ol"]&&(parentReferenceNode(t).insertBefore(t,referenceNode(t)),t["s-ol"].remove(),t["s-ol"]=void 0,checkSlotRelocate=!0),e&&putBackInOriginalLocation(t,e)}plt.G&=-2},addVnodes=(t,e,i,n,s,o)=>{let r,a=t["s-cr"]&&t["s-cr"].parentNode||t;for(a.shadowRoot&&a.tagName===hostTagName&&(a=a.shadowRoot);s<=o;++s)n[s]&&(r=createElm(null,i,s,t),r&&(n[s].O=r,a.insertBefore(r,referenceNode(e))))},removeVnodes=(t,e,i,n,s)=>{for(;e<=i;++e)(n=t[e])&&(s=n.O,callNodeRefs(n),checkSlotFallbackVisibility=!0,s["s-ol"]?s["s-ol"].remove():putBackInOriginalLocation(s,!0),s.remove())},updateChildren=(t,e,i,n)=>{let s,o,r=0,a=0,l=0,c=0,h=e.length-1,d=e[0],u=e[h],m=n.length-1,p=n[0],b=n[m];for(;r<=h&&a<=m;)if(null==d)d=e[++r];else if(null==u)u=e[--h];else if(null==p)p=n[++a];else if(null==b)b=n[--m];else if(isSameVnode(d,p))patch(d,p),d=e[++r],p=n[++a];else if(isSameVnode(u,b))patch(u,b),u=e[--h],b=n[--m];else if(isSameVnode(d,b))"slot"!==d.D&&"slot"!==b.D||putBackInOriginalLocation(d.O.parentNode,!1),patch(d,b),t.insertBefore(d.O,u.O.nextSibling),d=e[++r],b=n[--m];else if(isSameVnode(u,p))"slot"!==d.D&&"slot"!==b.D||putBackInOriginalLocation(u.O.parentNode,!1),patch(u,p),t.insertBefore(u.O,d.O),u=e[--h],p=n[++a];else{for(l=-1,c=r;c<=h;++c)if(e[c]&&null!==e[c].U&&e[c].U===p.U){l=c;break}l>=0?(o=e[l],o.D!==p.D?s=createElm(e&&e[a],i,l,t):(patch(o,p),e[l]=void 0,s=o.O),p=n[++a]):(s=createElm(e&&e[a],i,a,t),p=n[++a]),s&&parentReferenceNode(d.O).insertBefore(s,referenceNode(d.O))}r>h?addVnodes(t,null==n[m+1]?null:n[m+1].O,i,n,a,m):a>m&&removeVnodes(e,r,h)},isSameVnode=(t,e)=>t.D===e.D&&("slot"===t.D?t.A===e.A:t.U===e.U),referenceNode=t=>t&&t["s-ol"]||t,parentReferenceNode=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,patch=(t,e)=>{const i=e.O=t.O,n=t.J,s=e.J,o=e.D,r=e.Y;let a;null===r?(isSvgMode="svg"===o||"foreignObject"!==o&&isSvgMode,"slot"===o||updateElement(t,e,isSvgMode),null!==n&&null!==s?updateChildren(i,n,e,s):null!==s?(null!==t.Y&&(i.textContent=""),addVnodes(i,null,e,s,0,s.length-1)):null!==n&&removeVnodes(n,0,n.length-1),isSvgMode&&"svg"===o&&(isSvgMode=!1)):(a=i["s-cr"])?a.parentNode.textContent=r:t.Y!==r&&(i.data=r)},updateFallbackSlotVisibility=t=>{let e,i,n,s,o,r,a=t.childNodes;for(i=0,n=a.length;i<n;i++)if(e=a[i],1===e.nodeType){if(e["s-sr"])for(o=e["s-sn"],e.hidden=!1,s=0;s<n;s++)if(a[s]["s-hn"]!==e["s-hn"])if(r=a[s].nodeType,""!==o){if(1===r&&o===a[s].getAttribute("slot")){e.hidden=!0;break}}else if(1===r||3===r&&""!==a[s].textContent.trim()){e.hidden=!0;break}updateFallbackSlotVisibility(e)}},relocateNodes=[],relocateSlotContent=t=>{let e,i,n,s,o,r,a=0,l=t.childNodes,c=l.length;for(;a<c;a++){if(e=l[a],e["s-sr"]&&(i=e["s-cr"]))for(n=i.parentNode.childNodes,s=e["s-sn"],r=n.length-1;r>=0;r--)i=n[r],i["s-cn"]||i["s-nr"]||i["s-hn"]===e["s-hn"]||(isNodeLocatedInSlot(i,s)?(o=relocateNodes.find(t=>t._===i),checkSlotFallbackVisibility=!0,i["s-sn"]=i["s-sn"]||s,o?o.q=e:relocateNodes.push({q:e,_:i}),i["s-sr"]&&relocateNodes.map(t=>{isNodeLocatedInSlot(t._,i["s-sn"])&&(o=relocateNodes.find(t=>t._===i),o&&!t.q&&(t.q=o.q))})):relocateNodes.some(t=>t._===i)||relocateNodes.push({_:i}));1===e.nodeType&&relocateSlotContent(e)}},isNodeLocatedInSlot=(t,e)=>1===t.nodeType?null===t.getAttribute("slot")&&""===e||t.getAttribute("slot")===e:t["s-sn"]===e||""===e,callNodeRefs=t=>{t.K&&t.K.ref&&t.K.ref(null),t.J&&t.J.map(callNodeRefs)},renderVdom=(t,e)=>{const i=t.I,n=t.F,s=t.tt||newVNode(null,null),o=isHost(e)?e:h(null,null,e);if(hostTagName=i.tagName,n.et&&(o.K=o.K||{},n.et.map(([t,e])=>o.K[e]=i[t])),o.D=null,o.G|=4,t.tt=o,o.O=s.O=i.shadowRoot||i,scopeId=i["s-sc"],contentRef=i["s-cr"],useNativeShadowDom=supportsShadow&&0!=(1&n.G),checkSlotFallbackVisibility=!1,patch(s,o),plt.G|=1,checkSlotRelocate){let t,e,i,n,s,r;relocateSlotContent(o.O);let a=0;for(;a<relocateNodes.length;a++)t=relocateNodes[a],e=t._,e["s-ol"]||(i=doc.createTextNode(""),i["s-nr"]=e,e.parentNode.insertBefore(e["s-ol"]=i,e));for(a=0;a<relocateNodes.length;a++)if(t=relocateNodes[a],e=t._,t.q){for(n=t.q.parentNode,s=t.q.nextSibling,i=e["s-ol"];i=i.previousSibling;)if(r=i["s-nr"],r&&r["s-sn"]===e["s-sn"]&&n===r.parentNode&&(r=r.nextSibling,!r||!r["s-nr"])){s=r;break}(!s&&n!==e.parentNode||e.nextSibling!==s)&&e!==s&&(!e["s-hn"]&&e["s-ol"]&&(e["s-hn"]=e["s-ol"].parentNode.nodeName),n.insertBefore(e,s))}else 1===e.nodeType&&(e.hidden=!0)}checkSlotFallbackVisibility&&updateFallbackSlotVisibility(o.O),plt.G&=-2,relocateNodes.length=0},getElement=t=>t,createEvent=(t,e,i)=>{const n=getElement(t);return{emit:t=>emitEvent(n,e,{bubbles:!!(4&i),composed:!!(2&i),cancelable:!!(1&i),detail:t})}},emitEvent=(t,e,i)=>{const n=new CustomEvent(e,i);return t.dispatchEvent(n),n},attachToAncestor=(t,e)=>{e&&!t.it&&e["s-p"].push(new Promise(e=>t.it=e))},scheduleUpdate=(t,e)=>{if(t.G|=16,4&t.G)return void(t.G|=512);const i=t.I,n=createTime("scheduleUpdate",t.F.W),s=i,o=()=>updateComponent(t,s,e);let r;return attachToAncestor(t,t.nt),r=safeCall(s,e?"componentWillLoad":"componentWillUpdate"),r=then(r,()=>safeCall(s,"componentWillRender")),n(),then(r,()=>writeTask(o))},updateComponent=(t,e,i)=>{const n=t.I,s=createTime("update",t.F.W),o=n["s-rc"];i&&attachStyles(t);const r=createTime("render",t.F.W);renderVdom(t,callRender(e)),t.G&=-17,t.G|=2,o&&(o.map(t=>t()),n["s-rc"]=void 0),r(),s();{const e=n["s-p"],i=()=>postUpdateComponent(t);0===e.length?i():(Promise.all(e).then(i),t.G|=4,e.length=0)}},callRender=t=>{try{t=t.render&&t.render()}catch(e){consoleError(e)}return t},postUpdateComponent=t=>{const e=t.I,i=createTime("postUpdate",t.F.W),n=e,s=t.nt;safeCall(n,"componentDidRender"),64&t.G?(safeCall(n,"componentDidUpdate"),i()):(t.G|=64,addHydratedFlag(e),safeCall(n,"componentDidLoad"),i(),t.st(e),s||appDidLoad()),t.it&&(t.it(),t.it=void 0),512&t.G&&nextTick(()=>scheduleUpdate(t,!1)),t.G&=-517},forceUpdate=t=>{{const e=getHostRef(t),i=e.I.isConnected;return i&&2==(18&e.G)&&scheduleUpdate(e,!1),i}},appDidLoad=()=>{addHydratedFlag(doc.documentElement),plt.G|=2,nextTick(()=>emitEvent(win,"appload",{detail:{namespace:NAMESPACE}}))},safeCall=(t,i,n)=>{if(t&&t[i])try{return t[i](n)}catch(e){consoleError(e)}},then=(t,e)=>t&&t.then?t.then(e):e(),addHydratedFlag=t=>t.classList.add("hydrated"),parsePropertyValue=(t,e)=>null==t||isComplexType(t)?t:4&e?"false"!==t&&(""===t||!!t):2&e?parseFloat(t):1&e?String(t):t,getValue=(t,e)=>getHostRef(t).ot.get(e),setValue=(t,i,n,s)=>{const o=getHostRef(t),r=t,a=o.ot.get(i),l=o.G,c=r;if((n=parsePropertyValue(n,s.rt[i][0]))!==a){if(o.ot.set(i,n),s.lt&&128&l){const t=s.lt[i];t&&t.map(t=>{try{c[t](n,a,i)}catch(e){consoleError(e)}})}2==(18&l)&&scheduleUpdate(o,!1)}},proxyComponent=(t,e)=>{if(e.rt){t.watchers&&(e.lt=t.watchers);const i=Object.entries(e.rt),n=t.prototype;i.map(([t,[i]])=>{(31&i||32&i)&&Object.defineProperty(n,t,{get(){return getValue(this,t)},set(i){setValue(this,t,i,e)},configurable:!0,enumerable:!0})});{const s=new Map;n.attributeChangedCallback=function(t,e,i){plt.jmp(()=>{const e=s.get(t);this[e]=(null!==i||"boolean"!=typeof this[e])&&i})},t.observedAttributes=i.filter(([t,e])=>15&e[0]).map(([t,i])=>{const n=i[1]||t;return s.set(n,t),512&i[0]&&e.et.push([t,n]),n})}}return t},initializeComponent=async(t,e,i,n,s)=>{if(0==(32&e.G)){e.G|=32,null==e.T&&(e.T="string"!=typeof i.ct?computeMode(t):""),s=t.constructor;const n=getScopeId(i.W,e.T);if(!styles.has(n)&&s.style){const t=createTime("registerStyles",i.W);let o=s.style;"string"!=typeof o&&(o=o[e.T]),8&i.G&&(o=await import("./p-55eca4f7.mjs").then(t=>t.scopeCss(o,n,!1))),registerStyle(n,o,!!(1&i.G)),t()}}const o=e.nt,r=()=>scheduleUpdate(e,!0);o&&o["s-rc"]?o["s-rc"].push(r):r()},connectedCallback=t=>{if(0==(1&plt.G)){const e=getHostRef(t),i=e.F,n=createTime("connectedCallback",i.W);if(addHostEventListeners(t,e,i.ht,!0),1&e.G)addHostEventListeners(t,e,i.ht,!1);else{e.G|=1,12&i.G&&setContentReference(t);{let i=t;for(;i=i.parentNode||i.host;)if(i["s-p"]){attachToAncestor(e,e.nt=i);break}}initializeComponent(t,e,i)}n()}},setContentReference=t=>{const e=t["s-cr"]=doc.createComment("");e["s-cn"]=!0,t.insertBefore(e,t.firstChild)},disconnectedCallback=t=>{if(0==(1&plt.G)){const e=getHostRef(t),i=t;e.V&&(e.V.map(t=>t()),e.V=void 0),safeCall(i,"componentDidUnload")}},proxyCustomElement=(t,e)=>{const i={G:e[0],W:e[1]};i.rt=e[2],i.ht=e[3],i.lt=t.lt,i.et=[],!supportsShadow&&1&i.G&&(i.G|=8);const n=t.prototype.connectedCallback,s=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){registerHost(this,i)},connectedCallback(){connectedCallback(this),n&&n.call(this)},disconnectedCallback(){disconnectedCallback(this),s&&s.call(this)}}),t.is=i.W,proxyComponent(t,i)},attachShadow=t=>{supportsShadow?t.attachShadow({mode:"open"}):t.shadowRoot=t},getAssetPath=t=>{const e=new URL(t,plt.X);return e.origin!==win.location.origin?e.href:e.pathname},hostRefs=new WeakMap,getHostRef=t=>hostRefs.get(t),registerHost=(t,e)=>{const i={G:0,I:t,F:e,ot:new Map};return i.dt=new Promise(t=>i.st=t),t["s-p"]=[],t["s-rc"]=[],addHostEventListeners(t,i,e.ht,!1),hostRefs.set(t,i)},isMemberInElement=(t,e)=>e in t,consoleError=t=>console.error(t),styles=new Map,modeResolutionChain=[],queueDomReads=[],queueDomWrites=[],queueDomWritesLow=[],queueTask=(t,e)=>i=>{t.push(i),queuePending||(queuePending=!0,e&&4&plt.G?nextTick(flush):plt.raf(flush))},consume=t=>{for(let i=0;i<t.length;i++)try{t[i](performance.now())}catch(e){consoleError(e)}t.length=0},consumeTimeout=(t,i)=>{let n=0,s=0;for(;n<t.length&&(s=performance.now())<i;)try{t[n++](s)}catch(e){consoleError(e)}n===t.length?t.length=0:0!==n&&t.splice(0,n)},flush=()=>{queueCongestion++,consume(queueDomReads);{const t=2==(6&plt.G)?performance.now()+14*Math.ceil(.1*queueCongestion):1/0;consumeTimeout(queueDomWrites,t),consumeTimeout(queueDomWritesLow,t),queueDomWrites.length>0&&(queueDomWritesLow.push(...queueDomWrites),queueDomWrites.length=0),(queuePending=queueDomReads.length+queueDomWrites.length+queueDomWritesLow.length>0)?plt.raf(flush):queueCongestion=0}},nextTick=t=>promiseResolve().then(t),readTask=queueTask(queueDomReads,!1),writeTask=queueTask(queueDomWrites,!0),Build={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},getPlatforms=t=>setupPlatforms(t),isPlatform=(t,e)=>("string"==typeof t&&(e=t,t=void 0),getPlatforms(t).includes(e)),setupPlatforms=(t=window)=>{t.Ionic=t.Ionic||{};let e=t.Ionic.platforms;return null==e&&(e=t.Ionic.platforms=detectPlatforms(t),e.forEach(e=>t.document.documentElement.classList.add("plt-"+e))),e},detectPlatforms=t=>Object.keys(PLATFORMS_MAP).filter(e=>PLATFORMS_MAP[e](t)),isMobileWeb=t=>isMobile(t)&&!isHybrid(t),isIpad=t=>!!testUserAgent(t,/iPad/i)||!(!testUserAgent(t,/Macintosh/i)||!isMobile(t)),isIphone=t=>testUserAgent(t,/iPhone/i),isIOS=t=>testUserAgent(t,/iPhone|iPod/i)||isIpad(t),isAndroid=t=>testUserAgent(t,/android|sink/i),isAndroidTablet=t=>isAndroid(t)&&!testUserAgent(t,/mobile/i),isPhablet=t=>{const e=t.innerWidth,i=t.innerHeight,n=Math.min(e,i),s=Math.max(e,i);return n>390&&n<520&&s>620&&s<800},isTablet=t=>{const e=t.innerWidth,i=t.innerHeight,n=Math.min(e,i),s=Math.max(e,i);return isIpad(t)||isAndroidTablet(t)||n>460&&n<820&&s>780&&s<1400},isMobile=t=>matchMedia(t,"(any-pointer:coarse)"),isDesktop=t=>!isMobile(t),isHybrid=t=>isCordova(t)||isCapacitorNative(t),isCordova=t=>!!(t.cordova||t.phonegap||t.PhoneGap),isCapacitorNative=t=>{const e=t.Capacitor;return!(!e||!e.isNative)},isElectron=t=>testUserAgent(t,/electron/i),isPWA=t=>!(!t.matchMedia("(display-mode: standalone)").matches&&!t.navigator.standalone),testUserAgent=(t,e)=>e.test(t.navigator.userAgent),matchMedia=(t,e)=>t.matchMedia(e).matches,PLATFORMS_MAP={ipad:isIpad,iphone:isIphone,ios:isIOS,android:isAndroid,phablet:isPhablet,tablet:isTablet,cordova:isCordova,capacitor:isCapacitorNative,electron:isElectron,pwa:isPWA,mobile:isMobile,mobileweb:isMobileWeb,desktop:isDesktop,hybrid:isHybrid};class Config{constructor(){this.m=new Map}reset(t){this.m=new Map(Object.entries(t))}get(t,e){const i=this.m.get(t);return void 0!==i?i:e}getBoolean(t,e=!1){const i=this.m.get(t);return void 0===i?e:"string"==typeof i?"true"===i:!!i}getNumber(t,e){const i=parseFloat(this.m.get(t));return isNaN(i)?void 0!==e?e:NaN:i}set(t,e){this.m.set(t,e)}}const config=new Config,configFromSession=t=>{try{const e=t.sessionStorage.getItem(IONIC_SESSION_KEY);return null!==e?JSON.parse(e):{}}catch(e){return{}}},saveConfig=(t,i)=>{try{t.sessionStorage.setItem(IONIC_SESSION_KEY,JSON.stringify(i))}catch(e){return}},configFromURL=t=>{const e={};return t.location.search.slice(1).split("&").map(t=>t.split("=")).map(([t,e])=>[decodeURIComponent(t),decodeURIComponent(e)]).filter(([t])=>startsWith(t,IONIC_PREFIX)).map(([t,e])=>[t.slice(IONIC_PREFIX.length),e]).forEach(([t,i])=>{e[t]=i}),e},startsWith=(t,e)=>t.substr(0,e.length)===e,IONIC_PREFIX="ionic:",IONIC_SESSION_KEY="ionic-persist-config";let defaultMode;const getIonMode=t=>t&&getMode(t)||defaultMode;var ionicCoreGlobalScript=()=>{const t=document,e=window,i=e.Ionic=e.Ionic||{};setupPlatforms(e);const n=Object.assign(Object.assign(Object.assign(Object.assign({},configFromSession(e)),{persistConfig:!1}),i.config),configFromURL(e));config.reset(n),config.getBoolean("persistConfig")&&saveConfig(e,n),i.config=config,i.mode=defaultMode=config.get("mode",t.documentElement.getAttribute("mode")||(isPlatform(e,"ios")?"ios":"md")),config.set("mode",defaultMode),t.documentElement.setAttribute("mode",defaultMode),t.documentElement.classList.add(defaultMode),config.getBoolean("_testing")&&config.set("animated",!1);const s=t=>t.tagName&&t.tagName.startsWith("ION-"),o=t=>["ios","md"].includes(t);setMode(t=>{for(;t;){const e=t.mode||t.getAttribute("mode");if(e){if(o(e))return e;s(t)&&console.warn('Invalid ionic mode: "'+e+'", expected: "ios" or "md"')}t=t.parentElement}return defaultMode})};const globalScripts=()=>{ionicCoreGlobalScript()},startHardwareBackButton=()=>{const t=document;let e=!1;t.addEventListener("backbutton",()=>{if(e)return;const i=[],n=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(t,e){i.push({priority:t,handler:e})}}});if(t.dispatchEvent(n),i.length>0){let t,n=Number.MIN_SAFE_INTEGER;i.forEach(({priority:e,handler:i})=>{e>=n&&(n=e,t=i)}),e=!0,executeAction(t).then(()=>e=!1)}})},executeAction=async t=>{try{if(t){const e=t();null!=e&&await e}}catch(e){console.error(e)}},OVERLAY_BACK_BUTTON_PRIORITY=100,MENU_BACK_BUTTON_PRIORITY=99;var hardwareBackButton=Object.freeze({__proto__:null,startHardwareBackButton,OVERLAY_BACK_BUTTON_PRIORITY,MENU_BACK_BUTTON_PRIORITY});let lastId=0;const activeAnimations=new WeakMap,createController=t=>({create:e=>createOverlay(t,e),dismiss:(e,i,n)=>dismissOverlay(document,e,i,t,n),getTop:async()=>getOverlay(document,t)}),alertController=createController("ion-alert"),actionSheetController=createController("ion-action-sheet"),pickerController=createController("ion-picker"),popoverController=createController("ion-popover"),prepareOverlay=t=>{const e=document;connectListeners(e);const i=lastId++;t.overlayIndex=i,t.hasAttribute("id")||(t.id="ion-overlay-"+i)},createOverlay=(t,e)=>customElements.whenDefined(t).then(()=>{const i=document,n=i.createElement(t);return n.classList.add("overlay-hidden"),Object.assign(n,e),getAppRoot(i).appendChild(n),n.componentOnReady()}),connectListeners=t=>{0===lastId&&(lastId=1,t.addEventListener("focusin",e=>{const i=getOverlay(t);if(i&&i.backdropDismiss&&!isDescendant(i,e.target)){const t=i.querySelector("input,button");t&&t.focus()}}),t.addEventListener("ionBackButton",e=>{const i=getOverlay(t);i&&i.backdropDismiss&&e.detail.register(OVERLAY_BACK_BUTTON_PRIORITY,()=>i.dismiss(void 0,BACKDROP))}),t.addEventListener("keyup",e=>{if("Escape"===e.key){const e=getOverlay(t);e&&e.backdropDismiss&&e.dismiss(void 0,BACKDROP)}}))},dismissOverlay=(t,e,i,n,s)=>{const o=getOverlay(t,n,s);return o?o.dismiss(e,i):Promise.reject("overlay does not exist")},getOverlays=(t,e)=>(void 0===e&&(e="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(t.querySelectorAll(e)).filter(t=>t.overlayIndex>0)),getOverlay=(t,e,i)=>{const n=getOverlays(t,e);return void 0===i?n[n.length-1]:n.find(t=>t.id===i)},present=async(t,e,i,n,s)=>{if(t.presented)return;t.presented=!0,t.willPresent.emit();const o=getIonMode(t),r=t.enterAnimation?t.enterAnimation:config.get(e,"ios"===o?i:n);await overlayAnimation(t,r,t.el,s)&&t.didPresent.emit()},dismiss=async(t,e,i,n,s,o,r)=>{if(!t.presented)return!1;t.presented=!1;try{t.willDismiss.emit({data:e,role:i});const a=getIonMode(t),l=t.leaveAnimation?t.leaveAnimation:config.get(n,"ios"===a?s:o);"gesture"!==i&&await overlayAnimation(t,l,t.el,r),t.didDismiss.emit({data:e,role:i}),activeAnimations.delete(t)}catch(a){console.error(a)}return t.el.remove(),!0},getAppRoot=t=>t.querySelector("ion-app")||t.body,overlayAnimation=async(t,e,i,n)=>{i.classList.remove("overlay-hidden");const s=e(i.shadowRoot||t.el,n);t.animated&&config.getBoolean("animated",!0)||s.duration(0),t.keyboardClose&&s.beforeAddWrite(()=>{const t=i.ownerDocument.activeElement;t&&t.matches("input, ion-input, ion-textarea")&&t.blur()});const o=activeAnimations.get(t)||[];return activeAnimations.set(t,[...o,s]),await s.play(),!0},eventMethod=(t,e)=>{let i;const n=new Promise(t=>i=t);return onceEvent(t,e,t=>{i(t.detail)}),n},onceEvent=(t,e,i)=>{const n=s=>{t.removeEventListener(e,n),i(s)};t.addEventListener(e,n)},isCancel=t=>"cancel"===t||t===BACKDROP,isDescendant=(t,e)=>{for(;e;){if(e===t)return!0;e=e.parentElement}return!1},defaultGate=t=>t(),safeCall$1=(t,i)=>{if("function"==typeof t)return config.get("_zoneGate",defaultGate)(()=>{try{return t(i)}catch(e){console.error(e)}})},BACKDROP="backdrop",hostContext=(t,e)=>null!==e.closest(t),createColorClasses=t=>"string"==typeof t&&t.length>0?{"ion-color":!0,["ion-color-"+t]:!0}:void 0,getClassList=t=>void 0!==t?(Array.isArray(t)?t:t.split(" ")).filter(t=>null!=t).map(t=>t.trim()).filter(t=>""!==t):[],getClassMap=t=>{const e={};return getClassList(t).forEach(t=>e[t]=!0),e},SCHEME=/^[a-z][a-z0-9+\-.]*:/,openURL=async(t,e,i)=>{if(null!=t&&"#"!==t[0]&&!SCHEME.test(t)){const n=document.querySelector("ion-router");if(n)return null!=e&&e.preventDefault(),n.push(t,i)}return!1},raf=t=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(t):"function"==typeof requestAnimationFrame?requestAnimationFrame(t):setTimeout(t),hasShadowDom=t=>!!t.shadowRoot&&!!t.attachShadow,findItemLabel=t=>{const e=t.closest("ion-item");return e?e.querySelector("ion-label"):null},renderHiddenInput=(t,e,i,n,s)=>{if(t||hasShadowDom(e)){let t=e.querySelector("input.aux-input");t||(t=e.ownerDocument.createElement("input"),t.type="hidden",t.classList.add("aux-input"),e.appendChild(t)),t.disabled=s,t.name=i,t.value=n||""}},clamp=(t,e,i)=>Math.max(t,Math.min(e,i)),assert=(t,e)=>{if(!t){const t="ASSERT: "+e;throw console.error(t),new Error(t)}},now=t=>t.timeStamp||Date.now(),pointerCoord=t=>{if(t){const e=t.changedTouches;if(e&&e.length>0){const t=e[0];return{x:t.clientX,y:t.clientY}}if(void 0!==t.pageX)return{x:t.pageX,y:t.pageY}}return{x:0,y:0}},isEndSide=t=>{const e="rtl"===document.dir;switch(t){case"start":return e;case"end":return!e;default:throw new Error(`"${t}" is not a valid value for [side]. Use "start" or "end" instead.`)}},debounceEvent=(t,e)=>{const i=t._original||t;return{_original:t,emit:debounce(i.emit.bind(i),e)}},debounce=(t,e=0)=>{let i;return(...n)=>{clearTimeout(i),i=setTimeout(t,e,...n)}},processKeyframes=t=>(t.forEach(t=>{for(const e in t)if(t.hasOwnProperty(e)){const i=t[e];if("easing"===e)t["animation-timing-function"]=i,delete t[e];else{const n=convertCamelCaseToHypen(e);n!==e&&(t[n]=i,delete t[e])}}}),t),convertCamelCaseToHypen=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();let animationPrefix;const getAnimationPrefix=t=>{if(void 0===animationPrefix){const e=void 0!==t.style.webkitAnimationName;animationPrefix=void 0===t.style.animationName&&e?"-webkit-":""}return animationPrefix},setStyleProperty=(t,e,i)=>{const n=e.startsWith("animation")?getAnimationPrefix(t):"";t.style.setProperty(n+e,i)},removeStyleProperty=(t,e)=>{const i=e.startsWith("animation")?getAnimationPrefix(t):"";t.style.removeProperty(i+e)},animationEnd=(t,e)=>{let i;const n={passive:!0},s=()=>{i&&i()},o=i=>{t===i.target&&(s(),e(i))};return t&&(t.addEventListener("webkitAnimationEnd",o,n),t.addEventListener("animationend",o,n),i=()=>{t.removeEventListener("webkitAnimationEnd",o,n),t.removeEventListener("animationend",o,n)}),s},generateKeyframeRules=(t=[])=>t.map(t=>{const e=t.offset,i=[];for(const n in t)t.hasOwnProperty(n)&&"offset"!==n&&i.push(`${n}: ${t[n]};`);return`${100*e}% { ${i.join(" ")} }`}).join(" "),keyframeIds=[],generateKeyframeName=t=>{let e=keyframeIds.indexOf(t);return e<0&&(e=keyframeIds.push(t)-1),"ion-animation-"+e},getStyleContainer=t=>{const e=t.getRootNode();return e.head||e},createKeyframeStylesheet=(t,e,i)=>{const n=getStyleContainer(i),s=getAnimationPrefix(i),o=n.querySelector("#"+t);if(o)return o;const r=(i.ownerDocument||document).createElement("style");return r.id=t,r.textContent=`@${s}keyframes ${t} { ${e} } @${s}keyframes ${t}-alt { ${e} }`,n.appendChild(r),r},addClassToArray=(t=[],e)=>{if(void 0!==e){const i=Array.isArray(e)?e:[e];return[...t,...i]}return t},createAnimation=t=>{let e,i,n,s,o,r,a,l,c,h,d,u,m,p=[],b=[],f=[],g=!1,y={},v=[],Z=[],x={},G=0,X=!1,w=!1,V=!0,I=!1,S=!0;const R=t,k=[],C=[],W=[],L=[],F=[],M=[],T=[],Y=[],z=[],K=[],N="function"==typeof AnimationEffect||"function"==typeof window.AnimationEffect,E="function"==typeof Element&&"function"==typeof Element.prototype.animate&&N,H=(t,e)=>((e&&e.oneTimeCallback?C:k).push({c:t,o:e}),m),B=()=>{if(E)K.forEach(t=>{t.cancel()}),K.length=0;else{const t=W.slice();raf(()=>{t.forEach(t=>{removeStyleProperty(t,"animation-name"),removeStyleProperty(t,"animation-duration"),removeStyleProperty(t,"animation-timing-function"),removeStyleProperty(t,"animation-iteration-count"),removeStyleProperty(t,"animation-delay"),removeStyleProperty(t,"animation-play-state"),removeStyleProperty(t,"animation-fill-mode"),removeStyleProperty(t,"animation-direction")})})}},J=()=>{F.forEach(t=>{t&&t.parentNode&&t.parentNode.removeChild(t)}),F.length=0},U=()=>void 0!==o?o:a?a.getFill():"both",P=()=>void 0!==c?c:void 0!==r?r:a?a.getDirection():"normal",A=()=>X?"linear":void 0!==n?n:a?a.getEasing():"linear",D=()=>w?0:void 0!==h?h:void 0!==i?i:a?a.getDuration():0,O=()=>void 0!==s?s:a?a.getIterations():1,j=()=>void 0!==d?d:void 0!==e?e:a?a.getDelay():0,Q=()=>{0!==G&&(G--,0===G&&((()=>{st(),Y.forEach(t=>t()),z.forEach(t=>t());const t=V?1:0,e=v,i=Z,n=x;W.forEach(t=>{const s=t.classList;e.forEach(t=>s.add(t)),i.forEach(t=>s.remove(t));for(const e in n)n.hasOwnProperty(e)&&setStyleProperty(t,e,n[e])}),k.forEach(e=>e.c(t,m)),C.forEach(e=>e.c(t,m)),C.length=0,S=!0,V&&(I=!0),V=!0})(),a&&a.animationFinish()))},_=(e=!0)=>{(()=>{M.forEach(t=>t()),T.forEach(t=>t());const t=b,e=f,i=y;W.forEach(n=>{const s=n.classList;t.forEach(t=>s.add(t)),e.forEach(t=>s.remove(t));for(const t in i)i.hasOwnProperty(t)&&setStyleProperty(n,t,i[t])})})(),p.length>0&&(E?(W.forEach(t=>{const e=t.animate(p,{id:R,delay:j(),duration:D(),easing:A(),iterations:O(),fill:U(),direction:P()});e.pause(),K.push(e)}),K.length>0&&(K[0].onfinish=()=>{Q()})):((e=!0)=>{J();const i=processKeyframes(p);W.forEach(n=>{if(i.length>0){const s=generateKeyframeRules(i);u=void 0!==t?t:generateKeyframeName(s);const o=createKeyframeStylesheet(u,s,n);F.push(o),setStyleProperty(n,"animation-duration",D()+"ms"),setStyleProperty(n,"animation-timing-function",A()),setStyleProperty(n,"animation-delay",j()+"ms"),setStyleProperty(n,"animation-fill-mode",U()),setStyleProperty(n,"animation-direction",P());const r=O()===1/0?"infinite":O().toString();setStyleProperty(n,"animation-iteration-count",r),setStyleProperty(n,"animation-play-state","paused"),e&&setStyleProperty(n,"animation-name",o.id+"-alt"),raf(()=>{setStyleProperty(n,"animation-name",o.id||null)})}})})(e)),g=!0},$=t=>{if(t=Math.min(Math.max(t,0),.9999),E)K.forEach(e=>{e.currentTime=e.effect.getComputedTiming().delay+D()*t,e.pause()});else{const e=`-${D()*t}ms`;W.forEach(t=>{p.length>0&&(setStyleProperty(t,"animation-delay",e),setStyleProperty(t,"animation-play-state","paused"))})}},q=t=>{K.forEach(t=>{t.effect.updateTiming({delay:j(),duration:D(),easing:A(),iterations:O(),fill:U(),direction:P()})}),void 0!==t&&$(t)},tt=(t=!0,e)=>{raf(()=>{W.forEach(i=>{setStyleProperty(i,"animation-name",u||null),setStyleProperty(i,"animation-duration",D()+"ms"),setStyleProperty(i,"animation-timing-function",A()),setStyleProperty(i,"animation-delay",void 0!==e?`-${e*D()}ms`:j()+"ms"),setStyleProperty(i,"animation-fill-mode",U()||null),setStyleProperty(i,"animation-direction",P()||null);const n=O()===1/0?"infinite":O().toString();setStyleProperty(i,"animation-iteration-count",n),t&&setStyleProperty(i,"animation-name",u+"-alt"),raf(()=>{setStyleProperty(i,"animation-name",u||null)})})})},et=(t=!1,e=!0,i)=>(t&&L.forEach(n=>{n.update(t,e,i)}),E?q(i):tt(e,i),m),it=()=>{g&&(E?K.forEach(t=>{t.pause()}):W.forEach(t=>{setStyleProperty(t,"animation-play-state","paused")}))},nt=()=>{l=void 0,Q()},st=()=>{l&&clearTimeout(l)},ot=t=>new Promise(e=>{t&&t.sync&&(w=!0,H(()=>w=!1,{oneTimeCallback:!0})),g||_(),I&&(E?($(0),q()):tt(),I=!1),S&&(G=L.length+1,S=!1),H(()=>e(),{oneTimeCallback:!0}),L.forEach(t=>{t.play()}),E?(K.forEach(t=>{t.play()}),0!==p.length&&0!==W.length||Q()):(()=>{if(st(),raf(()=>{W.forEach(t=>{p.length>0&&setStyleProperty(t,"animation-play-state","running")})}),0===p.length||0===W.length)Q();else{const t=j()||0,e=D()||0,i=O()||1;isFinite(i)&&(l=setTimeout(nt,t+e*i+100)),animationEnd(W[0],()=>{st(),raf(()=>{W.forEach(t=>{removeStyleProperty(t,"animation-duration"),removeStyleProperty(t,"animation-delay"),removeStyleProperty(t,"animation-play-state")}),raf(Q)})})}})()}),rt=(t,e)=>{const i=p[0];return void 0===i||void 0!==i.offset&&0!==i.offset?p=[{offset:0,[t]:e},...p]:i[t]=e,m};return m={parentAnimation:a,elements:W,childAnimations:L,id:R,animationFinish:Q,from:rt,to:(t,e)=>{const i=p[p.length-1];return void 0===i||void 0!==i.offset&&1!==i.offset?p=[...p,{offset:1,[t]:e}]:i[t]=e,m},fromTo:(t,e,i)=>rt(t,e).to(t,i),parent:t=>(a=t,m),play:ot,pause:()=>(L.forEach(t=>{t.pause()}),it(),m),stop:()=>{L.forEach(t=>{t.stop()}),g&&(B(),g=!1),X=!1,w=!1,S=!0,c=void 0,h=void 0,d=void 0,G=0,I=!1,V=!0},destroy:()=>(L.forEach(t=>{t.destroy()}),B(),J(),W.length=0,L.length=0,p.length=0,k.length=0,C.length=0,g=!1,S=!0,m),keyframes:t=>(p=t,m),addAnimation:t=>{if(null!=t)if(Array.isArray(t))for(const e of t)e.parent(m),L.push(e);else t.parent(m),L.push(t);return m},addElement:t=>{if(null!=t)if(1===t.nodeType)W.push(t);else if(t.length>=0)for(let e=0;e<t.length;e++)W.push(t[e]);else console.error("Invalid addElement value");return m},update:et,fill:t=>(o=t,et(!0),m),direction:t=>(r=t,et(!0),m),iterations:t=>(s=t,et(!0),m),duration:t=>(E||0!==t||(t=1),i=t,et(!0),m),easing:t=>(n=t,et(!0),m),delay:t=>(e=t,et(!0),m),getWebAnimations:()=>K,getKeyframes:()=>p,getFill:U,getDirection:P,getDelay:j,getIterations:O,getEasing:A,getDuration:D,afterAddRead:t=>(Y.push(t),m),afterAddWrite:t=>(z.push(t),m),afterClearStyles:(t=[])=>{for(const e of t)x[e]="";return m},afterStyles:(t={})=>(x=t,m),afterRemoveClass:t=>(Z=addClassToArray(Z,t),m),afterAddClass:t=>(v=addClassToArray(v,t),m),beforeAddRead:t=>(M.push(t),m),beforeAddWrite:t=>(T.push(t),m),beforeClearStyles:(t=[])=>{for(const e of t)y[e]="";return m},beforeStyles:(t={})=>(y=t,m),beforeRemoveClass:t=>(f=addClassToArray(f,t),m),beforeAddClass:t=>(b=addClassToArray(b,t),m),onFinish:H,progressStart:(t=!1,e)=>(L.forEach(i=>{i.progressStart(t,e)}),it(),X=t,g?et(!1,!0,e):_(),m),progressStep:t=>(L.forEach(e=>{e.progressStep(t)}),$(t),m),progressEnd:(t,e,i)=>(X=!1,L.forEach(n=>{n.progressEnd(t,e,i)}),void 0!==i&&(h=i),I=!1,V=!0,0===t?(c="reverse"===P()?"normal":"reverse","reverse"===c&&(V=!1),E?(et(),$(1-e)):(d=(1-e)*D()*-1,et(!1,!1))):1===t&&(E?(et(),$(e)):(d=e*D()*-1,et(!1,!1))),void 0!==t&&(H(()=>{h=void 0,c=void 0,d=void 0},{oneTimeCallback:!0}),a||ot()),m)}},iosEnterAnimation=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(100%)","translateY(0%)"),e.addElement(t).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([i,n])},iosLeaveAnimation=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(0%)","translateY(100%)"),e.addElement(t).easing("cubic-bezier(.36,.66,.04,1)").duration(450).addAnimation([i,n])},mdEnterAnimation=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(100%)","translateY(0%)"),e.addElement(t).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([i,n])},mdLeaveAnimation=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(0%)","translateY(100%)"),e.addElement(t).easing("cubic-bezier(.36,.66,.04,1)").duration(450).addAnimation([i,n])},actionSheetIosCss='.sc-ion-action-sheet-ios-h{--color:initial;--button-color-activated:var(--button-color);--button-color-focused:var(--button-color);--button-color-hover:var(--button-color);--button-color-selected:var(--button-color);--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--height:100%;--max-height:calc(100% - (var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:block;position:fixed;font-family:var(--ion-font-family, inherit);-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-action-sheet-ios-h{display:none}.action-sheet-wrapper.sc-ion-action-sheet-ios{left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:block;position:absolute;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);z-index:10;pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-wrapper.sc-ion-action-sheet-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.action-sheet-button.sc-ion-action-sheet-ios{display:block;position:relative;width:100%;border:0;outline:none;background:var(--button-background);color:var(--button-color);font-family:inherit;overflow:hidden}.action-sheet-button-inner.sc-ion-action-sheet-ios{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}.action-sheet-container.sc-ion-action-sheet-ios{display:-ms-flexbox;display:flex;-ms-flex-flow:column;flex-flow:column;-ms-flex-pack:end;justify-content:flex-end;height:100%;max-height:100%}.action-sheet-group.sc-ion-action-sheet-ios{-ms-flex-negative:2;flex-shrink:2;overscroll-behavior-y:contain;overflow-y:auto;-webkit-overflow-scrolling:touch;pointer-events:all;background:var(--background)}.action-sheet-group.sc-ion-action-sheet-ios::-webkit-scrollbar{display:none}.action-sheet-group-cancel.sc-ion-action-sheet-ios{-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.action-sheet-button.sc-ion-action-sheet-ios::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.action-sheet-selected.sc-ion-action-sheet-ios{color:var(--button-color-selected)}.action-sheet-selected.sc-ion-action-sheet-ios::after{background:var(--button-background-selected);opacity:var(--button-background-selected-opacity)}.action-sheet-button.ion-activated.sc-ion-action-sheet-ios{color:var(--button-color-activated)}.action-sheet-button.ion-activated.sc-ion-action-sheet-ios::after{background:var(--button-background-activated);opacity:var(--button-background-activated-opacity)}.action-sheet-button.ion-focused.sc-ion-action-sheet-ios{color:var(--button-color-focused)}.action-sheet-button.ion-focused.sc-ion-action-sheet-ios::after{background:var(--button-background-focused);opacity:var(--button-background-focused-opacity)}@media (any-hover: hover){.action-sheet-button.sc-ion-action-sheet-ios:hover{color:var(--button-color-hover)}.action-sheet-button.sc-ion-action-sheet-ios:hover::after{background:var(--button-background-hover);opacity:var(--button-background-hover-opacity)}}.sc-ion-action-sheet-ios-h{--background:var(--ion-overlay-background-color, var(--ion-color-step-100, #f9f9f9));--backdrop-opacity:var(--ion-backdrop-opacity, 0.4);--button-background:linear-gradient(0deg, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08), rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08) 50%, transparent 50%) bottom/100% 1px no-repeat transparent;--button-background-activated:var(--ion-text-color, #000);--button-background-activated-opacity:.08;--button-background-hover:currentColor;--button-background-hover-opacity:.04;--button-background-focused:currentColor;--button-background-focused-opacity:.12;--button-background-selected:var(--ion-background-color, #fff);--button-background-selected-opacity:1;--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-400, #999999);text-align:center}.action-sheet-wrapper.sc-ion-action-sheet-ios{margin-left:auto;margin-right:auto;margin-top:var(--ion-safe-area-top, 0);margin-bottom:var(--ion-safe-area-bottom, 0)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-wrapper.sc-ion-action-sheet-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.action-sheet-container.sc-ion-action-sheet-ios{padding-left:8px;padding-right:8px;padding-top:0;padding-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-container.sc-ion-action-sheet-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.action-sheet-group.sc-ion-action-sheet-ios{border-radius:13px;margin-bottom:8px}.action-sheet-group.sc-ion-action-sheet-ios:first-child{margin-top:10px}.action-sheet-group.sc-ion-action-sheet-ios:last-child{margin-bottom:10px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-group.sc-ion-action-sheet-ios{background-color:transparent;-webkit-backdrop-filter:saturate(280%) blur(20px);backdrop-filter:saturate(280%) blur(20px)}.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-title.sc-ion-action-sheet-ios,.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-button.sc-ion-action-sheet-ios{background-color:transparent;background-image:-webkit-gradient(linear, left bottom, left top, from(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)), to(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8))), -webkit-gradient(linear, left bottom, left top, from(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4)), color-stop(50%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4)), color-stop(50%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)));background-image:linear-gradient(0deg, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8), rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 100%), linear-gradient(0deg, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4), rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4) 50%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 50%);background-repeat:no-repeat;background-position:top, bottom;background-size:100% calc(100% - 1px), 100% 1px;-webkit-backdrop-filter:saturate(120%);backdrop-filter:saturate(120%)}.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-button.ion-activated.sc-ion-action-sheet-ios{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.7);background-image:none}.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-cancel.sc-ion-action-sheet-ios{background:var(--button-background-selected)}}.action-sheet-title.sc-ion-action-sheet-ios{background:-webkit-gradient(linear, left bottom, left top, from(rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08)), color-stop(50%, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08)), color-stop(50%, transparent)) bottom/100% 1px no-repeat transparent;background:linear-gradient(0deg, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08), rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08) 50%, transparent 50%) bottom/100% 1px no-repeat transparent}.action-sheet-title.sc-ion-action-sheet-ios{padding-left:10px;padding-right:10px;padding-top:14px;padding-bottom:13px;color:var(--color, var(--ion-color-step-400, #999999));font-size:13px;font-weight:400;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-title.sc-ion-action-sheet-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:10px;padding-inline-start:10px;-webkit-padding-end:10px;padding-inline-end:10px}}.action-sheet-sub-title.sc-ion-action-sheet-ios{padding-left:0;padding-right:0;padding-top:15px;padding-bottom:0;font-size:12px}.action-sheet-button.sc-ion-action-sheet-ios{padding-left:18px;padding-right:18px;padding-top:18px;padding-bottom:18px;height:56px;font-size:20px;contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-button.sc-ion-action-sheet-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:18px;padding-inline-start:18px;-webkit-padding-end:18px;padding-inline-end:18px}}.action-sheet-button.sc-ion-action-sheet-ios .action-sheet-icon.sc-ion-action-sheet-ios{margin-right:0.1em;font-size:28px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-button.sc-ion-action-sheet-ios .action-sheet-icon.sc-ion-action-sheet-ios{margin-right:unset;-webkit-margin-end:0.1em;margin-inline-end:0.1em}}.action-sheet-button.sc-ion-action-sheet-ios:last-child{background-image:none}.action-sheet-selected.sc-ion-action-sheet-ios{font-weight:bold}.action-sheet-cancel.sc-ion-action-sheet-ios{font-weight:600}.action-sheet-cancel.sc-ion-action-sheet-ios::after{background:var(--button-background-selected);opacity:var(--button-background-selected-opacity)}.action-sheet-destructive.sc-ion-action-sheet-ios,.action-sheet-destructive.ion-activated.sc-ion-action-sheet-ios,.action-sheet-destructive.ion-focused.sc-ion-action-sheet-ios{color:var(--ion-color-danger, #eb445a)}@media (any-hover: hover){.action-sheet-destructive.sc-ion-action-sheet-ios:hover{color:var(--ion-color-danger, #eb445a)}}',actionSheetMdCss='.sc-ion-action-sheet-md-h{--color:initial;--button-color-activated:var(--button-color);--button-color-focused:var(--button-color);--button-color-hover:var(--button-color);--button-color-selected:var(--button-color);--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--height:100%;--max-height:calc(100% - (var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:block;position:fixed;font-family:var(--ion-font-family, inherit);-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-action-sheet-md-h{display:none}.action-sheet-wrapper.sc-ion-action-sheet-md{left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:block;position:absolute;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);z-index:10;pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-wrapper.sc-ion-action-sheet-md{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.action-sheet-button.sc-ion-action-sheet-md{display:block;position:relative;width:100%;border:0;outline:none;background:var(--button-background);color:var(--button-color);font-family:inherit;overflow:hidden}.action-sheet-button-inner.sc-ion-action-sheet-md{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}.action-sheet-container.sc-ion-action-sheet-md{display:-ms-flexbox;display:flex;-ms-flex-flow:column;flex-flow:column;-ms-flex-pack:end;justify-content:flex-end;height:100%;max-height:100%}.action-sheet-group.sc-ion-action-sheet-md{-ms-flex-negative:2;flex-shrink:2;overscroll-behavior-y:contain;overflow-y:auto;-webkit-overflow-scrolling:touch;pointer-events:all;background:var(--background)}.action-sheet-group.sc-ion-action-sheet-md::-webkit-scrollbar{display:none}.action-sheet-group-cancel.sc-ion-action-sheet-md{-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.action-sheet-button.sc-ion-action-sheet-md::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.action-sheet-selected.sc-ion-action-sheet-md{color:var(--button-color-selected)}.action-sheet-selected.sc-ion-action-sheet-md::after{background:var(--button-background-selected);opacity:var(--button-background-selected-opacity)}.action-sheet-button.ion-activated.sc-ion-action-sheet-md{color:var(--button-color-activated)}.action-sheet-button.ion-activated.sc-ion-action-sheet-md::after{background:var(--button-background-activated);opacity:var(--button-background-activated-opacity)}.action-sheet-button.ion-focused.sc-ion-action-sheet-md{color:var(--button-color-focused)}.action-sheet-button.ion-focused.sc-ion-action-sheet-md::after{background:var(--button-background-focused);opacity:var(--button-background-focused-opacity)}@media (any-hover: hover){.action-sheet-button.sc-ion-action-sheet-md:hover{color:var(--button-color-hover)}.action-sheet-button.sc-ion-action-sheet-md:hover::after{background:var(--button-background-hover);opacity:var(--button-background-hover-opacity)}}.sc-ion-action-sheet-md-h{--background:var(--ion-overlay-background-color, var(--ion-background-color, #fff));--backdrop-opacity:var(--ion-backdrop-opacity, 0.32);--button-background:transparent;--button-background-selected:currentColor;--button-background-selected-opacity:0;--button-background-activated:transparent;--button-background-activated-opacity:0;--button-background-hover:currentColor;--button-background-hover-opacity:.04;--button-background-focused:currentColor;--button-background-focused-opacity:.12;--button-color:var(--ion-color-step-850, #262626);--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54)}.action-sheet-title.sc-ion-action-sheet-md{padding-left:16px;padding-right:16px;padding-top:20px;padding-bottom:17px;height:60px;color:var(--color, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54));font-size:16px;text-align:start}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-title.sc-ion-action-sheet-md{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.action-sheet-sub-title.sc-ion-action-sheet-md{padding-left:0;padding-right:0;padding-top:16px;padding-bottom:0;font-size:14px}.action-sheet-group.sc-ion-action-sheet-md:first-child{padding-top:0}.action-sheet-group.sc-ion-action-sheet-md:last-child{padding-bottom:0}.action-sheet-button.sc-ion-action-sheet-md{padding-left:16px;padding-right:16px;padding-top:0;padding-bottom:0;position:relative;height:52px;font-size:16px;text-align:start;contain:strict;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-button.sc-ion-action-sheet-md{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.action-sheet-icon.sc-ion-action-sheet-md{padding-bottom:4px;margin-left:0;margin-right:32px;margin-top:0;margin-bottom:0;color:var(--color);font-size:24px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-icon.sc-ion-action-sheet-md{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:32px;margin-inline-end:32px}}.action-sheet-button-inner.sc-ion-action-sheet-md{-ms-flex-pack:start;justify-content:flex-start}.action-sheet-selected.sc-ion-action-sheet-md{font-weight:bold}',ActionSheet=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.presented=!1,this.keyboardClose=!0,this.buttons=[],this.backdropDismiss=!0,this.translucent=!1,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,BACKDROP)},this.dispatchCancelHandler=t=>{if(isCancel(t.detail.role)){const t=this.getButtons().find(t=>"cancel"===t.role);this.callButtonHandler(t)}},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionActionSheetDidPresent",7),this.willPresent=createEvent(this,"ionActionSheetWillPresent",7),this.willDismiss=createEvent(this,"ionActionSheetWillDismiss",7),this.didDismiss=createEvent(this,"ionActionSheetDidDismiss",7)}present(){return present(this,"actionSheetEnter",iosEnterAnimation,mdEnterAnimation)}dismiss(t,e){return dismiss(this,t,e,"actionSheetLeave",iosLeaveAnimation,mdLeaveAnimation)}onDidDismiss(){return eventMethod(this.el,"ionActionSheetDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionActionSheetWillDismiss")}async buttonClick(t){const e=t.role;return isCancel(e)?this.dismiss(void 0,e):await this.callButtonHandler(t)?this.dismiss(void 0,t.role):Promise.resolve()}async callButtonHandler(t){return!t||!1!==await safeCall$1(t.handler)}getButtons(){return this.buttons.map(t=>"string"==typeof t?{text:t}:t)}render(){const t=getIonMode(this),e=this.getButtons(),i=e.find(t=>"cancel"===t.role),n=e.filter(t=>"cancel"!==t.role);return h(Host,{role:"dialog","aria-modal":"true",style:{zIndex:""+(2e4+this.overlayIndex)},class:Object.assign(Object.assign({[t]:!0},getClassMap(this.cssClass)),{"action-sheet-translucent":this.translucent}),onIonActionSheetWillDismiss:this.dispatchCancelHandler,onIonBackdropTap:this.onBackdropTap},h("ion-backdrop",{tappable:this.backdropDismiss}),h("div",{class:"action-sheet-wrapper",role:"dialog"},h("div",{class:"action-sheet-container"},h("div",{class:"action-sheet-group"},void 0!==this.header&&h("div",{class:"action-sheet-title"},this.header,this.subHeader&&h("div",{class:"action-sheet-sub-title"},this.subHeader)),n.map(e=>h("button",{type:"button",class:buttonClass(e),onClick:()=>this.buttonClick(e)},h("span",{class:"action-sheet-button-inner"},e.icon&&h("ion-icon",{icon:e.icon,lazy:!1,class:"action-sheet-icon"}),e.text),"md"===t&&h("ion-ripple-effect",null)))),i&&h("div",{class:"action-sheet-group action-sheet-group-cancel"},h("button",{type:"button",class:buttonClass(i),onClick:()=>this.buttonClick(i)},h("span",{class:"action-sheet-button-inner"},i.icon&&h("ion-icon",{icon:i.icon,lazy:!1,class:"action-sheet-icon"}),i.text),"md"===t&&h("ion-ripple-effect",null))))))}get el(){return this}static get style(){return{ios:actionSheetIosCss,md:actionSheetMdCss}}},buttonClass=t=>Object.assign({"action-sheet-button":!0,"ion-activatable":!0,"ion-focusable":!0,["action-sheet-"+t.role]:void 0!==t.role},getClassMap(t.cssClass)),sanitizeDOMString=t=>{try{if("string"!=typeof t||""===t)return t;const e=document.createDocumentFragment(),i=document.createElement("div");e.appendChild(i),i.innerHTML=t,blockedTags.forEach(t=>{const i=e.querySelectorAll(t);for(let n=i.length-1;n>=0;n--){const t=i[n];t.parentNode?t.parentNode.removeChild(t):e.removeChild(t);const s=getElementChildren(t);for(let e=0;e<s.length;e++)sanitizeElement(s[e])}});const n=getElementChildren(e);for(let t=0;t<n.length;t++)sanitizeElement(n[t]);const s=document.createElement("div");s.appendChild(e);const o=s.querySelector("div");return null!==o?o.innerHTML:s.innerHTML}catch(e){return console.error(e),""}},sanitizeElement=t=>{if(t.nodeType&&1!==t.nodeType)return;for(let i=t.attributes.length-1;i>=0;i--){const e=t.attributes.item(i),n=e.name;if(!allowedAttributes.includes(n.toLowerCase())){t.removeAttribute(n);continue}const s=e.value;null!=s&&s.toLowerCase().includes("javascript:")&&t.removeAttribute(n)}const e=getElementChildren(t);for(let i=0;i<e.length;i++)sanitizeElement(e[i])},getElementChildren=t=>null!=t.children?t.children:t.childNodes,allowedAttributes=["class","id","href","src","name","slot"],blockedTags=["script","style","iframe","meta","link","object","embed"],iosEnterAnimation$1=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".alert-wrapper")).keyframes([{offset:0,opacity:"0.01",transform:"scale(1.1)"},{offset:1,opacity:"1",transform:"scale(1)"}]),e.addElement(t).easing("ease-in-out").duration(200).addAnimation([i,n])},iosLeaveAnimation$1=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".alert-wrapper")).keyframes([{offset:0,opacity:.99,transform:"scale(1)"},{offset:1,opacity:0,transform:"scale(0.9)"}]),e.addElement(t).easing("ease-in-out").duration(200).addAnimation([i,n])},mdEnterAnimation$1=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".alert-wrapper")).keyframes([{offset:0,opacity:"0.01",transform:"scale(0.9)"},{offset:1,opacity:"1",transform:"scale(1)"}]),e.addElement(t).easing("ease-in-out").duration(150).addAnimation([i,n])},mdLeaveAnimation$1=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".alert-wrapper")).fromTo("opacity",.99,0),e.addElement(t).easing("ease-in-out").duration(150).addAnimation([i,n])},alertIosCss=".sc-ion-alert-ios-h{--min-width:250px;--width:auto;--min-height:auto;--height:auto;--max-height:90%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-alert-ios-h{display:none}.alert-top.sc-ion-alert-ios-h{padding-top:50px;-ms-flex-align:start;align-items:flex-start}.alert-wrapper.sc-ion-alert-ios{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:content;opacity:0;z-index:10}.alert-title.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}.alert-sub-title.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-weight:normal}.alert-message.sc-ion-alert-ios{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-overflow-scrolling:touch;overflow-y:auto;overscroll-behavior-y:contain}.alert-checkbox-group.sc-ion-alert-ios::-webkit-scrollbar,.alert-radio-group.sc-ion-alert-ios::-webkit-scrollbar,.alert-message.sc-ion-alert-ios::-webkit-scrollbar{display:none}.alert-input.sc-ion-alert-ios{padding-left:0;padding-right:0;padding-top:10px;padding-bottom:10px;width:100%;border:0;background:inherit;font:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.alert-button-group.sc-ion-alert-ios{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;width:100%}.alert-button-group-vertical.sc-ion-alert-ios{-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.alert-button.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;border:0;font-size:14px;line-height:20px;z-index:0}.alert-button.ion-focused.sc-ion-alert-ios,.alert-tappable.ion-focused.sc-ion-alert-ios{background:var(--ion-color-step-100, #e6e6e6)}.alert-button-inner.sc-ion-alert-ios{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.alert-input-disabled.sc-ion-alert-ios,.alert-checkbox-button-disabled.sc-ion-alert-ios .alert-button-inner.sc-ion-alert-ios,.alert-radio-button-disabled.sc-ion-alert-ios .alert-button-inner.sc-ion-alert-ios{cursor:default;opacity:0.5;pointer-events:none}.alert-tappable.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;width:100%;border:0;background:transparent;font-size:inherit;line-height:initial;text-align:start;-webkit-appearance:none;-moz-appearance:none;appearance:none;contain:strict}.alert-button.sc-ion-alert-ios,.alert-checkbox.sc-ion-alert-ios,.alert-input.sc-ion-alert-ios,.alert-radio.sc-ion-alert-ios{outline:none}.alert-radio-icon.sc-ion-alert-ios,.alert-checkbox-icon.sc-ion-alert-ios,.alert-checkbox-inner.sc-ion-alert-ios{-webkit-box-sizing:border-box;box-sizing:border-box}textarea.alert-input.sc-ion-alert-ios{min-height:37px;resize:none}.sc-ion-alert-ios-h{--background:var(--ion-overlay-background-color, var(--ion-color-step-100, #f9f9f9));--max-width:270px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.3);font-size:14px}.alert-wrapper.sc-ion-alert-ios{border-radius:13px;-webkit-box-shadow:none;box-shadow:none;overflow:hidden}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.alert-translucent.sc-ion-alert-ios-h .alert-wrapper.sc-ion-alert-ios{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.9);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}.alert-head.sc-ion-alert-ios{padding-left:16px;padding-right:16px;padding-top:12px;padding-bottom:7px;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-head.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.alert-title.sc-ion-alert-ios{margin-top:8px;color:var(--ion-text-color, #000);font-size:17px;font-weight:600}.alert-sub-title.sc-ion-alert-ios{color:var(--ion-color-step-600, #666666);font-size:14px}.alert-message.sc-ion-alert-ios,.alert-input-group.sc-ion-alert-ios{padding-left:16px;padding-right:16px;padding-top:0;padding-bottom:21px;color:var(--ion-text-color, #000);font-size:13px;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-message.sc-ion-alert-ios,.alert-input-group.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.alert-message.sc-ion-alert-ios{max-height:240px}.alert-message.sc-ion-alert-ios:empty{padding-left:0;padding-right:0;padding-top:0;padding-bottom:12px}.alert-input.sc-ion-alert-ios{border-radius:4px;margin-top:10px;padding-left:6px;padding-right:6px;padding-top:6px;padding-bottom:6px;border:0.55px solid var(--ion-color-step-250, #bfbfbf);background-color:var(--ion-background-color, #fff);-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-input.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px}}.alert-input.sc-ion-alert-ios::-webkit-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::-moz-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios:-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::-ms-clear{display:none}.alert-radio-group.sc-ion-alert-ios,.alert-checkbox-group.sc-ion-alert-ios{-ms-scroll-chaining:none;overscroll-behavior:contain;max-height:240px;border-top:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2);overflow-y:auto;-webkit-overflow-scrolling:touch}.alert-tappable.sc-ion-alert-ios{height:44px}.alert-radio-label.sc-ion-alert-ios{padding-left:13px;padding-right:13px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;-ms-flex-order:0;order:0;color:var(--ion-text-color, #000);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-radio-label.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:13px;padding-inline-start:13px;-webkit-padding-end:13px;padding-inline-end:13px}}[aria-checked=true].sc-ion-alert-ios .alert-radio-label.sc-ion-alert-ios{color:var(--ion-color-primary, #3880ff)}.alert-radio-icon.sc-ion-alert-ios{position:relative;-ms-flex-order:1;order:1;min-width:30px}[aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios{left:7px;top:-7px;position:absolute;width:6px;height:12px;-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:2px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--ion-color-primary, #3880ff)}[dir=rtl].sc-ion-alert-ios [aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios,[dir=rtl].sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios,[dir=rtl] .sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios{left:unset;right:unset;right:7px}.alert-checkbox-label.sc-ion-alert-ios{padding-left:13px;padding-right:13px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;color:var(--ion-text-color, #000);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-checkbox-label.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:13px;padding-inline-start:13px;-webkit-padding-end:13px;padding-inline-end:13px}}.alert-checkbox-icon.sc-ion-alert-ios{border-radius:50%;margin-left:16px;margin-right:6px;margin-top:10px;margin-bottom:10px;position:relative;width:24px;height:24px;border-width:1px;border-style:solid;border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));background-color:var(--ion-item-background, var(--ion-background-color, #fff));contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-checkbox-icon.sc-ion-alert-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:6px;margin-inline-end:6px}}[aria-checked=true].sc-ion-alert-ios .alert-checkbox-icon.sc-ion-alert-ios{border-color:var(--ion-color-primary, #3880ff);background-color:var(--ion-color-primary, #3880ff)}[aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios{left:9px;top:4px;position:absolute;width:5px;height:12px;-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:1px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--ion-background-color, #fff)}[dir=rtl].sc-ion-alert-ios [aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios,[dir=rtl].sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios,[dir=rtl] .sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios{left:unset;right:unset;right:9px}.alert-button-group.sc-ion-alert-ios{margin-right:-0.55px;-ms-flex-wrap:wrap;flex-wrap:wrap}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button-group.sc-ion-alert-ios{margin-right:unset;-webkit-margin-end:-0.55px;margin-inline-end:-0.55px}}.alert-button.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;border-radius:0;-ms-flex:1 1 auto;flex:1 1 auto;min-width:50%;height:44px;border-top:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2);border-right:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2);background-color:transparent;color:var(--ion-color-primary, #3880ff);font-size:17px;overflow:hidden}[dir=rtl].sc-ion-alert-ios .alert-button.sc-ion-alert-ios:first-child,[dir=rtl].sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:first-child,[dir=rtl] .sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:first-child{border-right:0}.alert-button.sc-ion-alert-ios:last-child{border-right:0;font-weight:bold}[dir=rtl].sc-ion-alert-ios .alert-button.sc-ion-alert-ios:last-child,[dir=rtl].sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:last-child,[dir=rtl] .sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:last-child{border-right:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2)}.alert-button.ion-activated.sc-ion-alert-ios{background-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1)}",alertMdCss=".sc-ion-alert-md-h{--min-width:250px;--width:auto;--min-height:auto;--height:auto;--max-height:90%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-alert-md-h{display:none}.alert-top.sc-ion-alert-md-h{padding-top:50px;-ms-flex-align:start;align-items:flex-start}.alert-wrapper.sc-ion-alert-md{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:content;opacity:0;z-index:10}.alert-title.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}.alert-sub-title.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-weight:normal}.alert-message.sc-ion-alert-md{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-overflow-scrolling:touch;overflow-y:auto;overscroll-behavior-y:contain}.alert-checkbox-group.sc-ion-alert-md::-webkit-scrollbar,.alert-radio-group.sc-ion-alert-md::-webkit-scrollbar,.alert-message.sc-ion-alert-md::-webkit-scrollbar{display:none}.alert-input.sc-ion-alert-md{padding-left:0;padding-right:0;padding-top:10px;padding-bottom:10px;width:100%;border:0;background:inherit;font:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.alert-button-group.sc-ion-alert-md{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;width:100%}.alert-button-group-vertical.sc-ion-alert-md{-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.alert-button.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;border:0;font-size:14px;line-height:20px;z-index:0}.alert-button.ion-focused.sc-ion-alert-md,.alert-tappable.ion-focused.sc-ion-alert-md{background:var(--ion-color-step-100, #e6e6e6)}.alert-button-inner.sc-ion-alert-md{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.alert-input-disabled.sc-ion-alert-md,.alert-checkbox-button-disabled.sc-ion-alert-md .alert-button-inner.sc-ion-alert-md,.alert-radio-button-disabled.sc-ion-alert-md .alert-button-inner.sc-ion-alert-md{cursor:default;opacity:0.5;pointer-events:none}.alert-tappable.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;width:100%;border:0;background:transparent;font-size:inherit;line-height:initial;text-align:start;-webkit-appearance:none;-moz-appearance:none;appearance:none;contain:strict}.alert-button.sc-ion-alert-md,.alert-checkbox.sc-ion-alert-md,.alert-input.sc-ion-alert-md,.alert-radio.sc-ion-alert-md{outline:none}.alert-radio-icon.sc-ion-alert-md,.alert-checkbox-icon.sc-ion-alert-md,.alert-checkbox-inner.sc-ion-alert-md{-webkit-box-sizing:border-box;box-sizing:border-box}textarea.alert-input.sc-ion-alert-md{min-height:37px;resize:none}.sc-ion-alert-md-h{--background:var(--ion-overlay-background-color, var(--ion-background-color, #fff));--max-width:280px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.32);font-size:14px}.alert-wrapper.sc-ion-alert-md{border-radius:4px;-webkit-box-shadow:0 11px 15px -7px rgba(0, 0, 0, 0.2), 0 24px 38px 3px rgba(0, 0, 0, 0.14), 0 9px 46px 8px rgba(0, 0, 0, 0.12);box-shadow:0 11px 15px -7px rgba(0, 0, 0, 0.2), 0 24px 38px 3px rgba(0, 0, 0, 0.14), 0 9px 46px 8px rgba(0, 0, 0, 0.12)}.alert-head.sc-ion-alert-md{padding-left:23px;padding-right:23px;padding-top:20px;padding-bottom:15px;text-align:start}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-head.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:23px;padding-inline-start:23px;-webkit-padding-end:23px;padding-inline-end:23px}}.alert-title.sc-ion-alert-md{color:var(--ion-text-color, #000);font-size:20px;font-weight:500}.alert-sub-title.sc-ion-alert-md{color:var(--ion-text-color, #000);font-size:16px}.alert-message.sc-ion-alert-md,.alert-input-group.sc-ion-alert-md{padding-left:24px;padding-right:24px;padding-top:20px;padding-bottom:20px;color:var(--ion-color-step-550, #737373)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-message.sc-ion-alert-md,.alert-input-group.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:24px;padding-inline-start:24px;-webkit-padding-end:24px;padding-inline-end:24px}}.alert-message.sc-ion-alert-md{max-height:240px;font-size:16px}.alert-message.sc-ion-alert-md:empty{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}.alert-head.sc-ion-alert-md+.alert-message.sc-ion-alert-md{padding-top:0}.alert-input.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:5px;border-bottom:1px solid var(--ion-color-step-150, #d9d9d9);color:var(--ion-text-color, #000)}.alert-input.sc-ion-alert-md::-webkit-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::-moz-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md:-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::-ms-clear{display:none}.alert-input.sc-ion-alert-md:focus{margin-bottom:4px;border-bottom:2px solid var(--ion-color-primary, #3880ff)}.alert-radio-group.sc-ion-alert-md,.alert-checkbox-group.sc-ion-alert-md{position:relative;max-height:240px;border-top:1px solid var(--ion-color-step-150, #d9d9d9);border-bottom:1px solid var(--ion-color-step-150, #d9d9d9);overflow:auto}.alert-tappable.sc-ion-alert-md{position:relative;height:48px;overflow:hidden}.alert-radio-label.sc-ion-alert-md{padding-left:52px;padding-right:26px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;color:var(--ion-color-step-850, #262626);font-size:16px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-radio-label.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:52px;padding-inline-start:52px;-webkit-padding-end:26px;padding-inline-end:26px}}.alert-radio-icon.sc-ion-alert-md{left:26px;top:0;border-radius:50%;display:block;position:relative;width:20px;height:20px;border-width:2px;border-style:solid;border-color:var(--ion-color-step-550, #737373)}[dir=rtl].sc-ion-alert-md .alert-radio-icon.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h .alert-radio-icon.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h .alert-radio-icon.sc-ion-alert-md{left:unset;right:unset;right:26px}.alert-radio-inner.sc-ion-alert-md{left:3px;top:3px;border-radius:50%;position:absolute;width:10px;height:10px;-webkit-transform:scale3d(0, 0, 0);transform:scale3d(0, 0, 0);-webkit-transition:-webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:-webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:transform 280ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--ion-color-primary, #3880ff)}[dir=rtl].sc-ion-alert-md .alert-radio-inner.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h .alert-radio-inner.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h .alert-radio-inner.sc-ion-alert-md{left:unset;right:unset;right:3px}[aria-checked=true].sc-ion-alert-md .alert-radio-label.sc-ion-alert-md{color:var(--ion-color-step-850, #262626)}[aria-checked=true].sc-ion-alert-md .alert-radio-icon.sc-ion-alert-md{border-color:var(--ion-color-primary, #3880ff)}[aria-checked=true].sc-ion-alert-md .alert-radio-inner.sc-ion-alert-md{-webkit-transform:scale3d(1, 1, 1);transform:scale3d(1, 1, 1)}.alert-checkbox-label.sc-ion-alert-md{padding-left:53px;padding-right:26px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;color:var(--ion-color-step-850, #262626);font-size:16px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-checkbox-label.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:53px;padding-inline-start:53px;-webkit-padding-end:26px;padding-inline-end:26px}}.alert-checkbox-icon.sc-ion-alert-md{left:26px;top:0;border-radius:2px;position:relative;width:16px;height:16px;border-width:2px;border-style:solid;border-color:var(--ion-color-step-550, #737373);contain:strict}[dir=rtl].sc-ion-alert-md .alert-checkbox-icon.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h .alert-checkbox-icon.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h .alert-checkbox-icon.sc-ion-alert-md{left:unset;right:unset;right:26px}[aria-checked=true].sc-ion-alert-md .alert-checkbox-icon.sc-ion-alert-md{border-color:var(--ion-color-primary, #3880ff);background-color:var(--ion-color-primary, #3880ff)}[aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md{left:3px;top:0;position:absolute;width:6px;height:10px;-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:2px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--ion-color-primary-contrast, #fff)}[dir=rtl].sc-ion-alert-md [aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h [aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h [aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md{left:unset;right:unset;right:3px}.alert-button-group.sc-ion-alert-md{padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse;-ms-flex-pack:end;justify-content:flex-end}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button-group.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.alert-button.sc-ion-alert-md{border-radius:2px;margin-left:0;margin-right:8px;margin-top:0;margin-bottom:0;padding-left:10px;padding-right:10px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;color:var(--ion-color-primary, #3880ff);font-weight:500;text-align:end;text-transform:uppercase;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button.sc-ion-alert-md{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:10px;padding-inline-start:10px;-webkit-padding-end:10px;padding-inline-end:10px}}.alert-button-inner.sc-ion-alert-md{-ms-flex-pack:end;justify-content:flex-end}",Alert=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.processedInputs=[],this.processedButtons=[],this.presented=!1,this.keyboardClose=!0,this.buttons=[],this.inputs=[],this.backdropDismiss=!0,this.translucent=!1,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,BACKDROP)},this.dispatchCancelHandler=t=>{if(isCancel(t.detail.role)){const t=this.processedButtons.find(t=>"cancel"===t.role);this.callButtonHandler(t)}},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionAlertDidPresent",7),this.willPresent=createEvent(this,"ionAlertWillPresent",7),this.willDismiss=createEvent(this,"ionAlertWillDismiss",7),this.didDismiss=createEvent(this,"ionAlertDidDismiss",7)}buttonsChanged(){this.processedButtons=this.buttons.map(t=>"string"==typeof t?{text:t,role:"cancel"===t.toLowerCase()?"cancel":void 0}:t)}inputsChanged(){const t=this.inputs,e=new Set(t.map(t=>t.type));e.has("checkbox")&&e.has("radio")&&console.warn(`Alert cannot mix input types: ${Array.from(e.values()).join("/")}. Please see alert docs for more info.`),this.inputType=e.values().next().value,this.processedInputs=t.map((t,e)=>({type:t.type||"text",name:t.name||""+e,placeholder:t.placeholder||"",value:t.value,label:t.label,checked:!!t.checked,disabled:!!t.disabled,id:t.id||`alert-input-${this.overlayIndex}-${e}`,handler:t.handler,min:t.min,max:t.max}))}componentWillLoad(){this.inputsChanged(),this.buttonsChanged()}present(){return present(this,"alertEnter",iosEnterAnimation$1,mdEnterAnimation$1)}dismiss(t,e){return dismiss(this,t,e,"alertLeave",iosLeaveAnimation$1,mdLeaveAnimation$1)}onDidDismiss(){return eventMethod(this.el,"ionAlertDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionAlertWillDismiss")}rbClick(t){for(const e of this.processedInputs)e.checked=e===t;this.activeId=t.id,safeCall$1(t.handler,t),forceUpdate(this)}cbClick(t){t.checked=!t.checked,safeCall$1(t.handler,t),forceUpdate(this)}buttonClick(t){const e=t.role,i=this.getValues();if(isCancel(e))return this.dismiss({values:i},e);const n=this.callButtonHandler(t,i);return!1!==n?this.dismiss(Object.assign({values:i},n),t.role):Promise.resolve(!1)}callButtonHandler(t,e){if(t&&t.handler){const i=safeCall$1(t.handler,e);if(!1===i)return!1;if("object"==typeof i)return i}return{}}getValues(){if(0===this.processedInputs.length)return;if("radio"===this.inputType){const t=this.processedInputs.find(t=>!!t.checked);return t?t.value:void 0}if("checkbox"===this.inputType)return this.processedInputs.filter(t=>t.checked).map(t=>t.value);const t={};return this.processedInputs.forEach(e=>{t[e.name]=e.value||""}),t}renderAlertInputs(t){switch(this.inputType){case"checkbox":return this.renderCheckbox(t);case"radio":return this.renderRadio(t);default:return this.renderInput(t)}}renderCheckbox(t){const e=this.processedInputs,i=getIonMode(this);return 0===e.length?null:h("div",{class:"alert-checkbox-group","aria-labelledby":t},e.map(t=>h("button",{type:"button",onClick:()=>this.cbClick(t),"aria-checked":""+t.checked,id:t.id,disabled:t.disabled,tabIndex:0,role:"checkbox",class:{"alert-tappable":!0,"alert-checkbox":!0,"alert-checkbox-button":!0,"ion-focusable":!0,"alert-checkbox-button-disabled":t.disabled||!1}},h("div",{class:"alert-button-inner"},h("div",{class:"alert-checkbox-icon"},h("div",{class:"alert-checkbox-inner"})),h("div",{class:"alert-checkbox-label"},t.label)),"md"===i&&h("ion-ripple-effect",null))))}renderRadio(t){const e=this.processedInputs;return 0===e.length?null:h("div",{class:"alert-radio-group",role:"radiogroup","aria-labelledby":t,"aria-activedescendant":this.activeId},e.map(t=>h("button",{type:"button",onClick:()=>this.rbClick(t),"aria-checked":""+t.checked,disabled:t.disabled,id:t.id,tabIndex:0,class:{"alert-radio-button":!0,"alert-tappable":!0,"alert-radio":!0,"ion-focusable":!0,"alert-radio-button-disabled":t.disabled||!1},role:"radio"},h("div",{class:"alert-button-inner"},h("div",{class:"alert-radio-icon"},h("div",{class:"alert-radio-inner"})),h("div",{class:"alert-radio-label"},t.label)))))}renderInput(t){const e=this.processedInputs;return 0===e.length?null:h("div",{class:"alert-input-group","aria-labelledby":t},e.map(t=>h("div",{class:"alert-input-wrapper"},"textarea"===t.type?h("textarea",{placeholder:t.placeholder,value:t.value,onInput:e=>t.value=e.target.value,id:t.id,disabled:t.disabled,tabIndex:0,class:{"alert-input":!0,"alert-input-disabled":t.disabled||!1}}):h("input",{placeholder:t.placeholder,value:t.value,type:t.type,min:t.min,max:t.max,onInput:e=>t.value=e.target.value,id:t.id,disabled:t.disabled,tabIndex:0,class:{"alert-input":!0,"alert-input-disabled":t.disabled||!1}}))))}renderAlertButtons(){const t=this.processedButtons,e=getIonMode(this);return h("div",{class:{"alert-button-group":!0,"alert-button-group-vertical":t.length>2}},t.map(t=>h("button",{type:"button",class:buttonClass$1(t),tabIndex:0,onClick:()=>this.buttonClick(t)},h("span",{class:"alert-button-inner"},t.text),"md"===e&&h("ion-ripple-effect",null))))}render(){const{overlayIndex:t,header:e,subHeader:i}=this,n=getIonMode(this),s=`alert-${t}-hdr`,o=`alert-${t}-sub-hdr`,r=`alert-${t}-msg`;let a;return void 0!==e?a=s:void 0!==i&&(a=o),h(Host,{role:"dialog","aria-modal":"true",style:{zIndex:""+(2e4+t)},class:Object.assign(Object.assign({},getClassMap(this.cssClass)),{[n]:!0,"alert-translucent":this.translucent}),onIonAlertWillDismiss:this.dispatchCancelHandler,onIonBackdropTap:this.onBackdropTap},h("ion-backdrop",{tappable:this.backdropDismiss}),h("div",{class:"alert-wrapper"},h("div",{class:"alert-head"},e&&h("h2",{id:s,class:"alert-title"},e),i&&h("h2",{id:o,class:"alert-sub-title"},i)),h("div",{id:r,class:"alert-message",innerHTML:sanitizeDOMString(this.message)}),this.renderAlertInputs(a),this.renderAlertButtons()))}get el(){return this}static get watchers(){return{buttons:["buttonsChanged"],inputs:["inputsChanged"]}}static get style(){return{ios:alertIosCss,md:alertMdCss}}},buttonClass$1=t=>Object.assign({"alert-button":!0,"ion-focusable":!0,"ion-activatable":!0},getClassMap(t.cssClass)),appCss="html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}",App=class extends HTMLElement{constructor(){super(),this.__registerHost()}componentDidLoad(){rIC(()=>{const t=isPlatform(window,"hybrid");config.getBoolean("_testing")||import("./p-9091a351.mjs").then(t=>t.startTapClick(config)),config.getBoolean("statusTap",t)&&import("./p-81357737.mjs").then(t=>t.startStatusTap()),config.getBoolean("inputShims",needInputShims())&&import("./p-cf631d57.mjs").then(t=>t.startInputShims(config)),config.getBoolean("hardwareBackButton",t)&&Promise.resolve().then((function(){return hardwareBackButton})).then(t=>t.startHardwareBackButton()),import("./p-94452b39.mjs").then(t=>t.startFocusVisible())})}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"ion-page":!0,"force-statusbar-padding":config.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return appCss}},needInputShims=()=>isPlatform(window,"ios")&&isPlatform(window,"mobile"),rIC=t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,32)},avatarIosCss=":host{border-radius:var(--border-radius);display:block}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}:host{--border-radius:50%;width:48px;height:48px}",avatarMdCss=":host{border-radius:var(--border-radius);display:block}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}:host{--border-radius:50%;width:64px;height:64px}",Avatar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h(Host,{class:getIonMode(this)},h("slot",null))}static get style(){return{ios:avatarIosCss,md:avatarMdCss}}},backButtonIosCss=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:var(--margin-start);margin-right:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end)}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{padding-left:var(--icon-padding-start);padding-right:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);margin-left:var(--icon-margin-start);margin-right:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-icon{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end)}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-icon{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--background-hover:transparent;--background-hover-opacity:1;--background-focused:currentColor;--background-focused-opacity:.1;--border-radius:4px;--color:var(--ion-color-primary, #3880ff);--icon-margin-end:-5px;--icon-margin-start:-4px;--icon-font-size:1.85em;--min-height:32px;font-size:17px}.button-native{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:visible;z-index:99}:host(.ion-activated) .button-native{opacity:0.4}@media (any-hover: hover){:host(:hover){opacity:0.6}}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}',backButtonMdCss=':host{--background:transparent;--color-focused:currentColor;--color-hover:currentColor;--icon-margin-top:0;--icon-margin-bottom:0;--icon-padding-top:0;--icon-padding-end:0;--icon-padding-bottom:0;--icon-padding-start:0;--margin-top:0;--margin-end:0;--margin-bottom:0;--margin-start:0;--min-width:auto;--min-height:auto;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--opacity:1;--ripple-color:currentColor;--transition:background-color, opacity 100ms linear;display:none;min-width:var(--min-width);min-height:var(--min-height);color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-font-kerning:none;font-kerning:none}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.show-back-button){display:block}:host(.back-button-disabled){cursor:default;opacity:0.5;pointer-events:none}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:var(--margin-start);margin-right:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;min-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;opacity:var(--opacity);overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end)}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{padding-left:var(--icon-padding-start);padding-right:var(--icon-padding-end);padding-top:var(--icon-padding-top);padding-bottom:var(--icon-padding-bottom);margin-left:var(--icon-margin-start);margin-right:var(--icon-margin-end);margin-top:var(--icon-margin-top);margin-bottom:var(--icon-margin-bottom);display:inherit;font-size:var(--icon-font-size);font-weight:var(--icon-font-weight);pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-icon{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--icon-padding-start);padding-inline-start:var(--icon-padding-start);-webkit-padding-end:var(--icon-padding-end);padding-inline-end:var(--icon-padding-end)}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-icon{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--icon-margin-start);margin-inline-start:var(--icon-margin-start);-webkit-margin-end:var(--icon-margin-end);margin-inline-end:var(--icon-margin-end)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--border-radius:4px;--background-focused:currentColor;--background-focused-opacity:.12;--background-hover:currentColor;--background-hover-opacity:0.04;--color:currentColor;--icon-margin-end:0;--icon-margin-start:0;--icon-font-size:24px;--icon-font-weight:normal;--min-height:32px;--min-width:44px;--padding-start:12px;--padding-end:12px;font-size:14px;font-weight:500;text-transform:uppercase}:host(.back-button-has-icon-only){--border-radius:50%;min-width:48px;height:48px}.button-native{-webkit-box-shadow:none;box-shadow:none}.button-text{padding-left:4px;padding-right:4px;padding-top:0;padding-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-text{padding-left:unset;padding-right:unset;-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px}}ion-icon{line-height:0.67;text-align:start}@media (any-hover: hover){:host(.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}',BackButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.disabled=!1,this.type="button",this.onClick=async t=>{const e=this.el.closest("ion-nav");return t.preventDefault(),e&&await e.canGoBack()?e.pop({skipIfBusy:!0}):openURL(this.defaultHref,t,"back")}}get backButtonIcon(){const t=this.icon;return null!=t?t:"ios"===getIonMode(this)?config.get("backButtonIcon","chevron-back"):config.get("backButtonIcon","arrow-back-sharp")}get backButtonText(){const t="ios"===getIonMode(this)?"Back":null;return null!=this.text?this.text:config.get("backButtonText",t)}get hasIconOnly(){return this.backButtonIcon&&!this.backButtonText}get rippleType(){return this.hasIconOnly?"unbounded":"bounded"}render(){const{color:t,defaultHref:e,disabled:i,type:n,hasIconOnly:s,backButtonIcon:o,backButtonText:r}=this,a=void 0!==e,l=getIonMode(this);return h(Host,{onClick:this.onClick,class:Object.assign(Object.assign({},createColorClasses(t)),{[l]:!0,button:!0,"back-button-disabled":i,"back-button-has-icon-only":s,"in-toolbar":hostContext("ion-toolbar",this.el),"in-toolbar-color":hostContext("ion-toolbar[color]",this.el),"ion-activatable":!0,"ion-focusable":!0,"show-back-button":a})},h("button",{type:n,disabled:i,class:"button-native",part:"button"},h("span",{class:"button-inner"},o&&h("ion-icon",{icon:o,lazy:!1,part:"icon"}),r&&h("span",{class:"button-text",part:"text"},r)),"md"===l&&h("ion-ripple-effect",{type:this.rippleType})))}get el(){return this}static get style(){return{ios:backButtonIosCss,md:backButtonMdCss}}};class GestureController{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(t){return new GestureDelegate(this,this.newID(),t.name,t.priority||0,!!t.disableScroll)}createBlocker(t={}){return new BlockerDelegate(this,this.newID(),t.disable,!!t.disableScroll)}start(t,e,i){return this.canStart(t)?(this.requestedStart.set(e,i),!0):(this.requestedStart.delete(e),!1)}capture(t,e,i){if(!this.start(t,e,i))return!1;const n=this.requestedStart;let s=-1e4;if(n.forEach(t=>{s=Math.max(s,t)}),s===i){this.capturedId=e,n.clear();const i=new CustomEvent("ionGestureCaptured",{detail:{gestureName:t}});return document.dispatchEvent(i),!0}return n.delete(e),!1}release(t){this.requestedStart.delete(t),this.capturedId===t&&(this.capturedId=void 0)}disableGesture(t,e){let i=this.disabledGestures.get(t);void 0===i&&(i=new Set,this.disabledGestures.set(t,i)),i.add(e)}enableGesture(t,e){const i=this.disabledGestures.get(t);void 0!==i&&i.delete(e)}disableScroll(t){this.disabledScroll.add(t),1===this.disabledScroll.size&&document.body.classList.add(BACKDROP_NO_SCROLL)}enableScroll(t){this.disabledScroll.delete(t),0===this.disabledScroll.size&&document.body.classList.remove(BACKDROP_NO_SCROLL)}canStart(t){return void 0===this.capturedId&&!this.isDisabled(t)}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(t){const e=this.disabledGestures.get(t);return!!(e&&e.size>0)}newID(){return this.gestureId++,this.gestureId}}class GestureDelegate{constructor(t,e,i,n,s){this.id=e,this.name=i,this.disableScroll=s,this.priority=1e6*n+e,this.ctrl=t}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const t=this.ctrl.capture(this.name,this.id,this.priority);return t&&this.disableScroll&&this.ctrl.disableScroll(this.id),t}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class BlockerDelegate{constructor(t,e,i,n){this.id=e,this.disable=i,this.disableScroll=n,this.ctrl=t}block(){if(this.ctrl){if(this.disable)for(const t of this.disable)this.ctrl.disableGesture(t,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const t of this.disable)this.ctrl.enableGesture(t,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const BACKDROP_NO_SCROLL="backdrop-no-scroll",GESTURE_CONTROLLER=new GestureController,addEventListener$1=(t,e,i,n)=>{const s=supportsPassive(t)?{capture:!!n.capture,passive:!!n.passive}:!!n.capture;let o,r;return t.__zone_symbol__addEventListener?(o="__zone_symbol__addEventListener",r="__zone_symbol__removeEventListener"):(o="addEventListener",r="removeEventListener"),t[o](e,i,s),()=>{t[r](e,i,s)}},supportsPassive=t=>{if(void 0===_sPassive)try{const e=Object.defineProperty({},"passive",{get:()=>{_sPassive=!0}});t.addEventListener("optsTest",()=>{},e)}catch(e){_sPassive=!1}return!!_sPassive};let _sPassive;const MOUSE_WAIT=2e3,createPointerEvents=(t,e,i,n,s)=>{let o,r,a,l,c,h,d,u=0;const m=n=>{u=Date.now()+MOUSE_WAIT,e(n)&&(!r&&i&&(r=addEventListener$1(t,"touchmove",i,s)),a||(a=addEventListener$1(t,"touchend",b,s)),l||(l=addEventListener$1(t,"touchcancel",b,s)))},p=n=>{u>Date.now()||e(n)&&(!h&&i&&(h=addEventListener$1(getDocument(t),"mousemove",i,s)),d||(d=addEventListener$1(getDocument(t),"mouseup",f,s)))},b=t=>{g(),n&&n(t)},f=t=>{y(),n&&n(t)},g=()=>{r&&r(),a&&a(),l&&l(),r=a=l=void 0},y=()=>{h&&h(),d&&d(),h=d=void 0},v=()=>{g(),y()},Z=(e=!0)=>{e?(o||(o=addEventListener$1(t,"touchstart",m,s)),c||(c=addEventListener$1(t,"mousedown",p,s))):(o&&o(),c&&c(),o=c=void 0,v())};return{enable:Z,stop:v,destroy:()=>{Z(!1),n=i=e=void 0}}},getDocument=t=>t instanceof Document?t:t.ownerDocument,createPanRecognizer=(t,e,i)=>{const n=i*(Math.PI/180),s="x"===t,o=Math.cos(n),r=e*e;let a=0,l=0,c=!1,h=0;return{start(t,e){a=t,l=e,h=0,c=!0},detect(t,e){if(!c)return!1;const i=t-a,n=e-l,d=i*i+n*n;if(d<r)return!1;const u=Math.sqrt(d),m=(s?i:n)/u;return h=m>o?1:m<-o?-1:0,c=!1,!0},isGesture:()=>0!==h,getDirection:()=>h}},createGesture=t=>{let e=!1,i=!1,n=!0,s=!1;const o=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},t),r=o.canStart,a=o.onWillStart,l=o.onStart,c=o.onEnd,h=o.notCaptured,d=o.onMove,u=o.threshold,m={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},p=createPanRecognizer(o.direction,o.threshold,o.maxAngle),b=GESTURE_CONTROLLER.createGesture({name:t.gestureName,priority:t.gesturePriority,disableScroll:t.disableScroll}),f=()=>{e&&(s=!1,d&&d(m))},g=()=>!(b&&!b.capture()||(e=!0,n=!1,m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime,a?a(m).then(y):y(),0)),y=()=>{l&&l(m),n=!0},v=()=>{e=!1,i=!1,s=!1,n=!0,b.release()},Z=t=>{const i=e,s=n;v(),s&&(calcGestureData(m,t),i?c&&c(m):h&&h(m))},x=createPointerEvents(o.el,t=>{const e=now$1(t);return!(i||!n)&&(updateDetail(t,m),m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime=e,m.velocityX=m.velocityY=m.deltaX=m.deltaY=0,m.event=t,(!r||!1!==r(m))&&(b.release(),!!b.start()&&(i=!0,0===u?g():(p.start(m.startX,m.startY),!0))))},t=>{e?!s&&n&&(s=!0,calcGestureData(m,t),requestAnimationFrame(f)):(calcGestureData(m,t),p.detect(m.currentX,m.currentY)&&(p.isGesture()&&g()||G()))},Z,{capture:!1}),G=()=>{v(),x.stop(),h&&h(m)};return{enable(t=!0){t||(e&&Z(void 0),v()),x.enable(t)},destroy(){b.destroy(),x.destroy()}}},calcGestureData=(t,e)=>{if(!e)return;const i=t.currentX,n=t.currentY,s=t.currentTime;updateDetail(e,t);const o=t.currentX,r=t.currentY,a=(t.currentTime=now$1(e))-s;if(a>0&&a<100){const e=(r-n)/a;t.velocityX=(o-i)/a*.7+.3*t.velocityX,t.velocityY=.7*e+.3*t.velocityY}t.deltaX=o-t.startX,t.deltaY=r-t.startY,t.event=e},updateDetail=(t,e)=>{let i=0,n=0;if(t){const e=t.changedTouches;if(e&&e.length>0){const t=e[0];i=t.clientX,n=t.clientY}else void 0!==t.pageX&&(i=t.pageX,n=t.pageY)}e.currentX=i,e.currentY=n},now$1=t=>t.timeStamp||Date.now();var index$1=Object.freeze({__proto__:null,createGesture,GESTURE_CONTROLLER});const backdropIosCss=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",backdropMdCss=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",Backdrop=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.lastClick=-1e4,this.blocker=GESTURE_CONTROLLER.createBlocker({disableScroll:!0}),this.visible=!0,this.tappable=!0,this.stopPropagation=!0,this.ionBackdropTap=createEvent(this,"ionBackdropTap",7)}connectedCallback(){this.stopPropagation&&this.blocker.block()}disconnectedCallback(){this.blocker.unblock()}onTouchStart(t){this.lastClick=now(t),this.emitTap(t)}onMouseDown(t){this.lastClick<now(t)-2500&&this.emitTap(t)}emitTap(t){this.stopPropagation&&(t.preventDefault(),t.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const t=getIonMode(this);return h(Host,{tabindex:"-1",class:{[t]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:backdropIosCss,md:backdropMdCss}}},badgeIosCss=":host{--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff);--padding-top:3px;--padding-end:8px;--padding-bottom:3px;--padding-start:8px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:inline-block;min-width:10px;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);font-size:13px;font-weight:bold;line-height:1;text-align:center;white-space:nowrap;contain:content;vertical-align:baseline}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(:empty){display:none}:host{border-radius:10px}",badgeMdCss=":host{--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff);--padding-top:3px;--padding-end:8px;--padding-bottom:3px;--padding-start:8px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:inline-block;min-width:10px;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);font-size:13px;font-weight:bold;line-height:1;text-align:center;white-space:nowrap;contain:content;vertical-align:baseline}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(:empty){display:none}:host{--padding-top:3px;--padding-end:4px;--padding-bottom:4px;--padding-start:4px;border-radius:4px}",Badge=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0})},h("slot",null))}static get style(){return{ios:badgeIosCss,md:badgeMdCss}}},buttonIosCss=':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;pointer-events:auto;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){margin-left:-0.3em;margin-right:0.3em;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em}}::slotted(ion-icon[slot=end]){margin-left:0.3em;margin-right:-0.2em;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em}}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host{--border-radius:10px;--padding-top:0;--padding-bottom:0;--padding-start:1em;--padding-end:1em;--transition:background-color, opacity 100ms linear;margin-left:2px;margin-right:2px;margin-top:4px;margin-bottom:4px;height:2.8em;font-size:16px;font-weight:500;letter-spacing:-0.03em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px}}:host(.button-solid){--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1}:host(.button-outline){--border-radius:10px;--border-width:1px;--border-style:solid;--background-activated:var(--ion-color-primary, #3880ff);--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;--color-activated:var(--ion-color-primary-contrast, #fff)}:host(.button-clear){--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;font-size:17px;font-weight:normal;letter-spacing:0}:host(.button-large){--border-radius:12px;--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--border-radius:6px;--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-strong){font-weight:600}:host(.button-clear.ion-activated){opacity:0.4}:host(.button-outline.ion-activated.ion-color) .button-native{color:var(--ion-color-contrast)}:host(.button-outline.ion-activated.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}:host(.button-outline.ion-focused.ion-color) .button-native,:host(.button-clear.ion-focused.ion-color) .button-native{color:var(--ion-color-base)}:host(.button-outline.ion-focused.ion-color) .button-native::after,:host(.button-clear.ion-focused.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.button-clear:hover),:host(.button-outline:hover){opacity:0.6}:host(.button-clear.ion-color:hover) .button-native,:host(.button-outline.ion-color:hover) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:transparent}:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}:host(:hover.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native::after{background:#fff;opacity:0.1}}',buttonMdCss=':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;pointer-events:auto;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){margin-left:-0.3em;margin-right:0.3em;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em}}::slotted(ion-icon[slot=end]){margin-left:0.3em;margin-right:-0.2em;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em}}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host{--border-radius:4px;--padding-top:0;--padding-bottom:0;--padding-start:1.1em;--padding-end:1.1em;--transition:box-shadow 280ms cubic-bezier(.4, 0, .2, 1),\n                background-color 15ms linear,\n                color 15ms linear;margin-left:2px;margin-right:2px;margin-top:4px;margin-bottom:4px;height:36px;font-size:14px;font-weight:500;letter-spacing:0.06em;text-transform:uppercase}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px}}:host(.button-solid){--background-activated:transparent;--background-hover:var(--ion-color-primary-contrast, #fff);--background-focused:var(--ion-color-primary-contrast, #fff);--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}:host(.button-solid.ion-activated){--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12)}:host(.button-outline){--border-width:2px;--border-style:solid;--box-shadow:none;--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-outline.ion-activated.ion-color) .button-native{background:transparent}:host(.button-clear){--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-large){--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-strong){font-weight:bold}::slotted(ion-icon[slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast);opacity:0.24}:host(.button-clear.ion-color.ion-focused) .button-native::after,:host(.button-outline.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base);opacity:0.12}@media (any-hover: hover){:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-contrast);opacity:0.08}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:var(--ion-color-base);opacity:0.04}}',Button=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inItem=!1,this.inListHeader=!1,this.inToolbar=!1,this.buttonType="button",this.disabled=!1,this.routerDirection="forward",this.strong=!1,this.type="button",this.handleClick=t=>{if("button"===this.type)openURL(this.href,t,this.routerDirection);else if(hasShadowDom(this.el)){const e=this.el.closest("form");if(e){t.preventDefault();const i=document.createElement("button");i.type=this.type,i.style.display="none",e.appendChild(i),i.click(),i.remove()}}},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7)}componentWillLoad(){this.inToolbar=!!this.el.closest("ion-buttons"),this.inListHeader=!!this.el.closest("ion-list-header"),this.inItem=!!this.el.closest("ion-item")||!!this.el.closest("ion-item-divider")}get hasIconOnly(){return!!this.el.querySelector('ion-icon[slot="icon-only"]')}get rippleType(){return(void 0===this.fill||"clear"===this.fill)&&this.hasIconOnly&&this.inToolbar?"unbounded":"bounded"}render(){const t=getIonMode(this),{buttonType:e,type:i,disabled:n,rel:s,target:o,size:r,href:a,color:l,expand:c,hasIconOnly:d,shape:u,strong:m}=this,p=void 0===r&&this.inItem?"small":r,b=void 0===a?"button":"a",f="button"===b?{type:i}:{download:this.download,href:a,rel:s,target:o};let g=this.fill;return void 0===g&&(g=this.inToolbar||this.inListHeader?"clear":"solid"),h(Host,{onClick:this.handleClick,"aria-disabled":n?"true":null,class:Object.assign(Object.assign({},createColorClasses(l)),{[t]:!0,[e]:!0,[`${e}-${c}`]:void 0!==c,[`${e}-${p}`]:void 0!==p,[`${e}-${u}`]:void 0!==u,[`${e}-${g}`]:!0,[e+"-strong"]:m,"in-toolbar":hostContext("ion-toolbar",this.el),"in-toolbar-color":hostContext("ion-toolbar[color]",this.el),"button-has-icon-only":d,"button-disabled":n,"ion-activatable":!0,"ion-focusable":!0})},h(b,Object.assign({},f,{class:"button-native",disabled:n,onFocus:this.onFocus,onBlur:this.onBlur,part:"button"}),h("span",{class:"button-inner",part:"button-inner"},h("slot",{name:"icon-only"}),h("slot",{name:"start"}),h("slot",null),h("slot",{name:"end"})),"md"===t&&h("ion-ripple-effect",{type:this.rippleType})))}get el(){return this}static get style(){return{ios:buttonIosCss,md:buttonMdCss}}},buttonsIosCss=".sc-ion-buttons-ios-h{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:99}.sc-ion-buttons-ios-s ion-button{--padding-top:0;--padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.sc-ion-buttons-ios-s ion-button{--padding-start:5px;--padding-end:5px;margin-left:2px;margin-right:2px;height:32px;font-size:17px;font-weight:400}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-buttons-ios-s ion-button{margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px}}.sc-ion-buttons-ios-s ion-button:not(.button-round){--border-radius:4px}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button{--color:initial;--border-color:initial;--background-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-solid,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-solid{--background:var(--ion-color-contrast);--background-focused:#000;--background-focused-opacity:.12;--background-activated:#000;--background-activated-opacity:.12;--background-hover:var(--ion-color-base);--background-hover-opacity:0.45;--color:var(--ion-color-base);--color-focused:var(--ion-color-base)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-clear,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-clear{--color-activated:var(--ion-color-contrast);--color-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-outline,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-outline{--color-activated:var(--ion-color-base);--color-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-s .button-clear,.sc-ion-buttons-ios-s .button-outline{--background-activated:transparent;--background-focused:currentColor;--background-hover:transparent}.sc-ion-buttons-ios-s .button-solid:not(.ion-color){--background-focused:#000;--background-focused-opacity:.12;--background-activated:#000;--background-activated-opacity:.12}.sc-ion-buttons-ios-s ion-icon[slot=start]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;margin-right:0.3em;font-size:24px;line-height:0.67}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-buttons-ios-s ion-icon[slot=start]{margin-right:unset;-webkit-margin-end:0.3em;margin-inline-end:0.3em}}.sc-ion-buttons-ios-s ion-icon[slot=end]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;margin-left:0.4em;font-size:24px;line-height:0.67}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-buttons-ios-s ion-icon[slot=end]{margin-left:unset;-webkit-margin-start:0.4em;margin-inline-start:0.4em}}.sc-ion-buttons-ios-s ion-icon[slot=icon-only]{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;font-size:28px;line-height:0.67}",buttonsMdCss=".sc-ion-buttons-md-h{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:99}.sc-ion-buttons-md-s ion-button{--padding-top:0;--padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.sc-ion-buttons-md-s ion-button{--padding-top:0;--padding-bottom:0;--padding-start:8px;--padding-end:8px;--box-shadow:none;margin-left:2px;margin-right:2px;height:32px;font-size:14px;font-weight:500}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-buttons-md-s ion-button{margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px}}.sc-ion-buttons-md-s ion-button:not(.button-round){--border-radius:2px}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button{--color:initial;--color-focused:var(--ion-color-contrast);--color-hover:var(--ion-color-contrast);--background-activated:transparent;--background-focused:var(--ion-color-contrast);--background-hover:var(--ion-color-contrast)}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button-solid,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button-solid{--background:var(--ion-color-contrast);--background-activated:transparent;--background-focused:var(--ion-color-shade);--background-hover:var(--ion-color-base);--color:var(--ion-color-base);--color-focused:var(--ion-color-base);--color-hover:var(--ion-color-base)}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button-outline,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button-outline{--border-color:var(--ion-color-contrast)}.sc-ion-buttons-md-s .button-has-icon-only.button-clear{--padding-top:12px;--padding-end:12px;--padding-bottom:12px;--padding-start:12px;--border-radius:50%;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;width:48px;height:48px}.sc-ion-buttons-md-s .button{--background-hover:currentColor}.sc-ion-buttons-md-s .button-solid{--color:var(--ion-toolbar-background, var(--ion-background-color, #fff));--background:var(--ion-toolbar-color, var(--ion-text-color, #424242));--background-activated:transparent;--background-focused:currentColor}.sc-ion-buttons-md-s .button-outline{--color:initial;--background:transparent;--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--border-color:currentColor}.sc-ion-buttons-md-s .button-clear{--color:initial;--background:transparent;--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor}.sc-ion-buttons-md-s ion-icon[slot=start]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;margin-right:0.3em;font-size:1.4em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-buttons-md-s ion-icon[slot=start]{margin-right:unset;-webkit-margin-end:0.3em;margin-inline-end:0.3em}}.sc-ion-buttons-md-s ion-icon[slot=end]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;margin-left:0.4em;font-size:1.4em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-buttons-md-s ion-icon[slot=end]{margin-left:unset;-webkit-margin-start:0.4em;margin-inline-start:0.4em}}.sc-ion-buttons-md-s ion-icon[slot=icon-only]{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;font-size:1.8em}",Buttons=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.collapse=!1}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"buttons-collapse":this.collapse}})}static get style(){return{ios:buttonsIosCss,md:buttonsMdCss}}},cardIosCss=":host{--ion-safe-area-left:0px;--ion-safe-area-right:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.card-disabled){cursor:default;opacity:0.3;pointer-events:none}.card-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:inherit}.card-native::-moz-focus-inner{border:0}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}ion-ripple-effect{color:var(--ripple-color)}:host{--background:var(--ion-item-background, var(--ion-background-color, #fff));--color:var(--ion-color-step-600, #666666);margin-left:16px;margin-right:16px;margin-top:24px;margin-bottom:24px;border-radius:8px;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-transition:-webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:-webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1), -webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);font-size:14px;-webkit-box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);box-shadow:0 4px 16px rgba(0, 0, 0, 0.12)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px}}:host(.ion-activated){-webkit-transform:scale3d(0.97, 0.97, 1);transform:scale3d(0.97, 0.97, 1)}",cardMdCss=":host{--ion-safe-area-left:0px;--ion-safe-area-right:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.card-disabled){cursor:default;opacity:0.3;pointer-events:none}.card-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:inherit}.card-native::-moz-focus-inner{border:0}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}ion-ripple-effect{color:var(--ripple-color)}:host{--background:var(--ion-item-background, var(--ion-background-color, #fff));--color:var(--ion-color-step-550, #737373);margin-left:10px;margin-right:10px;margin-top:10px;margin-bottom:10px;border-radius:4px;font-size:14px;-webkit-box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12);box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}",Card=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.button=!1,this.type="button",this.disabled=!1,this.routerDirection="forward"}isClickable(){return void 0!==this.href||this.button}renderCard(t){const e=this.isClickable();if(!e)return[h("slot",null)];const{href:i,routerDirection:n}=this,s=e?void 0===i?"button":"a":"div";return h(s,Object.assign({},"button"===s?{type:this.type}:{download:this.download,href:this.href,rel:this.rel,target:this.target},{class:"card-native",disabled:this.disabled,onClick:t=>openURL(i,t,n)}),h("slot",null),e&&"md"===t&&h("ion-ripple-effect",null))}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({[t]:!0},createColorClasses(this.color)),{"card-disabled":this.disabled,"ion-activatable":this.isClickable()})},this.renderCard(t))}static get style(){return{ios:cardIosCss,md:cardMdCss}}},cardContentIosCss="ion-card-content{display:block;position:relative}.card-content-ios{padding-left:20px;padding-right:20px;padding-top:20px;padding-bottom:20px;font-size:16px;line-height:1.4}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.card-content-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:20px;padding-inline-start:20px;-webkit-padding-end:20px;padding-inline-end:20px}}.card-content-ios h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.card-content-ios h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.card-content-ios h3,.card-content-ios h4,.card-content-ios h5,.card-content-ios h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal}.card-content-ios p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px}ion-card-header+.card-content-ios{padding-top:0}",cardContentMdCss="ion-card-content{display:block;position:relative}.card-content-md{padding-left:16px;padding-right:16px;padding-top:13px;padding-bottom:13px;font-size:14px;line-height:1.5}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.card-content-md{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.card-content-md h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.card-content-md h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.card-content-md h3,.card-content-md h4,.card-content-md h5,.card-content-md h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal}.card-content-md p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:1.5}ion-card-header+.card-content-md{padding-top:0}",CardContent=class extends HTMLElement{constructor(){super(),this.__registerHost()}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,["card-content-"+t]:!0}})}static get style(){return{ios:cardContentIosCss,md:cardContentMdCss}}},cardHeaderIosCss=":host{--background:transparent;--color:inherit;display:block;position:relative;background:var(--background);color:var(--color)}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{padding-left:20px;padding-right:20px;padding-top:20px;padding-bottom:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:20px;padding-inline-start:20px;-webkit-padding-end:20px;padding-inline-end:20px}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.card-header-translucent){background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.9);-webkit-backdrop-filter:saturate(180%) blur(30px);backdrop-filter:saturate(180%) blur(30px)}}",cardHeaderMdCss=":host{--background:transparent;--color:inherit;display:block;position:relative;background:var(--background);color:var(--color)}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{padding-left:16px;padding-right:16px;padding-top:16px;padding-bottom:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}::slotted(ion-card-title:not(:first-child)),::slotted(ion-card-subtitle:not(:first-child)){margin-top:8px}",CardHeader=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.translucent=!1}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{"card-header-translucent":this.translucent,"ion-inherit-color":!0,[t]:!0})},h("slot",null))}static get style(){return{ios:cardHeaderIosCss,md:cardHeaderMdCss}}},cardSubtitleIosCss=":host{display:block;position:relative;color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}:host{--color:var(--ion-color-step-600, #666666);margin-left:0;margin-right:0;margin-top:0;margin-bottom:4px;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-size:12px;font-weight:700;letter-spacing:0.4px;text-transform:uppercase}",cardSubtitleMdCss=":host{display:block;position:relative;color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}:host{--color:var(--ion-color-step-550, #737373);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-size:14px;font-weight:500}",CardSubtitle=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){const t=getIonMode(this);return h(Host,{role:"heading","aria-level":"3",class:Object.assign(Object.assign({},createColorClasses(this.color)),{"ion-inherit-color":!0,[t]:!0})},h("slot",null))}static get style(){return{ios:cardSubtitleIosCss,md:cardSubtitleMdCss}}},cardTitleIosCss=":host{display:block;position:relative;color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}:host{--color:var(--ion-text-color, #000);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-size:28px;font-weight:700;line-height:1.2}",cardTitleMdCss=":host{display:block;position:relative;color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}:host{--color:var(--ion-color-step-850, #262626);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-size:20px;font-weight:500;line-height:1.2}",CardTitle=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){const t=getIonMode(this);return h(Host,{role:"heading","aria-level":"2",class:Object.assign(Object.assign({},createColorClasses(this.color)),{"ion-inherit-color":!0,[t]:!0})},h("slot",null))}static get style(){return{ios:cardTitleIosCss,md:cardTitleMdCss}}},checkboxIosCss=":host{--background-checked:var(--ion-color-primary, #3880ff);--border-color-checked:var(--ion-color-primary, #3880ff);--checkmark-color:var(--ion-color-primary-contrast, #fff);--checkmark-width:1;--transition:none;display:inline-block;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.ion-color){--background-checked:var(--ion-color-base);--border-color-checked:var(--ion-color-base);--checkmark-color:var(--ion-color-contrast)}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.checkbox-icon{border-radius:var(--border-radius);display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-sizing:border-box;box-sizing:border-box}.checkbox-icon path{fill:none;stroke:var(--checkmark-color);stroke-width:var(--checkmark-width);opacity:0}:host(.checkbox-checked) .checkbox-icon,:host(.checkbox-indeterminate) .checkbox-icon{border-color:var(--border-color-checked);background:var(--background-checked)}:host(.checkbox-checked) .checkbox-icon path,:host(.checkbox-indeterminate) .checkbox-icon path{opacity:1}:host(.checkbox-disabled){pointer-events:none}:host{--border-radius:50%;--border-width:1px;--border-style:solid;--border-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.23);--background:var(--ion-item-background, var(--ion-background-color, #fff));--size:26px;width:var(--size);height:var(--size)}:host(.checkbox-disabled){opacity:0.3}:host(.in-item){margin-left:0;margin-right:8px;margin-top:10px;margin-bottom:9px;display:block;position:static}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}:host(.in-item[slot=start]){margin-left:2px;margin-right:20px;margin-top:8px;margin-bottom:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:20px;margin-inline-end:20px}}",checkboxMdCss=":host{--background-checked:var(--ion-color-primary, #3880ff);--border-color-checked:var(--ion-color-primary, #3880ff);--checkmark-color:var(--ion-color-primary-contrast, #fff);--checkmark-width:1;--transition:none;display:inline-block;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.ion-color){--background-checked:var(--ion-color-base);--border-color-checked:var(--ion-color-base);--checkmark-color:var(--ion-color-contrast)}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.checkbox-icon{border-radius:var(--border-radius);display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-sizing:border-box;box-sizing:border-box}.checkbox-icon path{fill:none;stroke:var(--checkmark-color);stroke-width:var(--checkmark-width);opacity:0}:host(.checkbox-checked) .checkbox-icon,:host(.checkbox-indeterminate) .checkbox-icon{border-color:var(--border-color-checked);background:var(--background-checked)}:host(.checkbox-checked) .checkbox-icon path,:host(.checkbox-indeterminate) .checkbox-icon path{opacity:1}:host(.checkbox-disabled){pointer-events:none}:host{--border-radius:calc(var(--size) * .125);--border-width:2px;--border-style:solid;--border-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.51);--checkmark-width:3;--background:var(--ion-item-background, var(--ion-background-color, #fff));--transition:background 180ms cubic-bezier(0.4, 0, 0.2, 1);--size:18px;width:var(--size);height:var(--size)}.checkbox-icon path{stroke-dasharray:30;stroke-dashoffset:30}:host(.checkbox-checked) .checkbox-icon path,:host(.checkbox-indeterminate) .checkbox-icon path{stroke-dashoffset:0;-webkit-transition:stroke-dashoffset 90ms linear 90ms;transition:stroke-dashoffset 90ms linear 90ms}:host(.checkbox-disabled){opacity:0.3}:host(.in-item){margin-left:0;margin-right:0;margin-top:18px;margin-bottom:18px;display:block;position:static}:host(.in-item[slot=start]){margin-left:4px;margin-right:36px;margin-top:18px;margin-bottom:18px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:36px;margin-inline-end:36px}}",Checkbox=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputId="ion-cb-"+checkboxIds++,this.name=this.inputId,this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.value="on",this.onClick=()=>{this.setFocus(),this.checked=!this.checked,this.indeterminate=!1},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionChange=createEvent(this,"ionChange",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionStyle=createEvent(this,"ionStyle",7)}componentWillLoad(){this.emitStyle()}checkedChanged(t){this.ionChange.emit({checked:t,value:this.value}),this.emitStyle()}disabledChanged(){this.emitStyle()}emitStyle(){this.ionStyle.emit({"checkbox-checked":this.checked,"interactive-disabled":this.disabled})}setFocus(){this.buttonEl&&this.buttonEl.focus()}render(){const{inputId:t,indeterminate:e,disabled:i,checked:n,value:s,color:o,el:r}=this,a=t+"-lbl",l=getIonMode(this),c=findItemLabel(r);c&&(c.id=a),renderHiddenInput(!0,r,this.name,n?s:"",i);let d=h("path",e?{d:"M6 12L18 12"}:{d:"M5.9,12.5l3.8,3.8l8.8-8.8"});return"md"===l&&(d=h("path",e?{d:"M2 12H22"}:{d:"M1.73,12.91 8.1,19.28 22.79,4.59"})),h(Host,{onClick:this.onClick,role:"checkbox","aria-disabled":i?"true":null,"aria-checked":""+n,"aria-labelledby":a,class:Object.assign(Object.assign({},createColorClasses(o)),{[l]:!0,"in-item":hostContext("ion-item",r),"checkbox-checked":n,"checkbox-disabled":i,"checkbox-indeterminate":e,interactive:!0})},h("svg",{class:"checkbox-icon",viewBox:"0 0 24 24"},d),h("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:this.disabled,ref:t=>this.buttonEl=t}))}get el(){return this}static get watchers(){return{checked:["checkedChanged"],disabled:["disabledChanged"]}}static get style(){return{ios:checkboxIosCss,md:checkboxMdCss}}};let checkboxIds=0;const chipIosCss=":host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.12);--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.87);border-radius:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:4px;margin-right:4px;margin-top:4px;margin-bottom:4px;padding-left:12px;padding-right:12px;padding-top:7px;padding-bottom:7px;display:-ms-inline-flexbox;display:inline-flex;position:relative;-ms-flex-align:center;align-items:center;height:32px;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);font-size:14px;line-height:1;cursor:pointer;overflow:hidden;vertical-align:middle;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:12px;padding-inline-start:12px;-webkit-padding-end:12px;padding-inline-end:12px}}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.08);color:var(--ion-color-shade)}:host(.ion-color:focus){background:rgba(var(--ion-color-base-rgb), 0.12)}:host(.ion-color.ion-activated){background:rgba(var(--ion-color-base-rgb), 0.16)}:host(.chip-outline){border-width:1px;border-style:solid}:host(.chip-outline){border-color:rgba(0, 0, 0, 0.32);background:transparent}:host(.chip-outline.ion-color){border-color:rgba(var(--ion-color-base-rgb), 0.32)}:host(.chip-outline:not(.ion-color):focus){background:rgba(0, 0, 0, 0.04)}:host(.chip-outline.ion-activated:not(.ion-color)){background:rgba(0, 0, 0, 0.08)}::slotted(ion-icon){font-size:20px}:host(:not(.ion-color)) ::slotted(ion-icon){color:rgba(0, 0, 0, 0.54)}::slotted(ion-icon:first-child){margin-left:-4px;margin-right:8px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon:first-child){margin-left:unset;margin-right:unset;-webkit-margin-start:-4px;margin-inline-start:-4px;-webkit-margin-end:8px;margin-inline-end:8px}}::slotted(ion-icon:last-child){margin-left:8px;margin-right:-4px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon:last-child){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:-4px;margin-inline-end:-4px}}::slotted(ion-avatar){width:24px;height:24px}::slotted(ion-avatar:first-child){margin-left:-8px;margin-right:8px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar:first-child){margin-left:unset;margin-right:unset;-webkit-margin-start:-8px;margin-inline-start:-8px;-webkit-margin-end:8px;margin-inline-end:8px}}::slotted(ion-avatar:last-child){margin-left:8px;margin-right:-8px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar:last-child){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:-8px;margin-inline-end:-8px}}:host(:focus){outline:none}:host(:focus){--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.16)}:host(.ion-activated){--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2)}@media (any-hover: hover){:host(:hover){--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.16)}:host(.ion-color:hover){background:rgba(var(--ion-color-base-rgb), 0.12)}:host(.chip-outline:not(.ion-color):hover){background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.04)}}",chipMdCss=":host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.12);--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.87);border-radius:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:4px;margin-right:4px;margin-top:4px;margin-bottom:4px;padding-left:12px;padding-right:12px;padding-top:7px;padding-bottom:7px;display:-ms-inline-flexbox;display:inline-flex;position:relative;-ms-flex-align:center;align-items:center;height:32px;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);font-size:14px;line-height:1;cursor:pointer;overflow:hidden;vertical-align:middle;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:4px;margin-inline-end:4px}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:12px;padding-inline-start:12px;-webkit-padding-end:12px;padding-inline-end:12px}}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.08);color:var(--ion-color-shade)}:host(.ion-color:focus){background:rgba(var(--ion-color-base-rgb), 0.12)}:host(.ion-color.ion-activated){background:rgba(var(--ion-color-base-rgb), 0.16)}:host(.chip-outline){border-width:1px;border-style:solid}:host(.chip-outline){border-color:rgba(0, 0, 0, 0.32);background:transparent}:host(.chip-outline.ion-color){border-color:rgba(var(--ion-color-base-rgb), 0.32)}:host(.chip-outline:not(.ion-color):focus){background:rgba(0, 0, 0, 0.04)}:host(.chip-outline.ion-activated:not(.ion-color)){background:rgba(0, 0, 0, 0.08)}::slotted(ion-icon){font-size:20px}:host(:not(.ion-color)) ::slotted(ion-icon){color:rgba(0, 0, 0, 0.54)}::slotted(ion-icon:first-child){margin-left:-4px;margin-right:8px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon:first-child){margin-left:unset;margin-right:unset;-webkit-margin-start:-4px;margin-inline-start:-4px;-webkit-margin-end:8px;margin-inline-end:8px}}::slotted(ion-icon:last-child){margin-left:8px;margin-right:-4px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon:last-child){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:-4px;margin-inline-end:-4px}}::slotted(ion-avatar){width:24px;height:24px}::slotted(ion-avatar:first-child){margin-left:-8px;margin-right:8px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar:first-child){margin-left:unset;margin-right:unset;-webkit-margin-start:-8px;margin-inline-start:-8px;-webkit-margin-end:8px;margin-inline-end:8px}}::slotted(ion-avatar:last-child){margin-left:8px;margin-right:-8px;margin-top:-4px;margin-bottom:-4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar:last-child){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:-8px;margin-inline-end:-8px}}:host(:focus){outline:none}:host(:focus){--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.16)}:host(.ion-activated){--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2)}@media (any-hover: hover){:host(:hover){--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.16)}:host(.ion-color:hover){background:rgba(var(--ion-color-base-rgb), 0.12)}:host(.chip-outline:not(.ion-color):hover){background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.04)}}",Chip=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.outline=!1}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0,"chip-outline":this.outline,"ion-activatable":!0})},h("slot",null),"md"===t&&h("ion-ripple-effect",null))}static get style(){return{ios:chipIosCss,md:chipMdCss}}},SIZE_TO_MEDIA={xs:"(min-width: 0px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)"},matchBreakpoint=t=>void 0===t||""===t||!!window.matchMedia&&window.matchMedia(SIZE_TO_MEDIA[t]).matches,colCss=":host{padding-left:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-right:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;width:100%;max-width:100%;min-height:1px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xs, var(--ion-grid-column-padding, 5px))}}@media (min-width: 576px){:host{padding-left:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-right:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-sm, var(--ion-grid-column-padding, 5px))}}}@media (min-width: 768px){:host{padding-left:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-right:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-md, var(--ion-grid-column-padding, 5px))}}}@media (min-width: 992px){:host{padding-left:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-right:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-lg, var(--ion-grid-column-padding, 5px))}}}@media (min-width: 1200px){:host{padding-left:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-right:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-top:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-bottom:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-start:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));-webkit-padding-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px));padding-inline-end:var(--ion-grid-column-padding-xl, var(--ion-grid-column-padding, 5px))}}}",win$1=window,SUPPORTS_VARS=!!(win$1.CSS&&win$1.CSS.supports&&win$1.CSS.supports("--a: 0")),BREAKPOINTS=["","xs","sm","md","lg","xl"],Col=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}onResize(){forceUpdate(this)}getColumns(t){let e;for(const i of BREAKPOINTS){const n=matchBreakpoint(i),s=this[t+i.charAt(0).toUpperCase()+i.slice(1)];n&&void 0!==s&&(e=s)}return e}calculateSize(){const t=this.getColumns("size");if(!t||""===t)return;const e="auto"===t?"auto":SUPPORTS_VARS?`calc(calc(${t} / var(--ion-grid-columns, 12)) * 100%)`:t/12*100+"%";return{flex:"0 0 "+e,width:""+e,"max-width":""+e}}calculatePosition(t,e){const i=this.getColumns(t);if(i)return{[e]:SUPPORTS_VARS?`calc(calc(${i} / var(--ion-grid-columns, 12)) * 100%)`:i>0&&i<12?i/12*100+"%":"auto"}}calculateOffset(t){return this.calculatePosition("offset",t?"margin-right":"margin-left")}calculatePull(t){return this.calculatePosition("pull",t?"left":"right")}calculatePush(t){return this.calculatePosition("push",t?"right":"left")}render(){const t="rtl"===document.dir,e=getIonMode(this);return h(Host,{class:{[e]:!0},style:Object.assign(Object.assign(Object.assign(Object.assign({},this.calculateOffset(t)),this.calculatePull(t)),this.calculatePush(t)),this.calculateSize())},h("slot",null))}static get style(){return colCss}},contentCss=':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.outer-content){--background:var(--ion-color-step-50, #f2f2f2)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.inner-scroll{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;will-change:scroll-position}.scroll-y{-ms-touch-action:pan-y;touch-action:pan-y;overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{-ms-touch-action:pan-x;touch-action:pan-x;overflow-x:var(--overflow);overscroll-behavior-x:contain}.scroll-x.scroll-y{-ms-touch-action:auto;touch-action:auto}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){contain:none}:host(.content-sizing) .inner-scroll{position:relative}.transition-effect{display:none;position:absolute;left:-100%;width:100%;height:100%;opacity:0;pointer-events:none}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;right:0;width:10px;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAgCAYAAAAIXrg4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTE3MDgzRkQ5QTkyMTFFOUEwNzQ5MkJFREE1NUY2MjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTE3MDgzRkU5QTkyMTFFOUEwNzQ5MkJFREE1NUY2MjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxMTcwODNGQjlBOTIxMUU5QTA3NDkyQkVEQTU1RjYyNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxMTcwODNGQzlBOTIxMUU5QTA3NDkyQkVEQTU1RjYyNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmePEuQAAABNSURBVHjaYvz//z8DIxAwMDAwATGMhmFmPDQuOSZks0AMmoJBaQHjkPfB0Lfg/2gQjVow+HPy/yHvg9GiYjQfjMbBqAWjFgy/4hogwADYqwdzxy5BuwAAAABJRU5ErkJggg==);background-repeat:repeat-y;background-size:10px 16px}::slotted([slot=fixed]){position:absolute}',Content=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.fullscreen=!1,this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1,this.ionScrollStart=createEvent(this,"ionScrollStart",7),this.ionScroll=createEvent(this,"ionScroll",7),this.ionScrollEnd=createEvent(this,"ionScrollEnd",7)}disconnectedCallback(){this.onScrollEnd()}onAppLoad(){this.resize()}onClick(t){this.isScrolling&&(t.preventDefault(),t.stopPropagation())}shouldForceOverscroll(){const{forceOverscroll:t}=this,e=getIonMode(this);return void 0===t?"ios"===e&&isPlatform("ios"):t}resize(){this.fullscreen?readTask(()=>this.readDimensions()):0===this.cTop&&0===this.cBottom||(this.cTop=this.cBottom=0,forceUpdate(this))}readDimensions(){const t=getPageElement(this.el),e=Math.max(this.el.offsetTop,0),i=Math.max(t.offsetHeight-e-this.el.offsetHeight,0);(e!==this.cTop||i!==this.cBottom)&&(this.cTop=e,this.cBottom=i,forceUpdate(this))}onScroll(t){const e=Date.now(),i=!this.isScrolling;this.lastScroll=e,i&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,readTask(e=>{this.queued=!1,this.detail.event=t,updateScrollDetail(this.detail,this.scrollEl,e,i),this.ionScroll.emit(this.detail)}))}getScrollElement(){return Promise.resolve(this.scrollEl)}scrollToTop(t=0){return this.scrollToPoint(void 0,0,t)}scrollToBottom(t=0){return this.scrollToPoint(void 0,this.scrollEl.scrollHeight-this.scrollEl.clientHeight,t)}scrollByPoint(t,e,i){return this.scrollToPoint(t+this.scrollEl.scrollLeft,e+this.scrollEl.scrollTop,i)}async scrollToPoint(t,e,i=0){const n=this.scrollEl;if(i<32)return null!=e&&(n.scrollTop=e),void(null!=t&&(n.scrollLeft=t));let s,o=0;const r=new Promise(t=>s=t),a=n.scrollTop,l=n.scrollLeft,c=null!=e?e-a:0,h=null!=t?t-l:0,d=t=>{const e=Math.min(1,(t-o)/i)-1,r=Math.pow(e,3)+1;0!==c&&(n.scrollTop=Math.floor(r*c+a)),0!==h&&(n.scrollLeft=Math.floor(r*h+l)),r<1?requestAnimationFrame(d):s()};return requestAnimationFrame(t=>{o=t,d(t)}),r}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval(()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()},100)}onScrollEnd(){clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{scrollX:t,scrollY:e}=this,i=getIonMode(this),n=this.shouldForceOverscroll(),s="ios"===i&&config.getBoolean("experimentalTransitionShadow",!0);return this.resize(),h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[i]:!0,"content-sizing":hostContext("ion-popover",this.el),overscroll:n}),style:{"--offset-top":this.cTop+"px","--offset-bottom":this.cBottom+"px"}},h("div",{id:"background-content"}),h("main",{class:{"inner-scroll":!0,"scroll-x":t,"scroll-y":e,overscroll:(t||e)&&n},ref:t=>this.scrollEl=t,onScroll:this.scrollEvents?t=>this.onScroll(t):void 0},h("slot",null)),s?h("div",{class:"transition-effect"},h("div",{class:"transition-cover"}),h("div",{class:"transition-shadow"})):null,h("slot",{name:"fixed"}))}get el(){return this}static get style(){return contentCss}},getParentElement=t=>t.parentElement?t.parentElement:t.parentNode&&t.parentNode.host?t.parentNode.host:null,getPageElement=t=>{const e=t.closest("ion-tabs");return e||(t.closest("ion-app,ion-page,.ion-page,page-inner")||getParentElement(t))},updateScrollDetail=(t,e,i,n)=>{const s=t.currentX,o=t.currentY,r=e.scrollLeft,a=e.scrollTop,l=i-t.currentTime;if(n&&(t.startTime=i,t.startX=r,t.startY=a,t.velocityX=t.velocityY=0),t.currentTime=i,t.currentX=t.scrollLeft=r,t.currentY=t.scrollTop=a,t.deltaX=r-t.startX,t.deltaY=a-t.startY,l>0&&l<100){const e=(a-o)/l;t.velocityX=(r-s)/l*.7+.3*t.velocityX,t.velocityY=.7*e+.3*t.velocityY}},getDateValue=(t,e)=>{const i=getValueFromFormat(t,e);if(void 0!==i)return i;const n=parseDate((new Date).toISOString());return getValueFromFormat(n,e)},renderDatetime=(t,e,i)=>{if(void 0===e)return;const n=[];let s=!1;if(FORMAT_KEYS.forEach((o,r)=>{if(t.indexOf(o.f)>-1){const a="{"+r+"}",l=renderTextFormat(o.f,e[o.k],e,i);s||void 0===l||null==e[o.k]||(s=!0),n.push(a,l||""),t=t.replace(o.f,a)}}),s){for(let e=0;e<n.length;e+=2)t=t.replace(n[e],n[e+1]);return t}},renderTextFormat=(t,i,n,s)=>{if(t!==FORMAT_DDDD&&t!==FORMAT_DDD){if(t===FORMAT_A)return void 0!==n&&void 0!==n.hour?n.hour<12?"AM":"PM":i?i.toUpperCase():"";if(t===FORMAT_a)return void 0!==n&&void 0!==n.hour?n.hour<12?"am":"pm":i||"";if(null==i)return"";if(t===FORMAT_YY||t===FORMAT_MM||t===FORMAT_DD||t===FORMAT_HH||t===FORMAT_mm||t===FORMAT_ss)return twoDigit(i);if(t===FORMAT_YYYY)return fourDigit(i);if(t===FORMAT_MMMM)return(s.monthNames?s.monthNames:MONTH_NAMES)[i-1];if(t===FORMAT_MMM)return(s.monthShortNames?s.monthShortNames:MONTH_SHORT_NAMES)[i-1];if(t===FORMAT_hh||t===FORMAT_h){if(0===i)return"12";if(i>12&&(i-=12),t===FORMAT_hh&&i<10)return"0"+i}return i.toString()}try{return i=new Date(n.year,n.month-1,n.day).getDay(),t===FORMAT_DDDD?(s.dayNames?s.dayNames:DAY_NAMES)[i]:(s.dayShortNames?s.dayShortNames:DAY_SHORT_NAMES)[i]}catch(e){}},dateValueRange=(t,e,i)=>{const n=[];if(t===FORMAT_YYYY||t===FORMAT_YY){if(void 0===i.year||void 0===e.year)throw new Error("min and max year is undefined");for(let t=i.year;t>=e.year;t--)n.push(t)}else if(t===FORMAT_MMMM||t===FORMAT_MMM||t===FORMAT_MM||t===FORMAT_M||t===FORMAT_hh||t===FORMAT_h)for(let s=1;s<13;s++)n.push(s);else if(t===FORMAT_DDDD||t===FORMAT_DDD||t===FORMAT_DD||t===FORMAT_D)for(let s=1;s<32;s++)n.push(s);else if(t===FORMAT_HH||t===FORMAT_H)for(let s=0;s<24;s++)n.push(s);else if(t===FORMAT_mm||t===FORMAT_m)for(let s=0;s<60;s++)n.push(s);else if(t===FORMAT_ss||t===FORMAT_s)for(let s=0;s<60;s++)n.push(s);else t!==FORMAT_A&&t!==FORMAT_a||n.push("am","pm");return n},dateSortValue=(t,e,i,n=0,s=0)=>parseInt(`1${fourDigit(t)}${twoDigit(e)}${twoDigit(i)}${twoDigit(n)}${twoDigit(s)}`,10),dateDataSortValue=t=>dateSortValue(t.year,t.month,t.day,t.hour,t.minute),daysInMonth=(t,e)=>4===t||6===t||9===t||11===t?30:2===t?isLeapYear(e)?29:28:31,isLeapYear=t=>t%4==0&&t%100!=0||t%400==0,ISO_8601_REGEXP=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,TIME_REGEXP=/^((\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,parseDate=t=>{let e=null;if(null!=t&&""!==t&&(e=TIME_REGEXP.exec(t),e?(e.unshift(void 0,void 0),e[2]=e[3]=void 0):e=ISO_8601_REGEXP.exec(t)),null===e)return;for(let n=1;n<8;n++)e[n]=void 0!==e[n]?parseInt(e[n],10):void 0;let i=0;return e[9]&&e[10]&&(i=60*parseInt(e[10],10),e[11]&&(i+=parseInt(e[11],10)),"-"===e[9]&&(i*=-1)),{year:e[1],month:e[2],day:e[3],hour:e[4],minute:e[5],second:e[6],millisecond:e[7],tzOffset:i}},getDateTime=(t="",e="")=>{null==t&&(t=""),10!==t.length&&7!==t.length||(t+=" ");const i="string"==typeof t&&t.length>0?new Date(t):new Date,n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return e&&e.length>0?new Date(i.getTime()-getTimezoneOffset(n,e)):n},getTimezoneOffset=(t,e)=>{const i=new Date(t.toLocaleString("en-US",{timeZone:"utc"})),n=new Date(t.toLocaleString("en-US",{timeZone:e}));return i.getTime()-n.getTime()},updateDate=(t,e,i)=>{if(!e||"string"==typeof e){const t=getDateTime(e,i);Number.isNaN(t.getTime())||(e=t.toISOString())}if(e&&""!==e){if("string"==typeof e){if(e=parseDate(e))return Object.assign(t,e),!0}else{if(e.year||e.hour||e.month||e.day||e.minute||e.second){e.ampm&&e.hour&&(e.hour.value="pm"===e.ampm.value?12===e.hour.value?12:e.hour.value+12:12===e.hour.value?0:e.hour.value);for(const i of Object.keys(e))t[i]=e[i].value;return!0}if(e.ampm)return e.hour={value:e.hour?e.hour.value:"pm"===e.ampm.value?t.hour<12?t.hour+12:t.hour:t.hour>=12?t.hour-12:t.hour},t.hour=e.hour.value,!0}console.warn(`Error parsing date: "${e}". Please provide a valid ISO 8601 datetime format: https://www.w3.org/TR/NOTE-datetime`)}else for(const n in t)t.hasOwnProperty(n)&&delete t[n];return!1},parseTemplate=t=>{const e=[];t=t.replace(/[^\w\s]/gi," "),FORMAT_KEYS.forEach(e=>{e.f.length>1&&t.indexOf(e.f)>-1&&t.indexOf(e.f+e.f.charAt(0))<0&&(t=t.replace(e.f," "+e.f+" "))});const i=t.split(" ").filter(t=>t.length>0);return i.forEach((t,n)=>{FORMAT_KEYS.forEach(s=>{if(t===s.f){if((t===FORMAT_A||t===FORMAT_a)&&(e.indexOf(FORMAT_h)<0&&e.indexOf(FORMAT_hh)<0||-1===VALID_AMPM_PREFIX.indexOf(i[n-1])))return;e.push(t)}})}),e},getValueFromFormat=(t,e)=>e===FORMAT_A||e===FORMAT_a?t.hour<12?"am":"pm":e===FORMAT_hh||e===FORMAT_h?t.hour>12?t.hour-12:0===t.hour?12:t.hour:t[convertFormatToKey(e)],convertFormatToKey=t=>{for(const e in FORMAT_KEYS)if(FORMAT_KEYS[e].f===t)return FORMAT_KEYS[e].k},convertDataToISO=t=>{let e="";return void 0!==t.year?(e=fourDigit(t.year),void 0!==t.month&&(e+="-"+twoDigit(t.month),void 0!==t.day&&(e+="-"+twoDigit(t.day),void 0!==t.hour&&(e+=`T${twoDigit(t.hour)}:${twoDigit(t.minute)}:${twoDigit(t.second)}`,t.millisecond>0&&(e+="."+threeDigit(t.millisecond)),e+=void 0===t.tzOffset?"Z":(t.tzOffset>0?"+":"-")+twoDigit(Math.floor(Math.abs(t.tzOffset/60)))+":"+twoDigit(t.tzOffset%60))))):void 0!==t.hour&&(e=twoDigit(t.hour)+":"+twoDigit(t.minute),void 0!==t.second&&(e+=":"+twoDigit(t.second),void 0!==t.millisecond&&(e+="."+threeDigit(t.millisecond)))),e},convertToArrayOfStrings=(t,e)=>{if(null==t)return;let i;return"string"==typeof t&&(t=t.replace(/\[|\]/g,"").split(",")),Array.isArray(t)&&(i=t.map(t=>t.toString().trim())),void 0!==i&&0!==i.length||console.warn(`Invalid "${e}Names". Must be an array of strings, or a comma separated string.`),i},convertToArrayOfNumbers=(t,e)=>{let i;return"string"==typeof t&&(t=t.replace(/\[|\]|\s/g,"").split(",")),i=Array.isArray(t)?t.map(t=>parseInt(t,10)).filter(isFinite):[t],0===i.length&&console.warn(`Invalid "${e}Values". Must be an array of numbers, or a comma separated string of numbers.`),i},twoDigit=t=>("0"+(void 0!==t?Math.abs(t):"0")).slice(-2),threeDigit=t=>("00"+(void 0!==t?Math.abs(t):"0")).slice(-3),fourDigit=t=>("000"+(void 0!==t?Math.abs(t):"0")).slice(-4),FORMAT_YYYY="YYYY",FORMAT_YY="YY",FORMAT_MMMM="MMMM",FORMAT_MMM="MMM",FORMAT_MM="MM",FORMAT_M="M",FORMAT_DDDD="DDDD",FORMAT_DDD="DDD",FORMAT_DD="DD",FORMAT_D="D",FORMAT_HH="HH",FORMAT_H="H",FORMAT_hh="hh",FORMAT_h="h",FORMAT_mm="mm",FORMAT_m="m",FORMAT_ss="ss",FORMAT_s="s",FORMAT_A="A",FORMAT_a="a",FORMAT_KEYS=[{f:FORMAT_YYYY,k:"year"},{f:FORMAT_MMMM,k:"month"},{f:FORMAT_DDDD,k:"day"},{f:FORMAT_MMM,k:"month"},{f:FORMAT_DDD,k:"day"},{f:FORMAT_YY,k:"year"},{f:FORMAT_MM,k:"month"},{f:FORMAT_DD,k:"day"},{f:FORMAT_HH,k:"hour"},{f:FORMAT_hh,k:"hour"},{f:FORMAT_mm,k:"minute"},{f:FORMAT_ss,k:"second"},{f:FORMAT_M,k:"month"},{f:FORMAT_D,k:"day"},{f:FORMAT_H,k:"hour"},{f:FORMAT_h,k:"hour"},{f:FORMAT_m,k:"minute"},{f:FORMAT_s,k:"second"},{f:FORMAT_A,k:"ampm"},{f:FORMAT_a,k:"ampm"}],DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DAY_SHORT_NAMES=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],MONTH_SHORT_NAMES=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],VALID_AMPM_PREFIX=[FORMAT_hh,FORMAT_h,FORMAT_mm,FORMAT_m,FORMAT_ss,FORMAT_s],datetimeIosCss=":host{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;min-width:16px;min-height:1.2em;font-family:var(--ion-font-family, inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.in-item){position:static}:host(.datetime-placeholder){color:var(--placeholder-color)}:host(.datetime-disabled){opacity:0.3;pointer-events:none}:host(.datetime-readonly){pointer-events:none}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.datetime-text{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-ms-flex:1;flex:1;min-height:inherit;direction:ltr;overflow:inherit}[dir=rtl] .datetime-text,:host-context([dir=rtl]) .datetime-text{direction:rtl}:host{--placeholder-color:var(--ion-color-step-400, #999999);--padding-top:10px;--padding-end:10px;--padding-bottom:10px;--padding-start:20px}",datetimeMdCss=":host{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;min-width:16px;min-height:1.2em;font-family:var(--ion-font-family, inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.in-item){position:static}:host(.datetime-placeholder){color:var(--placeholder-color)}:host(.datetime-disabled){opacity:0.3;pointer-events:none}:host(.datetime-readonly){pointer-events:none}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.datetime-text{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;-ms-flex:1;flex:1;min-height:inherit;direction:ltr;overflow:inherit}[dir=rtl] .datetime-text,:host-context([dir=rtl]) .datetime-text{direction:rtl}:host{--placeholder-color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));--padding-top:10px;--padding-end:0;--padding-bottom:11px;--padding-start:16px}",Datetime=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputId="ion-dt-"+datetimeIds++,this.locale={},this.datetimeMin={},this.datetimeMax={},this.datetimeValue={},this.isExpanded=!1,this.name=this.inputId,this.disabled=!1,this.readonly=!1,this.displayFormat="MMM D, YYYY",this.cancelText="Cancel",this.doneText="Done",this.onClick=()=>{this.setFocus(),this.open()},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionCancel=createEvent(this,"ionCancel",7),this.ionChange=createEvent(this,"ionChange",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionStyle=createEvent(this,"ionStyle",7)}disabledChanged(){this.emitStyle()}valueChanged(){this.updateDatetimeValue(this.value),this.emitStyle(),this.ionChange.emit({value:this.value})}componentWillLoad(){this.locale={monthNames:convertToArrayOfStrings(this.monthNames,"monthNames"),monthShortNames:convertToArrayOfStrings(this.monthShortNames,"monthShortNames"),dayNames:convertToArrayOfStrings(this.dayNames,"dayNames"),dayShortNames:convertToArrayOfStrings(this.dayShortNames,"dayShortNames")},this.updateDatetimeValue(this.value),this.emitStyle()}async open(){if(this.disabled||this.isExpanded)return;const t=this.generatePickerOptions(),e=await pickerController.create(t);this.isExpanded=!0,e.onDidDismiss().then(()=>{this.isExpanded=!1,this.setFocus()}),e.addEventListener("ionPickerColChange",async t=>{const i=t.detail,n={};n[i.name]={value:i.options[i.selectedIndex].value},this.updateDatetimeValue(n),e.columns=this.generateColumns()}),await e.present()}emitStyle(){this.ionStyle.emit({interactive:!0,datetime:!0,"has-placeholder":null!=this.placeholder,"has-value":this.hasValue(),"interactive-disabled":this.disabled})}updateDatetimeValue(t){updateDate(this.datetimeValue,t,this.displayTimezone)}generatePickerOptions(){const t=getIonMode(this),e=Object.assign(Object.assign({mode:t},this.pickerOptions),{columns:this.generateColumns()}),i=e.buttons;return i&&0!==i.length||(e.buttons=[{text:this.cancelText,role:"cancel",handler:()=>{this.updateDatetimeValue(this.value),this.ionCancel.emit()}},{text:this.doneText,handler:t=>{this.updateDatetimeValue(t);const e=new Date(convertDataToISO(this.datetimeValue));this.datetimeValue.tzOffset=void 0!==this.displayTimezone&&this.displayTimezone.length>0?getTimezoneOffset(e,this.displayTimezone)/1e3/60*-1:-1*e.getTimezoneOffset(),this.value=convertDataToISO(this.datetimeValue)}}]),e}generateColumns(){let t=this.pickerFormat||this.displayFormat||DEFAULT_FORMAT;if(0===t.length)return[];this.calcMinMax(),t=t.replace("DDDD","{~}").replace("DDD","{~}"),-1===t.indexOf("D")&&(t=t.replace("{~}","D")),t=t.replace(/{~}/g,"");const e=parseTemplate(t).map(t=>{const e=convertFormatToKey(t);let i;i=this[e+"Values"]?convertToArrayOfNumbers(this[e+"Values"],e):dateValueRange(t,this.datetimeMin,this.datetimeMax);const n=i.map(e=>({value:e,text:renderTextFormat(t,e,void 0,this.locale)})),s=getDateValue(this.datetimeValue,t),o=n.findIndex(t=>t.value===s);return{name:e,selectedIndex:o>=0?o:0,options:n}}),i=this.datetimeMin,n=this.datetimeMax;return["month","day","hour","minute"].filter(t=>!e.find(e=>e.name===t)).forEach(t=>{i[t]=0,n[t]=0}),this.validateColumns(divyColumns(e))}validateColumns(t){const e=new Date,i=dateDataSortValue(this.datetimeMin),n=dateDataSortValue(this.datetimeMax),s=t.find(t=>"year"===t.name);let o=e.getFullYear();if(s){s.options.find(t=>t.value===e.getFullYear())||(o=s.options[0].value);const t=s.selectedIndex;if(void 0!==t){const e=s.options[t];e&&(o=e.value)}}const r=this.validateColumn(t,"month",1,i,n,[o,0,0,0,0],[o,12,31,23,59]),a=daysInMonth(r,o),l=this.validateColumn(t,"day",2,i,n,[o,r,0,0,0],[o,r,a,23,59]),c=this.validateColumn(t,"hour",3,i,n,[o,r,l,0,0],[o,r,l,23,59]);return this.validateColumn(t,"minute",4,i,n,[o,r,l,c,0],[o,r,l,c,59]),t}calcMinMax(){const t=(new Date).getFullYear();if(void 0!==this.yearValues){const t=convertToArrayOfNumbers(this.yearValues,"year");void 0===this.min&&(this.min=Math.min(...t).toString()),void 0===this.max&&(this.max=Math.max(...t).toString())}else void 0===this.min&&(this.min=(t-100).toString()),void 0===this.max&&(this.max=t.toString());const e=this.datetimeMin=parseDate(this.min),i=this.datetimeMax=parseDate(this.max);e.year=e.year||t,i.year=i.year||t,e.month=e.month||1,i.month=i.month||12,e.day=e.day||1,i.day=i.day||31,e.hour=e.hour||0,i.hour=void 0===i.hour?23:i.hour,e.minute=e.minute||0,i.minute=void 0===i.minute?59:i.minute,e.second=e.second||0,i.second=void 0===i.second?59:i.second,e.year>i.year&&(console.error("min.year > max.year"),e.year=i.year-100),e.year===i.year&&(e.month>i.month?(console.error("min.month > max.month"),e.month=1):e.month===i.month&&e.day>i.day&&(console.error("min.day > max.day"),e.day=1))}validateColumn(t,e,i,n,s,o,r){const a=t.find(t=>t.name===e);if(!a)return 0;const l=o.slice(),c=r.slice(),h=a.options;let d=h.length-1,u=0;for(let b=0;b<h.length;b++){const t=h[b],e=t.value;l[i]=t.value,c[i]=t.value,(t.disabled=e<o[i]||e>r[i]||dateSortValue(c[0],c[1],c[2],c[3],c[4])<n||dateSortValue(l[0],l[1],l[2],l[3],l[4])>s)||(d=Math.min(d,b),u=Math.max(u,b))}const m=a.selectedIndex=clamp(d,a.selectedIndex,u),p=a.options[m];return p?p.value:0}get text(){if(null!=this.value&&0!==this.value.length)return renderDatetime(this.displayFormat||this.pickerFormat||DEFAULT_FORMAT,this.datetimeValue,this.locale)}hasValue(){return void 0!==this.text}setFocus(){this.buttonEl&&this.buttonEl.focus()}render(){const{inputId:t,text:e,disabled:i,readonly:n,isExpanded:s,el:o,placeholder:r}=this,a=getIonMode(this),l=t+"-lbl",c=findItemLabel(o),d=void 0===e&&null!=r,u=void 0===e?null!=r?r:"":e;return c&&(c.id=l),renderHiddenInput(!0,o,this.name,this.value,this.disabled),h(Host,{onClick:this.onClick,role:"combobox","aria-disabled":i?"true":null,"aria-expanded":""+s,"aria-haspopup":"true","aria-labelledby":l,class:{[a]:!0,"datetime-disabled":i,"datetime-readonly":n,"datetime-placeholder":d,"in-item":hostContext("ion-item",o)}},h("div",{class:"datetime-text"},u),h("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:this.disabled,ref:t=>this.buttonEl=t}))}get el(){return this}static get watchers(){return{disabled:["disabledChanged"],value:["valueChanged"]}}static get style(){return{ios:datetimeIosCss,md:datetimeMdCss}}},divyColumns=t=>{const e=[];let i,n;for(let s=0;s<t.length;s++){i=t[s],e.push(0);for(const t of i.options)n=t.text.length,n>e[s]&&(e[s]=n)}return 2===e.length?(n=Math.max(e[0],e[1]),t[0].align="right",t[1].align="left",t[0].optionsWidth=t[1].optionsWidth=17*n+"px"):3===e.length&&(n=Math.max(e[0],e[2]),t[0].align="right",t[1].columnWidth=17*e[1]+"px",t[0].optionsWidth=t[2].optionsWidth=17*n+"px",t[2].align="left"),t},DEFAULT_FORMAT="MMM D, YYYY";let datetimeIds=0;const fabCss=":host{position:absolute;z-index:999}:host(.fab-horizontal-center){left:50%;margin-left:-28px}:host-context([dir=rtl]):host(.fab-horizontal-center),:host-context([dir=rtl]).fab-horizontal-center{left:unset;right:unset;right:50%}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.fab-horizontal-center){margin-left:unset;-webkit-margin-start:-28px;margin-inline-start:-28px}}:host(.fab-horizontal-start){left:calc(10px + var(--ion-safe-area-left, 0px))}:host-context([dir=rtl]):host(.fab-horizontal-start),:host-context([dir=rtl]).fab-horizontal-start{left:unset;right:unset;right:calc(10px + var(--ion-safe-area-left, 0px))}:host(.fab-horizontal-end){right:calc(10px + var(--ion-safe-area-right, 0px))}:host-context([dir=rtl]):host(.fab-horizontal-end),:host-context([dir=rtl]).fab-horizontal-end{left:unset;right:unset;left:calc(10px + var(--ion-safe-area-right, 0px))}:host(.fab-vertical-top){top:10px}:host(.fab-vertical-top.fab-edge){top:-28px}:host(.fab-vertical-bottom){bottom:10px}:host(.fab-vertical-bottom.fab-edge){bottom:-28px}:host(.fab-vertical-center){margin-top:-28px;top:50%}",Fab=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.edge=!1,this.activated=!1,this.onClick=()=>{const t=!!this.el.querySelector("ion-fab-list"),e=this.getFab();t&&(!e||!e.disabled)&&(this.activated=!this.activated)}}activatedChanged(){const t=this.activated,e=this.getFab();e&&(e.activated=t),Array.from(this.el.querySelectorAll("ion-fab-list")).forEach(e=>{e.activated=t})}componentDidLoad(){this.activated&&this.activatedChanged()}async close(){this.activated=!1}getFab(){return this.el.querySelector("ion-fab-button")}render(){const{horizontal:t,vertical:e,edge:i}=this,n=getIonMode(this);return h(Host,{onClick:this.onClick,class:{[n]:!0,["fab-horizontal-"+t]:void 0!==t,["fab-vertical-"+e]:void 0!==e,"fab-edge":i}},h("slot",null))}get el(){return this}static get watchers(){return{activated:["activatedChanged"]}}static get style(){return fabCss}},fabButtonIosCss=':host{--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--background-hover:var(--ion-color-primary-contrast, #fff);--background-hover-opacity:.08;--transition:background-color, opacity 100ms linear;--ripple-color:currentColor;--border-radius:50%;--border-width:0;--border-style:none;--border-color:initial;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:56px;height:56px;font-size:14px;text-align:center;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transform:var(--transform);transform:var(--transform);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);background-clip:padding-box;color:var(--color);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:strict;cursor:pointer;overflow:hidden;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}::slotted(ion-icon){line-height:1}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;z-index:1}:host(.fab-button-disabled){cursor:default;opacity:0.5;pointer-events:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-activated) .button-native{color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}::slotted(ion-icon){line-height:1}:host(.fab-button-small){margin-left:8px;margin-right:8px;margin-top:8px;margin-bottom:8px;width:40px;height:40px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.fab-button-small){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px}}.close-icon{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transform:scale(0.4) rotateZ(-45deg);transform:scale(0.4) rotateZ(-45deg);-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;opacity:0;z-index:1}:host(.fab-button-close-active) .close-icon{-webkit-transform:scale(1) rotateZ(0deg);transform:scale(1) rotateZ(0deg);opacity:1}:host(.fab-button-close-active) .button-inner{-webkit-transform:scale(0.4) rotateZ(45deg);transform:scale(0.4) rotateZ(45deg);opacity:0}ion-ripple-effect{color:var(--ripple-color)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent) .button-native{-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter)}}:host(.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{--background:var(--ion-color-primary, #3880ff);--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1;--color:var(--ion-color-primary-contrast, #fff);--box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);--transition:0.2s transform cubic-bezier(0.25, 1.11, 0.78, 1.59)}:host(.ion-activated){--box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);--transform:scale(1.1);--transition:0.2s transform ease-out}::slotted(ion-icon),.close-icon{font-size:28px}:host(.fab-button-in-list){--background:var(--ion-color-light, #f4f5f8);--background-activated:var(--ion-color-light-shade, #d7d8da);--background-focused:var(--background-activated);--background-hover:var(--ion-color-light-tint, #f5f6f9);--color:var(--ion-color-light-contrast, #000);--color-activated:var(--ion-color-light-contrast, #000);--color-focused:var(--color-activated);--transition:transform 200ms ease 10ms, opacity 200ms ease 10ms}:host(.fab-button-in-list) ::slotted(ion-icon){font-size:18px}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}:host(.ion-color.ion-focused) .button-native,:host(.ion-color.ion-activated) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .button-native::after,:host(.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-contrast)}:host(.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent){--background:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.9);--background-hover:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.8);--background-focused:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.82);--backdrop-filter:saturate(180%) blur(20px)}:host(.fab-button-translucent-in-list){--background:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.9);--background-hover:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.8);--background-focused:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.82)}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){@media (any-hover: hover){:host(.fab-button-translucent.ion-color:hover) .button-native{background:rgba(var(--ion-color-base-rgb), 0.8)}}:host(.ion-color.fab-button-translucent) .button-native{background:rgba(var(--ion-color-base-rgb), 0.9)}:host(.ion-color.ion-focused.fab-button-translucent) .button-native,:host(.ion-color.ion-activated.fab-button-translucent) .button-native{background:var(--ion-color-base)}}',fabButtonMdCss=':host{--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--background-hover:var(--ion-color-primary-contrast, #fff);--background-hover-opacity:.08;--transition:background-color, opacity 100ms linear;--ripple-color:currentColor;--border-radius:50%;--border-width:0;--border-style:none;--border-color:initial;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:56px;height:56px;font-size:14px;text-align:center;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transform:var(--transform);transform:var(--transform);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);background-clip:padding-box;color:var(--color);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:strict;cursor:pointer;overflow:hidden;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}::slotted(ion-icon){line-height:1}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;z-index:1}:host(.fab-button-disabled){cursor:default;opacity:0.5;pointer-events:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-activated) .button-native{color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}::slotted(ion-icon){line-height:1}:host(.fab-button-small){margin-left:8px;margin-right:8px;margin-top:8px;margin-bottom:8px;width:40px;height:40px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.fab-button-small){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px}}.close-icon{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transform:scale(0.4) rotateZ(-45deg);transform:scale(0.4) rotateZ(-45deg);-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;opacity:0;z-index:1}:host(.fab-button-close-active) .close-icon{-webkit-transform:scale(1) rotateZ(0deg);transform:scale(1) rotateZ(0deg);opacity:1}:host(.fab-button-close-active) .button-inner{-webkit-transform:scale(0.4) rotateZ(45deg);transform:scale(0.4) rotateZ(45deg);opacity:0}ion-ripple-effect{color:var(--ripple-color)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent) .button-native{-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter)}}:host(.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{--background:var(--ion-color-primary, #3880ff);--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--color:var(--ion-color-primary-contrast, #fff);--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1), background-color 280ms cubic-bezier(0.4, 0, 0.2, 1), color 280ms cubic-bezier(0.4, 0, 0.2, 1), opacity 15ms linear 30ms, transform 270ms cubic-bezier(0, 0, 0.2, 1) 0ms}:host(.ion-activated){--box-shadow:0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 12px 17px 2px rgba(0, 0, 0, 0.14), 0 5px 22px 4px rgba(0, 0, 0, 0.12)}::slotted(ion-icon),.close-icon{font-size:24px}:host(.fab-button-in-list){--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);--color-activated:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);--color-focused:var(--color-activated);--background:var(--ion-color-light, #f4f5f8);--background-activated:transparent;--background-focused:var(--ion-color-light-shade, #d7d8da);--background-hover:var(--ion-color-light-tint, #f5f6f9)}:host(.fab-button-in-list) ::slotted(ion-icon){font-size:18px}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.ion-color.ion-activated) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activated) .button-native::after{background:transparent}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-contrast)}:host(.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}}',FabButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.activated=!1,this.disabled=!1,this.routerDirection="forward",this.show=!1,this.translucent=!1,this.type="button",this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7)}render(){const{el:t,disabled:e,color:i,href:n,activated:s,show:o,translucent:r,size:a}=this,l=hostContext("ion-fab-list",t),c=getIonMode(this),d=void 0===n?"button":"a",u="button"===d?{type:this.type}:{download:this.download,href:n,rel:this.rel,target:this.target};return h(Host,{"aria-disabled":e?"true":null,class:Object.assign(Object.assign({},createColorClasses(i)),{[c]:!0,"fab-button-in-list":l,"fab-button-translucent-in-list":l&&r,"fab-button-close-active":s,"fab-button-show":o,"fab-button-disabled":e,"fab-button-translucent":r,"ion-activatable":!0,"ion-focusable":!0,["fab-button-"+a]:void 0!==a})},h(d,Object.assign({},u,{class:"button-native",disabled:e,onFocus:this.onFocus,onBlur:this.onBlur,onClick:t=>openURL(n,t,this.routerDirection)}),h("span",{class:"close-icon"},h("ion-icon",{name:"close",lazy:!1})),h("span",{class:"button-inner"},h("slot",null)),"md"===c&&h("ion-ripple-effect",null)))}get el(){return this}static get style(){return{ios:fabButtonIosCss,md:fabButtonMdCss}}},fabListCss=":host{margin-left:0;margin-right:0;margin-top:66px;margin-bottom:66px;display:none;position:absolute;top:0;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;min-width:56px;min-height:56px}:host(.fab-list-active){display:-ms-flexbox;display:flex}::slotted(.fab-button-in-list){margin-left:0;margin-right:0;margin-top:8px;margin-bottom:8px;width:40px;height:40px;-webkit-transform:scale(0);transform:scale(0);opacity:0;visibility:hidden}:host(.fab-list-side-top) ::slotted(.fab-button-in-list),:host(.fab-list-side-bottom) ::slotted(.fab-button-in-list){margin-left:0;margin-right:0;margin-top:5px;margin-bottom:5px}:host(.fab-list-side-start) ::slotted(.fab-button-in-list),:host(.fab-list-side-end) ::slotted(.fab-button-in-list){margin-left:5px;margin-right:5px;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.fab-list-side-start) ::slotted(.fab-button-in-list),:host(.fab-list-side-end) ::slotted(.fab-button-in-list){margin-left:unset;margin-right:unset;-webkit-margin-start:5px;margin-inline-start:5px;-webkit-margin-end:5px;margin-inline-end:5px}}::slotted(.fab-button-in-list.fab-button-show){-webkit-transform:scale(1);transform:scale(1);opacity:1;visibility:visible}:host(.fab-list-side-top){top:auto;bottom:0;-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.fab-list-side-start){margin-left:66px;margin-right:66px;margin-top:0;margin-bottom:0;right:0;-ms-flex-direction:row-reverse;flex-direction:row-reverse}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.fab-list-side-start){margin-left:unset;margin-right:unset;-webkit-margin-start:66px;margin-inline-start:66px;-webkit-margin-end:66px;margin-inline-end:66px}}:host-context([dir=rtl]):host(.fab-list-side-start),:host-context([dir=rtl]).fab-list-side-start{left:unset;right:unset;left:0}:host(.fab-list-side-end){margin-left:66px;margin-right:66px;margin-top:0;margin-bottom:0;left:0;-ms-flex-direction:row;flex-direction:row}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.fab-list-side-end){margin-left:unset;margin-right:unset;-webkit-margin-start:66px;margin-inline-start:66px;-webkit-margin-end:66px;margin-inline-end:66px}}:host-context([dir=rtl]):host(.fab-list-side-end),:host-context([dir=rtl]).fab-list-side-end{left:unset;right:unset;right:0}",FabList=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.activated=!1,this.side="bottom"}activatedChanged(t){const e=Array.from(this.el.querySelectorAll("ion-fab-button")),i=t?30:0;e.forEach((e,n)=>{setTimeout(()=>e.show=t,n*i)})}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"fab-list-active":this.activated,["fab-list-side-"+this.side]:!0}},h("slot",null))}get el(){return this}static get watchers(){return{activated:["activatedChanged"]}}static get style(){return fabListCss}},footerIosCss="ion-footer{display:block;position:relative;-ms-flex-order:1;order:1;width:100%;z-index:10}ion-footer ion-toolbar:last-of-type{padding-bottom:var(--ion-safe-area-bottom, 0)}.footer-ios ion-toolbar:first-of-type{--border-width:0.55px 0 0}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.footer-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.footer-translucent-ios ion-toolbar{--opacity:.8}}.footer-ios.ion-no-border ion-toolbar:first-of-type{--border-width:0}",footerMdCss='ion-footer{display:block;position:relative;-ms-flex-order:1;order:1;width:100%;z-index:10}ion-footer ion-toolbar:last-of-type{padding-bottom:var(--ion-safe-area-bottom, 0)}.footer-md::before{left:0;top:-2px;bottom:auto;background-position:left 0 top 0;position:absolute;width:100%;height:2px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAHBAMAAADzDtBxAAAAD1BMVEUAAAAAAAAAAAAAAAAAAABPDueNAAAABXRSTlMUCS0gBIh/TXEAAAAaSURBVAjXYxCEAgY4UIICBmMogMsgFLtAAQCNSwXZKOdPxgAAAABJRU5ErkJggg==");background-repeat:repeat-x;content:""}[dir=rtl] .footer-md::before,:host-context([dir=rtl]) .footer-md::before{left:unset;right:unset;right:0}[dir=rtl] .footer-md::before,:host-context([dir=rtl]) .footer-md::before{background-position:right 0 top 0}.footer-md.ion-no-border::before{display:none}',Footer=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.translucent=!1}render(){const t=getIonMode(this),e=this.translucent;return h(Host,{role:"contentinfo",class:{[t]:!0,["footer-"+t]:!0,"footer-translucent":e,["footer-translucent-"+t]:e}},"ios"===t&&e&&h("div",{class:"footer-background"}),h("slot",null))}static get style(){return{ios:footerIosCss,md:footerMdCss}}},gridCss=":host{padding-left:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-right:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));margin-left:auto;margin-right:auto;display:block;-ms-flex:1;flex:1}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-xs, var(--ion-grid-padding, 5px))}}@media (min-width: 576px){:host{padding-left:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-right:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-sm, var(--ion-grid-padding, 5px))}}}@media (min-width: 768px){:host{padding-left:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-right:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-md, var(--ion-grid-padding, 5px))}}}@media (min-width: 992px){:host{padding-left:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-right:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-lg, var(--ion-grid-padding, 5px))}}}@media (min-width: 1200px){:host{padding-left:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-right:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-top:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-bottom:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-inline-start:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));-webkit-padding-end:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px));padding-inline-end:var(--ion-grid-padding-xl, var(--ion-grid-padding, 5px))}}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}:host(.grid-fixed){width:var(--ion-grid-width-xs, var(--ion-grid-width, 100%));max-width:100%}@media (min-width: 576px){:host(.grid-fixed){width:var(--ion-grid-width-sm, var(--ion-grid-width, 540px))}}@media (min-width: 768px){:host(.grid-fixed){width:var(--ion-grid-width-md, var(--ion-grid-width, 720px))}}@media (min-width: 992px){:host(.grid-fixed){width:var(--ion-grid-width-lg, var(--ion-grid-width, 960px))}}@media (min-width: 1200px){:host(.grid-fixed){width:var(--ion-grid-width-xl, var(--ion-grid-width, 1140px))}}:host(.ion-no-padding){--ion-grid-column-padding:0;--ion-grid-column-padding-xs:0;--ion-grid-column-padding-sm:0;--ion-grid-column-padding-md:0;--ion-grid-column-padding-lg:0;--ion-grid-column-padding-xl:0}",Grid=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.fixed=!1}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"grid-fixed":this.fixed}},h("slot",null))}static get style(){return gridCss}},TRANSITION="all 0.2s ease-in-out",cloneElement=t=>{const e=document.querySelector(t+".ion-cloned-element");if(null!==e)return e;const i=document.createElement(t);return i.classList.add("ion-cloned-element"),i.style.setProperty("display","none"),document.body.appendChild(i),i},createHeaderIndex=t=>{if(!t)return;const e=t.querySelectorAll("ion-toolbar");return{el:t,toolbars:Array.from(e).map(t=>{const e=t.querySelector("ion-title");return{el:t,background:t.shadowRoot.querySelector(".toolbar-background"),ionTitleEl:e,innerTitleEl:e?e.shadowRoot.querySelector(".toolbar-title"):null,ionButtonsEl:Array.from(t.querySelectorAll("ion-buttons"))||[]}})||[]}},handleContentScroll=(t,e,i)=>{readTask(()=>{const n=clamp(1,1+-t.scrollTop/500,1.1);null===i.querySelector("ion-refresher.refresher-native")&&writeTask(()=>{scaleLargeTitles(e.toolbars,n)})})},setToolbarBackgroundOpacity=(t,e)=>{void 0===e?t.background.style.removeProperty("--opacity"):t.background.style.setProperty("--opacity",e.toString())},handleToolbarBorderIntersection=(t,e)=>{if(!t[0].isIntersecting)return;const i=t[0].intersectionRatio>.9?0:100*(1-t[0].intersectionRatio)/75;e.toolbars.forEach(t=>{setToolbarBackgroundOpacity(t,1===i?void 0:i)})},handleToolbarIntersection=(t,e,i)=>{writeTask(()=>{handleToolbarBorderIntersection(t,e);const n=t[0],s=n.intersectionRect,o=s.width*s.height,r=0===o&&0==n.rootBounds.width*n.rootBounds.height,a=Math.abs(s.left-n.boundingClientRect.left),l=Math.abs(s.right-n.boundingClientRect.right);r||o>0&&(a>=5||l>=5)||(n.isIntersecting?(setHeaderActive(e,!1),setHeaderActive(i)):(0===s.x&&0===s.y||0!==s.width&&0!==s.height)&&(setHeaderActive(e),setHeaderActive(i,!1),setToolbarBackgroundOpacity(e.toolbars[0])))})},setHeaderActive=(t,e=!0)=>{e?t.el.classList.remove("header-collapse-condense-inactive"):t.el.classList.add("header-collapse-condense-inactive")},scaleLargeTitles=(t=[],e=1,i=!1)=>{t.forEach(t=>{const n=t.ionTitleEl,s=t.innerTitleEl;n&&"large"===n.size&&(s.style.transformOrigin="left center",s.style.transition=i?TRANSITION:"",s.style.transform=`scale3d(${e}, ${e}, 1)`)})},headerIosCss="ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-ios ion-toolbar:last-of-type{--border-width:0 0 0.55px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.header-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.header-translucent-ios ion-toolbar{--opacity:.8}.header-collapse-condense-inactive .header-background{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}}.header-ios.ion-no-border ion-toolbar:last-of-type{--border-width:0}.header-collapse-condense{z-index:9}.header-collapse-condense ion-toolbar{position:-webkit-sticky;position:sticky;top:0}.header-collapse-condense ion-toolbar:first-of-type{padding-top:7px;z-index:1}.header-collapse-condense ion-toolbar{--background:var(--ion-background-color, #fff);z-index:0}.header-collapse-condense ion-toolbar ion-searchbar{height:48px;padding-top:0px;padding-bottom:13px}.header-collapse-main ion-toolbar.in-toolbar ion-title,.header-collapse-main ion-toolbar.in-toolbar ion-buttons{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-buttons.buttons-collapse{opacity:0;pointer-events:none}.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-buttons.buttons-collapse{visibility:hidden}",headerMdCss='ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-md::after{left:0;bottom:-5px;background-position:left 0 top -2px;position:absolute;width:100%;height:5px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAHBAMAAADzDtBxAAAAD1BMVEUAAAAAAAAAAAAAAAAAAABPDueNAAAABXRSTlMUCS0gBIh/TXEAAAAaSURBVAjXYxCEAgY4UIICBmMogMsgFLtAAQCNSwXZKOdPxgAAAABJRU5ErkJggg==);background-repeat:repeat-x;content:""}[dir=rtl] .header-md::after,:host-context([dir=rtl]) .header-md::after{left:unset;right:unset;right:0}[dir=rtl] .header-md::after,:host-context([dir=rtl]) .header-md::after{background-position:right 0 top -2px}.header-collapse-condense{display:none}.header-md.ion-no-border::after{display:none}',Header=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.collapsibleHeaderInitialized=!1,this.translucent=!1}async componentDidLoad(){await this.checkCollapsibleHeader()}async componentDidUpdate(){await this.checkCollapsibleHeader()}componentDidUnload(){this.destroyCollapsibleHeader()}async checkCollapsibleHeader(){const t="condense"===this.collapse,e=!(!t||"ios"!==getIonMode(this))&&t;if(!e&&this.collapsibleHeaderInitialized)this.destroyCollapsibleHeader();else if(e&&!this.collapsibleHeaderInitialized){const t=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),e=t?t.querySelector("ion-content"):null;await this.setupCollapsibleHeader(e,t)}}destroyCollapsibleHeader(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0),this.scrollEl&&this.contentScrollCallback&&(this.scrollEl.removeEventListener("scroll",this.contentScrollCallback),this.contentScrollCallback=void 0),this.collapsibleMainHeader&&(this.collapsibleMainHeader.classList.remove("header-collapse-main"),this.collapsibleMainHeader=void 0)}async setupCollapsibleHeader(t,e){if(!t||!e)return void console.error("ion-header requires a content to collapse, make sure there is an ion-content.");this.scrollEl=await t.getScrollElement();const i=e.querySelectorAll("ion-header");if(this.collapsibleMainHeader=Array.from(i).find(t=>"condense"!==t.collapse),!this.collapsibleMainHeader)return;const n=createHeaderIndex(this.collapsibleMainHeader),s=createHeaderIndex(this.el);n&&s&&(setHeaderActive(n,!1),n.toolbars.forEach(t=>{setToolbarBackgroundOpacity(t,0)}),this.intersectionObserver=new IntersectionObserver(t=>{handleToolbarIntersection(t,n,s)},{root:t,threshold:[.25,.3,.4,.5,.6,.7,.8,.9,1]}),this.intersectionObserver.observe(s.toolbars[s.toolbars.length-1].el),this.contentScrollCallback=()=>{handleContentScroll(this.scrollEl,s,t)},this.scrollEl.addEventListener("scroll",this.contentScrollCallback),writeTask(()=>{cloneElement("ion-title").size="large",cloneElement("ion-back-button"),void 0!==this.collapsibleMainHeader&&this.collapsibleMainHeader.classList.add("header-collapse-main")}),this.collapsibleHeaderInitialized=!0)}render(){const{translucent:t}=this,e=getIonMode(this);return h(Host,{role:"banner",class:{[e]:!0,["header-"+e]:!0,"header-translucent":this.translucent,["header-collapse-"+(this.collapse||"none")]:!0,["header-translucent-"+e]:this.translucent}},"ios"===e&&t&&h("div",{class:"header-background"}),h("slot",null))}get el(){return this}static get style(){return{ios:headerIosCss,md:headerMdCss}}};let CACHED_MAP;const getIconMap=()=>{if("undefined"==typeof window)return new Map;if(!CACHED_MAP){const t=window;t.Ionicons=t.Ionicons||{},CACHED_MAP=t.Ionicons.map=t.Ionicons.map||new Map}return CACHED_MAP},getUrl=t=>{let e=getSrc(t.src);if(e)return e;if(e=getName(t.name,t.icon,t.mode,t.ios,t.md),e)return getNamedUrl(e);if(t.icon){if(e=getSrc(t.icon),e)return e;if(e=getSrc(t.icon[t.mode]),e)return e}return null},getNamedUrl=t=>getIconMap().get(t)||getAssetPath(`svg/${t}.svg`),getName=(t,e,i,n,s)=>(i="ios"===(i&&toLower(i))?"ios":"md",n&&"ios"===i?t=toLower(n):s&&"md"===i?t=toLower(s):(t||!e||isSrc(e)||(t=e),isStr(t)&&(t=toLower(t))),isStr(t)&&""!==t.trim()?""!==t.replace(/[a-z]|-|\d/gi,"")?null:t:null),getSrc=t=>isStr(t)&&(t=t.trim(),isSrc(t))?t:null,isSrc=t=>t.length>0&&/(\/|\.)/.test(t),isStr=t=>"string"==typeof t,toLower=t=>t.toLowerCase(),validateContent=t=>{if(t&&"undefined"!=typeof document){const e=document.createElement("div");e.innerHTML=t;for(let t=e.childNodes.length-1;t>=0;t--)"svg"!==e.childNodes[t].nodeName.toLowerCase()&&e.removeChild(e.childNodes[t]);const i=e.firstElementChild;if(i&&"svg"===i.nodeName.toLowerCase()){const t=i.getAttribute("class")||"";if(i.setAttribute("class",(t+" s-ion-icon").trim()),isValid(i))return e.innerHTML}}return""},isValid=t=>{if(1===t.nodeType){if("script"===t.nodeName.toLowerCase())return!1;for(let e=0;e<t.attributes.length;e++){const i=t.attributes[e].value;if(isStr(i)&&0===i.toLowerCase().indexOf("on"))return!1}for(let e=0;e<t.childNodes.length;e++)if(!isValid(t.childNodes[e]))return!1}return!0},ioniconContent=new Map,requests=new Map,getSvgContent=t=>{let e=requests.get(t);if(!e){if("undefined"==typeof fetch)return ioniconContent.set(t,""),Promise.resolve();e=fetch(t).then(e=>{if(e.ok)return e.text().then(e=>{ioniconContent.set(t,validateContent(e))});ioniconContent.set(t,"")}),requests.set(t,e)}return e},iconCss=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}:host(.flip-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",Icon=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.isVisible=!1,this.mode=getIonMode$1(),this.lazy=!1}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(t,e,i){if(this.lazy&&"undefined"!=typeof window&&window.IntersectionObserver){const n=this.io=new window.IntersectionObserver(t=>{t[0].isIntersecting&&(n.disconnect(),this.io=void 0,i())},{rootMargin:e});n.observe(t)}else i()}loadIcon(){if(this.isVisible){const t=getUrl(this);t&&(ioniconContent.has(t)?this.svgContent=ioniconContent.get(t):getSvgContent(t).then(()=>this.svgContent=ioniconContent.get(t)))}if(!this.ariaLabel){const t=getName(this.name,this.icon,this.mode,this.ios,this.md);t&&(this.ariaLabel=t.replace(/\-/g," "))}}render(){const t=this.mode||"md",e=this.flipRtl||this.ariaLabel&&(this.ariaLabel.indexOf("arrow")>-1||this.ariaLabel.indexOf("chevron")>-1)&&!1!==this.flipRtl;return h(Host,{role:"img",class:Object.assign(Object.assign({[t]:!0},createColorClasses$1(this.color)),{["icon-"+this.size]:!!this.size,"flip-rtl":!!e&&"rtl"===this.el.ownerDocument.dir})},h("div",this.svgContent?{class:"icon-inner",innerHTML:this.svgContent}:{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"]}}static get style(){return iconCss}},getIonMode$1=()=>"undefined"!=typeof document&&document.documentElement.getAttribute("mode")||"md",createColorClasses$1=t=>t?{"ion-color":!0,["ion-color-"+t]:!0}:null,imgCss=":host{display:block;-o-object-fit:contain;object-fit:contain}img{display:block;width:100%;height:100%;-o-object-fit:inherit;object-fit:inherit;-o-object-position:inherit;object-position:inherit}",Img=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.onLoad=()=>{this.ionImgDidLoad.emit()},this.onError=()=>{this.ionError.emit()},this.ionImgWillLoad=createEvent(this,"ionImgWillLoad",7),this.ionImgDidLoad=createEvent(this,"ionImgDidLoad",7),this.ionError=createEvent(this,"ionError",7)}srcChanged(){this.addIO()}componentDidLoad(){this.addIO()}addIO(){void 0!==this.src&&("IntersectionObserver"in window?(this.removeIO(),this.io=new IntersectionObserver(t=>{t[0].isIntersecting&&(this.load(),this.removeIO())}),this.io.observe(this.el)):setTimeout(()=>this.load(),200))}load(){this.loadError=this.onError,this.loadSrc=this.src,this.ionImgWillLoad.emit()}removeIO(){this.io&&(this.io.disconnect(),this.io=void 0)}render(){return h(Host,{class:getIonMode(this)},h("img",{decoding:"async",src:this.loadSrc,alt:this.alt,onLoad:this.onLoad,onError:this.loadError}))}get el(){return this}static get watchers(){return{src:["srcChanged"]}}static get style(){return imgCss}},infiniteScrollCss="ion-infinite-scroll{display:none;width:100%}.infinite-scroll-enabled{display:block}",InfiniteScroll=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.thrPx=0,this.thrPc=0,this.didFire=!1,this.isBusy=!1,this.isLoading=!1,this.threshold="15%",this.disabled=!1,this.position="bottom",this.onScroll=()=>{const t=this.scrollEl;if(!t||!this.canStart())return 1;const e=this.el.offsetHeight;if(0===e)return 2;const i=t.scrollTop,n=t.offsetHeight,s=0!==this.thrPc?n*this.thrPc:this.thrPx;if(("bottom"===this.position?t.scrollHeight-e-i-s-n:i-e-s)<0){if(!this.didFire)return this.isLoading=!0,this.didFire=!0,this.ionInfinite.emit(),3}else this.didFire=!1;return 4},this.ionInfinite=createEvent(this,"ionInfinite",7)}thresholdChanged(){const t=this.threshold;t.lastIndexOf("%")>-1?(this.thrPx=0,this.thrPc=parseFloat(t)/100):(this.thrPx=parseFloat(t),this.thrPc=0)}disabledChanged(){const t=this.disabled;t&&(this.isLoading=!1,this.isBusy=!1),this.enableScrollEvents(!t)}async connectedCallback(){const t=this.el.closest("ion-content");t?(this.scrollEl=await t.getScrollElement(),this.thresholdChanged(),this.disabledChanged(),"top"===this.position&&writeTask(()=>{this.scrollEl&&(this.scrollEl.scrollTop=this.scrollEl.scrollHeight-this.scrollEl.clientHeight)})):console.error("<ion-infinite-scroll> must be used inside an <ion-content>")}disconnectedCallback(){this.enableScrollEvents(!1),this.scrollEl=void 0}async complete(){const t=this.scrollEl;if(this.isLoading&&t&&(this.isLoading=!1,"top"===this.position)){this.isBusy=!0;const e=t.scrollHeight-t.scrollTop;requestAnimationFrame(()=>{readTask(()=>{const i=t.scrollHeight-e;requestAnimationFrame(()=>{writeTask(()=>{t.scrollTop=i,this.isBusy=!1})})})})}}canStart(){return!(this.disabled||this.isBusy||!this.scrollEl||this.isLoading)}enableScrollEvents(t){this.scrollEl&&(t?this.scrollEl.addEventListener("scroll",this.onScroll):this.scrollEl.removeEventListener("scroll",this.onScroll))}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"infinite-scroll-loading":this.isLoading,"infinite-scroll-enabled":!this.disabled}})}get el(){return this}static get watchers(){return{threshold:["thresholdChanged"],disabled:["disabledChanged"]}}static get style(){return infiniteScrollCss}},infiniteScrollContentIosCss="ion-infinite-scroll-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;min-height:84px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{margin-left:32px;margin-right:32px;margin-top:4px;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.infinite-loading-text{margin-left:unset;margin-right:unset;-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px}}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-ios .infinite-loading-text{color:var(--ion-color-step-600, #666666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-small-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-crescent circle{stroke:var(--ion-color-step-600, #666666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600, #666666)}",infiniteScrollContentMdCss="ion-infinite-scroll-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;min-height:84px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{margin-left:32px;margin-right:32px;margin-top:4px;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.infinite-loading-text{margin-left:unset;margin-right:unset;-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px}}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-md .infinite-loading-text{color:var(--ion-color-step-600, #666666)}.infinite-scroll-content-md .infinite-loading-spinner .spinner-lines-md line,.infinite-scroll-content-md .infinite-loading-spinner .spinner-lines-small-md line,.infinite-scroll-content-md .infinite-loading-spinner .spinner-crescent circle{stroke:var(--ion-color-step-600, #666666)}.infinite-scroll-content-md .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-md .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-md .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600, #666666)}",InfiniteScrollContent=class extends HTMLElement{constructor(){super(),this.__registerHost()}componentDidLoad(){if(void 0===this.loadingSpinner){const t=getIonMode(this);this.loadingSpinner=config.get("infiniteLoadingSpinner",config.get("spinner","ios"===t?"lines":"crescent"))}}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,["infinite-scroll-content-"+t]:!0}},h("div",{class:"infinite-loading"},this.loadingSpinner&&h("div",{class:"infinite-loading-spinner"},h("ion-spinner",{name:this.loadingSpinner})),this.loadingText&&h("div",{class:"infinite-loading-text",innerHTML:sanitizeDOMString(this.loadingText)})))}static get style(){return{ios:infiniteScrollContentIosCss,md:infiniteScrollContentMdCss}}},inputIosCss=".sc-ion-input-ios-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--background:transparent;--color:initial;display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;width:100%;padding:0 !important;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);z-index:2}ion-item.sc-ion-input-ios-h:not(.item-label),ion-item:not(.item-label) .sc-ion-input-ios-h{--padding-start:0}.ion-color.sc-ion-input-ios-h{color:var(--ion-color-base)}.native-input.sc-ion-input-ios{border-radius:var(--border-radius);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:inline-block;-ms-flex:1;flex:1;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.native-input.sc-ion-input-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.native-input.sc-ion-input-ios::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios:-webkit-autofill{background-color:transparent}.native-input.sc-ion-input-ios:invalid{-webkit-box-shadow:none;box-shadow:none}.native-input.sc-ion-input-ios::-ms-clear{display:none}.native-input[disabled].sc-ion-input-ios{opacity:0.4}.cloned-input.sc-ion-input-ios{left:0;top:0;position:absolute;pointer-events:none}[dir=rtl].sc-ion-input-ios .cloned-input.sc-ion-input-ios,[dir=rtl].sc-ion-input-ios-h .cloned-input.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h .cloned-input.sc-ion-input-ios{left:unset;right:unset;right:0}.input-clear-icon.sc-ion-input-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;background-position:center;border:0;outline:none;background-color:transparent;background-repeat:no-repeat;visibility:hidden;-webkit-appearance:none;-moz-appearance:none;appearance:none}.has-focus.has-value.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{visibility:visible}.has-focus.sc-ion-input-ios-h{pointer-events:none}.has-focus.sc-ion-input-ios-h input.sc-ion-input-ios,.has-focus.sc-ion-input-ios-h a.sc-ion-input-ios,.has-focus.sc-ion-input-ios-h button.sc-ion-input-ios{pointer-events:auto}.sc-ion-input-ios-h{--padding-top:10px;--padding-end:10px;--padding-bottom:10px;--padding-start:0;font-size:inherit}.item-label-stacked.sc-ion-input-ios-h,.item-label-stacked .sc-ion-input-ios-h,.item-label-floating.sc-ion-input-ios-h,.item-label-floating .sc-ion-input-ios-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0px}.input-clear-icon.sc-ion-input-ios{background-image:url(\"data:image/svg+xml;charset=utf-8,<svg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'><path%20fill='var(--ion-color-step-600,%20%23666666)'%20d='M403.1,108.9c-81.2-81.2-212.9-81.2-294.2,0s-81.2,212.9,0,294.2c81.2,81.2,212.9,81.2,294.2,0S484.3,190.1,403.1,108.9z%20M352,340.2L340.2,352l-84.4-84.2l-84,83.8L160,339.8l84-83.8l-84-83.8l11.8-11.8l84,83.8l84.4-84.2l11.8,11.8L267.6,256L352,340.2z'/></svg>\");width:30px;height:30px;background-size:18px}",inputMdCss=".sc-ion-input-md-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--background:transparent;--color:initial;display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;width:100%;padding:0 !important;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);z-index:2}ion-item.sc-ion-input-md-h:not(.item-label),ion-item:not(.item-label) .sc-ion-input-md-h{--padding-start:0}.ion-color.sc-ion-input-md-h{color:var(--ion-color-base)}.native-input.sc-ion-input-md{border-radius:var(--border-radius);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:inline-block;-ms-flex:1;flex:1;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.native-input.sc-ion-input-md{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.native-input.sc-ion-input-md::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md:-webkit-autofill{background-color:transparent}.native-input.sc-ion-input-md:invalid{-webkit-box-shadow:none;box-shadow:none}.native-input.sc-ion-input-md::-ms-clear{display:none}.native-input[disabled].sc-ion-input-md{opacity:0.4}.cloned-input.sc-ion-input-md{left:0;top:0;position:absolute;pointer-events:none}[dir=rtl].sc-ion-input-md .cloned-input.sc-ion-input-md,[dir=rtl].sc-ion-input-md-h .cloned-input.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h .cloned-input.sc-ion-input-md{left:unset;right:unset;right:0}.input-clear-icon.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;background-position:center;border:0;outline:none;background-color:transparent;background-repeat:no-repeat;visibility:hidden;-webkit-appearance:none;-moz-appearance:none;appearance:none}.has-focus.has-value.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{visibility:visible}.has-focus.sc-ion-input-md-h{pointer-events:none}.has-focus.sc-ion-input-md-h input.sc-ion-input-md,.has-focus.sc-ion-input-md-h a.sc-ion-input-md,.has-focus.sc-ion-input-md-h button.sc-ion-input-md{pointer-events:auto}.sc-ion-input-md-h{--padding-top:10px;--padding-end:0;--padding-bottom:10px;--padding-start:8px;font-size:inherit}.item-label-stacked.sc-ion-input-md-h,.item-label-stacked .sc-ion-input-md-h,.item-label-floating.sc-ion-input-md-h,.item-label-floating .sc-ion-input-md-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0}.input-clear-icon.sc-ion-input-md{background-image:url(\"data:image/svg+xml;charset=utf-8,<svg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'><polygon%20fill='var(--ion-color-step-600,%20%23666666)'%20points='405,136.798%20375.202,107%20256,226.202%20136.798,107%20107,136.798%20226.202,256%20107,375.202%20136.798,405%20256,285.798%20375.202,405%20405,375.202%20285.798,256'/></svg>\");width:30px;height:30px;background-size:22px}",Input=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.inputId="ion-input-"+inputIds++,this.didBlurAfterEdit=!1,this.hasFocus=!1,this.autocapitalize="off",this.autocomplete="off",this.autocorrect="off",this.autofocus=!1,this.clearInput=!1,this.debounce=0,this.disabled=!1,this.name=this.inputId,this.readonly=!1,this.required=!1,this.spellcheck=!1,this.type="text",this.value="",this.onInput=t=>{const e=t.target;e&&(this.value=e.value||""),this.ionInput.emit(t)},this.onBlur=()=>{this.hasFocus=!1,this.focusChanged(),this.emitStyle(),this.ionBlur.emit()},this.onFocus=()=>{this.hasFocus=!0,this.focusChanged(),this.emitStyle(),this.ionFocus.emit()},this.onKeydown=t=>{this.shouldClearOnEdit()&&(this.didBlurAfterEdit&&this.hasValue()&&"Enter"!==t.key&&this.clearTextInput(),this.didBlurAfterEdit=!1)},this.clearTextInput=t=>{this.clearInput&&!this.readonly&&!this.disabled&&t&&(t.preventDefault(),t.stopPropagation()),this.value="",this.nativeInput&&(this.nativeInput.value="")},this.ionInput=createEvent(this,"ionInput",7),this.ionChange=createEvent(this,"ionChange",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionStyle=createEvent(this,"ionStyle",7)}debounceChanged(){this.ionChange=debounceEvent(this.ionChange,this.debounce)}disabledChanged(){this.emitStyle()}valueChanged(){this.emitStyle(),this.ionChange.emit({value:null==this.value?this.value:this.value.toString()})}connectedCallback(){this.emitStyle(),this.debounceChanged(),document.dispatchEvent(new CustomEvent("ionInputDidLoad",{detail:this.el}))}disconnectedCallback(){document.dispatchEvent(new CustomEvent("ionInputDidUnload",{detail:this.el}))}async setFocus(){this.nativeInput&&this.nativeInput.focus()}getInputElement(){return Promise.resolve(this.nativeInput)}shouldClearOnEdit(){const{type:t,clearOnEdit:e}=this;return void 0===e?"password"===t:e}getValue(){return"number"==typeof this.value?this.value.toString():(this.value||"").toString()}emitStyle(){this.ionStyle.emit({interactive:!0,input:!0,"has-placeholder":null!=this.placeholder,"has-value":this.hasValue(),"has-focus":this.hasFocus,"interactive-disabled":this.disabled})}focusChanged(){!this.hasFocus&&this.shouldClearOnEdit()&&this.hasValue()&&(this.didBlurAfterEdit=!0)}hasValue(){return this.getValue().length>0}render(){const t=getIonMode(this),e=this.getValue(),i=this.inputId+"-lbl",n=findItemLabel(this.el);return n&&(n.id=i),h(Host,{"aria-disabled":this.disabled?"true":null,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0,"has-value":this.hasValue(),"has-focus":this.hasFocus})},h("input",{class:"native-input",ref:t=>this.nativeInput=t,"aria-labelledby":i,disabled:this.disabled,accept:this.accept,autoCapitalize:this.autocapitalize,autoComplete:this.autocomplete,autoCorrect:this.autocorrect,autoFocus:this.autofocus,inputMode:this.inputmode,min:this.min,max:this.max,minLength:this.minlength,maxLength:this.maxlength,multiple:this.multiple,name:this.name,pattern:this.pattern,placeholder:this.placeholder||"",readOnly:this.readonly,required:this.required,spellCheck:this.spellcheck,step:this.step,size:this.size,type:this.type,value:e,onInput:this.onInput,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeydown}),this.clearInput&&!this.readonly&&!this.disabled&&h("button",{type:"button",class:"input-clear-icon",tabindex:"-1",onTouchStart:this.clearTextInput,onMouseDown:this.clearTextInput}))}get el(){return this}static get watchers(){return{debounce:["debounceChanged"],disabled:["disabledChanged"],value:["valueChanged"]}}static get style(){return{ios:inputIosCss,md:inputMdCss}}};let inputIds=0;const itemIosCss=':host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:initial;text-decoration:none;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}:host(.ion-color) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color) .item-native,:host(.ion-color) .item-inner{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native::after{background:var(--ion-color-contrast)}@media (any-hover: hover){:host(.ion-activatable:hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:hover) .item-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:hover) .item-native::after{background:var(--ion-color-contrast)}}:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){cursor:default;opacity:0.3;pointer-events:none}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-native{padding-left:unset;padding-right:unset;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.item-native::-moz-focus-inner{border:0}.item-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--inner-padding-start);padding-right:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-inner{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end))}}.item-detail-icon{color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label){-ms-flex:1;flex:1}:host([vertical-align-top]),:host(.item-input){-ms-flex-align:start;align-items:flex-start}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-stacked) .item-native,:host(.item-label-floating) .item-native{-ms-flex-align:start;align-items:start}:host(.item-label-stacked) .input-wrapper,:host(.item-label-floating) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;bottom:0;position:absolute;background:var(--highlight-background);z-index:1}.item-highlight{height:var(--full-highlight-height)}.item-inner-highlight{height:var(--inset-highlight-height)}:host(.item-interactive.item-has-focus),:host(.item-interactive.ion-touched.ion-invalid){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-label-stacked) ::slotted(ion-select),:host(.item-label-floating) ::slotted(ion-select){--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(.item-label-stacked) ::slotted(ion-datetime),:host(.item-label-floating) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host{--min-height:44px;--transition:background-color 200ms linear, opacity 200ms linear;--padding-start:20px;--inner-padding-end:10px;--inner-border-width:0px 0px 0.55px 0px;--background:var(--ion-item-background, var(--ion-background-color, #fff));--background-activated:#000;--background-focused:#000;--background-hover:currentColor;--background-activated-opacity:.12;--background-focused-opacity:.15;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));--color:var(--ion-item-color, var(--ion-text-color, #000));--highlight-height:0;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);font-size:17px}:host(.ion-activated){--transition:none}:host(.ion-color.ion-focused) .item-native::after{background:#000;opacity:0.15}:host(.ion-color.ion-activated) .item-native::after{background:#000;opacity:0.12}:host(.item-interactive){--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-full){--border-width:0px 0px 0.55px 0px;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0px 0px 0.55px 0px;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0px;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0px;--show-inset-highlight:0}::slotted([slot=start]){margin-left:0;margin-right:20px;margin-top:2px;margin-bottom:2px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:20px;margin-inline-end:20px}}::slotted([slot=end]){margin-left:10px;margin-right:10px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}::slotted(ion-icon[slot=start]),::slotted(ion-icon[slot=end]){margin-top:7px;margin-bottom:7px}::slotted(ion-toggle[slot=start]),::slotted(ion-toggle[slot=end]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.item-label-stacked) ::slotted([slot=end]),:host(.item-label-floating) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}::slotted(.button-small){--padding-top:0px;--padding-bottom:0px;--padding-start:.5em;--padding-end:.5em;height:24px;font-size:13px}::slotted(ion-avatar){width:36px;height:36px}::slotted(ion-thumbnail){width:56px;height:56px}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:10px;margin-right:10px;margin-top:10px;margin-bottom:10px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}:host(.item-radio) ::slotted(ion-label),:host(.item-toggle) ::slotted(ion-label){margin-left:0px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.item-radio) ::slotted(ion-label),:host(.item-toggle) ::slotted(ion-label){margin-left:unset;-webkit-margin-start:0px;margin-inline-start:0px}}::slotted(ion-label){margin-left:0;margin-right:8px;margin-top:10px;margin-bottom:10px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-label){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}:host(.item-label-floating),:host(.item-label-stacked){--min-height:68px}:host(.item-label-stacked) ::slotted(ion-select),:host(.item-label-floating) ::slotted(ion-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0px}',itemMdCss=':host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:initial;text-decoration:none;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}:host(.ion-color) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color) .item-native,:host(.ion-color) .item-inner{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native::after{background:var(--ion-color-contrast)}@media (any-hover: hover){:host(.ion-activatable:hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:hover) .item-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:hover) .item-native::after{background:var(--ion-color-contrast)}}:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){cursor:default;opacity:0.3;pointer-events:none}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-native{padding-left:unset;padding-right:unset;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.item-native::-moz-focus-inner{border:0}.item-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--inner-padding-start);padding-right:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-inner{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end))}}.item-detail-icon{color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label){-ms-flex:1;flex:1}:host([vertical-align-top]),:host(.item-input){-ms-flex-align:start;align-items:flex-start}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-stacked) .item-native,:host(.item-label-floating) .item-native{-ms-flex-align:start;align-items:start}:host(.item-label-stacked) .input-wrapper,:host(.item-label-floating) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;bottom:0;position:absolute;background:var(--highlight-background);z-index:1}.item-highlight{height:var(--full-highlight-height)}.item-inner-highlight{height:var(--inset-highlight-height)}:host(.item-interactive.item-has-focus),:host(.item-interactive.ion-touched.ion-invalid){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-label-stacked) ::slotted(ion-select),:host(.item-label-floating) ::slotted(ion-select){--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(.item-label-stacked) ::slotted(ion-datetime),:host(.item-label-floating) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host{--min-height:48px;--background:var(--ion-item-background, var(--ion-background-color, #fff));--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--color:var(--ion-item-color, var(--ion-text-color, #000));--transition:opacity 15ms linear, background-color 15ms linear;--padding-start:16px;--color:var(--ion-item-color, var(--ion-text-color, #000));--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--inner-padding-end:16px;--inner-border-width:0 0 1px 0;--highlight-height:2px;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);font-size:16px;font-weight:normal;text-transform:none}:host(.ion-color.ion-activated) .item-native::after{background:transparent}:host(.item-interactive){--border-width:0 0 1px 0;--inner-border-width:0;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-full){--border-width:0 0 1px 0;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0 0 1px 0;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0;--show-inset-highlight:0}:host(.item-multi-line) ::slotted([slot=start]),:host(.item-multi-line) ::slotted([slot=end]){margin-top:16px;margin-bottom:16px;-ms-flex-item-align:start;align-self:flex-start}::slotted([slot=start]){margin-right:32px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-right:unset;-webkit-margin-end:32px;margin-inline-end:32px}}::slotted([slot=end]){margin-left:32px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;-webkit-margin-start:32px;margin-inline-start:32px}}::slotted(ion-icon){color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);font-size:24px}:host(.ion-color) ::slotted(ion-icon){color:var(--ion-color-contrast)}::slotted(ion-icon[slot]){margin-top:12px;margin-bottom:12px}::slotted(ion-icon[slot=start]){margin-right:32px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=start]){margin-right:unset;-webkit-margin-end:32px;margin-inline-end:32px}}::slotted(ion-icon[slot=end]){margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=end]){margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}::slotted(ion-toggle[slot=start]),::slotted(ion-toggle[slot=end]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}::slotted(ion-note){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-ms-flex-item-align:start;align-self:flex-start;font-size:11px}::slotted(ion-note[slot]){padding-left:0;padding-right:0;padding-top:18px;padding-bottom:10px}::slotted(ion-note[slot=start]){padding-right:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-note[slot=start]){padding-right:unset;-webkit-padding-end:16px;padding-inline-end:16px}}::slotted(ion-note[slot=end]){padding-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-note[slot=end]){padding-left:unset;-webkit-padding-start:16px;padding-inline-start:16px}}::slotted(ion-avatar){width:40px;height:40px}::slotted(ion-thumbnail){width:56px;height:56px}::slotted(ion-avatar),::slotted(ion-thumbnail){margin-top:8px;margin-bottom:8px}::slotted(ion-avatar[slot=start]),::slotted(ion-thumbnail[slot=start]){margin-right:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar[slot=start]),::slotted(ion-thumbnail[slot=start]){margin-right:unset;-webkit-margin-end:16px;margin-inline-end:16px}}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:11px;margin-bottom:10px}:host(.item-label-stacked) ::slotted([slot=end]),:host(.item-label-floating) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}:host(.item-toggle) ::slotted(ion-label),:host(.item-radio) ::slotted(ion-label){margin-left:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.item-toggle) ::slotted(ion-label),:host(.item-radio) ::slotted(ion-label){margin-left:unset;-webkit-margin-start:0;margin-inline-start:0}}::slotted(.button-small){--padding-top:0;--padding-bottom:0;--padding-start:.6em;--padding-end:.6em;height:25px;font-size:12px}:host(.item-label-floating),:host(.item-label-stacked){--min-height:55px}:host(.item-label-stacked) ::slotted(ion-select),:host(.item-label-floating) ::slotted(ion-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0}:host(.item-has-focus:not(.ion-color)) ::slotted(.label-stacked),:host(.item-has-focus:not(.ion-color)) ::slotted(.label-floating){color:var(--ion-color-primary, #3880ff)}',Item=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.itemStyles=new Map,this.multipleInputs=!1,this.button=!1,this.detailIcon="chevron-forward",this.disabled=!1,this.routerDirection="forward",this.type="button"}itemStyle(t){t.stopPropagation();const e=t.target.tagName,i=t.detail,n={},s=this.itemStyles.get(e)||{};let o=!1;Object.keys(i).forEach(t=>{if(i[t]){const e="item-"+t;s[e]||(o=!0),n[e]=!0}}),o||Object.keys(n).length===Object.keys(s).length||(o=!0),o&&(this.itemStyles.set(e,n),forceUpdate(this))}componentDidLoad(){const t=this.el.querySelectorAll("ion-checkbox, ion-datetime, ion-select, ion-radio"),e=this.el.querySelectorAll("ion-input, ion-range, ion-searchbar, ion-segment, ion-textarea, ion-toggle"),i=this.el.querySelectorAll("ion-anchor, ion-button, a, button");this.multipleInputs=t.length+e.length>1||t.length+i.length>1||t.length>0&&this.isClickable()}hasCover(){return 1===this.el.querySelectorAll("ion-checkbox, ion-datetime, ion-select, ion-radio").length&&!this.multipleInputs}isClickable(){return void 0!==this.href||this.button}canActivate(){return this.isClickable()||this.hasCover()}render(){const{detail:t,detailIcon:e,download:i,lines:n,disabled:s,href:o,rel:r,target:a,routerDirection:l}=this,c={},d=getIonMode(this),u=this.isClickable(),m=this.canActivate(),p=u?void 0===o?"button":"a":"div",b="button"===p?{type:this.type}:{download:i,href:o,rel:r,target:a},f=void 0!==t?t:"ios"===d&&u;return this.itemStyles.forEach(t=>{Object.assign(c,t)}),h(Host,{"aria-disabled":s?"true":null,class:Object.assign(Object.assign(Object.assign({},c),createColorClasses(this.color)),{item:!0,[d]:!0,["item-lines-"+n]:void 0!==n,"item-disabled":s,"in-list":hostContext("ion-list",this.el),"item-multiple-inputs":this.multipleInputs,"ion-activatable":m,"ion-focusable":!0})},h(p,Object.assign({},b,{class:"item-native",disabled:s,onClick:t=>openURL(o,t,l)}),h("slot",{name:"start"}),h("div",{class:"item-inner"},h("div",{class:"input-wrapper"},h("slot",null)),h("slot",{name:"end"}),f&&h("ion-icon",{icon:e,lazy:!1,class:"item-detail-icon"}),h("div",{class:"item-inner-highlight"})),m&&"md"===d&&h("ion-ripple-effect",null)),h("div",{class:"item-highlight"}))}get el(){return this}static get style(){return{ios:itemIosCss,md:itemMdCss}}},itemDividerIosCss=":host{--padding-top:0px;--padding-end:0px;--padding-bottom:0px;--padding-start:0px;--inner-padding-top:0px;--inner-padding-end:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);overflow:hidden;z-index:100;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.item-divider-sticky){position:-webkit-sticky;position:sticky;top:0}.item-divider-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--inner-padding-start);padding-right:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border:0;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-divider-inner{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end))}}.item-divider-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:hidden}:host{--background:var(--ion-color-step-100, #e6e6e6);--color:var(--ion-color-step-850, #262626);--padding-start:20px;--inner-padding-end:10px;border-radius:0;position:relative;min-height:28px;font-size:17px;font-weight:600}:host([slot=start]){margin-left:0;margin-right:20px;margin-top:2px;margin-bottom:2px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:20px;margin-inline-end:20px}}:host([slot=end]){margin-left:10px;margin-right:10px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}::slotted(ion-icon[slot=start]),::slotted(ion-icon[slot=end]){margin-top:7px;margin-bottom:7px}::slotted(h1){margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}::slotted(h2){margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:17px;font-weight:normal}::slotted(h3),::slotted(h4),::slotted(h5),::slotted(h6){margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:normal;line-height:normal}::slotted(p){margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.4);font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}::slotted(h2:last-child) ::slotted(h3:last-child),::slotted(h4:last-child),::slotted(h5:last-child),::slotted(h6:last-child),::slotted(p:last-child){margin-bottom:0}",itemDividerMdCss=":host{--padding-top:0px;--padding-end:0px;--padding-bottom:0px;--padding-start:0px;--inner-padding-top:0px;--inner-padding-end:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);overflow:hidden;z-index:100;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.item-divider-sticky){position:-webkit-sticky;position:sticky;top:0}.item-divider-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--inner-padding-start);padding-right:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border:0;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-divider-inner{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end))}}.item-divider-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:hidden}:host{--background:var(--ion-background-color, #fff);--color:var(--ion-color-step-400, #999999);--padding-start:16px;--inner-padding-end:0;min-height:30px;border-bottom:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));font-size:14px}::slotted([slot=start]){margin-right:32px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-right:unset;-webkit-margin-end:32px;margin-inline-end:32px}}::slotted([slot=end]){margin-left:32px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;-webkit-margin-start:32px;margin-inline-start:32px}}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:13px;margin-bottom:10px}::slotted(ion-icon){color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);font-size:24px}:host(.ion-color) ::slotted(ion-icon){color:var(--ion-color-contrast)}::slotted(ion-icon[slot]){margin-top:12px;margin-bottom:12px}::slotted(ion-icon[slot=start]){margin-right:32px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=start]){margin-right:unset;-webkit-margin-end:32px;margin-inline-end:32px}}::slotted(ion-icon[slot=end]){margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-icon[slot=end]){margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}::slotted(ion-note){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-ms-flex-item-align:start;align-self:flex-start;font-size:11px}::slotted(ion-note[slot]){padding-left:0;padding-right:0;padding-top:18px;padding-bottom:10px}::slotted(ion-note[slot=start]){padding-right:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-note[slot=start]){padding-right:unset;-webkit-padding-end:16px;padding-inline-end:16px}}::slotted(ion-note[slot=end]){padding-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-note[slot=end]){padding-left:unset;-webkit-padding-start:16px;padding-inline-start:16px}}::slotted(ion-avatar){width:40px;height:40px}::slotted(ion-thumbnail){width:56px;height:56px}::slotted(ion-avatar),::slotted(ion-thumbnail){margin-top:8px;margin-bottom:8px}::slotted(ion-avatar[slot=start]),::slotted(ion-thumbnail[slot=start]){margin-right:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar[slot=start]),::slotted(ion-thumbnail[slot=start]){margin-right:unset;-webkit-margin-end:16px;margin-inline-end:16px}}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}::slotted(h1){margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}::slotted(h2){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}::slotted(h3,h4,h5,h6){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:normal}::slotted(p){margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;color:var(--ion-color-step-600, #666666);font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}",ItemDivider=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.sticky=!1}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0,"item-divider-sticky":this.sticky,item:!0})},h("slot",{name:"start"}),h("div",{class:"item-divider-inner"},h("div",{class:"item-divider-wrapper"},h("slot",null)),h("slot",{name:"end"})))}get el(){return this}static get style(){return{ios:itemDividerIosCss,md:itemDividerMdCss}}},itemGroupIosCss="ion-item-group{display:block}",itemGroupMdCss="ion-item-group{display:block}",ItemGroup=class extends HTMLElement{constructor(){super(),this.__registerHost()}render(){const t=getIonMode(this);return h(Host,{role:"group",class:{[t]:!0,["item-group-"+t]:!0,item:!0}})}static get style(){return{ios:itemGroupIosCss,md:itemGroupMdCss}}},itemOptionIosCss=":host{--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff);background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit)}:host(.in-list.item-options-end:last-child){padding-right:calc(.7em + var(--ion-safe-area-right))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-list.item-options-end:last-child){padding-right:unset;-webkit-padding-end:calc(.7em + var(--ion-safe-area-right));padding-inline-end:calc(.7em + var(--ion-safe-area-right))}}:host(.in-list.item-options-start:first-child){padding-left:calc(.7em + var(--ion-safe-area-left))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-list.item-options-start:first-child){padding-left:unset;-webkit-padding-start:calc(.7em + var(--ion-safe-area-left));padding-inline-start:calc(.7em + var(--ion-safe-area-left))}}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}.button-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0.7em;padding-right:0.7em;padding-top:0;padding-bottom:0;display:inline-block;position:relative;width:100%;height:100%;border:0;outline:none;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:0.7em;padding-inline-start:0.7em;-webkit-padding-end:0.7em;padding-inline-end:0.7em}}.button-inner{display:-ms-flexbox;display:flex;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.horizontal-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%}::slotted(*){-ms-flex-negative:0;flex-shrink:0}::slotted([slot=start]){margin-left:0;margin-right:5px;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:5px;margin-inline-end:5px}}::slotted([slot=end]){margin-left:5px;margin-right:0;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:5px;margin-inline-start:5px;-webkit-margin-end:0;margin-inline-end:0}}::slotted([slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:10px;margin-right:10px;margin-top:0;margin-bottom:0;min-width:0.9em;font-size:1.8em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=icon-only]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}:host(.item-option-expandable){-ms-flex-negative:0;flex-shrink:0;-webkit-transition-duration:0;transition-duration:0;-webkit-transition-property:none;transition-property:none;-webkit-transition-timing-function:cubic-bezier(0.65, 0.05, 0.36, 1);transition-timing-function:cubic-bezier(0.65, 0.05, 0.36, 1)}:host(.item-option-disabled){pointer-events:none}:host(.item-option-disabled) .button-native{cursor:default;opacity:0.5;pointer-events:none}:host{font-size:16px}:host(.ion-activated){background:var(--ion-color-primary-shade, #3171e0)}:host(.ion-color.ion-activated){background:var(--ion-color-shade)}",itemOptionMdCss=":host{--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff);background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit)}:host(.in-list.item-options-end:last-child){padding-right:calc(.7em + var(--ion-safe-area-right))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-list.item-options-end:last-child){padding-right:unset;-webkit-padding-end:calc(.7em + var(--ion-safe-area-right));padding-inline-end:calc(.7em + var(--ion-safe-area-right))}}:host(.in-list.item-options-start:first-child){padding-left:calc(.7em + var(--ion-safe-area-left))}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-list.item-options-start:first-child){padding-left:unset;-webkit-padding-start:calc(.7em + var(--ion-safe-area-left));padding-inline-start:calc(.7em + var(--ion-safe-area-left))}}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}.button-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0.7em;padding-right:0.7em;padding-top:0;padding-bottom:0;display:inline-block;position:relative;width:100%;height:100%;border:0;outline:none;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:0.7em;padding-inline-start:0.7em;-webkit-padding-end:0.7em;padding-inline-end:0.7em}}.button-inner{display:-ms-flexbox;display:flex;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.horizontal-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%}::slotted(*){-ms-flex-negative:0;flex-shrink:0}::slotted([slot=start]){margin-left:0;margin-right:5px;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:5px;margin-inline-end:5px}}::slotted([slot=end]){margin-left:5px;margin-right:0;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:5px;margin-inline-start:5px;-webkit-margin-end:0;margin-inline-end:0}}::slotted([slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:10px;margin-right:10px;margin-top:0;margin-bottom:0;min-width:0.9em;font-size:1.8em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=icon-only]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}:host(.item-option-expandable){-ms-flex-negative:0;flex-shrink:0;-webkit-transition-duration:0;transition-duration:0;-webkit-transition-property:none;transition-property:none;-webkit-transition-timing-function:cubic-bezier(0.65, 0.05, 0.36, 1);transition-timing-function:cubic-bezier(0.65, 0.05, 0.36, 1)}:host(.item-option-disabled){pointer-events:none}:host(.item-option-disabled) .button-native{cursor:default;opacity:0.5;pointer-events:none}:host{font-size:14px;font-weight:500;text-transform:uppercase}",ItemOption=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.disabled=!1,this.expandable=!1,this.type="button",this.onClick=t=>{t.target.closest("ion-item-option")&&t.preventDefault()}}render(){const{disabled:t,expandable:e,href:i}=this,n=void 0===i?"button":"a",s=getIonMode(this),o="button"===n?{type:this.type}:{download:this.download,href:this.href,target:this.target};return h(Host,{onClick:this.onClick,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[s]:!0,"item-option-disabled":t,"item-option-expandable":e,"ion-activatable":!0})},h(n,Object.assign({},o,{class:"button-native",disabled:t}),h("span",{class:"button-inner"},h("slot",{name:"top"}),h("div",{class:"horizontal-wrapper"},h("slot",{name:"start"}),h("slot",{name:"icon-only"}),h("slot",null),h("slot",{name:"end"})),h("slot",{name:"bottom"})),"md"===s&&h("ion-ripple-effect",null)))}get el(){return this}static get style(){return{ios:itemOptionIosCss,md:itemOptionMdCss}}},itemOptionsIosCss="ion-item-options{top:0;right:0;-ms-flex-pack:end;justify-content:flex-end;display:none;position:absolute;height:100%;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1}[dir=rtl] ion-item-options,:host-context([dir=rtl]) ion-item-options{-ms-flex-pack:start;justify-content:flex-start}[dir=rtl] ion-item-options:not(.item-options-end),:host-context([dir=rtl]) ion-item-options:not(.item-options-end){right:auto;left:0;-ms-flex-pack:end;justify-content:flex-end}.item-options-start{right:auto;left:0;-ms-flex-pack:start;justify-content:flex-start}[dir=rtl] .item-options-start,:host-context([dir=rtl]) .item-options-start{-ms-flex-pack:end;justify-content:flex-end}.item-options-start ion-item-option:first-child{padding-right:var(--ion-safe-area-left)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-options-start ion-item-option:first-child{padding-right:unset;-webkit-padding-end:var(--ion-safe-area-left);padding-inline-end:var(--ion-safe-area-left)}}.item-options-end ion-item-option:last-child{padding-right:var(--ion-safe-area-right)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-options-end ion-item-option:last-child{padding-right:unset;-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}[dir=rtl] .item-sliding-active-slide.item-sliding-active-options-start ion-item-options:not(.item-options-end),:host-context([dir=rtl]) .item-sliding-active-slide.item-sliding-active-options-start ion-item-options:not(.item-options-end){width:100%;visibility:visible}.item-sliding-active-slide ion-item-options{display:-ms-flexbox;display:flex;visibility:hidden}.item-sliding-active-slide.item-sliding-active-options-start .item-options-start,.item-sliding-active-slide.item-sliding-active-options-end ion-item-options:not(.item-options-start){width:100%;visibility:visible}.item-options-ios{border-bottom-width:0;border-bottom-style:solid;border-bottom-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)))}.item-options-ios.item-options-end{border-bottom-width:0.55px}.list-ios-lines-none .item-options-ios{border-bottom-width:0}.list-ios-lines-full .item-options-ios,.list-ios-lines-inset .item-options-ios.item-options-end{border-bottom-width:0.55px}",itemOptionsMdCss="ion-item-options{top:0;right:0;-ms-flex-pack:end;justify-content:flex-end;display:none;position:absolute;height:100%;font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1}[dir=rtl] ion-item-options,:host-context([dir=rtl]) ion-item-options{-ms-flex-pack:start;justify-content:flex-start}[dir=rtl] ion-item-options:not(.item-options-end),:host-context([dir=rtl]) ion-item-options:not(.item-options-end){right:auto;left:0;-ms-flex-pack:end;justify-content:flex-end}.item-options-start{right:auto;left:0;-ms-flex-pack:start;justify-content:flex-start}[dir=rtl] .item-options-start,:host-context([dir=rtl]) .item-options-start{-ms-flex-pack:end;justify-content:flex-end}.item-options-start ion-item-option:first-child{padding-right:var(--ion-safe-area-left)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-options-start ion-item-option:first-child{padding-right:unset;-webkit-padding-end:var(--ion-safe-area-left);padding-inline-end:var(--ion-safe-area-left)}}.item-options-end ion-item-option:last-child{padding-right:var(--ion-safe-area-right)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-options-end ion-item-option:last-child{padding-right:unset;-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}[dir=rtl] .item-sliding-active-slide.item-sliding-active-options-start ion-item-options:not(.item-options-end),:host-context([dir=rtl]) .item-sliding-active-slide.item-sliding-active-options-start ion-item-options:not(.item-options-end){width:100%;visibility:visible}.item-sliding-active-slide ion-item-options{display:-ms-flexbox;display:flex;visibility:hidden}.item-sliding-active-slide.item-sliding-active-options-start .item-options-start,.item-sliding-active-slide.item-sliding-active-options-end ion-item-options:not(.item-options-start){width:100%;visibility:visible}.item-options-md{border-bottom-width:0;border-bottom-style:solid;border-bottom-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))))}.list-md-lines-none .item-options-md{border-bottom-width:0}.list-md-lines-full .item-options-md,.list-md-lines-inset .item-options-md.item-options-end{border-bottom-width:1px}",ItemOptions=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.side="end",this.ionSwipe=createEvent(this,"ionSwipe",7)}async fireSwipeEvent(){this.ionSwipe.emit({side:this.side})}render(){const t=getIonMode(this),e=isEndSide(this.side);return h(Host,{class:{[t]:!0,["item-options-"+t]:!0,"item-options-start":!e,"item-options-end":e}})}get el(){return this}static get style(){return{ios:itemOptionsIosCss,md:itemOptionsMdCss}}},itemSlidingCss="ion-item-sliding{display:block;position:relative;width:100%;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}ion-item-sliding .item{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.item-sliding-active-slide .item{position:relative;-webkit-transition:-webkit-transform 500ms cubic-bezier(0.36, 0.66, 0.04, 1);transition:-webkit-transform 500ms cubic-bezier(0.36, 0.66, 0.04, 1);transition:transform 500ms cubic-bezier(0.36, 0.66, 0.04, 1);transition:transform 500ms cubic-bezier(0.36, 0.66, 0.04, 1), -webkit-transform 500ms cubic-bezier(0.36, 0.66, 0.04, 1);opacity:1;z-index:2;pointer-events:none;will-change:transform}.item-sliding-active-swipe-end .item-options-end .item-option-expandable{padding-left:100%;-ms-flex-order:1;order:1;-webkit-transition-duration:0.6s;transition-duration:0.6s;-webkit-transition-property:padding-left;transition-property:padding-left}[dir=rtl] .item-sliding-active-swipe-end .item-options-end .item-option-expandable,:host-context([dir=rtl]) .item-sliding-active-swipe-end .item-options-end .item-option-expandable{-ms-flex-order:-1;order:-1}.item-sliding-active-swipe-start .item-options-start .item-option-expandable{padding-right:100%;-ms-flex-order:-1;order:-1;-webkit-transition-duration:0.6s;transition-duration:0.6s;-webkit-transition-property:padding-right;transition-property:padding-right}[dir=rtl] .item-sliding-active-swipe-start .item-options-start .item-option-expandable,:host-context([dir=rtl]) .item-sliding-active-swipe-start .item-options-start .item-option-expandable{-ms-flex-order:1;order:1}",SWIPE_MARGIN=30,ELASTIC_FACTOR=.55;let openSlidingItem;const ItemSliding=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.item=null,this.openAmount=0,this.initialOpenAmount=0,this.optsWidthRightSide=0,this.optsWidthLeftSide=0,this.sides=0,this.optsDirty=!0,this.state=2,this.disabled=!1,this.ionDrag=createEvent(this,"ionDrag",7)}disabledChanged(){this.gesture&&this.gesture.enable(!this.disabled)}async connectedCallback(){this.item=this.el.querySelector("ion-item"),await this.updateOptions(),this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.el,gestureName:"item-swipe",gesturePriority:100,threshold:5,canStart:t=>this.canStart(t),onStart:()=>this.onStart(),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.disabledChanged()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.item=null,this.leftOptions=this.rightOptions=void 0,openSlidingItem===this.el&&(openSlidingItem=void 0)}getOpenAmount(){return Promise.resolve(this.openAmount)}getSlidingRatio(){return Promise.resolve(this.getSlidingRatioSync())}async open(t){if(null===this.item)return;const e=this.getOptions(t);e&&(void 0===t&&(t=e===this.leftOptions?"start":"end"),t=isEndSide(t)?"end":"start",this.openAmount<0&&e===this.leftOptions||this.openAmount>0&&e===this.rightOptions||(this.closeOpened(),this.state=4,requestAnimationFrame(()=>{this.calculateOptsWidth(),openSlidingItem=this.el,this.setOpenAmount("end"===t?this.optsWidthRightSide:-this.optsWidthLeftSide,!1),this.state="end"===t?8:16})))}async close(){this.setOpenAmount(0,!0)}async closeOpened(){return void 0!==openSlidingItem&&(openSlidingItem.close(),openSlidingItem=void 0,!0)}getOptions(t){return void 0===t?this.leftOptions||this.rightOptions:"start"===t?this.leftOptions:this.rightOptions}async updateOptions(){const t=this.el.querySelectorAll("ion-item-options");let e=0;this.leftOptions=this.rightOptions=void 0;for(let i=0;i<t.length;i++){const n=await t.item(i).componentOnReady();"start"==(isEndSide(n.side)?"end":"start")?(this.leftOptions=n,e|=1):(this.rightOptions=n,e|=2)}this.optsDirty=!0,this.sides=e}canStart(t){return!("rtl"===document.dir?window.innerWidth-t.startX<15:t.startX<15)&&(openSlidingItem&&openSlidingItem!==this.el?(this.closeOpened(),!1):!(!this.rightOptions&&!this.leftOptions))}onStart(){openSlidingItem=this.el,void 0!==this.tmr&&(clearTimeout(this.tmr),this.tmr=void 0),0===this.openAmount&&(this.optsDirty=!0,this.state=4),this.initialOpenAmount=this.openAmount,this.item&&(this.item.style.transition="none")}onMove(t){this.optsDirty&&this.calculateOptsWidth();let e,i=this.initialOpenAmount-t.deltaX;switch(this.sides){case 2:i=Math.max(0,i);break;case 1:i=Math.min(0,i);break;case 3:break;case 0:return;default:console.warn("invalid ItemSideFlags value",this.sides)}i>this.optsWidthRightSide?(e=this.optsWidthRightSide,i=e+(i-e)*ELASTIC_FACTOR):i<-this.optsWidthLeftSide&&(e=-this.optsWidthLeftSide,i=e+(i-e)*ELASTIC_FACTOR),this.setOpenAmount(i,!1)}onEnd(t){const e=t.velocityX;let i=this.openAmount>0?this.optsWidthRightSide:-this.optsWidthLeftSide;const n=this.openAmount>0==!(e<0),s=Math.abs(e)>.3,o=Math.abs(this.openAmount)<Math.abs(i/2);swipeShouldReset(n,s,o)&&(i=0);const r=this.state;this.setOpenAmount(i,!0),0!=(32&r)&&this.rightOptions?this.rightOptions.fireSwipeEvent():0!=(64&r)&&this.leftOptions&&this.leftOptions.fireSwipeEvent()}calculateOptsWidth(){this.optsWidthRightSide=0,this.rightOptions&&(this.rightOptions.style.display="flex",this.optsWidthRightSide=this.rightOptions.offsetWidth,this.rightOptions.style.display=""),this.optsWidthLeftSide=0,this.leftOptions&&(this.leftOptions.style.display="flex",this.optsWidthLeftSide=this.leftOptions.offsetWidth,this.leftOptions.style.display=""),this.optsDirty=!1}setOpenAmount(t,e){if(void 0!==this.tmr&&(clearTimeout(this.tmr),this.tmr=void 0),!this.item)return;const i=this.item.style;if(this.openAmount=t,e&&(i.transition=""),t>0)this.state=t>=this.optsWidthRightSide+SWIPE_MARGIN?40:8;else{if(!(t<0))return this.tmr=setTimeout(()=>{this.state=2,this.tmr=void 0},600),openSlidingItem=void 0,void(i.transform="");this.state=t<=-this.optsWidthLeftSide-SWIPE_MARGIN?80:16}i.transform=`translate3d(${-t}px,0,0)`,this.ionDrag.emit({amount:t,ratio:this.getSlidingRatioSync()})}getSlidingRatioSync(){return this.openAmount>0?this.openAmount/this.optsWidthRightSide:this.openAmount<0?this.openAmount/this.optsWidthLeftSide:0}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"item-sliding-active-slide":2!==this.state,"item-sliding-active-options-end":0!=(8&this.state),"item-sliding-active-options-start":0!=(16&this.state),"item-sliding-active-swipe-end":0!=(32&this.state),"item-sliding-active-swipe-start":0!=(64&this.state)}})}get el(){return this}static get watchers(){return{disabled:["disabledChanged"]}}static get style(){return itemSlidingCss}},swipeShouldReset=(t,e,i)=>!e&&i||t&&e,labelIosCss=".item.sc-ion-label-ios-h,.item .sc-ion-label-ios-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-ios-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{white-space:normal}.item-interactive-disabled.sc-ion-label-ios-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-ios-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-ios-h,.item-input .sc-ion-label-ios-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-ios-h,.item-textarea .sc-ion-label-ios-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-ios-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-ios-h,.label-floating.sc-ion-label-ios-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-ios-h{-webkit-transition:none;transition:none}.sc-ion-label-ios-s h1,.sc-ion-label-ios-s h2,.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{font-size:14px;line-height:1.5}.label-stacked.sc-ion-label-ios-h{margin-bottom:4px;font-size:14px}.label-floating.sc-ion-label-ios-h{margin-bottom:0;-webkit-transform:translate3d(0,  27px,  0);transform:translate3d(0,  27px,  0);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms ease-in-out;transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out}[dir=rtl].sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl] .sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl].label-floating.sc-ion-label-ios-h,[dir=rtl] .label-floating.sc-ion-label-ios-h{-webkit-transform-origin:right top;transform-origin:right top}.item-has-focus.label-floating.sc-ion-label-ios-h,.item-has-focus .label-floating.sc-ion-label-ios-h,.item-has-placeholder.label-floating.sc-ion-label-ios-h,.item-has-placeholder .label-floating.sc-ion-label-ios-h,.item-has-value.label-floating.sc-ion-label-ios-h,.item-has-value .label-floating.sc-ion-label-ios-h{-webkit-transform:translate3d(0,  0,  0) scale(0.82);transform:translate3d(0,  0,  0) scale(0.82)}.sc-ion-label-ios-s h1{margin-left:0;margin-right:0;margin-top:3px;margin-bottom:2px;font-size:22px;font-weight:normal}.sc-ion-label-ios-s h2{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:17px;font-weight:normal}.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-ios-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}.sc-ion-label-ios-s>p{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.4)}.sc-ion-label-ios-h.ion-color.sc-ion-label-ios-s>p,.ion-color .sc-ion-label-ios-h.sc-ion-label-ios-s>p{color:inherit}.sc-ion-label-ios-s h2:last-child,.sc-ion-label-ios-s h3:last-child,.sc-ion-label-ios-s h4:last-child,.sc-ion-label-ios-s h5:last-child,.sc-ion-label-ios-s h6:last-child,.sc-ion-label-ios-s p:last-child{margin-bottom:0}",labelMdCss=".item.sc-ion-label-md-h,.item .sc-ion-label-md-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-md-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{white-space:normal}.item-interactive-disabled.sc-ion-label-md-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-md-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-md-h,.item-input .sc-ion-label-md-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-md-h,.item-textarea .sc-ion-label-md-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-md-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-md-h{-webkit-transition:none;transition:none}.sc-ion-label-md-s h1,.sc-ion-label-md-s h2,.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{line-height:1.5}.label-stacked.sc-ion-label-md-h{-webkit-transform-origin:left top;transform-origin:left top;-webkit-transform:translate3d(0,  50%,  0) scale(0.75);transform:translate3d(0,  50%,  0) scale(0.75);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl].sc-ion-label-md-h -no-combinator.label-stacked.sc-ion-label-md-h,[dir=rtl] .sc-ion-label-md-h -no-combinator.label-stacked.sc-ion-label-md-h,[dir=rtl].label-stacked.sc-ion-label-md-h,[dir=rtl] .label-stacked.sc-ion-label-md-h{-webkit-transform-origin:right top;transform-origin:right top}.label-floating.sc-ion-label-md-h{-webkit-transform:translate3d(0,  96%,  0);transform:translate3d(0,  96%,  0);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1)}[dir=rtl].sc-ion-label-md-h -no-combinator.label-floating.sc-ion-label-md-h,[dir=rtl] .sc-ion-label-md-h -no-combinator.label-floating.sc-ion-label-md-h,[dir=rtl].label-floating.sc-ion-label-md-h,[dir=rtl] .label-floating.sc-ion-label-md-h{-webkit-transform-origin:right top;transform-origin:right top}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.item-select.label-floating.sc-ion-label-md-h,.item-select .label-floating.sc-ion-label-md-h{-webkit-transform:translate3d(0,  130%,  0);transform:translate3d(0,  130%,  0)}.item-has-focus.label-floating.sc-ion-label-md-h,.item-has-focus .label-floating.sc-ion-label-md-h,.item-has-placeholder.label-floating.sc-ion-label-md-h,.item-has-placeholder .label-floating.sc-ion-label-md-h,.item-has-value.label-floating.sc-ion-label-md-h,.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translate3d(0,  50%,  0) scale(0.75);transform:translate3d(0,  50%,  0) scale(0.75)}.item-has-focus.label-stacked.sc-ion-label-md-h,.item-has-focus .label-stacked.sc-ion-label-md-h,.item-has-focus.label-floating.sc-ion-label-md-h,.item-has-focus .label-floating.sc-ion-label-md-h{color:var(--ion-color-primary, #3880ff)}.sc-ion-label-md-s h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.sc-ion-label-md-s h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-md-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:20px;text-overflow:inherit;overflow:inherit}.sc-ion-label-md-s>p{color:var(--ion-color-step-600, #666666)}.sc-ion-label-md-h.ion-color.sc-ion-label-md-s>p,.ion-color .sc-ion-label-md-h.sc-ion-label-md-s>p{color:inherit}",Label=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.noAnimate=!1,this.ionStyle=createEvent(this,"ionStyle",7)}componentWillLoad(){this.noAnimate="floating"===this.position,this.emitStyle()}componentDidLoad(){this.noAnimate&&setTimeout(()=>{this.noAnimate=!1},1e3)}positionChanged(){this.emitStyle()}emitStyle(){const t=this.position;this.ionStyle.emit({label:!0,["label-"+t]:void 0!==t})}render(){const t=this.position,e=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[e]:!0,["label-"+t]:void 0!==t,"label-no-animate":this.noAnimate})})}get el(){return this}static get watchers(){return{position:["positionChanged"]}}static get style(){return{ios:labelIosCss,md:labelMdCss}}},listIosCss="ion-list{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:block;contain:content;list-style-type:none}ion-list.list-inset{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:hidden}.list-ios{background:var(--ion-item-background, var(--ion-background-color, #fff))}.list-ios.list-inset{margin-left:16px;margin-right:16px;margin-top:16px;margin-bottom:16px;border-radius:4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.list-ios.list-inset{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px}}.list-ios.list-inset ion-item{--border-width:0 0 1px 0;--inner-border-width:0}.list-ios.list-inset ion-item:last-child{--border-width:0;--inner-border-width:0}.list-ios.list-inset+ion-list.list-inset{margin-top:0}.list-ios-lines-none .item{--border-width:0;--inner-border-width:0}.list-ios-lines-full .item,.list-ios .item-lines-full{--border-width:0 0 0.55px 0}.list-ios-lines-full .item{--inner-border-width:0}.list-ios-lines-inset .item,.list-ios .item-lines-inset{--inner-border-width:0 0 0.55px 0}.list-ios .item-lines-inset{--border-width:0}.list-ios .item-lines-full{--inner-border-width:0}.list-ios .item-lines-none{--border-width:0;--inner-border-width:0}ion-card .list-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}",listMdCss="ion-list{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:block;contain:content;list-style-type:none}ion-list.list-inset{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:hidden}.list-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:8px;padding-bottom:8px;background:var(--ion-item-background, var(--ion-background-color, #fff))}.list-md>.input:last-child::after{left:0}[dir=rtl] .list-md>.input:last-child::after,:host-context([dir=rtl]) .list-md>.input:last-child::after{left:unset;right:unset;right:0}.list-md.list-inset{margin-left:16px;margin-right:16px;margin-top:16px;margin-bottom:16px;border-radius:2px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.list-md.list-inset{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px}}.list-md.list-inset ion-item:first-child{--border-radius:2px 2px 0 0;--border-width:0 0 1px 0}.list-md.list-inset ion-item:last-child{--border-radius:0 0 2px, 2px;--border-width:0}.list-md.list-inset .item-interactive{--padding-start:0;--padding-end:0}.list-md.list-inset+ion-list.list-inset{margin-top:0}.list-md-lines-none .item{--border-width:0;--inner-border-width:0}.list-md-lines-full .item,.list-md .item-lines-full{--border-width:0 0 1px 0}.list-md-lines-full .item{--inner-border-width:0}.list-md-lines-inset .item,.list-md .item-lines-inset{--inner-border-width:0 0 1px 0}.list-md .item-lines-inset{--border-width:0}.list-md .item-lines-full{--inner-border-width:0}.list-md .item-lines-none{--border-width:0;--inner-border-width:0}ion-card .list-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}",List=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.inset=!1}async closeSlidingItems(){const t=this.el.querySelector("ion-item-sliding");return!(!t||!t.closeOpened)&&t.closeOpened()}render(){const t=getIonMode(this),{lines:e,inset:i}=this;return h(Host,{class:{[t]:!0,["list-"+t]:!0,"list-inset":i,["list-lines-"+e]:void 0!==e,[`list-${t}-lines-${e}`]:void 0!==e}})}get el(){return this}static get style(){return{ios:listIosCss,md:listMdCss}}},listHeaderIosCss=":host{--border-style:solid;--border-width:0;--inner-border-width:0;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:40px;border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);color:var(--color);overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}.list-header-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex:1 1 auto;flex:1 1 auto}:host(.list-header-lines-inset),:host(.list-header-lines-none){--border-width:0}:host(.list-header-lines-full),:host(.list-header-lines-none){--inner-border-width:0}:host{--background:transparent;--color:var(--ion-color-step-850, #262626);--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));padding-left:calc(var(--ion-safe-area-left, 0px) + 20px);position:relative;-ms-flex-align:end;align-items:flex-end;font-size:22px;font-weight:700;letter-spacing:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;-webkit-padding-start:calc(var(--ion-safe-area-left, 0px) + 20px);padding-inline-start:calc(var(--ion-safe-area-left, 0px) + 20px)}}::slotted(ion-button),::slotted(ion-label){margin-top:29px;margin-bottom:6px}::slotted(ion-button){margin-left:3px;margin-right:3px;height:1.4em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-button){margin-left:unset;margin-right:unset;-webkit-margin-start:3px;margin-inline-start:3px;-webkit-margin-end:3px;margin-inline-end:3px}}:host(.list-header-lines-full){--border-width:0 0 0.55px 0}:host(.list-header-lines-inset){--inner-border-width:0 0 0.55px 0}",listHeaderMdCss=":host{--border-style:solid;--border-width:0;--inner-border-width:0;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:40px;border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);color:var(--color);overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}.list-header-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex:1 1 auto;flex:1 1 auto}:host(.list-header-lines-inset),:host(.list-header-lines-none){--border-width:0}:host(.list-header-lines-full),:host(.list-header-lines-none){--inner-border-width:0}:host{--background:transparent;--color:var(--ion-text-color, #000);--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));padding-left:calc(var(--ion-safe-area-left, 0) + 16px);min-height:45px;font-size:14px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;-webkit-padding-start:calc(var(--ion-safe-area-left, 0) + 16px);padding-inline-start:calc(var(--ion-safe-area-left, 0) + 16px)}}:host(.list-header-lines-full){--border-width:0 0 1px 0}:host(.list-header-lines-inset){--inner-border-width:0 0 1px 0}",ListHeader=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){const{lines:t}=this,e=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[e]:!0,["list-header-lines-"+t]:void 0!==t})},h("div",{class:"list-header-inner"},h("slot",null)))}static get style(){return{ios:listHeaderIosCss,md:listHeaderMdCss}}},iosEnterAnimation$2=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.01,transform:"scale(1.1)"},{offset:1,opacity:1,transform:"scale(1)"}]),e.addElement(t).easing("ease-in-out").duration(200).addAnimation([i,n])},iosLeaveAnimation$2=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.99,transform:"scale(1)"},{offset:1,opacity:0,transform:"scale(0.9)"}]),e.addElement(t).easing("ease-in-out").duration(200).addAnimation([i,n])},mdEnterAnimation$2=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.01,transform:"scale(1.1)"},{offset:1,opacity:1,transform:"scale(1)"}]),e.addElement(t).easing("ease-in-out").duration(200).addAnimation([i,n])},mdLeaveAnimation$2=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.99,transform:"scale(1)"},{offset:1,opacity:0,transform:"scale(0.9)"}]),e.addElement(t).easing("ease-in-out").duration(200).addAnimation([i,n])},loadingIosCss=".sc-ion-loading-ios-h{--min-width:auto;--width:auto;--min-height:auto;--height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-loading-ios-h{display:none}.loading-wrapper.sc-ion-loading-ios{display:-ms-flexbox;display:flex;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);opacity:0;z-index:10}.spinner-lines.sc-ion-loading-ios,.spinner-lines-small.sc-ion-loading-ios,.spinner-bubbles.sc-ion-loading-ios,.spinner-circles.sc-ion-loading-ios,.spinner-crescent.sc-ion-loading-ios,.spinner-dots.sc-ion-loading-ios{color:var(--spinner-color)}.sc-ion-loading-ios-h{--background:var(--ion-overlay-background-color, var(--ion-color-step-100, #f9f9f9));--max-width:270px;--max-height:90%;--spinner-color:var(--ion-color-step-600, #666666);--backdrop-opacity:var(--ion-backdrop-opacity, 0.3);color:var(--ion-text-color, #000);font-size:14px}.loading-wrapper.sc-ion-loading-ios{border-radius:8px;padding-left:34px;padding-right:34px;padding-top:24px;padding-bottom:24px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-wrapper.sc-ion-loading-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:34px;padding-inline-start:34px;-webkit-padding-end:34px;padding-inline-end:34px}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.loading-translucent.sc-ion-loading-ios-h .loading-wrapper.sc-ion-loading-ios{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}.loading-content.sc-ion-loading-ios{font-weight:bold}.loading-spinner.sc-ion-loading-ios+.loading-content.sc-ion-loading-ios{margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-spinner.sc-ion-loading-ios+.loading-content.sc-ion-loading-ios{margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}",loadingMdCss=".sc-ion-loading-md-h{--min-width:auto;--width:auto;--min-height:auto;--height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-loading-md-h{display:none}.loading-wrapper.sc-ion-loading-md{display:-ms-flexbox;display:flex;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);opacity:0;z-index:10}.spinner-lines.sc-ion-loading-md,.spinner-lines-small.sc-ion-loading-md,.spinner-bubbles.sc-ion-loading-md,.spinner-circles.sc-ion-loading-md,.spinner-crescent.sc-ion-loading-md,.spinner-dots.sc-ion-loading-md{color:var(--spinner-color)}.sc-ion-loading-md-h{--background:var(--ion-color-step-50, #f2f2f2);--max-width:280px;--max-height:90%;--spinner-color:var(--ion-color-primary, #3880ff);--backdrop-opacity:var(--ion-backdrop-opacity, 0.32);color:var(--ion-color-step-850, #262626);font-size:14px}.loading-wrapper.sc-ion-loading-md{border-radius:2px;padding-left:24px;padding-right:24px;padding-top:24px;padding-bottom:24px;-webkit-box-shadow:0 16px 20px rgba(0, 0, 0, 0.4);box-shadow:0 16px 20px rgba(0, 0, 0, 0.4)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-wrapper.sc-ion-loading-md{padding-left:unset;padding-right:unset;-webkit-padding-start:24px;padding-inline-start:24px;-webkit-padding-end:24px;padding-inline-end:24px}}.loading-spinner.sc-ion-loading-md+.loading-content.sc-ion-loading-md{margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-spinner.sc-ion-loading-md+.loading-content.sc-ion-loading-md{margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}",Loading=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.presented=!1,this.keyboardClose=!0,this.duration=0,this.backdropDismiss=!1,this.showBackdrop=!0,this.translucent=!1,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,BACKDROP)},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionLoadingDidPresent",7),this.willPresent=createEvent(this,"ionLoadingWillPresent",7),this.willDismiss=createEvent(this,"ionLoadingWillDismiss",7),this.didDismiss=createEvent(this,"ionLoadingDidDismiss",7)}componentWillLoad(){if(void 0===this.spinner){const t=getIonMode(this);this.spinner=config.get("loadingSpinner",config.get("spinner","ios"===t?"lines":"crescent"))}}async present(){await present(this,"loadingEnter",iosEnterAnimation$2,mdEnterAnimation$2,void 0),this.duration>0&&(this.durationTimeout=setTimeout(()=>this.dismiss(),this.duration+10))}dismiss(t,e){return this.durationTimeout&&clearTimeout(this.durationTimeout),dismiss(this,t,e,"loadingLeave",iosLeaveAnimation$2,mdLeaveAnimation$2)}onDidDismiss(){return eventMethod(this.el,"ionLoadingDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionLoadingWillDismiss")}render(){const{message:t,spinner:e}=this,i=getIonMode(this);return h(Host,{onIonBackdropTap:this.onBackdropTap,style:{zIndex:""+(4e4+this.overlayIndex)},class:Object.assign(Object.assign({},getClassMap(this.cssClass)),{[i]:!0,"loading-translucent":this.translucent})},h("ion-backdrop",{visible:this.showBackdrop,tappable:this.backdropDismiss}),h("div",{class:"loading-wrapper",role:"dialog"},e&&h("div",{class:"loading-spinner"},h("ion-spinner",{name:e})),t&&h("div",{class:"loading-content",innerHTML:sanitizeDOMString(t)})))}get el(){return this}static get style(){return{ios:loadingIosCss,md:loadingMdCss}}},getTimeGivenProgression=(t,e,i,n,s)=>solveCubicBezier(t[1],e[1],i[1],n[1],s).map(s=>solveCubicParametricEquation(t[0],e[0],i[0],n[0],s)),solveCubicParametricEquation=(t,e,i,n,s)=>s*(3*e*Math.pow(s-1,2)+s*(-3*i*s+3*i+n*s))-t*Math.pow(s-1,3),solveCubicBezier=(t,e,i,n,s)=>solveCubicEquation((n-=s)-3*(i-=s)+3*(e-=s)-(t-=s),3*i-6*e+3*t,3*e-3*t,t).filter(t=>t>=0&&t<=1),solveQuadraticEquation=(t,e,i)=>{const n=e*e-4*t*i;return n<0?[]:[(-e+Math.sqrt(n))/(2*t),(-e-Math.sqrt(n))/(2*t)]},solveCubicEquation=(t,e,i,n)=>{if(0===t)return solveQuadraticEquation(e,i,n);const s=(3*(i/=t)-(e/=t)*e)/3,o=(2*e*e*e-9*e*i+27*(n/=t))/27;if(0===s)return[Math.pow(-o,1/3)];if(0===o)return[Math.sqrt(-s),-Math.sqrt(-s)];const r=Math.pow(o/2,2)+Math.pow(s/3,3);if(0===r)return[Math.pow(o/2,.5)-e/3];if(r>0)return[Math.pow(-o/2+Math.sqrt(r),1/3)-Math.pow(o/2+Math.sqrt(r),1/3)-e/3];const a=Math.sqrt(Math.pow(-s/3,3)),l=Math.acos(-o/(2*Math.sqrt(Math.pow(-s/3,3)))),c=2*Math.pow(a,1/3);return[c*Math.cos(l/3)-e/3,c*Math.cos((l+2*Math.PI)/3)-e/3,c*Math.cos((l+4*Math.PI)/3)-e/3]},baseAnimation=t=>createAnimation().duration(t?400:300),menuOverlayAnimation=t=>{let e,i;const n=t.width+8,s=createAnimation(),o=createAnimation();t.isEndSide?(e=n+"px",i="0px"):(e=-n+"px",i="0px"),s.addElement(t.menuInnerEl).fromTo("transform",`translateX(${e})`,`translateX(${i})`);const r="ios"===getIonMode(t),a=r?.2:.25;return o.addElement(t.backdropEl).fromTo("opacity",.01,a),baseAnimation(r).addAnimation([s,o])},menuPushAnimation=t=>{let e,i;const n=getIonMode(t),s=t.width;t.isEndSide?(e=-s+"px",i=s+"px"):(e=s+"px",i=-s+"px");const o=createAnimation().addElement(t.menuInnerEl).fromTo("transform",`translateX(${i})`,"translateX(0px)"),r=createAnimation().addElement(t.contentEl).fromTo("transform","translateX(0px)",`translateX(${e})`),a=createAnimation().addElement(t.backdropEl).fromTo("opacity",.01,.32);return baseAnimation("ios"===n).addAnimation([o,r,a])},menuRevealAnimation=t=>{const e=getIonMode(t),i=t.width*(t.isEndSide?-1:1)+"px",n=createAnimation().addElement(t.contentEl).fromTo("transform","translateX(0px)",`translateX(${i})`);return baseAnimation("ios"===e).addAnimation(n)},createMenuController=()=>{const t=new Map,e=[],i=async t=>{if(await c(),"start"===t||"end"===t){return l(e=>e.side===t&&!e.disabled)||l(e=>e.side===t)}if(null!=t)return l(e=>e.menuId===t);return l(t=>!t.disabled)||(e.length>0?e[0].el:void 0)},n=async()=>(await c(),r()),s=(e,i)=>{t.set(e,i)},o=t=>{const i=t.side;e.filter(e=>e.side===i&&e!==t).forEach(t=>t.disabled=!0)},r=()=>l(t=>t._isOpen),a=()=>e.some(t=>t.isAnimating),l=t=>{const i=e.find(t);if(void 0!==i)return i.el},c=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(t=>t.componentOnReady()));return s("reveal",menuRevealAnimation),s("push",menuPushAnimation),s("overlay",menuOverlayAnimation),"undefined"!=typeof document&&document.addEventListener("ionBackButton",t=>{const e=r();e&&t.detail.register(MENU_BACK_BUTTON_PRIORITY,()=>e.close())}),{registerAnimation:s,get:i,getMenus:async()=>(await c(),e.map(t=>t.el)),getOpen:n,isEnabled:async t=>{const e=await i(t);return!!e&&!e.disabled},swipeGesture:async(t,e)=>{const n=await i(e);return n&&(n.swipeGesture=t),n},isAnimating:async()=>(await c(),a()),isOpen:async t=>{if(null!=t){const e=await i(t);return void 0!==e&&e.isOpen()}return void 0!==await n()},enable:async(t,e)=>{const n=await i(e);return n&&(n.disabled=!t),n},toggle:async t=>{const e=await i(t);return!!e&&e.toggle()},close:async t=>{const e=await(void 0!==t?i(t):n());return void 0!==e&&e.close()},open:async t=>{const e=await i(t);return!!e&&e.open()},_getOpenSync:r,_createAnimation:(e,i)=>{const n=t.get(e);if(!n)throw new Error("animation not registered");return n(i)},_register:t=>{e.indexOf(t)<0&&(t.disabled||o(t),e.push(t))},_unregister:t=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},_setOpen:async(t,e,i)=>{if(a())return!1;if(e){const e=await n();e&&t.el!==e&&await e.setOpen(!1,!1)}return t._setOpen(e,i)},_setActiveMenu:o}},menuController=createMenuController(),menuIosCss=":host{--width:304px;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--background:var(--ion-background-color, #fff);left:0;right:0;top:0;bottom:0;display:none;position:absolute;contain:strict}:host(.show-menu){display:block}.menu-inner{left:0;right:auto;top:0;bottom:0;-webkit-transform:translate3d(-9999px,  0,  0);transform:translate3d(-9999px,  0,  0);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:strict}[dir=rtl] .menu-inner,:host-context([dir=rtl]) .menu-inner{left:unset;right:unset;left:auto;right:0}[dir=rtl] .menu-inner,:host-context([dir=rtl]) .menu-inner{-webkit-transform:translate3d(calc(-1 * -9999px),  0,  0);transform:translate3d(calc(-1 * -9999px),  0,  0)}:host(.menu-side-start) .menu-inner{--ion-safe-area-right:0px;right:auto;left:0}:host(.menu-side-end) .menu-inner{--ion-safe-area-left:0px;right:0;left:auto;}ion-backdrop{display:none;opacity:0.01;z-index:-1}@media (max-width: 340px){.menu-inner{--width:264px}}:host(.menu-type-reveal){z-index:0}:host(.menu-type-reveal.show-menu) .menu-inner{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}:host(.menu-type-overlay){z-index:1000}:host(.menu-type-overlay) .show-backdrop{display:block;cursor:pointer}:host(.menu-pane-visible){width:var(--width);min-width:var(--min-width);max-width:var(--max-width)}:host(.menu-pane-visible) .menu-inner{left:0;right:0;width:auto;-webkit-transform:none !important;transform:none !important;-webkit-box-shadow:none !important;box-shadow:none !important}:host(.menu-pane-visible) ion-backdrop{display:hidden !important;}:host(.menu-type-push){z-index:1000}:host(.menu-type-push) .show-backdrop{display:block}",menuMdCss=":host{--width:304px;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--background:var(--ion-background-color, #fff);left:0;right:0;top:0;bottom:0;display:none;position:absolute;contain:strict}:host(.show-menu){display:block}.menu-inner{left:0;right:auto;top:0;bottom:0;-webkit-transform:translate3d(-9999px,  0,  0);transform:translate3d(-9999px,  0,  0);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:strict}[dir=rtl] .menu-inner,:host-context([dir=rtl]) .menu-inner{left:unset;right:unset;left:auto;right:0}[dir=rtl] .menu-inner,:host-context([dir=rtl]) .menu-inner{-webkit-transform:translate3d(calc(-1 * -9999px),  0,  0);transform:translate3d(calc(-1 * -9999px),  0,  0)}:host(.menu-side-start) .menu-inner{--ion-safe-area-right:0px;right:auto;left:0}:host(.menu-side-end) .menu-inner{--ion-safe-area-left:0px;right:0;left:auto;}ion-backdrop{display:none;opacity:0.01;z-index:-1}@media (max-width: 340px){.menu-inner{--width:264px}}:host(.menu-type-reveal){z-index:0}:host(.menu-type-reveal.show-menu) .menu-inner{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}:host(.menu-type-overlay){z-index:1000}:host(.menu-type-overlay) .show-backdrop{display:block;cursor:pointer}:host(.menu-pane-visible){width:var(--width);min-width:var(--min-width);max-width:var(--max-width)}:host(.menu-pane-visible) .menu-inner{left:0;right:0;width:auto;-webkit-transform:none !important;transform:none !important;-webkit-box-shadow:none !important;box-shadow:none !important}:host(.menu-pane-visible) ion-backdrop{display:hidden !important;}:host(.menu-type-overlay) .menu-inner{-webkit-box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18);box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}",iosEasing="cubic-bezier(0.32,0.72,0,1)",mdEasing="cubic-bezier(0.0,0.0,0.2,1)",iosEasingReverse="cubic-bezier(1, 0, 0.68, 0.28)",mdEasingReverse="cubic-bezier(0.4, 0, 0.6, 1)",Menu=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.lastOnEnd=0,this.blocker=GESTURE_CONTROLLER.createBlocker({disableScroll:!0}),this.isAnimating=!1,this._isOpen=!1,this.isPaneVisible=!1,this.isEndSide=!1,this.disabled=!1,this.side="start",this.swipeGesture=!0,this.maxEdgeStart=50,this.ionWillOpen=createEvent(this,"ionWillOpen",7),this.ionWillClose=createEvent(this,"ionWillClose",7),this.ionDidOpen=createEvent(this,"ionDidOpen",7),this.ionDidClose=createEvent(this,"ionDidClose",7),this.ionMenuChange=createEvent(this,"ionMenuChange",7)}typeChanged(t,e){const i=this.contentEl;i&&(void 0!==e&&i.classList.remove("menu-content-"+e),i.classList.add("menu-content-"+t),i.removeAttribute("style")),this.menuInnerEl&&this.menuInnerEl.removeAttribute("style"),this.animation=void 0}disabledChanged(){this.updateState(),this.ionMenuChange.emit({disabled:this.disabled,open:this._isOpen})}sideChanged(){this.isEndSide=isEndSide(this.side)}swipeGestureChanged(){this.updateState()}async connectedCallback(){void 0===this.type&&(this.type=config.get("menuType","overlay"));const t=this.el.parentNode;void 0===this.contentId&&console.warn('[DEPRECATED][ion-menu] Using the [main] attribute is deprecated, please use the "contentId" property instead:\nBEFORE:\n  <ion-menu>...</ion-menu>\n  <div main>...</div>\n\nAFTER:\n  <ion-menu contentId="main-content"></ion-menu>\n  <div id="main-content">...</div>\n');const e=void 0!==this.contentId?document.getElementById(this.contentId):t&&t.querySelector&&t.querySelector("[main]");e&&e.tagName?(this.contentEl=e,e.classList.add("menu-content"),this.typeChanged(this.type,void 0),this.sideChanged(),menuController._register(this),this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:document,gestureName:"menu-swipe",gesturePriority:30,threshold:10,canStart:t=>this.canStart(t),onWillStart:()=>this.onWillStart(),onStart:()=>this.onStart(),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.updateState()):console.error('Menu: must have a "content" element to listen for drag events on.')}async componentDidLoad(){this.ionMenuChange.emit({disabled:this.disabled,open:this._isOpen}),this.updateState()}disconnectedCallback(){this.blocker.destroy(),menuController._unregister(this),this.animation&&this.animation.destroy(),this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.animation=void 0,this.contentEl=this.backdropEl=this.menuInnerEl=void 0}onSplitPaneChanged(t){this.isPaneVisible=t.detail.isPane(this.el),this.updateState()}onBackdropClick(t){this._isOpen&&this.lastOnEnd<t.timeStamp-100&&t.composedPath&&!t.composedPath().includes(this.menuInnerEl)&&(t.preventDefault(),t.stopPropagation(),this.close())}isOpen(){return Promise.resolve(this._isOpen)}isActive(){return Promise.resolve(this._isActive())}open(t=!0){return this.setOpen(!0,t)}close(t=!0){return this.setOpen(!1,t)}toggle(t=!0){return this.setOpen(!this._isOpen,t)}setOpen(t,e=!0){return menuController._setOpen(this,t,e)}async _setOpen(t,e=!0){return!(!this._isActive()||this.isAnimating||t===this._isOpen||(this.beforeAnimation(t),await this.loadAnimation(),await this.startAnimation(t,e),this.afterAnimation(t),0))}async loadAnimation(){const t=this.menuInnerEl.offsetWidth;t===this.width&&void 0!==this.animation||(this.width=t,this.animation&&(this.animation.destroy(),this.animation=void 0),this.animation=await menuController._createAnimation(this.type,this),config.getBoolean("animated",!0)||this.animation.duration(0),this.animation.fill("both"))}async startAnimation(t,e){const i=!t,n=getIonMode(this),s="ios"===n?iosEasing:mdEasing,o="ios"===n?iosEasingReverse:mdEasingReverse,r=this.animation.direction(i?"reverse":"normal").easing(i?o:s).onFinish(()=>{"reverse"===r.getDirection()&&r.direction("normal")});e?await r.play():r.play({sync:!0})}_isActive(){return!this.disabled&&!this.isPaneVisible}canSwipe(){return this.swipeGesture&&!this.isAnimating&&this._isActive()}canStart(t){return!(document.querySelector("ion-modal.show-modal")||!this.canSwipe())&&(!!this._isOpen||!menuController._getOpenSync()&&checkEdgeSide(window,t.currentX,this.isEndSide,this.maxEdgeStart))}onWillStart(){return this.beforeAnimation(!this._isOpen),this.loadAnimation()}onStart(){this.isAnimating&&this.animation?this.animation.progressStart(!0,this._isOpen?1:0):assert(!1,"isAnimating has to be true")}onMove(t){if(!this.isAnimating||!this.animation)return void assert(!1,"isAnimating has to be true");const e=computeDelta(t.deltaX,this._isOpen,this.isEndSide)/this.width;this.animation.progressStep(this._isOpen?1-e:e)}onEnd(t){if(!this.isAnimating||!this.animation)return void assert(!1,"isAnimating has to be true");const e=this._isOpen,i=this.isEndSide,n=computeDelta(t.deltaX,e,i),s=this.width,o=n/s,r=t.velocityX,a=s/2,l=r>=0&&(r>.2||t.deltaX>a),c=r<=0&&(r<-.2||t.deltaX<-a),h=e?i?l:c:i?c:l;let d=!e&&h;e&&!h&&(d=!0),this.lastOnEnd=t.currentTime;let u=h?.001:-.001;u+=getTimeGivenProgression([0,0],[.4,0],[.6,1],[1,1],clamp(0,o<0?.01:o,.9999))[0]||0;const m=this._isOpen?!h:h;this.animation.easing("cubic-bezier(0.4, 0.0, 0.6, 1)").onFinish(()=>this.afterAnimation(d),{oneTimeCallback:!0}).progressEnd(m?1:0,this._isOpen?1-u:u,300)}beforeAnimation(t){assert(!this.isAnimating,"_before() should not be called while animating"),this.el.classList.add(SHOW_MENU),this.backdropEl&&this.backdropEl.classList.add(SHOW_BACKDROP),this.blocker.block(),this.isAnimating=!0,t?this.ionWillOpen.emit():this.ionWillClose.emit()}afterAnimation(t){assert(this.isAnimating,"_before() should be called while animating"),this._isOpen=t,this.isAnimating=!1,this._isOpen||this.blocker.unblock(),t?(this.contentEl&&this.contentEl.classList.add(MENU_CONTENT_OPEN),this.ionDidOpen.emit()):(this.el.classList.remove(SHOW_MENU),this.contentEl&&this.contentEl.classList.remove(MENU_CONTENT_OPEN),this.backdropEl&&this.backdropEl.classList.remove(SHOW_BACKDROP),this.animation&&this.animation.stop(),this.ionDidClose.emit())}updateState(){const t=this._isActive();this.gesture&&this.gesture.enable(t&&this.swipeGesture),!t&&this._isOpen&&this.forceClosing(),this.disabled||menuController._setActiveMenu(this),assert(!this.isAnimating,"can not be animating")}forceClosing(){assert(this._isOpen,"menu cannot be closed"),this.isAnimating=!0,this.animation.direction("reverse").play({sync:!0}),this.afterAnimation(!1)}render(){const{isEndSide:t,type:e,disabled:i,isPaneVisible:n}=this,s=getIonMode(this);return h(Host,{role:"navigation",class:{[s]:!0,["menu-type-"+e]:!0,"menu-enabled":!i,"menu-side-end":t,"menu-side-start":!t,"menu-pane-visible":n}},h("div",{class:"menu-inner",ref:t=>this.menuInnerEl=t},h("slot",null)),h("ion-backdrop",{ref:t=>this.backdropEl=t,class:"menu-backdrop",tappable:!1,stopPropagation:!1}))}get el(){return this}static get watchers(){return{type:["typeChanged"],disabled:["disabledChanged"],side:["sideChanged"],swipeGesture:["swipeGestureChanged"]}}static get style(){return{ios:menuIosCss,md:menuMdCss}}},computeDelta=(t,e,i)=>Math.max(0,e!==i?-t:t),checkEdgeSide=(t,e,i,n)=>i?e>=t.innerWidth-n:e<=n,SHOW_MENU="show-menu",SHOW_BACKDROP="show-backdrop",MENU_CONTENT_OPEN="menu-content-open",updateVisibility=async t=>{const e=await menuController.get(t);return!(!e||!(await e.isActive()))},menuButtonIosCss=':host{--background:transparent;--color-focused:currentColor;--border-radius:initial;--padding-top:0;--padding-bottom:0;color:var(--color);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;pointer-events:none}:host(.menu-button-hidden){display:none}:host(.menu-button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity, 0)}}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--background-focused:currentColor;--background-focused-opacity:.1;--border-radius:4px;--color:var(--ion-color-primary, #3880ff);--padding-start:5px;--padding-end:5px;height:32px;font-size:31px}:host(.ion-activated){opacity:0.4}@media (any-hover: hover){:host(:hover){opacity:0.6}}',menuButtonMdCss=':host{--background:transparent;--color-focused:currentColor;--border-radius:initial;--padding-top:0;--padding-bottom:0;color:var(--color);text-align:center;text-decoration:none;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;border:0;outline:none;background:var(--background);line-height:1;cursor:pointer;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}ion-icon{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;pointer-events:none}:host(.menu-button-hidden){display:none}:host(.menu-button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity, 0)}}:host(.ion-color) .button-native{color:var(--ion-color-base)}:host(.in-toolbar:not(.in-toolbar-color)){color:var(--ion-toolbar-color, var(--color))}:host{--background-focused:currentColor;--background-focused-opacity:.12;--background-hover:currentColor;--background-hover-opacity:.04;--border-radius:50%;--color:initial;--padding-start:8px;--padding-end:8px;width:48px;height:48px;font-size:24px}:host(.ion-color.ion-focused)::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}',MenuButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.visible=!1,this.disabled=!1,this.autoHide=!0,this.type="button",this.onClick=async()=>menuController.toggle(this.menu)}componentDidLoad(){this.visibilityChanged()}async visibilityChanged(){this.visible=await updateVisibility(this.menu)}render(){const{color:t,disabled:e}=this,i=getIonMode(this),n=config.get("menuIcon","ios"===i?"menu-outline":"menu-sharp"),s=this.autoHide&&!this.visible,o={type:this.type};return h(Host,{onClick:this.onClick,"aria-disabled":e?"true":null,"aria-hidden":s?"true":null,class:Object.assign(Object.assign({[i]:!0},createColorClasses(t)),{button:!0,"menu-button-hidden":s,"menu-button-disabled":e,"in-toolbar":hostContext("ion-toolbar",this.el),"in-toolbar-color":hostContext("ion-toolbar[color]",this.el),"ion-activatable":!0,"ion-focusable":!0})},h("button",Object.assign({},o,{disabled:e,class:"button-native"}),h("span",{class:"button-inner"},h("slot",null,h("ion-icon",{icon:n,mode:i,lazy:!1}))),"md"===i&&h("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:menuButtonIosCss,md:menuButtonMdCss}}},menuToggleCss=":host(.menu-toggle-hidden){display:none}",MenuToggle=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.visible=!1,this.autoHide=!0,this.onClick=()=>menuController.toggle(this.menu)}connectedCallback(){this.visibilityChanged()}async visibilityChanged(){this.visible=await updateVisibility(this.menu)}render(){const t=getIonMode(this),e=this.autoHide&&!this.visible;return h(Host,{onClick:this.onClick,"aria-hidden":e?"true":null,class:{[t]:!0,"menu-toggle-hidden":e}},h("slot",null))}static get style(){return menuToggleCss}},attachComponent=async(t,e,i,n,s)=>{if(t)return t.attachViewToDom(e,i,s,n);if("string"!=typeof i&&!(i instanceof HTMLElement))throw new Error("framework delegate is missing");const o="string"==typeof i?e.ownerDocument&&e.ownerDocument.createElement(i):i;return n&&n.forEach(t=>o.classList.add(t)),s&&Object.assign(o,s),e.appendChild(o),o.componentOnReady&&await o.componentOnReady(),o},detachComponent=(t,e)=>{if(e){if(t)return t.removeViewFromDom(e.parentElement,e);e.remove()}return Promise.resolve()},LIFECYCLE_WILL_ENTER="ionViewWillEnter",LIFECYCLE_DID_ENTER="ionViewDidEnter",LIFECYCLE_WILL_LEAVE="ionViewWillLeave",LIFECYCLE_DID_LEAVE="ionViewDidLeave",LIFECYCLE_WILL_UNLOAD="ionViewWillUnload",iosTransitionAnimation=()=>Promise.resolve().then((function(){return ios_transition})),mdTransitionAnimation=()=>Promise.resolve().then((function(){return md_transition})),transition=t=>new Promise((e,i)=>{writeTask(()=>{beforeTransition(t),runTransition(t).then(i=>{i.animation&&i.animation.destroy(),afterTransition(t),e(i)},e=>{afterTransition(t),i(e)})})}),beforeTransition=t=>{const e=t.enteringEl,i=t.leavingEl;setZIndex(e,i,t.direction),t.showGoBack?e.classList.add("can-go-back"):e.classList.remove("can-go-back"),setPageHidden(e,!1),i&&setPageHidden(i,!1)},runTransition=async t=>{const e=await getAnimationBuilder(t);return e&&Build.isBrowser?animation(e,t):noAnimation(t)},afterTransition=t=>{const e=t.leavingEl;t.enteringEl.classList.remove("ion-page-invisible"),void 0!==e&&e.classList.remove("ion-page-invisible")},getAnimationBuilder=async t=>{if(t.leavingEl&&t.animated&&0!==t.duration)return t.animationBuilder?t.animationBuilder:"ios"===t.mode?(await iosTransitionAnimation()).iosTransitionAnimation:(await mdTransitionAnimation()).mdTransitionAnimation},animation=async(t,e)=>{await waitForReady(e,!0);const i=t(e.baseEl,e);fireWillEvents(e.enteringEl,e.leavingEl);const n=await playTransition(i,e);return e.progressCallback&&e.progressCallback(void 0),n&&fireDidEvents(e.enteringEl,e.leavingEl),{hasCompleted:n,animation:i}},noAnimation=async t=>{const e=t.enteringEl,i=t.leavingEl;return await waitForReady(t,!1),fireWillEvents(e,i),fireDidEvents(e,i),{hasCompleted:!0}},waitForReady=async(t,e)=>{const i=(void 0!==t.deepWait?t.deepWait:e)?[deepReady(t.enteringEl),deepReady(t.leavingEl)]:[shallowReady(t.enteringEl),shallowReady(t.leavingEl)];await Promise.all(i),await notifyViewReady(t.viewIsReady,t.enteringEl)},notifyViewReady=async(t,e)=>{t&&await t(e)},playTransition=(t,e)=>{const i=e.progressCallback,n=new Promise(e=>{t.onFinish(t=>e(1===t))});return i?(t.progressStart(!0),i(t)):t.play(),n},fireWillEvents=(t,e)=>{lifecycle(e,LIFECYCLE_WILL_LEAVE),lifecycle(t,LIFECYCLE_WILL_ENTER)},fireDidEvents=(t,e)=>{lifecycle(t,LIFECYCLE_DID_ENTER),lifecycle(e,LIFECYCLE_DID_LEAVE)},lifecycle=(t,e)=>{if(t){const i=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.dispatchEvent(i)}},shallowReady=t=>t&&t.componentOnReady?t.componentOnReady():Promise.resolve(),deepReady=async t=>{const e=t;if(e){if(null!=e.componentOnReady&&null!=await e.componentOnReady())return;await Promise.all(Array.from(e.children).map(deepReady))}},setPageHidden=(t,e)=>{e?(t.setAttribute("aria-hidden","true"),t.classList.add("ion-page-hidden")):(t.hidden=!1,t.removeAttribute("aria-hidden"),t.classList.remove("ion-page-hidden"))},setZIndex=(t,e,i)=>{void 0!==t&&(t.style.zIndex="back"===i?"99":"101"),void 0!==e&&(e.style.zIndex="100")},getIonPageElement=t=>{if(t.classList.contains("ion-page"))return t;return t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||t},SwipeToCloseDefaults={MIN_PRESENTING_SCALE:.93},createSwipeToCloseGesture=(t,e,i)=>{const n=t.offsetHeight;let s=!1;const o=createGesture({el:t,gestureName:"modalSwipeToClose",gesturePriority:40,direction:"y",threshold:10,canStart:t=>{const e=t.event.target;return null===e||!e.closest||null===e.closest("ion-content")},onStart:()=>{e.progressStart(!0,s?1:0)},onMove:t=>{const i=t.deltaY/n;i<0||e.progressStep(i)},onEnd:t=>{const r=t.velocityY,a=t.deltaY/n;if(a<0)return;const l=(t.deltaY+1e3*r)/n>=.5;let c=l?-.001:.001;l?(e.easing("cubic-bezier(0.32, 0.72, 0, 1)"),c+=getTimeGivenProgression([0,0],[.32,.72],[0,1],[1,1],a)[0]):(e.easing("cubic-bezier(1, 0, 0.68, 0.28)"),c+=getTimeGivenProgression([0,0],[1,0],[.68,.28],[1,1],a)[0]);const h=computeDuration(l?a*n:(1-a)*n,r);s=l,o.enable(!1),e.onFinish(()=>{l||o.enable(!0)}).progressEnd(l?1:0,c,h),l&&i()}});return o},computeDuration=(t,e)=>clamp(400,t/Math.abs(1.1*e),500),iosEnterAnimation$3=(t,e)=>{const i=createAnimation().addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n=createAnimation().addElement(t.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1}).fromTo("transform","translateY(100vh)","translateY(0vh)"),s=createAnimation().addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation(n);if(e){const t=window.innerWidth<768,o="ION-MODAL"===e.tagName&&void 0!==e.presentingElement,r=createAnimation().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),a=document.body;if(t){const t=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",i=`translateY(${o?"-10px":t}) scale(${SwipeToCloseDefaults.MIN_PRESENTING_SCALE})`;r.afterStyles({transform:i}).beforeAddWrite(()=>a.style.setProperty("background-color","black")).addElement(e).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:i,borderRadius:"10px 10px 0 0"}]),s.addAnimation(r)}else if(s.addAnimation(i),o){const t=`translateY(-10px) scale(${o?SwipeToCloseDefaults.MIN_PRESENTING_SCALE:1})`;r.afterStyles({transform:t}).addElement(e.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:t}]);const i=createAnimation().afterStyles({transform:t}).addElement(e.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:t}]);s.addAnimation([r,i])}else n.fromTo("opacity","0","1")}else s.addAnimation(i);return s},iosLeaveAnimation$3=(t,e,i=500)=>{const n=createAnimation().addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),s=createAnimation().addElement(t.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1}).fromTo("transform","translateY(0vh)","translateY(100vh)"),o=createAnimation().addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(i).addAnimation(s);if(e){const t=window.innerWidth<768,i="ION-MODAL"===e.tagName&&void 0!==e.presentingElement,r=createAnimation().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(t=>{1===t&&(e.style.setProperty("overflow",""),Array.from(a.querySelectorAll("ion-modal")).filter(t=>void 0!==t.presentingElement).length<=1&&a.style.setProperty("background-color",""))}),a=document.body;if(t){const t=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",n=`translateY(${i?"-10px":t}) scale(${SwipeToCloseDefaults.MIN_PRESENTING_SCALE})`;r.addElement(e).keyframes([{offset:0,filter:"contrast(0.85)",transform:n,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),o.addAnimation(r)}else if(o.addAnimation(n),i){const t=`translateY(-10px) scale(${i?SwipeToCloseDefaults.MIN_PRESENTING_SCALE:1})`;r.addElement(e.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:t},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const n=createAnimation().addElement(e.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:t},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);o.addAnimation([r,n])}else s.fromTo("opacity","1","0")}else o.addAnimation(n);return o},mdEnterAnimation$3=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".modal-wrapper")).keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}]),e.addElement(t).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([i,n])},mdLeaveAnimation$3=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation(),s=t.querySelector(".modal-wrapper");return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(s).keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}]),e.addElement(t).easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([i,n])},modalIosCss=".sc-ion-modal-ios-h{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;contain:strict}.overlay-hidden.sc-ion-modal-ios-h{display:none}.modal-wrapper.sc-ion-modal-ios,.modal-shadow.sc-ion-modal-ios{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow.sc-ion-modal-ios{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){.sc-ion-modal-ios-h{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){.sc-ion-modal-ios-h{--width:600px;--height:600px}}.sc-ion-modal-ios-h:first-of-type{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}@media only screen and (min-width: 768px) and (min-height: 600px){.sc-ion-modal-ios-h{--border-radius:10px}}.modal-wrapper.sc-ion-modal-ios{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){.modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios{height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){.modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios{height:calc(100% - 40px)}}.modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios{border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:0;border-bottom-left-radius:0}[dir=rtl].sc-ion-modal-ios-h -no-combinator.modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios,[dir=rtl] .sc-ion-modal-ios-h -no-combinator.modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios,[dir=rtl].modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios,[dir=rtl] .modal-card.sc-ion-modal-ios-h .modal-wrapper.sc-ion-modal-ios{border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-right-radius:0;border-bottom-left-radius:0}.modal-card.sc-ion-modal-ios-h{--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}.modal-card.sc-ion-modal-ios-h .modal-shadow.sc-ion-modal-ios{display:none}.modal-card.sc-ion-modal-ios-h ion-backdrop.sc-ion-modal-ios{pointer-events:none}}@media screen and (min-width: 768px){.modal-card.sc-ion-modal-ios-h{--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px}.modal-card.sc-ion-modal-ios-h{--backdrop-opacity:0;-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}.modal-card.sc-ion-modal-ios-h:first-of-type{--backdrop-opacity:0.18}.modal-card.sc-ion-modal-ios-h .modal-shadow.sc-ion-modal-ios{-webkit-box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1)}}",modalMdCss=".sc-ion-modal-md-h{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;contain:strict}.overlay-hidden.sc-ion-modal-md-h{display:none}.modal-wrapper.sc-ion-modal-md,.modal-shadow.sc-ion-modal-md{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow.sc-ion-modal-md{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){.sc-ion-modal-md-h{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){.sc-ion-modal-md-h{--width:600px;--height:600px}}.sc-ion-modal-md-h:first-of-type{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){.sc-ion-modal-md-h{--border-radius:2px}.sc-ion-modal-md-h:first-of-type{--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper.sc-ion-modal-md{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}",Modal=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.gestureAnimationDismissing=!1,this.presented=!1,this.keyboardClose=!0,this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.swipeToClose=!1,this.onBackdropTap=()=>{this.dismiss(void 0,BACKDROP)},this.onDismiss=t=>{t.stopPropagation(),t.preventDefault(),this.dismiss()},this.onLifecycle=t=>{const e=this.usersElement,i=LIFECYCLE_MAP[t.type];if(e&&i){const n=new CustomEvent(i,{bubbles:!1,cancelable:!1,detail:t.detail});e.dispatchEvent(n)}},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionModalDidPresent",7),this.willPresent=createEvent(this,"ionModalWillPresent",7),this.willDismiss=createEvent(this,"ionModalWillDismiss",7),this.didDismiss=createEvent(this,"ionModalDidDismiss",7)}async present(){if(this.presented)return;const t=this.el.querySelector(".modal-wrapper");if(!t)throw new Error("container is undefined");const e=Object.assign(Object.assign({},this.componentProps),{modal:this.el});this.usersElement=await attachComponent(this.delegate,t,this.component,["ion-page"],e),await deepReady(this.usersElement),writeTask(()=>this.el.classList.add("show-modal")),await present(this,"modalEnter",iosEnterAnimation$3,mdEnterAnimation$3,this.presentingElement);const i=getIonMode(this);if(this.swipeToClose&&"ios"===i){const t=this.leaveAnimation||config.get("modalLeave",iosLeaveAnimation$3),e=this.animation=t(this.el,this.presentingElement);this.gesture=createSwipeToCloseGesture(this.el,e,()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{await this.dismiss(void 0,"gesture"),this.gestureAnimationDismissing=!1})}),this.gesture.enable(!0)}}async dismiss(t,e){if(this.gestureAnimationDismissing&&"gesture"!==e)return!1;const i=activeAnimations.get(this)||[],n=await dismiss(this,t,e,"modalLeave",iosLeaveAnimation$3,mdLeaveAnimation$3,this.presentingElement);return n&&(await detachComponent(this.delegate,this.usersElement),this.animation&&this.animation.destroy(),i.forEach(t=>t.destroy())),this.animation=void 0,n}onDidDismiss(){return eventMethod(this.el,"ionModalDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionModalWillDismiss")}render(){const t=getIonMode(this);return h(Host,{"no-router":!0,"aria-modal":"true",class:Object.assign({[t]:!0,"modal-card":void 0!==this.presentingElement&&"ios"===t},getClassMap(this.cssClass)),style:{zIndex:""+(2e4+this.overlayIndex)},onIonBackdropTap:this.onBackdropTap,onIonDismiss:this.onDismiss,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle},h("ion-backdrop",{visible:this.showBackdrop,tappable:this.backdropDismiss}),"ios"===t&&h("div",{class:"modal-shadow"}),h("div",{role:"dialog",class:"modal-wrapper"}))}get el(){return this}static get style(){return{ios:modalIosCss,md:modalMdCss}}},LIFECYCLE_MAP={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"},VIEW_STATE_NEW=1,VIEW_STATE_ATTACHED=2,VIEW_STATE_DESTROYED=3;class ViewController{constructor(t,e){this.component=t,this.params=e,this.state=VIEW_STATE_NEW}async init(t){if(this.state=VIEW_STATE_ATTACHED,!this.element){const e=this.component;this.element=await attachComponent(this.delegate,t,e,["ion-page","ion-page-invisible"],this.params)}}_destroy(){assert(this.state!==VIEW_STATE_DESTROYED,"view state must be ATTACHED");const t=this.element;t&&(this.delegate?this.delegate.removeViewFromDom(t.parentElement,t):t.remove()),this.nav=void 0,this.state=VIEW_STATE_DESTROYED}}const matches=(t,e,i)=>{if(!t)return!1;if(t.component!==e)return!1;const n=t.params;if(n===i)return!0;if(!n&&!i)return!0;if(!n||!i)return!1;const s=Object.keys(n),o=Object.keys(i);if(s.length!==o.length)return!1;for(const r of s)if(n[r]!==i[r])return!1;return!0},convertToView=(t,e)=>t?t instanceof ViewController?t:new ViewController(t,e):null,convertToViews=t=>t.map(t=>t instanceof ViewController?t:"page"in t?convertToView(t.page,t.params):convertToView(t,void 0)).filter(t=>null!==t),navCss=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}",Nav=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.transInstr=[],this.animationEnabled=!0,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.animated=!0,this.ionNavWillLoad=createEvent(this,"ionNavWillLoad",7),this.ionNavWillChange=createEvent(this,"ionNavWillChange",3),this.ionNavDidChange=createEvent(this,"ionNavDidChange",3)}swipeGestureChanged(){this.gesture&&this.gesture.enable(!0===this.swipeGesture)}rootChanged(){void 0!==this.root&&(this.useRouter||this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=!!document.querySelector("ion-router")&&!this.el.closest("[no-router]"),void 0===this.swipeGesture){const t=getIonMode(this);this.swipeGesture=config.getBoolean("swipeBackEnabled","ios"===t)}this.ionNavWillLoad.emit()}async componentDidLoad(){this.rootChanged(),this.gesture=(await import("./p-28cdd47a.mjs")).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}componentDidUnload(){for(const t of this.views)lifecycle(t.element,LIFECYCLE_WILL_UNLOAD),t._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=this.views.length=0,this.destroyed=!0}push(t,e,i,n){return this.queueTrns({insertStart:-1,insertViews:[{page:t,params:e}],opts:i},n)}insert(t,e,i,n,s){return this.queueTrns({insertStart:t,insertViews:[{page:e,params:i}],opts:n},s)}insertPages(t,e,i,n){return this.queueTrns({insertStart:t,insertViews:e,opts:i},n)}pop(t,e){return this.queueTrns({removeStart:-1,removeCount:1,opts:t},e)}popTo(t,e,i){const n={removeStart:-1,removeCount:-1,opts:e};return"object"==typeof t&&t.component?(n.removeView=t,n.removeStart=1):"number"==typeof t&&(n.removeStart=t+1),this.queueTrns(n,i)}popToRoot(t,e){return this.queueTrns({removeStart:1,removeCount:-1,opts:t},e)}removeIndex(t,e=1,i,n){return this.queueTrns({removeStart:t,removeCount:e,opts:i},n)}setRoot(t,e,i,n){return this.setPages([{page:t,params:e}],i,n)}setPages(t,e,i){return null==e&&(e={}),!0!==e.animated&&(e.animated=!1),this.queueTrns({insertStart:0,insertViews:t,removeStart:0,removeCount:-1,opts:e},i)}setRouteId(t,e,i){const n=this.getActiveSync();if(matches(n,t,e))return Promise.resolve({changed:!1,element:n.element});let s;const o=new Promise(t=>s=t);let r;const a={updateURL:!1,viewIsReady:t=>{let e;const i=new Promise(t=>e=t);return s({changed:!0,element:t,markVisible:async()=>{e(),await r}}),i}};if("root"===i)r=this.setRoot(t,e,a);else{const n=this.views.find(i=>matches(i,t,e));n?r=this.popTo(n,Object.assign(Object.assign({},a),{direction:"back"})):"forward"===i?r=this.push(t,e,a):"back"===i&&(r=this.setRoot(t,e,Object.assign(Object.assign({},a),{direction:"back",animated:!0})))}return o}async getRouteId(){const t=this.getActiveSync();return t?{id:t.element.tagName,params:t.params,element:t.element}:void 0}getActive(){return Promise.resolve(this.getActiveSync())}getByIndex(t){return Promise.resolve(this.views[t])}canGoBack(t){return Promise.resolve(this.canGoBackSync(t))}getPrevious(t){return Promise.resolve(this.getPreviousSync(t))}getLength(){return this.views.length}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(t=this.getActiveSync()){return!(!t||!this.getPreviousSync(t))}getPreviousSync(t=this.getActiveSync()){if(!t)return;const e=this.views,i=e.indexOf(t);return i>0?e[i-1]:void 0}queueTrns(t,e){if(this.isTransitioning&&null!=t.opts&&t.opts.skipIfBusy)return Promise.resolve(!1);const i=new Promise((e,i)=>{t.resolve=e,t.reject=i});return t.done=e,t.insertViews&&0===t.insertViews.length&&(t.insertViews=void 0),this.transInstr.push(t),this.nextTrns(),i}success(t,e){if(this.destroyed)this.fireError("nav controller was destroyed",e);else if(e.done&&e.done(t.hasCompleted,t.requiresTransition,t.enteringView,t.leavingView,t.direction),e.resolve(t.hasCompleted),!1!==e.opts.updateURL&&this.useRouter){const e=document.querySelector("ion-router");e&&e.navChanged("back"===t.direction?"back":"forward")}}failed(t,e){this.destroyed?this.fireError("nav controller was destroyed",e):(this.transInstr.length=0,this.fireError(t,e))}fireError(t,e){e.done&&e.done(!1,!1,t),e.reject&&!this.destroyed?e.reject(t):e.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const t=this.transInstr.shift();return!!t&&(this.runTransition(t),!0)}async runTransition(t){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(t);const e=this.getActiveSync(),i=this.getEnteringView(t,e);if(!e&&!i)throw new Error("no views in the stack to be removed");i&&i.state===VIEW_STATE_NEW&&await i.init(this.el),this.postViewInit(i,e,t);const n=(t.enteringRequiresTransition||t.leavingRequiresTransition)&&i!==e?await this.transition(i,e,t):{hasCompleted:!0,requiresTransition:!1};this.success(n,t),this.ionNavDidChange.emit()}catch(e){this.failed(e,t)}this.isTransitioning=!1,this.nextTrns()}prepareTI(t){const e=this.views.length;if(t.opts=t.opts||{},void 0===t.opts.delegate&&(t.opts.delegate=this.delegate),void 0!==t.removeView){assert(void 0!==t.removeStart,"removeView needs removeStart"),assert(void 0!==t.removeCount,"removeView needs removeCount");const e=this.views.indexOf(t.removeView);if(e<0)throw new Error("removeView was not found");t.removeStart+=e}void 0!==t.removeStart&&(t.removeStart<0&&(t.removeStart=e-1),t.removeCount<0&&(t.removeCount=e-t.removeStart),t.leavingRequiresTransition=t.removeCount>0&&t.removeStart+t.removeCount===e),t.insertViews&&((t.insertStart<0||t.insertStart>e)&&(t.insertStart=e),t.enteringRequiresTransition=t.insertStart===e);const i=t.insertViews;if(!i)return;assert(i.length>0,"length can not be zero");const n=convertToViews(i);if(0===n.length)throw new Error("invalid views to insert");for(const s of n){s.delegate=t.opts.delegate;const e=s.nav;if(e&&e!==this)throw new Error("inserted view was already inserted");if(s.state===VIEW_STATE_DESTROYED)throw new Error("inserted view was already destroyed")}t.insertViews=n}getEnteringView(t,e){const i=t.insertViews;if(void 0!==i)return i[i.length-1];const n=t.removeStart;if(void 0!==n){const i=this.views,s=n+t.removeCount;for(let t=i.length-1;t>=0;t--){const o=i[t];if((t<n||t>=s)&&o!==e)return o}}}postViewInit(t,e,i){assert(e||t,"Both leavingView and enteringView are null"),assert(i.resolve,"resolve must be valid"),assert(i.reject,"reject must be valid");const n=i.opts,s=i.insertViews,o=i.removeStart,r=i.removeCount;let a;if(void 0!==o&&void 0!==r){assert(o>=0,"removeStart can not be negative"),assert(r>=0,"removeCount can not be negative"),a=[];for(let i=0;i<r;i++){const n=this.views[i+o];n&&n!==t&&n!==e&&a.push(n)}n.direction=n.direction||"back"}const l=this.views.length+(void 0!==s?s.length:0)-(void 0!==r?r:0);if(assert(l>=0,"final balance can not be negative"),0===l)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(s){let t=i.insertStart;for(const e of s)this.insertViewAt(e,t),t++;i.enteringRequiresTransition&&(n.direction=n.direction||"forward")}if(a&&a.length>0){for(const t of a)lifecycle(t.element,LIFECYCLE_WILL_LEAVE),lifecycle(t.element,LIFECYCLE_DID_LEAVE),lifecycle(t.element,LIFECYCLE_WILL_UNLOAD);for(const t of a)this.destroyView(t)}}async transition(t,e,i){const n=i.opts,s=n.progressAnimation?t=>this.sbAni=t:void 0,o=getIonMode(this),r=t.element,a=e&&e.element,l=Object.assign({mode:o,showGoBack:this.canGoBackSync(t),baseEl:this.el,animationBuilder:this.animation||n.animationBuilder||config.get("navAnimation"),progressCallback:s,animated:this.animated&&config.getBoolean("animated",!0),enteringEl:r,leavingEl:a},n),{hasCompleted:c}=await transition(l);return this.transitionFinish(c,t,e,n)}transitionFinish(t,e,i,n){const s=t?e:i;return s&&this.cleanup(s),{hasCompleted:t,requiresTransition:!0,enteringView:e,leavingView:i,direction:n.direction}}insertViewAt(t,e){const i=this.views,n=i.indexOf(t);n>-1?(assert(t.nav===this,"view is not part of the nav"),i.splice(e,0,i.splice(n,1)[0])):(assert(!t.nav,"nav is used"),t.nav=this,i.splice(e,0,t))}removeView(t){assert(t.state===VIEW_STATE_ATTACHED||t.state===VIEW_STATE_DESTROYED,"view state should be loaded or destroyed");const e=this.views,i=e.indexOf(t);assert(i>-1,"view must be part of the stack"),i>=0&&e.splice(i,1)}destroyView(t){t._destroy(),this.removeView(t)}cleanup(t){if(this.destroyed)return;const e=this.views,i=e.indexOf(t);for(let n=e.length-1;n>=0;n--){const t=e[n],s=t.element;n>i?(lifecycle(s,LIFECYCLE_WILL_UNLOAD),this.destroyView(t)):n<i&&setPageHidden(s,!0)}}canStart(){return!!this.swipeGesture&&!this.isTransitioning&&0===this.transInstr.length&&this.animationEnabled&&this.canGoBackSync()}onStart(){this.queueTrns({removeStart:-1,removeCount:1,opts:{direction:"back",progressAnimation:!0}},void 0)}onMove(t){this.sbAni&&this.sbAni.progressStep(t)}onEnd(t,e,i){if(this.sbAni){this.animationEnabled=!1,this.sbAni.onFinish(()=>{this.animationEnabled=!0},{oneTimeCallback:!0});let n=t?-.001:.001;t?n+=getTimeGivenProgression([0,0],[.32,.72],[0,1],[1,1],e)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),n+=getTimeGivenProgression([0,0],[1,0],[.68,.28],[1,1],e)[0]),this.sbAni.progressEnd(t?1:0,n,i)}}render(){return h("slot",null)}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return navCss}},navLink=(t,e,i,n)=>{const s=t.closest("ion-nav");if(s)if("forward"===e){if(void 0!==i)return s.push(i,n,{skipIfBusy:!0})}else if("root"===e){if(void 0!==i)return s.setRoot(i,n,{skipIfBusy:!0})}else if("back"===e)return s.pop({skipIfBusy:!0});return Promise.resolve(!1)},NavLink=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.routerDirection="forward",this.onClick=()=>navLink(this.el,this.routerDirection,this.component,this.componentProps)}render(){return h(Host,{onClick:this.onClick})}get el(){return this}},noteIosCss=":host{color:var(--color);font-family:var(--ion-font-family, inherit);-webkit-box-sizing:border-box;box-sizing:border-box}:host(.ion-color){color:var(--ion-color-base)}:host{--color:var(--ion-color-step-350, #a6a6a6)}",noteMdCss=":host{color:var(--color);font-family:var(--ion-font-family, inherit);-webkit-box-sizing:border-box;box-sizing:border-box}:host(.ion-color){color:var(--ion-color-base)}:host{--color:var(--ion-color-step-600, #666666);font-size:14px}",Note=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0})},h("slot",null))}static get style(){return{ios:noteIosCss,md:noteMdCss}}},iosEnterAnimation$4=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),n.addElement(t.querySelector(".picker-wrapper")).fromTo("transform","translateY(100%)","translateY(0%)"),e.addElement(t).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([i,n])},iosLeaveAnimation$4=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",.01),n.addElement(t.querySelector(".picker-wrapper")).fromTo("transform","translateY(0%)","translateY(100%)"),e.addElement(t).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([i,n])},pickerIosCss=".sc-ion-picker-ios-h{--border-radius:0;--border-style:solid;--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--max-height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;top:0;display:block;position:absolute;width:100%;height:100%;font-family:var(--ion-font-family, inherit);contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}[dir=rtl].sc-ion-picker-ios-h,[dir=rtl] .sc-ion-picker-ios-h{left:unset;right:unset;right:0}.overlay-hidden.sc-ion-picker-ios-h{display:none}.picker-wrapper.sc-ion-picker-ios{border-radius:var(--border-radius);left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;overflow:hidden;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-wrapper.sc-ion-picker-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.picker-toolbar.sc-ion-picker-ios{width:100%;background:transparent;contain:strict;z-index:1}.picker-button.sc-ion-picker-ios{border:0;font-family:inherit}.picker-button.sc-ion-picker-ios:active,.picker-button.sc-ion-picker-ios:focus{outline:none}.picker-columns.sc-ion-picker-ios{display:-ms-flexbox;display:flex;position:relative;-ms-flex-pack:center;justify-content:center;margin-bottom:var(--ion-safe-area-bottom, 0);contain:strict;direction:ltr;overflow:hidden}.picker-above-highlight.sc-ion-picker-ios,.picker-below-highlight.sc-ion-picker-ios{display:none;pointer-events:none}.sc-ion-picker-ios-h{--background:var(--ion-background-color, #fff);--border-width:1px 0 0;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));--height:260px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.26);color:var(--ion-item-color, var(--ion-text-color, #000))}.picker-toolbar.sc-ion-picker-ios{display:-ms-flexbox;display:flex;height:44px;border-bottom:0.55px solid var(--border-color)}.picker-toolbar-button.sc-ion-picker-ios{-ms-flex:1;flex:1;text-align:end}.picker-toolbar-button.sc-ion-picker-ios:last-child .picker-button.sc-ion-picker-ios{font-weight:600}.picker-toolbar-button.sc-ion-picker-ios:first-child{font-weight:normal;text-align:start}.picker-button.sc-ion-picker-ios,.picker-button.ion-activated.sc-ion-picker-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:1em;padding-right:1em;padding-top:0;padding-bottom:0;height:44px;background:transparent;color:var(--ion-color-primary, #3880ff);font-size:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-button.sc-ion-picker-ios,.picker-button.ion-activated.sc-ion-picker-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:1em;padding-inline-start:1em;-webkit-padding-end:1em;padding-inline-end:1em}}.picker-columns.sc-ion-picker-ios{height:215px;-webkit-perspective:1000px;perspective:1000px}.picker-above-highlight.sc-ion-picker-ios{left:0;top:0;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);display:block;position:absolute;width:100%;height:81px;border-bottom:1px solid var(--border-color);background:-webkit-gradient(linear, left top, left bottom, color-stop(20%, var(--background, var(--ion-background-color, #fff))), to(rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8)));background:linear-gradient(to bottom, var(--background, var(--ion-background-color, #fff)) 20%, rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8) 100%);z-index:10}[dir=rtl].sc-ion-picker-ios .picker-above-highlight.sc-ion-picker-ios,[dir=rtl].sc-ion-picker-ios-h .picker-above-highlight.sc-ion-picker-ios,[dir=rtl] .sc-ion-picker-ios-h .picker-above-highlight.sc-ion-picker-ios{left:unset;right:unset;right:0}.picker-below-highlight.sc-ion-picker-ios{left:0;top:115px;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);display:block;position:absolute;width:100%;height:119px;border-top:1px solid var(--border-color);background:-webkit-gradient(linear, left bottom, left top, color-stop(30%, var(--background, var(--ion-background-color, #fff))), to(rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8)));background:linear-gradient(to top, var(--background, var(--ion-background-color, #fff)) 30%, rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8) 100%);z-index:11}[dir=rtl].sc-ion-picker-ios .picker-below-highlight.sc-ion-picker-ios,[dir=rtl].sc-ion-picker-ios-h .picker-below-highlight.sc-ion-picker-ios,[dir=rtl] .sc-ion-picker-ios-h .picker-below-highlight.sc-ion-picker-ios{left:unset;right:unset;right:0}",pickerMdCss=".sc-ion-picker-md-h{--border-radius:0;--border-style:solid;--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--max-height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;top:0;display:block;position:absolute;width:100%;height:100%;font-family:var(--ion-font-family, inherit);contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}[dir=rtl].sc-ion-picker-md-h,[dir=rtl] .sc-ion-picker-md-h{left:unset;right:unset;right:0}.overlay-hidden.sc-ion-picker-md-h{display:none}.picker-wrapper.sc-ion-picker-md{border-radius:var(--border-radius);left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;overflow:hidden;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-wrapper.sc-ion-picker-md{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.picker-toolbar.sc-ion-picker-md{width:100%;background:transparent;contain:strict;z-index:1}.picker-button.sc-ion-picker-md{border:0;font-family:inherit}.picker-button.sc-ion-picker-md:active,.picker-button.sc-ion-picker-md:focus{outline:none}.picker-columns.sc-ion-picker-md{display:-ms-flexbox;display:flex;position:relative;-ms-flex-pack:center;justify-content:center;margin-bottom:var(--ion-safe-area-bottom, 0);contain:strict;direction:ltr;overflow:hidden}.picker-above-highlight.sc-ion-picker-md,.picker-below-highlight.sc-ion-picker-md{display:none;pointer-events:none}.sc-ion-picker-md-h{--background:var(--ion-background-color, #fff);--border-width:0.55px 0 0;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--height:260px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.26);color:var(--ion-item-color, var(--ion-text-color, #000))}.picker-toolbar.sc-ion-picker-md{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;height:44px}.picker-button.sc-ion-picker-md,.picker-button.ion-activated.sc-ion-picker-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:1.1em;padding-right:1.1em;padding-top:0;padding-bottom:0;height:44px;background:transparent;color:var(--ion-color-primary, #3880ff);font-size:14px;font-weight:500;text-transform:uppercase;-webkit-box-shadow:none;box-shadow:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-button.sc-ion-picker-md,.picker-button.ion-activated.sc-ion-picker-md{padding-left:unset;padding-right:unset;-webkit-padding-start:1.1em;padding-inline-start:1.1em;-webkit-padding-end:1.1em;padding-inline-end:1.1em}}.picker-columns.sc-ion-picker-md{height:216px;-webkit-perspective:1800px;perspective:1800px}.picker-above-highlight.sc-ion-picker-md{left:0;top:0;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);position:absolute;width:100%;height:81px;border-bottom:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));background:-webkit-gradient(linear, left top, left bottom, color-stop(20%, var(--ion-background-color, #fff)), to(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)));background:linear-gradient(to bottom, var(--ion-background-color, #fff) 20%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 100%);z-index:10}[dir=rtl].sc-ion-picker-md .picker-above-highlight.sc-ion-picker-md,[dir=rtl].sc-ion-picker-md-h .picker-above-highlight.sc-ion-picker-md,[dir=rtl] .sc-ion-picker-md-h .picker-above-highlight.sc-ion-picker-md{left:unset;right:unset;right:0}.picker-below-highlight.sc-ion-picker-md{left:0;top:115px;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);position:absolute;width:100%;height:119px;border-top:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));background:-webkit-gradient(linear, left bottom, left top, color-stop(30%, var(--ion-background-color, #fff)), to(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)));background:linear-gradient(to top, var(--ion-background-color, #fff) 30%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 100%);z-index:11}[dir=rtl].sc-ion-picker-md .picker-below-highlight.sc-ion-picker-md,[dir=rtl].sc-ion-picker-md-h .picker-below-highlight.sc-ion-picker-md,[dir=rtl] .sc-ion-picker-md-h .picker-below-highlight.sc-ion-picker-md{left:unset;right:unset;right:0}",Picker=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.presented=!1,this.keyboardClose=!0,this.buttons=[],this.columns=[],this.duration=0,this.showBackdrop=!0,this.backdropDismiss=!0,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,BACKDROP)},this.dispatchCancelHandler=t=>{if(isCancel(t.detail.role)){const t=this.buttons.find(t=>"cancel"===t.role);this.callButtonHandler(t)}},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionPickerDidPresent",7),this.willPresent=createEvent(this,"ionPickerWillPresent",7),this.willDismiss=createEvent(this,"ionPickerWillDismiss",7),this.didDismiss=createEvent(this,"ionPickerDidDismiss",7)}async present(){await present(this,"pickerEnter",iosEnterAnimation$4,iosEnterAnimation$4,void 0),this.duration>0&&(this.durationTimeout=setTimeout(()=>this.dismiss(),this.duration))}dismiss(t,e){return this.durationTimeout&&clearTimeout(this.durationTimeout),dismiss(this,t,e,"pickerLeave",iosLeaveAnimation$4,iosLeaveAnimation$4)}onDidDismiss(){return eventMethod(this.el,"ionPickerDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionPickerWillDismiss")}getColumn(t){return Promise.resolve(this.columns.find(e=>e.name===t))}async buttonClick(t){const e=t.role;return isCancel(e)?this.dismiss(void 0,e):await this.callButtonHandler(t)?this.dismiss(this.getSelected(),t.role):Promise.resolve()}async callButtonHandler(t){return!t||!1!==await safeCall$1(t.handler,this.getSelected())}getSelected(){const t={};return this.columns.forEach((e,i)=>{const n=void 0!==e.selectedIndex?e.options[e.selectedIndex]:void 0;t[e.name]={text:n?n.text:void 0,value:n?n.value:void 0,columnIndex:i}}),t}render(){const t=getIonMode(this);return h(Host,{"aria-modal":"true",class:Object.assign({[t]:!0,["picker-"+t]:!0},getClassMap(this.cssClass)),style:{zIndex:""+(2e4+this.overlayIndex)},onIonBackdropTap:this.onBackdropTap,onIonPickerWillDismiss:this.dispatchCancelHandler},h("ion-backdrop",{visible:this.showBackdrop,tappable:this.backdropDismiss}),h("div",{class:"picker-wrapper",role:"dialog"},h("div",{class:"picker-toolbar"},this.buttons.map(t=>h("div",{class:buttonWrapperClass(t)},h("button",{type:"button",onClick:()=>this.buttonClick(t),class:buttonClass$2(t)},t.text)))),h("div",{class:"picker-columns"},h("div",{class:"picker-above-highlight"}),this.presented&&this.columns.map(t=>h("ion-picker-column",{col:t})),h("div",{class:"picker-below-highlight"}))))}get el(){return this}static get style(){return{ios:pickerIosCss,md:pickerMdCss}}},buttonWrapperClass=t=>({["picker-toolbar-"+t.role]:void 0!==t.role,"picker-toolbar-button":!0}),buttonClass$2=t=>Object.assign({"picker-button":!0,"ion-activatable":!0},getClassMap(t.cssClass)),hapticSelection=()=>{const t=window.TapticEngine;t&&t.selection()},hapticSelectionStart=()=>{const t=window.TapticEngine;t&&t.gestureSelectionStart()},hapticSelectionChanged=()=>{const t=window.TapticEngine;t&&t.gestureSelectionChanged()},hapticSelectionEnd=()=>{const t=window.TapticEngine;t&&t.gestureSelectionEnd()},pickerColumnIosCss=".picker-col{display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-box-sizing:content-box;box-sizing:content-box;contain:content}.picker-opts{position:relative;-ms-flex:1;flex:1;max-width:100%}.picker-opt{left:0;top:0;display:block;position:absolute;width:100%;border:0;text-align:center;text-overflow:ellipsis;white-space:nowrap;contain:strict;overflow:hidden;will-change:transform}[dir=rtl] .picker-opt,:host-context([dir=rtl]) .picker-opt{left:unset;right:unset;right:0}.picker-opt.picker-opt-disabled{pointer-events:none}.picker-opt-disabled{opacity:0}.picker-opts-left{-ms-flex-pack:start;justify-content:flex-start}.picker-opts-right{-ms-flex-pack:end;justify-content:flex-end}.picker-opt:active,.picker-opt:focus{outline:none}.picker-prefix{position:relative;-ms-flex:1;flex:1;text-align:end;white-space:nowrap}.picker-suffix{position:relative;-ms-flex:1;flex:1;text-align:start;white-space:nowrap}.picker-col{padding-left:4px;padding-right:4px;padding-top:0;padding-bottom:0;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-col{padding-left:unset;padding-right:unset;-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px}}.picker-prefix,.picker-suffix,.picker-opts{top:77px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;color:inherit;font-size:20px;line-height:42px;pointer-events:none}.picker-opt{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-transform-origin:center center;transform-origin:center center;height:46px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;background:transparent;color:inherit;font-size:20px;line-height:42px;-webkit-backface-visibility:hidden;backface-visibility:hidden;pointer-events:auto}[dir=rtl] .picker-opt,:host-context([dir=rtl]) .picker-opt{-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}",pickerColumnMdCss=".picker-col{display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-box-sizing:content-box;box-sizing:content-box;contain:content}.picker-opts{position:relative;-ms-flex:1;flex:1;max-width:100%}.picker-opt{left:0;top:0;display:block;position:absolute;width:100%;border:0;text-align:center;text-overflow:ellipsis;white-space:nowrap;contain:strict;overflow:hidden;will-change:transform}[dir=rtl] .picker-opt,:host-context([dir=rtl]) .picker-opt{left:unset;right:unset;right:0}.picker-opt.picker-opt-disabled{pointer-events:none}.picker-opt-disabled{opacity:0}.picker-opts-left{-ms-flex-pack:start;justify-content:flex-start}.picker-opts-right{-ms-flex-pack:end;justify-content:flex-end}.picker-opt:active,.picker-opt:focus{outline:none}.picker-prefix{position:relative;-ms-flex:1;flex:1;text-align:end;white-space:nowrap}.picker-suffix{position:relative;-ms-flex:1;flex:1;text-align:start;white-space:nowrap}.picker-col{padding-left:8px;padding-right:8px;padding-top:0;padding-bottom:0;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-col{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.picker-prefix,.picker-suffix,.picker-opts{top:77px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;color:inherit;font-size:22px;line-height:42px;pointer-events:none}.picker-opt{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;height:43px;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;background:transparent;color:inherit;font-size:22px;line-height:42px;-webkit-backface-visibility:hidden;backface-visibility:hidden;pointer-events:auto}.picker-prefix,.picker-suffix,.picker-opt.picker-opt-selected{color:var(--ion-color-primary, #3880ff)}",PickerColumnCmp=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.optHeight=0,this.rotateFactor=0,this.scaleFactor=1,this.velocity=0,this.y=0,this.noAnimate=!0,this.ionPickerColChange=createEvent(this,"ionPickerColChange",7)}colChanged(){this.refresh()}async connectedCallback(){let t=0,e=.81;"ios"===getIonMode(this)&&(t=-.46,e=1),this.rotateFactor=t,this.scaleFactor=e,this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.el,gestureName:"picker-swipe",gesturePriority:100,threshold:0,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gesture.enable(),this.tmrId=setTimeout(()=>{this.noAnimate=!1,this.refresh(!0)},250)}componentDidLoad(){const t=this.optsEl;t&&(this.optHeight=t.firstElementChild?t.firstElementChild.clientHeight:0),this.refresh()}disconnectedCallback(){cancelAnimationFrame(this.rafId),clearTimeout(this.tmrId),this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}emitColChange(){this.ionPickerColChange.emit(this.col)}setSelected(t,e){const i=t>-1?-t*this.optHeight:0;this.velocity=0,cancelAnimationFrame(this.rafId),this.update(i,e,!0),this.emitColChange()}update(t,e,i){if(!this.optsEl)return;let n=0,s=0;const{col:o,rotateFactor:r}=this,a=o.selectedIndex=this.indexForY(-t),l=0===e?"":e+"ms",c=`scale(${this.scaleFactor})`,h=this.optsEl.children;for(let d=0;d<h.length;d++){const i=h[d],u=o.options[d],m=d*this.optHeight+t;let p="";if(0!==r){const t=m*r;Math.abs(t)<=90?(n=0,s=90,p=`rotateX(${t}deg) `):n=-9999}else s=0,n=m;const b=a===d;p+=`translate3d(0px,${n}px,${s}px) `,1===this.scaleFactor||b||(p+=c),this.noAnimate?(u.duration=0,i.style.transitionDuration=""):e!==u.duration&&(u.duration=e,i.style.transitionDuration=l),p!==u.transform&&(u.transform=p,i.style.transform=p),b!==u.selected&&(u.selected=b,b?i.classList.add(PICKER_OPT_SELECTED):i.classList.remove(PICKER_OPT_SELECTED))}this.col.prevSelected=a,i&&(this.y=t),this.lastIndex!==a&&(hapticSelectionChanged(),this.lastIndex=a)}decelerate(){if(0!==this.velocity){this.velocity*=DECELERATION_FRICTION,this.velocity=this.velocity>0?Math.max(this.velocity,1):Math.min(this.velocity,-1);let t=this.y+this.velocity;t>this.minY?(t=this.minY,this.velocity=0):t<this.maxY&&(t=this.maxY,this.velocity=0),this.update(t,0,!0),Math.round(t)%this.optHeight!=0||Math.abs(this.velocity)>1?this.rafId=requestAnimationFrame(()=>this.decelerate()):(this.velocity=0,this.emitColChange())}else if(this.y%this.optHeight!=0){const t=Math.abs(this.y%this.optHeight);this.velocity=t>this.optHeight/2?1:-1,this.decelerate()}}indexForY(t){return Math.min(Math.max(Math.abs(Math.round(t/this.optHeight)),0),this.col.options.length-1)}onStart(t){t.event.preventDefault(),t.event.stopPropagation(),cancelAnimationFrame(this.rafId);const e=this.col.options;let i=e.length-1,n=0;for(let s=0;s<e.length;s++)e[s].disabled||(i=Math.min(i,s),n=Math.max(n,s));this.minY=-i*this.optHeight,this.maxY=-n*this.optHeight}onMove(t){t.event.preventDefault(),t.event.stopPropagation();let e=this.y+t.deltaY;e>this.minY?(e=Math.pow(e,.8),this.bounceFrom=e):e<this.maxY?(e+=Math.pow(this.maxY-e,.9),this.bounceFrom=e):this.bounceFrom=0,this.update(e,0,!1)}onEnd(t){if(this.bounceFrom>0)return this.update(this.minY,100,!0),void this.emitColChange();if(this.bounceFrom<0)return this.update(this.maxY,100,!0),void this.emitColChange();if(this.velocity=clamp(-MAX_PICKER_SPEED,23*t.velocityY,MAX_PICKER_SPEED),0===this.velocity&&0===t.deltaY){const e=t.event.target.closest(".picker-opt");e&&e.hasAttribute("opt-index")&&this.setSelected(parseInt(e.getAttribute("opt-index"),10),TRANSITION_DURATION)}else{if(this.y+=t.deltaY,Math.abs(t.velocityY)<.05){const e=t.deltaY>0,i=Math.abs(this.y)%this.optHeight/this.optHeight;e&&i>.5?this.velocity=-1*Math.abs(this.velocity):!e&&i<=.5&&(this.velocity=Math.abs(this.velocity))}this.decelerate()}}refresh(t){let e=this.col.options.length-1,i=0;const n=this.col.options;for(let o=0;o<n.length;o++)n[o].disabled||(e=Math.min(e,o),i=Math.max(i,o));if(0!==this.velocity)return;const s=clamp(e,this.col.selectedIndex||0,i);if(this.col.prevSelected!==s||t){const t=s*this.optHeight*-1;this.velocity=0,this.update(t,TRANSITION_DURATION,!0)}}render(){const t=this.col,e=getIonMode(this);return h(Host,{class:{[e]:!0,"picker-col":!0,"picker-opts-left":"left"===this.col.align,"picker-opts-right":"right"===this.col.align},style:{"max-width":this.col.columnWidth}},t.prefix&&h("div",{class:"picker-prefix",style:{width:t.prefixWidth}},t.prefix),h("div",{class:"picker-opts",style:{maxWidth:t.optionsWidth},ref:t=>this.optsEl=t},t.options.map((t,e)=>h("button",{type:"button",class:{"picker-opt":!0,"picker-opt-disabled":!!t.disabled},"opt-index":e},t.text))),t.suffix&&h("div",{class:"picker-suffix",style:{width:t.suffixWidth}},t.suffix))}get el(){return this}static get watchers(){return{col:["colChanged"]}}static get style(){return{ios:pickerColumnIosCss,md:pickerColumnMdCss}}},PICKER_OPT_SELECTED="picker-opt-selected",DECELERATION_FRICTION=.97,MAX_PICKER_SPEED=90,TRANSITION_DURATION=150,iosEnterAnimation$5=(t,e)=>{let i="top",n="left";const s=t.querySelector(".popover-content"),o=s.getBoundingClientRect(),r=o.width,a=o.height,l=t.ownerDocument.defaultView.innerWidth,c=t.ownerDocument.defaultView.innerHeight,h=e&&e.target&&e.target.getBoundingClientRect(),d=null!=h&&"top"in h?h.top:c/2-a/2,u=null!=h&&"left"in h?h.left:l/2,m=h&&h.width||0,p=h&&h.height||0,b=t.querySelector(".popover-arrow"),f=b.getBoundingClientRect(),g=f.width,y=f.height;null==h&&(b.style.display="none");const v={top:d+p,left:u+m/2-g/2},Z={top:d+p+(y-1),left:u+m/2-r/2};let x=!1,G=!1;Z.left<POPOVER_IOS_BODY_PADDING+25?(x=!0,Z.left=POPOVER_IOS_BODY_PADDING):r+POPOVER_IOS_BODY_PADDING+Z.left+25>l&&(G=!0,Z.left=l-r-POPOVER_IOS_BODY_PADDING,n="right"),d+p+a>c&&d-a>0?(v.top=d-(y+1),Z.top=d-a-(y-1),t.className=t.className+" popover-bottom",i="bottom"):d+p+a>c&&(s.style.bottom=POPOVER_IOS_BODY_PADDING+"%"),b.style.top=v.top+"px",b.style.left=v.left+"px",s.style.top=Z.top+"px",s.style.left=Z.left+"px",x&&(s.style.left=`calc(${Z.left}px + var(--ion-safe-area-left, 0px))`),G&&(s.style.left=`calc(${Z.left}px - var(--ion-safe-area-right, 0px))`),s.style.transformOrigin=i+" "+n;const X=createAnimation(),w=createAnimation(),V=createAnimation();return w.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),V.addElement(t.querySelector(".popover-wrapper")).fromTo("opacity",.01,1),X.addElement(t).easing("ease").duration(100).addAnimation([w,V])},POPOVER_IOS_BODY_PADDING=5,iosLeaveAnimation$5=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".popover-wrapper")).fromTo("opacity",.99,0),e.addElement(t).easing("ease").duration(500).addAnimation([i,n])},mdEnterAnimation$4=(t,e)=>{const i=t.ownerDocument,n="rtl"===i.dir;let s="top",o=n?"right":"left";const r=t.querySelector(".popover-content"),a=r.getBoundingClientRect(),l=a.width,c=a.height,h=i.defaultView.innerWidth,d=i.defaultView.innerHeight,u=e&&e.target&&e.target.getBoundingClientRect(),m=null!=u&&"bottom"in u?u.bottom:d/2-c/2,p=u&&u.height||0,b={top:m,left:null!=u&&"left"in u?n?u.left-l+u.width:u.left:h/2-l/2};b.left<12?(b.left=12,o="left"):l+12+b.left>h&&(b.left=h-l-12,o="right"),m+p+c>d&&m-c>0?(b.top=m-c-p,t.className=t.className+" popover-bottom",s="bottom"):m+p+c>d&&(r.style.bottom="12px");const f=createAnimation(),g=createAnimation(),y=createAnimation(),v=createAnimation(),Z=createAnimation();return g.addElement(t.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),y.addElement(t.querySelector(".popover-wrapper")).fromTo("opacity",.01,1),v.addElement(r).beforeStyles({top:b.top+"px",left:b.left+"px","transform-origin":`${s} ${o}`}).fromTo("transform","scale(0.001)","scale(1)"),Z.addElement(t.querySelector(".popover-viewport")).fromTo("opacity",.01,1),f.addElement(t).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(300).addAnimation([g,y,v,Z])},mdLeaveAnimation$4=t=>{const e=createAnimation(),i=createAnimation(),n=createAnimation();return i.addElement(t.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),n.addElement(t.querySelector(".popover-wrapper")).fromTo("opacity",.99,0),e.addElement(t).easing("ease").duration(500).addAnimation([i,n])},popoverIosCss='.sc-ion-popover-ios-h{--background:var(--ion-background-color, #fff);--min-width:0;--min-height:0;--max-width:auto;--height:auto;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;color:var(--ion-text-color, #000);z-index:1001}.overlay-hidden.sc-ion-popover-ios-h{display:none}.popover-wrapper.sc-ion-popover-ios{opacity:0;z-index:10}.popover-content.sc-ion-popover-ios{display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:auto;z-index:10}.popover-viewport.sc-ion-popover-ios{--ion-safe-area-top:0px;--ion-safe-area-right:0px;--ion-safe-area-bottom:0px;--ion-safe-area-left:0px}.sc-ion-popover-ios-h{--width:200px;--max-height:90%;--box-shadow:none;--backdrop-opacity:var(--ion-backdrop-opacity, 0.08)}.popover-content.sc-ion-popover-ios{border-radius:10px}.popover-arrow.sc-ion-popover-ios{display:block;position:absolute;width:20px;height:10px;overflow:hidden}.popover-arrow.sc-ion-popover-ios::after{left:3px;top:3px;border-radius:3px;position:absolute;width:14px;height:14px;-webkit-transform:rotate(45deg);transform:rotate(45deg);background:var(--background);content:"";z-index:10}[dir=rtl].sc-ion-popover-ios .popover-arrow.sc-ion-popover-ios::after,[dir=rtl].sc-ion-popover-ios-h .popover-arrow.sc-ion-popover-ios::after,[dir=rtl] .sc-ion-popover-ios-h .popover-arrow.sc-ion-popover-ios::after{left:unset;right:unset;right:3px}.popover-bottom.sc-ion-popover-ios-h .popover-arrow.sc-ion-popover-ios{top:auto;bottom:-10px}.popover-bottom.sc-ion-popover-ios-h .popover-arrow.sc-ion-popover-ios::after{top:-6px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.popover-translucent.sc-ion-popover-ios-h .popover-content.sc-ion-popover-ios,.popover-translucent.sc-ion-popover-ios-h .popover-arrow.sc-ion-popover-ios::after{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}',popoverMdCss=".sc-ion-popover-md-h{--background:var(--ion-background-color, #fff);--min-width:0;--min-height:0;--max-width:auto;--height:auto;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;color:var(--ion-text-color, #000);z-index:1001}.overlay-hidden.sc-ion-popover-md-h{display:none}.popover-wrapper.sc-ion-popover-md{opacity:0;z-index:10}.popover-content.sc-ion-popover-md{display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:auto;z-index:10}.popover-viewport.sc-ion-popover-md{--ion-safe-area-top:0px;--ion-safe-area-right:0px;--ion-safe-area-bottom:0px;--ion-safe-area-left:0px}.sc-ion-popover-md-h{--width:250px;--max-height:90%;--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12);--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}.popover-content.sc-ion-popover-md{border-radius:4px;-webkit-transform-origin:left top;transform-origin:left top}[dir=rtl].sc-ion-popover-md .popover-content.sc-ion-popover-md,[dir=rtl].sc-ion-popover-md-h .popover-content.sc-ion-popover-md,[dir=rtl] .sc-ion-popover-md-h .popover-content.sc-ion-popover-md{-webkit-transform-origin:right top;transform-origin:right top}.popover-viewport.sc-ion-popover-md{-webkit-transition-delay:100ms;transition-delay:100ms}",Popover=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.presented=!1,this.keyboardClose=!0,this.backdropDismiss=!0,this.showBackdrop=!0,this.translucent=!1,this.animated=!0,this.onDismiss=t=>{t.stopPropagation(),t.preventDefault(),this.dismiss()},this.onBackdropTap=()=>{this.dismiss(void 0,BACKDROP)},this.onLifecycle=t=>{const e=this.usersElement,i=LIFECYCLE_MAP$1[t.type];if(e&&i){const n=new CustomEvent(i,{bubbles:!1,cancelable:!1,detail:t.detail});e.dispatchEvent(n)}},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionPopoverDidPresent",7),this.willPresent=createEvent(this,"ionPopoverWillPresent",7),this.willDismiss=createEvent(this,"ionPopoverWillDismiss",7),this.didDismiss=createEvent(this,"ionPopoverDidDismiss",7)}async present(){if(this.presented)return;const t=this.el.querySelector(".popover-content");if(!t)throw new Error("container is undefined");const e=Object.assign(Object.assign({},this.componentProps),{popover:this.el});return this.usersElement=await attachComponent(this.delegate,t,this.component,["popover-viewport",this.el["s-sc"]],e),await deepReady(this.usersElement),present(this,"popoverEnter",iosEnterAnimation$5,mdEnterAnimation$4,this.event)}async dismiss(t,e){const i=await dismiss(this,t,e,"popoverLeave",iosLeaveAnimation$5,mdLeaveAnimation$4,this.event);return i&&await detachComponent(this.delegate,this.usersElement),i}onDidDismiss(){return eventMethod(this.el,"ionPopoverDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionPopoverWillDismiss")}render(){const t=getIonMode(this),{onLifecycle:e}=this;return h(Host,{"aria-modal":"true","no-router":!0,style:{zIndex:""+(2e4+this.overlayIndex)},class:Object.assign(Object.assign({},getClassMap(this.cssClass)),{[t]:!0,"popover-translucent":this.translucent}),onIonPopoverDidPresent:e,onIonPopoverWillPresent:e,onIonPopoverWillDismiss:e,onIonPopoverDidDismiss:e,onIonDismiss:this.onDismiss,onIonBackdropTap:this.onBackdropTap},h("ion-backdrop",{tappable:this.backdropDismiss,visible:this.showBackdrop}),h("div",{class:"popover-wrapper"},h("div",{class:"popover-arrow"}),h("div",{class:"popover-content"})))}get el(){return this}static get style(){return{ios:popoverIosCss,md:popoverMdCss}}},LIFECYCLE_MAP$1={ionPopoverDidPresent:"ionViewDidEnter",ionPopoverWillPresent:"ionViewWillEnter",ionPopoverWillDismiss:"ionViewWillLeave",ionPopoverDidDismiss:"ionViewDidLeave"},progressBarIosCss=':host{--background:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.2);--progress-background:var(--ion-color-primary, #3880ff);--buffer-background:var(--background);display:block;position:relative;width:100%;contain:strict;direction:ltr;overflow:hidden}:host(.ion-color){--progress-background:var(--ion-color-base);--buffer-background:rgba(var(--ion-color-base-rgb), 0.2)}:host(.progress-bar-indeterminate){background:var(--buffer-background)}.progress,.progress-indeterminate,.indeterminate-bar-primary,.indeterminate-bar-secondary,.progress-buffer-bar,.progress-buffer-bar:before,.buffer-circles{left:0;right:0;top:0;bottom:0;position:absolute;width:100%;height:100%}.progress,.progress-buffer-bar{-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms linear;transition:-webkit-transform 150ms linear;transition:transform 150ms linear;transition:transform 150ms linear, -webkit-transform 150ms linear}.progress,.progress-indeterminate{background:var(--progress-background);z-index:2}.progress-buffer-bar{background:#fff;z-index:1}.progress-buffer-bar:before{background:var(--buffer-background);content:""}.indeterminate-bar-primary{top:0;right:0;bottom:0;left:-145.166611%;-webkit-animation:primary-indeterminate-translate 2s infinite linear;animation:primary-indeterminate-translate 2s infinite linear}.indeterminate-bar-primary .progress-indeterminate{-webkit-animation:primary-indeterminate-scale 2s infinite linear;animation:primary-indeterminate-scale 2s infinite linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.indeterminate-bar-secondary{top:0;right:0;bottom:0;left:-54.888891%;-webkit-animation:secondary-indeterminate-translate 2s infinite linear;animation:secondary-indeterminate-translate 2s infinite linear}.indeterminate-bar-secondary .progress-indeterminate{-webkit-animation:secondary-indeterminate-scale 2s infinite linear;animation:secondary-indeterminate-scale 2s infinite linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.buffer-circles{background:radial-gradient(ellipse at center, var(--buffer-background) 0%, var(--buffer-background) 30%, transparent 30%) repeat-x 5px center;background-size:10px 10px;z-index:0;-webkit-animation:buffering 450ms infinite linear;animation:buffering 450ms infinite linear}:host(.progress-bar-reversed) .progress,:host(.progress-bar-reversed) .progress-buffer-bar{-webkit-transform-origin:right top;transform-origin:right top}:host(.progress-bar-reversed) .buffer-circles,:host(.progress-bar-reversed) .indeterminate-bar-primary,:host(.progress-bar-reversed) .indeterminate-bar-secondary,:host(.progress-bar-reversed) .progress-indeterminate{animation-direction:reverse}:host(.progress-paused) .indeterminate-bar-secondary,:host(.progress-paused) .indeterminate-bar-primary,:host(.progress-paused) .buffer-circles{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes primary-indeterminate-translate{0%{-webkit-transform:translateX(0);transform:translateX(0)}20%{-webkit-animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);-webkit-transform:translateX(0);transform:translateX(0)}59.15%{-webkit-animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);-webkit-transform:translateX(83.67142%);transform:translateX(83.67142%)}100%{-webkit-transform:translateX(200.611057%);transform:translateX(200.611057%)}}@keyframes primary-indeterminate-translate{0%{-webkit-transform:translateX(0);transform:translateX(0)}20%{-webkit-animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);-webkit-transform:translateX(0);transform:translateX(0)}59.15%{-webkit-animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);-webkit-transform:translateX(83.67142%);transform:translateX(83.67142%)}100%{-webkit-transform:translateX(200.611057%);transform:translateX(200.611057%)}}@-webkit-keyframes primary-indeterminate-scale{0%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}36.65%{-webkit-animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}69.15%{-webkit-animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);-webkit-transform:scaleX(0.661479);transform:scaleX(0.661479)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@keyframes primary-indeterminate-scale{0%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}36.65%{-webkit-animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}69.15%{-webkit-animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);-webkit-transform:scaleX(0.661479);transform:scaleX(0.661479)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@-webkit-keyframes secondary-indeterminate-translate{0%{-webkit-animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);-webkit-transform:translateX(0);transform:translateX(0)}25%{-webkit-animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);-webkit-transform:translateX(37.651913%);transform:translateX(37.651913%)}48.35%{-webkit-animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);-webkit-transform:translateX(84.386165%);transform:translateX(84.386165%)}100%{-webkit-transform:translateX(160.277782%);transform:translateX(160.277782%)}}@keyframes secondary-indeterminate-translate{0%{-webkit-animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);-webkit-transform:translateX(0);transform:translateX(0)}25%{-webkit-animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);-webkit-transform:translateX(37.651913%);transform:translateX(37.651913%)}48.35%{-webkit-animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);-webkit-transform:translateX(84.386165%);transform:translateX(84.386165%)}100%{-webkit-transform:translateX(160.277782%);transform:translateX(160.277782%)}}@-webkit-keyframes secondary-indeterminate-scale{0%{-webkit-animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}19.15%{-webkit-animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);-webkit-transform:scaleX(0.457104);transform:scaleX(0.457104)}44.15%{-webkit-animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);-webkit-transform:scaleX(0.72796);transform:scaleX(0.72796)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@keyframes secondary-indeterminate-scale{0%{-webkit-animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}19.15%{-webkit-animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);-webkit-transform:scaleX(0.457104);transform:scaleX(0.457104)}44.15%{-webkit-animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);-webkit-transform:scaleX(0.72796);transform:scaleX(0.72796)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@-webkit-keyframes buffering{to{-webkit-transform:translateX(-10px);transform:translateX(-10px)}}@keyframes buffering{to{-webkit-transform:translateX(-10px);transform:translateX(-10px)}}:host{height:3px}',progressBarMdCss=':host{--background:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.2);--progress-background:var(--ion-color-primary, #3880ff);--buffer-background:var(--background);display:block;position:relative;width:100%;contain:strict;direction:ltr;overflow:hidden}:host(.ion-color){--progress-background:var(--ion-color-base);--buffer-background:rgba(var(--ion-color-base-rgb), 0.2)}:host(.progress-bar-indeterminate){background:var(--buffer-background)}.progress,.progress-indeterminate,.indeterminate-bar-primary,.indeterminate-bar-secondary,.progress-buffer-bar,.progress-buffer-bar:before,.buffer-circles{left:0;right:0;top:0;bottom:0;position:absolute;width:100%;height:100%}.progress,.progress-buffer-bar{-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms linear;transition:-webkit-transform 150ms linear;transition:transform 150ms linear;transition:transform 150ms linear, -webkit-transform 150ms linear}.progress,.progress-indeterminate{background:var(--progress-background);z-index:2}.progress-buffer-bar{background:#fff;z-index:1}.progress-buffer-bar:before{background:var(--buffer-background);content:""}.indeterminate-bar-primary{top:0;right:0;bottom:0;left:-145.166611%;-webkit-animation:primary-indeterminate-translate 2s infinite linear;animation:primary-indeterminate-translate 2s infinite linear}.indeterminate-bar-primary .progress-indeterminate{-webkit-animation:primary-indeterminate-scale 2s infinite linear;animation:primary-indeterminate-scale 2s infinite linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.indeterminate-bar-secondary{top:0;right:0;bottom:0;left:-54.888891%;-webkit-animation:secondary-indeterminate-translate 2s infinite linear;animation:secondary-indeterminate-translate 2s infinite linear}.indeterminate-bar-secondary .progress-indeterminate{-webkit-animation:secondary-indeterminate-scale 2s infinite linear;animation:secondary-indeterminate-scale 2s infinite linear;-webkit-animation-play-state:inherit;animation-play-state:inherit}.buffer-circles{background:radial-gradient(ellipse at center, var(--buffer-background) 0%, var(--buffer-background) 30%, transparent 30%) repeat-x 5px center;background-size:10px 10px;z-index:0;-webkit-animation:buffering 450ms infinite linear;animation:buffering 450ms infinite linear}:host(.progress-bar-reversed) .progress,:host(.progress-bar-reversed) .progress-buffer-bar{-webkit-transform-origin:right top;transform-origin:right top}:host(.progress-bar-reversed) .buffer-circles,:host(.progress-bar-reversed) .indeterminate-bar-primary,:host(.progress-bar-reversed) .indeterminate-bar-secondary,:host(.progress-bar-reversed) .progress-indeterminate{animation-direction:reverse}:host(.progress-paused) .indeterminate-bar-secondary,:host(.progress-paused) .indeterminate-bar-primary,:host(.progress-paused) .buffer-circles{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes primary-indeterminate-translate{0%{-webkit-transform:translateX(0);transform:translateX(0)}20%{-webkit-animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);-webkit-transform:translateX(0);transform:translateX(0)}59.15%{-webkit-animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);-webkit-transform:translateX(83.67142%);transform:translateX(83.67142%)}100%{-webkit-transform:translateX(200.611057%);transform:translateX(200.611057%)}}@keyframes primary-indeterminate-translate{0%{-webkit-transform:translateX(0);transform:translateX(0)}20%{-webkit-animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);-webkit-transform:translateX(0);transform:translateX(0)}59.15%{-webkit-animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);-webkit-transform:translateX(83.67142%);transform:translateX(83.67142%)}100%{-webkit-transform:translateX(200.611057%);transform:translateX(200.611057%)}}@-webkit-keyframes primary-indeterminate-scale{0%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}36.65%{-webkit-animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}69.15%{-webkit-animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);-webkit-transform:scaleX(0.661479);transform:scaleX(0.661479)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@keyframes primary-indeterminate-scale{0%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}36.65%{-webkit-animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}69.15%{-webkit-animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);-webkit-transform:scaleX(0.661479);transform:scaleX(0.661479)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@-webkit-keyframes secondary-indeterminate-translate{0%{-webkit-animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);-webkit-transform:translateX(0);transform:translateX(0)}25%{-webkit-animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);-webkit-transform:translateX(37.651913%);transform:translateX(37.651913%)}48.35%{-webkit-animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);-webkit-transform:translateX(84.386165%);transform:translateX(84.386165%)}100%{-webkit-transform:translateX(160.277782%);transform:translateX(160.277782%)}}@keyframes secondary-indeterminate-translate{0%{-webkit-animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);-webkit-transform:translateX(0);transform:translateX(0)}25%{-webkit-animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);-webkit-transform:translateX(37.651913%);transform:translateX(37.651913%)}48.35%{-webkit-animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);-webkit-transform:translateX(84.386165%);transform:translateX(84.386165%)}100%{-webkit-transform:translateX(160.277782%);transform:translateX(160.277782%)}}@-webkit-keyframes secondary-indeterminate-scale{0%{-webkit-animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}19.15%{-webkit-animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);-webkit-transform:scaleX(0.457104);transform:scaleX(0.457104)}44.15%{-webkit-animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);-webkit-transform:scaleX(0.72796);transform:scaleX(0.72796)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@keyframes secondary-indeterminate-scale{0%{-webkit-animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}19.15%{-webkit-animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);-webkit-transform:scaleX(0.457104);transform:scaleX(0.457104)}44.15%{-webkit-animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);-webkit-transform:scaleX(0.72796);transform:scaleX(0.72796)}100%{-webkit-transform:scaleX(0.08);transform:scaleX(0.08)}}@-webkit-keyframes buffering{to{-webkit-transform:translateX(-10px);transform:translateX(-10px)}}@keyframes buffering{to{-webkit-transform:translateX(-10px);transform:translateX(-10px)}}:host{height:4px}',ProgressBar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.type="determinate",this.reversed=!1,this.value=0,this.buffer=1}render(){const{color:t,type:e,reversed:i,value:n,buffer:s}=this,o=config.getBoolean("_testing"),r=getIonMode(this);return h(Host,{role:"progressbar","aria-valuenow":"determinate"===e?n:null,"aria-valuemin":"0","aria-valuemax":"1",class:Object.assign(Object.assign({},createColorClasses(t)),{[r]:!0,["progress-bar-"+e]:!0,"progress-paused":o,"progress-bar-reversed":"rtl"===document.dir?!i:i})},"indeterminate"===e?renderIndeterminate():renderProgress(n,s))}static get style(){return{ios:progressBarIosCss,md:progressBarMdCss}}},renderIndeterminate=()=>[h("div",{class:"indeterminate-bar-primary"},h("span",{class:"progress-indeterminate"})),h("div",{class:"indeterminate-bar-secondary"},h("span",{class:"progress-indeterminate"}))],renderProgress=(t,e)=>{const i=clamp(0,t,1),n=clamp(0,e,1);return[h("div",{class:"progress",style:{transform:`scaleX(${i})`}}),1!==n&&h("div",{class:"buffer-circles"}),h("div",{class:"progress-buffer-bar",style:{transform:`scaleX(${n})`}})]},radioIosCss=':host{--inner-border-radius:50%;display:inline-block;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.radio-disabled){pointer-events:none}.radio-icon{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;contain:layout size style}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.radio-icon,.radio-inner{-webkit-box-sizing:border-box;box-sizing:border-box}:host{--color-checked:var(--ion-color-primary, #3880ff);width:15px;height:24px}:host(.ion-color.radio-checked) .radio-inner{border-color:var(--ion-color-base)}.item-radio.item-ios ion-label{margin-left:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.item-radio.item-ios ion-label{margin-left:unset;-webkit-margin-start:0;margin-inline-start:0}}.radio-inner{width:33%;height:50%}:host(.radio-checked) .radio-inner{-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:2px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--color-checked)}:host(.radio-disabled){opacity:0.3}:host(.ion-focused) .radio-icon::after{border-radius:var(--inner-border-radius);left:-9px;top:-8px;display:block;position:absolute;width:36px;height:36px;background:var(--ion-color-primary-tint, #4c8dff);content:"";opacity:0.2}:host-context([dir=rtl]):host(.ion-focused) .radio-icon::after,:host-context([dir=rtl]).ion-focused .radio-icon::after{left:unset;right:unset;right:-9px}:host(.in-item){margin-left:10px;margin-right:11px;margin-top:8px;margin-bottom:8px;display:block;position:static}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:11px;margin-inline-end:11px}}:host(.in-item[slot=start]){margin-left:3px;margin-right:21px;margin-top:8px;margin-bottom:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:3px;margin-inline-start:3px;-webkit-margin-end:21px;margin-inline-end:21px}}',radioMdCss=':host{--inner-border-radius:50%;display:inline-block;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.radio-disabled){pointer-events:none}.radio-icon{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;contain:layout size style}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.radio-icon,.radio-inner{-webkit-box-sizing:border-box;box-sizing:border-box}:host{--color:var(--ion-color-step-400, #999999);--color-checked:var(--ion-color-primary, #3880ff);--border-width:2px;--border-style:solid;--border-radius:50%;width:20px;height:20px}:host(.ion-color) .radio-inner{background:var(--ion-color-base)}:host(.ion-color.radio-checked) .radio-icon{border-color:var(--ion-color-base)}.radio-icon{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;border-radius:var(--border-radius);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--color)}.radio-inner{border-radius:var(--inner-border-radius);width:calc(50% + var(--border-width));height:calc(50% + var(--border-width));-webkit-transform:scale3d(0, 0, 0);transform:scale3d(0, 0, 0);-webkit-transition:-webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:-webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:transform 280ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);background:var(--color-checked)}:host(.radio-checked) .radio-icon{border-color:var(--color-checked)}:host(.radio-checked) .radio-inner{-webkit-transform:scale3d(1, 1, 1);transform:scale3d(1, 1, 1)}:host(.radio-disabled){opacity:0.3}:host(.ion-focused) .radio-icon::after{border-radius:var(--inner-border-radius);left:-12px;top:-12px;display:block;position:absolute;width:36px;height:36px;background:var(--ion-color-primary-tint, #4c8dff);content:"";opacity:0.2}:host-context([dir=rtl]):host(.ion-focused) .radio-icon::after,:host-context([dir=rtl]).ion-focused .radio-icon::after{left:unset;right:unset;right:-12px}:host(.in-item){margin-left:0;margin-right:0;margin-top:9px;margin-bottom:9px;display:block;position:static}:host(.in-item[slot=start]){margin-left:4px;margin-right:36px;margin-top:11px;margin-bottom:10px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-end:36px;margin-inline-end:36px}}',Radio=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputId="ion-rb-"+radioButtonIds++,this.radioGroup=null,this.checked=!1,this.name=this.inputId,this.disabled=!1,this.updateState=()=>{this.radioGroup&&(this.checked=this.radioGroup.value===this.value)},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionStyle=createEvent(this,"ionStyle",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7)}connectedCallback(){void 0===this.value&&(this.value=this.inputId);const t=this.radioGroup=this.el.closest("ion-radio-group");t&&(this.updateState(),t.addEventListener("ionChange",this.updateState))}disconnectedCallback(){const t=this.radioGroup;t&&(t.removeEventListener("ionChange",this.updateState),this.radioGroup=null)}componentWillLoad(){this.emitStyle()}emitStyle(){this.ionStyle.emit({"radio-checked":this.checked,"interactive-disabled":this.disabled})}render(){const{inputId:t,disabled:e,checked:i,color:n,el:s}=this,o=getIonMode(this),r=t+"-lbl",a=findItemLabel(s);return a&&(a.id=r),h(Host,{role:"radio","aria-disabled":e?"true":null,"aria-checked":""+i,"aria-labelledby":r,class:Object.assign(Object.assign({},createColorClasses(n)),{[o]:!0,"in-item":hostContext("ion-item",s),interactive:!0,"radio-checked":i,"radio-disabled":e})},h("div",{class:"radio-icon"},h("div",{class:"radio-inner"})),h("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:e}))}get el(){return this}static get watchers(){return{color:["emitStyle"],checked:["emitStyle"],disabled:["emitStyle"]}}static get style(){return{ios:radioIosCss,md:radioMdCss}}};let radioButtonIds=0;const RadioGroup=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.inputId="ion-rg-"+radioGroupIds++,this.labelId=this.inputId+"-lbl",this.allowEmptySelection=!1,this.name=this.inputId,this.onClick=t=>{const e=t.target&&t.target.closest("ion-radio");if(e){const t=e.value;t!==this.value?this.value=t:this.allowEmptySelection&&(this.value=void 0)}},this.ionChange=createEvent(this,"ionChange",7)}valueChanged(t){this.ionChange.emit({value:t})}async connectedCallback(){const t=this.el,e=t.querySelector("ion-list-header")||t.querySelector("ion-item-divider");if(e){const t=e.querySelector("ion-label");t&&(this.labelId=t.id=this.name+"-lbl")}}render(){return h(Host,{role:"radiogroup","aria-labelledby":this.labelId,onClick:this.onClick,class:getIonMode(this)})}get el(){return this}static get watchers(){return{value:["valueChanged"]}}};let radioGroupIds=0;const rangeIosCss=":host{--knob-handle-size:calc(var(--knob-size) * 2);display:-ms-flexbox;display:flex;position:relative;-ms-flex:3;flex:3;-ms-flex-align:center;align-items:center;font-family:var(--ion-font-family, inherit);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.range-disabled){pointer-events:none}::slotted(ion-label){-ms-flex:initial;flex:initial}::slotted(ion-icon[slot]){font-size:24px}.range-slider{position:relative;-ms-flex:1;flex:1;width:100%;height:var(--height);contain:size layout style;cursor:-webkit-grab;cursor:grab;-ms-touch-action:pan-y;touch-action:pan-y}:host(.range-pressed) .range-slider{cursor:-webkit-grabbing;cursor:grabbing}.range-pin{position:absolute;background:var(--ion-color-base);color:var(--ion-color-contrast);text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box}.range-knob-handle{left:0;top:calc((var(--height) - var(--knob-handle-size)) / 2);margin-left:calc(0px - var(--knob-handle-size) / 2);position:absolute;width:var(--knob-handle-size);height:var(--knob-handle-size);text-align:center}[dir=rtl] .range-knob-handle,:host-context([dir=rtl]) .range-knob-handle{left:unset;right:unset;right:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.range-knob-handle{margin-left:unset;-webkit-margin-start:calc(0px - var(--knob-handle-size) / 2);margin-inline-start:calc(0px - var(--knob-handle-size) / 2)}}[dir=rtl] .range-knob-handle,:host-context([dir=rtl]) .range-knob-handle{left:unset}.range-knob-handle:active,.range-knob-handle:focus{outline:none}.range-bar{border-radius:var(--bar-border-radius);left:0;top:calc((var(--height) - var(--bar-height)) / 2);position:absolute;width:100%;height:var(--bar-height);background:var(--bar-background);pointer-events:none}[dir=rtl] .range-bar,:host-context([dir=rtl]) .range-bar{left:unset;right:unset;right:0}[dir=rtl] .range-bar,:host-context([dir=rtl]) .range-bar{left:unset}.range-knob{border-radius:var(--knob-border-radius);left:calc(50% - var(--knob-size) / 2);top:calc(50% - var(--knob-size) / 2);position:absolute;width:var(--knob-size);height:var(--knob-size);background:var(--knob-background);-webkit-box-shadow:var(--knob-box-shadow);box-shadow:var(--knob-box-shadow);z-index:2;pointer-events:none}[dir=rtl] .range-knob,:host-context([dir=rtl]) .range-knob{left:unset;right:unset;right:calc(50% - var(--knob-size) / 2)}[dir=rtl] .range-knob,:host-context([dir=rtl]) .range-knob{left:unset}:host(.range-pressed) .range-bar-active{will-change:left, right}:host(.in-item){width:100%}:host(.in-item) ::slotted(ion-label){-ms-flex-item-align:center;align-self:center}:host{--knob-border-radius:50%;--knob-background:#ffffff;--knob-box-shadow:0 3px 1px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 0, 0, 0.13), 0 0 0 1px rgba(0, 0, 0, 0.02);--knob-size:28px;--bar-height:2px;--bar-background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1);--bar-background-active:var(--ion-color-primary, #3880ff);--bar-border-radius:0;--height:42px;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}:host(.ion-color) .range-bar-active,:host(.ion-color) .range-tick-active{background:var(--ion-color-base)}::slotted([slot=start]){margin-left:0;margin-right:16px;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px}}::slotted([slot=end]){margin-left:16px;margin-right:0;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:0;margin-inline-end:0}}:host(.range-has-pin){padding-top:20px}.range-bar-active{bottom:0;width:auto;background:var(--bar-background-active)}.range-tick{margin-left:-1px;border-radius:0;position:absolute;top:18px;width:2px;height:8px;background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1);pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.range-tick{margin-left:unset;-webkit-margin-start:-1px;margin-inline-start:-1px}}.range-tick-active{background:var(--bar-background-active)}.range-pin{-webkit-transform:translate3d(0,  28px,  0) scale(0.01);transform:translate3d(0,  28px,  0) scale(0.01);padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;display:inline-block;position:relative;top:-20px;min-width:28px;-webkit-transition:-webkit-transform 120ms ease;transition:-webkit-transform 120ms ease;transition:transform 120ms ease;transition:transform 120ms ease, -webkit-transform 120ms ease;background:transparent;color:var(--ion-text-color, #000);font-size:12px;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.range-pin{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.range-knob-pressed .range-pin{-webkit-transform:translate3d(0,  0,  0) scale(1);transform:translate3d(0,  0,  0) scale(1)}:host(.range-disabled){opacity:0.5}",rangeMdCss=':host{--knob-handle-size:calc(var(--knob-size) * 2);display:-ms-flexbox;display:flex;position:relative;-ms-flex:3;flex:3;-ms-flex-align:center;align-items:center;font-family:var(--ion-font-family, inherit);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.range-disabled){pointer-events:none}::slotted(ion-label){-ms-flex:initial;flex:initial}::slotted(ion-icon[slot]){font-size:24px}.range-slider{position:relative;-ms-flex:1;flex:1;width:100%;height:var(--height);contain:size layout style;cursor:-webkit-grab;cursor:grab;-ms-touch-action:pan-y;touch-action:pan-y}:host(.range-pressed) .range-slider{cursor:-webkit-grabbing;cursor:grabbing}.range-pin{position:absolute;background:var(--ion-color-base);color:var(--ion-color-contrast);text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box}.range-knob-handle{left:0;top:calc((var(--height) - var(--knob-handle-size)) / 2);margin-left:calc(0px - var(--knob-handle-size) / 2);position:absolute;width:var(--knob-handle-size);height:var(--knob-handle-size);text-align:center}[dir=rtl] .range-knob-handle,:host-context([dir=rtl]) .range-knob-handle{left:unset;right:unset;right:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.range-knob-handle{margin-left:unset;-webkit-margin-start:calc(0px - var(--knob-handle-size) / 2);margin-inline-start:calc(0px - var(--knob-handle-size) / 2)}}[dir=rtl] .range-knob-handle,:host-context([dir=rtl]) .range-knob-handle{left:unset}.range-knob-handle:active,.range-knob-handle:focus{outline:none}.range-bar{border-radius:var(--bar-border-radius);left:0;top:calc((var(--height) - var(--bar-height)) / 2);position:absolute;width:100%;height:var(--bar-height);background:var(--bar-background);pointer-events:none}[dir=rtl] .range-bar,:host-context([dir=rtl]) .range-bar{left:unset;right:unset;right:0}[dir=rtl] .range-bar,:host-context([dir=rtl]) .range-bar{left:unset}.range-knob{border-radius:var(--knob-border-radius);left:calc(50% - var(--knob-size) / 2);top:calc(50% - var(--knob-size) / 2);position:absolute;width:var(--knob-size);height:var(--knob-size);background:var(--knob-background);-webkit-box-shadow:var(--knob-box-shadow);box-shadow:var(--knob-box-shadow);z-index:2;pointer-events:none}[dir=rtl] .range-knob,:host-context([dir=rtl]) .range-knob{left:unset;right:unset;right:calc(50% - var(--knob-size) / 2)}[dir=rtl] .range-knob,:host-context([dir=rtl]) .range-knob{left:unset}:host(.range-pressed) .range-bar-active{will-change:left, right}:host(.in-item){width:100%}:host(.in-item) ::slotted(ion-label){-ms-flex-item-align:center;align-self:center}:host{--knob-border-radius:50%;--knob-background:var(--bar-background-active);--knob-box-shadow:none;--knob-size:18px;--bar-height:2px;--bar-background:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.26);--bar-background-active:var(--ion-color-primary, #3880ff);--bar-border-radius:0;--height:42px;--pin-background:var(--ion-color-primary, #3880ff);--pin-color:var(--ion-color-primary-contrast, #fff);padding-left:14px;padding-right:14px;padding-top:8px;padding-bottom:8px;font-size:12px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:14px;padding-inline-start:14px;-webkit-padding-end:14px;padding-inline-end:14px}}:host(.ion-color) .range-bar{background:rgba(var(--ion-color-base-rgb), 0.26)}:host(.ion-color) .range-bar-active,:host(.ion-color) .range-knob,:host(.ion-color) .range-pin,:host(.ion-color) .range-pin::before,:host(.ion-color) .range-tick{background:var(--ion-color-base);color:var(--ion-color-contrast)}::slotted([slot=start]){margin-left:0;margin-right:14px;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:14px;margin-inline-end:14px}}::slotted([slot=end]){margin-left:14px;margin-right:0;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:14px;margin-inline-start:14px;-webkit-margin-end:0;margin-inline-end:0}}:host(.range-has-pin){padding-top:28px}.range-bar-active{bottom:0;width:auto;background:var(--bar-background-active)}.range-knob{-webkit-transform:scale(0.67);transform:scale(0.67);-webkit-transition-duration:120ms;transition-duration:120ms;-webkit-transition-property:background-color, border, -webkit-transform;transition-property:background-color, border, -webkit-transform;transition-property:transform, background-color, border;transition-property:transform, background-color, border, -webkit-transform;-webkit-transition-timing-function:ease;transition-timing-function:ease;z-index:2}.range-tick{position:absolute;top:calc((var(--height) - var(--bar-height)) / 2);width:var(--bar-height);height:var(--bar-height);background:var(--bar-background-active);z-index:1;pointer-events:none}.range-tick-active{background:transparent}.range-pin{padding-left:0;padding-right:0;padding-top:8px;padding-bottom:8px;border-radius:50%;-webkit-transform:translate3d(0,  0,  0) scale(0.01);transform:translate3d(0,  0,  0) scale(0.01);display:inline-block;position:relative;min-width:28px;height:28px;-webkit-transition:background 120ms ease, -webkit-transform 120ms ease;transition:background 120ms ease, -webkit-transform 120ms ease;transition:transform 120ms ease, background 120ms ease;transition:transform 120ms ease, background 120ms ease, -webkit-transform 120ms ease;background:var(--pin-background);color:var(--pin-color);text-align:center}.range-pin::before{left:50%;top:3px;margin-left:-13px;border-radius:50% 50% 50% 0;position:absolute;width:26px;height:26px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transition:background 120ms ease;transition:background 120ms ease;background:var(--pin-background);content:"";z-index:-1}[dir=rtl] .range-pin::before,:host-context([dir=rtl]) .range-pin::before{left:unset;right:unset;right:50%}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.range-pin::before{margin-left:unset;-webkit-margin-start:-13px;margin-inline-start:-13px}}[dir=rtl] .range-pin::before,:host-context([dir=rtl]) .range-pin::before{left:unset}.range-knob-pressed .range-pin{-webkit-transform:translate3d(0,  -24px,  0) scale(1);transform:translate3d(0,  -24px,  0) scale(1)}:host(:not(.range-has-pin)) .range-knob-pressed .range-knob{-webkit-transform:scale(1);transform:scale(1)}:host(.range-disabled) .range-bar-active,:host(.range-disabled) .range-bar,:host(.range-disabled) .range-tick{background-color:var(--ion-color-step-250, #bfbfbf)}:host(.range-disabled) .range-knob{-webkit-transform:scale(0.55);transform:scale(0.55);outline:5px solid #fff;background-color:var(--ion-color-step-250, #bfbfbf)}',Range=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.noUpdate=!1,this.hasFocus=!1,this.ratioA=0,this.ratioB=0,this.debounce=0,this.name="",this.dualKnobs=!1,this.min=0,this.max=100,this.pin=!1,this.snaps=!1,this.step=1,this.ticks=!0,this.disabled=!1,this.value=0,this.clampBounds=t=>clamp(this.min,t,this.max),this.ensureValueInBounds=t=>this.dualKnobs?{lower:this.clampBounds(t.lower),upper:this.clampBounds(t.upper)}:this.clampBounds(t),this.handleKeyboard=(t,e)=>{let i=this.step;i=i>0?i:1,i/=this.max-this.min,e||(i*=-1),"A"===t?this.ratioA=clamp(0,this.ratioA+i,1):this.ratioB=clamp(0,this.ratioB+i,1),this.updateValue()},this.onBlur=()=>{this.hasFocus&&(this.hasFocus=!1,this.ionBlur.emit(),this.emitStyle())},this.onFocus=()=>{this.hasFocus||(this.hasFocus=!0,this.ionFocus.emit(),this.emitStyle())},this.ionChange=createEvent(this,"ionChange",7),this.ionStyle=createEvent(this,"ionStyle",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7)}debounceChanged(){this.ionChange=debounceEvent(this.ionChange,this.debounce)}minChanged(){this.noUpdate||this.updateRatio()}maxChanged(){this.noUpdate||this.updateRatio()}disabledChanged(){this.gesture&&this.gesture.enable(!this.disabled),this.emitStyle()}valueChanged(t){this.noUpdate||this.updateRatio(),t=this.ensureValueInBounds(t),this.ionChange.emit({value:t})}connectedCallback(){this.updateRatio(),this.debounceChanged(),this.disabledChanged()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async componentDidLoad(){const t=this.rangeSlider;t&&(this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:t,gestureName:"range",gesturePriority:100,threshold:0,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gesture.enable(!this.disabled))}getValue(){const t=this.value||0;return this.dualKnobs?"object"==typeof t?t:{lower:0,upper:t}:"object"==typeof t?t.upper:t}emitStyle(){this.ionStyle.emit({interactive:!0,"interactive-disabled":this.disabled})}onStart(t){const e=this.rect=this.rangeSlider.getBoundingClientRect(),i=t.currentX;let n=clamp(0,(i-e.left)/e.width,1);"rtl"===document.dir&&(n=1-n),this.pressedKnob=!this.dualKnobs||Math.abs(this.ratioA-n)<Math.abs(this.ratioB-n)?"A":"B",this.setFocus(this.pressedKnob),this.update(i)}onMove(t){this.update(t.currentX)}onEnd(t){this.update(t.currentX),this.pressedKnob=void 0}update(t){const e=this.rect;let i=clamp(0,(t-e.left)/e.width,1);"rtl"===document.dir&&(i=1-i),this.snaps&&(i=valueToRatio(ratioToValue(i,this.min,this.max,this.step),this.min,this.max)),"A"===this.pressedKnob?this.ratioA=i:this.ratioB=i,this.updateValue()}get valA(){return ratioToValue(this.ratioA,this.min,this.max,this.step)}get valB(){return ratioToValue(this.ratioB,this.min,this.max,this.step)}get ratioLower(){return this.dualKnobs?Math.min(this.ratioA,this.ratioB):0}get ratioUpper(){return this.dualKnobs?Math.max(this.ratioA,this.ratioB):this.ratioA}updateRatio(){const t=this.getValue(),{min:e,max:i}=this;this.dualKnobs?(this.ratioA=valueToRatio(t.lower,e,i),this.ratioB=valueToRatio(t.upper,e,i)):this.ratioA=valueToRatio(t,e,i)}updateValue(){this.noUpdate=!0;const{valA:t,valB:e}=this;this.value=this.dualKnobs?{lower:Math.min(t,e),upper:Math.max(t,e)}:t,this.noUpdate=!1}setFocus(t){if(this.el.shadowRoot){const e=this.el.shadowRoot.querySelector("A"===t?".range-knob-a":".range-knob-b");e&&e.focus()}}render(){const{min:t,max:e,step:i,el:n,handleKeyboard:s,pressedKnob:o,disabled:r,pin:a,ratioLower:l,ratioUpper:c}=this,d=getIonMode(this),u="rtl"===document.dir,m=u?"right":"left",p=t=>({[m]:t[m]}),b={[m]:100*l+"%",[u?"left":"right"]:100-100*c+"%"},f=[];if(this.snaps&&this.ticks)for(let h=t;h<=e;h+=i){const i=valueToRatio(h,t,e),n={ratio:i,active:i>=l&&i<=c};n[m]=100*i+"%",f.push(n)}return renderHiddenInput(!0,n,this.name,JSON.stringify(this.getValue()),r),h(Host,{onFocusin:this.onFocus,onFocusout:this.onBlur,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[d]:!0,"in-item":hostContext("ion-item",n),"range-disabled":r,"range-pressed":void 0!==o,"range-has-pin":a})},h("slot",{name:"start"}),h("div",{class:"range-slider",ref:t=>this.rangeSlider=t},f.map(t=>h("div",{style:p(t),role:"presentation",class:{"range-tick":!0,"range-tick-active":t.active}})),h("div",{class:"range-bar",role:"presentation"}),h("div",{class:"range-bar range-bar-active",role:"presentation",style:b}),renderKnob(u,{knob:"A",pressed:"A"===o,value:this.valA,ratio:this.ratioA,pin:a,disabled:r,handleKeyboard:s,min:t,max:e}),this.dualKnobs&&renderKnob(u,{knob:"B",pressed:"B"===o,value:this.valB,ratio:this.ratioB,pin:a,disabled:r,handleKeyboard:s,min:t,max:e})),h("slot",{name:"end"}))}get el(){return this}static get watchers(){return{debounce:["debounceChanged"],min:["minChanged"],max:["maxChanged"],disabled:["disabledChanged"],value:["valueChanged"]}}static get style(){return{ios:rangeIosCss,md:rangeMdCss}}},renderKnob=(t,{knob:e,value:i,ratio:n,min:s,max:o,disabled:r,pressed:a,pin:l,handleKeyboard:c})=>{const d=t?"right":"left";return h("div",{onKeyDown:t=>{const i=t.key;"ArrowLeft"===i||"ArrowDown"===i?(c(e,!1),t.preventDefault(),t.stopPropagation()):"ArrowRight"!==i&&"ArrowUp"!==i||(c(e,!0),t.preventDefault(),t.stopPropagation())},class:{"range-knob-handle":!0,"range-knob-a":"A"===e,"range-knob-b":"B"===e,"range-knob-pressed":a,"range-knob-min":i===s,"range-knob-max":i===o},style:(()=>{const t={};return t[d]=100*n+"%",t})(),role:"slider",tabindex:r?-1:0,"aria-valuemin":s,"aria-valuemax":o,"aria-disabled":r?"true":null,"aria-valuenow":i},l&&h("div",{class:"range-pin",role:"presentation"},Math.round(i)),h("div",{class:"range-knob",role:"presentation"}))},ratioToValue=(t,e,i,n)=>{let s=(i-e)*t;return n>0&&(s=Math.round(s/n)*n+e),clamp(e,s,i)},valueToRatio=(t,e,i)=>clamp(0,(t-e)/(i-e),1),DURATION=540,getClonedElement=t=>document.querySelector(t+".ion-cloned-element"),shadow=t=>t.shadowRoot||t,getLargeTitle=t=>{const e="ION-TABS"===t.tagName?t:t.querySelector("ion-tabs"),i="ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";return null!=e?e.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)").querySelector(i):t.querySelector(i)},getBackButton=(t,e)=>{const i="ION-TABS"===t.tagName?t:t.querySelector("ion-tabs");let n=[];n=null!=i?i.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)").querySelectorAll("ion-buttons"):t.querySelectorAll("ion-buttons");for(const s of n){const t=s.closest("ion-header"),i=t&&!t.classList.contains("header-collapse-condense-inactive"),n=s.querySelector("ion-back-button"),o=s.classList.contains("buttons-collapse"),r="start"===s.slot||""===s.slot;if(null!==n&&r&&(o&&i&&e||!o))return n}return null},createLargeTitleTransition=(t,e,i,n,s)=>{const o=getBackButton(n,i),r=getLargeTitle(s),a=getLargeTitle(n),l=getBackButton(s,i),c=null!==o&&null!==r&&!i,h=null!==a&&null!==l&&i;if(c){const n=r.getBoundingClientRect(),s=o.getBoundingClientRect();animateLargeTitle(t,e,i,r,n,s),animateBackButton(t,e,i,o,n,s)}else if(h){const n=a.getBoundingClientRect(),s=l.getBoundingClientRect();animateLargeTitle(t,e,i,a,n,s),animateBackButton(t,e,i,l,n,s)}return{forward:c,backward:h}},animateBackButton=(t,e,i,n,s,o)=>{const r=e?`calc(100% - ${o.right+4}px)`:o.left-4+"px",a=e?"7px":"-7px",l=e?"-4px":"4px",c=e?"-4px":"4px",h=e?"right":"left",d=e?"left":"right",u=i?[{offset:0,opacity:1,transform:`translate3d(${l}, ${o.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${a}, ${s.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${a}, ${s.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${l}, ${o.top-46}px, 0) scale(1)`}],m=i?[{offset:0,opacity:1,transform:`translate3d(${c}, ${o.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${c}, ${o.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${c}, ${o.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${c}, ${o.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${c}, ${o.top-46}px, 0) scale(1)`}],p=createAnimation(),b=createAnimation(),f=getClonedElement("ion-back-button"),g=shadow(f).querySelector(".button-text"),y=shadow(f).querySelector("ion-icon");f.text=n.text,f.mode=n.mode,f.icon=n.icon,f.color=n.color,f.disabled=n.disabled,f.style.setProperty("display","block"),f.style.setProperty("position","fixed"),b.addElement(y),p.addElement(g),p.beforeStyles({"transform-origin":h+" center"}).beforeAddWrite(()=>{n.style.setProperty("display","none"),f.style.setProperty(h,r)}).afterAddWrite(()=>{n.style.setProperty("display",""),f.style.setProperty("display","none"),f.style.removeProperty(h)}).keyframes(u),b.beforeStyles({"transform-origin":d+" center"}).keyframes(m),t.addAnimation([p,b])},animateLargeTitle=(t,e,i,n,s,o)=>{const r=e?`calc(100% - ${s.right}px)`:s.left+"px",a=e?"-18px":"18px",l=e?"right":"left",c=i?[{offset:0,opacity:0,transform:`translate3d(${a}, ${o.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${s.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${s.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${a}, ${o.top-4}px, 0) scale(0.5)`}],h=getClonedElement("ion-title"),d=createAnimation();h.innerText=n.innerText,h.size=n.size,h.color=n.color,d.addElement(h),d.beforeStyles({"transform-origin":l+" center",height:"46px",display:"",position:"relative",[l]:r}).beforeAddWrite(()=>{n.style.setProperty("display","none")}).afterAddWrite(()=>{n.style.setProperty("display",""),h.style.setProperty("display","none")}).keyframes(c),t.addAnimation(d)},iosTransitionAnimation$1=(t,e)=>{try{const i="cubic-bezier(0.32,0.72,0,1)",n="opacity",s="transform",o="0%",r=.8,a="rtl"===t.ownerDocument.dir,l=a?"-99.5%":"99.5%",c=a?"33%":"-33%",h=e.enteringEl,d=e.leavingEl,u="back"===e.direction,m=h.querySelector(":scope > ion-content"),p=h.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),b=h.querySelectorAll(":scope > ion-header > ion-toolbar"),f=createAnimation(),g=createAnimation();if(f.addElement(h).duration(e.duration||DURATION).easing(e.easing||i).fill("both").beforeRemoveClass("ion-page-invisible"),d&&t){const e=createAnimation();e.addElement(t),f.addAnimation(e)}if(m||0!==b.length||0!==p.length?(g.addElement(m),g.addElement(p)):g.addElement(h.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),f.addAnimation(g),u?g.beforeClearStyles([n]).fromTo("transform",`translateX(${c})`,`translateX(${o})`).fromTo(n,r,1):g.beforeClearStyles([n]).fromTo("transform",`translateX(${l})`,`translateX(${o})`),m){const t=shadow(m).querySelector(".transition-effect");if(t){const e=t.querySelector(".transition-cover"),i=t.querySelector(".transition-shadow"),s=createAnimation(),o=createAnimation(),r=createAnimation();s.addElement(t).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),o.addElement(e).beforeClearStyles([n]).fromTo(n,0,.1),r.addElement(i).beforeClearStyles([n]).fromTo(n,.03,.7),s.addAnimation([o,r]),g.addAnimation([s])}}const y=h.querySelector("ion-header.header-collapse-condense"),{forward:v,backward:Z}=createLargeTitleTransition(f,a,u,h,d);if(b.forEach(t=>{const e=createAnimation();e.addElement(t),f.addAnimation(e);const i=createAnimation();i.addElement(t.querySelector("ion-title"));const s=createAnimation(),r=Array.from(t.querySelectorAll("ion-buttons,[menuToggle]")),h=t.closest("ion-header"),d=h&&h.classList.contains("header-collapse-condense-inactive");let m;m=r.filter(u?t=>{const e=t.classList.contains("buttons-collapse");return e&&!d||!e}:t=>!t.classList.contains("buttons-collapse")),s.addElement(m);const p=createAnimation();p.addElement(t.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const b=createAnimation();b.addElement(shadow(t).querySelector(".toolbar-background"));const g=createAnimation(),Z=t.querySelector("ion-back-button");if(Z&&g.addElement(Z),e.addAnimation([i,s,p,b,g]),s.fromTo(n,.01,1),p.fromTo(n,.01,1),u)d||i.fromTo("transform",`translateX(${c})`,`translateX(${o})`).fromTo(n,.01,1),p.fromTo("transform",`translateX(${c})`,`translateX(${o})`),g.fromTo(n,.01,1);else if(y||i.fromTo("transform",`translateX(${l})`,`translateX(${o})`).fromTo(n,.01,1),p.fromTo("transform",`translateX(${l})`,`translateX(${o})`),b.beforeClearStyles([n,"transform"]),(null==h?void 0:h.translucent)?b.fromTo("transform",a?"translateX(-100%)":"translateX(100%)","translateX(0px)"):b.fromTo(n,.01,1),v||g.fromTo(n,.01,1),Z&&!v){const t=createAnimation();t.addElement(shadow(Z).querySelector(".button-text")).fromTo("transform",a?"translateX(-100px)":"translateX(100px)","translateX(0px)"),e.addAnimation(t)}}),d){const t=createAnimation(),e=d.querySelector(":scope > ion-content");if(t.addElement(e),t.addElement(d.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *")),f.addAnimation(t),u){t.beforeClearStyles([n]).fromTo("transform",`translateX(${o})`,a?"translateX(-100%)":"translateX(100%)");const e=getIonPageElement(d);f.afterAddWrite(()=>{"normal"===f.getDirection()&&e.style.setProperty("display","none")})}else t.fromTo("transform",`translateX(${o})`,`translateX(${c})`).fromTo(n,1,r);if(e){const i=shadow(e).querySelector(".transition-effect");if(i){const e=i.querySelector(".transition-cover"),s=i.querySelector(".transition-shadow"),o=createAnimation(),r=createAnimation(),a=createAnimation();o.addElement(i).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),r.addElement(e).beforeClearStyles([n]).fromTo(n,.1,0),a.addElement(s).beforeClearStyles([n]).fromTo(n,.7,.03),o.addAnimation([r,a]),t.addAnimation([o])}}d.querySelectorAll(":scope > ion-header > ion-toolbar").forEach(t=>{const e=createAnimation();e.addElement(t);const i=createAnimation();i.addElement(t.querySelector("ion-title"));const r=createAnimation(),l=t.querySelectorAll("ion-buttons,[menuToggle]"),h=t.closest("ion-header"),d=h&&h.classList.contains("header-collapse-condense-inactive"),m=Array.from(l).filter(t=>{const e=t.classList.contains("buttons-collapse");return e&&!d||!e});r.addElement(m);const p=createAnimation(),b=t.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");b.length>0&&p.addElement(b);const g=createAnimation();g.addElement(shadow(t).querySelector(".toolbar-background"));const y=createAnimation(),v=t.querySelector("ion-back-button");if(v&&y.addElement(v),e.addAnimation([i,r,p,y,g]),f.addAnimation(e),y.fromTo(n,.99,0),r.fromTo(n,.99,0),p.fromTo(n,.99,0),u){if(d||i.fromTo("transform",`translateX(${o})`,a?"translateX(-100%)":"translateX(100%)").fromTo(n,.99,0),p.fromTo("transform",`translateX(${o})`,a?"translateX(-100%)":"translateX(100%)"),g.beforeClearStyles([n,"transform"]),(null==h?void 0:h.translucent)?g.fromTo("transform","translateX(0px)",a?"translateX(-100%)":"translateX(100%)"):g.fromTo(n,.99,0),v&&!Z){const t=createAnimation();t.addElement(shadow(v).querySelector(".button-text")).fromTo("transform",`translateX(${o})`,`translateX(${(a?-124:124)+"px"})`),e.addAnimation(t)}}else d||i.fromTo("transform",`translateX(${o})`,`translateX(${c})`).fromTo(n,.99,0).afterClearStyles([s,n]),p.fromTo("transform",`translateX(${o})`,`translateX(${c})`).afterClearStyles([s,n]),y.afterClearStyles([n]),i.afterClearStyles([n]),r.afterClearStyles([n])})}return f}catch(i){throw i}};var ios_transition=Object.freeze({__proto__:null,shadow,iosTransitionAnimation:iosTransitionAnimation$1});const mdTransitionAnimation$1=(t,e)=>{const i="back"===e.direction,n=e.leavingEl,s=getIonPageElement(e.enteringEl),o=s.querySelector("ion-toolbar"),r=createAnimation();if(r.addElement(s).fill("both").beforeRemoveClass("ion-page-invisible"),i?r.duration(e.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):r.duration(e.duration||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),o){const t=createAnimation();t.addElement(o),r.addAnimation(t)}if(n&&i){r.duration(e.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const t=createAnimation();t.addElement(getIonPageElement(n)).afterStyles({display:"none"}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),r.addAnimation(t)}return r};var md_transition=Object.freeze({__proto__:null,mdTransitionAnimation:mdTransitionAnimation$1});const HapticEngine={getEngine(){const t=window;return t.TapticEngine||t.Capacitor&&t.Capacitor.Plugins.Haptics},available(){return!!this.getEngine()},isCordova:()=>!!window.TapticEngine,isCapacitor:()=>!!window.Capacitor,impact(t){const e=this.getEngine();if(!e)return;const i=this.isCapacitor()?t.style.toUpperCase():t.style;e.impact({style:i})},notification(t){const e=this.getEngine();if(!e)return;const i=this.isCapacitor()?t.style.toUpperCase():t.style;e.notification({style:i})},selection(){this.impact({style:"light"})},selectionStart(){const t=this.getEngine();t&&(this.isCapacitor()?t.selectionStart():t.gestureSelectionStart())},selectionChanged(){const t=this.getEngine();t&&(this.isCapacitor()?t.selectionChanged():t.gestureSelectionChanged())},selectionEnd(){const t=this.getEngine();t&&(this.isCapacitor()?t.selectionChanged():t.gestureSelectionChanged())}},hapticImpact=t=>{HapticEngine.impact(t)},getRefresherAnimationType=t=>{const e=t.previousElementSibling;return null!==e&&"ION-HEADER"===e.tagName?"translate":"scale"},createPullingAnimation=(t,e)=>"scale"===t?createScaleAnimation(e):createTranslateAnimation(e),createBaseAnimation=t=>{const e=t.querySelector("ion-spinner"),i=e.shadowRoot.querySelector("circle"),n=t.querySelector(".spinner-arrow-container"),s=t.querySelector(".arrow-container"),o=s?s.querySelector("ion-icon"):null,r=createAnimation().duration(1e3).easing("ease-out"),a=createAnimation().addElement(n).keyframes([{offset:0,opacity:"0.3"},{offset:.45,opacity:"0.3"},{offset:.55,opacity:"1"},{offset:1,opacity:"1"}]),l=createAnimation().addElement(i).keyframes([{offset:0,strokeDasharray:"1px, 200px"},{offset:.2,strokeDasharray:"1px, 200px"},{offset:.55,strokeDasharray:"100px, 200px"},{offset:1,strokeDasharray:"100px, 200px"}]),c=createAnimation().addElement(e).keyframes([{offset:0,transform:"rotate(-90deg)"},{offset:1,transform:"rotate(210deg)"}]);if(s&&o){const t=createAnimation().addElement(s).keyframes([{offset:0,transform:"rotate(0deg)"},{offset:.3,transform:"rotate(0deg)"},{offset:.55,transform:"rotate(280deg)"},{offset:1,transform:"rotate(400deg)"}]),e=createAnimation().addElement(o).keyframes([{offset:0,transform:"translateX(2px) scale(0)"},{offset:.3,transform:"translateX(2px) scale(0)"},{offset:.55,transform:"translateX(-1.5px) scale(1)"},{offset:1,transform:"translateX(-1.5px) scale(1)"}]);r.addAnimation([t,e])}return r.addAnimation([a,l,c])},createScaleAnimation=t=>{const e=t.clientHeight,i=createAnimation().addElement(t).keyframes([{offset:0,transform:`scale(0) translateY(-${e+20}px)`},{offset:1,transform:"scale(1) translateY(100px)"}]);return createBaseAnimation(t).addAnimation([i])},createTranslateAnimation=t=>{const e=t.clientHeight,i=createAnimation().addElement(t).keyframes([{offset:0,transform:`translateY(-${e+20}px)`},{offset:1,transform:"translateY(100px)"}]);return createBaseAnimation(t).addAnimation([i])},createSnapBackAnimation=t=>createAnimation().duration(125).addElement(t).fromTo("transform","translateY(var(--ion-pulling-refresher-translate, 100px))","translateY(0px)"),setSpinnerOpacity=(t,e)=>{t.style.setProperty("opacity",e.toString())},handleScrollWhilePulling=(t,e,i,n)=>{writeTask(()=>{setSpinnerOpacity(t,i),e.forEach((t,e)=>t.style.setProperty("opacity",e<=n?"0.99":"0"))})},handleScrollWhileRefreshing=(t,e)=>{writeTask(()=>{t.style.setProperty("--refreshing-rotation-duration",e>=1?"0.5s":"2s"),t.style.setProperty("opacity","1")})},translateElement=(t,e)=>{if(!t)return Promise.resolve();const i=transitionEndAsync(t);return writeTask(()=>{t.style.setProperty("transition","0.2s all ease-out"),void 0===e?t.style.removeProperty("transform"):t.style.setProperty("transform",`translate3d(0px, ${e}, 0px)`)}),i},shouldUseNativeRefresher=(t,e)=>{const i=t.querySelector("ion-refresher-content .refresher-pulling ion-spinner"),n=t.querySelector("ion-refresher-content .refresher-refreshing ion-spinner");return null!==i&&null!==n&&("ios"===e&&isPlatform("mobile")&&void 0!==t.style.webkitOverflowScrolling||"md"===e)},transitionEndAsync=t=>new Promise(e=>{transitionEnd(t,e)}),transitionEnd=(t,e)=>{let i;const n={passive:!0},s=()=>{i&&i()},o=i=>{t===i.target&&(s(),e(i))};return t&&(t.addEventListener("webkitTransitionEnd",o,n),t.addEventListener("transitionend",o,n),i=()=>{t.removeEventListener("webkitTransitionEnd",o,n),t.removeEventListener("transitionend",o,n)}),s},refresherIosCss="ion-refresher{left:0;top:0;display:none;position:absolute;width:100%;height:60px;pointer-events:none;z-index:-1}[dir=rtl] ion-refresher,:host-context([dir=rtl]) ion-refresher{left:unset;right:unset;right:0}ion-refresher.refresher-active{display:block}ion-refresher-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;height:100%}.refresher-pulling,.refresher-refreshing{display:none;width:100%}.refresher-pulling-icon,.refresher-refreshing-icon{-webkit-transform-origin:center;transform-origin:center;-webkit-transition:200ms;transition:200ms;font-size:30px;text-align:center}[dir=rtl] .refresher-pulling-icon,:host-context([dir=rtl]) .refresher-pulling-icon,[dir=rtl] .refresher-refreshing-icon,:host-context([dir=rtl]) .refresher-refreshing-icon{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}.refresher-pulling-text,.refresher-refreshing-text{font-size:16px;text-align:center}ion-refresher-content .arrow-container{display:none}.refresher-pulling ion-refresher-content .refresher-pulling{display:block}.refresher-ready ion-refresher-content .refresher-pulling{display:block}.refresher-ready ion-refresher-content .refresher-pulling-icon{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.refresher-refreshing ion-refresher-content .refresher-refreshing{display:block}.refresher-cancelling ion-refresher-content .refresher-pulling{display:block}.refresher-cancelling ion-refresher-content .refresher-pulling-icon{-webkit-transform:scale(0);transform:scale(0)}.refresher-completing ion-refresher-content .refresher-refreshing{display:block}.refresher-completing ion-refresher-content .refresher-refreshing-icon{-webkit-transform:scale(0);transform:scale(0)}.refresher-native .refresher-pulling-text,.refresher-native .refresher-refreshing-text{display:none}.refresher-ios .refresher-pulling-icon,.refresher-ios .refresher-refreshing-icon{color:var(--ion-text-color, #000)}.refresher-ios .refresher-pulling-text,.refresher-ios .refresher-refreshing-text{color:var(--ion-text-color, #000)}.refresher-ios .refresher-refreshing .spinner-lines-ios line,.refresher-ios .refresher-refreshing .spinner-lines-small-ios line,.refresher-ios .refresher-refreshing .spinner-crescent circle{stroke:var(--ion-text-color, #000)}.refresher-ios .refresher-refreshing .spinner-bubbles circle,.refresher-ios .refresher-refreshing .spinner-circles circle,.refresher-ios .refresher-refreshing .spinner-dots circle{fill:var(--ion-text-color, #000)}ion-refresher.refresher-native{display:block;z-index:1}ion-refresher.refresher-native ion-spinner{margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-refresher.refresher-native ion-spinner{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.refresher-native .refresher-refreshing ion-spinner{--refreshing-rotation-duration:2s;display:none;-webkit-animation:var(--refreshing-rotation-duration) ease-out refresher-rotate forwards;animation:var(--refreshing-rotation-duration) ease-out refresher-rotate forwards}.refresher-native .refresher-refreshing{display:none;-webkit-animation:250ms linear refresher-pop forwards;animation:250ms linear refresher-pop forwards}.refresher-native.refresher-refreshing .refresher-pulling ion-spinner,.refresher-native.refresher-completing .refresher-pulling ion-spinner{display:none}.refresher-native.refresher-refreshing .refresher-refreshing ion-spinner,.refresher-native.refresher-completing .refresher-refreshing ion-spinner{display:block}.refresher-native.refresher-pulling .refresher-pulling ion-spinner{display:block}.refresher-native.refresher-pulling .refresher-refreshing ion-spinner{display:none}@-webkit-keyframes refresher-pop{0%{-webkit-transform:scale(1);transform:scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes refresher-pop{0%{-webkit-transform:scale(1);transform:scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:scale(1);transform:scale(1)}}@-webkit-keyframes refresher-rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}@keyframes refresher-rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(180deg);transform:rotate(180deg)}}",refresherMdCss="ion-refresher{left:0;top:0;display:none;position:absolute;width:100%;height:60px;pointer-events:none;z-index:-1}[dir=rtl] ion-refresher,:host-context([dir=rtl]) ion-refresher{left:unset;right:unset;right:0}ion-refresher.refresher-active{display:block}ion-refresher-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;height:100%}.refresher-pulling,.refresher-refreshing{display:none;width:100%}.refresher-pulling-icon,.refresher-refreshing-icon{-webkit-transform-origin:center;transform-origin:center;-webkit-transition:200ms;transition:200ms;font-size:30px;text-align:center}[dir=rtl] .refresher-pulling-icon,:host-context([dir=rtl]) .refresher-pulling-icon,[dir=rtl] .refresher-refreshing-icon,:host-context([dir=rtl]) .refresher-refreshing-icon{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}.refresher-pulling-text,.refresher-refreshing-text{font-size:16px;text-align:center}ion-refresher-content .arrow-container{display:none}.refresher-pulling ion-refresher-content .refresher-pulling{display:block}.refresher-ready ion-refresher-content .refresher-pulling{display:block}.refresher-ready ion-refresher-content .refresher-pulling-icon{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.refresher-refreshing ion-refresher-content .refresher-refreshing{display:block}.refresher-cancelling ion-refresher-content .refresher-pulling{display:block}.refresher-cancelling ion-refresher-content .refresher-pulling-icon{-webkit-transform:scale(0);transform:scale(0)}.refresher-completing ion-refresher-content .refresher-refreshing{display:block}.refresher-completing ion-refresher-content .refresher-refreshing-icon{-webkit-transform:scale(0);transform:scale(0)}.refresher-native .refresher-pulling-text,.refresher-native .refresher-refreshing-text{display:none}.refresher-md .refresher-pulling-icon,.refresher-md .refresher-refreshing-icon{color:var(--ion-text-color, #000)}.refresher-md .refresher-pulling-text,.refresher-md .refresher-refreshing-text{color:var(--ion-text-color, #000)}.refresher-md .refresher-refreshing .spinner-lines-md line,.refresher-md .refresher-refreshing .spinner-lines-small-md line,.refresher-md .refresher-refreshing .spinner-crescent circle{stroke:var(--ion-text-color, #000)}.refresher-md .refresher-refreshing .spinner-bubbles circle,.refresher-md .refresher-refreshing .spinner-circles circle,.refresher-md .refresher-refreshing .spinner-dots circle{fill:var(--ion-text-color, #000)}ion-refresher.refresher-native{display:block;z-index:1}ion-refresher.refresher-native ion-spinner{margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;width:24px;height:24px;color:var(--ion-color-primary, #3880ff)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-refresher.refresher-native ion-spinner{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}ion-refresher.refresher-native .spinner-arrow-container{display:inherit}ion-refresher.refresher-native .arrow-container{display:block;position:absolute;width:24px;height:24px}ion-refresher.refresher-native .arrow-container ion-icon{margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;left:0;right:0;bottom:-4px;position:absolute;color:var(--ion-color-primary, #3880ff);font-size:12px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-refresher.refresher-native .arrow-container ion-icon{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}ion-refresher.refresher-native.refresher-pulling ion-refresher-content .refresher-pulling,ion-refresher.refresher-native.refresher-ready ion-refresher-content .refresher-pulling{display:-ms-flexbox;display:flex}ion-refresher.refresher-native.refresher-refreshing ion-refresher-content .refresher-refreshing,ion-refresher.refresher-native.refresher-completing ion-refresher-content .refresher-refreshing,ion-refresher.refresher-native.refresher-cancelling ion-refresher-content .refresher-refreshing{display:-ms-flexbox;display:flex}ion-refresher.refresher-native .refresher-pulling-icon{-webkit-transform:translateY(calc(-100% - 10px));transform:translateY(calc(-100% - 10px))}ion-refresher.refresher-native .refresher-pulling-icon,ion-refresher.refresher-native .refresher-refreshing-icon{margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;border-radius:100%;padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;display:-ms-flexbox;display:flex;border:1px solid #ececec;background:white;-webkit-box-shadow:0px 1px 6px rgba(0, 0, 0, 0.1);box-shadow:0px 1px 6px rgba(0, 0, 0, 0.1)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-refresher.refresher-native .refresher-pulling-icon,ion-refresher.refresher-native .refresher-refreshing-icon{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-refresher.refresher-native .refresher-pulling-icon,ion-refresher.refresher-native .refresher-refreshing-icon{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}",Refresher=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.appliedStyles=!1,this.didStart=!1,this.progress=0,this.pointerDown=!1,this.needsCompletion=!1,this.didRefresh=!1,this.lastVelocityY=0,this.animations=[],this.nativeRefresher=!1,this.state=1,this.pullMin=60,this.pullMax=this.pullMin+60,this.closeDuration="280ms",this.snapbackDuration="280ms",this.pullFactor=1,this.disabled=!1,this.ionRefresh=createEvent(this,"ionRefresh",7),this.ionPull=createEvent(this,"ionPull",7),this.ionStart=createEvent(this,"ionStart",7)}disabledChanged(){this.gesture&&this.gesture.enable(!this.disabled)}checkNativeRefresher(){const t=shouldUseNativeRefresher(this.el,getIonMode(this));if(t&&!this.nativeRefresher){const t=this.el.closest("ion-content");this.setupNativeRefresher(t)}else t||this.destroyNativeRefresher()}destroyNativeRefresher(){this.scrollEl&&this.scrollListenerCallback&&(this.scrollEl.removeEventListener("scroll",this.scrollListenerCallback),this.scrollListenerCallback=void 0),this.nativeRefresher=!1}async resetNativeRefresher(t,e){this.state=e,"ios"===getIonMode(this)?await translateElement(t,void 0):await transitionEndAsync(this.el.querySelector(".refresher-refreshing-icon")),this.didRefresh=!1,this.needsCompletion=!1,this.pointerDown=!1,this.animations.forEach(t=>t.destroy()),this.animations=[],this.progress=0,this.state=1}async setupiOSNativeRefresher(t,e){this.elementToTransform=this.scrollEl;const i=t.shadowRoot.querySelectorAll("svg"),n=.16*this.scrollEl.clientHeight,s=i.length;writeTask(()=>i.forEach(t=>t.style.setProperty("animation","none"))),this.scrollListenerCallback=()=>{(this.pointerDown||1!==this.state)&&readTask(()=>{const o=this.scrollEl.scrollTop,r=this.el.clientHeight;if(o>0){if(8===this.state){const t=clamp(0,o/(.5*r),1);return void writeTask(()=>setSpinnerOpacity(e,1-t))}return void writeTask(()=>setSpinnerOpacity(t,0))}this.pointerDown&&(this.didStart||(this.didStart=!0,this.ionStart.emit()),this.pointerDown&&this.ionPull.emit());const a=clamp(0,Math.abs(o)/r,.99),l=this.progress=clamp(0,(Math.abs(o)-30)/n,1),c=clamp(0,Math.floor(l*s),s-1);8===this.state||c===s-1?(this.pointerDown&&handleScrollWhileRefreshing(e,this.lastVelocityY),this.didRefresh||(this.beginRefresh(),this.didRefresh=!0,hapticImpact({style:"light"}),this.pointerDown||translateElement(this.elementToTransform,r+"px"))):(this.state=2,handleScrollWhilePulling(t,i,a,c))})},this.scrollEl.addEventListener("scroll",this.scrollListenerCallback),this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.scrollEl,gestureName:"refresher",gesturePriority:10,direction:"y",threshold:5,onStart:()=>{this.pointerDown=!0,this.didRefresh||translateElement(this.elementToTransform,"0px")},onMove:t=>{this.lastVelocityY=t.velocityY},onEnd:()=>{this.pointerDown=!1,this.didStart=!1,this.needsCompletion?(this.resetNativeRefresher(this.elementToTransform,32),this.needsCompletion=!1):this.didRefresh&&readTask(()=>translateElement(this.elementToTransform,this.el.clientHeight+"px"))}}),this.disabledChanged()}async setupMDNativeRefresher(t,e,i){const n=e.shadowRoot.querySelector("circle"),s=this.el.querySelector("ion-refresher-content .refresher-pulling-icon"),o=i.shadowRoot.querySelector("circle");null!==n&&null!==o&&writeTask(()=>{n.style.setProperty("animation","none"),i.style.setProperty("animation-delay","-655ms"),o.style.setProperty("animation-delay","-655ms")}),this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.scrollEl,gestureName:"refresher",gesturePriority:10,direction:"y",threshold:5,canStart:()=>8!==this.state&&32!==this.state&&0===this.scrollEl.scrollTop,onStart:t=>{t.data={animation:void 0,didStart:!1,cancelled:!1}},onMove:e=>{if(e.velocityY<0&&0===this.progress&&!e.data.didStart||e.data.cancelled)e.data.cancelled=!0;else{if(!e.data.didStart)return e.data.didStart=!0,this.state=2,void writeTask(()=>{const i=getRefresherAnimationType(t),n=createPullingAnimation(i,s);e.data.animation=n,this.scrollEl.style.setProperty("--overflow","hidden"),n.progressStart(!1,0),this.ionStart.emit(),this.animations.push(n)});this.progress=clamp(0,e.deltaY/180*.5,1),e.data.animation.progressStep(this.progress),this.ionPull.emit()}},onEnd:t=>{if(!t.data.didStart)return;if(writeTask(()=>this.scrollEl.style.removeProperty("--overflow")),this.progress<=.4)return this.gesture.enable(!1),void t.data.animation.progressEnd(0,this.progress,500).onFinish(()=>{this.animations.forEach(t=>t.destroy()),this.animations=[],this.gesture.enable(!0),this.state=1});const e=getTimeGivenProgression([0,0],[0,0],[1,1],[1,1],this.progress)[0],i=createSnapBackAnimation(s);this.animations.push(i),writeTask(async()=>{s.style.setProperty("--ion-pulling-refresher-translate",100*e+"px"),t.data.animation.progressEnd(),await i.play(),this.beginRefresh(),t.data.animation.destroy()})}}),this.disabledChanged()}async setupNativeRefresher(t){if(this.scrollListenerCallback||!t||this.nativeRefresher||!this.scrollEl)return;this.nativeRefresher=!0;const e=this.el.querySelector("ion-refresher-content .refresher-pulling ion-spinner"),i=this.el.querySelector("ion-refresher-content .refresher-refreshing ion-spinner");"ios"===getIonMode(this)?this.setupiOSNativeRefresher(e,i):this.setupMDNativeRefresher(t,e,i)}componentDidUpdate(){this.checkNativeRefresher()}async connectedCallback(){if("fixed"!==this.el.getAttribute("slot"))return void console.error('Make sure you use: <ion-refresher slot="fixed">');const t=this.el.closest("ion-content");t?(this.scrollEl=await t.getScrollElement(),this.backgroundContentEl=t.shadowRoot.querySelector("#background-content"),shouldUseNativeRefresher(this.el,getIonMode(this))?this.setupNativeRefresher(t):(this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:t,gestureName:"refresher",gesturePriority:10,direction:"y",threshold:20,passive:!1,canStart:()=>this.canStart(),onStart:()=>this.onStart(),onMove:t=>this.onMove(t),onEnd:()=>this.onEnd()}),this.disabledChanged())):console.error("<ion-refresher> must be used inside an <ion-content>")}disconnectedCallback(){this.destroyNativeRefresher(),this.scrollEl=void 0,this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async complete(){this.nativeRefresher?(this.needsCompletion=!0,this.pointerDown||raf(()=>raf(()=>this.resetNativeRefresher(this.elementToTransform,32)))):this.close(32,"120ms")}async cancel(){this.nativeRefresher?this.pointerDown||raf(()=>raf(()=>this.resetNativeRefresher(this.elementToTransform,16))):this.close(16,"")}getProgress(){return Promise.resolve(this.progress)}canStart(){return!(!this.scrollEl||1!==this.state||this.scrollEl.scrollTop>0)}onStart(){this.progress=0,this.state=1}onMove(t){if(!this.scrollEl)return;const e=t.event;if(e.touches&&e.touches.length>1)return;if(0!=(56&this.state))return;const i=Number.isNaN(this.pullFactor)||this.pullFactor<0?1:this.pullFactor,n=t.deltaY*i;if(n<=0)return this.progress=0,this.state=1,this.appliedStyles?void this.setCss(0,"",!1,""):void 0;if(1===this.state){if(this.scrollEl.scrollTop>0)return void(this.progress=0);this.state=2}if(e.cancelable&&e.preventDefault(),this.setCss(n,"0ms",!0,""),0===n)return void(this.progress=0);const s=this.pullMin;this.progress=n/s,this.didStart||(this.didStart=!0,this.ionStart.emit()),this.ionPull.emit(),n<s?this.state=2:n>this.pullMax?this.beginRefresh():this.state=4}onEnd(){4===this.state?this.beginRefresh():2===this.state&&this.cancel()}beginRefresh(){this.state=8,this.setCss(this.pullMin,this.snapbackDuration,!0,""),this.ionRefresh.emit({complete:this.complete.bind(this)})}close(t,e){setTimeout(()=>{this.state=1,this.progress=0,this.didStart=!1,this.setCss(0,"0ms",!1,"")},600),this.state=t,this.setCss(0,this.closeDuration,!0,e)}setCss(t,e,i,n){this.nativeRefresher||(this.appliedStyles=t>0,writeTask(()=>{if(this.scrollEl&&this.backgroundContentEl){const s=this.scrollEl.style,o=this.backgroundContentEl.style;s.transform=o.transform=t>0?`translateY(${t}px) translateZ(0px)`:"",s.transitionDuration=o.transitionDuration=e,s.transitionDelay=o.transitionDelay=n,s.overflow=i?"hidden":""}}))}render(){const t=getIonMode(this);return h(Host,{slot:"fixed",class:{[t]:!0,["refresher-"+t]:!0,"refresher-native":this.nativeRefresher,"refresher-active":1!==this.state,"refresher-pulling":2===this.state,"refresher-ready":4===this.state,"refresher-refreshing":8===this.state,"refresher-cancelling":16===this.state,"refresher-completing":32===this.state}})}get el(){return this}static get watchers(){return{disabled:["disabledChanged"]}}static get style(){return{ios:refresherIosCss,md:refresherMdCss}}},spinners={bubbles:{dur:1e3,circles:9,fn:(t,e,i)=>{const n=t*e/i-t+"ms",s=2*Math.PI*e/i;return{r:5,style:{top:9*Math.sin(s)+"px",left:9*Math.cos(s)+"px","animation-delay":n}}}},circles:{dur:1e3,circles:8,fn:(t,e,i)=>{const n=e/i,s=t*n-t+"ms",o=2*Math.PI*n;return{r:5,style:{top:9*Math.sin(o)+"px",left:9*Math.cos(o)+"px","animation-delay":s}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(t,e)=>({r:6,style:{left:9-9*e+"px","animation-delay":-110*e+"ms"}})},lines:{dur:1e3,lines:12,fn:(t,e,i)=>({y1:17,y2:29,style:{transform:`rotate(${30*e+(e<6?180:-180)}deg)`,"animation-delay":t*e/i-t+"ms"}})},"lines-small":{dur:1e3,lines:12,fn:(t,e,i)=>({y1:12,y2:20,style:{transform:`rotate(${30*e+(e<6?180:-180)}deg)`,"animation-delay":t*e/i-t+"ms"}})}},SPINNERS=spinners,RefresherContent=class extends HTMLElement{constructor(){super(),this.__registerHost()}componentWillLoad(){if(void 0===this.pullingIcon){const t=getIonMode(this),e=void 0!==this.el.style.webkitOverflowScrolling?"lines":"arrow-down";this.pullingIcon=config.get("refreshingIcon","ios"===t&&isPlatform("mobile")?config.get("spinner",e):"circular")}if(void 0===this.refreshingSpinner){const t=getIonMode(this);this.refreshingSpinner=config.get("refreshingSpinner",config.get("spinner","ios"===t?"lines":"circular"))}}render(){const t=this.pullingIcon,e=null!=t&&void 0!==SPINNERS[t],i=getIonMode(this);return h(Host,{class:i},h("div",{class:"refresher-pulling"},this.pullingIcon&&e&&h("div",{class:"refresher-pulling-icon"},h("div",{class:"spinner-arrow-container"},h("ion-spinner",{name:this.pullingIcon,paused:!0}),"md"===i&&"circular"===this.pullingIcon&&h("div",{class:"arrow-container"},h("ion-icon",{name:"caret-back-sharp"})))),this.pullingIcon&&!e&&h("div",{class:"refresher-pulling-icon"},h("ion-icon",{icon:this.pullingIcon,lazy:!1})),this.pullingText&&h("div",{class:"refresher-pulling-text",innerHTML:sanitizeDOMString(this.pullingText)})),h("div",{class:"refresher-refreshing"},this.refreshingSpinner&&h("div",{class:"refresher-refreshing-icon"},h("ion-spinner",{name:this.refreshingSpinner})),this.refreshingText&&h("div",{class:"refresher-refreshing-text",innerHTML:sanitizeDOMString(this.refreshingText)})))}get el(){return this}},reorderIosCss=":host([slot]){display:none;line-height:0;z-index:100}.reorder-icon{display:block;font-size:22px}.reorder-icon{font-size:34px;opacity:0.4}",reorderMdCss=":host([slot]){display:none;line-height:0;z-index:100}.reorder-icon{display:block;font-size:22px}.reorder-icon{font-size:31px;opacity:0.3}",Reorder=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}onClick(t){t.preventDefault(),t.stopImmediatePropagation()}render(){const t=getIonMode(this);return h(Host,{class:t},h("slot",null,h("ion-icon",{name:"ios"===t?"reorder-three-outline":"reorder-two-sharp",lazy:!1,class:"reorder-icon"})))}static get style(){return{ios:reorderIosCss,md:reorderMdCss}}},reorderGroupCss=".reorder-list-active>*{-webkit-transition:-webkit-transform 300ms;transition:-webkit-transform 300ms;transition:transform 300ms;transition:transform 300ms, -webkit-transform 300ms;will-change:transform}.reorder-enabled{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.reorder-enabled ion-reorder{display:block;cursor:-webkit-grab;cursor:grab;pointer-events:all;-ms-touch-action:none;touch-action:none}.reorder-selected,.reorder-selected ion-reorder{cursor:-webkit-grabbing;cursor:grabbing}.reorder-selected{position:relative;-webkit-transition:none !important;transition:none !important;-webkit-box-shadow:0 0 10px rgba(0, 0, 0, 0.4);box-shadow:0 0 10px rgba(0, 0, 0, 0.4);opacity:0.8;z-index:100}.reorder-visible ion-reorder .reorder-icon{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}",ReorderGroup=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.lastToIndex=-1,this.cachedHeights=[],this.scrollElTop=0,this.scrollElBottom=0,this.scrollElInitial=0,this.containerTop=0,this.containerBottom=0,this.state=0,this.disabled=!0,this.ionItemReorder=createEvent(this,"ionItemReorder",7)}disabledChanged(){this.gesture&&this.gesture.enable(!this.disabled)}async connectedCallback(){const t=this.el.closest("ion-content");t&&(this.scrollEl=await t.getScrollElement()),this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.el,gestureName:"reorder",gesturePriority:110,threshold:0,direction:"y",passive:!1,canStart:t=>this.canStart(t),onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:()=>this.onEnd()}),this.disabledChanged()}disconnectedCallback(){this.onEnd(),this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}complete(t){return Promise.resolve(this.completeSync(t))}canStart(t){if(this.selectedItemEl||0!==this.state)return!1;const e=t.event.target.closest("ion-reorder");if(!e)return!1;const i=findReorderItem(e,this.el);return!!i&&(t.data=i,!0)}onStart(t){t.event.preventDefault();const e=this.selectedItemEl=t.data,i=this.cachedHeights;i.length=0;const n=this.el,s=n.children;if(!s||0===s.length)return;let o=0;for(let a=0;a<s.length;a++){const t=s[a];o+=t.offsetHeight,i.push(o),t.$ionIndex=a}const r=n.getBoundingClientRect();if(this.containerTop=r.top,this.containerBottom=r.bottom,this.scrollEl){const t=this.scrollEl.getBoundingClientRect();this.scrollElInitial=this.scrollEl.scrollTop,this.scrollElTop=t.top+AUTO_SCROLL_MARGIN,this.scrollElBottom=t.bottom-AUTO_SCROLL_MARGIN}else this.scrollElInitial=0,this.scrollElTop=0,this.scrollElBottom=0;this.lastToIndex=indexForItem(e),this.selectedItemHeight=e.offsetHeight,this.state=1,e.classList.add(ITEM_REORDER_SELECTED),hapticSelectionStart()}onMove(t){const e=this.selectedItemEl;if(!e)return;const i=this.autoscroll(t.currentY),n=this.containerTop-i,s=Math.max(n,Math.min(t.currentY,this.containerBottom-i)),o=i+s-t.startY,r=this.itemIndexForTop(s-n);if(r!==this.lastToIndex){const t=indexForItem(e);this.lastToIndex=r,hapticSelectionChanged(),this.reorderMove(t,r)}e.style.transform=`translateY(${o}px)`}onEnd(){const t=this.selectedItemEl;if(this.state=2,!t)return void(this.state=0);const e=this.lastToIndex,i=indexForItem(t);e===i?this.completeSync():this.ionItemReorder.emit({from:i,to:e,complete:this.completeSync.bind(this)}),hapticSelectionEnd()}completeSync(t){const e=this.selectedItemEl;if(e&&2===this.state){const i=this.el.children,n=i.length,s=this.lastToIndex,o=indexForItem(e);s===o||t&&!0!==t||this.el.insertBefore(e,o<s?i[s+1]:i[s]),Array.isArray(t)&&(t=reorderArray(t,o,s));for(let t=0;t<n;t++)i[t].style.transform="";e.style.transition="",e.classList.remove(ITEM_REORDER_SELECTED),this.selectedItemEl=void 0,this.state=0}return t}itemIndexForTop(t){const e=this.cachedHeights;let i=0;for(i=0;i<e.length&&!(e[i]>t);i++);return i}reorderMove(t,e){const i=this.selectedItemHeight,n=this.el.children;for(let s=0;s<n.length;s++){let o="";s>t&&s<=e?o=`translateY(${-i}px)`:s<t&&s>=e&&(o=`translateY(${i}px)`),n[s].style.transform=o}}autoscroll(t){if(!this.scrollEl)return 0;let e=0;return t<this.scrollElTop?e=-SCROLL_JUMP:t>this.scrollElBottom&&(e=SCROLL_JUMP),0!==e&&this.scrollEl.scrollBy(0,e),this.scrollEl.scrollTop-this.scrollElInitial}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"reorder-enabled":!this.disabled,"reorder-list-active":0!==this.state}})}get el(){return this}static get watchers(){return{disabled:["disabledChanged"]}}static get style(){return reorderGroupCss}},indexForItem=t=>t.$ionIndex,findReorderItem=(t,e)=>{let i;for(;t;){if(i=t.parentElement,i===e)return t;t=i}},AUTO_SCROLL_MARGIN=60,SCROLL_JUMP=10,ITEM_REORDER_SELECTED="reorder-selected",reorderArray=(t,e,i)=>{const n=t[e];return t.splice(e,1),t.splice(i,0,n),t.slice()},rippleEffectCss=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",RippleEffect=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.type="bounded"}async addRipple(t,e){return new Promise(i=>{readTask(()=>{const n=this.el.getBoundingClientRect(),s=n.width,o=n.height,r=Math.sqrt(s*s+o*o),a=Math.max(o,s),l=this.unbounded?a:r+PADDING,c=Math.floor(a*INITIAL_ORIGIN_SCALE),h=l/c;let d=t-n.left,u=e-n.top;this.unbounded&&(d=.5*s,u=.5*o);const m=d-.5*c,p=u-.5*c,b=.5*s-d,f=.5*o-u;writeTask(()=>{const t=document.createElement("div");t.classList.add("ripple-effect");const e=t.style;e.top=p+"px",e.left=m+"px",e.width=e.height=c+"px",e.setProperty("--final-scale",""+h),e.setProperty("--translate-end",`${b}px, ${f}px`),(this.el.shadowRoot||this.el).appendChild(t),setTimeout(()=>{i(()=>{removeRipple(t)})},325)})})})}get unbounded(){return"unbounded"===this.type}render(){const t=getIonMode(this);return h(Host,{role:"presentation",class:{[t]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return rippleEffectCss}},removeRipple=t=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},200)},PADDING=10,INITIAL_ORIGIN_SCALE=.5,Route=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.url="",this.ionRouteDataChanged=createEvent(this,"ionRouteDataChanged",7)}onUpdate(t){this.ionRouteDataChanged.emit(t)}onComponentProps(t,e){if(t===e)return;const i=t?Object.keys(t):[],n=e?Object.keys(e):[];if(i.length===n.length){for(const s of i)if(t[s]!==e[s])return void this.onUpdate(t)}else this.onUpdate(t)}connectedCallback(){this.ionRouteDataChanged.emit()}static get watchers(){return{url:["onUpdate"],component:["onUpdate"],componentProps:["onComponentProps"]}}},RouteRedirect=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.ionRouteRedirectChanged=createEvent(this,"ionRouteRedirectChanged",7)}propDidChange(){this.ionRouteRedirectChanged.emit()}connectedCallback(){this.ionRouteRedirectChanged.emit()}static get watchers(){return{from:["propDidChange"],to:["propDidChange"]}}},ROUTER_INTENT_NONE="root",ROUTER_INTENT_FORWARD="forward",ROUTER_INTENT_BACK="back",generatePath=t=>"/"+t.filter(t=>t.length>0).join("/"),chainToPath=t=>{const e=[];for(const i of t)for(const t of i.path)if(":"===t[0]){const n=i.params&&i.params[t.slice(1)];if(!n)return null;e.push(n)}else""!==t&&e.push(t);return e},writePath=(t,e,i,n,s,o)=>{let r=generatePath([...parsePath(e),...n]);i&&(r="#"+r),s===ROUTER_INTENT_FORWARD?t.pushState(o,"",r):t.replaceState(o,"",r)},removePrefix=(t,e)=>{if(t.length>e.length)return null;if(t.length<=1&&""===t[0])return e;for(let i=0;i<t.length;i++)if(t[i].length>0&&t[i]!==e[i])return null;return e.length===t.length?[""]:e.slice(t.length)},readPath=(t,e,i)=>{let n=t.pathname;if(i){const e=t.hash;n="#"===e[0]?e.slice(1):""}const s=parsePath(e),o=parsePath(n);return removePrefix(s,o)},parsePath=t=>{if(null==t)return[""];const e=t.split("/").map(t=>t.trim()).filter(t=>t.length>0);return 0===e.length?[""]:e},printRoutes=t=>{console.group(`[ion-core] ROUTES[${t.length}]`);for(const e of t){const t=[];e.forEach(e=>t.push(...e.path));const i=e.map(t=>t.id);console.debug("%c "+generatePath(t),"font-weight: bold; padding-left: 20px","=>\t",`(${i.join(", ")})`)}console.groupEnd()},printRedirects=t=>{console.group(`[ion-core] REDIRECTS[${t.length}]`);for(const e of t)e.to&&console.debug("FROM: ","$c "+generatePath(e.from),"font-weight: bold"," TO: ","$c "+generatePath(e.to),"font-weight: bold");console.groupEnd()},writeNavState=async(t,i,n,s,o=!1)=>{try{const e=searchNavNode(t);if(s>=i.length||!e)return o;await e.componentOnReady();const r=i[s],a=await e.setRouteId(r.id,r.params,n);return a.changed&&(n=ROUTER_INTENT_NONE,o=!0),o=await writeNavState(a.element,i,n,s+1,o),a.markVisible&&await a.markVisible(),o}catch(e){return console.error(e),!1}},readNavState=async t=>{const e=[];let i,n=t;for(;i=searchNavNode(n),i;){const t=await i.getRouteId();if(!t)break;n=t.element,t.element=void 0,e.push(t)}return{ids:e,outlet:i}},waitUntilNavNode=()=>searchNavNode(document.body)?Promise.resolve():new Promise(t=>{window.addEventListener("ionNavWillLoad",t,{once:!0})}),QUERY=":not([no-router]) ion-nav, :not([no-router]) ion-tabs, :not([no-router]) ion-router-outlet",searchNavNode=t=>{if(!t)return;if(t.matches(QUERY))return t;return t.querySelector(QUERY)||void 0},matchesRedirect=(t,e)=>{const{from:i,to:n}=e;if(void 0===n)return!1;if(i.length>t.length)return!1;for(let s=0;s<i.length;s++){const e=i[s];if("*"===e)return!0;if(e!==t[s])return!1}return i.length===t.length},routeRedirect=(t,e)=>e.find(e=>matchesRedirect(t,e)),matchesIDs=(t,e)=>{const i=Math.min(t.length,e.length);let n=0;for(;n<i&&t[n].toLowerCase()===e[n].id;n++);return n},matchesPath=(t,e)=>{const i=new RouterSegments(t);let n,s=!1;for(let o=0;o<e.length;o++){const t=e[o].path;if(""===t[0])s=!0;else{for(const e of t){const t=i.next();if(":"===e[0]){if(""===t)return null;n=n||[],(n[o]||(n[o]={}))[e.slice(1)]=t}else if(t!==e)return null}s=!1}}return s&&s!==(""===i.next())?null:n?e.map((t,e)=>({id:t.id,path:t.path,params:mergeParams(t.params,n[e])})):e},mergeParams=(t,e)=>!t&&e?e:t&&!e?t:t&&e?Object.assign(Object.assign({},t),e):void 0,routerIDsToChain=(t,e)=>{let i=null,n=0;const s=t.map(t=>t.id);for(const o of e){const t=matchesIDs(s,o);t>n&&(i=o,n=t)}return i?i.map((e,i)=>({id:e.id,path:e.path,params:mergeParams(e.params,t[i]&&t[i].params)})):null},routerPathToChain=(t,e)=>{let i=null,n=0;for(const s of e){const e=matchesPath(t,s);if(null!==e){const t=computePriority(e);t>n&&(n=t,i=e)}}return i},computePriority=t=>{let e=1,i=1;for(const n of t)for(const t of n.path)":"===t[0]?e+=Math.pow(1,i):""!==t&&(e+=Math.pow(2,i)),i++;return e};class RouterSegments{constructor(t){this.path=t.slice()}next(){return this.path.length>0?this.path.shift():""}}const readRedirects=t=>Array.from(t.children).filter(t=>"ION-ROUTE-REDIRECT"===t.tagName).map(t=>{const e=readProp(t,"to");return{from:parsePath(readProp(t,"from")),to:null==e?void 0:parsePath(e)}}),readRoutes=t=>flattenRouterTree(readRouteNodes(t)),readRouteNodes=(t,e=t)=>Array.from(e.children).filter(t=>"ION-ROUTE"===t.tagName&&t.component).map(e=>{const i=readProp(e,"component");if(null==i)throw new Error("component missing in ion-route");return{path:parsePath(readProp(e,"url")),id:i.toLowerCase(),params:e.componentProps,children:readRouteNodes(t,e)}}),readProp=(t,e)=>e in t?t[e]:t.hasAttribute(e)?t.getAttribute(e):null,flattenRouterTree=t=>{const e=[];for(const i of t)flattenNode([],e,i);return e},flattenNode=(t,e,i)=>{const n=t.slice();if(n.push({id:i.id,path:i.path,params:i.params}),0!==i.children.length)for(const s of i.children)flattenNode(n,e,s);else e.push(n)},Router=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.previousPath=null,this.busy=!1,this.state=0,this.lastState=0,this.root="/",this.useHash=!0,this.ionRouteWillChange=createEvent(this,"ionRouteWillChange",7),this.ionRouteDidChange=createEvent(this,"ionRouteDidChange",7)}async componentWillLoad(){console.debug("[ion-router] router will load"),await waitUntilNavNode(),console.debug("[ion-router] found nav"),await this.onRoutesChanged()}componentDidLoad(){window.addEventListener("ionRouteRedirectChanged",debounce(this.onRedirectChanged.bind(this),10)),window.addEventListener("ionRouteDataChanged",debounce(this.onRoutesChanged.bind(this),100))}onPopState(){const t=this.historyDirection(),e=this.getPath();return console.debug("[ion-router] URL changed -> update nav",e,t),this.writeNavStateRoot(e,t)}onBackButton(t){t.detail.register(0,()=>this.back())}push(t,e="forward"){t.startsWith(".")&&(t=new URL(t,window.location.href).pathname),console.debug("[ion-router] URL pushed -> updating nav",t,e);const i=parsePath(t);return this.setPath(i,e),this.writeNavStateRoot(i,e)}back(){return window.history.back(),Promise.resolve(this.waitPromise)}async printDebug(){console.debug("CURRENT PATH",this.getPath()),console.debug("PREVIOUS PATH",this.previousPath),printRoutes(readRoutes(this.el)),printRedirects(readRedirects(this.el))}async navChanged(t){if(this.busy)return console.warn("[ion-router] router is busy, navChanged was cancelled"),!1;const{ids:e,outlet:i}=await readNavState(window.document.body),n=readRoutes(this.el),s=routerIDsToChain(e,n);if(!s)return console.warn("[ion-router] no matching URL for ",e.map(t=>t.id)),!1;const o=chainToPath(s);return o?(console.debug("[ion-router] nav changed -> update URL",e,o),this.setPath(o,t),await this.safeWriteNavState(i,s,ROUTER_INTENT_NONE,o,null,e.length),!0):(console.warn("[ion-router] router could not match path because some required param is missing"),!1)}onRedirectChanged(){const t=this.getPath();t&&routeRedirect(t,readRedirects(this.el))&&this.writeNavStateRoot(t,ROUTER_INTENT_NONE)}onRoutesChanged(){return this.writeNavStateRoot(this.getPath(),ROUTER_INTENT_NONE)}historyDirection(){const t=window;null===t.history.state&&(this.state++,t.history.replaceState(this.state,t.document.title,t.document.location&&t.document.location.href));const e=t.history.state,i=this.lastState;return this.lastState=e,e>i?ROUTER_INTENT_FORWARD:e<i?ROUTER_INTENT_BACK:ROUTER_INTENT_NONE}async writeNavStateRoot(t,e){if(!t)return console.error("[ion-router] URL is not part of the routing set"),!1;const i=readRedirects(this.el),n=routeRedirect(t,i);let s=null;n&&(this.setPath(n.to,e),s=n.from,t=n.to);const o=readRoutes(this.el),r=routerPathToChain(t,o);return r?this.safeWriteNavState(document.body,r,e,t,s):(console.error("[ion-router] the path does not match any route"),!1)}async safeWriteNavState(t,i,n,s,o,r=0){const a=await this.lock();let l=!1;try{l=await this.writeNavState(t,i,n,s,o,r)}catch(e){console.error(e)}return a(),l}async lock(){const t=this.waitPromise;let e;return this.waitPromise=new Promise(t=>e=t),void 0!==t&&await t,e}async writeNavState(t,e,i,n,s,o=0){if(this.busy)return console.warn("[ion-router] router is busy, transition was cancelled"),!1;this.busy=!0;const r=this.routeChangeEvent(n,s);r&&this.ionRouteWillChange.emit(r);const a=await writeNavState(t,e,i,o);return this.busy=!1,a&&console.debug("[ion-router] route changed",n),r&&this.ionRouteDidChange.emit(r),a}setPath(t,e){this.state++,writePath(window.history,this.root,this.useHash,t,e,this.state)}getPath(){return readPath(window.location,this.root,this.useHash)}routeChangeEvent(t,e){const i=this.previousPath,n=generatePath(t);return this.previousPath=n,n===i?null:{from:i,redirectedFrom:e?generatePath(e):null,to:n}}get el(){return this}},routerLinkCss=":host{--background:transparent;--color:var(--ion-color-primary, #3880ff);background:var(--background);color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}a{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit}",RouterLink=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.routerDirection="forward",this.onClick=t=>{openURL(this.href,t,this.routerDirection)}}render(){const t=getIonMode(this),e={href:this.href,rel:this.rel,target:this.target};return h(Host,{onClick:this.onClick,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0,"ion-activatable":!0})},h("a",Object.assign({},e),h("slot",null)))}static get style(){return routerLinkCss}},routeOutletCss=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}",RouterOutlet=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.animationEnabled=!0,this.mode=getIonMode(this),this.animated=!0,this.ionNavWillLoad=createEvent(this,"ionNavWillLoad",7),this.ionNavWillChange=createEvent(this,"ionNavWillChange",3),this.ionNavDidChange=createEvent(this,"ionNavDidChange",3)}swipeHandlerChanged(){this.gesture&&this.gesture.enable(void 0!==this.swipeHandler)}async connectedCallback(){this.gesture=(await import("./p-28cdd47a.mjs")).createSwipeBackGesture(this.el,()=>!!this.swipeHandler&&this.swipeHandler.canStart()&&this.animationEnabled,()=>this.swipeHandler&&this.swipeHandler.onStart(),t=>this.ani&&this.ani.progressStep(t),(t,e,i)=>{if(this.ani){this.animationEnabled=!1,this.ani.onFinish(()=>{this.animationEnabled=!0,this.swipeHandler&&this.swipeHandler.onEnd(t)},{oneTimeCallback:!0});let n=t?-.001:.001;t?n+=getTimeGivenProgression([0,0],[.32,.72],[0,1],[1,1],e)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),n+=getTimeGivenProgression([0,0],[1,0],[.68,.28],[1,1],e)[0]),this.ani.progressEnd(t?1:0,n,i)}}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(t,i,n){const s=await this.lock();let o=!1;try{o=await this.transition(t,i,n)}catch(e){console.error(e)}return s(),o}async setRouteId(t,e,i){return{changed:await this.setRoot(t,e,{duration:"root"===i?0:void 0,direction:"back"===i?"back":"forward"}),element:this.activeEl}}async getRouteId(){const t=this.activeEl;return t?{id:t.tagName,element:t}:void 0}async setRoot(t,e,i){if(this.activeComponent===t)return!1;const n=this.activeEl,s=await attachComponent(this.delegate,this.el,t,["ion-page","ion-page-invisible"],e);return this.activeComponent=t,this.activeEl=s,await this.commit(s,n,i),await detachComponent(this.delegate,n),!0}async transition(t,e,i={}){if(e===t)return!1;this.ionNavWillChange.emit();const{el:n,mode:s}=this,o=this.animated&&config.getBoolean("animated",!0),r=this.animation||i.animationBuilder||config.get("navAnimation");return await transition(Object.assign({mode:s,animated:o,animationBuilder:r,enteringEl:t,leavingEl:e,baseEl:n,progressCallback:i.progressAnimation?t=>this.ani=t:void 0},i)),this.ionNavDidChange.emit(),!0}async lock(){const t=this.waitPromise;let e;return this.waitPromise=new Promise(t=>e=t),void 0!==t&&await t,e}render(){return h("slot",null)}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return routeOutletCss}},rowCss=":host{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}",Row=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h(Host,{class:getIonMode(this)},h("slot",null))}static get style(){return rowCss}},searchbarIosCss=".sc-ion-searchbar-ios-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;width:100%;color:var(--color);font-family:var(--ion-font-family, inherit);-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-searchbar-ios-h{color:var(--ion-color-contrast)}.ion-color.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{background:var(--ion-color-base)}.ion-color.sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios,.ion-color.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios,.ion-color.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{color:inherit}.searchbar-search-icon.sc-ion-searchbar-ios{color:var(--icon-color);pointer-events:none}.searchbar-input-container.sc-ion-searchbar-ios{display:block;position:relative;-ms-flex-negative:1;flex-shrink:1;width:100%}.searchbar-input.sc-ion-searchbar-ios{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;width:100%;border:0;outline:none;background:var(--background);font-family:inherit;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-input.sc-ion-searchbar-ios::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::-webkit-search-cancel-button,.searchbar-input.sc-ion-searchbar-ios::-ms-clear{display:none}.searchbar-cancel-button.sc-ion-searchbar-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:none;height:100%;border:0;outline:none;color:var(--cancel-button-color);cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-cancel-button.sc-ion-searchbar-ios>div.sc-ion-searchbar-ios{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.searchbar-clear-button.sc-ion-searchbar-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:none;min-height:0;outline:none;color:var(--clear-button-color);-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-has-value.searchbar-has-focus.sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios{display:block}.searchbar-disabled.sc-ion-searchbar-ios-h{cursor:default;opacity:0.4;pointer-events:none}.sc-ion-searchbar-ios-h{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.07);--box-shadow:none;--cancel-button-color:var(--ion-color-primary, #3880ff);--clear-button-color:var(--ion-color-step-600, #666666);--color:var(--ion-text-color, #000);--icon-color:var(--ion-color-step-600, #666666);padding-left:12px;padding-right:12px;padding-top:12px;padding-bottom:12px;height:60px;contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-searchbar-ios-h{padding-left:unset;padding-right:unset;-webkit-padding-start:12px;padding-inline-start:12px;-webkit-padding-end:12px;padding-inline-end:12px}}.searchbar-input-container.sc-ion-searchbar-ios{height:36px}.searchbar-search-icon.sc-ion-searchbar-ios{margin-left:calc(50% - 60px);left:5px;top:0;position:absolute;width:22px;height:100%;contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-search-icon.sc-ion-searchbar-ios{margin-left:unset;-webkit-margin-start:calc(50% - 60px);margin-inline-start:calc(50% - 60px)}}[dir=rtl].sc-ion-searchbar-ios .searchbar-search-icon.sc-ion-searchbar-ios,[dir=rtl].sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios,[dir=rtl] .sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{left:unset;right:unset;right:5px}.searchbar-input.sc-ion-searchbar-ios{padding-left:28px;padding-right:28px;padding-top:0;padding-bottom:0;border-radius:10px;height:100%;font-size:17px;font-weight:400;contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-input.sc-ion-searchbar-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:28px;padding-inline-start:28px;-webkit-padding-end:28px;padding-inline-end:28px}}.searchbar-clear-button.sc-ion-searchbar-ios{right:0;top:0;background-position:center;position:absolute;width:30px;height:100%;border:0;background-color:transparent}[dir=rtl].sc-ion-searchbar-ios .searchbar-clear-button.sc-ion-searchbar-ios,[dir=rtl].sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios,[dir=rtl] .sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios{left:unset;right:unset;left:0}.searchbar-clear-icon.sc-ion-searchbar-ios{width:18px;height:100%}.searchbar-cancel-button.sc-ion-searchbar-ios{padding-left:8px;padding-right:0;padding-top:0;padding-bottom:0;-ms-flex-negative:0;flex-shrink:0;background-color:transparent;font-size:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-cancel-button.sc-ion-searchbar-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:0;padding-inline-end:0}}.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{margin-left:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{margin-left:unset;-webkit-margin-start:0;margin-inline-start:0}}.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{padding-left:30px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{padding-left:unset;-webkit-padding-start:30px;padding-inline-start:30px}}.searchbar-has-focus.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios,.searchbar-should-show-cancel.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios,.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{display:block}.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios,.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{-webkit-transition:all 300ms ease;transition:all 300ms ease}.searchbar-animated.searchbar-has-focus.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios,.searchbar-animated.searchbar-should-show-cancel.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{opacity:1;pointer-events:auto}.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{margin-right:-100%;-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);-webkit-transition:all 300ms ease;transition:all 300ms ease;opacity:0;pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{margin-right:unset;-webkit-margin-end:-100%;margin-inline-end:-100%}}.searchbar-no-animate.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios,.searchbar-no-animate.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios,.searchbar-no-animate.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{-webkit-transition-duration:0ms;transition-duration:0ms}.ion-color.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{color:var(--ion-color-base)}@media (any-hover: hover){.ion-color.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios:hover{color:var(--ion-color-tint)}}ion-toolbar.sc-ion-searchbar-ios-h,ion-toolbar .sc-ion-searchbar-ios-h{padding-top:1px;padding-bottom:15px;height:52px}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color),ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color){color:inherit}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-cancel-button.sc-ion-searchbar-ios,ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-cancel-button.sc-ion-searchbar-ios{color:currentColor}ion-toolbar.ion-color.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios,ion-toolbar.ion-color .sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{color:currentColor;opacity:0.5}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-input.sc-ion-searchbar-ios,ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-input.sc-ion-searchbar-ios{background:rgba(var(--ion-color-contrast-rgb), 0.07);color:currentColor}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-clear-button.sc-ion-searchbar-ios,ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-clear-button.sc-ion-searchbar-ios{color:currentColor;opacity:0.5}",searchbarMdCss=".sc-ion-searchbar-md-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;width:100%;color:var(--color);font-family:var(--ion-font-family, inherit);-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-searchbar-md-h{color:var(--ion-color-contrast)}.ion-color.sc-ion-searchbar-md-h .searchbar-input.sc-ion-searchbar-md{background:var(--ion-color-base)}.ion-color.sc-ion-searchbar-md-h .searchbar-clear-button.sc-ion-searchbar-md,.ion-color.sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md,.ion-color.sc-ion-searchbar-md-h .searchbar-search-icon.sc-ion-searchbar-md{color:inherit}.searchbar-search-icon.sc-ion-searchbar-md{color:var(--icon-color);pointer-events:none}.searchbar-input-container.sc-ion-searchbar-md{display:block;position:relative;-ms-flex-negative:1;flex-shrink:1;width:100%}.searchbar-input.sc-ion-searchbar-md{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;width:100%;border:0;outline:none;background:var(--background);font-family:inherit;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-input.sc-ion-searchbar-md::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-md::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-md:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-md::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-md::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-md::-webkit-search-cancel-button,.searchbar-input.sc-ion-searchbar-md::-ms-clear{display:none}.searchbar-cancel-button.sc-ion-searchbar-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:none;height:100%;border:0;outline:none;color:var(--cancel-button-color);cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-cancel-button.sc-ion-searchbar-md>div.sc-ion-searchbar-md{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.searchbar-clear-button.sc-ion-searchbar-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:none;min-height:0;outline:none;color:var(--clear-button-color);-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-has-value.searchbar-has-focus.sc-ion-searchbar-md-h .searchbar-clear-button.sc-ion-searchbar-md{display:block}.searchbar-disabled.sc-ion-searchbar-md-h{cursor:default;opacity:0.4;pointer-events:none}.sc-ion-searchbar-md-h{--background:var(--ion-background-color, #fff);--box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);--cancel-button-color:var(--ion-color-step-900, #1a1a1a);--clear-button-color:initial;--color:var(--ion-color-step-850, #262626);--icon-color:var(--ion-color-step-600, #666666);padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;background:inherit}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.sc-ion-searchbar-md-h{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.searchbar-search-icon.sc-ion-searchbar-md{left:16px;top:11px;width:21px;height:21px}[dir=rtl].sc-ion-searchbar-md .searchbar-search-icon.sc-ion-searchbar-md,[dir=rtl].sc-ion-searchbar-md-h .searchbar-search-icon.sc-ion-searchbar-md,[dir=rtl] .sc-ion-searchbar-md-h .searchbar-search-icon.sc-ion-searchbar-md{left:unset;right:unset;right:16px}.searchbar-cancel-button.sc-ion-searchbar-md{left:5px;top:0;background-color:transparent;font-size:1.6em}[dir=rtl].sc-ion-searchbar-md .searchbar-cancel-button.sc-ion-searchbar-md,[dir=rtl].sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md,[dir=rtl] .sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md{left:unset;right:unset;right:5px}.searchbar-search-icon.sc-ion-searchbar-md,.searchbar-cancel-button.sc-ion-searchbar-md{position:absolute}.searchbar-search-icon.ion-activated.sc-ion-searchbar-md,.searchbar-cancel-button.ion-activated.sc-ion-searchbar-md{background-color:transparent}.searchbar-input.sc-ion-searchbar-md{padding-left:55px;padding-right:55px;padding-top:6px;padding-bottom:6px;border-radius:2px;background-position:left 8px center;height:auto;font-size:16px;font-weight:400;line-height:30px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.searchbar-input.sc-ion-searchbar-md{padding-left:unset;padding-right:unset;-webkit-padding-start:55px;padding-inline-start:55px;-webkit-padding-end:55px;padding-inline-end:55px}}[dir=rtl].sc-ion-searchbar-md .searchbar-input.sc-ion-searchbar-md,[dir=rtl].sc-ion-searchbar-md-h .searchbar-input.sc-ion-searchbar-md,[dir=rtl] .sc-ion-searchbar-md-h .searchbar-input.sc-ion-searchbar-md{background-position:right 8px center}.searchbar-clear-button.sc-ion-searchbar-md{right:13px;top:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;position:absolute;height:100%;border:0;background-color:transparent}[dir=rtl].sc-ion-searchbar-md .searchbar-clear-button.sc-ion-searchbar-md,[dir=rtl].sc-ion-searchbar-md-h .searchbar-clear-button.sc-ion-searchbar-md,[dir=rtl] .sc-ion-searchbar-md-h .searchbar-clear-button.sc-ion-searchbar-md{left:unset;right:unset;left:13px}.searchbar-clear-button.ion-activated.sc-ion-searchbar-md{background-color:transparent}.searchbar-clear-icon.sc-ion-searchbar-md{width:22px;height:100%}.searchbar-has-focus.sc-ion-searchbar-md-h .searchbar-search-icon.sc-ion-searchbar-md{display:block}.searchbar-has-focus.sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md,.searchbar-should-show-cancel.sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md{display:block}.searchbar-has-focus.sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md+.searchbar-search-icon.sc-ion-searchbar-md,.searchbar-should-show-cancel.sc-ion-searchbar-md-h .searchbar-cancel-button.sc-ion-searchbar-md+.searchbar-search-icon.sc-ion-searchbar-md{display:none}ion-toolbar.sc-ion-searchbar-md-h,ion-toolbar .sc-ion-searchbar-md-h{padding-left:7px;padding-right:7px;padding-top:3px;padding-bottom:3px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){ion-toolbar.sc-ion-searchbar-md-h,ion-toolbar .sc-ion-searchbar-md-h{padding-left:unset;padding-right:unset;-webkit-padding-start:7px;padding-inline-start:7px;-webkit-padding-end:7px;padding-inline-end:7px}}",Searchbar=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.isCancelVisible=!1,this.shouldAlignLeft=!0,this.focused=!1,this.noAnimate=!0,this.animated=!1,this.autocomplete="off",this.autocorrect="off",this.cancelButtonIcon=config.get("backButtonIcon","arrow-back-sharp"),this.cancelButtonText="Cancel",this.debounce=250,this.disabled=!1,this.placeholder="Search",this.showCancelButton="never",this.spellcheck=!1,this.type="search",this.value="",this.onClearInput=t=>{this.ionClear.emit(),t&&(t.preventDefault(),t.stopPropagation()),setTimeout(()=>{""!==this.getValue()&&(this.value="",this.ionInput.emit())},64)},this.onCancelSearchbar=t=>{t&&(t.preventDefault(),t.stopPropagation()),this.ionCancel.emit(),this.onClearInput(),this.nativeInput&&this.nativeInput.blur()},this.onInput=t=>{const e=t.target;e&&(this.value=e.value),this.ionInput.emit(t)},this.onBlur=()=>{this.focused=!1,this.ionBlur.emit(),this.positionElements()},this.onFocus=()=>{this.focused=!0,this.ionFocus.emit(),this.positionElements()},this.ionInput=createEvent(this,"ionInput",7),this.ionChange=createEvent(this,"ionChange",7),this.ionCancel=createEvent(this,"ionCancel",7),this.ionClear=createEvent(this,"ionClear",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionStyle=createEvent(this,"ionStyle",7)}debounceChanged(){this.ionChange=debounceEvent(this.ionChange,this.debounce)}valueChanged(){const t=this.nativeInput,e=this.getValue();t&&t.value!==e&&(t.value=e),this.ionChange.emit({value:e})}showCancelButtonChanged(){requestAnimationFrame(()=>{this.positionElements(),forceUpdate(this)})}connectedCallback(){this.emitStyle()}componentDidLoad(){this.positionElements(),this.debounceChanged(),setTimeout(()=>{this.noAnimate=!1},300)}emitStyle(){this.ionStyle.emit({searchbar:!0})}async setFocus(){this.nativeInput&&this.nativeInput.focus()}getInputElement(){return Promise.resolve(this.nativeInput)}positionElements(){const t=this.getValue(),e=this.shouldAlignLeft,i=getIonMode(this),n=!this.animated||""!==t.trim()||!!this.focused;this.shouldAlignLeft=n,"ios"===i&&(e!==n&&this.positionPlaceholder(),this.animated&&this.positionCancelButton())}positionPlaceholder(){const t=this.nativeInput;if(!t)return;const e="rtl"===document.dir,i=(this.el.shadowRoot||this.el).querySelector(".searchbar-search-icon");if(this.shouldAlignLeft)t.removeAttribute("style"),i.removeAttribute("style");else{const n=document,s=n.createElement("span");s.innerText=this.placeholder||"",n.body.appendChild(s),raf(()=>{const n=s.offsetWidth;s.remove();const o="calc(50% - "+n/2+"px)",r="calc(50% - "+(n/2+30)+"px)";e?(t.style.paddingRight=o,i.style.marginRight=r):(t.style.paddingLeft=o,i.style.marginLeft=r)})}}positionCancelButton(){const t="rtl"===document.dir,e=(this.el.shadowRoot||this.el).querySelector(".searchbar-cancel-button"),i=this.shouldShowCancelButton();if(e&&i!==this.isCancelVisible){const n=e.style;if(this.isCancelVisible=i,i)t?n.marginLeft="0":n.marginRight="0";else{const i=e.offsetWidth;i>0&&(t?n.marginLeft=-i+"px":n.marginRight=-i+"px")}}}getValue(){return this.value||""}hasValue(){return""!==this.getValue()}shouldShowCancelButton(){return!("never"===this.showCancelButton||"focus"===this.showCancelButton&&!this.focused)}render(){const t=this.animated&&config.getBoolean("animated",!0),e=getIonMode(this),i=this.clearIcon||("ios"===e?"close-circle":"close-sharp"),n=this.searchIcon||("ios"===e?"search-outline":"search-sharp"),s="never"!==this.showCancelButton&&h("button",{"aria-label":"cancel",type:"button",tabIndex:"ios"!==e||this.shouldShowCancelButton()?void 0:-1,onMouseDown:this.onCancelSearchbar,onTouchStart:this.onCancelSearchbar,class:"searchbar-cancel-button"},h("div",null,"md"===e?h("ion-icon",{"aria-hidden":"true",mode:e,icon:this.cancelButtonIcon,lazy:!1}):this.cancelButtonText));return h(Host,{role:"search","aria-disabled":this.disabled?"true":null,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[e]:!0,"searchbar-animated":t,"searchbar-disabled":this.disabled,"searchbar-no-animate":t&&this.noAnimate,"searchbar-has-value":this.hasValue(),"searchbar-left-aligned":this.shouldAlignLeft,"searchbar-has-focus":this.focused,"searchbar-should-show-cancel":this.shouldShowCancelButton()})},h("div",{class:"searchbar-input-container"},h("input",{"aria-label":"search text",disabled:this.disabled,ref:t=>this.nativeInput=t,class:"searchbar-input",inputMode:this.inputmode,onInput:this.onInput,onBlur:this.onBlur,onFocus:this.onFocus,placeholder:this.placeholder,type:this.type,value:this.getValue(),autoComplete:this.autocomplete,autoCorrect:this.autocorrect,spellCheck:this.spellcheck}),"md"===e&&s,h("ion-icon",{mode:e,icon:n,lazy:!1,class:"searchbar-search-icon"}),h("button",{"aria-label":"reset",type:"button","no-blur":!0,class:"searchbar-clear-button",onMouseDown:this.onClearInput,onTouchStart:this.onClearInput},h("ion-icon",{"aria-hidden":"true",mode:e,icon:i,lazy:!1,class:"searchbar-clear-icon"}))),"ios"===e&&s)}get el(){return this}static get watchers(){return{debounce:["debounceChanged"],value:["valueChanged"],showCancelButton:["showCancelButtonChanged"]}}static get style(){return{ios:searchbarIosCss,md:searchbarMdCss}}},segmentIosCss=":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.065);border-radius:8px;overflow:hidden;z-index:0}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.065)}:host(.in-toolbar){margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;width:auto}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-toolbar){margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}:host(.in-toolbar:not(.ion-color)){background:var(--ion-toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.ion-color)){background:rgba(var(--ion-color-contrast-rgb), 0.11)}",segmentMdCss=":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint}:host(.segment-scrollable){-ms-flex-pack:start;justify-content:start;width:auto;overflow-x:auto}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:transparent}:host(.segment-scrollable) ::slotted(ion-segment-button){min-width:auto}",Segment=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.didInit=!1,this.activated=!1,this.disabled=!1,this.scrollable=!1,this.onClick=t=>{const e=t.target,i=this.checked;this.value=e.value,i&&this.scrollable&&this.checkButton(i,e),this.checked=e},this.ionChange=createEvent(this,"ionChange",7),this.ionSelect=createEvent(this,"ionSelect",7),this.ionStyle=createEvent(this,"ionStyle",7)}valueChanged(t,e){this.ionSelect.emit({value:t}),(""!==e||this.didInit)&&(this.activated?this.valueAfterGesture=t:this.ionChange.emit({value:t}))}disabledChanged(){this.gestureChanged();const t=this.getButtons();for(const e of t)e.disabled=this.disabled}gestureChanged(){this.gesture&&!this.scrollable&&this.gesture.enable(!this.disabled)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gesture.enable(!this.scrollable),this.gestureChanged(),this.disabled&&this.disabledChanged(),this.didInit=!0}onStart(t){this.activate(t)}onMove(t){this.setNextIndex(t)}onEnd(t){this.setActivated(!1);const e=this.setNextIndex(t,!0);t.event.stopImmediatePropagation(),e&&this.addRipple(t);const i=this.valueAfterGesture;void 0!==i&&(this.ionChange.emit({value:i}),this.valueAfterGesture=void 0)}getButtons(){return Array.from(this.el.querySelectorAll("ion-segment-button"))}addRipple(t){if(!config.getBoolean("animated",!0)||!config.getBoolean("rippleEffect",!0))return;const e=this.getButtons().find(t=>t.value===this.value),i=(e.shadowRoot||e).querySelector("ion-ripple-effect");if(!i)return;const{x:n,y:s}=pointerCoord(t.event);i.addRipple(n,s).then(t=>t())}setActivated(t){this.getButtons().forEach(e=>{t?e.classList.add("segment-button-activated"):e.classList.remove("segment-button-activated")}),this.activated=t}activate(t){const e=t.event.target,i=this.getButtons().find(t=>t.value===this.value);"ION-SEGMENT-BUTTON"===e.tagName&&(i||(this.value=e.value),this.value===e.value&&this.setActivated(!0))}getIndicator(t){return(t.shadowRoot||t).querySelector(".segment-button-indicator")}checkButton(t,e){const i=this.getIndicator(t),n=this.getIndicator(e);if(null===i||null===n)return;const s=i.getBoundingClientRect(),o=n.getBoundingClientRect(),r=`translate3d(${s.left-o.left}px, 0, 0) scaleX(${s.width/o.width})`;writeTask(()=>{n.classList.remove("segment-button-indicator-animated"),n.style.setProperty("transform",r),n.getBoundingClientRect(),n.classList.add("segment-button-indicator-animated"),n.style.setProperty("transform","")}),this.value=e.value,this.setCheckedClasses()}setCheckedClasses(){const t=this.getButtons(),e=t.findIndex(t=>t.value===this.value)+1;this.checked=t.find(t=>t.value===this.value);for(const i of t)i.classList.remove("segment-button-after-checked");e<t.length&&t[e].classList.add("segment-button-after-checked")}setNextIndex(t,e=!1){const i="rtl"===document.dir,n=this.activated,s=this.getButtons(),o=s.findIndex(t=>t.value===this.value),r=s[o];let a,l;if(-1===o)return;const c=r.getBoundingClientRect(),h=c.left,d=c.width,u=t.currentX,m=document.elementFromPoint(u,c.top+c.height/2);if(n&&!e){if(i?u>h+d:u<h){const t=o-1;t>=0&&(l=t)}else if((i?u<h:u>h+d)&&n&&!e){const t=o+1;t<s.length&&(l=t)}void 0===l||s[l].disabled||(a=s[l])}if(!n&&e&&(a=m),null!=a){if("ION-SEGMENT"===a.tagName)return!1;r!==a&&this.checkButton(r,a)}return!0}emitStyle(){this.ionStyle.emit({segment:!0})}render(){const t=getIonMode(this);return h(Host,{onClick:this.onClick,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0,"in-toolbar":hostContext("ion-toolbar",this.el),"in-toolbar-color":hostContext("ion-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},h("slot",null))}get el(){return this}static get watchers(){return{value:["valueChanged"],disabled:["disabledChanged"]}}static get style(){return{ios:segmentIosCss,md:segmentMdCss}}},segmentButtonIosCss=':host{--color:initial;--color-hover:var(--color);--color-checked:var(--color);--color-disabled:var(--color);--padding-start:0;--padding-end:0;--padding-top:0;--padding-bottom:0;border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-direction:column;flex-direction:column;height:auto;background:var(--background);color:var(--color);text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none;cursor:pointer}.button-native{border-radius:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;margin-left:var(--margin-start);margin-right:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;min-width:inherit;max-width:inherit;height:auto;min-height:inherit;max-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:none;outline:none;background:transparent;contain:content;pointer-events:none;overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end)}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}:host(.segment-button-checked){background:var(--background-checked);color:var(--color-checked)}:host(.segment-button-disabled){cursor:default;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.segment-button-checked:hover) .button-native{color:var(--color-checked)}}::slotted(ion-icon){-ms-flex-negative:0;flex-shrink:0;-ms-flex-order:-1;order:-1;pointer-events:none}::slotted(ion-label){display:block;-ms-flex-item-align:center;align-self:center;line-height:22px;text-overflow:ellipsis;white-space:nowrap;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.segment-button-layout-icon-top) .button-native{-ms-flex-direction:column;flex-direction:column}:host(.segment-button-layout-icon-start) .button-native{-ms-flex-direction:row;flex-direction:row}:host(.segment-button-layout-icon-end) .button-native{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.segment-button-layout-icon-bottom) .button-native{-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.segment-button-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.segment-button-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color, var(--color-checked))}.segment-button-indicator{-webkit-transform-origin:left;transform-origin:left;position:absolute;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;will-change:transform, opacity;pointer-events:none}.segment-button-indicator-background{width:100%;height:var(--indicator-height);-webkit-transform:var(--indicator-transform);transform:var(--indicator-transform);-webkit-box-shadow:var(--indicator-box-shadow);box-shadow:var(--indicator-box-shadow);pointer-events:none}.segment-button-indicator-animated{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked) .segment-button-indicator{opacity:1}@media (prefers-reduced-motion: reduce){.segment-button-indicator-background{-webkit-transform:none;transform:none}.segment-button-indicator-animated{-webkit-transition:none;transition:none}}:host{--background:none;--background-checked:none;--background-hover:none;--background-hover-opacity:0;--background-focused:none;--background-focused-opacity:0;--border-radius:7px;--border-width:1px;--border-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.12);--border-style:solid;--indicator-box-shadow:0 0 5px rgba(0, 0, 0, 0.16);--indicator-color:var(--ion-color-step-350, var(--ion-background-color, #fff));--indicator-height:100%;--indicator-transition:transform 260ms cubic-bezier(0.4, 0, 0.2, 1);--indicator-transform:none;--transition:100ms all linear;--padding-top:0;--padding-end:13px;--padding-bottom:0;--padding-start:13px;margin-top:2px;margin-bottom:2px;position:relative;-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-direction:row;flex-direction:row;min-width:70px;min-height:28px;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);font-size:13px;font-weight:450;line-height:37px}:host::before{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:5px;-webkit-transition:160ms opacity ease-in-out;transition:160ms opacity ease-in-out;-webkit-transition-delay:100ms;transition-delay:100ms;border-left:var(--border-width) var(--border-style) var(--border-color);content:"";opacity:1;will-change:opacity}:host(:first-of-type)::before{border-left-color:transparent}:host(.segment-button-disabled){opacity:0.3}::slotted(ion-icon){font-size:24px}:host(.segment-button-layout-icon-start) ::slotted(ion-label){margin-left:2px;margin-right:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.segment-button-layout-icon-start) ::slotted(ion-label){margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:0;margin-inline-end:0}}:host(.segment-button-layout-icon-end) ::slotted(ion-label){margin-left:0;margin-right:2px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.segment-button-layout-icon-end) ::slotted(ion-label){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:2px;margin-inline-end:2px}}.segment-button-indicator{padding-left:2px;padding-right:2px;left:0;right:0;top:0;bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.segment-button-indicator{padding-left:unset;padding-right:unset;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px}}.segment-button-indicator-background{border-radius:var(--border-radius);background:var(--indicator-color)}.segment-button-indicator-background{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked)::before,:host(.segment-button-after-checked)::before{opacity:0}:host(.segment-button-checked){z-index:-1}:host(.segment-button-activated){--indicator-transform:scale(0.95)}:host(.ion-focused) .button-native{opacity:0.7}@media (any-hover: hover){:host(:hover) .button-native{opacity:0.5}:host(.segment-button-checked:hover) .button-native{opacity:1}}:host(.in-segment-color){background:none;color:var(--ion-text-color, #000)}:host(.in-segment-color) .segment-button-indicator-background{background:var(--ion-color-step-350, var(--ion-background-color, #fff))}@media (any-hover: hover){:host(.in-segment-color:hover) .button-native,:host(.in-segment-color.segment-button-checked:hover) .button-native{color:var(--ion-text-color, #000)}}:host(.in-toolbar:not(.in-segment-color)){--background-checked:var(--ion-toolbar-segment-background-checked, none);--color:var(--ion-toolbar-segment-color, var(--ion-toolbar-color), initial);--color-checked:var(--ion-toolbar-segment-color-checked, var(--ion-toolbar-color), initial);--indicator-color:var(--ion-toolbar-segment-indicator-color, var(--ion-color-step-350, var(--ion-background-color, #fff)))}:host(.in-toolbar-color) .segment-button-indicator-background{background:#fff}:host(.in-toolbar-color:not(.in-segment-color)) .button-native{color:var(--ion-color-contrast)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color)) .button-native{color:var(--ion-color-base)}@media (any-hover: hover){:host(.in-toolbar-color:not(.in-segment-color):hover) .button-native{color:var(--ion-color-contrast)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color):hover) .button-native{color:var(--ion-color-base)}}',segmentButtonMdCss=':host{--color:initial;--color-hover:var(--color);--color-checked:var(--color);--color-disabled:var(--color);--padding-start:0;--padding-end:0;--padding-top:0;--padding-bottom:0;border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-direction:column;flex-direction:column;height:auto;background:var(--background);color:var(--color);text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none;cursor:pointer}.button-native{border-radius:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;margin-left:var(--margin-start);margin-right:var(--margin-end);margin-top:var(--margin-top);margin-bottom:var(--margin-bottom);padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;min-width:inherit;max-width:inherit;height:auto;min-height:inherit;max-height:inherit;-webkit-transition:var(--transition);transition:var(--transition);border:none;outline:none;background:transparent;contain:content;pointer-events:none;overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{margin-left:unset;margin-right:unset;-webkit-margin-start:var(--margin-start);margin-inline-start:var(--margin-start);-webkit-margin-end:var(--margin-end);margin-inline-end:var(--margin-end)}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}:host(.segment-button-checked){background:var(--background-checked);color:var(--color-checked)}:host(.segment-button-disabled){cursor:default;pointer-events:none}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.segment-button-checked:hover) .button-native{color:var(--color-checked)}}::slotted(ion-icon){-ms-flex-negative:0;flex-shrink:0;-ms-flex-order:-1;order:-1;pointer-events:none}::slotted(ion-label){display:block;-ms-flex-item-align:center;align-self:center;line-height:22px;text-overflow:ellipsis;white-space:nowrap;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.segment-button-layout-icon-top) .button-native{-ms-flex-direction:column;flex-direction:column}:host(.segment-button-layout-icon-start) .button-native{-ms-flex-direction:row;flex-direction:row}:host(.segment-button-layout-icon-end) .button-native{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.segment-button-layout-icon-bottom) .button-native{-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.segment-button-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.segment-button-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color, var(--color-checked))}.segment-button-indicator{-webkit-transform-origin:left;transform-origin:left;position:absolute;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;will-change:transform, opacity;pointer-events:none}.segment-button-indicator-background{width:100%;height:var(--indicator-height);-webkit-transform:var(--indicator-transform);transform:var(--indicator-transform);-webkit-box-shadow:var(--indicator-box-shadow);box-shadow:var(--indicator-box-shadow);pointer-events:none}.segment-button-indicator-animated{-webkit-transition:var(--indicator-transition);transition:var(--indicator-transition)}:host(.segment-button-checked) .segment-button-indicator{opacity:1}@media (prefers-reduced-motion: reduce){.segment-button-indicator-background{-webkit-transform:none;transform:none}.segment-button-indicator-animated{-webkit-transition:none;transition:none}}:host{--background:none;--background-checked:none;--background-hover:var(--color-checked);--background-focused:var(--color-checked);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04;--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6);--color-checked:var(--ion-color-primary, #3880ff);--indicator-box-shadow:none;--indicator-color:var(--color-checked);--indicator-height:2px;--indicator-transition:transform 250ms cubic-bezier(0.4, 0, 0.2, 1);--indicator-transform:none;--padding-top:0;--padding-end:16px;--padding-bottom:0;--padding-start:16px;--transition:color 0.15s linear 0s, opacity 0.15s linear 0s;min-width:90px;max-width:360px;min-height:48px;border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);font-size:14px;font-weight:500;letter-spacing:0.06em;line-height:40px;text-transform:uppercase}.button-native{min-width:90px}:host(.segment-button-disabled){opacity:0.3}:host(.in-segment-color){background:none;color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6)}:host(.in-segment-color) ion-ripple-effect{color:var(--ion-color-base)}:host(.in-segment-color) .segment-button-indicator-background{background:var(--ion-color-base)}:host(.in-segment-color.segment-button-checked) .button-native{color:var(--ion-color-base)}:host(.in-segment-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.in-segment-color:hover) .button-native{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6)}:host(.in-segment-color:hover) .button-native::after{background:var(--ion-color-base)}:host(.in-segment-color.segment-button-checked:hover) .button-native{color:var(--ion-color-base)}}:host(.in-toolbar:not(.in-segment-color)){--background:var(--ion-toolbar-segment-background, none);--background-checked:var(--ion-toolbar-segment-background-checked, none);--color:var(--ion-toolbar-segment-color, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.6));--color-checked:var(--ion-toolbar-segment-color-checked, var(--ion-color-primary, #3880ff));--indicator-color:var(--ion-toolbar-segment-color-checked, var(--color-checked))}:host(.in-toolbar-color:not(.in-segment-color)) .button-native{color:rgba(var(--ion-color-contrast-rgb), 0.6)}:host(.in-toolbar-color.segment-button-checked:not(.in-segment-color)) .button-native{color:var(--ion-color-contrast)}@media (any-hover: hover){:host(.in-toolbar-color:not(.in-segment-color)) .button-native::after{background:var(--ion-color-contrast)}}::slotted(ion-icon){margin-top:12px;margin-bottom:12px;font-size:24px}::slotted(ion-label){margin-top:12px;margin-bottom:12px}:host(.segment-button-layout-icon-top) ::slotted(ion-label),:host(.segment-button-layout-icon-bottom) ::slotted(ion-icon){margin-top:0}:host(.segment-button-layout-icon-top) ::slotted(ion-icon),:host(.segment-button-layout-icon-bottom) ::slotted(ion-label){margin-bottom:0}:host(.segment-button-layout-icon-start) ::slotted(ion-label){margin-left:8px;margin-right:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.segment-button-layout-icon-start) ::slotted(ion-label){margin-left:unset;margin-right:unset;-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:0;margin-inline-end:0}}:host(.segment-button-layout-icon-end) ::slotted(ion-label){margin-left:0;margin-right:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.segment-button-layout-icon-end) ::slotted(ion-label){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}:host(.segment-button-has-icon-only) ::slotted(ion-icon){margin-top:12px;margin-bottom:12px}:host(.segment-button-has-label-only) ::slotted(ion-label){margin-top:12px;margin-bottom:12px}.segment-button-indicator{left:0;right:0;bottom:0}.segment-button-indicator-background{background:var(--indicator-color)}:host(.in-toolbar:not(.in-segment-color)) .segment-button-indicator-background{background:var(--ion-toolbar-segment-indicator-color, var(--indicator-color))}:host(.in-toolbar-color:not(.in-segment-color)) .segment-button-indicator-background{background:var(--ion-color-contrast)}';let ids=0;const SegmentButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.segmentEl=null,this.checked=!1,this.disabled=!1,this.layout="icon-top",this.type="button",this.value="ion-sb-"+ids++,this.updateState=()=>{this.segmentEl&&(this.checked=this.segmentEl.value===this.value)}}connectedCallback(){const t=this.segmentEl=this.el.closest("ion-segment");t&&(this.updateState(),t.addEventListener("ionSelect",this.updateState))}disconnectedCallback(){const t=this.segmentEl;t&&(t.removeEventListener("ionSelect",this.updateState),this.segmentEl=null)}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{checked:t,type:e,disabled:i,hasIcon:n,hasLabel:s,layout:o}=this,r=getIonMode(this);return h(Host,{"aria-disabled":i?"true":null,class:{[r]:!0,"in-toolbar":hostContext("ion-toolbar",this.el),"in-toolbar-color":hostContext("ion-toolbar[color]",this.el),"in-segment":hostContext("ion-segment",this.el),"in-segment-color":hostContext("ion-segment[color]",this.el),"segment-button-has-label":s,"segment-button-has-icon":n,"segment-button-has-label-only":s&&!n,"segment-button-has-icon-only":n&&!s,"segment-button-disabled":i,"segment-button-checked":t,["segment-button-layout-"+o]:!0,"ion-activatable":!0,"ion-activatable-instant":!0,"ion-focusable":!0}},h("button",{type:e,"aria-pressed":t?"true":null,class:"button-native",disabled:i},h("span",{class:"button-inner"},h("slot",null)),"md"===r&&h("ion-ripple-effect",null)),h("div",{part:"indicator",class:{"segment-button-indicator":!0,"segment-button-indicator-animated":!0}},h("div",{part:"indicator-background",class:"segment-button-indicator-background"})))}get el(){return this}static get style(){return{ios:segmentButtonIosCss,md:segmentButtonMdCss}}},watchForOptions=(t,e,i)=>{const n=new MutationObserver(t=>{i(getSelectedOption(t,e))});return n.observe(t,{childList:!0,subtree:!0}),n},getSelectedOption=(t,e)=>{let i;return t.forEach(t=>{for(let n=0;n<t.addedNodes.length;n++)i=findCheckedOption(t.addedNodes[n],e)||i}),i},findCheckedOption=(t,e)=>{if(1===t.nodeType)return(t.tagName===e.toUpperCase()?[t]:Array.from(t.querySelectorAll(e))).find(e=>e.value===t.value)},selectIosCss=":host{--placeholder-color:currentColor;--placeholder-opacity:0.33;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;font-family:var(--ion-font-family, inherit);overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.in-item){position:static;max-width:45%}:host(.select-disabled){opacity:0.4;pointer-events:none}:host(.ion-focused) button{border:2px solid #5e9ed6}.select-placeholder{color:var(--placeholder-color);opacity:var(--placeholder-opacity)}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.select-icon{position:relative;opacity:0.33}.select-text{-ms-flex:1;flex:1;min-width:16px;font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.select-icon-inner{left:5px;top:50%;margin-top:-3px;position:absolute;width:0;height:0;border-top:5px solid;border-right:5px solid transparent;border-left:5px solid transparent;color:currentColor;pointer-events:none}[dir=rtl] .select-icon-inner,:host-context([dir=rtl]) .select-icon-inner{left:unset;right:unset;right:5px}:host{--padding-top:10px;--padding-end:10px;--padding-bottom:10px;--padding-start:20px}.select-icon{width:12px;height:18px}",selectMdCss=":host{--placeholder-color:currentColor;--placeholder-opacity:0.33;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;font-family:var(--ion-font-family, inherit);overflow:hidden;z-index:2}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}:host(.in-item){position:static;max-width:45%}:host(.select-disabled){opacity:0.4;pointer-events:none}:host(.ion-focused) button{border:2px solid #5e9ed6}.select-placeholder{color:var(--placeholder-color);opacity:var(--placeholder-opacity)}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}.select-icon{position:relative;opacity:0.33}.select-text{-ms-flex:1;flex:1;min-width:16px;font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.select-icon-inner{left:5px;top:50%;margin-top:-3px;position:absolute;width:0;height:0;border-top:5px solid;border-right:5px solid transparent;border-left:5px solid transparent;color:currentColor;pointer-events:none}[dir=rtl] .select-icon-inner,:host-context([dir=rtl]) .select-icon-inner{left:unset;right:unset;right:5px}:host{--padding-top:10px;--padding-end:0;--padding-bottom:11px;--padding-start:16px}.select-icon{width:19px;height:19px}",Select=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputId="ion-sel-"+selectIds++,this.didInit=!1,this.isExpanded=!1,this.disabled=!1,this.cancelText="Cancel",this.okText="OK",this.name=this.inputId,this.multiple=!1,this.interface="alert",this.interfaceOptions={},this.onClick=t=>{this.setFocus(),this.open(t)},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionChange=createEvent(this,"ionChange",7),this.ionCancel=createEvent(this,"ionCancel",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionStyle=createEvent(this,"ionStyle",7)}disabledChanged(){this.emitStyle()}valueChanged(){this.emitStyle(),this.didInit&&this.ionChange.emit({value:this.value})}async connectedCallback(){this.updateOverlayOptions(),this.emitStyle(),this.mutationO=watchForOptions(this.el,"ion-select-option",async()=>{this.updateOverlayOptions()})}disconnectedCallback(){this.mutationO&&(this.mutationO.disconnect(),this.mutationO=void 0)}componentDidLoad(){this.didInit=!0}async open(t){if(this.disabled||this.isExpanded)return;const e=this.overlay=await this.createOverlay(t);return this.isExpanded=!0,e.onDidDismiss().then(()=>{this.overlay=void 0,this.isExpanded=!1,this.setFocus()}),await e.present(),e}createOverlay(t){let e=this.interface;return"action-sheet"!==e&&"popover"!==e||!this.multiple||(console.warn(`Select interface cannot be "${e}" with a multi-value select. Using the "alert" interface instead.`),e="alert"),"popover"!==e||t||(console.warn('Select interface cannot be a "popover" without passing an event. Using the "alert" interface instead.'),e="alert"),"popover"===e?this.openPopover(t):"action-sheet"===e?this.openActionSheet():this.openAlert()}updateOverlayOptions(){const t=this.overlay;if(!t)return;const e=this.childOpts,i=this.value;switch(this.interface){case"action-sheet":t.buttons=this.createActionSheetButtons(e,i);break;case"popover":const n=t.querySelector("ion-select-popover");n&&(n.options=this.createPopoverOptions(e,i));break;case"alert":t.inputs=this.createAlertInputs(e,this.multiple?"checkbox":"radio",i)}}createActionSheetButtons(t,e){const i=t.map(t=>{const i=getOptionValue(t);return{role:isOptionSelected(i,e,this.compareWith)?"selected":"",text:t.textContent,handler:()=>{this.value=i}}});return i.push({text:this.cancelText,role:"cancel",handler:()=>{this.ionCancel.emit()}}),i}createAlertInputs(t,e,i){return t.map(t=>{const n=getOptionValue(t);return{type:e,label:t.textContent||"",value:n,checked:isOptionSelected(n,i,this.compareWith),disabled:t.disabled}})}createPopoverOptions(t,e){return t.map(t=>{const i=getOptionValue(t);return{text:t.textContent||"",value:i,checked:isOptionSelected(i,e,this.compareWith),disabled:t.disabled,handler:()=>{this.value=i,this.close()}}})}async openPopover(t){const e=this.interfaceOptions,i=getIonMode(this),n=this.value,s=Object.assign(Object.assign({mode:i},e),{component:"ion-select-popover",cssClass:["select-popover",e.cssClass],event:t,componentProps:{header:e.header,subHeader:e.subHeader,message:e.message,value:n,options:this.createPopoverOptions(this.childOpts,n)}});return popoverController.create(s)}async openActionSheet(){const t=getIonMode(this),e=this.interfaceOptions,i=Object.assign(Object.assign({mode:t},e),{buttons:this.createActionSheetButtons(this.childOpts,this.value),cssClass:["select-action-sheet",e.cssClass]});return actionSheetController.create(i)}async openAlert(){const t=this.getLabel(),e=t?t.textContent:null,i=this.interfaceOptions,n=this.multiple?"checkbox":"radio",s=getIonMode(this),o=Object.assign(Object.assign({mode:s},i),{header:i.header?i.header:e,inputs:this.createAlertInputs(this.childOpts,n,this.value),buttons:[{text:this.cancelText,role:"cancel",handler:()=>{this.ionCancel.emit()}},{text:this.okText,handler:t=>{this.value=t}}],cssClass:["select-alert",i.cssClass,this.multiple?"multiple-select-alert":"single-select-alert"]});return alertController.create(o)}close(){return this.overlay?this.overlay.dismiss():Promise.resolve(!1)}getLabel(){return findItemLabel(this.el)}hasValue(){return""!==this.getText()}get childOpts(){return Array.from(this.el.querySelectorAll("ion-select-option"))}getText(){const t=this.selectedText;return null!=t&&""!==t?t:generateText(this.childOpts,this.value,this.compareWith)}setFocus(){this.buttonEl&&this.buttonEl.focus()}emitStyle(){this.ionStyle.emit({interactive:!0,select:!0,"has-placeholder":null!=this.placeholder,"has-value":this.hasValue(),"interactive-disabled":this.disabled,"select-disabled":this.disabled})}render(){const{placeholder:t,name:e,disabled:i,isExpanded:n,value:s,el:o}=this,r=getIonMode(this),a=this.inputId+"-lbl",l=findItemLabel(o);l&&(l.id=a);let c=!1,d=this.getText();""===d&&null!=t&&(d=t,c=!0),renderHiddenInput(!0,o,e,parseValue(s),i);const u={"select-text":!0,"select-placeholder":c},m=c?"placeholder":"text";return h(Host,{onClick:this.onClick,role:"combobox","aria-haspopup":"dialog","aria-disabled":i?"true":null,"aria-expanded":""+n,"aria-labelledby":a,class:{[r]:!0,"in-item":hostContext("ion-item",o),"select-disabled":i}},h("div",{class:u,part:m},d),h("div",{class:"select-icon",role:"presentation",part:"icon"},h("div",{class:"select-icon-inner",part:"icon-inner"})),h("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:i,ref:t=>this.buttonEl=t}))}get el(){return this}static get watchers(){return{disabled:["disabledChanged"],placeholder:["disabledChanged"],value:["valueChanged"]}}static get style(){return{ios:selectIosCss,md:selectMdCss}}},isOptionSelected=(t,e,i)=>void 0!==t&&(Array.isArray(t)?t.some(t=>compareOptions(t,e,i)):compareOptions(t,e,i)),getOptionValue=t=>{const e=t.value;return void 0===e?t.textContent||"":e},parseValue=t=>{if(null!=t)return Array.isArray(t)?t.join(","):t.toString()},compareOptions=(t,e,i)=>"function"==typeof i?i(t,e):"string"==typeof i?t[i]===e[i]:Array.isArray(e)?e.includes(t):t===e,generateText=(t,e,i)=>void 0===e?"":Array.isArray(e)?e.map(e=>textForValue(t,e,i)).filter(t=>null!==t).join(", "):textForValue(t,e,i)||"",textForValue=(t,e,i)=>{const n=t.find(t=>compareOptions(getOptionValue(t),e,i));return n?n.textContent:null};let selectIds=0;const selectOptionCss=":host{display:none}",SelectOption=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputId="ion-selopt-"+selectOptionIds++,this.disabled=!1}render(){return h(Host,{role:"option",id:this.inputId,class:getIonMode(this)})}get el(){return this}static get style(){return selectOptionCss}};let selectOptionIds=0;const selectPopoverCss=".sc-ion-select-popover-h ion-list.sc-ion-select-popover{margin-left:0;margin-right:0;margin-top:-1px;margin-bottom:-1px}.sc-ion-select-popover-h ion-list-header.sc-ion-select-popover,.sc-ion-select-popover-h ion-label.sc-ion-select-popover{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}",SelectPopover=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.options=[]}onSelect(t){const e=this.options.find(e=>e.value===t.target.value);e&&safeCall$1(e.handler)}render(){const t=this.options.find(t=>t.checked),e=t?t.value:void 0;return h(Host,{class:getIonMode(this)},h("ion-list",null,void 0!==this.header&&h("ion-list-header",null,this.header),(void 0!==this.subHeader||void 0!==this.message)&&h("ion-item",null,h("ion-label",{class:"ion-text-wrap"},void 0!==this.subHeader&&h("h3",null,this.subHeader),void 0!==this.message&&h("p",null,this.message))),h("ion-radio-group",{value:e},this.options.map(t=>h("ion-item",null,h("ion-label",null,t.text),h("ion-radio",{value:t.value,disabled:t.disabled}))))))}static get style(){return selectPopoverCss}},skeletonTextCss=":host{--background:rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.065);border-radius:var(--border-radius, inherit);display:block;width:100%;height:inherit;margin-top:4px;margin-bottom:4px;background:var(--background);line-height:10px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}span{display:inline-block}:host(.in-media){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;height:100%}:host(.skeleton-text-animated){position:relative;background:-webkit-gradient(linear, left top, right top, color-stop(8%, rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.065)), color-stop(18%, rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.135)), color-stop(33%, rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.065)));background:linear-gradient(to right, rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.065) 8%, rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.135) 18%, rgba(var(--background-rgb, var(--ion-text-color-rgb, 0, 0, 0)), 0.065) 33%);background-size:800px 104px;-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:shimmer;animation-name:shimmer;-webkit-animation-timing-function:linear;animation-timing-function:linear}@-webkit-keyframes shimmer{0%{background-position:-468px 0}100%{background-position:468px 0}}@keyframes shimmer{0%{background-position:-468px 0}100%{background-position:468px 0}}",SkeletonText=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.animated=!1}render(){const t=this.animated&&config.getBoolean("animated",!0),e=hostContext("ion-avatar",this.el)||hostContext("ion-thumbnail",this.el),i=getIonMode(this);return h(Host,{class:{[i]:!0,"skeleton-text-animated":t,"in-media":e}},h("span",null,""))}get el(){return this}static get style(){return skeletonTextCss}},slideCss="ion-slide{display:block;width:100%;height:100%}.slide-zoom{display:block;width:100%;text-align:center}.swiper-slide{display:-ms-flexbox;display:flex;position:relative;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;font-size:18px;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box}.swiper-slide img{width:auto;max-width:100%;height:auto;max-height:100%}",Slide=class extends HTMLElement{constructor(){super(),this.__registerHost()}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,"swiper-slide":!0,"swiper-zoom-container":!0}})}static get style(){return slideCss}},slidesIosCss=".swiper-container{margin:0 auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-container-no-flexbox .swiper-slide{float:left}.swiper-container-vertical{height:100%}.swiper-container-vertical>.swiper-wrapper{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;-o-transition-property:transform;transition-property:transform;transition-property:transform, -webkit-transform;-webkit-box-sizing:content-box;box-sizing:content-box}.swiper-container-android .swiper-slide,.swiper-wrapper{-webkit-transform:translate3d(0px, 0, 0);transform:translate3d(0px, 0, 0)}.swiper-container-multirow>.swiper-wrapper{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.swiper-container-free-mode>.swiper-wrapper{-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out;margin:0 auto}.swiper-slide{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:100%;height:100%;position:relative;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;-o-transition-property:transform;transition-property:transform;transition-property:transform, -webkit-transform}.swiper-invisible-blank-slide{visibility:hidden}.swiper-container-autoheight,.swiper-container-autoheight .swiper-slide{height:auto}.swiper-container-autoheight .swiper-wrapper{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-transition-property:height, -webkit-transform;transition-property:height, -webkit-transform;-o-transition-property:transform, height;transition-property:transform, height;transition-property:transform, height, -webkit-transform}.swiper-container-3d{-webkit-perspective:1200px;perspective:1200px}.swiper-container-3d .swiper-wrapper,.swiper-container-3d .swiper-slide,.swiper-container-3d .swiper-slide-shadow-left,.swiper-container-3d .swiper-slide-shadow-right,.swiper-container-3d .swiper-slide-shadow-top,.swiper-container-3d .swiper-slide-shadow-bottom,.swiper-container-3d .swiper-cube-shadow{-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.swiper-container-3d .swiper-slide-shadow-left,.swiper-container-3d .swiper-slide-shadow-right,.swiper-container-3d .swiper-slide-shadow-top,.swiper-container-3d .swiper-slide-shadow-bottom{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-container-3d .swiper-slide-shadow-left{background-image:-webkit-gradient(linear, right top, left top, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-3d .swiper-slide-shadow-right{background-image:-webkit-gradient(linear, left top, right top, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-3d .swiper-slide-shadow-top{background-image:-webkit-gradient(linear, left bottom, left top, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-3d .swiper-slide-shadow-bottom{background-image:-webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-wp8-horizontal,.swiper-container-wp8-horizontal>.swiper-wrapper{-ms-touch-action:pan-y;touch-action:pan-y}.swiper-container-wp8-vertical,.swiper-container-wp8-vertical>.swiper-wrapper{-ms-touch-action:pan-x;touch-action:pan-x}.swiper-button-prev,.swiper-button-next{position:absolute;top:50%;width:27px;height:44px;margin-top:-22px;z-index:10;cursor:pointer;background-size:27px 44px;background-position:center;background-repeat:no-repeat}.swiper-button-prev.swiper-button-disabled,.swiper-button-next.swiper-button-disabled{opacity:0.35;cursor:auto;pointer-events:none}.swiper-button-prev,.swiper-container-rtl .swiper-button-next{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23007aff'%2F%3E%3C%2Fsvg%3E\");left:10px;right:auto}.swiper-button-next,.swiper-container-rtl .swiper-button-prev{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23007aff'%2F%3E%3C%2Fsvg%3E\");right:10px;left:auto}.swiper-button-prev.swiper-button-white,.swiper-container-rtl .swiper-button-next.swiper-button-white{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23ffffff'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-next.swiper-button-white,.swiper-container-rtl .swiper-button-prev.swiper-button-white{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23ffffff'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-prev.swiper-button-black,.swiper-container-rtl .swiper-button-next.swiper-button-black{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23000000'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-next.swiper-button-black,.swiper-container-rtl .swiper-button-prev.swiper-button-black{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23000000'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-lock{display:none}.swiper-pagination{position:absolute;text-align:center;-webkit-transition:300ms opacity;-o-transition:300ms opacity;transition:300ms opacity;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-pagination-fraction,.swiper-pagination-custom,.swiper-container-horizontal>.swiper-pagination-bullets{bottom:10px;left:0;width:100%}.swiper-pagination-bullets-dynamic{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{-webkit-transform:scale(0.33);-ms-transform:scale(0.33);transform:scale(0.33);position:relative}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev{-webkit-transform:scale(0.66);-ms-transform:scale(0.66);transform:scale(0.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev{-webkit-transform:scale(0.33);-ms-transform:scale(0.33);transform:scale(0.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next{-webkit-transform:scale(0.66);-ms-transform:scale(0.66);transform:scale(0.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next{-webkit-transform:scale(0.33);-ms-transform:scale(0.33);transform:scale(0.33)}.swiper-pagination-bullet{width:8px;height:8px;display:inline-block;border-radius:100%;background:#000;opacity:0.2}button.swiper-pagination-bullet{border:none;margin:0;padding:0;-webkit-box-shadow:none;box-shadow:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-bullet-active{opacity:1;background:#007aff}.swiper-container-vertical>.swiper-pagination-bullets{right:10px;top:50%;-webkit-transform:translate3d(0px, -50%, 0);transform:translate3d(0px, -50%, 0)}.swiper-container-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{margin:6px 0;display:block}.swiper-container-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:8px}.swiper-container-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{display:inline-block;-webkit-transition:200ms top, 200ms -webkit-transform;transition:200ms top, 200ms -webkit-transform;-o-transition:200ms transform, 200ms top;transition:200ms transform, 200ms top;transition:200ms transform, 200ms top, 200ms -webkit-transform}.swiper-container-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 4px}.swiper-container-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);white-space:nowrap}.swiper-container-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{-webkit-transition:200ms left, 200ms -webkit-transform;transition:200ms left, 200ms -webkit-transform;-o-transition:200ms transform, 200ms left;transition:200ms transform, 200ms left;transition:200ms transform, 200ms left, 200ms -webkit-transform}.swiper-container-horizontal.swiper-container-rtl>.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{-webkit-transition:200ms right, 200ms -webkit-transform;transition:200ms right, 200ms -webkit-transform;-o-transition:200ms transform, 200ms right;transition:200ms transform, 200ms right;transition:200ms transform, 200ms right, 200ms -webkit-transform}.swiper-pagination-progressbar{background:rgba(0, 0, 0, 0.25);position:absolute}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:#007aff;position:absolute;left:0;top:0;width:100%;height:100%;-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.swiper-container-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{-webkit-transform-origin:right top;-ms-transform-origin:right top;transform-origin:right top}.swiper-container-horizontal>.swiper-pagination-progressbar,.swiper-container-vertical>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:100%;height:4px;left:0;top:0}.swiper-container-vertical>.swiper-pagination-progressbar,.swiper-container-horizontal>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:4px;height:100%;left:0;top:0}.swiper-pagination-white .swiper-pagination-bullet-active{background:#ffffff}.swiper-pagination-progressbar.swiper-pagination-white{background:rgba(255, 255, 255, 0.25)}.swiper-pagination-progressbar.swiper-pagination-white .swiper-pagination-progressbar-fill{background:#ffffff}.swiper-pagination-black .swiper-pagination-bullet-active{background:#000000}.swiper-pagination-progressbar.swiper-pagination-black{background:rgba(0, 0, 0, 0.25)}.swiper-pagination-progressbar.swiper-pagination-black .swiper-pagination-progressbar-fill{background:#000000}.swiper-pagination-lock{display:none}.swiper-scrollbar{border-radius:10px;position:relative;-ms-touch-action:none;background:rgba(0, 0, 0, 0.1)}.swiper-container-horizontal>.swiper-scrollbar{position:absolute;left:1%;bottom:3px;z-index:50;height:5px;width:98%}.swiper-container-vertical>.swiper-scrollbar{position:absolute;right:3px;top:1%;z-index:50;width:5px;height:98%}.swiper-scrollbar-drag{height:100%;width:100%;position:relative;background:rgba(0, 0, 0, 0.5);border-radius:10px;left:0;top:0}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-scrollbar-lock{display:none}.swiper-zoom-container{width:100%;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;text-align:center}.swiper-zoom-container>img,.swiper-zoom-container>svg,.swiper-zoom-container>canvas{max-width:100%;max-height:100%;-o-object-fit:contain;object-fit:contain}.swiper-slide-zoomed{cursor:move}.swiper-lazy-preloader{width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;-webkit-transform-origin:50%;-ms-transform-origin:50%;transform-origin:50%;-webkit-animation:swiper-preloader-spin 1s steps(12, end) infinite;animation:swiper-preloader-spin 1s steps(12, end) infinite}.swiper-lazy-preloader:after{display:block;content:\"\";width:100%;height:100%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D'0%200%20120%20120'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cdefs%3E%3Cline%20id%3D'l'%20x1%3D'60'%20x2%3D'60'%20y1%3D'7'%20y2%3D'27'%20stroke%3D'%236c6c6c'%20stroke-width%3D'11'%20stroke-linecap%3D'round'%2F%3E%3C%2Fdefs%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(30%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(60%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(90%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(120%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(150%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.37'%20transform%3D'rotate(180%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.46'%20transform%3D'rotate(210%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.56'%20transform%3D'rotate(240%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.66'%20transform%3D'rotate(270%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.75'%20transform%3D'rotate(300%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.85'%20transform%3D'rotate(330%2060%2C60)'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\");background-position:50%;background-size:100%;background-repeat:no-repeat}.swiper-lazy-preloader-white:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D'0%200%20120%20120'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cdefs%3E%3Cline%20id%3D'l'%20x1%3D'60'%20x2%3D'60'%20y1%3D'7'%20y2%3D'27'%20stroke%3D'%23fff'%20stroke-width%3D'11'%20stroke-linecap%3D'round'%2F%3E%3C%2Fdefs%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(30%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(60%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(90%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(120%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(150%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.37'%20transform%3D'rotate(180%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.46'%20transform%3D'rotate(210%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.56'%20transform%3D'rotate(240%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.66'%20transform%3D'rotate(270%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.75'%20transform%3D'rotate(300%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.85'%20transform%3D'rotate(330%2060%2C60)'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\")}@-webkit-keyframes swiper-preloader-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes swiper-preloader-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.swiper-container .swiper-notification{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-container-fade.swiper-container-free-mode .swiper-slide{-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.swiper-container-fade .swiper-slide{pointer-events:none;-webkit-transition-property:opacity;-o-transition-property:opacity;transition-property:opacity}.swiper-container-fade .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-fade .swiper-slide-active,.swiper-container-fade .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-cube{overflow:visible}.swiper-container-cube .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;width:100%;height:100%}.swiper-container-cube .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-cube.swiper-container-rtl .swiper-slide{-webkit-transform-origin:100% 0;-ms-transform-origin:100% 0;transform-origin:100% 0}.swiper-container-cube .swiper-slide-active,.swiper-container-cube .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-cube .swiper-slide-active,.swiper-container-cube .swiper-slide-next,.swiper-container-cube .swiper-slide-prev,.swiper-container-cube .swiper-slide-next+.swiper-slide{pointer-events:auto;visibility:visible}.swiper-container-cube .swiper-slide-shadow-top,.swiper-container-cube .swiper-slide-shadow-bottom,.swiper-container-cube .swiper-slide-shadow-left,.swiper-container-cube .swiper-slide-shadow-right{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-container-cube .swiper-cube-shadow{position:absolute;left:0;bottom:0px;width:100%;height:100%;background:#000;opacity:0.6;-webkit-filter:blur(50px);filter:blur(50px);z-index:0}.swiper-container-flip{overflow:visible}.swiper-container-flip .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-container-flip .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-flip .swiper-slide-active,.swiper-container-flip .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-flip .swiper-slide-shadow-top,.swiper-container-flip .swiper-slide-shadow-bottom,.swiper-container-flip .swiper-slide-shadow-left,.swiper-container-flip .swiper-slide-shadow-right{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-container-coverflow .swiper-wrapper{-ms-perspective:1200px}ion-slides{display:block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.swiper-pagination-bullet{background:var(--bullet-background)}.swiper-pagination-bullet-active{background:var(--bullet-background-active)}.swiper-pagination-progressbar{background:var(--progress-bar-background)}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:var(--progress-bar-background-active)}.swiper-scrollbar{background:var(--scroll-bar-background)}.swiper-scrollbar-drag{background:var(--scroll-bar-background-active)}.slides-ios{--bullet-background:var(--ion-color-step-200, #cccccc);--bullet-background-active:var(--ion-color-primary, #3880ff);--progress-bar-background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.25);--progress-bar-background-active:var(--ion-color-primary-shade, #3171e0);--scroll-bar-background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1);--scroll-bar-background-active:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.5)}",slidesMdCss=".swiper-container{margin:0 auto;position:relative;overflow:hidden;list-style:none;padding:0;z-index:1}.swiper-container-no-flexbox .swiper-slide{float:left}.swiper-container-vertical{height:100%}.swiper-container-vertical>.swiper-wrapper{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.swiper-wrapper{position:relative;width:100%;height:100%;z-index:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;-o-transition-property:transform;transition-property:transform;transition-property:transform, -webkit-transform;-webkit-box-sizing:content-box;box-sizing:content-box}.swiper-container-android .swiper-slide,.swiper-wrapper{-webkit-transform:translate3d(0px, 0, 0);transform:translate3d(0px, 0, 0)}.swiper-container-multirow>.swiper-wrapper{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.swiper-container-free-mode>.swiper-wrapper{-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out;margin:0 auto}.swiper-slide{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:100%;height:100%;position:relative;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;-o-transition-property:transform;transition-property:transform;transition-property:transform, -webkit-transform}.swiper-invisible-blank-slide{visibility:hidden}.swiper-container-autoheight,.swiper-container-autoheight .swiper-slide{height:auto}.swiper-container-autoheight .swiper-wrapper{-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-transition-property:height, -webkit-transform;transition-property:height, -webkit-transform;-o-transition-property:transform, height;transition-property:transform, height;transition-property:transform, height, -webkit-transform}.swiper-container-3d{-webkit-perspective:1200px;perspective:1200px}.swiper-container-3d .swiper-wrapper,.swiper-container-3d .swiper-slide,.swiper-container-3d .swiper-slide-shadow-left,.swiper-container-3d .swiper-slide-shadow-right,.swiper-container-3d .swiper-slide-shadow-top,.swiper-container-3d .swiper-slide-shadow-bottom,.swiper-container-3d .swiper-cube-shadow{-webkit-transform-style:preserve-3d;transform-style:preserve-3d}.swiper-container-3d .swiper-slide-shadow-left,.swiper-container-3d .swiper-slide-shadow-right,.swiper-container-3d .swiper-slide-shadow-top,.swiper-container-3d .swiper-slide-shadow-bottom{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:10}.swiper-container-3d .swiper-slide-shadow-left{background-image:-webkit-gradient(linear, right top, left top, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-3d .swiper-slide-shadow-right{background-image:-webkit-gradient(linear, left top, right top, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(left, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to right, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-3d .swiper-slide-shadow-top{background-image:-webkit-gradient(linear, left bottom, left top, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-3d .swiper-slide-shadow-bottom{background-image:-webkit-gradient(linear, left top, left bottom, from(rgba(0, 0, 0, 0.5)), to(rgba(0, 0, 0, 0)));background-image:-webkit-linear-gradient(top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:-o-linear-gradient(top, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0));background-image:linear-gradient(to bottom, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0))}.swiper-container-wp8-horizontal,.swiper-container-wp8-horizontal>.swiper-wrapper{-ms-touch-action:pan-y;touch-action:pan-y}.swiper-container-wp8-vertical,.swiper-container-wp8-vertical>.swiper-wrapper{-ms-touch-action:pan-x;touch-action:pan-x}.swiper-button-prev,.swiper-button-next{position:absolute;top:50%;width:27px;height:44px;margin-top:-22px;z-index:10;cursor:pointer;background-size:27px 44px;background-position:center;background-repeat:no-repeat}.swiper-button-prev.swiper-button-disabled,.swiper-button-next.swiper-button-disabled{opacity:0.35;cursor:auto;pointer-events:none}.swiper-button-prev,.swiper-container-rtl .swiper-button-next{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23007aff'%2F%3E%3C%2Fsvg%3E\");left:10px;right:auto}.swiper-button-next,.swiper-container-rtl .swiper-button-prev{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23007aff'%2F%3E%3C%2Fsvg%3E\");right:10px;left:auto}.swiper-button-prev.swiper-button-white,.swiper-container-rtl .swiper-button-next.swiper-button-white{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23ffffff'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-next.swiper-button-white,.swiper-container-rtl .swiper-button-prev.swiper-button-white{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23ffffff'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-prev.swiper-button-black,.swiper-container-rtl .swiper-button-next.swiper-button-black{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M0%2C22L22%2C0l2.1%2C2.1L4.2%2C22l19.9%2C19.9L22%2C44L0%2C22L0%2C22L0%2C22z'%20fill%3D'%23000000'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-next.swiper-button-black,.swiper-container-rtl .swiper-button-prev.swiper-button-black{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2027%2044'%3E%3Cpath%20d%3D'M27%2C22L27%2C22L5%2C44l-2.1-2.1L22.8%2C22L2.9%2C2.1L5%2C0L27%2C22L27%2C22z'%20fill%3D'%23000000'%2F%3E%3C%2Fsvg%3E\")}.swiper-button-lock{display:none}.swiper-pagination{position:absolute;text-align:center;-webkit-transition:300ms opacity;-o-transition:300ms opacity;transition:300ms opacity;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-pagination-fraction,.swiper-pagination-custom,.swiper-container-horizontal>.swiper-pagination-bullets{bottom:10px;left:0;width:100%}.swiper-pagination-bullets-dynamic{overflow:hidden;font-size:0}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{-webkit-transform:scale(0.33);-ms-transform:scale(0.33);transform:scale(0.33);position:relative}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev{-webkit-transform:scale(0.66);-ms-transform:scale(0.66);transform:scale(0.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev{-webkit-transform:scale(0.33);-ms-transform:scale(0.33);transform:scale(0.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next{-webkit-transform:scale(0.66);-ms-transform:scale(0.66);transform:scale(0.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next{-webkit-transform:scale(0.33);-ms-transform:scale(0.33);transform:scale(0.33)}.swiper-pagination-bullet{width:8px;height:8px;display:inline-block;border-radius:100%;background:#000;opacity:0.2}button.swiper-pagination-bullet{border:none;margin:0;padding:0;-webkit-box-shadow:none;box-shadow:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-bullet-active{opacity:1;background:#007aff}.swiper-container-vertical>.swiper-pagination-bullets{right:10px;top:50%;-webkit-transform:translate3d(0px, -50%, 0);transform:translate3d(0px, -50%, 0)}.swiper-container-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{margin:6px 0;display:block}.swiper-container-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:8px}.swiper-container-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{display:inline-block;-webkit-transition:200ms top, 200ms -webkit-transform;transition:200ms top, 200ms -webkit-transform;-o-transition:200ms transform, 200ms top;transition:200ms transform, 200ms top;transition:200ms transform, 200ms top, 200ms -webkit-transform}.swiper-container-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 4px}.swiper-container-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);white-space:nowrap}.swiper-container-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{-webkit-transition:200ms left, 200ms -webkit-transform;transition:200ms left, 200ms -webkit-transform;-o-transition:200ms transform, 200ms left;transition:200ms transform, 200ms left;transition:200ms transform, 200ms left, 200ms -webkit-transform}.swiper-container-horizontal.swiper-container-rtl>.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{-webkit-transition:200ms right, 200ms -webkit-transform;transition:200ms right, 200ms -webkit-transform;-o-transition:200ms transform, 200ms right;transition:200ms transform, 200ms right;transition:200ms transform, 200ms right, 200ms -webkit-transform}.swiper-pagination-progressbar{background:rgba(0, 0, 0, 0.25);position:absolute}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:#007aff;position:absolute;left:0;top:0;width:100%;height:100%;-webkit-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.swiper-container-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{-webkit-transform-origin:right top;-ms-transform-origin:right top;transform-origin:right top}.swiper-container-horizontal>.swiper-pagination-progressbar,.swiper-container-vertical>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:100%;height:4px;left:0;top:0}.swiper-container-vertical>.swiper-pagination-progressbar,.swiper-container-horizontal>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{width:4px;height:100%;left:0;top:0}.swiper-pagination-white .swiper-pagination-bullet-active{background:#ffffff}.swiper-pagination-progressbar.swiper-pagination-white{background:rgba(255, 255, 255, 0.25)}.swiper-pagination-progressbar.swiper-pagination-white .swiper-pagination-progressbar-fill{background:#ffffff}.swiper-pagination-black .swiper-pagination-bullet-active{background:#000000}.swiper-pagination-progressbar.swiper-pagination-black{background:rgba(0, 0, 0, 0.25)}.swiper-pagination-progressbar.swiper-pagination-black .swiper-pagination-progressbar-fill{background:#000000}.swiper-pagination-lock{display:none}.swiper-scrollbar{border-radius:10px;position:relative;-ms-touch-action:none;background:rgba(0, 0, 0, 0.1)}.swiper-container-horizontal>.swiper-scrollbar{position:absolute;left:1%;bottom:3px;z-index:50;height:5px;width:98%}.swiper-container-vertical>.swiper-scrollbar{position:absolute;right:3px;top:1%;z-index:50;width:5px;height:98%}.swiper-scrollbar-drag{height:100%;width:100%;position:relative;background:rgba(0, 0, 0, 0.5);border-radius:10px;left:0;top:0}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-scrollbar-lock{display:none}.swiper-zoom-container{width:100%;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;text-align:center}.swiper-zoom-container>img,.swiper-zoom-container>svg,.swiper-zoom-container>canvas{max-width:100%;max-height:100%;-o-object-fit:contain;object-fit:contain}.swiper-slide-zoomed{cursor:move}.swiper-lazy-preloader{width:42px;height:42px;position:absolute;left:50%;top:50%;margin-left:-21px;margin-top:-21px;z-index:10;-webkit-transform-origin:50%;-ms-transform-origin:50%;transform-origin:50%;-webkit-animation:swiper-preloader-spin 1s steps(12, end) infinite;animation:swiper-preloader-spin 1s steps(12, end) infinite}.swiper-lazy-preloader:after{display:block;content:\"\";width:100%;height:100%;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D'0%200%20120%20120'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cdefs%3E%3Cline%20id%3D'l'%20x1%3D'60'%20x2%3D'60'%20y1%3D'7'%20y2%3D'27'%20stroke%3D'%236c6c6c'%20stroke-width%3D'11'%20stroke-linecap%3D'round'%2F%3E%3C%2Fdefs%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(30%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(60%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(90%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(120%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(150%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.37'%20transform%3D'rotate(180%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.46'%20transform%3D'rotate(210%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.56'%20transform%3D'rotate(240%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.66'%20transform%3D'rotate(270%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.75'%20transform%3D'rotate(300%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.85'%20transform%3D'rotate(330%2060%2C60)'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\");background-position:50%;background-size:100%;background-repeat:no-repeat}.swiper-lazy-preloader-white:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg%20viewBox%3D'0%200%20120%20120'%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20xmlns%3Axlink%3D'http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink'%3E%3Cdefs%3E%3Cline%20id%3D'l'%20x1%3D'60'%20x2%3D'60'%20y1%3D'7'%20y2%3D'27'%20stroke%3D'%23fff'%20stroke-width%3D'11'%20stroke-linecap%3D'round'%2F%3E%3C%2Fdefs%3E%3Cg%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(30%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(60%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(90%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(120%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.27'%20transform%3D'rotate(150%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.37'%20transform%3D'rotate(180%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.46'%20transform%3D'rotate(210%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.56'%20transform%3D'rotate(240%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.66'%20transform%3D'rotate(270%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.75'%20transform%3D'rotate(300%2060%2C60)'%2F%3E%3Cuse%20xlink%3Ahref%3D'%23l'%20opacity%3D'.85'%20transform%3D'rotate(330%2060%2C60)'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E\")}@-webkit-keyframes swiper-preloader-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes swiper-preloader-spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.swiper-container .swiper-notification{position:absolute;left:0;top:0;pointer-events:none;opacity:0;z-index:-1000}.swiper-container-fade.swiper-container-free-mode .swiper-slide{-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.swiper-container-fade .swiper-slide{pointer-events:none;-webkit-transition-property:opacity;-o-transition-property:opacity;transition-property:opacity}.swiper-container-fade .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-fade .swiper-slide-active,.swiper-container-fade .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-cube{overflow:visible}.swiper-container-cube .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1;visibility:hidden;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;width:100%;height:100%}.swiper-container-cube .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-cube.swiper-container-rtl .swiper-slide{-webkit-transform-origin:100% 0;-ms-transform-origin:100% 0;transform-origin:100% 0}.swiper-container-cube .swiper-slide-active,.swiper-container-cube .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-cube .swiper-slide-active,.swiper-container-cube .swiper-slide-next,.swiper-container-cube .swiper-slide-prev,.swiper-container-cube .swiper-slide-next+.swiper-slide{pointer-events:auto;visibility:visible}.swiper-container-cube .swiper-slide-shadow-top,.swiper-container-cube .swiper-slide-shadow-bottom,.swiper-container-cube .swiper-slide-shadow-left,.swiper-container-cube .swiper-slide-shadow-right{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-container-cube .swiper-cube-shadow{position:absolute;left:0;bottom:0px;width:100%;height:100%;background:#000;opacity:0.6;-webkit-filter:blur(50px);filter:blur(50px);z-index:0}.swiper-container-flip{overflow:visible}.swiper-container-flip .swiper-slide{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:1}.swiper-container-flip .swiper-slide .swiper-slide{pointer-events:none}.swiper-container-flip .swiper-slide-active,.swiper-container-flip .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-container-flip .swiper-slide-shadow-top,.swiper-container-flip .swiper-slide-shadow-bottom,.swiper-container-flip .swiper-slide-shadow-left,.swiper-container-flip .swiper-slide-shadow-right{z-index:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.swiper-container-coverflow .swiper-wrapper{-ms-perspective:1200px}ion-slides{display:block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.swiper-pagination-bullet{background:var(--bullet-background)}.swiper-pagination-bullet-active{background:var(--bullet-background-active)}.swiper-pagination-progressbar{background:var(--progress-bar-background)}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:var(--progress-bar-background-active)}.swiper-scrollbar{background:var(--scroll-bar-background)}.swiper-scrollbar-drag{background:var(--scroll-bar-background-active)}.slides-md{--bullet-background:var(--ion-color-step-200, #cccccc);--bullet-background-active:var(--ion-color-primary, #3880ff);--progress-bar-background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.25);--progress-bar-background-active:var(--ion-color-primary-shade, #3171e0);--scroll-bar-background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1);--scroll-bar-background-active:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.5)}",Slides=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.swiperReady=!1,this.swiper=new Promise(t=>{this.readySwiper=t}),this.options={},this.pager=!1,this.scrollbar=!1,this.ionSlidesDidLoad=createEvent(this,"ionSlidesDidLoad",7),this.ionSlideTap=createEvent(this,"ionSlideTap",7),this.ionSlideDoubleTap=createEvent(this,"ionSlideDoubleTap",7),this.ionSlideWillChange=createEvent(this,"ionSlideWillChange",7),this.ionSlideDidChange=createEvent(this,"ionSlideDidChange",7),this.ionSlideNextStart=createEvent(this,"ionSlideNextStart",7),this.ionSlidePrevStart=createEvent(this,"ionSlidePrevStart",7),this.ionSlideNextEnd=createEvent(this,"ionSlideNextEnd",7),this.ionSlidePrevEnd=createEvent(this,"ionSlidePrevEnd",7),this.ionSlideTransitionStart=createEvent(this,"ionSlideTransitionStart",7),this.ionSlideTransitionEnd=createEvent(this,"ionSlideTransitionEnd",7),this.ionSlideDrag=createEvent(this,"ionSlideDrag",7),this.ionSlideReachStart=createEvent(this,"ionSlideReachStart",7),this.ionSlideReachEnd=createEvent(this,"ionSlideReachEnd",7),this.ionSlideTouchStart=createEvent(this,"ionSlideTouchStart",7),this.ionSlideTouchEnd=createEvent(this,"ionSlideTouchEnd",7)}async optionsChanged(){if(this.swiperReady){const t=await this.getSwiper();Object.assign(t.params,this.options),await this.update()}}connectedCallback(){"undefined"!=typeof MutationObserver&&((this.mutationO=new MutationObserver(()=>{this.swiperReady&&this.update()})).observe(this.el,{childList:!0,subtree:!0}),this.el.componentOnReady().then(()=>this.initSwiper()))}async disconnectedCallback(){this.mutationO&&(this.mutationO.disconnect(),this.mutationO=void 0),(await this.getSwiper()).destroy(!0,!0),this.swiper=new Promise(t=>{this.readySwiper=t}),this.swiperReady=!1}async update(){const[t]=await Promise.all([this.getSwiper(),waitForSlides(this.el)]);t.update()}async updateAutoHeight(t){(await this.getSwiper()).updateAutoHeight(t)}async slideTo(t,e,i){(await this.getSwiper()).slideTo(t,e,i)}async slideNext(t,e){(await this.getSwiper()).slideNext(t,e)}async slidePrev(t,e){(await this.getSwiper()).slidePrev(t,e)}async getActiveIndex(){return(await this.getSwiper()).activeIndex}async getPreviousIndex(){return(await this.getSwiper()).previousIndex}async length(){return(await this.getSwiper()).slides.length}async isEnd(){return(await this.getSwiper()).isEnd}async isBeginning(){return(await this.getSwiper()).isBeginning}async startAutoplay(){const t=await this.getSwiper();t.autoplay&&t.autoplay.start()}async stopAutoplay(){const t=await this.getSwiper();t.autoplay&&t.autoplay.stop()}async lockSwipeToNext(t){(await this.getSwiper()).allowSlideNext=!t}async lockSwipeToPrev(t){(await this.getSwiper()).allowSlidePrev=!t}async lockSwipes(t){const e=await this.getSwiper();e.allowSlideNext=!t,e.allowSlidePrev=!t,e.allowTouchMove=!t}async getSwiper(){return this.swiper}async initSwiper(){const t=this.normalizeOptions(),{Swiper:e}=await import("./p-fd229165.mjs");await waitForSlides(this.el);const i=new e(this.el,t);this.swiperReady=!0,this.readySwiper(i)}normalizeOptions(){const t={effect:void 0,direction:"horizontal",initialSlide:0,loop:!1,parallax:!1,slidesPerView:1,spaceBetween:0,speed:300,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,touchEventsTarget:"container",autoplay:!1,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,zoom:{maxRatio:3,minRatio:1,toggle:!1},touchRatio:1,touchAngle:45,simulateTouch:!0,touchStartPreventDefault:!1,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,threshold:0,touchMoveStopPropagation:!0,touchReleaseOnEdges:!1,iOSEdgeSwipeDetection:!1,iOSEdgeSwipeThreshold:20,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,watchSlidesVisibility:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loopAdditionalSlides:0,noSwiping:!0,runCallbacksOnInit:!0,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},flipEffect:{slideShadows:!0,limitRotation:!0},cubeEffect:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fadeEffect:{crossfade:!1},a11y:{prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide"}};this.pager&&(t.pagination={el:this.paginationEl,type:"bullets",clickable:!1,hideOnClick:!1}),this.scrollbar&&(t.scrollbar={el:this.scrollbarEl,hide:!0});const e={on:{init:()=>{setTimeout(()=>{this.ionSlidesDidLoad.emit()},20)},slideChangeTransitionStart:this.ionSlideWillChange.emit,slideChangeTransitionEnd:this.ionSlideDidChange.emit,slideNextTransitionStart:this.ionSlideNextStart.emit,slidePrevTransitionStart:this.ionSlidePrevStart.emit,slideNextTransitionEnd:this.ionSlideNextEnd.emit,slidePrevTransitionEnd:this.ionSlidePrevEnd.emit,transitionStart:this.ionSlideTransitionStart.emit,transitionEnd:this.ionSlideTransitionEnd.emit,sliderMove:this.ionSlideDrag.emit,reachBeginning:this.ionSlideReachStart.emit,reachEnd:this.ionSlideReachEnd.emit,touchStart:this.ionSlideTouchStart.emit,touchEnd:this.ionSlideTouchEnd.emit,tap:this.ionSlideTap.emit,doubleTap:this.ionSlideDoubleTap.emit}},i={on:Object.assign(Object.assign({},this.options&&this.options.on?this.options.on:{}),e.on)};return Object.assign(Object.assign(Object.assign({},t),this.options),i)}render(){const t=getIonMode(this);return h(Host,{class:{[""+t]:!0,["slides-"+t]:!0,"swiper-container":!0}},h("div",{class:"swiper-wrapper"},h("slot",null)),this.pager&&h("div",{class:"swiper-pagination",ref:t=>this.paginationEl=t}),this.scrollbar&&h("div",{class:"swiper-scrollbar",ref:t=>this.scrollbarEl=t}))}static get assetsDirs(){return["swiper"]}get el(){return this}static get watchers(){return{options:["optionsChanged"]}}static get style(){return{ios:slidesIosCss,md:slidesMdCss}}},waitForSlides=t=>Promise.all(Array.from(t.querySelectorAll("ion-slide")).map(t=>t.componentOnReady())),spinnerCss=":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{left:0;top:0;-webkit-transform-origin:center;transform-origin:center;position:absolute;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}[dir=rtl] svg,:host-context([dir=rtl]) svg{left:unset;right:unset;right:0}[dir=rtl] svg,:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:4px;stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular){-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}",Spinner=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.paused=!1}getName(){const t=this.name||config.get("spinner"),e=getIonMode(this);return t||("ios"===e?"lines":"circular")}render(){const t=getIonMode(this),e=this.getName(),i=SPINNERS[e]||SPINNERS.lines,n="number"==typeof this.duration&&this.duration>10?this.duration:i.dur,s=[];if(void 0!==i.circles)for(let o=0;o<i.circles;o++)s.push(buildCircle(i,n,o,i.circles));else if(void 0!==i.lines)for(let o=0;o<i.lines;o++)s.push(buildLine(i,n,o,i.lines));return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0,["spinner-"+e]:!0,"spinner-paused":!!this.paused||config.getBoolean("_testing")}),role:"progressbar",style:i.elmDuration?{animationDuration:n+"ms"}:{}},s)}static get style(){return spinnerCss}},buildCircle=(t,e,i,n)=>{const s=t.fn(e,i,n);return s.style["animation-duration"]=e+"ms",h("svg",{viewBox:s.viewBox||"0 0 64 64",style:s.style},h("circle",{transform:s.transform||"translate(32,32)",cx:s.cx,cy:s.cy,r:s.r,style:t.elmDuration?{animationDuration:e+"ms"}:{}}))},buildLine=(t,e,i,n)=>{const s=t.fn(e,i,n);return s.style["animation-duration"]=e+"ms",h("svg",{viewBox:s.viewBox||"0 0 64 64",style:s.style},h("line",{transform:"translate(32,32)",y1:s.y1,y2:s.y2}))},splitPaneIosCss=":host{--side-width:100%;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:nowrap;flex-wrap:nowrap;contain:strict}::slotted(ion-menu.menu-pane-visible){-ms-flex:0 1 auto;flex:0 1 auto;width:var(--side-width);min-width:var(--side-min-width);max-width:var(--side-max-width)}:host(.split-pane-visible) ::slotted(.split-pane-side),:host(.split-pane-visible) ::slotted(.split-pane-main){left:0;right:0;top:0;bottom:0;position:relative;-webkit-box-shadow:none !important;box-shadow:none !important;z-index:0}:host(.split-pane-visible) ::slotted(.split-pane-main){-ms-flex:1;flex:1}:host(.split-pane-visible) ::slotted(.split-pane-side:not(ion-menu)),:host(.split-pane-visible) ::slotted(ion-menu.split-pane-side.menu-enabled){display:-ms-flexbox;display:flex;-ms-flex-negative:0;flex-shrink:0}::slotted(.split-pane-side:not(ion-menu)){display:none}:host(.split-pane-visible) ::slotted(.split-pane-side){-ms-flex-order:-1;order:-1}:host(.split-pane-visible) ::slotted(.split-pane-side[side=end]){-ms-flex-order:1;order:1}:host{--border:0.55px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));--side-min-width:270px;--side-max-width:28%}:host(.split-pane-visible) ::slotted(.split-pane-side){min-width:var(--side-min-width);max-width:var(--side-max-width);border-right:var(--border);border-left:0}:host(.split-pane-visible) ::slotted(.split-pane-side[side=end]){min-width:var(--side-min-width);max-width:var(--side-max-width);border-right:0;border-left:var(--border)}",splitPaneMdCss=":host{--side-width:100%;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:nowrap;flex-wrap:nowrap;contain:strict}::slotted(ion-menu.menu-pane-visible){-ms-flex:0 1 auto;flex:0 1 auto;width:var(--side-width);min-width:var(--side-min-width);max-width:var(--side-max-width)}:host(.split-pane-visible) ::slotted(.split-pane-side),:host(.split-pane-visible) ::slotted(.split-pane-main){left:0;right:0;top:0;bottom:0;position:relative;-webkit-box-shadow:none !important;box-shadow:none !important;z-index:0}:host(.split-pane-visible) ::slotted(.split-pane-main){-ms-flex:1;flex:1}:host(.split-pane-visible) ::slotted(.split-pane-side:not(ion-menu)),:host(.split-pane-visible) ::slotted(ion-menu.split-pane-side.menu-enabled){display:-ms-flexbox;display:flex;-ms-flex-negative:0;flex-shrink:0}::slotted(.split-pane-side:not(ion-menu)){display:none}:host(.split-pane-visible) ::slotted(.split-pane-side){-ms-flex-order:-1;order:-1}:host(.split-pane-visible) ::slotted(.split-pane-side[side=end]){-ms-flex-order:1;order:1}:host{--border:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--side-min-width:270px;--side-max-width:28%}:host(.split-pane-visible) ::slotted(.split-pane-side){min-width:var(--side-min-width);max-width:var(--side-max-width);border-right:var(--border);border-left:0}:host(.split-pane-visible) ::slotted(.split-pane-side[side=end]){min-width:var(--side-min-width);max-width:var(--side-max-width);border-right:0;border-left:var(--border)}",SPLIT_PANE_MAIN="split-pane-main",SPLIT_PANE_SIDE="split-pane-side",QUERY$1={xs:"(min-width: 0px)",sm:"(min-width: 576px)",md:"(min-width: 768px)",lg:"(min-width: 992px)",xl:"(min-width: 1200px)",never:""},SplitPane=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.visible=!1,this.disabled=!1,this.when=QUERY$1.lg,this.ionSplitPaneVisible=createEvent(this,"ionSplitPaneVisible",7)}visibleChanged(t){const e={visible:t,isPane:this.isPane.bind(this)};this.ionSplitPaneVisible.emit(e)}connectedCallback(){this.styleChildren(),this.updateState()}disconnectedCallback(){this.rmL&&(this.rmL(),this.rmL=void 0)}updateState(){if(this.rmL&&(this.rmL(),this.rmL=void 0),this.disabled)return void(this.visible=!1);const t=this.when;if("boolean"==typeof t)return void(this.visible=t);const e=QUERY$1[t]||t;if(0!==e.length){if(window.matchMedia){const t=t=>{this.visible=t.matches},i=window.matchMedia(e);i.addListener(t),this.rmL=()=>i.removeListener(t),this.visible=i.matches}}else this.visible=!1}isPane(t){return!!this.visible&&t.parentElement===this.el&&t.classList.contains(SPLIT_PANE_SIDE)}styleChildren(){const t=this.contentId,e=this.el.children,i=this.el.childElementCount;let n=!1;for(let s=0;s<i;s++){const i=e[s],o=void 0!==t&&i.id===t;if(o){if(n)return void console.warn("split pane cannot have more than one main node");n=!0}setPaneClass(i,o)}n||console.warn("split pane does not have a specified main node")}render(){const t=getIonMode(this);return h(Host,{class:{[t]:!0,["split-pane-"+t]:!0,"split-pane-visible":this.visible}},h("slot",null))}get el(){return this}static get watchers(){return{visible:["visibleChanged"],disabled:["updateState"],when:["updateState"]}}static get style(){return{ios:splitPaneIosCss,md:splitPaneMdCss}}},setPaneClass=(t,e)=>{let i,n;e?(i=SPLIT_PANE_MAIN,n=SPLIT_PANE_SIDE):(i=SPLIT_PANE_SIDE,n=SPLIT_PANE_MAIN);const s=t.classList;s.add(i),s.remove(n)},tabCss=":host(.tab-hidden){display:none !important}",Tab=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.loaded=!1,this.active=!1}async componentWillLoad(){this.active&&await this.setActive()}async setActive(){await this.prepareLazyLoaded(),this.active=!0}changeActive(t){t&&this.prepareLazyLoaded()}prepareLazyLoaded(){if(!this.loaded&&null!=this.component){this.loaded=!0;try{return attachComponent(this.delegate,this.el,this.component,["ion-page"])}catch(e){console.error(e)}}return Promise.resolve(void 0)}render(){const{tab:t,active:e,component:i}=this;return h(Host,{role:"tabpanel","aria-hidden":e?null:"true","aria-labelledby":"tab-button-"+t,class:{"ion-page":void 0===i,"tab-hidden":!e}},h("slot",null))}get el(){return this}static get watchers(){return{active:["changeActive"]}}static get style(){return tabCss}},tabBarIosCss=":host{padding-left:var(--ion-safe-area-left);padding-right:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--color:var(--ion-tab-bar-color, var(--ion-color-step-400, #999999));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",tabBarMdCss=":host{padding-left:var(--ion-safe-area-left);padding-right:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.07))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, #666666));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:56px}",TabBar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.keyboardVisible=!1,this.translucent=!1,this.ionTabBarChanged=createEvent(this,"ionTabBarChanged",7)}selectedTabChanged(){void 0!==this.selectedTab&&this.ionTabBarChanged.emit({tab:this.selectedTab})}onKeyboardWillHide(){setTimeout(()=>this.keyboardVisible=!1,50)}onKeyboardWillShow(){"top"!==this.el.getAttribute("slot")&&(this.keyboardVisible=!0)}componentWillLoad(){this.selectedTabChanged()}render(){const{color:t,translucent:e,keyboardVisible:i}=this,n=getIonMode(this);return h(Host,{role:"tablist","aria-hidden":i?"true":null,class:Object.assign(Object.assign({},createColorClasses(t)),{[n]:!0,"tab-bar-translucent":e,"tab-bar-hidden":i})},h("slot",null))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:tabBarIosCss,md:tabBarMdCss}}},tabButtonIosCss=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){padding-left:6px;padding-right:6px;padding-top:1px;padding-bottom:1px;left:calc(50% + 6px);top:4px;height:auto;font-size:12px;line-height:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-badge){padding-left:unset;padding-right:unset;-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px}}[dir=rtl] ::slotted(ion-badge),:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:30px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:calc(50% + 12px)}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:calc(50% + 35px);top:10px}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:calc(50% + 30px);top:10px}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}',tabButtonMdCss=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}[dir=rtl] ::slotted(ion-icon),:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}::slotted(ion-badge){border-radius:8px;padding-left:2px;padding-right:2px;padding-top:3px;padding-bottom:2px;left:calc(50% + 6px);top:8px;min-width:12px;font-size:8px;font-weight:normal}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(ion-badge){padding-left:unset;padding-right:unset;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px}}[dir=rtl] ::slotted(ion-badge),:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:70%;top:8px}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:70%}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:80%;top:16px}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:80%}:host(.tab-layout-icon-start) ::slotted(ion-icon){margin-right:6px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-icon){margin-right:unset;-webkit-margin-end:6px;margin-inline-end:6px}}:host(.tab-layout-icon-end) ::slotted(ion-icon){margin-left:6px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.tab-layout-icon-end) ::slotted(ion-icon){margin-left:unset;-webkit-margin-start:6px;margin-inline-start:6px}}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:70%;top:16px}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:70%}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',TabButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.disabled=!1,this.selected=!1,this.onKeyUp=t=>{"Enter"!==t.key&&" "!==t.key||this.selectTab(t)},this.onClick=t=>{this.selectTab(t)},this.ionTabButtonClick=createEvent(this,"ionTabButtonClick",7)}onTabBarChanged(t){this.selected=this.tab===t.detail.tab}componentWillLoad(){void 0===this.layout&&(this.layout=config.get("tabButtonLayout","icon-top"))}selectTab(t){void 0!==this.tab&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),t.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}get tabIndex(){return this.disabled?-1:this.el.hasAttribute("tabindex")?this.el.getAttribute("tabindex"):0}render(){const{disabled:t,hasIcon:e,hasLabel:i,tabIndex:n,href:s,rel:o,target:r,layout:a,selected:l,tab:c}=this,d=getIonMode(this);return h(Host,{onClick:this.onClick,onKeyup:this.onKeyUp,role:"tab",tabindex:n,"aria-selected":l?"true":null,id:void 0!==c?"tab-button-"+c:null,class:{[d]:!0,"tab-selected":l,"tab-disabled":t,"tab-has-label":i,"tab-has-icon":e,"tab-has-label-only":i&&!e,"tab-has-icon-only":e&&!i,["tab-layout-"+a]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},h("a",Object.assign({},{download:this.download,href:s,rel:o,target:r},{tabIndex:-1,class:"button-native"}),h("span",{class:"button-inner"},h("slot",null)),"md"===d&&h("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:tabButtonIosCss,md:tabButtonMdCss}}},tabsCss=":host{left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%;contain:layout size style;z-index:0}.tabs-inner{position:relative;-ms-flex:1;flex:1;contain:layout size style}",Tabs=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.transitioning=!1,this.useRouter=!1,this.onTabClicked=t=>{const{href:e,tab:i}=t.detail;if(this.useRouter&&void 0!==e){const t=document.querySelector("ion-router");t&&t.push(e)}else this.select(i)},this.ionNavWillLoad=createEvent(this,"ionNavWillLoad",7),this.ionTabsWillChange=createEvent(this,"ionTabsWillChange",3),this.ionTabsDidChange=createEvent(this,"ionTabsDidChange",3)}async componentWillLoad(){if(this.useRouter||(this.useRouter=!!document.querySelector("ion-router")&&!this.el.closest("[no-router]")),!this.useRouter){const t=this.tabs;t.length>0&&await this.select(t[0])}this.ionNavWillLoad.emit()}componentWillRender(){const t=this.el.querySelector("ion-tab-bar");t&&(t.selectedTab=this.selectedTab?this.selectedTab.tab:void 0)}async select(t){const e=getTab(this.tabs,t);return!!this.shouldSwitch(e)&&(await this.setActive(e),await this.notifyRouter(),this.tabSwitch(),!0)}async getTab(t){return getTab(this.tabs,t)}getSelected(){return Promise.resolve(this.selectedTab?this.selectedTab.tab:void 0)}async setRouteId(t){const e=getTab(this.tabs,t);return this.shouldSwitch(e)?(await this.setActive(e),{changed:!0,element:this.selectedTab,markVisible:()=>this.tabSwitch()}):{changed:!1,element:this.selectedTab}}async getRouteId(){const t=this.selectedTab&&this.selectedTab.tab;return void 0!==t?{id:t,element:this.selectedTab}:void 0}setActive(t){return this.transitioning?Promise.reject("transitioning already happening"):(this.transitioning=!0,this.leavingTab=this.selectedTab,this.selectedTab=t,this.ionTabsWillChange.emit({tab:t.tab}),t.active=!0,Promise.resolve())}tabSwitch(){const t=this.selectedTab,e=this.leavingTab;this.leavingTab=void 0,this.transitioning=!1,t&&e!==t&&(e&&(e.active=!1),this.ionTabsDidChange.emit({tab:t.tab}))}notifyRouter(){if(this.useRouter){const t=document.querySelector("ion-router");if(t)return t.navChanged("forward")}return Promise.resolve(!1)}shouldSwitch(t){return void 0!==t&&t!==this.selectedTab&&!this.transitioning}get tabs(){return Array.from(this.el.querySelectorAll("ion-tab"))}render(){return h(Host,{onIonTabButtonClick:this.onTabClicked},h("slot",{name:"top"}),h("div",{class:"tabs-inner"},h("slot",null)),h("slot",{name:"bottom"}))}get el(){return this}static get style(){return tabsCss}},getTab=(t,e)=>{const i="string"==typeof e?t.find(t=>t.tab===e):e;return i||console.error(`tab with id: "${i}" does not exist`),i},textCss=":host(.ion-color){color:var(--ion-color-base)}",Text=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){const t=getIonMode(this);return h(Host,{class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0})},h("slot",null))}static get style(){return textCss}},textareaIosCss=".sc-ion-textarea-ios-h{--background:initial;--color:initial;--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--border-radius:0;display:block;position:relative;-ms-flex:1;flex:1;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);white-space:pre-wrap;z-index:2}.ion-color.sc-ion-textarea-ios-h{background:initial}.ion-color.sc-ion-textarea-ios-h{color:var(--ion-color-base)}ion-item.sc-ion-textarea-ios-h,ion-item .sc-ion-textarea-ios-h{-ms-flex-item-align:baseline;align-self:baseline}ion-item.sc-ion-textarea-ios-h:not(.item-label),ion-item:not(.item-label) .sc-ion-textarea-ios-h{--padding-start:0}.native-textarea.sc-ion-textarea-ios{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;resize:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.native-textarea.sc-ion-textarea-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.native-textarea.sc-ion-textarea-ios::-webkit-input-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-ios::-moz-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-ios:-ms-input-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-ios::-ms-input-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-ios::placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea[disabled].sc-ion-textarea-ios{opacity:0.4}.cloned-input.sc-ion-textarea-ios{left:0;top:0;position:absolute;pointer-events:none}[dir=rtl].sc-ion-textarea-ios .cloned-input.sc-ion-textarea-ios,[dir=rtl].sc-ion-textarea-ios-h .cloned-input.sc-ion-textarea-ios,[dir=rtl] .sc-ion-textarea-ios-h .cloned-input.sc-ion-textarea-ios{left:unset;right:unset;right:0}.sc-ion-textarea-ios-h{--padding-top:10px;--padding-end:10px;--padding-bottom:10px;--padding-start:0;font-size:inherit}.item-label-stacked.sc-ion-textarea-ios-h,.item-label-stacked .sc-ion-textarea-ios-h,.item-label-floating.sc-ion-textarea-ios-h,.item-label-floating .sc-ion-textarea-ios-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0px}",textareaMdCss=".sc-ion-textarea-md-h{--background:initial;--color:initial;--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;--border-radius:0;display:block;position:relative;-ms-flex:1;flex:1;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);white-space:pre-wrap;z-index:2}.ion-color.sc-ion-textarea-md-h{background:initial}.ion-color.sc-ion-textarea-md-h{color:var(--ion-color-base)}ion-item.sc-ion-textarea-md-h,ion-item .sc-ion-textarea-md-h{-ms-flex-item-align:baseline;align-self:baseline}ion-item.sc-ion-textarea-md-h:not(.item-label),ion-item:not(.item-label) .sc-ion-textarea-md-h{--padding-start:0}.native-textarea.sc-ion-textarea-md{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;resize:none;-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.native-textarea.sc-ion-textarea-md{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.native-textarea.sc-ion-textarea-md::-webkit-input-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-md::-moz-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-md:-ms-input-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-md::-ms-input-placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea.sc-ion-textarea-md::placeholder{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-textarea[disabled].sc-ion-textarea-md{opacity:0.4}.cloned-input.sc-ion-textarea-md{left:0;top:0;position:absolute;pointer-events:none}[dir=rtl].sc-ion-textarea-md .cloned-input.sc-ion-textarea-md,[dir=rtl].sc-ion-textarea-md-h .cloned-input.sc-ion-textarea-md,[dir=rtl] .sc-ion-textarea-md-h .cloned-input.sc-ion-textarea-md{left:unset;right:unset;right:0}.sc-ion-textarea-md-h{--padding-top:10px;--padding-end:0;--padding-bottom:11px;--padding-start:8px;margin-left:0;margin-right:0;margin-top:8px;margin-bottom:0;font-size:inherit}.item-label-stacked.sc-ion-textarea-md-h,.item-label-stacked .sc-ion-textarea-md-h,.item-label-floating.sc-ion-textarea-md-h,.item-label-floating .sc-ion-textarea-md-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0}",Textarea=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.inputId="ion-input-"+textareaIds++,this.didBlurAfterEdit=!1,this.hasFocus=!1,this.autocapitalize="none",this.autofocus=!1,this.clearOnEdit=!1,this.debounce=0,this.disabled=!1,this.name=this.inputId,this.readonly=!1,this.required=!1,this.spellcheck=!1,this.autoGrow=!1,this.value="",this.onInput=t=>{this.nativeInput&&(this.value=this.nativeInput.value),this.emitStyle(),this.ionInput.emit(t)},this.onFocus=()=>{this.hasFocus=!0,this.focusChange(),this.ionFocus.emit()},this.onBlur=()=>{this.hasFocus=!1,this.focusChange(),this.ionBlur.emit()},this.onKeyDown=()=>{this.checkClearOnEdit()},this.ionChange=createEvent(this,"ionChange",7),this.ionInput=createEvent(this,"ionInput",7),this.ionStyle=createEvent(this,"ionStyle",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionFocus=createEvent(this,"ionFocus",7)}debounceChanged(){this.ionChange=debounceEvent(this.ionChange,this.debounce)}disabledChanged(){this.emitStyle()}valueChanged(){const t=this.nativeInput,e=this.getValue();t&&t.value!==e&&(t.value=e),this.runAutoGrow(),this.emitStyle(),this.ionChange.emit({value:e})}connectedCallback(){this.emitStyle(),this.debounceChanged(),document.dispatchEvent(new CustomEvent("ionInputDidLoad",{detail:this.el}))}disconnectedCallback(){document.dispatchEvent(new CustomEvent("ionInputDidUnload",{detail:this.el}))}componentDidLoad(){this.runAutoGrow()}runAutoGrow(){const t=this.nativeInput;t&&this.autoGrow&&readTask(()=>{t.style.height="auto",t.style.height=t.scrollHeight+"px",this.textareaWrapper&&(this.textareaWrapper.style.height=t.scrollHeight+"px")})}async setFocus(){this.nativeInput&&this.nativeInput.focus()}getInputElement(){return Promise.resolve(this.nativeInput)}emitStyle(){this.ionStyle.emit({interactive:!0,textarea:!0,input:!0,"interactive-disabled":this.disabled,"has-placeholder":null!=this.placeholder,"has-value":this.hasValue(),"has-focus":this.hasFocus})}checkClearOnEdit(){this.clearOnEdit&&(this.didBlurAfterEdit&&this.hasValue()&&(this.value=""),this.didBlurAfterEdit=!1)}focusChange(){this.clearOnEdit&&!this.hasFocus&&this.hasValue()&&(this.didBlurAfterEdit=!0),this.emitStyle()}hasValue(){return""!==this.getValue()}getValue(){return this.value||""}render(){const t=getIonMode(this),e=this.getValue(),i=this.inputId+"-lbl",n=findItemLabel(this.el);return n&&(n.id=i),h(Host,{"aria-disabled":this.disabled?"true":null,class:Object.assign(Object.assign({},createColorClasses(this.color)),{[t]:!0})},h("div",{class:"textarea-wrapper",ref:t=>this.textareaWrapper=t},h("textarea",{class:"native-textarea",ref:t=>this.nativeInput=t,autoCapitalize:this.autocapitalize,autoFocus:this.autofocus,disabled:this.disabled,maxLength:this.maxlength,minLength:this.minlength,name:this.name,placeholder:this.placeholder||"",readOnly:this.readonly,required:this.required,spellCheck:this.spellcheck,cols:this.cols,rows:this.rows,wrap:this.wrap,onInput:this.onInput,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeyDown},e)))}get el(){return this}static get watchers(){return{debounce:["debounceChanged"],disabled:["disabledChanged"],value:["valueChanged"]}}static get style(){return{ios:textareaIosCss,md:textareaMdCss}}};let textareaIds=0;const thumbnailCss=":host{--size:48px;--border-radius:0;border-radius:var(--border-radius);display:block;width:var(--size);height:var(--size)}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}",Thumbnail=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h(Host,{class:getIonMode(this)},h("slot",null))}static get style(){return thumbnailCss}},titleIosCss=":host{--color:initial;display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}.toolbar-title{display:block;width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;pointer-events:auto}:host(.title-small) .toolbar-title{white-space:normal}:host{left:0;top:0;padding-left:90px;padding-right:90px;padding-top:0;padding-bottom:0;position:absolute;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0);font-size:17px;font-weight:600;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host-context([dir=rtl]){left:unset;right:unset;right:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:90px;padding-inline-start:90px;-webkit-padding-end:90px;padding-inline-end:90px}}:host(.title-small){padding-left:9px;padding-right:9px;padding-top:6px;padding-bottom:16px;position:relative;font-size:13px;font-weight:normal}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.title-small){padding-left:unset;padding-right:unset;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px}}:host(.title-large){padding-left:16px;padding-right:16px;padding-top:0;padding-bottom:0;bottom:0;-ms-flex-align:end;align-items:flex-end;min-width:100%;padding-bottom:6px;font-size:34px;font-weight:700;text-align:start}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.title-large){padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}:host(.title-large.ion-cloned-element){--color:var(--ion-text-color, #000)}",titleMdCss=":host{--color:initial;display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);color:var(--color)}:host(.ion-color){color:var(--ion-color-base)}.toolbar-title{display:block;width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;pointer-events:auto}:host(.title-small) .toolbar-title{white-space:normal}:host{padding-left:20px;padding-right:20px;padding-top:0;padding-bottom:0;font-size:20px;font-weight:500;letter-spacing:0.0125em}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:20px;padding-inline-start:20px;-webkit-padding-end:20px;padding-inline-end:20px}}:host(.title-small){width:100%;height:100%;font-size:15px;font-weight:normal}",ToolbarTitle=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.ionStyle=createEvent(this,"ionStyle",7)}sizeChanged(){this.emitStyle()}connectedCallback(){this.emitStyle()}emitStyle(){const t=this.getSize();this.ionStyle.emit({["title-"+t]:!0})}getSize(){return void 0!==this.size?this.size:"default"}render(){const t=getIonMode(this),e=this.getSize();return h(Host,{class:Object.assign({[t]:!0,["title-"+e]:!0},createColorClasses(this.color))},h("div",{class:"toolbar-title"},h("slot",null)))}get el(){return this}static get watchers(){return{size:["sizeChanged"]}}static get style(){return{ios:titleIosCss,md:titleMdCss}}},iosEnterAnimation$6=(t,e)=>{const i=createAnimation(),n=createAnimation(),s=t.host||t,o=t.querySelector(".toast-wrapper");switch(n.addElement(o),e){case"top":n.fromTo("transform","translateY(-100%)","translateY(calc(10px + var(--ion-safe-area-top, 0px)))");break;case"middle":const t=Math.floor(s.clientHeight/2-o.clientHeight/2);o.style.top=t+"px",n.fromTo("opacity",.01,1);break;default:n.fromTo("transform","translateY(100%)","translateY(calc(-10px - var(--ion-safe-area-bottom, 0px)))")}return i.addElement(s).easing("cubic-bezier(.155,1.105,.295,1.12)").duration(400).addAnimation(n)},iosLeaveAnimation$6=(t,e)=>{const i=createAnimation(),n=createAnimation(),s=t.host||t,o=t.querySelector(".toast-wrapper");switch(n.addElement(o),e){case"top":n.fromTo("transform","translateY(calc(10px + var(--ion-safe-area-top, 0px)))","translateY(-100%)");break;case"middle":n.fromTo("opacity",.99,0);break;default:n.fromTo("transform","translateY(calc(-10px - var(--ion-safe-area-bottom, 0px)))","translateY(100%)")}return i.addElement(s).easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(n)},mdEnterAnimation$5=(t,e)=>{const i=createAnimation(),n=createAnimation(),s=t.host||t,o=t.querySelector(".toast-wrapper");switch(n.addElement(o),e){case"top":o.style.top="calc(8px + var(--ion-safe-area-top, 0px))",n.fromTo("opacity",.01,1);break;case"middle":const t=Math.floor(s.clientHeight/2-o.clientHeight/2);o.style.top=t+"px",n.fromTo("opacity",.01,1);break;default:o.style.bottom="calc(8px + var(--ion-safe-area-bottom, 0px))",n.fromTo("opacity",.01,1)}return i.addElement(s).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation(n)},mdLeaveAnimation$5=t=>{const e=createAnimation(),i=createAnimation(),n=t.host||t,s=t.querySelector(".toast-wrapper");return i.addElement(s).fromTo("opacity",.99,0),e.addElement(n).easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(i)},toastIosCss=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;left:0;top:0;display:block;position:absolute;width:100%;height:100%;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host-context([dir=rtl]){left:unset;right:unset;right:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);left:var(--start);right:var(--end);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}[dir=rtl] .toast-wrapper,:host-context([dir=rtl]) .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:auto;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-message{-ms-flex:1;flex:1;white-space:pre-wrap}.toast-button-group{display:-ms-flexbox;display:flex}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-50, #f2f2f2);--border-radius:14px;--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-850, #262626);--max-width:700px;--start:10px;--end:10px;font-size:14px}.toast-wrapper{margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-wrapper{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.toast-translucent) .toast-wrapper{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-middle{opacity:0.01}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-content{padding-left:15px;padding-right:15px;padding-top:15px;padding-bottom:15px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-content{padding-left:unset;padding-right:unset;-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px}}.toast-header{margin-bottom:2px;font-weight:500}.toast-button{padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;height:44px;-webkit-transition:background-color, opacity 100ms linear;transition:background-color, opacity 100ms linear;border:0;background-color:transparent;font-family:var(--ion-font-family);font-size:17px;font-weight:500;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button{padding-left:unset;padding-right:unset;-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px}}.toast-button.ion-activated{opacity:0.4}@media (any-hover: hover){.toast-button:hover{opacity:0.6}}",toastMdCss=":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;left:0;top:0;display:block;position:absolute;width:100%;height:100%;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host-context([dir=rtl]){left:unset;right:unset;right:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);left:var(--start);right:var(--end);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}[dir=rtl] .toast-wrapper,:host-context([dir=rtl]) .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:auto;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-message{-ms-flex:1;flex:1;white-space:pre-wrap}.toast-button-group{display:-ms-flexbox;display:flex}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-800, #333333);--border-radius:4px;--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-50, #f2f2f2);--max-width:700px;--start:8px;--end:8px;font-size:14px}.toast-wrapper{margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;opacity:0.01;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-wrapper{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.toast-content{padding-left:16px;padding-right:16px;padding-top:14px;padding-bottom:14px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-content{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.toast-header{margin-bottom:2px;font-weight:500;line-height:20px}.toast-message{line-height:20px}.toast-button-group-start{margin-left:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button-group-start{margin-left:unset;-webkit-margin-start:8px;margin-inline-start:8px}}.toast-button-group-end{margin-right:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button-group-end{margin-right:unset;-webkit-margin-end:8px;margin-inline-end:8px}}.toast-button{padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;font-family:var(--ion-font-family);font-size:14px;font-weight:500;letter-spacing:0.84px;text-transform:uppercase;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button{padding-left:unset;padding-right:unset;-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px}}.toast-button-cancel{color:var(--ion-color-step-100, #e6e6e6)}.toast-button-icon-only{border-radius:50%;padding-left:9px;padding-right:9px;padding-top:9px;padding-bottom:9px;width:36px;height:36px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button-icon-only{padding-left:unset;padding-right:unset;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px}}@media (any-hover: hover){.toast-button:hover{background-color:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.08)}.toast-button-cancel:hover{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.08)}}",Toast=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.presented=!1,this.duration=0,this.keyboardClose=!1,this.position="bottom",this.translucent=!1,this.animated=!0,this.dispatchCancelHandler=t=>{if(isCancel(t.detail.role)){const t=this.getButtons().find(t=>"cancel"===t.role);this.callButtonHandler(t)}},prepareOverlay(this.el),this.didPresent=createEvent(this,"ionToastDidPresent",7),this.willPresent=createEvent(this,"ionToastWillPresent",7),this.willDismiss=createEvent(this,"ionToastWillDismiss",7),this.didDismiss=createEvent(this,"ionToastDidDismiss",7)}async present(){await present(this,"toastEnter",iosEnterAnimation$6,mdEnterAnimation$5,this.position),this.duration>0&&(this.durationTimeout=setTimeout(()=>this.dismiss(void 0,"timeout"),this.duration))}dismiss(t,e){return this.durationTimeout&&clearTimeout(this.durationTimeout),dismiss(this,t,e,"toastLeave",iosLeaveAnimation$6,mdLeaveAnimation$5,this.position)}onDidDismiss(){return eventMethod(this.el,"ionToastDidDismiss")}onWillDismiss(){return eventMethod(this.el,"ionToastWillDismiss")}getButtons(){return this.buttons?this.buttons.map(t=>"string"==typeof t?{text:t}:t):[]}async buttonClick(t){const e=t.role;return isCancel(e)||await this.callButtonHandler(t)?this.dismiss(void 0,e):Promise.resolve()}async callButtonHandler(t){if(t&&t.handler)try{if(!1===await safeCall$1(t.handler))return!1}catch(e){console.error(e)}return!0}renderButtons(t,e){if(0===t.length)return;const i=getIonMode(this);return h("div",{class:{"toast-button-group":!0,["toast-button-group-"+e]:!0}},t.map(t=>h("button",{type:"button",class:buttonClass$3(t),tabIndex:0,onClick:()=>this.buttonClick(t),part:"button"},h("div",{class:"toast-button-inner"},t.icon&&h("ion-icon",{icon:t.icon,slot:void 0===t.text?"icon-only":void 0,class:"toast-icon"}),t.text),"md"===i&&h("ion-ripple-effect",{type:void 0!==t.icon&&void 0===t.text?"unbounded":"bounded"}))))}render(){const t=this.getButtons(),e=t.filter(t=>"start"===t.side),i=t.filter(t=>"start"!==t.side),n=getIonMode(this),s={"toast-wrapper":!0,["toast-"+this.position]:!0};return h(Host,{style:{zIndex:""+(6e4+this.overlayIndex)},class:Object.assign(Object.assign(Object.assign({[n]:!0},createColorClasses(this.color)),getClassMap(this.cssClass)),{"toast-translucent":this.translucent}),onIonToastWillDismiss:this.dispatchCancelHandler},h("div",{class:s},h("div",{class:"toast-container",part:"container"},this.renderButtons(e,"start"),h("div",{class:"toast-content"},void 0!==this.header&&h("div",{class:"toast-header",part:"header"},this.header),void 0!==this.message&&h("div",{class:"toast-message",part:"message",innerHTML:sanitizeDOMString(this.message)})),this.renderButtons(i,"end"))))}get el(){return this}static get style(){return{ios:toastIosCss,md:toastMdCss}}},buttonClass$3=t=>Object.assign({"toast-button":!0,"toast-button-icon-only":void 0!==t.icon&&void 0===t.text,["toast-button-"+t.role]:void 0!==t.role,"ion-focusable":!0,"ion-activatable":!0},getClassMap(t.cssClass)),toggleIosCss=":host{-webkit-box-sizing:content-box !important;box-sizing:content-box !important;display:inline-block;outline:none;contain:content;cursor:pointer;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.ion-focused) input{border:2px solid #5e9ed6}:host(.toggle-disabled){pointer-events:none}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.088);--background-checked:var(--ion-color-primary, #3880ff);--handle-background:#ffffff;--handle-background-checked:#ffffff;--border-radius:16px;--handle-border-radius:14px;-webkit-box-sizing:content-box;box-sizing:content-box;position:relative;width:51px;height:32px;contain:strict}:host(.ion-color.toggle-checked) .toggle-icon{background:var(--ion-color-base)}.toggle-icon{border-radius:var(--border-radius);display:block;position:relative;width:100%;height:100%;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);-webkit-transition:background-color 300ms;transition:background-color 300ms;background:var(--background);overflow:hidden;pointer-events:none}.toggle-inner{left:2px;top:2px;border-radius:var(--handle-border-radius);position:absolute;width:28px;height:28px;-webkit-transition:width 120ms ease-in-out 80ms, left 110ms ease-in-out 80ms, right 110ms ease-in-out 80ms, -webkit-transform 300ms;transition:width 120ms ease-in-out 80ms, left 110ms ease-in-out 80ms, right 110ms ease-in-out 80ms, -webkit-transform 300ms;transition:transform 300ms, width 120ms ease-in-out 80ms, left 110ms ease-in-out 80ms, right 110ms ease-in-out 80ms;transition:transform 300ms, width 120ms ease-in-out 80ms, left 110ms ease-in-out 80ms, right 110ms ease-in-out 80ms, -webkit-transform 300ms;background:var(--handle-background);-webkit-box-shadow:0 3px 12px rgba(0, 0, 0, 0.16), 0 3px 1px rgba(0, 0, 0, 0.1);box-shadow:0 3px 12px rgba(0, 0, 0, 0.16), 0 3px 1px rgba(0, 0, 0, 0.1);will-change:transform;contain:strict}[dir=rtl] .toggle-inner,:host-context([dir=rtl]) .toggle-inner{left:unset;right:unset;right:2px}:host(.toggle-checked) .toggle-icon{background:var(--background-checked)}:host(.toggle-activated) .toggle-icon::before,:host(.toggle-checked) .toggle-icon::before{-webkit-transform:scale3d(0, 0, 0);transform:scale3d(0, 0, 0)}:host(.toggle-checked) .toggle-inner{-webkit-transform:translate3d(19px,  0,  0);transform:translate3d(19px,  0,  0);background:var(--handle-background-checked)}:host-context([dir=rtl]):host(.toggle-checked) .toggle-inner,:host-context([dir=rtl]).toggle-checked .toggle-inner{-webkit-transform:translate3d(calc(-1 * 19px),  0,  0);transform:translate3d(calc(-1 * 19px),  0,  0)}:host(.toggle-activated.toggle-checked) .toggle-inner::before{-webkit-transform:scale3d(0, 0, 0);transform:scale3d(0, 0, 0)}:host(.toggle-activated) .toggle-inner{width:34px}:host(.toggle-activated.toggle-checked) .toggle-inner{left:-4px}:host-context([dir=rtl]):host(.toggle-activated.toggle-checked) .toggle-inner,:host-context([dir=rtl]).toggle-activated.toggle-checked .toggle-inner{left:unset;right:unset;right:-4px}:host(.toggle-disabled){opacity:0.3}:host(.in-item[slot]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:20px;padding-right:10px;padding-top:6px;padding-bottom:5px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot]){padding-left:unset;padding-right:unset;-webkit-padding-start:20px;padding-inline-start:20px;-webkit-padding-end:10px;padding-inline-end:10px}}:host(.in-item[slot=start]){padding-left:0;padding-right:16px;padding-top:6px;padding-bottom:5px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot=start]){padding-left:unset;padding-right:unset;-webkit-padding-start:0;padding-inline-start:0;-webkit-padding-end:16px;padding-inline-end:16px}}",toggleMdCss=":host{-webkit-box-sizing:content-box !important;box-sizing:content-box !important;display:inline-block;outline:none;contain:content;cursor:pointer;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:2}:host(.ion-focused) input{border:2px solid #5e9ed6}:host(.toggle-disabled){pointer-events:none}button{left:0;top:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;position:absolute;width:100%;height:100%;border:0;background:transparent;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none}[dir=rtl] button,:host-context([dir=rtl]) button{left:unset;right:unset;right:0}button::-moz-focus-inner{border:0}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.3);--background-checked:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.5);--handle-background:#ffffff;--handle-background-checked:var(--ion-color-primary, #3880ff);--border-radius:14px;--handle-border-radius:50%;padding-left:12px;padding-right:12px;padding-top:12px;padding-bottom:12px;-webkit-box-sizing:content-box;box-sizing:content-box;position:relative;width:36px;height:14px;contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:12px;padding-inline-start:12px;-webkit-padding-end:12px;padding-inline-end:12px}}:host(.ion-color.toggle-checked) .toggle-icon{background:rgba(var(--ion-color-base-rgb), 0.5)}:host(.ion-color.toggle-checked) .toggle-inner{background:var(--ion-color-base)}.toggle-icon{border-radius:var(--border-radius);display:block;position:relative;width:100%;height:100%;-webkit-transition:background-color 160ms;transition:background-color 160ms;background:var(--background);pointer-events:none}.toggle-inner{left:0;top:-3px;border-radius:var(--handle-border-radius);position:absolute;width:20px;height:20px;-webkit-transition-duration:160ms;transition-duration:160ms;-webkit-transition-property:background-color, -webkit-transform;transition-property:background-color, -webkit-transform;transition-property:transform, background-color;transition-property:transform, background-color, -webkit-transform;-webkit-transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);background:var(--handle-background);-webkit-box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);box-shadow:0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 1px 5px 0 rgba(0, 0, 0, 0.12);will-change:transform, background-color;contain:strict}[dir=rtl] .toggle-inner,:host-context([dir=rtl]) .toggle-inner{left:unset;right:unset;right:0}:host(.toggle-checked) .toggle-icon{background:var(--background-checked)}:host(.toggle-checked) .toggle-inner{-webkit-transform:translate3d(16px,  0,  0);transform:translate3d(16px,  0,  0);background:var(--handle-background-checked)}:host-context([dir=rtl]):host(.toggle-checked) .toggle-inner,:host-context([dir=rtl]).toggle-checked .toggle-inner{-webkit-transform:translate3d(calc(-1 * 16px),  0,  0);transform:translate3d(calc(-1 * 16px),  0,  0)}:host(.toggle-disabled){opacity:0.3}:host(.in-item[slot]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:16px;padding-right:0;padding-top:12px;padding-bottom:12px;cursor:pointer}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot]){padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:0;padding-inline-end:0}}:host(.in-item[slot=start]){padding-left:2px;padding-right:18px;padding-top:12px;padding-bottom:12px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host(.in-item[slot=start]){padding-left:unset;padding-right:unset;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:18px;padding-inline-end:18px}}",Toggle=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputId="ion-tg-"+toggleIds++,this.lastDrag=0,this.activated=!1,this.name=this.inputId,this.checked=!1,this.disabled=!1,this.value="on",this.onClick=()=>{this.lastDrag+300<Date.now()&&(this.checked=!this.checked)},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.ionChange=createEvent(this,"ionChange",7),this.ionFocus=createEvent(this,"ionFocus",7),this.ionBlur=createEvent(this,"ionBlur",7),this.ionStyle=createEvent(this,"ionStyle",7)}checkedChanged(t){this.ionChange.emit({checked:t,value:this.value})}disabledChanged(){this.emitStyle(),this.gesture&&this.gesture.enable(!this.disabled)}async connectedCallback(){this.gesture=(await Promise.resolve().then((function(){return index$1}))).createGesture({el:this.el,gestureName:"toggle",gesturePriority:100,threshold:5,passive:!1,onStart:()=>this.onStart(),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.disabledChanged()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}componentWillLoad(){this.emitStyle()}emitStyle(){this.ionStyle.emit({"interactive-disabled":this.disabled})}onStart(){this.activated=!0,this.setFocus()}onMove(t){shouldToggle(document,this.checked,t.deltaX,-10)&&(this.checked=!this.checked,hapticSelection())}onEnd(t){this.activated=!1,this.lastDrag=Date.now(),t.event.preventDefault(),t.event.stopImmediatePropagation()}getValue(){return this.value||""}setFocus(){this.buttonEl&&this.buttonEl.focus()}render(){const{inputId:t,disabled:e,checked:i,activated:n,color:s,el:o}=this,r=getIonMode(this),a=t+"-lbl",l=findItemLabel(o),c=this.getValue();return l&&(l.id=a),renderHiddenInput(!0,o,this.name,i?c:"",e),h(Host,{onClick:this.onClick,role:"checkbox","aria-disabled":e?"true":null,"aria-checked":""+i,"aria-labelledby":a,class:Object.assign(Object.assign({},createColorClasses(s)),{[r]:!0,"in-item":hostContext("ion-item",o),"toggle-activated":n,"toggle-checked":i,"toggle-disabled":e,interactive:!0})},h("div",{class:"toggle-icon"},h("div",{class:"toggle-inner"})),h("button",{type:"button",onFocus:this.onFocus,onBlur:this.onBlur,disabled:e,ref:t=>this.buttonEl=t}))}get el(){return this}static get watchers(){return{checked:["checkedChanged"],disabled:["disabledChanged"]}}static get style(){return{ios:toggleIosCss,md:toggleMdCss}}},shouldToggle=(t,e,i,n)=>{const s="rtl"===t.dir;return e?!s&&n>i||s&&-n<i:!s&&-n<i||s&&n>i};let toggleIds=0;const toolbarIosCss=":host{--border-width:0;--border-style:solid;--opacity:1;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;padding-left:var(--ion-safe-area-left);padding-right:var(--ion-safe-area-right);display:block;position:relative;width:100%;color:var(--color);font-family:var(--ion-font-family, inherit);contain:content;z-index:10;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}:host(.ion-color){color:var(--ion-color-contrast)}:host(.ion-color) .toolbar-background{background:var(--ion-color-base)}.toolbar-container{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:var(--min-height);contain:content;overflow:hidden;z-index:10;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toolbar-container{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.toolbar-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;opacity:var(--opacity);z-index:-1;pointer-events:none}::slotted(ion-progress-bar){left:0;right:0;bottom:0;position:absolute}:host{--background:var(--ion-toolbar-background, var(--ion-color-step-50, #fff));--color:var(--ion-toolbar-color, var(--ion-text-color, #000));--border-color:var(--ion-toolbar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--padding-top:3px;--padding-bottom:3px;--padding-start:4px;--padding-end:4px;--min-height:44px}.toolbar-content{-ms-flex:1;flex:1;-ms-flex-order:4;order:4;min-width:0}:host(.toolbar-segment) .toolbar-content{display:-ms-inline-flexbox;display:inline-flex}:host(.toolbar-searchbar) .toolbar-container{padding-top:0;padding-bottom:0}:host(.toolbar-searchbar) ::slotted(*){-ms-flex-item-align:start;align-self:start}:host(.toolbar-searchbar) ::slotted(ion-chip){margin-top:3px}:host(.toolbar-searchbar) ::slotted(ion-back-button){height:38px}::slotted(ion-buttons){min-height:38px}::slotted([slot=start]){-ms-flex-order:2;order:2}::slotted([slot=secondary]){-ms-flex-order:3;order:3}::slotted([slot=primary]){-ms-flex-order:5;order:5;text-align:end}::slotted([slot=end]){-ms-flex-order:6;order:6;text-align:end}:host(.toolbar-title-large) .toolbar-container{-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:start;align-items:flex-start}:host(.toolbar-title-large) .toolbar-content ion-title{-ms-flex:1;flex:1;-ms-flex-order:8;order:8;min-width:100%}",toolbarMdCss=":host{--border-width:0;--border-style:solid;--opacity:1;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;padding-left:var(--ion-safe-area-left);padding-right:var(--ion-safe-area-right);display:block;position:relative;width:100%;color:var(--color);font-family:var(--ion-font-family, inherit);contain:content;z-index:10;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}:host(.ion-color){color:var(--ion-color-contrast)}:host(.ion-color) .toolbar-background{background:var(--ion-color-base)}.toolbar-container{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:var(--min-height);contain:content;overflow:hidden;z-index:10;-webkit-box-sizing:border-box;box-sizing:border-box}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toolbar-container{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.toolbar-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;opacity:var(--opacity);z-index:-1;pointer-events:none}::slotted(ion-progress-bar){left:0;right:0;bottom:0;position:absolute}:host{--background:var(--ion-toolbar-background, var(--ion-background-color, #fff));--color:var(--ion-toolbar-color, var(--ion-text-color, #424242));--border-color:var(--ion-toolbar-border-color, var(--ion-border-color, var(--ion-color-step-150, #c1c4cd)));--padding-top:0;--padding-bottom:0;--padding-start:0;--padding-end:0;--min-height:56px}.toolbar-content{-ms-flex:1;flex:1;-ms-flex-order:3;order:3;min-width:0;max-width:100%}::slotted(ion-segment){min-height:var(--min-height)}::slotted(.buttons-first-slot){margin-left:4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(.buttons-first-slot){margin-left:unset;-webkit-margin-start:4px;margin-inline-start:4px}}::slotted(.buttons-last-slot){margin-right:4px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){::slotted(.buttons-last-slot){margin-right:unset;-webkit-margin-end:4px;margin-inline-end:4px}}::slotted([slot=start]){-ms-flex-order:2;order:2}::slotted([slot=secondary]){-ms-flex-order:4;order:4}::slotted([slot=primary]){-ms-flex-order:5;order:5;text-align:end}::slotted([slot=end]){-ms-flex-order:6;order:6;text-align:end}",Toolbar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.childrenStyles=new Map}componentWillLoad(){const t=Array.from(this.el.querySelectorAll("ion-buttons")),e=t.find(t=>"start"===t.slot);e&&e.classList.add("buttons-first-slot");const i=t.reverse(),n=i.find(t=>"end"===t.slot)||i.find(t=>"primary"===t.slot)||i.find(t=>"secondary"===t.slot);n&&n.classList.add("buttons-last-slot")}childrenStyle(t){t.stopPropagation();const e=t.target.tagName,i=t.detail,n={},s=this.childrenStyles.get(e)||{};let o=!1;Object.keys(i).forEach(t=>{const e="toolbar-"+t,r=i[t];r!==s[e]&&(o=!0),r&&(n[e]=!0)}),o&&(this.childrenStyles.set(e,n),forceUpdate(this))}render(){const t=getIonMode(this),e={};return this.childrenStyles.forEach(t=>{Object.assign(e,t)}),h(Host,{class:Object.assign(Object.assign({"in-toolbar":hostContext("ion-toolbar",this.el),[t]:!0},e),createColorClasses(this.color))},h("div",{class:"toolbar-background"}),h("div",{class:"toolbar-container"},h("slot",{name:"start"}),h("slot",{name:"secondary"}),h("div",{class:"toolbar-content"},h("slot",null)),h("slot",{name:"primary"}),h("slot",{name:"end"})))}get el(){return this}static get style(){return{ios:toolbarIosCss,md:toolbarMdCss}}},CELL_TYPE_ITEM="item",CELL_TYPE_HEADER="header",CELL_TYPE_FOOTER="footer",NODE_CHANGE_NONE=0,NODE_CHANGE_POSITION=1,NODE_CHANGE_CELL=2,MIN_READS=2,updateVDom=(t,e,i,n)=>{for(const a of t)a.change=NODE_CHANGE_NONE,a.d=!0;const s=[],o=n.offset+n.length;for(let a=n.offset;a<o;a++){const n=i[a],o=t.find(t=>t.d&&t.cell===n);if(o){const t=e[a];t!==o.top&&(o.top=t,o.change=NODE_CHANGE_POSITION),o.d=!1}else s.push(n)}const r=t.filter(t=>t.d);for(const a of s){const i=r.find(t=>t.d&&t.cell.type===a.type),n=a.i;i?(i.d=!1,i.change=NODE_CHANGE_CELL,i.cell=a,i.top=e[n]):t.push({d:!1,cell:a,visible:!0,change:NODE_CHANGE_CELL,top:e[n]})}t.filter(t=>t.d&&-9999!==t.top).forEach(t=>{t.change=NODE_CHANGE_POSITION,t.top=-9999})},doRender=(t,e,i,n)=>{const s=Array.from(t.children).filter(t=>"TEMPLATE"!==t.tagName),o=s.length;let r;for(let a=0;a<i.length;a++){const l=i[a],c=l.cell;if(l.change===NODE_CHANGE_CELL){if(a<o)r=s[a],e(r,c,a);else{const i=createNode(t,c.type);r=e(i,c,a)||i,r.classList.add("virtual-item"),t.appendChild(r)}r.$ionCell=c}else r=s[a];l.change!==NODE_CHANGE_NONE&&(r.style.transform=`translate3d(0,${l.top}px,0)`);const h=c.visible;l.visible!==h&&(h?r.classList.remove("virtual-loading"):r.classList.add("virtual-loading"),l.visible=h),c.reads>0&&(n(c,r),c.reads--)}},createNode=(t,e)=>{const i=getTemplate(t,e);return i&&t.ownerDocument?t.ownerDocument.importNode(i.content,!0).children[0]:null},getTemplate=(t,e)=>{switch(e){case CELL_TYPE_ITEM:return t.querySelector("template:not([name])");case CELL_TYPE_HEADER:return t.querySelector("template[name=header]");case CELL_TYPE_FOOTER:return t.querySelector("template[name=footer]")}},getViewport=(t,e,i)=>({top:Math.max(t-i,0),bottom:t+e+i}),getRange=(t,e,i)=>{const n=e.top,s=e.bottom;let o=0;for(;o<t.length&&!(t[o]>n);o++);const r=Math.max(o-i-1,0);for(;o<t.length&&!(t[o]>=s);o++);return{offset:r,length:Math.min(o+i,t.length)-r}},getShouldUpdate=(t,e,i)=>t<=i.offset+i.length||e.offset!==i.offset||e.length!==i.length,findCellIndex=(t,e)=>0===e?0:e===(t.length>0?t[t.length-1].index:0)+1?t.length:t.findIndex(t=>t.index===e),inplaceUpdate=(t,e,i)=>{if(0===i&&e.length>=t.length)return e;for(let n=0;n<e.length;n++)t[n+i]=e[n];return t},calcCells=(t,e,i,n,s,o,r,a,l,c,h,d)=>{const u=[],m=d+h;for(let p=h;p<m;p++){const h=t[p];if(s){const e=s(h,p,t);null!=e&&u.push({i:c++,type:CELL_TYPE_HEADER,value:e,index:p,height:i?i(e,p):r,reads:i?0:MIN_READS,visible:!!i})}if(u.push({i:c++,type:CELL_TYPE_ITEM,value:h,index:p,height:e?e(h,p):l,reads:e?0:MIN_READS,visible:!!e}),o){const e=o(h,p,t);null!=e&&u.push({i:c++,type:CELL_TYPE_FOOTER,value:e,index:p,height:n?n(e,p):a,reads:n?0:MIN_READS,visible:!!n})}}return u},calcHeightIndex=(t,e,i)=>{let n=t[i];for(let s=i;s<t.length;s++)t[s]=n,n+=e[s].height;return n},resizeBuffer=(t,e)=>{if(!t)return new Uint32Array(e);if(t.length===e)return t;if(e>t.length){const i=new Uint32Array(e);return i.set(t),i}return t.subarray(0,e)},positionForIndex=(t,e,i)=>{const n=e.find(e=>e.type===CELL_TYPE_ITEM&&e.index===t);return n?i[n.i]:-1},virtualScrollCss="ion-virtual-scroll{display:block;position:relative;width:100%;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}ion-virtual-scroll>.virtual-loading{opacity:0}ion-virtual-scroll>.virtual-item{position:absolute !important;top:0 !important;right:0 !important;left:0 !important;-webkit-transition-duration:0ms;transition-duration:0ms;will-change:transform}",VirtualScroll=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.range={offset:0,length:0},this.viewportHeight=0,this.cells=[],this.virtualDom=[],this.isEnabled=!1,this.viewportOffset=0,this.currentScrollTop=0,this.indexDirty=0,this.lastItemLen=0,this.totalHeight=0,this.approxItemHeight=45,this.approxHeaderHeight=30,this.approxFooterHeight=30,this.onScroll=()=>{this.updateVirtualScroll()}}itemsChanged(){this.calcCells(),this.updateVirtualScroll()}async connectedCallback(){const t=this.el.closest("ion-content");t?(this.scrollEl=await t.getScrollElement(),this.contentEl=t,this.calcCells(),this.updateState()):console.error("<ion-virtual-scroll> must be used inside an <ion-content>")}componentDidUpdate(){this.updateState()}disconnectedCallback(){this.scrollEl=void 0}onResize(){this.calcCells(),this.updateVirtualScroll()}positionForItem(t){return Promise.resolve(positionForIndex(t,this.cells,this.getHeightIndex()))}async checkRange(t,e=-1){if(!this.items)return;const i=-1===e?this.items.length-t:e,n=findCellIndex(this.cells,t),s=calcCells(this.items,this.itemHeight,this.headerHeight,this.footerHeight,this.headerFn,this.footerFn,this.approxHeaderHeight,this.approxFooterHeight,this.approxItemHeight,n,t,i);this.cells=inplaceUpdate(this.cells,s,n),this.lastItemLen=this.items.length,this.indexDirty=Math.max(t-1,0),this.scheduleUpdate()}async checkEnd(){this.items&&this.checkRange(this.lastItemLen)}updateVirtualScroll(){this.isEnabled&&this.scrollEl&&(this.timerUpdate&&(clearTimeout(this.timerUpdate),this.timerUpdate=void 0),readTask(this.readVS.bind(this)),writeTask(this.writeVS.bind(this)))}readVS(){const{contentEl:t,scrollEl:e,el:i}=this;let n=0,s=i;for(;s&&s!==t;)n+=s.offsetTop,s=s.parentElement;this.viewportOffset=n,e&&(this.viewportHeight=e.offsetHeight,this.currentScrollTop=e.scrollTop)}writeVS(){const t=this.indexDirty,e=getViewport(this.currentScrollTop-this.viewportOffset,this.viewportHeight,100),i=this.getHeightIndex(),n=getRange(i,e,2);getShouldUpdate(t,this.range,n)&&(this.range=n,updateVDom(this.virtualDom,i,this.cells,n),this.nodeRender?doRender(this.el,this.nodeRender,this.virtualDom,this.updateCellHeight.bind(this)):this.domRender?this.domRender(this.virtualDom):this.renderItem&&forceUpdate(this))}updateCellHeight(t,e){const i=()=>{if(e.$ionCell===t){const i=window.getComputedStyle(e),n=e.offsetHeight+parseFloat(i.getPropertyValue("margin-bottom"));this.setCellHeight(t,n)}};e&&e.componentOnReady?e.componentOnReady().then(i):i()}setCellHeight(t,e){const i=t.i;t===this.cells[i]&&(t.height===e&&!0===t.visible||(t.visible=!0,t.height=e,this.indexDirty=Math.min(this.indexDirty,i),this.scheduleUpdate()))}scheduleUpdate(){clearTimeout(this.timerUpdate),this.timerUpdate=setTimeout(()=>this.updateVirtualScroll(),100)}updateState(){const t=!(!this.scrollEl||!this.cells);t!==this.isEnabled&&(this.enableScrollEvents(t),t&&this.updateVirtualScroll())}calcCells(){this.items&&(this.lastItemLen=this.items.length,this.cells=calcCells(this.items,this.itemHeight,this.headerHeight,this.footerHeight,this.headerFn,this.footerFn,this.approxHeaderHeight,this.approxFooterHeight,this.approxItemHeight,0,0,this.lastItemLen),this.indexDirty=0)}getHeightIndex(){return this.indexDirty!==1/0&&this.calcHeightIndex(this.indexDirty),this.heightIndex}calcHeightIndex(t=0){this.heightIndex=resizeBuffer(this.heightIndex,this.cells.length),this.totalHeight=calcHeightIndex(this.heightIndex,this.cells,t),this.indexDirty=1/0}enableScrollEvents(t){this.rmEvent&&(this.rmEvent(),this.rmEvent=void 0);const e=this.scrollEl;e&&(this.isEnabled=t,e.addEventListener("scroll",this.onScroll),this.rmEvent=()=>{e.removeEventListener("scroll",this.onScroll)})}renderVirtualNode(t){const{type:e,value:i,index:n}=t.cell;switch(e){case CELL_TYPE_ITEM:return this.renderItem(i,n);case CELL_TYPE_HEADER:return this.renderHeader(i,n);case CELL_TYPE_FOOTER:return this.renderFooter(i,n)}}render(){return h(Host,{style:{height:this.totalHeight+"px"}},this.renderItem&&h(VirtualProxy,{dom:this.virtualDom},this.virtualDom.map(t=>this.renderVirtualNode(t))))}get el(){return this}static get watchers(){return{itemHeight:["itemsChanged"],headerHeight:["itemsChanged"],footerHeight:["itemsChanged"],items:["itemsChanged"]}}static get style(){return virtualScrollCss}},VirtualProxy=({dom:t},e,i)=>i.map(e,(e,i)=>{const n=t[i],s=e.vattrs||{};let o=s.class||"";return o+="virtual-item ",n.visible||(o+="virtual-loading"),Object.assign(Object.assign({},e),{vattrs:Object.assign(Object.assign({},s),{class:o,style:Object.assign(Object.assign({},s.style),{transform:`translate3d(0,${n.top}px,0)`})})})}),zeaAppShellCss=":host,.zea-app-shell{color:var(--color-freground-1);width:100%;height:100%}#brand{display:inline-block;vertical-align:middle;z-index:10000020;position:relative;background-size:contain;background-position:0px center;background-repeat:no-repeat;width:150px;height:34px}#left-panel-container,#right-panel-container,#center-panel-container{height:100%}header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;background-color:var(--color-grey-1)}#tools-container{-ms-flex-positive:1;flex-grow:1;text-align:right}header zea-user-chip{margin-right:10px}#main-search{width:300px;display:inline-block;text-align:right;margin:0 20px}@media only screen and (max-width: 667px){#main-search{width:auto}zea-user-chip-set{display:none}zea-user-chip-set.nav-drawer-open{display:block;-ms-flex-positive:1;flex-grow:1}#tools-container.nav-drawer-open{display:none}#brand{width:50px}}",ZeaAppShell=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.logoUrl="https://storage.googleapis.com/zea-web-components-assets/zea-logo.png",this.userData={},this.session={},this.leftPanelWidth="200",this.rightPanelWidth="200",this.leftProgressMessage="",this.centerProgressMessage="",this.rightProgressMessage="",this.userAuthenticated=createEvent(this,"userAuthenticated",7)}userRegisteredHandler(t){this.userData=t.detail,this.userData.id?"pub"in this.session&&this.session.pub("userChanged",this.userData):(this.userData.id=Math.random().toString(36).slice(2,12),this.userAuthenticated.emit(this.userData)),this.registerDialog.shown=!1,localStorage.setItem("zea-user-data",JSON.stringify(this.userData)),this.currentUserChip.userData=Object.assign({},this.userData),forceUpdate(this.currentUserChip)}navDrawerOpenHandler(){this.userChipSet.classList.add("nav-drawer-open"),this.toolsContainer.classList.add("nav-drawer-open")}navDrawerClosedHandler(){this.userChipSet.classList.remove("nav-drawer-open"),this.toolsContainer.classList.remove("nav-drawer-open")}async doUpdate(){console.log("Force updating shell"),forceUpdate(this.hostElement),forceUpdate(this.userChipSet)}componentWillLoad(){const t=localStorage.getItem("zea-user-data");t&&(this.userData=JSON.parse(t))}componentDidLoad(){"id"in this.userData?this.userAuthenticated.emit(this.userData):this.registerDialog.shown=!0}onShareIconClick(){this.shareDialog.shown=!0}render(){return[h("zea-layout",{orientation:"vertical","cell-a-size":"40","cell-c-size":"0","resize-cell-a":"false","resize-cell-c":"false","show-borders":"false"},h("header",{slot:"a"},h("zea-navigation-drawer",{id:"navigation-drawer"},h("zea-menu-item",{onClick:this.onShareIconClick.bind(this),type:"standalone"},h("zea-icon",{name:"link-outline"}),"Share"),h("slot",{name:"nav-drawer"})),h("div",{id:"brand",style:{backgroundImage:`url(${this.logoUrl})`}}),h("zea-user-chip-set",{ref:t=>{this.userChipSet=t},id:"users-container",session:this.session}),h("div",{id:"tools-container",ref:t=>{this.toolsContainer=t}},h("div",{id:"main-search"},h("zea-input-search",null))),h("zea-user-chip",{ref:t=>{this.currentUserChip=t},userData:Object.assign({},this.userData),id:"current-user","profile-card-align":"right","is-current-user":"true"})),h("zea-layout",{slot:"b","cell-a-size":this.leftPanelWidth,"cell-c-size":this.rightPanelWidth},h("div",{slot:"a",id:"left-panel-container"},this.leftProgressMessage&&h("zea-panel-progress-bar",{ref:t=>this.leftProgressBar=t},this.leftProgressMessage),h("slot",{name:"left-panel"})),h("div",{slot:"b",id:"center-panel-container"},this.centerProgressMessage&&h("zea-panel-progress-bar",{ref:t=>this.centerProgressBar=t},this.centerProgressMessage),h("slot",{name:"center-panel"})),h("div",{slot:"c",id:"right-panel-container"},this.rightProgressMessage&&h("zea-panel-progress-bar",{ref:t=>this.rightProgressBar=t},this.rightProgressMessage),h("slot",{name:"right-panel"})))),h("zea-dialog-profile",{allowClose:!1,ref:t=>this.registerDialog=t}),h("zea-dialog-share",{ref:t=>this.shareDialog=t})]}get hostElement(){return this}static get style(){return zeaAppShellCss}},zeaBreadcrumbsCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.ZeaBreadcrumbs{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:1rem}.ZeaBreadcrumbs a{color:var(--ion-color-primary)}",ZeaBreadcrumbs=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.clickFolder=createEvent(this,"clickFolder",7)}static breadcrumbEl(t){return h("a",{href:"#",onClick:t=>{t.preventDefault()}},t)}render(){const t=[this.folder];return h("div",{class:"ZeaBreadcrumbs"},ZeaBreadcrumbs.breadcrumbEl(this.project.name),t.length>0&&t.map(t=>h("span",null,h("ion-icon",{name:"arrow-dropright"}),ZeaBreadcrumbs.breadcrumbEl(t.name))))}static get style(){return zeaBreadcrumbsCss}},zeaButtonCss=":host{display:inline-block}:host,input,button,select,textarea{font-family:'Roboto', sans-serif;font-size:13px}.small{font-size:11px}.zea-button{border-radius:2px;outline:none;padding:0;width:100%}.zea-button-label{padding:0.5em 1em;white-space:nowrap}.zea-button-content-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.zea-button{color:var(--color-foreground-1);background-color:var(--color-background-1);border:1px solid var(--color-background-1)}.zea-button:hover{background-color:var(--color-primary-3)}.zea-button:disabled{background-color:var(--color-disabled-2);border:1px solid var(--color-disabled-2);color:var(--color-disabled-1)}.zea-button.solid{color:var(--color-foreground-1);background-color:var(--color-secondary-1);border:1px solid var(--color-secondary-1)}.zea-button.solid:hover{background-color:var(--color-secondary-2);border:1px solid var(--color-secondary-2)}.zea-button.solid:disabled{background-color:var(--color-disabled-2);border:1px solid var(--color-disabled-2);color:var(--color-disabled-1)}.zea-button.outlined{color:var(--color-secondary-1);background-color:transparent;border:1px solid var(--color-secondary-1)}.zea-button.outlined:hover{background-color:var(--color-secondary-3)}.zea-button.outlined:disabled{background-color:var(--color-disabled-2);border:1px solid var(--color-disabled-2);color:var(--color-disabled-1)}.zea-button.pill{color:var(--color-button-text-1);background-color:var(--color-primary-1);border:1px solid var(--color-primary-1);border-radius:20px;min-height:40px}.zea-button.pill:hover{background-color:var(--color-primary-2);border:1px solid var(--color-primary-2)}.zea-button.pill:disabled{background-color:var(--color-disabled-2);border:1px solid var(--color-disabled-2);color:var(--color-foreground-1)}.zea-start-icon ::slotted(zea-icon){vertical-align:middle;padding-left:0.5em}.zea-end-icon ::slotted(zea-icon){vertical-align:middle;padding-right:0.5em}",ZeaButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.variant="solid",this.disabled=!1,this.color=!1,this.density="normal"}render(){return h("button",{class:`zea-button ${this.variant} ${this.density}`,disabled:this.disabled},h("span",{class:"zea-button-content-wrap"},h("span",{class:"zea-start-icon"},h("slot",{name:"start-icon"})),this.htmlContent?h("span",{class:"zea-button-label",innerHTML:this.htmlContent}):h("span",{class:"zea-button-label"},h("slot",null)),h("span",{class:"zea-end-icon"},h("slot",{name:"end-icon"}))))}static get style(){return zeaButtonCss}},zeaCheckboxCss=".zea-checkbox{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-pack:center;justify-content:center;-ms-flex-line-pack:center;align-content:center;overflow:hidden;width:16px;height:16px;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid var(--color-primary-1);border-radius:3px}.zea-checkbox.checked{background-color:var(--color-primary-1)}.zea-checkbox.isradio{border-radius:1em;border-width:2px;background:none;display:-ms-flexbox;display:flex}.zea-checkbox.isradio .icon-path{fill:var(--color-primary-1)}.zea-checkbox.isradio svg{width:8px;height:8px}.zea-checkbox.disabled{border:0.1em solid var(--color-disabled-2)}.zea-checkbox.checked.disabled{background-color:var(--color-disabled-2)}.zea-checkbox path.icon-path{fill:var(--color-disabled-2)}.zea-checkbox.checked.disabled path.icon-path{fill:var(--color-disabled-1)}.zea-checkbox-wrap{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.zea-checkbox-icon{display:none;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.zea-checkbox.checked .zea-checkbox-icon{display:-ms-inline-flexbox;display:inline-flex}input[type='checkbox']{position:absolute;left:-50000px}",ZeaCheckbox=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.disabled=!1,this.checked=!1,this.isRadio=!1}onCheckedChanged(t){this.element.shadowRoot.querySelector("input").checked=t,this.updateElementClass()}onDisabledChanged(t){this.element.shadowRoot.querySelector("input").disabled=t,this.updateElementClass()}updateElementClass(){this.elementClass=this.checked?"checked":"",this.elementClass+=this.disabled?" disabled ":"",this.elementClass+=this.isRadio?" isradio ":""}toggleCheck(){this.disabled||(this.checked=!this.checked)}componentDidLoad(){this.onCheckedChanged(this.checked),this.onDisabledChanged(this.disabled)}render(){return h("div",{class:"zea-checkbox "+this.elementClass,onClick:()=>{this.toggleCheck()}},h("span",{class:"zea-checkbox-wrap"},h("span",{class:"zea-checkbox-icon"},!this.isRadio&&h("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24"},h("path",{class:"icon-path",d:"M9 21.035l-9-8.638 2.791-2.87 6.156 5.874 12.21-12.436 2.843 2.817z"})),this.isRadio&&h("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 512 512"},h("path",{class:"icon-path",d:"M256 464c-114.69 0-208-93.31-208-208S141.31 48 256 48s208 93.31 208 208-93.31 208-208 208z"})))),h("input",{type:"checkbox",name:this.name}))}get element(){return this}static get watchers(){return{checked:["onCheckedChanged"],disabled:["onDisabledChanged"]}}static get style(){return zeaCheckboxCss}},zeaCopyLinkCss=".zea-copy-link{color:var(--color-foreground-1)}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.label{font-size:1.1em;margin-bottom:5px;margin-top:2em}.link-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;background-color:var(--color-background-1);padding:5px}.link{-ms-flex-positive:1;flex-grow:1;border:none;background-color:transparent;outline:none;color:var(--color-foreground-1)}.copy-icon{cursor:pointer;margin:0 1em}.tooltip{position:absolute;width:64px;font-size:10px;-webkit-transform:translateX(-22px);transform:translateX(-22px);padding:2px;margin-top:5px;border-radius:3px;text-align:center;background-color:var(--color-secondary-1);min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;display:none}.active .tooltip,.copy-icon:hover .tooltip{color:var(--color-foreground-1);display:block}",ZeaCopyLink=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.tooltipDelay=3e3,this.link="",this.tooltipIsVisible=!1,this.tooltipText="Copy Link"}onCopyClick(){this.linkInput.select(),this.linkInput.setSelectionRange(0,99999),document.execCommand("copy"),this.tooltipIsVisible=!0,this.tooltipText="Link Copied",setTimeout(()=>{this.tooltipIsVisible=!1,this.tooltipText="Copy Link"},this.tooltipDelay)}onLinkClick(){this.linkInput.select(),this.linkInput.setSelectionRange(0,99999)}render(){return this.link||(this.link=window.location.href),h("div",{class:"zea-copy-link"},h("div",{class:"label"},"Copy Link"),h("div",{class:"link-container"},h("input",{onClick:this.onLinkClick.bind(this),readOnly:!0,class:"link",ref:t=>this.linkInput=t,value:this.link}),h("div",{class:{active:this.tooltipIsVisible,"copy-icon":!0},onClick:this.onCopyClick.bind(this)},h("zea-icon",{name:"copy-outline"}),h("div",{class:{tooltip:!0}},this.tooltipText))))}static get style(){return zeaCopyLinkCss}},zeaDialogCss="@import url('https://unpkg.com/tachyons@4/css/tachyons.min.css');:host{position:relative;z-index:10000000}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-dialog{color:var(--color-foreground-1);display:none;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;position:fixed;top:0;left:0;bottom:0;right:0;max-width:100vw;max-height:100vh;font-size:14px;pointer-events:none}.zea-dialog.shown{display:-ms-flexbox;display:flex}.backdrop{background-color:var(--color-shadow);position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:auto}.scroll-pane-container{max-height:100%;height:100%}.zea-dialog-container{-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--color-background-1);-webkit-box-shadow:2px 6px 10px 5px var(--color-shadow);box-shadow:2px 6px 10px 5px var(--color-shadow);min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;pointer-events:auto;max-height:100%;max-width:100%}.zea-dialog-title ::slotted([slot='title']){margin:0.5em 0}.zea-dialog-title{color:var(--color-foreground-1);padding:2em 2em 0;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.zea-dialog-title zea-icon{display:none}.with-padding .zea-dialog-title{padding:20px 20px 0 20px}.zea-dialog-body{-ms-flex-positive:1;flex-grow:1;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.with-padding .zea-dialog-body{padding:20px}.zea-dialog-body ::slotted([slot='body']){height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.zea-dialog-footer{text-align:right}.with-padding .zea-dialog-footer{padding:0 20px 20px}@media only screen and (max-width: 667px), only screen and (max-height: 667px){:host{position:relative;z-index:1000000000000}.zea-dialog-container.full-screen-mobile{height:100% !important;width:100% !important;position:fixed;top:0;left:0}.zea-dialog-title{color:var(--color-foreground-1);background-color:var(--color-grey-2);padding:0.5em 1em}.zea-dialog-title zea-icon{margin-right:1em;display:inline-block}.with-padding .zea-dialog-title{padding:0.5em 1em}.with-padding .zea-dialog-body{padding:20px;height:calc(100% - 3em)}}",ZeaDialog=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.shown=!1,this.width="auto",this.allowClose=!0,this.showBackdrop=!0,this.addPadding=!0,this.showTitle=!0,this.fullScreenMobile=!0,this.dialogClose=createEvent(this,"dialogClose",7)}async prompt(){this.shown=!0}closeDialog(){this.allowClose&&(this.shown=!1,this.dialogClose.emit(this.hostElement))}resetSize(){this.dialogContainer&&(this.dialogContainer.style.width=this.width?this.width:"fit-content",this.dialogContainer.style.height="fit-content",this.dialogContainer.offsetHeight&&(this.dialogContainer.style.height=this.dialogContainer.offsetHeight+"px"),this.dialogContainer.offsetWidth&&(this.dialogContainer.style.width=this.dialogContainer.offsetWidth+"px"))}componentDidRender(){this.resetSize()}componentWillLoad(){window.addEventListener("resize",()=>{this.resetSize()})}setupContainer(t){this.dialogContainer||(this.dialogContainer=t,this.dialogContainer.addEventListener("dialogResize",()=>{this.resetSize()}))}render(){return h("div",{class:{"zea-dialog":!0,shown:this.shown,"with-padding":this.addPadding}},this.showBackdrop&&h("div",{class:"backdrop",onClick:this.closeDialog.bind(this)}),h("div",{class:{"zea-dialog-container":!0,"full-screen-mobile":this.fullScreenMobile},ref:t=>this.setupContainer(t)},this.showTitle&&h("div",{class:"zea-dialog-title"},this.allowClose&&h("zea-icon",{name:"arrow-back",onClick:this.closeDialog.bind(this)}),h("slot",{name:"title"})),h("div",{class:"zea-dialog-body"},h("slot",{name:"body"})),h("div",{class:"zea-dialog-footer"},h("slot",{name:"footer"}))))}get hostElement(){return this}static get style(){return zeaDialogCss}},zeaDialogDrawingSettingsCss=".zea-dialog-drawing-settings{color:var(--color-freground-1)}zea-form-disciplines-settings{height:100%}#tabs-container{padding:20px}",ZeaDialogDrawingSettings=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.allowClose=!0,this.shown=!1,this.showLabels=!0}todoCompletedHandler(){this.shown=!1}render(){return h("div",{class:"zea-dialog-pdf-drawing-settings"},h("zea-dialog",{allowClose:this.allowClose,showBackdrop:!0,shown:this.shown,addPadding:!1},h("div",{slot:"body",id:"tabs-container"},h("zea-tabs",{orientation:"horizontal",density:"small"},h("div",{slot:"tab-bar"},"Drawing Disciplines"),h("zea-form-disciplines-settings",null),h("div",{slot:"tab-bar"},"Measurements"),h("zea-form-measurements-settings",null)))))}static get style(){return zeaDialogDrawingSettingsCss}},zeaDialogProfileCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-dialog-profile{color:var(--color-foreground-1)}.scrollpane-container{width:100%;height:calc(100% - 3em);padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box}",ZeaProfileDialog=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.allowClose=!0,this.shown=!1,this.showLabels=!0}todoCompletedHandler(){this.shown=!1}userRegisteredHandler(){this.shown=!1}render(){return h("div",{class:"zea-dialog-profile"},h("zea-dialog",{width:"320px",allowClose:this.allowClose,showBackdrop:!0,shown:this.shown,addPadding:!1},h("div",{slot:"title"},"My Profile"),h("div",{slot:"body"},h("div",{class:"scrollpane-container"},h("zea-scroll-pane",null,h("zea-form-profile",{userData:this.userData,showLabels:this.showLabels,welcomeHtml:""}))))))}static get style(){return zeaDialogProfileCss}},zeaDialogShareCss=".zea-dialog-share{color:var(--color-freground-1)}.scrollpane-container{width:100%;height:100%;padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box}",ZeaDialogShare=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.shown=!1}dialogCloseHandler(t){t.detail==this.dialog&&(this.shown=!1)}render(){return h("zea-dialog",{ref:t=>this.dialog=t,width:"fit-content",class:"share-dialog",shown:this.shown},h("div",{slot:"title"},"Share"),h("div",{slot:"body"},h("div",{class:"scrollpane-container"},h("zea-scroll-pane",null,h("zea-tabs",{orientation:"horizontal",density:"small"},h("div",{slot:"tab-bar"},"Share Link"),h("div",null,h("zea-qr-code",{scale:4}),h("zea-copy-link",null)),h("div",{slot:"tab-bar"},"Send SMS"),h("div",null,"Tab Content 2"),h("div",{slot:"tab-bar"},"Send Email"),h("div",null,"Tab Content 3"))))))}static get style(){return zeaDialogShareCss}},zeaDropdownMenuCss=".zea-dropdown-menu{color:var(--color-foreground-1);font-size:14px}ul,li{display:block;list-style:none;margin:0;padding:0;background-color:var(--color-background-2);cursor:default;position:relative;color:var(--color-foreground-1)}li.flashed>span,li.flashed:hover>span{background-color:var(--color-secondary-3) !important}.menu-root{display:-ms-flexbox;display:flex;-ms-flex-pack:left;justify-content:left;-ms-flex-align:center;align-items:center}ul ul{display:none}.leaf-label,.branch-label{display:inline-block;white-space:nowrap}.menu-root>li>.leaf-label,.menu-root>li>.branch-label{padding:16px}.menu-root>li>.branch-label>.branch-arrow{display:none}li .leaf-label,li .branch-label{padding:8px 8px 8px 16px;display:-ms-flexbox;display:flex}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}ul ul li>.leaf-label{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.branch-name{-ms-flex-positive:1;flex-grow:1}li:hover>span{background-color:var(--color-grey-3)}li:hover>ul{display:block;position:absolute;-webkit-box-shadow:0 6px 13px 0 var(--color-shadow);box-shadow:0 6px 13px 0 var(--color-shadow)}ul ul ul{margin-left:100%;margin-top:-30px}.action-name{min-width:100px;display:block;-ms-flex-positive:1;flex-grow:1}.keyboard-shortcut{display:block;opacity:0.75;font-size:0.8em;padding-left:10px}.branch-arrow-icon{display:block;opacity:0.5}.keyboard-key{border:1px solid var(--color-grey-3);padding:2px;border-radius:5px;font-size:0.8em;text-align:center;min-width:10px;display:inline-block;background-color:var(--color-background-1);text-transform:uppercase;margin:0 2px}",ZeaDropdownMenu=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.hotkeysToActions={},this.menuItems={children:{}}}componentDidLoad(){this.appData&&this.appData.actionRegistry&&this.appData.actionRegistry.on("actionAdded",()=>{this.makeMenuTree()}),this.makeMenuTree()}keydownHandler(t){if(t.target instanceof HTMLInputElement)return;const e=[];t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.metaKey&&e.push("ctrl"),t.ctrlKey&&e.push("ctrl"),"Alt"!=t.key&&"Control"!=t.key&&"Ctrl"!=t.key&&"Shift"!=t.key&&e.push(t.key);const i=e.join("+").toLowerCase();i in this.hotkeysToActions&&this.hotkeysToActions[i].callback(t),t.preventDefault()}makeMenuTree(){this.actions=this.appData.actionRegistry.getActions(),this.actions.forEach(t=>{this.getMenuTreeItem(t.path).children[t.name]=t}),this.feedHotKeys()}feedHotKeys(){this.actions.forEach(t=>{const e=this.keyComboAsText(t);e&&(this.hotkeysToActions[e]=t)})}getMenuTreeItem(t){let e=this.menuItems;return t.forEach(t=>{t in e.children||(e.children[t]={children:{}}),e=e.children[t]}),e}makeBranch(t,e){return h("li",{key:t},h("span",{class:"branch-label"},h("span",{class:"branch-name"},t),h("span",{class:"branch-arrow"},this.getBranchArrow())),h("ul",null,this.makeBranchItems(e)))}makeBranchItems(t){const e=[];return Object.keys(t.children).forEach(i=>{const n=t.children[i];e.push("children"in n?this.makeBranch(i,n):this.makeLeaf(i,n))}),e}makeLeaf(t,e){return h("li",{key:t,onClick:t=>{this.hadleLeafClick(t,e)}},h("span",{class:"leaf-label"},h("span",{class:"action-name"},e.name),h("span",{class:"keyboard-shortcut"},this.keyComboAsHtml(e))))}hadleLeafClick(t,e){"callback"in e&&e.callback(),this.flashItem(t.currentTarget)}flashItem(t){t.classList.toggle("flashed");const e=setInterval(()=>{t.classList.toggle("flashed")},80);setTimeout(()=>{clearInterval(e),t.classList.remove("flashed")},100)}keyComboAsHtml(t){const{metaKeys:e,key:i}=t,n=[];return i||e?(e.control&&(n.push(h("span",{class:"keyboard-key"},"Ctrl")),n.push("+")),e.alt&&(n.push(h("span",{class:"keyboard-key"},"Alt")),n.push("+")),e.shift&&(n.push(h("span",{class:"keyboard-key"},"Shift")),n.push("+")),n.push(h("span",{class:"keyboard-key"},i)),n):null}keyComboAsText(t){const{metaKeys:e,key:i}=t,n=[];return i||e?(e&&(e.shift&&n.push("shift"),e.alt&&n.push("alt"),e.control&&n.push("ctrl")),n.push(i),n.join("+").toLowerCase()):""}getBranchArrow(){return h("svg",{class:"branch-arrow-icon",xmlns:"http://www.w3.org/2000/svg",height:"16",viewBox:"0 0 24 24",width:"16"},h("path",{d:"M8 5v14l11-7z"}),h("path",{d:"M0 0h24v24H0z",fill:"none"}))}render(){return h("div",{class:"zea-dropdown-menu"},h("ul",{class:"menu-root"},this.makeBranchItems(this.menuItems)))}static get style(){return zeaDropdownMenuCss}},zeaFabButtonCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-fab-button{font-size:1em;border-radius:50%;outline:none;text-align:center;padding:0;color:var(--color-button-text-1);background-color:var(--color-primary-1);border:1px solid var(--color-primary-1);-webkit-box-shadow:0px 5px 5px var(--color-shadow);box-shadow:0px 5px 5px var(--color-shadow)}.zea-fab-button:hover{background-color:var(--color-primary-2);border:1px solid var(--color-primary-2)}.zea-fab-button:disabled{background-color:var(--color-disabled-2);border:1px solid var(--color-disabled-2);color:var(--color-disabled-1);-webkit-box-shadow:0px 5px 5px var(--color-shadow);box-shadow:0px 5px 5px var(--color-shadow)}.zea-fab-button-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;padding:0.7em;width:1em;height:1em}",ZeaFabButton=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h("button",{class:"zea-fab-button",disabled:this.disabled},h("span",{class:"zea-fab-button-wrap"},h("span",{class:"zea-fab-button-icon"},h("slot",null))))}static get style(){return zeaFabButtonCss}};var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}function getCjsExportFromNamespace(t){return t&&t.default||t}var process_1=commonjsGlobal.process,s=1e3,m=60*s,h$1=60*m,d=24*h$1,w=7*d,y=365.25*d,ms=function(t,e){e=e||{};var i=typeof t;if("string"===i&&t.length>0)return parse(t);if("number"===i&&isFinite(t))return e.long?fmtLong(t):fmtShort(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function parse(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*y;case"weeks":case"week":case"w":return i*w;case"days":case"day":case"d":return i*d;case"hours":case"hour":case"hrs":case"hr":case"h":return i*h$1;case"minutes":case"minute":case"mins":case"min":case"m":return i*m;case"seconds":case"second":case"secs":case"sec":case"s":return i*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function fmtShort(t){var e=Math.abs(t);return e>=d?Math.round(t/d)+"d":e>=h$1?Math.round(t/h$1)+"h":e>=m?Math.round(t/m)+"m":e>=s?Math.round(t/s)+"s":t+"ms"}function fmtLong(t){var e=Math.abs(t);return e>=d?plural(t,e,d,"day"):e>=h$1?plural(t,e,h$1,"hour"):e>=m?plural(t,e,m,"minute"):e>=s?plural(t,e,s,"second"):t+" ms"}function plural(t,e,i,n){var s=e>=1.5*i;return Math.round(t/i)+" "+n+(s?"s":"")}function setup(t){function e(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return i.colors[Math.abs(e)%i.colors.length]}function i(t){let o;function r(...t){if(!r.enabled)return;const e=r,n=Number(new Date);e.diff=n-(o||n),e.prev=o,e.curr=n,o=n,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,o)=>{if("%%"===n)return n;s++;const r=i.formatters[o];return"function"==typeof r&&(n=r.call(e,t[s]),t.splice(s,1),s--),n}),i.formatArgs.call(e,t),(e.log||i.log).apply(e,t)}return r.namespace=t,r.enabled=i.enabled(t),r.useColors=i.useColors(),r.color=e(t),r.destroy=n,r.extend=s,"function"==typeof i.init&&i.init(r),i.instances.push(r),r}function n(){const t=i.instances.indexOf(this);return-1!==t&&(i.instances.splice(t,1),!0)}function s(t,e){const n=i(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(t){return t instanceof Error?t.stack||t.message:t},i.disable=function(){const t=[...i.names.map(o),...i.skips.map(o).map(t=>"-"+t)].join(",");return i.enable(""),t},i.enable=function(t){let e;i.save(t),i.names=[],i.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),s=n.length;for(e=0;e<s;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")));for(e=0;e<i.instances.length;e++){const t=i.instances[e];t.enabled=i.enabled(t.namespace)}},i.enabled=function(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=i.skips.length;e<n;e++)if(i.skips[e].test(t))return!1;for(e=0,n=i.names.length;e<n;e++)if(i.names[e].test(t))return!0;return!1},i.humanize=ms,Object.keys(t).forEach(e=>{i[e]=t[e]}),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=e,i.enable(i.load()),i}var common=setup,browser=createCommonjsModule((function(t,e){e.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;e.splice(1,0,i,"color: inherit");let n=0,s=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(s=n))}),e.splice(s,0,i)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(i){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(i){}return!t&&void 0!==process_1&&"env"in process_1&&(t=process_1.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=common(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})),re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parseuri=function(t){var e=t,i=t.indexOf("["),n=t.indexOf("]");-1!=i&&-1!=n&&(t=t.substring(0,i)+t.substring(i,n).replace(/:/g,";")+t.substring(n,t.length));for(var s=re.exec(t||""),o={},r=14;r--;)o[parts[r]]=s[r]||"";return-1!=i&&-1!=n&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o},debug=browser("socket.io-client:url"),url_1=url;function url(t,e){var i=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(debug("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),debug("parse %s",t),i=parseuri(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";var n=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+n+":"+i.port,i.href=i.protocol+"://"+n+(e&&e.port===i.port?"":":"+i.port),i}var s$1=1e3,m$1=60*s$1,h$2=60*m$1,d$1=24*h$2,y$1=365.25*d$1,ms$1=function(t,e){e=e||{};var i=typeof t;if("string"===i&&t.length>0)return parse$1(t);if("number"===i&&!1===isNaN(t))return e.long?fmtLong$1(t):fmtShort$1(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function parse$1(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*y$1;case"days":case"day":case"d":return i*d$1;case"hours":case"hour":case"hrs":case"hr":case"h":return i*h$2;case"minutes":case"minute":case"mins":case"min":case"m":return i*m$1;case"seconds":case"second":case"secs":case"sec":case"s":return i*s$1;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function fmtShort$1(t){return t>=d$1?Math.round(t/d$1)+"d":t>=h$2?Math.round(t/h$2)+"h":t>=m$1?Math.round(t/m$1)+"m":t>=s$1?Math.round(t/s$1)+"s":t+"ms"}function fmtLong$1(t){return plural$1(t,d$1,"day")||plural$1(t,h$2,"hour")||plural$1(t,m$1,"minute")||plural$1(t,s$1,"second")||t+" ms"}function plural$1(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var debug$1=createCommonjsModule((function(t,e){function i(t){var i;function s(){if(s.enabled){var t=s,n=+new Date,o=n-(i||n);t.diff=o,t.prev=i,t.curr=n,i=n;for(var r=new Array(arguments.length),a=0;a<r.length;a++)r[a]=arguments[a];r[0]=e.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var l=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,(function(i,n){if("%%"===i)return i;l++;var s=e.formatters[n];return"function"==typeof s&&(i=s.call(t,r[l]),r.splice(l,1),l--),i})),e.formatArgs.call(t,r);var c=s.log||e.log||console.log.bind(console);c.apply(t,r)}}return s.namespace=t,s.enabled=e.enabled(t),s.useColors=e.useColors(),s.color=function(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),s.destroy=n,"function"==typeof e.init&&e.init(s),e.instances.push(s),s}function n(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var i;e.save(t),e.names=[],e.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),s=n.length;for(i=0;i<s;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(i=0;i<e.instances.length;i++){var o=e.instances[i];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=ms$1,e.instances=[],e.names=[],e.skips=[],e.formatters={}})),browser$1=createCommonjsModule((function(t,i){function n(){var t;try{t=i.storage.debug}catch(e){}return!t&&void 0!==process_1&&"env"in process_1&&(t=process_1.env.DEBUG),t}(i=t.exports=debug$1).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},i.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+i.humanize(this.diff),e){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var s=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(s++,"%c"===t&&(o=s))})),t.splice(o,0,n)}},i.save=function(t){try{null==t?i.storage.removeItem("debug"):i.storage.debug=t}catch(e){}},i.load=n,i.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},i.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],i.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},i.enable(n())})),componentEmitter=createCommonjsModule((function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<n.length;s++)if((i=n[s])===e||i.fn===e){n.splice(s,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var n=0,s=(i=i.slice(0)).length;n<s;++n)i[n].apply(this,e);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}})),toString={}.toString,isarray=Array.isArray||function(t){return"[object Array]"==toString.call(t)},global$1="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,i=t.length;e<i;++e)lookup[e]=t[e],revLookup[t.charCodeAt(e)]=e;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(t){var e,i,n,s,o,r;inited||init();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");r=new Arr(3*a/4-(o="="===t[a-2]?2:"="===t[a-1]?1:0)),n=o>0?a-4:a;var l=0;for(e=0,i=0;e<n;e+=4,i+=3)s=revLookup[t.charCodeAt(e)]<<18|revLookup[t.charCodeAt(e+1)]<<12|revLookup[t.charCodeAt(e+2)]<<6|revLookup[t.charCodeAt(e+3)],r[l++]=s>>16&255,r[l++]=s>>8&255,r[l++]=255&s;return 2===o?(s=revLookup[t.charCodeAt(e)]<<2|revLookup[t.charCodeAt(e+1)]>>4,r[l++]=255&s):1===o&&(s=revLookup[t.charCodeAt(e)]<<10|revLookup[t.charCodeAt(e+1)]<<4|revLookup[t.charCodeAt(e+2)]>>2,r[l++]=s>>8&255,r[l++]=255&s),r}function tripletToBase64(t){return lookup[t>>18&63]+lookup[t>>12&63]+lookup[t>>6&63]+lookup[63&t]}function encodeChunk(t,e,i){for(var n=[],s=e;s<i;s+=3)n.push(tripletToBase64((t[s]<<16)+(t[s+1]<<8)+t[s+2]));return n.join("")}function fromByteArray(t){var e;inited||init();for(var i=t.length,n=i%3,s="",o=[],r=0,a=i-n;r<a;r+=16383)o.push(encodeChunk(t,r,r+16383>a?a:r+16383));return 1===n?(s+=lookup[(e=t[i-1])>>2],s+=lookup[e<<4&63],s+="=="):2===n&&(s+=lookup[(e=(t[i-2]<<8)+t[i-1])>>10],s+=lookup[e>>4&63],s+=lookup[e<<2&63],s+="="),o.push(s),o.join("")}function read(t,e,i,n,s){var o,r,a=8*s-n-1,l=(1<<a)-1,c=l>>1,h=-7,d=i?s-1:0,u=i?-1:1,m=t[e+d];for(d+=u,o=m&(1<<-h)-1,m>>=-h,h+=a;h>0;o=256*o+t[e+d],d+=u,h-=8);for(r=o&(1<<-h)-1,o>>=-h,h+=n;h>0;r=256*r+t[e+d],d+=u,h-=8);if(0===o)o=1-c;else{if(o===l)return r?NaN:1/0*(m?-1:1);r+=Math.pow(2,n),o-=c}return(m?-1:1)*r*Math.pow(2,o-n)}function write(t,e,i,n,s,o){var r,a,l,c=8*o-s-1,h=(1<<c)-1,d=h>>1,u=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:o-1,p=n?1:-1,b=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,r=h):(r=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-r))<1&&(r--,l*=2),(e+=r+d>=1?u/l:u*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=h?(a=0,r=h):r+d>=1?(a=(e*l-1)*Math.pow(2,s),r+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),r=0));s>=8;t[i+m]=255&a,m+=p,a/=256,s-=8);for(r=r<<s|a,c+=s;c>0;t[i+m]=255&r,m+=p,r/=256,c-=8);t[i+m-p]|=128*b}var toString$1={}.toString,isArray=Array.isArray||function(t){return"[object Array]"==toString$1.call(t)},INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=void 0===global$1.TYPED_ARRAY_SUPPORT||global$1.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(t,e){if(kMaxLength()<e)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Buffer.prototype:(null===t&&(t=new Buffer(e)),t.length=e),t}function Buffer(t,e,i){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,t)}return from(this,t,e,i)}function from(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer(t,e,i,n):"string"==typeof e?fromString(t,e,i):fromObject(t,e)}function assertSize(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function alloc(t,e,i,n){return assertSize(e),e<=0?createBuffer(t,e):void 0!==i?"string"==typeof n?createBuffer(t,e).fill(i,n):createBuffer(t,e).fill(i):createBuffer(t,e)}function allocUnsafe(t,e){if(assertSize(e),t=createBuffer(t,e<0?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function fromString(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!Buffer.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(e,i),s=(t=createBuffer(t,n)).write(e,i);return s!==n&&(t=t.slice(0,s)),t}function fromArrayLike(t,e){var i=e.length<0?0:0|checked(e.length);t=createBuffer(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function fromArrayBuffer(t,e,i,n){if(i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n),Buffer.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Buffer.prototype:t=fromArrayLike(t,e),t}function fromObject(t,e){if(internalIsBuffer(e)){var i=0|checked(e.length);return 0===(t=createBuffer(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan(e.length)?createBuffer(t,0):fromArrayLike(t,e);if("Buffer"===e.type&&isArray(e.data))return fromArrayLike(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function internalIsBuffer(t){return!(null==t||!t._isBuffer)}function byteLength(t,e){if(internalIsBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return base64ToBytes(t).length;default:if(n)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),n=!0}}function slowToString(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return hexSlice(this,e,i);case"utf8":case"utf-8":return utf8Slice(this,e,i);case"ascii":return asciiSlice(this,e,i);case"latin1":case"binary":return latin1Slice(this,e,i);case"base64":return base64Slice(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function swap(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function bidirectionalIndexOf(t,e,i,n,s){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(s)return-1;i=t.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof e&&(e=Buffer.from(e,n)),internalIsBuffer(e))return 0===e.length?-1:arrayIndexOf(t,e,i,n,s);if("number"==typeof e)return e&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):arrayIndexOf(t,[e],i,n,s);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(t,e,i,n,s){var o,r=1,a=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;r=2,a/=2,l/=2,i/=2}function c(t,e){return 1===r?t[e]:t.readUInt16BE(e*r)}if(s){var h=-1;for(o=i;o<a;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*r}else-1!==h&&(o-=o-h),h=-1}else for(i+l>a&&(i=a-l),o=i;o>=0;o--){for(var d=!0,u=0;u<l;u++)if(c(t,o+u)!==c(e,u)){d=!1;break}if(d)return o}return-1}function hexWrite(t,e,i,n){i=Number(i)||0;var s=t.length-i;n?(n=Number(n))>s&&(n=s):n=s;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var r=0;r<n;++r){var a=parseInt(e.substr(2*r,2),16);if(isNaN(a))return r;t[i+r]=a}return r}function utf8Write(t,e,i,n){return blitBuffer(utf8ToBytes(e,t.length-i),t,i,n)}function asciiWrite(t,e,i,n){return blitBuffer(asciiToBytes(e),t,i,n)}function latin1Write(t,e,i,n){return asciiWrite(t,e,i,n)}function base64Write(t,e,i,n){return blitBuffer(base64ToBytes(e),t,i,n)}function ucs2Write(t,e,i,n){return blitBuffer(utf16leToBytes(e,t.length-i),t,i,n)}function base64Slice(t,e,i){return fromByteArray(0===e&&i===t.length?t:t.slice(e,i))}function utf8Slice(t,e,i){i=Math.min(t.length,i);for(var n=[],s=e;s<i;){var o,r,a,l,c=t[s],h=null,d=c>239?4:c>223?3:c>191?2:1;if(s+d<=i)switch(d){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[s+1]))&&(l=(31&c)<<6|63&o)>127&&(h=l);break;case 3:r=t[s+2],128==(192&(o=t[s+1]))&&128==(192&r)&&(l=(15&c)<<12|(63&o)<<6|63&r)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:r=t[s+2],a=t[s+3],128==(192&(o=t[s+1]))&&128==(192&r)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(h=l)}null===h?(h=65533,d=1):h>65535&&(n.push((h-=65536)>>>10&1023|55296),h=56320|1023&h),n.push(h),s+=d}return decodeCodePointsArray(n)}Buffer.poolSize=8192,Buffer._augment=function(t){return t.__proto__=Buffer.prototype,t},Buffer.from=function(t,e,i){return from(null,t,e,i)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.alloc=function(t,e,i){return alloc(null,t,e,i)},Buffer.allocUnsafe=function(t){return allocUnsafe(null,t)},Buffer.allocUnsafeSlow=function(t){return allocUnsafe(null,t)},Buffer.isBuffer=isBuffer,Buffer.compare=function(t,e){if(!internalIsBuffer(t)||!internalIsBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,s=0,o=Math.min(i,n);s<o;++s)if(t[s]!==e[s]){i=t[s],n=e[s];break}return i<n?-1:n<i?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=Buffer.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var o=t[i];if(!internalIsBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,s),s+=o.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)swap(this,e,e+1);return this},Buffer.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)swap(this,e,e+3),swap(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)swap(this,e,e+7),swap(this,e+1,e+6),swap(this,e+2,e+5),swap(this,e+3,e+4);return this},Buffer.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t,e,i,n,s){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),e<0||i>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=i)return 0;if(n>=s)return-1;if(e>=i)return 1;if(this===t)return 0;for(var o=(s>>>=0)-(n>>>=0),r=(i>>>=0)-(e>>>=0),a=Math.min(o,r),l=this.slice(n,s),c=t.slice(e,i),h=0;h<a;++h)if(l[h]!==c[h]){o=l[h],r=c[h];break}return o<r?-1:r<o?1:0},Buffer.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},Buffer.prototype.indexOf=function(t,e,i){return bidirectionalIndexOf(this,t,e,i,!0)},Buffer.prototype.lastIndexOf=function(t,e,i){return bidirectionalIndexOf(this,t,e,i,!1)},Buffer.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var s=this.length-e;if((void 0===i||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return hexWrite(this,t,e,i);case"utf8":case"utf-8":return utf8Write(this,t,e,i);case"ascii":return asciiWrite(this,t,e,i);case"latin1":case"binary":return latin1Write(this,t,e,i);case"base64":return base64Write(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(t){var e=t.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=MAX_ARGUMENTS_LENGTH));return i}function asciiSlice(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(127&t[s]);return n}function latin1Slice(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(t[s]);return n}function hexSlice(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var s="",o=e;o<i;++o)s+=toHex(t[o]);return s}function utf16leSlice(t,e,i){for(var n=t.slice(e,i),s="",o=0;o<n.length;o+=2)s+=String.fromCharCode(n[o]+256*n[o+1]);return s}function checkOffset(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,i,n,s,o){if(!internalIsBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function objectWriteUInt16(t,e,i,n){e<0&&(e=65535+e+1);for(var s=0,o=Math.min(t.length-i,2);s<o;++s)t[i+s]=(e&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function objectWriteUInt32(t,e,i,n){e<0&&(e=4294967295+e+1);for(var s=0,o=Math.min(t.length-i,4);s<o;++s)t[i+s]=e>>>8*(n?s:3-s)&255}function checkIEEE754(t,e,i,n){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function writeFloat(t,e,i,n,s){return s||checkIEEE754(t,e,i,4),write(t,e,i,n,23,4),i+4}function writeDouble(t,e,i,n,s){return s||checkIEEE754(t,e,i,8),write(t,e,i,n,52,8),i+8}Buffer.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),Buffer.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=Buffer.prototype;else{var s=e-t;i=new Buffer(s,void 0);for(var o=0;o<s;++o)i[o]=this[o+t]}return i},Buffer.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||checkOffset(t,e,this.length);for(var n=this[t],s=1,o=0;++o<e&&(s*=256);)n+=this[t+o]*s;return n},Buffer.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||checkOffset(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||checkOffset(t,e,this.length);for(var n=this[t],s=1,o=0;++o<e&&(s*=256);)n+=this[t+o]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||checkOffset(t,e,this.length);for(var n=e,s=1,o=this[t+--n];n>0&&(s*=256);)o+=this[t+--n]*s;return o>=(s*=128)&&(o-=Math.pow(2,8*e)),o},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,i,n){t=+t,e|=0,i|=0,n||checkInt(this,t,e,i,Math.pow(2,8*i)-1,0);var s=1,o=0;for(this[e]=255&t;++o<i&&(s*=256);)this[e+o]=t/s&255;return e+i},Buffer.prototype.writeUIntBE=function(t,e,i,n){t=+t,e|=0,i|=0,n||checkInt(this,t,e,i,Math.pow(2,8*i)-1,0);var s=i-1,o=1;for(this[e+s]=255&t;--s>=0&&(o*=256);)this[e+s]=t/o&255;return e+i},Buffer.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var s=Math.pow(2,8*i-1);checkInt(this,t,e,i,s-1,-s)}var o=0,r=1,a=0;for(this[e]=255&t;++o<i&&(r*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/r>>0)-a&255;return e+i},Buffer.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var s=Math.pow(2,8*i-1);checkInt(this,t,e,i,s-1,-s)}var o=i-1,r=1,a=0;for(this[e+o]=255&t;--o>=0&&(r*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/r>>0)-a&255;return e+i},Buffer.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||checkInt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,i){return writeFloat(this,t,e,!0,i)},Buffer.prototype.writeFloatBE=function(t,e,i){return writeFloat(this,t,e,!1,i)},Buffer.prototype.writeDoubleLE=function(t,e,i){return writeDouble(this,t,e,!0,i)},Buffer.prototype.writeDoubleBE=function(t,e,i){return writeDouble(this,t,e,!1,i)},Buffer.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var s,o=n-i;if(this===t&&i<e&&e<n)for(s=o-1;s>=0;--s)t[s+e]=this[s+i];else if(o<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(s=0;s<o;++s)t[s+e]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},Buffer.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var r=internalIsBuffer(t)?t:utf8ToBytes(new Buffer(t,n).toString()),a=r.length;for(o=0;o<i-e;++o)this[o+e]=r[o%a]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(t){if((t=stringtrim(t).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return t<16?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){var i;e=e||1/0;for(var n=t.length,s=null,o=[],r=0;r<n;++r){if((i=t.charCodeAt(r))>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(r+1===n){(e-=3)>-1&&o.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(e-=3)>-1&&o.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function asciiToBytes(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}function utf16leToBytes(t,e){for(var i,n,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(i=t.charCodeAt(o))>>8,s.push(i%256),s.push(n);return s}function base64ToBytes(t){return toByteArray(base64clean(t))}function blitBuffer(t,e,i,n){for(var s=0;s<n&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}function isnan(t){return t!=t}function isBuffer(t){return null!=t&&(!!t._isBuffer||isFastBuffer(t)||isSlowBuffer(t))}function isFastBuffer(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function isSlowBuffer(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&isFastBuffer(t.slice(0,0))}var bufferEs6=Object.freeze({__proto__:null,Buffer,INSPECT_MAX_BYTES,SlowBuffer,isBuffer,kMaxLength:_kMaxLength}),isBuffer$1=isBuf,withNativeBuffer="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,withNativeArrayBuffer="function"==typeof ArrayBuffer,isView=function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer};function isBuf(t){return withNativeBuffer&&Buffer.isBuffer(t)||withNativeArrayBuffer&&(t instanceof ArrayBuffer||isView(t))}var toString$2=Object.prototype.toString,withNativeBlob="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===toString$2.call(Blob),withNativeFile="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===toString$2.call(File),deconstructPacket=function(t){var e=[],i=t;return i.data=_deconstructPacket(t.data,e),i.attachments=e.length,{packet:i,buffers:e}};function _deconstructPacket(t,e){if(!t)return t;if(isBuffer$1(t)){var i={_placeholder:!0,num:e.length};return e.push(t),i}if(isarray(t)){for(var n=new Array(t.length),s=0;s<t.length;s++)n[s]=_deconstructPacket(t[s],e);return n}if("object"==typeof t&&!(t instanceof Date)){for(var o in n={},t)n[o]=_deconstructPacket(t[o],e);return n}return t}var reconstructPacket=function(t,e){return t.data=_reconstructPacket(t.data,e),t.attachments=void 0,t};function _reconstructPacket(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(isarray(t))for(var i=0;i<t.length;i++)t[i]=_reconstructPacket(t[i],e);else if("object"==typeof t)for(var n in t)t[n]=_reconstructPacket(t[n],e);return t}var removeBlobs=function(t,e){var i=0,n=t;!function t(s,o,r){if(!s)return s;if(withNativeBlob&&s instanceof Blob||withNativeFile&&s instanceof File){i++;var a=new FileReader;a.onload=function(){r?r[o]=this.result:n=this.result,--i||e(n)},a.readAsArrayBuffer(s)}else if(isarray(s))for(var l=0;l<s.length;l++)t(s[l],l,s);else if("object"==typeof s&&!isBuffer$1(s))for(var c in s)t(s[c],c,s)}(n),i||e(n)},binary={deconstructPacket,reconstructPacket,removeBlobs},socket_ioParser=createCommonjsModule((function(t,i){var n=browser$1("socket.io-parser");function s(){}i.protocol=4,i.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],i.CONNECT=0,i.DISCONNECT=1,i.EVENT=2,i.ACK=3,i.ERROR=4,i.BINARY_EVENT=5,i.BINARY_ACK=6,i.Encoder=s,i.Decoder=a;var o=i.ERROR+'"encode error"';function r(t){var s=""+t.type;if(i.BINARY_EVENT!==t.type&&i.BINARY_ACK!==t.type||(s+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(s+=t.nsp+","),null!=t.id&&(s+=t.id),null!=t.data){var r=function(t){try{return JSON.stringify(t)}catch(e){return!1}}(t.data);if(!1===r)return o;s+=r}return n("encoded %j as %s",t,s),s}function a(){this.reconstructor=null}function l(t){this.reconPack=t,this.buffers=[]}function c(t){return{type:i.ERROR,data:"parser error: "+t}}s.prototype.encode=function(t,e){n("encoding packet %j",t),i.BINARY_EVENT===t.type||i.BINARY_ACK===t.type?function(t,e){binary.removeBlobs(t,(function(t){var i=binary.deconstructPacket(t),n=r(i.packet),s=i.buffers;s.unshift(n),e(s)}))}(t,e):e([r(t)])},componentEmitter(a.prototype),a.prototype.add=function(t){var s;if("string"==typeof t)s=function(t){var s=0,o={type:Number(t.charAt(0))};if(null==i.types[o.type])return c("unknown packet type "+o.type);if(i.BINARY_EVENT===o.type||i.BINARY_ACK===o.type){for(var r="";"-"!==t.charAt(++s)&&(r+=t.charAt(s),s!=t.length););if(r!=Number(r)||"-"!==t.charAt(s))throw new Error("Illegal attachments");o.attachments=Number(r)}if("/"===t.charAt(s+1))for(o.nsp="";++s&&","!==(l=t.charAt(s))&&(o.nsp+=l,s!==t.length););else o.nsp="/";var a=t.charAt(s+1);if(""!==a&&Number(a)==a){for(o.id="";++s;){var l;if(null==(l=t.charAt(s))||Number(l)!=l){--s;break}if(o.id+=t.charAt(s),s===t.length)break}o.id=Number(o.id)}if(t.charAt(++s)){var h=function(t){try{return JSON.parse(t)}catch(e){return!1}}(t.substr(s));if(!1===h||o.type!==i.ERROR&&!isarray(h))return c("invalid payload");o.data=h}return n("decoded %s as %j",t,o),o}(t),i.BINARY_EVENT===s.type||i.BINARY_ACK===s.type?(this.reconstructor=new l(s),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",s)):this.emit("decoded",s);else{if(!isBuffer$1(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(s=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",s))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=binary.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}})),hasCors=createCommonjsModule((function(t){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}})),globalThis_browser="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),xmlhttprequest=function(t){var i=t.xdomain,n=t.xscheme,s=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||hasCors))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(e){}if(!i)try{return new(globalThis_browser[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}},keys=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e},toString$3={}.toString,isarray$1=Array.isArray||function(t){return"[object Array]"==toString$3.call(t)},toString$4=Object.prototype.toString,withNativeBlob$1="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===toString$4.call(Blob),withNativeFile$1="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===toString$4.call(File),hasBinary2=hasBinary;function hasBinary(t){if(!t||"object"!=typeof t)return!1;if(isarray$1(t)){for(var e=0,i=t.length;e<i;e++)if(hasBinary(t[e]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||withNativeBlob$1&&t instanceof Blob||withNativeFile$1&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return hasBinary(t.toJSON(),!0);for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&hasBinary(t[n]))return!0;return!1}var arraybuffer_slice=function(t,e,i){var n=t.byteLength;if(e=e||0,i=i||n,t.slice)return t.slice(e,i);if(e<0&&(e+=n),i<0&&(i+=n),i>n&&(i=n),e>=n||e>=i||0===n)return new ArrayBuffer(0);for(var s=new Uint8Array(t),o=new Uint8Array(i-e),r=e,a=0;r<i;r++,a++)o[a]=s[r];return o.buffer},after_1=after;function after(t,e,i){var n=!1;return i=i||noop,s.count=t,0===t?e():s;function s(t,o){if(s.count<=0)throw new Error("after called too many times");--s.count,t?(n=!0,e(t),e=i):0!==s.count||n||e(null,o)}}function noop(){}
/*! https://mths.be/utf8js v2.1.2 by @mathias */var stringFromCharCode=String.fromCharCode,byteArray,byteCount,byteIndex;function ucs2decode(t){for(var e,i,n=[],s=0,o=t.length;s<o;)(e=t.charCodeAt(s++))>=55296&&e<=56319&&s<o?56320==(64512&(i=t.charCodeAt(s++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),s--):n.push(e);return n}function ucs2encode(t){for(var e,i=t.length,n=-1,s="";++n<i;)(e=t[n])>65535&&(s+=stringFromCharCode((e-=65536)>>>10&1023|55296),e=56320|1023&e),s+=stringFromCharCode(e);return s}function checkScalarValue(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function createByte(t,e){return stringFromCharCode(t>>e&63|128)}function encodeCodePoint(t,e){if(0==(4294967168&t))return stringFromCharCode(t);var i="";return 0==(4294965248&t)?i=stringFromCharCode(t>>6&31|192):0==(4294901760&t)?(checkScalarValue(t,e)||(t=65533),i=stringFromCharCode(t>>12&15|224),i+=createByte(t,6)):0==(4292870144&t)&&(i=stringFromCharCode(t>>18&7|240),i+=createByte(t,12),i+=createByte(t,6)),i+stringFromCharCode(63&t|128)}function utf8encode(t,e){for(var i=!1!==(e=e||{}).strict,n=ucs2decode(t),s=n.length,o=-1,r="";++o<s;)r+=encodeCodePoint(n[o],i);return r}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var t=255&byteArray[byteIndex];if(byteIndex++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function decodeSymbol(t){var e,i;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(e=255&byteArray[byteIndex],byteIndex++,0==(128&e))return e;if(192==(224&e)){if((i=(31&e)<<6|readContinuationByte())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if((i=(15&e)<<12|readContinuationByte()<<6|readContinuationByte())>=2048)return checkScalarValue(i,t)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(i=(7&e)<<18|readContinuationByte()<<12|readContinuationByte()<<6|readContinuationByte())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}function utf8decode(t,e){var i=!1!==(e=e||{}).strict;byteArray=ucs2decode(t),byteCount=byteArray.length,byteIndex=0;for(var n,s=[];!1!==(n=decodeSymbol(i));)s.push(n);return ucs2encode(s)}var utf8={version:"2.1.2",encode:utf8encode,decode:utf8decode},base64Arraybuffer=createCommonjsModule((function(t,e){!function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),n=0;n<t.length;n++)i[t.charCodeAt(n)]=n;e.encode=function(e){var i,n=new Uint8Array(e),s=n.length,o="";for(i=0;i<s;i+=3)o+=t[n[i]>>2],o+=t[(3&n[i])<<4|n[i+1]>>4],o+=t[(15&n[i+1])<<2|n[i+2]>>6],o+=t[63&n[i+2]];return s%3==2?o=o.substring(0,o.length-1)+"=":s%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(t){var e,n,s,o,r,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var h=new ArrayBuffer(a),d=new Uint8Array(h);for(e=0;e<l;e+=4)n=i[t.charCodeAt(e)],s=i[t.charCodeAt(e+1)],o=i[t.charCodeAt(e+2)],r=i[t.charCodeAt(e+3)],d[c++]=n<<2|s>>4,d[c++]=(15&s)<<4|o>>2,d[c++]=(3&o)<<6|63&r;return h}}()})),BlobBuilder$1=void 0!==BlobBuilder$1?BlobBuilder$1:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,blobSupported=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),blobSupportsArrayBufferView=blobSupported&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),blobBuilderSupported=BlobBuilder$1&&BlobBuilder$1.prototype.append&&BlobBuilder$1.prototype.getBlob;function mapArrayBufferViews(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var i=new Uint8Array(t.byteLength);i.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=i.buffer}return e}return t}))}function BlobBuilderConstructor(t,e){e=e||{};var i=new BlobBuilder$1;return mapArrayBufferViews(t).forEach((function(t){i.append(t)})),e.type?i.getBlob(e.type):i.getBlob()}function BlobConstructor(t,e){return new Blob(mapArrayBufferViews(t),e||{})}"undefined"!=typeof Blob&&(BlobBuilderConstructor.prototype=Blob.prototype,BlobConstructor.prototype=Blob.prototype);var blob=blobSupported?blobSupportsArrayBufferView?Blob:BlobConstructor:blobBuilderSupported?BlobBuilderConstructor:void 0,browser$2=createCommonjsModule((function(t,i){var n;"undefined"!=typeof ArrayBuffer&&(n=base64Arraybuffer);var s="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),o="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),r=s||o;i.protocol=3;var a=i.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},l=keys(a),c={type:"error",data:"parser error"};function h(t,e,i){for(var n=new Array(t.length),s=after_1(t.length,i),o=function(t,i,s){e(i,(function(e,i){n[t]=i,s(e,n)}))},r=0;r<t.length;r++)o(r,t[r],s)}i.encodePacket=function(t,e,n,s){"function"==typeof e&&(s=e,e=!1),"function"==typeof n&&(s=n,n=null);var o=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,e,n){if(!e)return i.encodeBase64Packet(t,n);var s=t.data,o=new Uint8Array(s),r=new Uint8Array(1+s.byteLength);r[0]=a[t.type];for(var l=0;l<o.length;l++)r[l+1]=o[l];return n(r.buffer)}(t,e,s);if(void 0!==blob&&o instanceof blob)return function(t,e,n){if(!e)return i.encodeBase64Packet(t,n);if(r)return function(t,e,n){if(!e)return i.encodeBase64Packet(t,n);var s=new FileReader;return s.onload=function(){i.encodePacket({type:t.type,data:s.result},e,!0,n)},s.readAsArrayBuffer(t.data)}(t,e,n);var s=new Uint8Array(1);return s[0]=a[t.type],n(new blob([s.buffer,t.data]))}(t,e,s);if(o&&o.base64)return function(t,e){return e("b"+i.packets[t.type]+t.data.data)}(t,s);var l=a[t.type];return void 0!==t.data&&(l+=n?utf8.encode(String(t.data),{strict:!1}):String(t.data)),s(""+l)},i.encodeBase64Packet=function(t,n){var s,o="b"+i.packets[t.type];if(void 0!==blob&&t.data instanceof blob){var r=new FileReader;return r.onload=function(){var t=r.result.split(",")[1];n(o+t)},r.readAsDataURL(t.data)}try{s=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var a=new Uint8Array(t.data),l=new Array(a.length),c=0;c<a.length;c++)l[c]=a[c];s=String.fromCharCode.apply(null,l)}return o+=btoa(s),n(o)},i.decodePacket=function(t,n,s){if(void 0===t)return c;if("string"==typeof t){if("b"===t.charAt(0))return i.decodeBase64Packet(t.substr(1),n);if(s&&!1===(t=function(t){try{t=utf8.decode(t,{strict:!1})}catch(e){return!1}return t}(t)))return c;var o=t.charAt(0);return Number(o)==o&&l[o]?t.length>1?{type:l[o],data:t.substring(1)}:{type:l[o]}:c}o=new Uint8Array(t)[0];var r=arraybuffer_slice(t,1);return blob&&"blob"===n&&(r=new blob([r])),{type:l[o],data:r}},i.decodeBase64Packet=function(t,e){var i=l[t.charAt(0)];if(!n)return{type:i,data:{base64:!0,data:t.substr(1)}};var s=n.decode(t.substr(1));return"blob"===e&&blob&&(s=new blob([s])),{type:i,data:s}},i.encodePayload=function(t,e,n){"function"==typeof e&&(n=e,e=null);var s=hasBinary2(t);return e&&s?blob&&!r?i.encodePayloadAsBlob(t,n):i.encodePayloadAsArrayBuffer(t,n):t.length?void h(t,(function(t,n){i.encodePacket(t,!!s&&e,!1,(function(t){n(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return n(e.join(""))})):n("0:")},i.decodePayload=function(t,e,n){if("string"!=typeof t)return i.decodePayloadAsBinary(t,e,n);var s;if("function"==typeof e&&(n=e,e=null),""===t)return n(c,0,1);for(var o,r,a="",l=0,h=t.length;l<h;l++){var d=t.charAt(l);if(":"===d){if(""===a||a!=(o=Number(a)))return n(c,0,1);if(a!=(r=t.substr(l+1,o)).length)return n(c,0,1);if(r.length){if(s=i.decodePacket(r,e,!1),c.type===s.type&&c.data===s.data)return n(c,0,1);if(!1===n(s,l+o,h))return}l+=o,a=""}else a+=d}return""!==a?n(c,0,1):void 0},i.encodePayloadAsArrayBuffer=function(t,e){if(!t.length)return e(new ArrayBuffer(0));h(t,(function(t,e){i.encodePacket(t,!0,!0,(function(t){return e(null,t)}))}),(function(t,i){var n=i.reduce((function(t,e){var i;return t+(i="string"==typeof e?e.length:e.byteLength).toString().length+i+2}),0),s=new Uint8Array(n),o=0;return i.forEach((function(t){var e="string"==typeof t,i=t;if(e){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);i=n.buffer}s[o++]=e?0:1;var a=i.byteLength.toString();for(r=0;r<a.length;r++)s[o++]=parseInt(a[r]);for(s[o++]=255,n=new Uint8Array(i),r=0;r<n.length;r++)s[o++]=n[r]})),e(s.buffer)}))},i.encodePayloadAsBlob=function(t,e){h(t,(function(t,e){i.encodePacket(t,!0,!0,(function(t){var i=new Uint8Array(1);if(i[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);t=n.buffer,i[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),r=new Uint8Array(o.length+1);for(s=0;s<o.length;s++)r[s]=parseInt(o[s]);if(r[o.length]=255,blob){var a=new blob([i.buffer,r.buffer,t]);e(null,a)}}))}),(function(t,i){return e(new blob(i))}))},i.decodePayloadAsBinary=function(t,n,s){"function"==typeof n&&(s=n,n=null);for(var o=t,r=[];o.byteLength>0;){for(var a=new Uint8Array(o),l=0===a[0],h="",d=1;255!==a[d];d++){if(h.length>310)return s(c,0,1);h+=a[d]}o=arraybuffer_slice(o,2+h.length),h=parseInt(h);var u=arraybuffer_slice(o,0,h);if(l)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var m=new Uint8Array(u);for(u="",d=0;d<m.length;d++)u+=String.fromCharCode(m[d])}r.push(u),o=arraybuffer_slice(o,h)}var p=r.length;r.forEach((function(t,e){s(i.decodePacket(t,n,!0),e,p)}))}})),transport=Transport;function Transport(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}componentEmitter(Transport.prototype),Transport.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},Transport.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},Transport.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},Transport.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},Transport.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Transport.prototype.onData=function(t){var e=browser$2.decodePacket(t,this.socket.binaryType);this.onPacket(e)},Transport.prototype.onPacket=function(t){this.emit("packet",t)},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},decode=function(t){for(var e={},i=t.split("&"),n=0,s=i.length;n<s;n++){var o=i[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e},parseqs={encode,decode},componentInherit=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={},seed=0,i=0,prev;function encode$1(t){var e="";do{e=alphabet[t%length]+e,t=Math.floor(t/length)}while(t>0);return e}function decode$1(t){var e=0;for(i=0;i<t.length;i++)e=e*length+map[t.charAt(i)];return e}function yeast(){var t=encode$1(+new Date);return t!==prev?(seed=0,prev=t):t+"."+encode$1(seed++)}for(;i<length;i++)map[alphabet[i]]=i;yeast.encode=encode$1,yeast.decode=decode$1;var yeast_1=yeast,debug$2=browser("engine.io-client:polling"),polling=Polling,hasXHR2=null!=new xmlhttprequest({xdomain:!1}).responseType;function Polling(t){hasXHR2&&!(t&&t.forceBase64)||(this.supportsBinary=!1),transport.call(this,t)}componentInherit(Polling,transport),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(t){var e=this;function i(){debug$2("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(debug$2("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){debug$2("pre-pause polling complete"),--n||i()}))),this.writable||(debug$2("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){debug$2("pre-pause writing complete"),--n||i()})))}else i()},Polling.prototype.poll=function(){debug$2("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(t){var e=this;debug$2("polling got data %s",t),browser$2.decodePayload(t,this.socket.binaryType,(function(t){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():debug$2('ignoring poll - transport state "%s"',this.readyState))},Polling.prototype.doClose=function(){var t=this;function e(){debug$2("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(debug$2("transport open - closing"),e()):(debug$2("transport not open - deferring close"),this.once("open",e))},Polling.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};browser$2.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,i)}))},Polling.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=yeast_1()),this.supportsBinary||t.sid||(t.b64=1),t=parseqs.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t};var debug$3=browser("engine.io-client:polling-xhr"),pollingXhr=XHR,Request_1=Request;function empty(){}function XHR(t){if(polling.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,i=location.port;i||(i=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==e}}function Request(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(componentInherit(XHR,polling),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new Request(t)},XHR.prototype.doWrite=function(t,e){var i=this.request({method:"POST",data:t,isBinary:"string"!=typeof t&&void 0!==t}),n=this;i.on("success",e),i.on("error",(function(t){n.onError("xhr post error",t)})),this.sendXhr=i},XHR.prototype.doPoll=function(){debug$3("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},componentEmitter(Request.prototype),Request.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new xmlhttprequest(t),n=this;try{debug$3("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var s in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(s)&&i.setRequestHeader(s,this.extraHeaders[s])}catch(e){}if("POST"===this.method)try{i.setRequestHeader("Content-type",this.isBinary?"application/octet-stream":"text/plain;charset=UTF-8")}catch(e){}try{i.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in i&&(i.withCredentials=this.withCredentials),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){n.onLoad()},i.onerror=function(){n.onError(i.responseText)}):i.onreadystatechange=function(){if(2===i.readyState)try{var t=i.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(i.responseType="arraybuffer")}catch(e){}4===i.readyState&&(200===i.status||1223===i.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof i.status?i.status:0)}),0))},debug$3("xhr data %s",this.data),i.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},Request.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},Request.prototype.cleanup=function(t){if(null!=this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,t)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var t;try{var i;try{i=this.xhr.getResponseHeader("Content-Type")}catch(e){}t=("application/octet-stream"===i||"application/octet-stream; charset=UTF-8"===i)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=t&&this.onData(t)},Request.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},Request.requestsCount=0,Request.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){var terminationEvent="onpagehide"in globalThis_browser?"pagehide":"unload";addEventListener(terminationEvent,unloadHandler,!1)}function unloadHandler(){for(var t in Request.requests)Request.requests.hasOwnProperty(t)&&Request.requests[t].abort()}pollingXhr.Request=Request_1;var pollingJsonp=JSONPPolling,rNewline=/\n/g,rEscapedNewline=/\\n/g,callbacks;function empty$1(){}function JSONPPolling(t){polling.call(this,t),this.query=this.query||{},callbacks||(callbacks=globalThis_browser.___eio=globalThis_browser.___eio||[]),this.index=callbacks.length;var e=this;callbacks.push((function(t){e.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){e.script&&(e.script.onerror=empty$1)}),!1)}componentInherit(JSONPPolling,polling),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},JSONPPolling.prototype.doWrite=function(t,i){var n=this;if(!this.form){var s,o=document.createElement("form"),r=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=a,o.method="POST",o.setAttribute("accept-charset","utf-8"),r.name="d",o.appendChild(r),document.body.appendChild(o),this.form=o,this.area=r}function l(){c(),i()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{s=document.createElement('<iframe src="javascript:0" name="'+n.iframeId+'">')}catch(e){(s=document.createElement("iframe")).name=n.iframeId,s.src="javascript:0"}s.id=n.iframeId,n.form.appendChild(s),n.iframe=s}this.form.action=this.uri(),c(),t=t.replace(rEscapedNewline,"\\\n"),this.area.value=t.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&l()}:this.iframe.onload=l};var _nodeResolve_empty={},_nodeResolve_empty$1=Object.freeze({__proto__:null,default:_nodeResolve_empty}),require$$1=getCjsExportFromNamespace(_nodeResolve_empty$1),debug$4=browser("engine.io-client:websocket"),BrowserWebSocket,NodeWebSocket;if("undefined"!=typeof WebSocket?BrowserWebSocket=WebSocket:"undefined"!=typeof self&&(BrowserWebSocket=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{NodeWebSocket=require$$1}catch(e){}var WebSocketImpl=BrowserWebSocket||NodeWebSocket,websocket=WS;function WS(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=BrowserWebSocket&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(WebSocketImpl=NodeWebSocket),transport.call(this,t)}componentInherit(WS,transport),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new WebSocketImpl(t,e):new WebSocketImpl(t):new WebSocketImpl(t,e,i)}catch(n){return this.emit("error",n)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},WS.prototype.write=function(t){var i=this;this.writable=!1;for(var n=t.length,s=0,o=n;s<o;s++)!function(t){browser$2.encodePacket(t,i.supportsBinary,(function(s){if(!i.usingBrowserWebSocket){var o={};t.options&&(o.compress=t.options.compress),i.perMessageDeflate&&("string"==typeof s?Buffer.byteLength(s):s.length)<i.perMessageDeflate.threshold&&(o.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(s):i.ws.send(s,o)}catch(e){debug$4("websocket closed before onclose event")}--n||(i.emit("flush"),setTimeout((function(){i.writable=!0,i.emit("drain")}),0))}))}(t[s])},WS.prototype.onClose=function(){transport.prototype.onClose.call(this)},WS.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},WS.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=yeast_1()),this.supportsBinary||(t.b64=1),(t=parseqs.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},WS.prototype.check=function(){return!(!WebSocketImpl||"__initialize"in WebSocketImpl&&this.name===WS.prototype.name)};var polling_1=polling$1,websocket_1=websocket;function polling$1(t){var e=!1,i=!1,n=!1!==t.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,o=location.port;o||(o=s?443:80),e=t.hostname!==location.hostname||o!==t.port,i=t.secure!==s}if(t.xdomain=e,t.xscheme=i,"open"in new xmlhttprequest(t)&&!t.forceJSONP)return new pollingXhr(t);if(!n)throw new Error("JSONP disabled");return new pollingJsonp(t)}var transports={polling:polling_1,websocket:websocket_1},indexOf=[].indexOf,indexof=function(t,e){if(indexOf)return t.indexOf(e);for(var i=0;i<t.length;++i)if(t[i]===e)return i;return-1},debug$5=browser("engine.io-client:socket"),socket=Socket;function Socket(t,e){if(!(this instanceof Socket))return new Socket(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=parseuri(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=parseuri(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=parseqs.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function clone(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}Socket.priorWebsocketSuccess=!1,componentEmitter(Socket.prototype),Socket.protocol=browser$2.protocol,Socket.Socket=Socket,Socket.Transport=transport,Socket.transports=transports,Socket.parser=browser$2,Socket.prototype.createTransport=function(t){debug$5('creating transport "%s"',t);var e=clone(this.query);e.EIO=browser$2.protocol,e.transport=t;var i=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new transports[t]({query:e,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,withCredentials:i.withCredentials||this.withCredentials,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0,isReactNative:this.isReactNative})},Socket.prototype.open=function(){var t;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var i=this;return void setTimeout((function(){i.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(e){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},Socket.prototype.setTransport=function(t){debug$5("setting transport %s",t.name);var e=this;this.transport&&(debug$5("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},Socket.prototype.probe=function(t){debug$5('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),i=!1,n=this;function s(){n.onlyBinaryUpgrades&&(i=i||!this.supportsBinary&&n.transport.supportsBinary),i||(debug$5('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(s){if(!i)if("pong"===s.type&&"probe"===s.data){if(debug$5('probe transport "%s" pong',t),n.upgrading=!0,n.emit("upgrading",e),!e)return;Socket.priorWebsocketSuccess="websocket"===e.name,debug$5('pausing current transport "%s"',n.transport.name),n.transport.pause((function(){i||"closed"!==n.readyState&&(debug$5("changing transport and sending upgrade packet"),h(),n.setTransport(e),e.send([{type:"upgrade"}]),n.emit("upgrade",e),e=null,n.upgrading=!1,n.flush())}))}else{debug$5('probe transport "%s" failed',t);var o=new Error("probe error");o.transport=e.name,n.emit("upgradeError",o)}})))}function o(){i||(i=!0,h(),e.close(),e=null)}function r(i){var s=new Error("probe error: "+i);s.transport=e.name,o(),debug$5('probe transport "%s" failed because of error: %s',t,i),n.emit("upgradeError",s)}function a(){r("transport closed")}function l(){r("socket closed")}function c(t){e&&t.name!==e.name&&(debug$5('"%s" works - aborting "%s"',t.name,e.name),o())}function h(){e.removeListener("open",s),e.removeListener("error",r),e.removeListener("close",a),n.removeListener("close",l),n.removeListener("upgrading",c)}Socket.priorWebsocketSuccess=!1,e.once("open",s),e.once("error",r),e.once("close",a),this.once("close",l),this.once("upgrading",c),e.open()},Socket.prototype.onOpen=function(){if(debug$5("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){debug$5("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},Socket.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(debug$5('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else debug$5('packet received with socket readyState "%s"',this.readyState)},Socket.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},Socket.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){debug$5("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},Socket.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},Socket.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug$5("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},Socket.prototype.sendPacket=function(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var s={type:t,data:e,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}},Socket.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():e()})):this.upgrading?n():e()}function e(){t.onClose("forced close"),debug$5("socket closing - telling transport to close"),t.transport.close()}function i(){t.removeListener("upgrade",i),t.removeListener("upgradeError",i),e()}function n(){t.once("upgrade",i),t.once("upgradeError",i)}return this},Socket.prototype.onError=function(t){debug$5("socket error %j",t),Socket.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},Socket.prototype.onClose=function(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(debug$5('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)},Socket.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~indexof(this.transports,t[i])&&e.push(t[i]);return e};var lib=socket,parser=browser$2;lib.parser=parser;var toArray_1=toArray;function toArray(t,e){for(var i=[],n=(e=e||0)||0;n<t.length;n++)i[n-e]=t[n];return i}var on_1=on;function on(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}var slice=[].slice,componentBind=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var i=slice.call(arguments,2);return function(){return e.apply(t,i.concat(slice.call(arguments)))}},socket$1=createCommonjsModule((function(t){var e=browser("socket.io-client:socket");t.exports=s;var i={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},n=componentEmitter.prototype.emit;function s(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}componentEmitter(s.prototype),s.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[on_1(t,"open",componentBind(this,"onopen")),on_1(t,"packet",componentBind(this,"onpacket")),on_1(t,"close",componentBind(this,"onclose"))]}},s.prototype.open=s.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},s.prototype.send=function(){var t=toArray_1(arguments);return t.unshift("message"),this.emit.apply(this,t),this},s.prototype.emit=function(t){if(i.hasOwnProperty(t))return n.apply(this,arguments),this;var s=toArray_1(arguments),o={type:(void 0!==this.flags.binary?this.flags.binary:hasBinary2(s))?socket_ioParser.BINARY_EVENT:socket_ioParser.EVENT,data:s,options:{}};return o.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof s[s.length-1]&&(e("emitting packet with ack id %d",this.ids),this.acks[this.ids]=s.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),this.flags={},this},s.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},s.prototype.onopen=function(){if(e("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?parseqs.encode(this.query):this.query;e("sending connect packet with query %s",t),this.packet({type:socket_ioParser.CONNECT,query:t})}else this.packet({type:socket_ioParser.CONNECT})},s.prototype.onclose=function(t){e("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},s.prototype.onpacket=function(t){if(t.nsp===this.nsp||t.type===socket_ioParser.ERROR&&"/"===t.nsp)switch(t.type){case socket_ioParser.CONNECT:this.onconnect();break;case socket_ioParser.EVENT:case socket_ioParser.BINARY_EVENT:this.onevent(t);break;case socket_ioParser.ACK:case socket_ioParser.BINARY_ACK:this.onack(t);break;case socket_ioParser.DISCONNECT:this.ondisconnect();break;case socket_ioParser.ERROR:this.emit("error",t.data)}},s.prototype.onevent=function(t){var i=t.data||[];e("emitting event %j",i),null!=t.id&&(e("attaching ack callback to event"),i.push(this.ack(t.id))),this.connected?n.apply(this,i):this.receiveBuffer.push(i)},s.prototype.ack=function(t){var i=this,n=!1;return function(){if(!n){n=!0;var s=toArray_1(arguments);e("sending ack %j",s),i.packet({type:hasBinary2(s)?socket_ioParser.BINARY_ACK:socket_ioParser.ACK,id:t,data:s})}}},s.prototype.onack=function(t){var i=this.acks[t.id];"function"==typeof i?(e("calling ack %s with %j",t.id,t.data),i.apply(this,t.data),delete this.acks[t.id]):e("bad ack %s",t.id)},s.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},s.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)n.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},s.prototype.ondisconnect=function(){e("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},s.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},s.prototype.close=s.prototype.disconnect=function(){return this.connected&&(e("performing disconnect (%s)",this.nsp),this.packet({type:socket_ioParser.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},s.prototype.compress=function(t){return this.flags.compress=t,this},s.prototype.binary=function(t){return this.flags.binary=t,this}})),backo2=Backoff;function Backoff(t){this.ms=(t=t||{}).min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(t){this.ms=t},Backoff.prototype.setMax=function(t){this.max=t},Backoff.prototype.setJitter=function(t){this.jitter=t};var debug$6=browser("socket.io-client:manager"),has=Object.prototype.hasOwnProperty,manager=Manager;function Manager(t,e){if(!(this instanceof Manager))return new Manager(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new backo2({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=e.parser||socket_ioParser;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}Manager.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)has.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},Manager.prototype.updateSocketIds=function(){for(var t in this.nsps)has.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},Manager.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},componentEmitter(Manager.prototype),Manager.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},Manager.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},Manager.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},Manager.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(t){if(debug$6("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;debug$6("opening %s",this.uri),this.engine=lib(this.uri,this.opts);var e=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var n=on_1(e,"open",(function(){i.onopen(),t&&t()})),s=on_1(e,"error",(function(e){if(debug$6("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var o=this._timeout;debug$6("connect attempt will timeout after %d",o);var r=setTimeout((function(){debug$6("connect attempt timed out after %d",o),n.destroy(),e.close(),e.emit("error","timeout"),i.emitAll("connect_timeout",o)}),o);this.subs.push({destroy:function(){clearTimeout(r)}})}return this.subs.push(n),this.subs.push(s),this},Manager.prototype.onopen=function(){debug$6("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(on_1(t,"data",componentBind(this,"ondata"))),this.subs.push(on_1(t,"ping",componentBind(this,"onping"))),this.subs.push(on_1(t,"pong",componentBind(this,"onpong"))),this.subs.push(on_1(t,"error",componentBind(this,"onerror"))),this.subs.push(on_1(t,"close",componentBind(this,"onclose"))),this.subs.push(on_1(this.decoder,"decoded",componentBind(this,"ondecoded")))},Manager.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},Manager.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},Manager.prototype.ondata=function(t){this.decoder.add(t)},Manager.prototype.ondecoded=function(t){this.emit("packet",t)},Manager.prototype.onerror=function(t){debug$6("error",t),this.emitAll("error",t)},Manager.prototype.socket=function(t,e){var i=this.nsps[t];if(!i){i=new socket$1(this,t,e),this.nsps[t]=i;var n=this;i.on("connecting",s),i.on("connect",(function(){i.id=n.generateId(t)})),this.autoConnect&&s()}function s(){~indexof(n.connecting,i)||n.connecting.push(i)}return i},Manager.prototype.destroy=function(t){var e=indexof(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},Manager.prototype.packet=function(t){debug$6("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(i){for(var n=0;n<i.length;n++)e.engine.write(i[n],t.options);e.encoding=!1,e.processPacketQueue()})))},Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},Manager.prototype.cleanup=function(){debug$6("cleanup");for(var t=this.subs.length,e=0;e<t;e++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){debug$6("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(t){debug$6("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)debug$6("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();debug$6("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout((function(){t.skipReconnect||(debug$6("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(debug$6("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(debug$6("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(i)}})}},Manager.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)};var lib$1=createCommonjsModule((function(t,e){var i=browser("socket.io-client");t.exports=e=s;var n=e.managers={};function s(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var s,o=url_1(t),r=o.source,a=o.id;return e.forceNew||e["force new connection"]||!1===e.multiplex||n[a]&&o.path in n[a].nsps?(i("ignoring socket cache for %s",r),s=manager(r,e)):(n[a]||(i("new io instance for %s",r),n[a]=manager(r,e)),s=n[a]),o.query&&!e.query&&(e.query=o.query),s.socket(o.path,e)}e.protocol=socket_ioParser.protocol,e.connect=s,e.Manager=manager,e.Socket=socket$1}));function EventHandlers(){}function EventEmitter(){EventEmitter.init.call(this)}function $getMaxListeners(t){return void 0===t._maxListeners?EventEmitter.defaultMaxListeners:t._maxListeners}function emitNone(t,e,i){if(e)t.call(i);else for(var n=t.length,s=arrayClone(t,n),o=0;o<n;++o)s[o].call(i)}function emitOne(t,e,i,n){if(e)t.call(i,n);else for(var s=t.length,o=arrayClone(t,s),r=0;r<s;++r)o[r].call(i,n)}function emitTwo(t,e,i,n,s){if(e)t.call(i,n,s);else for(var o=t.length,r=arrayClone(t,o),a=0;a<o;++a)r[a].call(i,n,s)}function emitThree(t,e,i,n,s,o){if(e)t.call(i,n,s,o);else for(var r=t.length,a=arrayClone(t,r),l=0;l<r;++l)a[l].call(i,n,s,o)}function emitMany(t,e,i,n){if(e)t.apply(i,n);else for(var s=t.length,o=arrayClone(t,s),r=0;r<s;++r)o[r].apply(i,n)}function _addListener(t,e,i,n){var s,o,r;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((o=t._events)?(o.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),o=t._events),r=o[e]):(o=t._events=new EventHandlers,t._eventsCount=0),r){if("function"==typeof r?r=o[e]=n?[i,r]:[r,i]:n?r.unshift(i):r.push(i),!r.warned&&(s=$getMaxListeners(t))&&s>0&&r.length>s){r.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=r.length,emitWarning(a)}}else r=o[e]=i,++t._eventsCount;return t}function emitWarning(t){"function"==typeof console.warn?console.warn(t):console.log(t)}function _onceWrap(t,e,i){var n=!1;function s(){t.removeListener(e,s),n||(n=!0,i.apply(t,arguments))}return s.listener=i,s}function listenerCount(t){var e=this._events;if(e){var i=e[t];if("function"==typeof i)return 1;if(i)return i.length}return 0}function spliceOne(t,e){for(var i=e,n=i+1,s=t.length;n<s;i+=1,n+=1)t[i]=t[n];t.pop()}function arrayClone(t,e){for(var i=new Array(e);e--;)i[e]=t[e];return i}function unwrapListeners(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}EventHandlers.prototype=Object.create(null),EventEmitter.EventEmitter=EventEmitter,EventEmitter.usingDomains=!1,EventEmitter.prototype.domain=void 0,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new EventHandlers,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function(t){var e,i,n,s,o,r,a,l="error"===t;if(r=this._events)l=l&&null==r.error;else if(!l)return!1;if(a=this.domain,l){if(e=arguments[1],!a){if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=a,e.domainThrown=!1,a.emit("error",e),!1}if(!(i=r[t]))return!1;var h="function"==typeof i;switch(n=arguments.length){case 1:emitNone(i,h,this);break;case 2:emitOne(i,h,this,arguments[1]);break;case 3:emitTwo(i,h,this,arguments[1],arguments[2]);break;case 4:emitThree(i,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(n-1),o=1;o<n;o++)s[o-1]=arguments[o];emitMany(i,h,this,s)}return!0},EventEmitter.prototype.addListener=function(t,e){return _addListener(this,t,e,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(t,e){return _addListener(this,t,e,!0)},EventEmitter.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,_onceWrap(this,t,e)),this},EventEmitter.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,_onceWrap(this,t,e)),this},EventEmitter.prototype.removeListener=function(t,e){var i,n,s,o,r;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(i=n[t]))return this;if(i===e||i.listener&&i.listener===e)0==--this._eventsCount?this._events=new EventHandlers:(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(s=-1,o=i.length;o-- >0;)if(i[o]===e||i[o].listener&&i[o].listener===e){r=i[o].listener,s=o;break}if(s<0)return this;if(1===i.length){if(i[0]=void 0,0==--this._eventsCount)return this._events=new EventHandlers,this;delete n[t]}else spliceOne(i,s);n.removeListener&&this.emit("removeListener",t,r||e)}return this},EventEmitter.prototype.removeAllListeners=function(t){var e,i;if(!(i=this._events))return this;if(!i.removeListener)return 0===arguments.length?(this._events=new EventHandlers,this._eventsCount=0):i[t]&&(0==--this._eventsCount?this._events=new EventHandlers:delete i[t]),this;if(0===arguments.length){for(var n,s=Object.keys(i),o=0;o<s.length;++o)"removeListener"!==(n=s[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new EventHandlers,this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},EventEmitter.prototype.listeners=function(t){var e,i=this._events;return i&&(e=i[t])?"function"==typeof e?[e.listener||e]:unwrapListeners(e):[]},EventEmitter.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):listenerCount.call(t,e)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var events=Object.freeze({__proto__:null,default:EventEmitter,EventEmitter}),require$$0=getCjsExportFromNamespace(events),BuiltInEmitter=require$$0.EventEmitter,socketioWildcard=function(t){var e=(t||BuiltInEmitter).prototype.emit;function i(t){var i=t.data||[];return null!=t.id&&i.push(this.ack(t.id)),e.call(this,"*",t),e.apply(this,i)}return function(t,e){return t.onevent!==i&&(t.onevent=i),e?e():null}};const i$1={JOIN_ROOM:"join-room",PING_ROOM:"ping-room",LEAVE_ROOM:"leave-room"};class o{constructor(t,e){this.userData=t,this.socketUrl=e,this.users={},this.userStreams={},this.callbacks={},this.envIsBrowser="undefined"!=typeof window,this.debugCollab=browser("zea-collab")}stopCamera(t=!0){this.stream&&(this.stream.getVideoTracks()[0].enabled=!1,t&&this.pub(o.actions.USER_VIDEO_STOPPED,{}))}startCamera(t=!0){this.stream&&(this.stream.getVideoTracks()[0].enabled=!0,t&&this.pub(o.actions.USER_VIDEO_STARTED,{}))}muteAudio(t=!0){this.stream&&(this.stream.getAudioTracks()[0].enabled=!1,t&&this.pub(o.actions.USER_VIDEO_STOPPED,{}))}unmuteAudio(t=!0){this.stream&&(this.stream.getAudioTracks()[0].enabled=!0,t&&this.pub(o.actions.USER_AUDIO_STARTED,{}))}getVideoStream(t){return this.userStreams[t]}setVideoStream(t,e){if(this.userStreams[e])return;const i=document.createElement("video");i.srcObject=t,this.userStreams[e]=i,i.onloadedmetadata=()=>{i.play()},document.body.appendChild(i)}static concatFullRoomId(t,e,i){return t+(e||"_ALL_FILES_")+(i||"_ALL_ROOMS_")}isJoiningTheSameRoom(t,e,i){return this.fullRoomId===o.concatFullRoomId(t,e,i)}joinRoom(t,e,i){this.projectId=t,this.fileId=e,this.roomId=i,this.fullRoomId=o.concatFullRoomId(this.projectId,this.fileId,this.roomId),this.leaveRoom(),this.socket=lib$1(this.socketUrl,{"sync disconnect on unload":!0,query:`userId=${this.userData.id}&roomId=${this.fullRoomId}`}),socketioWildcard(lib$1.Manager)(this.socket),this.socket.on("*",t=>{const[e,i]=t.data;e in i$1||this._emit(e,i.payload,i.userId)}),this.envIsBrowser&&window.addEventListener("beforeunload",()=>{this.leaveRoom()}),this.pub(i$1.JOIN_ROOM),this.socket.on(i$1.JOIN_ROOM,t=>{this.debugCollab(i$1.JOIN_ROOM+":\n%O",t),this._addUserIfNew(t.userData),this.pub(i$1.PING_ROOM)}),this.socket.on(i$1.LEAVE_ROOM,t=>{this.debugCollab(i$1.LEAVE_ROOM+":\n%O",t);const e=t.userData,i=e.id;if(i in this.users)return delete this.users[i],void this._emit(o.actions.USER_LEFT,e);this.debugCollab("Outgoing user was not found in room.")}),this.socket.on(i$1.PING_ROOM,t=>{this.debugCollab(i$1.PING_ROOM+":\n%O",t),this._addUserIfNew(t.userData)})}_prepareMediaStream(){return this.__streamPromise||(this.__streamPromise=new window.Promise((t,e)=>{this.stream?t():navigator.mediaDevices.getUserMedia({audio:!0,video:{width:400,height:300}}).then(e=>{this.stream=e,this.stopCamera(!1),this.muteAudio(!1),t()}).catch(t=>{e(t)})})),this.__streamPromise}leaveRoom(){this._emit(o.actions.LEFT_ROOM),this.users={},this.socket&&this.pub(i$1.LEAVE_ROOM,void 0,()=>{this.socket.close()})}_addUserIfNew(t){t.id in this.users||(this.users[t.id]=t,this._emit(o.actions.USER_JOINED,t))}createRoom(){return this.roomId=shortid.generate(),this.joinRoom(this.projectId,this.fileId,this.roomId),this.envIsBrowser&&window.history.pushState(null,null,`?project-id=${this.projectId}&file-id=${this.fileId}&room-id=${this.roomId}`),this.roomId}getUsers(){return this.users}getUser(t){return this.users[t]}pub(t,e,i){if(!t)throw new Error("Missing messageType");this.socket.emit(t,{userData:this.userData,userId:this.userData.id,payload:e},i)}_emit(t,e,i){const n=this.callbacks[t];n&&n.forEach(t=>t(e,i))}sub(t,e){if(!t)throw new Error("Missing messageType");if(!e)throw new Error("Missing callback");return this.callbacks[t]=this.callbacks[t]||[],this.callbacks[t].push(e),()=>{this.callbacks[t].splice(this.callbacks[t].indexOf(e),1)}}}o.actions={USER_JOINED:"user-joined",USER_VIDEO_STARTED:"user-video-started",USER_VIDEO_STOPPED:"user-video-stopped",USER_AUDIO_STARTED:"user-audio-started",USER_AUDIO_STOPPED:"user-audio-stopped",USER_LEFT:"user-left",LEFT_ROOM:"left-room",TEXT_MESSAGE:"text-message",POSE_CHANGED:"pose-message",COMMAND_ADDED:"command-added",COMMAND_UPDATED:"command-updated",FILE_WITH_PROGRESS:"file-with-progress"};class r{static setSocketURL(t){this.socketUrl=t}static getInstance(t,e,i,n){if(!this.session){if(!this.socketUrl)throw new Error("Missing #socketUrl. Call #setSocketURL first.");this.session=new o(t,this.socketUrl)}return this.session.isJoiningTheSameRoom(e,i,n)||this.session.joinRoom(e,i,n),this.session}static getCurrentSession(){return this.session}}function isNothing(t){return null==t}function isObject(t){return"object"==typeof t&&null!==t}function toArray$1(t){return Array.isArray(t)?t:isNothing(t)?[]:[t]}function extend(t,e){var i,n,s,o;if(e)for(i=0,n=(o=Object.keys(e)).length;i<n;i+=1)t[s=o[i]]=e[s];return t}function repeat(t,e){var i,n="";for(i=0;i<e;i+=1)n+=t;return n}function isNegativeZero(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t}var isNothing_1=isNothing,isObject_1=isObject,toArray_1$1=toArray$1,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend,common$1={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1$1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function YAMLException(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}YAMLException.prototype=Object.create(Error.prototype),YAMLException.prototype.constructor=YAMLException,YAMLException.prototype.toString=function(t){var e=this.name+": ";return e+=this.reason||"(unknown reason)",!t&&this.mark&&(e+=" "+this.mark.toString()),e};var exception=YAMLException;function Mark(t,e,i,n,s){this.name=t,this.buffer=e,this.position=i,this.line=n,this.column=s}Mark.prototype.getSnippet=function(t,e){var i,n,s,o,r;if(!this.buffer)return null;for(t=t||4,e=e||75,i="",n=this.position;n>0&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(n-1));)if(this.position-(n-=1)>e/2-1){i=" ... ",n+=5;break}for(s="",o=this.position;o<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o));)if((o+=1)-this.position>e/2-1){s=" ... ",o-=5;break}return r=this.buffer.slice(n,o),common$1.repeat(" ",t)+i+r+s+"\n"+common$1.repeat(" ",t+this.position-n+i.length)+"^"},Mark.prototype.toString=function(t){var e,i="";return this.name&&(i+='in "'+this.name+'" '),i+="at line "+(this.line+1)+", column "+(this.column+1),t||(e=this.getSnippet())&&(i+=":\n"+e),i};var mark=Mark,TYPE_CONSTRUCTOR_OPTIONS=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(t){var e={};return null!==t&&Object.keys(t).forEach((function(i){t[i].forEach((function(t){e[String(t)]=i}))})),e}function Type(t,e){if(e=e||{},Object.keys(e).forEach((function(e){if(-1===TYPE_CONSTRUCTOR_OPTIONS.indexOf(e))throw new exception('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')})),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=compileStyleAliases(e.styleAliases||null),-1===YAML_NODE_KINDS.indexOf(this.kind))throw new exception('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}var type=Type;function compileList(t,e,i){var n=[];return t.include.forEach((function(t){i=compileList(t,e,i)})),t[e].forEach((function(t){i.forEach((function(e,i){e.tag===t.tag&&e.kind===t.kind&&n.push(i)})),i.push(t)})),i.filter((function(t,e){return-1===n.indexOf(e)}))}function compileMap(){var t,e,i={scalar:{},sequence:{},mapping:{},fallback:{}};function n(t){i[t.kind][t.tag]=i.fallback[t.tag]=t}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(n);return i}function Schema(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach((function(t){if(t.loadKind&&"scalar"!==t.loadKind)throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=compileList(this,"implicit",[]),this.compiledExplicit=compileList(this,"explicit",[]),this.compiledTypeMap=compileMap(this.compiledImplicit,this.compiledExplicit)}Schema.DEFAULT=null,Schema.create=function(){var t,e;switch(arguments.length){case 1:t=Schema.DEFAULT,e=arguments[0];break;case 2:t=arguments[0],e=arguments[1];break;default:throw new exception("Wrong number of arguments for Schema.create function")}if(t=common$1.toArray(t),e=common$1.toArray(e),!t.every((function(t){return t instanceof Schema})))throw new exception("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!e.every((function(t){return t instanceof type})))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Schema({include:t,explicit:e})};var schema=Schema,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),map$1=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),failsafe=new schema({explicit:[str,seq,map$1]});function resolveYamlNull(t){if(null===t)return!0;var e=t.length;return 1===e&&"~"===t||4===e&&("null"===t||"Null"===t||"NULL"===t)}function constructYamlNull(){return null}function isNull(t){return null===t}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"});function resolveYamlBoolean(t){if(null===t)return!1;var e=t.length;return 4===e&&("true"===t||"True"===t||"TRUE"===t)||5===e&&("false"===t||"False"===t||"FALSE"===t)}function constructYamlBoolean(t){return"true"===t||"True"===t||"TRUE"===t}function isBoolean(t){return"[object Boolean]"===Object.prototype.toString.call(t)}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function isOctCode(t){return 48<=t&&t<=55}function isDecCode(t){return 48<=t&&t<=57}function resolveYamlInteger(t){if(null===t)return!1;var e,i=t.length,n=0,s=!1;if(!i)return!1;if("-"!==(e=t[n])&&"+"!==e||(e=t[++n]),"0"===e){if(n+1===i)return!0;if("b"===(e=t[++n])){for(n++;n<i;n++)if("_"!==(e=t[n])){if("0"!==e&&"1"!==e)return!1;s=!0}return s&&"_"!==e}if("x"===e){for(n++;n<i;n++)if("_"!==(e=t[n])){if(!isHexCode(t.charCodeAt(n)))return!1;s=!0}return s&&"_"!==e}for(;n<i;n++)if("_"!==(e=t[n])){if(!isOctCode(t.charCodeAt(n)))return!1;s=!0}return s&&"_"!==e}if("_"===e)return!1;for(;n<i;n++)if("_"!==(e=t[n])){if(":"===e)break;if(!isDecCode(t.charCodeAt(n)))return!1;s=!0}return!(!s||"_"===e)&&(":"!==e||/^(:[0-5]?[0-9])+$/.test(t.slice(n)))}function constructYamlInteger(t){var e,i,n=t,s=1,o=[];return-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(e=n[0])&&"+"!==e||("-"===e&&(s=-1),e=(n=n.slice(1))[0]),"0"===n?0:"0"===e?"b"===n[1]?s*parseInt(n.slice(2),2):"x"===n[1]?s*parseInt(n,16):s*parseInt(n,8):-1!==n.indexOf(":")?(n.split(":").forEach((function(t){o.unshift(parseInt(t,10))})),n=0,i=1,o.forEach((function(t){n+=t*i,i*=60})),s*n):s*parseInt(n,10)}function isInteger(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!common$1.isNegativeZero(t)}var int_1=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0"+t.toString(8):"-0"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(t){return null!==t&&!(!YAML_FLOAT_PATTERN.test(t)||"_"===t[t.length-1])}function constructYamlFloat(t){var e,i,n,s;return i="-"===(e=t.replace(/_/g,"").toLowerCase())[0]?-1:1,s=[],"+-".indexOf(e[0])>=0&&(e=e.slice(1)),".inf"===e?1===i?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===e?NaN:e.indexOf(":")>=0?(e.split(":").forEach((function(t){s.unshift(parseFloat(t,10))})),e=0,n=1,s.forEach((function(t){e+=t*n,n*=60})),i*e):i*parseFloat(e,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(t,e){var i;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common$1.isNegativeZero(t))return"-0.0";return i=t.toString(10),SCIENTIFIC_WITHOUT_DOT.test(i)?i.replace("e",".e"):i}function isFloat(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||common$1.isNegativeZero(t))}var float_1=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=new schema({include:[failsafe],implicit:[_null,bool,int_1,float_1]}),core=new schema({include:[json]}),YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(t){return null!==t&&(null!==YAML_DATE_REGEXP.exec(t)||null!==YAML_TIMESTAMP_REGEXP.exec(t))}function constructYamlTimestamp(t){var e,i,n,s,o,r,a,l,c=0,h=null;if(null===(e=YAML_DATE_REGEXP.exec(t))&&(e=YAML_TIMESTAMP_REGEXP.exec(t)),null===e)throw new Error("Date resolve error");if(i=+e[1],n=+e[2]-1,s=+e[3],!e[4])return new Date(Date.UTC(i,n,s));if(o=+e[4],r=+e[5],a=+e[6],e[7]){for(c=e[7].slice(0,3);c.length<3;)c+="0";c=+c}return e[9]&&(h=6e4*(60*+e[10]+ +(e[11]||0)),"-"===e[9]&&(h=-h)),l=new Date(Date.UTC(i,n,s,o,r,a,c)),h&&l.setTime(l.getTime()-h),l}function representYamlTimestamp(t){return t.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(t){return"<<"===t||null===t}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),NodeBuffer;try{var _require=commonjsRequire;NodeBuffer=_require("buffer").Buffer}catch(__){}var BASE64_MAP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function resolveYamlBinary(t){if(null===t)return!1;var e,i,n=0,s=t.length,o=BASE64_MAP;for(i=0;i<s;i++)if(!((e=o.indexOf(t.charAt(i)))>64)){if(e<0)return!1;n+=6}return n%8==0}function constructYamlBinary(t){var e,i,n=t.replace(/[\r\n=]/g,""),s=n.length,o=BASE64_MAP,r=0,a=[];for(e=0;e<s;e++)e%4==0&&e&&(a.push(r>>16&255),a.push(r>>8&255),a.push(255&r)),r=r<<6|o.indexOf(n.charAt(e));return 0==(i=s%4*6)?(a.push(r>>16&255),a.push(r>>8&255),a.push(255&r)):18===i?(a.push(r>>10&255),a.push(r>>2&255)):12===i&&a.push(r>>4&255),NodeBuffer?NodeBuffer.from?NodeBuffer.from(a):new NodeBuffer(a):a}function representYamlBinary(t){var e,i,n="",s=0,o=t.length,r=BASE64_MAP;for(e=0;e<o;e++)e%3==0&&e&&(n+=r[s>>18&63],n+=r[s>>12&63],n+=r[s>>6&63],n+=r[63&s]),s=(s<<8)+t[e];return 0==(i=o%3)?(n+=r[s>>18&63],n+=r[s>>12&63],n+=r[s>>6&63],n+=r[63&s]):2===i?(n+=r[s>>10&63],n+=r[s>>4&63],n+=r[s<<2&63],n+=r[64]):1===i&&(n+=r[s>>2&63],n+=r[s<<4&63],n+=r[64],n+=r[64]),n}function isBinary(t){return NodeBuffer&&NodeBuffer.isBuffer(t)}var binary$1=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty=Object.prototype.hasOwnProperty,_toString=Object.prototype.toString;function resolveYamlOmap(t){if(null===t)return!0;var e,i,n,s,o,r=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(o=!1,"[object Object]"!==_toString.call(n=a[e]))return!1;for(s in n)if(_hasOwnProperty.call(n,s)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==r.indexOf(s))return!1;r.push(s)}return!0}function constructYamlOmap(t){return null!==t?t:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(t){if(null===t)return!0;var e,i,n,s,o,r=t;for(o=new Array(r.length),e=0,i=r.length;e<i;e+=1){if("[object Object]"!==_toString$1.call(n=r[e]))return!1;if(1!==(s=Object.keys(n)).length)return!1;o[e]=[s[0],n[s[0]]]}return!0}function constructYamlPairs(t){if(null===t)return[];var e,i,n,s,o,r=t;for(o=new Array(r.length),e=0,i=r.length;e<i;e+=1)n=r[e],s=Object.keys(n),o[e]=[s[0],n[s[0]]];return o}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$1=Object.prototype.hasOwnProperty;function resolveYamlSet(t){if(null===t)return!0;var e,i=t;for(e in i)if(_hasOwnProperty$1.call(i,e)&&null!==i[e])return!1;return!0}function constructYamlSet(t){return null!==t?t:{}}var set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),default_safe=new schema({include:[core],implicit:[timestamp,merge],explicit:[binary$1,omap,pairs,set]});function resolveJavascriptUndefined(){return!0}function constructJavascriptUndefined(){}function representJavascriptUndefined(){return""}function isUndefined(t){return void 0===t}var _undefined=new type("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:resolveJavascriptUndefined,construct:constructJavascriptUndefined,predicate:isUndefined,represent:representJavascriptUndefined});function resolveJavascriptRegExp(t){if(null===t)return!1;if(0===t.length)return!1;var e=t,i=/\/([gim]*)$/.exec(t),n="";if("/"===e[0]){if(i&&(n=i[1]),n.length>3)return!1;if("/"!==e[e.length-n.length-1])return!1}return!0}function constructJavascriptRegExp(t){var e=t,i=/\/([gim]*)$/.exec(t),n="";return"/"===e[0]&&(i&&(n=i[1]),e=e.slice(1,e.length-n.length-1)),new RegExp(e,n)}function representJavascriptRegExp(t){var e="/"+t.source+"/";return t.global&&(e+="g"),t.multiline&&(e+="m"),t.ignoreCase&&(e+="i"),e}function isRegExp(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var regexp=new type("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:resolveJavascriptRegExp,construct:constructJavascriptRegExp,predicate:isRegExp,represent:representJavascriptRegExp}),esprima;try{var _require$1=commonjsRequire;esprima=_require$1("esprima")}catch(_){"undefined"!=typeof window&&(esprima=window.esprima)}function resolveJavascriptFunction(t){if(null===t)return!1;try{var e=esprima.parse("("+t+")",{range:!0});return"Program"===e.type&&1===e.body.length&&"ExpressionStatement"===e.body[0].type&&("ArrowFunctionExpression"===e.body[0].expression.type||"FunctionExpression"===e.body[0].expression.type)}catch(i){return!1}}function constructJavascriptFunction(t){var e,i="("+t+")",n=esprima.parse(i,{range:!0}),s=[];if("Program"!==n.type||1!==n.body.length||"ExpressionStatement"!==n.body[0].type||"ArrowFunctionExpression"!==n.body[0].expression.type&&"FunctionExpression"!==n.body[0].expression.type)throw new Error("Failed to resolve function");return n.body[0].expression.params.forEach((function(t){s.push(t.name)})),e=n.body[0].expression.body.range,new Function(s,"BlockStatement"===n.body[0].expression.body.type?i.slice(e[0]+1,e[1]-1):"return "+i.slice(e[0],e[1]))}function representJavascriptFunction(t){return t.toString()}function isFunction(t){return"[object Function]"===Object.prototype.toString.call(t)}var _function=new type("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:resolveJavascriptFunction,construct:constructJavascriptFunction,predicate:isFunction,represent:representJavascriptFunction}),default_full=schema.DEFAULT=new schema({include:[default_safe],explicit:[_undefined,regexp,_function]}),_hasOwnProperty$2=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(t){return Object.prototype.toString.call(t)}function is_EOL(t){return 10===t||13===t}function is_WHITE_SPACE(t){return 9===t||32===t}function is_WS_OR_EOL(t){return 9===t||32===t||10===t||13===t}function is_FLOW_INDICATOR(t){return 44===t||91===t||93===t||123===t||125===t}function fromHexCode(t){var e;return 48<=t&&t<=57?t-48:97<=(e=32|t)&&e<=102?e-97+10:-1}function escapedHexLen(t){return 120===t?2:117===t?4:85===t?8:0}function fromDecimalCode(t){return 48<=t&&t<=57?t-48:-1}function simpleEscapeSequence(t){return 48===t?"\0":97===t?"":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"":95===t?"":76===t?"\u2028":80===t?"\u2029":""}function charFromCodepoint(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),i$2=0;i$2<256;i$2++)simpleEscapeCheck[i$2]=simpleEscapeSequence(i$2)?1:0,simpleEscapeMap[i$2]=simpleEscapeSequence(i$2);function State(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||default_full,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function generateError(t,e){return new exception(e,new mark(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function throwError(t,e){throw generateError(t,e)}function throwWarning(t,e){t.onWarning&&t.onWarning.call(null,generateError(t,e))}var directiveHandlers={YAML:function(t,e,i){var n,s,o;null!==t.version&&throwError(t,"duplication of %YAML directive"),1!==i.length&&throwError(t,"YAML directive accepts exactly one argument"),null===(n=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&throwError(t,"ill-formed argument of the YAML directive"),s=parseInt(n[1],10),o=parseInt(n[2],10),1!==s&&throwError(t,"unacceptable YAML version of the document"),t.version=i[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&throwWarning(t,"unsupported YAML version of the document")},TAG:function(t,e,i){var n,s;2!==i.length&&throwError(t,"TAG directive accepts exactly two arguments"),s=i[1],PATTERN_TAG_HANDLE.test(n=i[0])||throwError(t,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$2.call(t.tagMap,n)&&throwError(t,'there is a previously declared suffix for "'+n+'" tag handle'),PATTERN_TAG_URI.test(s)||throwError(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[n]=s}};function captureSegment(t,e,i,n){var s,o,r,a;if(e<i){if(a=t.input.slice(e,i),n)for(s=0,o=a.length;s<o;s+=1)9===(r=a.charCodeAt(s))||32<=r&&r<=1114111||throwError(t,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(a)&&throwError(t,"the stream contains non-printable characters");t.result+=a}}function mergeMappings(t,e,i,n){var s,o,r,a;for(common$1.isObject(i)||throwError(t,"cannot merge mappings; the provided source object is unacceptable"),r=0,a=(s=Object.keys(i)).length;r<a;r+=1)_hasOwnProperty$2.call(e,o=s[r])||(e[o]=i[o],n[o]=!0)}function storeMappingPair(t,e,i,n,s,o,r,a){var l,c;if(Array.isArray(s))for(l=0,c=(s=Array.prototype.slice.call(s)).length;l<c;l+=1)Array.isArray(s[l])&&throwError(t,"nested arrays are not supported inside keys"),"object"==typeof s&&"[object Object]"===_class(s[l])&&(s[l]="[object Object]");if("object"==typeof s&&"[object Object]"===_class(s)&&(s="[object Object]"),s=String(s),null===e&&(e={}),"tag:yaml.org,2002:merge"===n)if(Array.isArray(o))for(l=0,c=o.length;l<c;l+=1)mergeMappings(t,e,o[l],i);else mergeMappings(t,e,o,i);else t.json||_hasOwnProperty$2.call(i,s)||!_hasOwnProperty$2.call(e,s)||(t.line=r||t.line,t.position=a||t.position,throwError(t,"duplicated mapping key")),e[s]=o,delete i[s];return e}function readLineBreak(t){var e;10===(e=t.input.charCodeAt(t.position))?t.position++:13===e?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):throwError(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function skipSeparationSpace(t,e,i){for(var n=0,s=t.input.charCodeAt(t.position);0!==s;){for(;is_WHITE_SPACE(s);)s=t.input.charCodeAt(++t.position);if(e&&35===s)do{s=t.input.charCodeAt(++t.position)}while(10!==s&&13!==s&&0!==s);if(!is_EOL(s))break;for(readLineBreak(t),s=t.input.charCodeAt(t.position),n++,t.lineIndent=0;32===s;)t.lineIndent++,s=t.input.charCodeAt(++t.position)}return-1!==i&&0!==n&&t.lineIndent<i&&throwWarning(t,"deficient indentation"),n}function testDocumentSeparator(t){var e,i=t.position;return!(45!==(e=t.input.charCodeAt(i))&&46!==e||e!==t.input.charCodeAt(i+1)||e!==t.input.charCodeAt(i+2)||0!==(e=t.input.charCodeAt(i+=3))&&!is_WS_OR_EOL(e))}function writeFoldedLines(t,e){1===e?t.result+=" ":e>1&&(t.result+=common$1.repeat("\n",e-1))}function readPlainScalar(t,e,i){var n,s,o,r,a,l,c,h,d=t.kind,u=t.result;if(is_WS_OR_EOL(h=t.input.charCodeAt(t.position))||is_FLOW_INDICATOR(h)||35===h||38===h||42===h||33===h||124===h||62===h||39===h||34===h||37===h||64===h||96===h)return!1;if((63===h||45===h)&&(is_WS_OR_EOL(n=t.input.charCodeAt(t.position+1))||i&&is_FLOW_INDICATOR(n)))return!1;for(t.kind="scalar",t.result="",s=o=t.position,r=!1;0!==h;){if(58===h){if(is_WS_OR_EOL(n=t.input.charCodeAt(t.position+1))||i&&is_FLOW_INDICATOR(n))break}else if(35===h){if(is_WS_OR_EOL(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&testDocumentSeparator(t)||i&&is_FLOW_INDICATOR(h))break;if(is_EOL(h)){if(a=t.line,l=t.lineStart,c=t.lineIndent,skipSeparationSpace(t,!1,-1),t.lineIndent>=e){r=!0,h=t.input.charCodeAt(t.position);continue}t.position=o,t.line=a,t.lineStart=l,t.lineIndent=c;break}}r&&(captureSegment(t,s,o,!1),writeFoldedLines(t,t.line-a),s=o=t.position,r=!1),is_WHITE_SPACE(h)||(o=t.position+1),h=t.input.charCodeAt(++t.position)}return captureSegment(t,s,o,!1),!!t.result||(t.kind=d,t.result=u,!1)}function readSingleQuotedScalar(t,e){var i,n,s;if(39!==(i=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,n=s=t.position;0!==(i=t.input.charCodeAt(t.position));)if(39===i){if(captureSegment(t,n,t.position,!0),39!==(i=t.input.charCodeAt(++t.position)))return!0;n=t.position,t.position++,s=t.position}else is_EOL(i)?(captureSegment(t,n,s,!0),writeFoldedLines(t,skipSeparationSpace(t,!1,e)),n=s=t.position):t.position===t.lineStart&&testDocumentSeparator(t)?throwError(t,"unexpected end of the document within a single quoted scalar"):(t.position++,s=t.position);throwError(t,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(t,e){var i,n,s,o,r,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=n=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return captureSegment(t,i,t.position,!0),t.position++,!0;if(92===a){if(captureSegment(t,i,t.position,!0),is_EOL(a=t.input.charCodeAt(++t.position)))skipSeparationSpace(t,!1,e);else if(a<256&&simpleEscapeCheck[a])t.result+=simpleEscapeMap[a],t.position++;else if((r=escapedHexLen(a))>0){for(s=r,o=0;s>0;s--)(r=fromHexCode(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+r:throwError(t,"expected hexadecimal character");t.result+=charFromCodepoint(o),t.position++}else throwError(t,"unknown escape sequence");i=n=t.position}else is_EOL(a)?(captureSegment(t,i,n,!0),writeFoldedLines(t,skipSeparationSpace(t,!1,e)),i=n=t.position):t.position===t.lineStart&&testDocumentSeparator(t)?throwError(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}throwError(t,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(t,e){var i,n,s,o,r,a,l,c,h,d,u=!0,m=t.tag,p=t.anchor,b={};if(91===(d=t.input.charCodeAt(t.position)))s=93,a=!1,n=[];else{if(123!==d)return!1;s=125,a=!0,n={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=n),d=t.input.charCodeAt(++t.position);0!==d;){if(skipSeparationSpace(t,!0,e),(d=t.input.charCodeAt(t.position))===s)return t.position++,t.tag=m,t.anchor=p,t.kind=a?"mapping":"sequence",t.result=n,!0;u||throwError(t,"missed comma between flow collection entries"),h=null,o=r=!1,63===d&&is_WS_OR_EOL(t.input.charCodeAt(t.position+1))&&(o=r=!0,t.position++,skipSeparationSpace(t,!0,e)),i=t.line,composeNode(t,e,CONTEXT_FLOW_IN,!1,!0),c=t.tag,l=t.result,skipSeparationSpace(t,!0,e),d=t.input.charCodeAt(t.position),!r&&t.line!==i||58!==d||(o=!0,d=t.input.charCodeAt(++t.position),skipSeparationSpace(t,!0,e),composeNode(t,e,CONTEXT_FLOW_IN,!1,!0),h=t.result),a?storeMappingPair(t,n,b,c,l,h):n.push(o?storeMappingPair(t,null,b,c,l,h):l),skipSeparationSpace(t,!0,e),44===(d=t.input.charCodeAt(t.position))?(u=!0,d=t.input.charCodeAt(++t.position)):u=!1}throwError(t,"unexpected end of the stream within a flow collection")}function readBlockScalar(t,e){var i,n,s,o,r=CHOMPING_CLIP,a=!1,l=!1,c=e,h=0,d=!1;if(124===(o=t.input.charCodeAt(t.position)))n=!1;else{if(62!==o)return!1;n=!0}for(t.kind="scalar",t.result="";0!==o;)if(43===(o=t.input.charCodeAt(++t.position))||45===o)CHOMPING_CLIP===r?r=43===o?CHOMPING_KEEP:CHOMPING_STRIP:throwError(t,"repeat of a chomping mode identifier");else{if(!((s=fromDecimalCode(o))>=0))break;0===s?throwError(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):l?throwError(t,"repeat of an indentation width identifier"):(c=e+s-1,l=!0)}if(is_WHITE_SPACE(o)){do{o=t.input.charCodeAt(++t.position)}while(is_WHITE_SPACE(o));if(35===o)do{o=t.input.charCodeAt(++t.position)}while(!is_EOL(o)&&0!==o)}for(;0!==o;){for(readLineBreak(t),t.lineIndent=0,o=t.input.charCodeAt(t.position);(!l||t.lineIndent<c)&&32===o;)t.lineIndent++,o=t.input.charCodeAt(++t.position);if(!l&&t.lineIndent>c&&(c=t.lineIndent),is_EOL(o))h++;else{if(t.lineIndent<c){r===CHOMPING_KEEP?t.result+=common$1.repeat("\n",a?1+h:h):r===CHOMPING_CLIP&&a&&(t.result+="\n");break}for(n?is_WHITE_SPACE(o)?(d=!0,t.result+=common$1.repeat("\n",a?1+h:h)):d?(d=!1,t.result+=common$1.repeat("\n",h+1)):0===h?a&&(t.result+=" "):t.result+=common$1.repeat("\n",h):t.result+=common$1.repeat("\n",a?1+h:h),a=!0,l=!0,h=0,i=t.position;!is_EOL(o)&&0!==o;)o=t.input.charCodeAt(++t.position);captureSegment(t,i,t.position,!1)}}return!0}function readBlockSequence(t,e){var i,n,s=t.tag,o=t.anchor,r=[],a=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=r),n=t.input.charCodeAt(t.position);0!==n&&45===n&&is_WS_OR_EOL(t.input.charCodeAt(t.position+1));)if(a=!0,t.position++,skipSeparationSpace(t,!0,-1)&&t.lineIndent<=e)r.push(null),n=t.input.charCodeAt(t.position);else if(i=t.line,composeNode(t,e,CONTEXT_BLOCK_IN,!1,!0),r.push(t.result),skipSeparationSpace(t,!0,-1),n=t.input.charCodeAt(t.position),(t.line===i||t.lineIndent>e)&&0!==n)throwError(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break;return!!a&&(t.tag=s,t.anchor=o,t.kind="sequence",t.result=r,!0)}function readBlockMapping(t,e,i){var n,s,o,r,a,l=t.tag,c=t.anchor,h={},d={},u=null,m=null,p=null,b=!1,f=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=h),a=t.input.charCodeAt(t.position);0!==a;){if(n=t.input.charCodeAt(t.position+1),o=t.line,r=t.position,63!==a&&58!==a||!is_WS_OR_EOL(n)){if(!composeNode(t,i,CONTEXT_FLOW_OUT,!1,!0))break;if(t.line===o){for(a=t.input.charCodeAt(t.position);is_WHITE_SPACE(a);)a=t.input.charCodeAt(++t.position);if(58===a)is_WS_OR_EOL(a=t.input.charCodeAt(++t.position))||throwError(t,"a whitespace character is expected after the key-value separator within a block mapping"),b&&(storeMappingPair(t,h,d,u,m,null),u=m=p=null),f=!0,b=!1,s=!1,u=t.tag,m=t.result;else{if(!f)return t.tag=l,t.anchor=c,!0;throwError(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!f)return t.tag=l,t.anchor=c,!0;throwError(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===a?(b&&(storeMappingPair(t,h,d,u,m,null),u=m=p=null),f=!0,b=!0,s=!0):b?(b=!1,s=!0):throwError(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,a=n;if((t.line===o||t.lineIndent>e)&&(composeNode(t,e,CONTEXT_BLOCK_OUT,!0,s)&&(b?m=t.result:p=t.result),b||(storeMappingPair(t,h,d,u,m,p,o,r),u=m=p=null),skipSeparationSpace(t,!0,-1),a=t.input.charCodeAt(t.position)),t.lineIndent>e&&0!==a)throwError(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return b&&storeMappingPair(t,h,d,u,m,null),f&&(t.tag=l,t.anchor=c,t.kind="mapping",t.result=h),f}function readTagProperty(t){var e,i,n,s,o=!1,r=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&throwError(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(o=!0,s=t.input.charCodeAt(++t.position)):33===s?(r=!0,i="!!",s=t.input.charCodeAt(++t.position)):i="!",e=t.position,o){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(n=t.input.slice(e,t.position),s=t.input.charCodeAt(++t.position)):throwError(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!is_WS_OR_EOL(s);)33===s&&(r?throwError(t,"tag suffix cannot contain exclamation marks"):(i=t.input.slice(e-1,t.position+1),PATTERN_TAG_HANDLE.test(i)||throwError(t,"named tag handle cannot contain such characters"),r=!0,e=t.position+1)),s=t.input.charCodeAt(++t.position);n=t.input.slice(e,t.position),PATTERN_FLOW_INDICATORS.test(n)&&throwError(t,"tag suffix cannot contain flow indicator characters")}return n&&!PATTERN_TAG_URI.test(n)&&throwError(t,"tag name cannot contain such characters: "+n),o?t.tag=n:_hasOwnProperty$2.call(t.tagMap,i)?t.tag=t.tagMap[i]+n:"!"===i?t.tag="!"+n:"!!"===i?t.tag="tag:yaml.org,2002:"+n:throwError(t,'undeclared tag handle "'+i+'"'),!0}function readAnchorProperty(t){var e,i;if(38!==(i=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&throwError(t,"duplication of an anchor property"),i=t.input.charCodeAt(++t.position),e=t.position;0!==i&&!is_WS_OR_EOL(i)&&!is_FLOW_INDICATOR(i);)i=t.input.charCodeAt(++t.position);return t.position===e&&throwError(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function readAlias(t){var e,i,n;if(42!==(n=t.input.charCodeAt(t.position)))return!1;for(n=t.input.charCodeAt(++t.position),e=t.position;0!==n&&!is_WS_OR_EOL(n)&&!is_FLOW_INDICATOR(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&throwError(t,"name of an alias node must contain at least one character"),i=t.input.slice(e,t.position),t.anchorMap.hasOwnProperty(i)||throwError(t,'unidentified alias "'+i+'"'),t.result=t.anchorMap[i],skipSeparationSpace(t,!0,-1),!0}function composeNode(t,e,i,n,s){var o,r,a,l,c,h,d,u,m=1,p=!1,b=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=r=a=CONTEXT_BLOCK_OUT===i||CONTEXT_BLOCK_IN===i,n&&skipSeparationSpace(t,!0,-1)&&(p=!0,t.lineIndent>e?m=1:t.lineIndent===e?m=0:t.lineIndent<e&&(m=-1)),1===m)for(;readTagProperty(t)||readAnchorProperty(t);)skipSeparationSpace(t,!0,-1)?(p=!0,a=o,t.lineIndent>e?m=1:t.lineIndent===e?m=0:t.lineIndent<e&&(m=-1)):a=!1;if(a&&(a=p||s),1!==m&&CONTEXT_BLOCK_OUT!==i||(d=CONTEXT_FLOW_IN===i||CONTEXT_FLOW_OUT===i?e:e+1,u=t.position-t.lineStart,1===m?a&&(readBlockSequence(t,u)||readBlockMapping(t,u,d))||readFlowCollection(t,d)?b=!0:(r&&readBlockScalar(t,d)||readSingleQuotedScalar(t,d)||readDoubleQuotedScalar(t,d)?b=!0:readAlias(t)?(b=!0,null===t.tag&&null===t.anchor||throwError(t,"alias node should not have any properties")):readPlainScalar(t,d,CONTEXT_FLOW_IN===i)&&(b=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===m&&(b=a&&readBlockSequence(t,u))),null!==t.tag&&"!"!==t.tag)if("?"===t.tag){for(l=0,c=t.implicitTypes.length;l<c;l+=1)if((h=t.implicitTypes[l]).resolve(t.result)){t.result=h.construct(t.result),t.tag=h.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else _hasOwnProperty$2.call(t.typeMap[t.kind||"fallback"],t.tag)?(h=t.typeMap[t.kind||"fallback"][t.tag],null!==t.result&&h.kind!==t.kind&&throwError(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+h.kind+'", not "'+t.kind+'"'),h.resolve(t.result)?(t.result=h.construct(t.result),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):throwError(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):throwError(t,"unknown tag !<"+t.tag+">");return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||b}function readDocument(t){var e,i,n,s,o=t.position,r=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};0!==(s=t.input.charCodeAt(t.position))&&(skipSeparationSpace(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(r=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!is_WS_OR_EOL(s);)s=t.input.charCodeAt(++t.position);for(n=[],(i=t.input.slice(e,t.position)).length<1&&throwError(t,"directive name must not be less than one character in length");0!==s;){for(;is_WHITE_SPACE(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!is_EOL(s));break}if(is_EOL(s))break;for(e=t.position;0!==s&&!is_WS_OR_EOL(s);)s=t.input.charCodeAt(++t.position);n.push(t.input.slice(e,t.position))}0!==s&&readLineBreak(t),_hasOwnProperty$2.call(directiveHandlers,i)?directiveHandlers[i](t,i,n):throwWarning(t,'unknown document directive "'+i+'"')}skipSeparationSpace(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,skipSeparationSpace(t,!0,-1)):r&&throwError(t,"directives end mark is expected"),composeNode(t,t.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(t,!0,-1),t.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(t.input.slice(o,t.position))&&throwWarning(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&testDocumentSeparator(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,skipSeparationSpace(t,!0,-1)):t.position<t.length-1&&throwError(t,"end of the stream or a document separator is expected")}function loadDocuments(t,e){e=e||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var i=new State(t,e);for(i.input+="\0";32===i.input.charCodeAt(i.position);)i.lineIndent+=1,i.position+=1;for(;i.position<i.length-1;)readDocument(i);return i.documents}function loadAll(t,e,i){var n,s,o=loadDocuments(t,i);if("function"!=typeof e)return o;for(n=0,s=o.length;n<s;n+=1)e(o[n])}function load(t,e){var i=loadDocuments(t,e);if(0!==i.length){if(1===i.length)return i[0];throw new exception("expected a single document in the stream, but found more")}}function safeLoadAll(t,e,i){if("function"!=typeof e)return loadAll(t,common$1.extend({schema:default_safe},i));loadAll(t,e,common$1.extend({schema:default_safe},i))}function safeLoad(t,e){return load(t,common$1.extend({schema:default_safe},e))}var loadAll_1=loadAll,load_1=load,safeLoadAll_1=safeLoadAll,safeLoad_1=safeLoad,loader={loadAll:loadAll_1,load:load_1,safeLoadAll:safeLoadAll_1,safeLoad:safeLoad_1},_toString$2=Object.prototype.toString,_hasOwnProperty$3=Object.prototype.hasOwnProperty,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function compileStyleMap(t,e){var i,n,s,o,r,a,l;if(null===e)return{};for(i={},s=0,o=(n=Object.keys(e)).length;s<o;s+=1)r=n[s],a=String(e[r]),"!!"===r.slice(0,2)&&(r="tag:yaml.org,2002:"+r.slice(2)),(l=t.compiledTypeMap.fallback[r])&&_hasOwnProperty$3.call(l.styleAliases,a)&&(a=l.styleAliases[a]),i[r]=a;return i}function encodeHex(t){var e,i,n;if(e=t.toString(16).toUpperCase(),t<=255)i="x",n=2;else if(t<=65535)i="u",n=4;else{if(!(t<=4294967295))throw new exception("code point within a string may not be greater than 0xFFFFFFFF");i="U",n=8}return"\\"+i+common$1.repeat("0",n-e.length)+e}function State$1(t){this.schema=t.schema||default_full,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=common$1.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=compileStyleMap(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(t,e){for(var i,n=common$1.repeat(" ",e),s=0,o=-1,r="",a=t.length;s<a;)-1===(o=t.indexOf("\n",s))?(i=t.slice(s),s=a):(i=t.slice(s,o+1),s=o+1),i.length&&"\n"!==i&&(r+=n),r+=i;return r}function generateNextLine(t,e){return"\n"+common$1.repeat(" ",t.indent*e)}function testImplicitResolving(t,e){var i,n;for(i=0,n=t.implicitTypes.length;i<n;i+=1)if(t.implicitTypes[i].resolve(e))return!0;return!1}function isWhitespace(t){return t===CHAR_SPACE||t===CHAR_TAB}function isPrintable(t){return 32<=t&&t<=126||161<=t&&t<=55295&&8232!==t&&8233!==t||57344<=t&&t<=65533&&65279!==t||65536<=t&&t<=1114111}function isPlainSafe(t){return isPrintable(t)&&65279!==t&&t!==CHAR_COMMA&&t!==CHAR_LEFT_SQUARE_BRACKET&&t!==CHAR_RIGHT_SQUARE_BRACKET&&t!==CHAR_LEFT_CURLY_BRACKET&&t!==CHAR_RIGHT_CURLY_BRACKET&&t!==CHAR_COLON&&t!==CHAR_SHARP}function isPlainSafeFirst(t){return isPrintable(t)&&65279!==t&&!isWhitespace(t)&&t!==CHAR_MINUS&&t!==CHAR_QUESTION&&t!==CHAR_COLON&&t!==CHAR_COMMA&&t!==CHAR_LEFT_SQUARE_BRACKET&&t!==CHAR_RIGHT_SQUARE_BRACKET&&t!==CHAR_LEFT_CURLY_BRACKET&&t!==CHAR_RIGHT_CURLY_BRACKET&&t!==CHAR_SHARP&&t!==CHAR_AMPERSAND&&t!==CHAR_ASTERISK&&t!==CHAR_EXCLAMATION&&t!==CHAR_VERTICAL_LINE&&t!==CHAR_GREATER_THAN&&t!==CHAR_SINGLE_QUOTE&&t!==CHAR_DOUBLE_QUOTE&&t!==CHAR_PERCENT&&t!==CHAR_COMMERCIAL_AT&&t!==CHAR_GRAVE_ACCENT}function needIndentIndicator(t){return/^\n* /.test(t)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(t,e,i,n,s){var o,r,a=!1,l=!1,c=-1!==n,h=-1,d=isPlainSafeFirst(t.charCodeAt(0))&&!isWhitespace(t.charCodeAt(t.length-1));if(e)for(o=0;o<t.length;o++){if(!isPrintable(r=t.charCodeAt(o)))return STYLE_DOUBLE;d=d&&isPlainSafe(r)}else{for(o=0;o<t.length;o++){if((r=t.charCodeAt(o))===CHAR_LINE_FEED)a=!0,c&&(l=l||o-h-1>n&&" "!==t[h+1],h=o);else if(!isPrintable(r))return STYLE_DOUBLE;d=d&&isPlainSafe(r)}l=l||c&&o-h-1>n&&" "!==t[h+1]}return a||l?i>9&&needIndentIndicator(t)?STYLE_DOUBLE:l?STYLE_FOLDED:STYLE_LITERAL:d&&!s(t)?STYLE_PLAIN:STYLE_SINGLE}function writeScalar(t,e,i,n){t.dump=function(){if(0===e.length)return"''";if(!t.noCompatMode&&-1!==DEPRECATED_BOOLEANS_SYNTAX.indexOf(e))return"'"+e+"'";var s=t.indent*Math.max(1,i),o=-1===t.lineWidth?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-s);switch(chooseScalarStyle(e,n||t.flowLevel>-1&&i>=t.flowLevel,t.indent,o,(function(e){return testImplicitResolving(t,e)}))){case STYLE_PLAIN:return e;case STYLE_SINGLE:return"'"+e.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(e,t.indent)+dropEndingNewline(indentString(e,s));case STYLE_FOLDED:return">"+blockHeader(e,t.indent)+dropEndingNewline(indentString(foldString(e,o),s));case STYLE_DOUBLE:return'"'+escapeString(e)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(t,e){var i=needIndentIndicator(t)?String(e):"",n="\n"===t[t.length-1];return i+(!n||"\n"!==t[t.length-2]&&"\n"!==t?n?"":"-":"+")+"\n"}function dropEndingNewline(t){return"\n"===t[t.length-1]?t.slice(0,-1):t}function foldString(t,e){for(var i,n,s,o=/(\n+)([^\n]*)/g,r=(i=t.indexOf("\n"),o.lastIndex=i=-1!==i?i:t.length,foldLine(t.slice(0,i),e)),a="\n"===t[0]||" "===t[0];s=o.exec(t);){var l=s[2];n=" "===l[0],r+=s[1]+(a||n||""===l?"":"\n")+foldLine(l,e),a=n}return r}function foldLine(t,e){if(""===t||" "===t[0])return t;for(var i,n,s=/ [^ ]/g,o=0,r=0,a=0,l="";i=s.exec(t);)(a=i.index)-o>e&&(l+="\n"+t.slice(o,n=r>o?r:a),o=n+1),r=a;return l+="\n",(l+=t.length-o>e&&r>o?t.slice(o,r)+"\n"+t.slice(r+1):t.slice(o)).slice(1)}function escapeString(t){for(var e,i,n,s="",o=0;o<t.length;o++)(e=t.charCodeAt(o))>=55296&&e<=56319&&(i=t.charCodeAt(o+1))>=56320&&i<=57343?(s+=encodeHex(1024*(e-55296)+i-56320+65536),o++):s+=!(n=ESCAPE_SEQUENCES[e])&&isPrintable(e)?t[o]:n||encodeHex(e);return s}function writeFlowSequence(t,e,i){var n,s,o="",r=t.tag;for(n=0,s=i.length;n<s;n+=1)writeNode(t,e,i[n],!1,!1)&&(0!==n&&(o+=","+(t.condenseFlow?"":" ")),o+=t.dump);t.tag=r,t.dump="["+o+"]"}function writeBlockSequence(t,e,i,n){var s,o,r="",a=t.tag;for(s=0,o=i.length;s<o;s+=1)writeNode(t,e+1,i[s],!0,!0)&&(n&&0===s||(r+=generateNextLine(t,e)),t.dump&&CHAR_LINE_FEED===t.dump.charCodeAt(0)?r+="-":r+="- ",r+=t.dump);t.tag=a,t.dump=r||"[]"}function writeFlowMapping(t,e,i){var n,s,o,r,a,l="",c=t.tag,h=Object.keys(i);for(n=0,s=h.length;n<s;n+=1)a=t.condenseFlow?'"':"",0!==n&&(a+=", "),r=i[o=h[n]],writeNode(t,e,o,!1,!1)&&(t.dump.length>1024&&(a+="? "),a+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),writeNode(t,e,r,!1,!1)&&(l+=a+=t.dump));t.tag=c,t.dump="{"+l+"}"}function writeBlockMapping(t,e,i,n){var s,o,r,a,l,c,h="",d=t.tag,u=Object.keys(i);if(!0===t.sortKeys)u.sort();else if("function"==typeof t.sortKeys)u.sort(t.sortKeys);else if(t.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(s=0,o=u.length;s<o;s+=1)c="",n&&0===s||(c+=generateNextLine(t,e)),a=i[r=u[s]],writeNode(t,e+1,r,!0,!0,!0)&&((l=null!==t.tag&&"?"!==t.tag||t.dump&&t.dump.length>1024)&&(t.dump&&CHAR_LINE_FEED===t.dump.charCodeAt(0)?c+="?":c+="? "),c+=t.dump,l&&(c+=generateNextLine(t,e)),writeNode(t,e+1,a,!0,l)&&(t.dump&&CHAR_LINE_FEED===t.dump.charCodeAt(0)?c+=":":c+=": ",h+=c+=t.dump));t.tag=d,t.dump=h||"{}"}function detectType(t,e,i){var n,s,o,r,a,l;for(o=0,r=(s=i?t.explicitTypes:t.implicitTypes).length;o<r;o+=1)if(((a=s[o]).instanceOf||a.predicate)&&(!a.instanceOf||"object"==typeof e&&e instanceof a.instanceOf)&&(!a.predicate||a.predicate(e))){if(t.tag=i?a.tag:"?",a.represent){if(l=t.styleMap[a.tag]||a.defaultStyle,"[object Function]"===_toString$2.call(a.represent))n=a.represent(e,l);else{if(!_hasOwnProperty$3.call(a.represent,l))throw new exception("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');n=a.represent[l](e,l)}t.dump=n}return!0}return!1}function writeNode(t,e,i,n,s,o){t.tag=null,t.dump=i,detectType(t,i,!1)||detectType(t,i,!0);var r=_toString$2.call(t.dump);n&&(n=t.flowLevel<0||t.flowLevel>e);var a,l,c="[object Object]"===r||"[object Array]"===r;if(c&&(l=-1!==(a=t.duplicates.indexOf(i))),(null!==t.tag&&"?"!==t.tag||l||2!==t.indent&&e>0)&&(s=!1),l&&t.usedDuplicates[a])t.dump="*ref_"+a;else{if(c&&l&&!t.usedDuplicates[a]&&(t.usedDuplicates[a]=!0),"[object Object]"===r)n&&0!==Object.keys(t.dump).length?(writeBlockMapping(t,e,t.dump,s),l&&(t.dump="&ref_"+a+t.dump)):(writeFlowMapping(t,e,t.dump),l&&(t.dump="&ref_"+a+" "+t.dump));else if("[object Array]"===r){var h=t.noArrayIndent&&e>0?e-1:e;n&&0!==t.dump.length?(writeBlockSequence(t,h,t.dump,s),l&&(t.dump="&ref_"+a+t.dump)):(writeFlowSequence(t,h,t.dump),l&&(t.dump="&ref_"+a+" "+t.dump))}else{if("[object String]"!==r){if(t.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+r)}"?"!==t.tag&&writeScalar(t,t.dump,e,o)}null!==t.tag&&"?"!==t.tag&&(t.dump="!<"+t.tag+"> "+t.dump)}return!0}function getDuplicateReferences(t,e){var i,n,s=[],o=[];for(inspectNode(t,s,o),i=0,n=o.length;i<n;i+=1)e.duplicates.push(s[o[i]]);e.usedDuplicates=new Array(n)}function inspectNode(t,e,i){var n,s,o;if(null!==t&&"object"==typeof t)if(-1!==(s=e.indexOf(t)))-1===i.indexOf(s)&&i.push(s);else if(e.push(t),Array.isArray(t))for(s=0,o=t.length;s<o;s+=1)inspectNode(t[s],e,i);else for(s=0,o=(n=Object.keys(t)).length;s<o;s+=1)inspectNode(t[n[s]],e,i)}function dump(t,e){var i=new State$1(e=e||{});return i.noRefs||getDuplicateReferences(t,i),writeNode(i,0,t,!0,!0)?i.dump+"\n":""}function safeDump(t,e){return dump(t,common$1.extend({schema:default_safe},e))}var dump_1=dump,safeDump_1=safeDump,dumper={dump:dump_1,safeDump:safeDump_1};function deprecated(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}var Type$1=type,Schema$1=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SAFE_SCHEMA=default_safe,DEFAULT_FULL_SCHEMA=default_full,load$1=loader.load,loadAll$1=loader.loadAll,safeLoad$1=loader.safeLoad,safeLoadAll$1=loader.safeLoadAll,dump$1=dumper.dump,safeDump$1=dumper.safeDump,YAMLException$1=exception,MINIMAL_SCHEMA=failsafe,SAFE_SCHEMA=default_safe,DEFAULT_SCHEMA=default_full,scan=deprecated("scan"),parse$2=deprecated("parse"),compose=deprecated("compose"),addConstructor=deprecated("addConstructor"),jsYaml={Type:Type$1,Schema:Schema$1,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SAFE_SCHEMA,DEFAULT_FULL_SCHEMA,load:load$1,loadAll:loadAll$1,safeLoad:safeLoad$1,safeLoadAll:safeLoadAll$1,dump:dump$1,safeDump:safeDump$1,YAMLException:YAMLException$1,MINIMAL_SCHEMA,SAFE_SCHEMA,DEFAULT_SCHEMA,scan,parse:parse$2,compose,addConstructor},jsYaml$1=jsYaml;const zeaFileSystemBrowserCss="@import url('https://unpkg.com/tachyons@4/css/tachyons.min.css');.ZeaFileSystemBrowser{background-color:var(--color-background-1);color:var(--color-foreground-1);font-family:var(--theme-font-family)}.ZeaFileSystemBrowser--highlighted>.ZeaFileSystemBrowser__upload-overlay{display:-ms-flexbox;display:flex}.ZeaFileSystemBrowser__title-bar{display:-ms-flexbox;display:flex;height:64px;-ms-flex-align:center;align-items:center;padding:0 1rem;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-pack:justify;justify-content:space-between}.ZeaFileSystemBrowser__fs-objects{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.ZeaFileSystemBrowser__fs-objects>*{margin:1rem 0 0 1rem}.ZeaFileSystemBrowser__section-title{font-size:14px;font-weight:300}.ZeaFileSystemBrowser__upload-overlay{-ms-flex-align:center;align-items:center;display:none;-ms-flex-pack:center;justify-content:center}.AppItem__Thumbnail{width:220px;height:200px;background-size:contain;background-repeat:no-repeat;background-position:center}.AppItem__Name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}",ZeaFileSystemBrowser=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.filter="",this.changeFolder=createEvent(this,"changeFolder",7)}componentWillLoad(){this.setFolder()}componentWillUpdate(){this.setFolder()}componentDidUnload(){this.unsubFileWithProgress&&this.unsubFileWithProgress()}loadReadmeFile(){const t=this.folder.getFileByName("readme.md");t&&t.getPlainTextContent().then(t=>{this.readmeTextContent=t})}loadFileAssociations(){var t;if(null===(t=this.project.connectedApps)||void 0===t?void 0:t.length){const t=this.project.connectedApps.map(async t=>{const e=await this.project.fetchApp(t);await e.fetchLatestVersion();const i=e.getRootFolder().getFileByName("zea-app.yaml");if(!i)throw new Error(`The connected app "${t}" doesn't have a "zea-app.yaml" file.`);const n=await i.getPlainTextContent();return jsYaml$1.safeLoad(n)});Promise.all(t).then(t=>{this.fileAssociations=t})}}handleZeaSession(){this.unsubFileWithProgress&&this.unsubFileWithProgress(),r.setSocketURL("https://websocket-staging.zea.live"),this.zeaSession=r.getInstance({id:"zea-web-components"},this.project._id)}setFolder(){this.project&&(this.folder=this.folderId?this.project.getFolderById(this.folderId):this.project.getRootFolder(),this.galleryFolder=this.folder.getFolderByName("gallery"),this.loadReadmeFile(),this.loadFileAssociations(),this.handleZeaSession())}async handleDrop(t){const{files:e}=t.dataTransfer;await this.folder.addFiles(e),await this.project.fetchLatestVersion(),this.folder=null,this.setFolder()}static preventDefaults(t){t.preventDefault(),t.stopPropagation()}async fetchAvailableApps(){this.availableApps=await this.project.fetchAvailableApps()}render(){var t;if(!this.folder)return;const e=Object.values(this.folder.children||{}).filter(t=>t.name.toLowerCase().includes(this.filter.toLowerCase())).sort((t,e)=>t.name.toLowerCase()>e.name.toLowerCase()?1:-1),i=e.filter(t=>t.isFolder),n=e.filter(t=>!t.isFolder);return h("div",{class:{ZeaFileSystemBrowser:!0,"ZeaFileSystemBrowser--highlighted":this.isHighlighted},onDragEnter:t=>{ZeaFileSystemBrowser.preventDefaults(t),this.isHighlighted=!0},onDragLeave:t=>{ZeaFileSystemBrowser.preventDefaults(t),this.isHighlighted=!1},onDragOver:t=>{ZeaFileSystemBrowser.preventDefaults(t),this.isHighlighted=!0},onDrop:async t=>{ZeaFileSystemBrowser.preventDefaults(t),this.isHighlighted=!1,await this.handleDrop(t)}},h("div",{class:"ZeaFileSystemBrowser__upload-overlay"},h("img",{src:"./icon-drop-files-here.png"})),h("div",{class:"ZeaFileSystemBrowser__title-bar"},h("span",{class:"flex-auto"},this.project.name),h("ion-button",{shape:"round"},h("ion-icon",{slot:"start",name:"add"}),"new"),h("ion-button",{fill:"clear",title:"Project info"},h("ion-icon",{name:"information-circle-sharp"})),h("ion-button",{fill:"clear",title:"Project settings",onClick:()=>{this.showProjectSettingsDialog=!0}},h("ion-icon",{name:"settings-sharp"})),h("ion-button",{fill:"clear",title:"View as list"},h("ion-icon",{name:"list-sharp"}))),h("div",{class:"ZeaFileSystemBrowser__breadcrumbs"},h("zea-breadcrumbs",{project:this.project,folder:this.folder})),h("div",{class:"mh3"},h("div",{class:"mb4"},h("p",{class:"ZeaFileSystemBrowser__section-title"},"Folders"),i.length?h("div",{class:"ZeaFileSystemBrowser__fs-objects"},i.map(t=>h("zea-thumbnail",{icon:h("ion-icon",{name:"folder"}),zeaModelInstance:t,onDblClickThumbnail:()=>{this.folderId=t.id,this.changeFolder.emit(t)}}))):h("div",null,"No folders.")),h("div",{class:"mb4"},h("p",{class:"ZeaFileSystemBrowser__section-title"},"Files"),n.length?h("div",{class:"ZeaFileSystemBrowser__fs-objects"},n.map(t=>h("zea-thumbnail",{icon:h("ion-icon",{name:"document"}),zeaModelInstance:t,zeaSession:this.zeaSession,onDblClickThumbnail:()=>{const e=this.fileAssociations.find(e=>e["media-types"].includes(t.type));e?window.open(`${e["view-with"]}?project-id=${this.project._id}&file-id=${t.id}`).focus():window.alert(`The file's media type (${t.type}) doesn't have a valid association.`)}}))):h("div",null,"No files.")),h("div",{class:"ZeaFileSystemBrowser__gallery-wrapper"},this.galleryFolder&&h("zea-images-gallery",{folder:this.galleryFolder})),h("div",{class:"ZeaFileSystemBrowser__readme-wrapper"},h("zea-markdown-viewer",{mdText:this.readmeTextContent}))),this.showProjectSettingsDialog&&h("zea-dialog",{shown:!0,width:"50%"},h("div",{slot:"title"},"Project Settings"),h("div",{slot:"body"},h("zea-tabs",null,h("div",{slot:"tab-bar"},"Manage Apps"),h("div",null,h("div",{class:"f4 mb3"},"Manage Apps"),h("ion-button",{class:"mb3",onClick:async()=>{await this.fetchAvailableApps(),this.showAppStoreDialog=!0}},"App Store"),(null===(t=this.project.connectedApps)||void 0===t?void 0:t.length)>0?h("div",null,h("div",{class:"mb3"},"The apps below have been connected to this project."),h("ion-list",null,this.project.connectedApps.map(t=>h("ion-item",null,h("ion-label",null,t),h("ion-button",{class:"dark-red",fill:"clear",slot:"end",title:"Remove",onClick:async()=>{await this.project.disconnectApp(t)}},h("ion-icon",{name:"close-circle-sharp"})))))):h("div",null,"No apps have been connected to this project.")),h("div",{slot:"tab-bar"},"Storage"),h("div",null),h("div",{slot:"tab-bar"},"Advanced"),h("div",null)))),this.showAppStoreDialog&&h("zea-dialog",{shown:!0,width:"75%"},h("div",{slot:"title"},"App Store"),h("div",{slot:"body"},h("ul",{class:"list pl0 flex flex-wrap"},this.availableApps.map(t=>h("li",null,h("button",{class:"AppItem br2 grow shadow-hover mb3 mr3 pa0",title:t.name,type:"button",onClick:async()=>{this.currentApp=await this.project.fetchApp(t._id),await this.currentApp.fetchLatestVersion();const e=this.currentApp.getRootFolder().getFileByName("readme.md");e&&e.getPlainTextContent().then(t=>{this.currentAppReadmeTextContent=t})}},h("div",{class:"AppItem__Thumbnail br2",style:{backgroundImage:"url('https://storage.googleapis.com/zea-drive-staging-projects-assets/thumbnail-pdf-viewer.png')"}}),h("div",{class:"AppItem__Footer flex f6 items-center pa1"},h("span",{class:"AppItem__Name"},t.name)))))))),this.currentApp&&h("zea-dialog",{shown:!0,width:"80%"},h("div",{class:"flex items-center",slot:"title"},h("span",{class:"flex-auto"},this.currentApp.name),h("ion-button",{onClick:async()=>{await this.project.connectApp(this.currentApp._id)}},"Install")),h("div",{slot:"body"},h("zea-markdown-viewer",{mdText:this.currentAppReadmeTextContent}))))}static get style(){return zeaFileSystemBrowserCss}},zeaFormCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-form{color:var(--color-foreground-1)}zea-button.submit{margin-top:2em;width:100%}",ZeaForm=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.submitText="SUBMIT",this.validate=!0,this.isValid=!0,this.formValue={},this.inputs=[]}getFormValue(){return this.checkValidation(),this.inputs.forEach(t=>{this.formValue[t.name]=t.value}),this.formValue}checkValidation(){if(!this.validate)return!0;for(let t=0;t<this.inputs.length;t++){const e=this.inputs[t];if(!e.isValid)return e.invalidMessageShown=!0,this.isValid=!1,!1;e.invalidMessageShown=!1,this.isValid=!0}return!0}onSubmit(){this.submitCallback&&this.submitCallback(this.getFormValue())}componentDidRender(){this.setupChildren()}setupChildren(){this.formContainer.querySelector("slot").assignedElements().forEach(t=>{t.tagName.match(/^ZEA-INPUT/i)&&this.inputs.push(t)})}render(){return h("div",{class:"zea-form",ref:t=>this.formContainer=t},h("slot",null),h("zea-button",{onClick:this.onSubmit.bind(this),class:"submit"},this.submitText))}static get style(){return zeaFormCss}};var Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain,draining;if(Mutation){var called=0,observer=new Mutation(nextTick$1),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(commonjsGlobal.setImmediate||void 0===commonjsGlobal.MessageChannel)scheduleDrain="document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?function(){var t=commonjsGlobal.document.createElement("script");t.onreadystatechange=function(){nextTick$1(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},commonjsGlobal.document.documentElement.appendChild(t)}:function(){setTimeout(nextTick$1,0)};else{var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick$1,scheduleDrain=function(){channel.port2.postMessage(0)}}var queue=[];function nextTick$1(){var t,e;draining=!0;for(var i=queue.length;i;){for(e=queue,queue=[],t=-1;++t<i;)e[t]();i=queue.length}draining=!1}var browser$3=immediate;function immediate(t){1!==queue.push(t)||draining||scheduleDrain()}for(var rngBrowser=createCommonjsModule((function(t){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var i=new Uint8Array(16);t.exports=function(){return e(i),i}}else{var n=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),n[e]=t>>>((3&e)<<3)&255;return n}}})),byteToHex=[],i$3=0;i$3<256;++i$3)byteToHex[i$3]=(i$3+256).toString(16).substr(1);function bytesToUuid(t,e){var i=e||0;return[byteToHex[t[i++]],byteToHex[t[i++]],byteToHex[t[i++]],byteToHex[t[i++]],"-",byteToHex[t[i++]],byteToHex[t[i++]],"-",byteToHex[t[i++]],byteToHex[t[i++]],"-",byteToHex[t[i++]],byteToHex[t[i++]],"-",byteToHex[t[i++]],byteToHex[t[i++]],byteToHex[t[i++]],byteToHex[t[i++]],byteToHex[t[i++]],byteToHex[t[i++]]].join("")}var bytesToUuid_1=bytesToUuid,_nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(t,e,i){var n=e&&i||0,s=e||[],o=(t=t||{}).node||_nodeId,r=void 0!==t.clockseq?t.clockseq:_clockseq;if(null==o||null==r){var a=rngBrowser();null==o&&(o=_nodeId=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==r&&(r=_clockseq=16383&(a[6]<<8|a[7]))}var l=void 0!==t.msecs?t.msecs:(new Date).getTime(),c=void 0!==t.nsecs?t.nsecs:_lastNSecs+1,h=l-_lastMSecs+(c-_lastNSecs)/1e4;if(h<0&&void 0===t.clockseq&&(r=r+1&16383),(h<0||l>_lastMSecs)&&void 0===t.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=l,_lastNSecs=c,_clockseq=r;var d=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;s[n++]=d>>>24&255,s[n++]=d>>>16&255,s[n++]=d>>>8&255,s[n++]=255&d;var u=l/4294967296*1e4&268435455;s[n++]=u>>>8&255,s[n++]=255&u,s[n++]=u>>>24&15|16,s[n++]=u>>>16&255,s[n++]=r>>>8|128,s[n++]=255&r;for(var m=0;m<6;++m)s[n+m]=o[m];return e||bytesToUuid_1(s)}var v1_1=v1;function v4(t,e,i){var n=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||rngBrowser)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var o=0;o<16;++o)e[n+o]=s[o];return e||bytesToUuid_1(s)}var v4_1=v4,uuid=v4_1;uuid.v1=v1_1,uuid.v4=v4_1;var uuid_1=uuid,sparkMd5=createCommonjsModule((function(t){t.exports=function(){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function e(t,e){var i=t[0],n=t[1],s=t[2],o=t[3];n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&s|~n&o)+e[0]-680876936|0)<<7|i>>>25)+n|0)&n|~i&s)+e[1]-389564586|0)<<12|o>>>20)+i|0)&i|~o&n)+e[2]+606105819|0)<<17|s>>>15)+o|0)&o|~s&i)+e[3]-1044525330|0)<<22|n>>>10)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&s|~n&o)+e[4]-176418897|0)<<7|i>>>25)+n|0)&n|~i&s)+e[5]+1200080426|0)<<12|o>>>20)+i|0)&i|~o&n)+e[6]-1473231341|0)<<17|s>>>15)+o|0)&o|~s&i)+e[7]-45705983|0)<<22|n>>>10)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&s|~n&o)+e[8]+1770035416|0)<<7|i>>>25)+n|0)&n|~i&s)+e[9]-1958414417|0)<<12|o>>>20)+i|0)&i|~o&n)+e[10]-42063|0)<<17|s>>>15)+o|0)&o|~s&i)+e[11]-1990404162|0)<<22|n>>>10)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&s|~n&o)+e[12]+1804603682|0)<<7|i>>>25)+n|0)&n|~i&s)+e[13]-40341101|0)<<12|o>>>20)+i|0)&i|~o&n)+e[14]-1502002290|0)<<17|s>>>15)+o|0)&o|~s&i)+e[15]+1236535329|0)<<22|n>>>10)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&o|s&~o)+e[1]-165796510|0)<<5|i>>>27)+n|0)&s|n&~s)+e[6]-1069501632|0)<<9|o>>>23)+i|0)&n|i&~n)+e[11]+643717713|0)<<14|s>>>18)+o|0)&i|o&~i)+e[0]-373897302|0)<<20|n>>>12)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&o|s&~o)+e[5]-701558691|0)<<5|i>>>27)+n|0)&s|n&~s)+e[10]+38016083|0)<<9|o>>>23)+i|0)&n|i&~n)+e[15]-660478335|0)<<14|s>>>18)+o|0)&i|o&~i)+e[4]-405537848|0)<<20|n>>>12)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&o|s&~o)+e[9]+568446438|0)<<5|i>>>27)+n|0)&s|n&~s)+e[14]-1019803690|0)<<9|o>>>23)+i|0)&n|i&~n)+e[3]-187363961|0)<<14|s>>>18)+o|0)&i|o&~i)+e[8]+1163531501|0)<<20|n>>>12)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n&o|s&~o)+e[13]-1444681467|0)<<5|i>>>27)+n|0)&s|n&~s)+e[2]-51403784|0)<<9|o>>>23)+i|0)&n|i&~n)+e[7]+1735328473|0)<<14|s>>>18)+o|0)&i|o&~i)+e[12]-1926607734|0)<<20|n>>>12)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n^s^o)+e[5]-378558|0)<<4|i>>>28)+n|0)^n^s)+e[8]-2022574463|0)<<11|o>>>21)+i|0)^i^n)+e[11]+1839030562|0)<<16|s>>>16)+o|0)^o^i)+e[14]-35309556|0)<<23|n>>>9)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n^s^o)+e[1]-1530992060|0)<<4|i>>>28)+n|0)^n^s)+e[4]+1272893353|0)<<11|o>>>21)+i|0)^i^n)+e[7]-155497632|0)<<16|s>>>16)+o|0)^o^i)+e[10]-1094730640|0)<<23|n>>>9)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n^s^o)+e[13]+681279174|0)<<4|i>>>28)+n|0)^n^s)+e[0]-358537222|0)<<11|o>>>21)+i|0)^i^n)+e[3]-722521979|0)<<16|s>>>16)+o|0)^o^i)+e[6]+76029189|0)<<23|n>>>9)+s|0,n=((n+=((s=((s+=((o=((o+=((i=((i+=(n^s^o)+e[9]-640364487|0)<<4|i>>>28)+n|0)^n^s)+e[12]-421815835|0)<<11|o>>>21)+i|0)^i^n)+e[15]+530742520|0)<<16|s>>>16)+o|0)^o^i)+e[2]-995338651|0)<<23|n>>>9)+s|0,n=((n+=((o=((o+=(n^((i=((i+=(s^(n|~o))+e[0]-198630844|0)<<6|i>>>26)+n|0)|~s))+e[7]+1126891415|0)<<10|o>>>22)+i|0)^((s=((s+=(i^(o|~n))+e[14]-1416354905|0)<<15|s>>>17)+o|0)|~i))+e[5]-57434055|0)<<21|n>>>11)+s|0,n=((n+=((o=((o+=(n^((i=((i+=(s^(n|~o))+e[12]+1700485571|0)<<6|i>>>26)+n|0)|~s))+e[3]-1894986606|0)<<10|o>>>22)+i|0)^((s=((s+=(i^(o|~n))+e[10]-1051523|0)<<15|s>>>17)+o|0)|~i))+e[1]-2054922799|0)<<21|n>>>11)+s|0,n=((n+=((o=((o+=(n^((i=((i+=(s^(n|~o))+e[8]+1873313359|0)<<6|i>>>26)+n|0)|~s))+e[15]-30611744|0)<<10|o>>>22)+i|0)^((s=((s+=(i^(o|~n))+e[6]-1560198380|0)<<15|s>>>17)+o|0)|~i))+e[13]+1309151649|0)<<21|n>>>11)+s|0,n=((n+=((o=((o+=(n^((i=((i+=(s^(n|~o))+e[4]-145523070|0)<<6|i>>>26)+n|0)|~s))+e[11]-1120210379|0)<<10|o>>>22)+i|0)^((s=((s+=(i^(o|~n))+e[2]+718787259|0)<<15|s>>>17)+o|0)|~i))+e[9]-343485551|0)<<21|n>>>11)+s|0,t[0]=i+t[0]|0,t[1]=n+t[1]|0,t[2]=s+t[2]|0,t[3]=o+t[3]|0}function i(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}function n(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return i}function s(t){var n,s,o,r,a,l,c=t.length,h=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)e(h,i(t.substring(n-64,n)));for(s=(t=t.substring(n-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<s;n+=1)o[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),n>55)for(e(h,o),n=0;n<16;n+=1)o[n]=0;return r=(r=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=a,o[15]=l,e(h,o),h}function o(e){var i,n="";for(i=0;i<4;i+=1)n+=t[e>>8*i+4&15]+t[e>>8*i&15];return n}function r(t){var e;for(e=0;e<t.length;e+=1)t[e]=o(t[e]);return t.join("")}function a(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function l(t){var e,i=[],n=t.length;for(e=0;e<n-1;e+=2)i.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,i)}function c(){this.reset()}return r(s("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(e,i){var n,s,o,r,a=this.byteLength,l=t(e,a),c=a;return void 0!==i&&(c=t(i,a)),l>c?new ArrayBuffer(0):(n=c-l,s=new ArrayBuffer(n),o=new Uint8Array(s),r=new Uint8Array(this,l,n),o.set(r),s)}}(),c.prototype.append=function(t){return this.appendBinary(a(t)),this},c.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var n,s=this._buff.length;for(n=64;n<=s;n+=64)e(this._hash,i(this._buff.substring(n-64,n)));return this._buff=this._buff.substring(n-64),this},c.prototype.end=function(t){var e,i,n=this._buff,s=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<s;e+=1)o[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(o,s),i=r(this._hash),t&&(i=l(i)),this.reset(),i},c.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},c.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},c.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},c.prototype._finish=function(t,i){var n,s,o,r=i;if(t[r>>2]|=128<<(r%4<<3),r>55)for(e(this._hash,t),r=0;r<16;r+=1)t[r]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(n[2],16),o=parseInt(n[1],16)||0,t[14]=s,t[15]=o,e(this._hash,t)},c.hash=function(t,e){return c.hashBinary(a(t),e)},c.hashBinary=function(t,e){var i=r(s(t));return e?l(i):i},(c.ArrayBuffer=function(){this.reset()}).prototype.append=function(t){var i,s,o,r,a=(s=this._buff.buffer,o=t,!0,(r=new Uint8Array(s.byteLength+o.byteLength)).set(new Uint8Array(s)),r.set(new Uint8Array(o),s.byteLength),r),l=a.length;for(this._length+=t.byteLength,i=64;i<=l;i+=64)e(this._hash,n(a.subarray(i-64,i)));return this._buff=i-64<l?new Uint8Array(a.buffer.slice(i-64)):new Uint8Array(0),this},c.ArrayBuffer.prototype.end=function(t){var e,i,n=this._buff,s=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<s;e+=1)o[e>>2]|=n[e]<<(e%4<<3);return this._finish(o,s),i=r(this._hash),t&&(i=l(i)),this.reset(),i},c.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.ArrayBuffer.prototype.getState=function(){var t=c.prototype.getState.call(this);return t.buff=String.fromCharCode.apply(null,new Uint8Array(t.buff)),t},c.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t){var e,i=t.length,n=new ArrayBuffer(i),s=new Uint8Array(n);for(e=0;e<i;e+=1)s[e]=t.charCodeAt(e);return s}(t.buff),c.prototype.setState.call(this,t)},c.ArrayBuffer.prototype.destroy=c.prototype.destroy,c.ArrayBuffer.prototype._finish=c.prototype._finish,c.ArrayBuffer.hash=function(t,i){var s=r(function(t){var i,s,o,r,a,l,c=t.length,h=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=c;i+=64)e(h,n(t.subarray(i-64,i)));for(s=(t=i-64<c?t.subarray(i-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=0;i<s;i+=1)o[i>>2]|=t[i]<<(i%4<<3);if(o[i>>2]|=128<<(i%4<<3),i>55)for(e(h,o),i=0;i<16;i+=1)o[i]=0;return r=(r=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),l=parseInt(r[1],16)||0,o[14]=a,o[15]=l,e(h,o),h}(new Uint8Array(t)));return i?l(s):s},c}()})),stringify=function(t){var e=[];e.push({obj:t});for(var i,n,s,o,r,a,l,c,h,d="";i=e.pop();)if(n=i.obj,d+=i.prefix||"",s=i.val||"")d+=s;else if("object"!=typeof n)d+=void 0===n?null:JSON.stringify(n);else if(null===n)d+="null";else if(Array.isArray(n)){for(e.push({val:"]"}),o=n.length-1;o>=0;o--)e.push({obj:n[o],prefix:0===o?"":","});e.push({val:"["})}else{for(a in r=[],n)n.hasOwnProperty(a)&&r.push(a);for(e.push({val:"}"}),o=r.length-1;o>=0;o--)c=n[l=r[o]],h=o>0?",":"",h+=JSON.stringify(l)+":",e.push({obj:c,prefix:h});e.push({val:"{"})}return d};function pop(t,e,i){var n=i[i.length-1];t===n.element&&(i.pop(),n=i[i.length-1]);var s=n.element,o=n.index;Array.isArray(s)?s.push(t):o===e.length-2?s[e.pop()]=t:e.push(t)}var parse$3=function(t){for(var e,i,n,s,o,r,a,l,c,h=[],d=[],u=0;;)if("}"!==(e=t[u++])&&"]"!==e&&void 0!==e)switch(e){case" ":case"\t":case"\n":case":":case",":break;case"n":u+=3,pop(null,h,d);break;case"t":u+=3,pop(!0,h,d);break;case"f":u+=4,pop(!1,h,d);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(i="",u--;;){if(n=t[u++],!/[\d\.\-e\+]/.test(n)){u--;break}i+=n}pop(parseFloat(i),h,d);break;case'"':for(s="",o=void 0,r=0;'"'!==(a=t[u++])||"\\"===o&&r%2==1;)s+=a,"\\"===(o=a)?r++:r=0;pop(JSON.parse('"'+s+'"'),h,d);break;case"[":h.push((l={element:[],index:h.length}).element),d.push(l);break;case"{":h.push((c={element:{},index:h.length}).element),d.push(c);break;default:throw new Error("unexpectedly reached end of input: "+e)}else{if(1===h.length)return h.pop();pop(h.pop(),h,d)}},vuvuzela={stringify,parse:parse$3},argsarray=argsArray;function argsArray(t){return function(){var e=arguments.length;if(e){for(var i=[],n=-1;++n<e;)i[n]=arguments[n];return t.call(this,i)}return t.call(this,[])}}var inherits_browser=createCommonjsModule((function(t){t.exports="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}})),ExportedSet,ExportedMap;function mangle(t){return"$"+t}function unmangle(t){return t.substring(1)}function Map$1(){this._store={}}function Set$1(t){if(this._store=new Map$1,t&&Array.isArray(t))for(var e=0,i=t.length;e<i;e++)this.add(t[e])}function supportsMapAndSet(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}function isBinaryObject(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function cloneArrayBuffer(t){if("function"==typeof t.slice)return t.slice(0);var e=new ArrayBuffer(t.byteLength),i=new Uint8Array(e),n=new Uint8Array(t);return i.set(n),e}function cloneBinaryObject(t){if(t instanceof ArrayBuffer)return cloneArrayBuffer(t);var e=t.size,i=t.type;return"function"==typeof t.slice?t.slice(0,e,i):t.webkitSlice(0,e,i)}Map$1.prototype.get=function(t){var e=mangle(t);return this._store[e]},Map$1.prototype.set=function(t,e){var i=mangle(t);return this._store[i]=e,!0},Map$1.prototype.has=function(t){return mangle(t)in this._store},Map$1.prototype.delete=function(t){var e=mangle(t),i=e in this._store;return delete this._store[e],i},Map$1.prototype.forEach=function(t){for(var e=Object.keys(this._store),i=0,n=e.length;i<n;i++){var s=e[i];t(this._store[s],s=unmangle(s))}},Object.defineProperty(Map$1.prototype,"size",{get:function(){return Object.keys(this._store).length}}),Set$1.prototype.add=function(t){return this._store.set(t,!0)},Set$1.prototype.has=function(t){return this._store.has(t)},Set$1.prototype.forEach=function(t){this._store.forEach((function(e,i){t(i)}))},Object.defineProperty(Set$1.prototype,"size",{get:function(){return this._store.size}}),supportsMapAndSet()?(ExportedSet=Set,ExportedMap=Map):(ExportedSet=Set$1,ExportedMap=Map$1);var funcToString=Function.prototype.toString,objectCtorString=funcToString.call(Object);function isPlainObject(t){var e=Object.getPrototypeOf(t);if(null===e)return!0;var i=e.constructor;return"function"==typeof i&&i instanceof i&&funcToString.call(i)==objectCtorString}function clone$1(t){var e,i,n;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){for(e=[],i=0,n=t.length;i<n;i++)e[i]=clone$1(t[i]);return e}if(t instanceof Date)return t.toISOString();if(isBinaryObject(t))return cloneBinaryObject(t);if(!isPlainObject(t))return t;for(i in e={},t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=clone$1(t[i]);void 0!==s&&(e[i]=s)}return e}function once(t){var e=!1;return argsarray((function(i){if(e)throw new Error("once called more than once");e=!0,t.apply(this,i)}))}function toPromise(t){return argsarray((function(i){i=clone$1(i);var n=this,s="function"==typeof i[i.length-1]&&i.pop(),o=new Promise((function(s,o){var r;try{var a=once((function(t,e){t?o(t):s(e)}));i.push(a),(r=t.apply(n,i))&&"function"==typeof r.then&&s(r)}catch(e){o(e)}}));return s&&o.then((function(t){s(null,t)}),s),o}))}function logApiCall(t,e,i){if(t.constructor.listeners("debug").length){for(var n=["api",t.name,e],s=0;s<i.length-1;s++)n.push(i[s]);t.constructor.emit("debug",n);var o=i[i.length-1];i[i.length-1]=function(i,n){var s=["api",t.name,e];s=s.concat(i?["error",i]:["success",n]),t.constructor.emit("debug",s),o(i,n)}}}function adapterFun(t,e){return toPromise(argsarray((function(i){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return logApiCall(n,t,i),this.taskqueue.isReady?e.apply(this,i):new Promise((function(e,s){n.taskqueue.addTask((function(o){o?s(o):e(n[t].apply(n,i))}))}))})))}function pick(t,e){for(var i={},n=0,s=e.length;n<s;n++){var o=e[n];o in t&&(i[o]=t[o])}return i}var MAX_NUM_CONCURRENT_REQUESTS=6,hasLocal,assign;function identityFunction(t){return t}function formatResultForOpenRevsGet(t){return[{ok:t}]}function bulkGet(t,e,i){var n=e.docs,s=new ExportedMap;n.forEach((function(t){s.has(t.id)?s.get(t.id).push(t):s.set(t.id,[t])}));var o=s.size,r=0,a=new Array(o);var l=[];s.forEach((function(t,e){l.push(e)}));var c=0;!function n(){if(!(c>=l.length)){var h=Math.min(c+MAX_NUM_CONCURRENT_REQUESTS,l.length),d=l.slice(c,h);!function(l,c){l.forEach((function(l,h){var d=c+h,u=s.get(l),m=pick(u[0],["atts_since","attachments"]);m.open_revs=u.map((function(t){return t.rev})),m.open_revs=m.open_revs.filter(identityFunction);var p=identityFunction;0===m.open_revs.length&&(delete m.open_revs,p=formatResultForOpenRevsGet),["revs","attachments","binary","ajax","latest"].forEach((function(t){t in e&&(m[t]=e[t])})),t.get(l,m,(function(t,e){var s,c;s=t?[{error:t}]:p(e),a[d]={id:l,docs:s},++r===o&&(c=[],a.forEach((function(t){t.docs.forEach((function(e){c.push({id:t.id,docs:[e]})}))})),i(null,{results:c})),n()}))}))}(d,c),c+=d.length}}()}try{localStorage.setItem("_pouch_check_localstorage",1),hasLocal=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){hasLocal=!1}function hasLocalStorage(){return hasLocal}function attachBrowserEvents(t){hasLocalStorage()&&addEventListener("storage",(function(e){t.emit(e.key)}))}function Changes(){EventEmitter.call(this),this._listeners={},attachBrowserEvents(this)}function guardedConsole(t){if("undefined"!=typeof console&&"function"==typeof console[t]){var e=Array.prototype.slice.call(arguments,1);console[t].apply(console,e)}}function randomNumber(t,e){return t=parseInt(t,10)||0,(e=parseInt(e,10))!=e||e<=t?e=(t||1)<<1:e+=1,e>6e5&&(t=3e5,e=6e5),~~((e-t)*Math.random()+t)}function defaultBackOff(t){var e=0;return t||(e=2e3),randomNumber(t,e)}function explainError(t,e){guardedConsole("info","The above "+t+" is totally normal. "+e)}inherits_browser(Changes,EventEmitter),Changes.prototype.addListener=function(t,e,i,n){if(!this._listeners[e]){var s=this,o=!1;this._listeners[e]=r,this.on(t,r)}function r(){if(s._listeners[e])if(o)o="waiting";else{o=!0;var t=pick(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);i.changes(t).on("change",(function(t){t.seq>n.since&&!n.cancelled&&(n.since=t.seq,n.onChange(t))})).on("complete",(function(){"waiting"===o&&browser$3(r),o=!1})).on("error",(function(){o=!1}))}}},Changes.prototype.removeListener=function(t,e){e in this._listeners&&(EventEmitter.prototype.removeListener.call(this,t,this._listeners[e]),delete this._listeners[e])},Changes.prototype.notifyLocalWindows=function(t){hasLocalStorage()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},Changes.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},assign="function"==typeof Object.assign?Object.assign:function(t){for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};var $inject_Object_assign=assign;function PouchError(t,e,i){Error.call(this,i),this.status=t,this.name=e,this.message=i,this.error=!0}inherits_browser(PouchError,Error),PouchError.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED=new PouchError(401,"unauthorized","Name or password is incorrect."),MISSING_BULK_DOCS=new PouchError(400,"bad_request","Missing JSON list of 'docs'"),MISSING_DOC=new PouchError(404,"not_found","missing"),REV_CONFLICT=new PouchError(409,"conflict","Document update conflict"),INVALID_ID=new PouchError(400,"bad_request","_id field must contain a string"),MISSING_ID=new PouchError(412,"missing_id","_id is required for puts"),RESERVED_ID=new PouchError(400,"bad_request","Only reserved document ids may start with underscore."),NOT_OPEN=new PouchError(412,"precondition_failed","Database not open"),UNKNOWN_ERROR=new PouchError(500,"unknown_error","Database encountered an unknown error"),BAD_ARG=new PouchError(500,"badarg","Some query argument is invalid"),INVALID_REQUEST=new PouchError(400,"invalid_request","Request was invalid"),QUERY_PARSE_ERROR=new PouchError(400,"query_parse_error","Some query parameter is invalid"),DOC_VALIDATION=new PouchError(500,"doc_validation","Bad special document member"),BAD_REQUEST=new PouchError(400,"bad_request","Something wrong with the request"),NOT_AN_OBJECT=new PouchError(400,"bad_request","Document must be a JSON object"),DB_MISSING=new PouchError(404,"not_found","Database not found"),IDB_ERROR=new PouchError(500,"indexed_db_went_bad","unknown"),WSQ_ERROR=new PouchError(500,"web_sql_went_bad","unknown"),LDB_ERROR=new PouchError(500,"levelDB_went_went_bad","unknown"),FORBIDDEN=new PouchError(403,"forbidden","Forbidden by design doc validate_doc_update function"),INVALID_REV=new PouchError(400,"bad_request","Invalid rev format"),FILE_EXISTS=new PouchError(412,"file_exists","The database could not be created, the file already exists."),MISSING_STUB=new PouchError(412,"missing_stub","A pre-existing attachment stub wasn't found"),INVALID_URL=new PouchError(413,"invalid_url","Provided URL is invalid");function createError(t,e){function i(e){for(var i in t)"function"!=typeof t[i]&&(this[i]=t[i]);void 0!==e&&(this.reason=e)}return i.prototype=PouchError.prototype,new i(e)}function generateErrorFromResponse(t){if("object"!=typeof t){var e=t;(t=UNKNOWN_ERROR).data=e}return"error"in t&&"conflict"===t.error&&(t.name="conflict",t.status=409),"name"in t||(t.name=t.error||"unknown"),"status"in t||(t.status=500),"message"in t||(t.message=t.message||t.reason),t}function tryFilter(t,e,i){try{return!t(e,i)}catch(s){var n="Filter function threw: "+s.toString();return createError(BAD_REQUEST,n)}}function filterChange(t){var e={},i=t.filter&&"function"==typeof t.filter;return e.query=t.query_params,function(n){n.doc||(n.doc={});var s=i&&tryFilter(t.filter,n.doc,e);if("object"==typeof s)return s;if(s)return!1;if(t.include_docs){if(!t.attachments)for(var o in n.doc._attachments)n.doc._attachments.hasOwnProperty(o)&&(n.doc._attachments[o].stub=!0)}else delete n.doc;return!0}}function flatten(t){for(var e=[],i=0,n=t.length;i<n;i++)e=e.concat(t[i]);return e}function invalidIdError(t){var e;if(t?"string"!=typeof t?e=createError(INVALID_ID):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(e=createError(RESERVED_ID)):e=createError(MISSING_ID),e)throw e}function isRemote(t){return"boolean"==typeof t._remote?t._remote:"function"==typeof t.type&&(guardedConsole("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function listenerCount$1(t,e){return"listenerCount"in t?t.listenerCount(e):EventEmitter.listenerCount(t,e)}function parseDesignDocFunctionName(t){if(!t)return null;var e=t.split("/");return 2===e.length?e:1===e.length?[t,t]:null}function normalizeDesignDocFunctionName(t){var e=parseDesignDocFunctionName(t);return e?e.join("/"):null}var keys$1=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],qName="queryKey",qParser=/(?:^|&)([^&=]*)=?([^&]*)/g,parser$1=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function parseUri(t){for(var e=parser$1.exec(t),i={},n=14;n--;){var s=keys$1[n],o=e[n]||"",r=-1!==["user","password"].indexOf(s);i[s]=r?decodeURIComponent(o):o}return i[qName]={},i[keys$1[12]].replace(qParser,(function(t,e,n){e&&(i[qName][e]=n)})),i}function scopeEval(t,e){var i=[],n=[];for(var s in e)e.hasOwnProperty(s)&&(i.push(s),n.push(e[s]));return i.push(t),Function.apply(null,i).apply(null,n)}function upsert(t,e,i){return new Promise((function(n,s){t.get(e,(function(o,r){if(o){if(404!==o.status)return s(o);r={}}var a=r._rev,l=i(r);if(!l)return n({updated:!1,rev:a});l._id=e,l._rev=a,n(tryAndPut(t,l,i))}))}))}function tryAndPut(t,e,i){return t.put(e).then((function(t){return{updated:!0,rev:t.rev}}),(function(n){if(409!==n.status)throw n;return upsert(t,e._id,i)}))}var thisAtob=function(t){return atob(t)},thisBtoa=function(t){return btoa(t)};function createBlob(t,i){t=t||[],i=i||{};try{return new Blob(t,i)}catch(e){if("TypeError"!==e.name)throw e;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),s=0;s<t.length;s+=1)n.append(t[s]);return n.getBlob(i.type)}}function binaryStringToArrayBuffer(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),s=0;s<e;s++)n[s]=t.charCodeAt(s);return i}function binStringToBluffer(t,e){return createBlob([binaryStringToArrayBuffer(t)],{type:e})}function b64ToBluffer(t,e){return binStringToBluffer(thisAtob(t),e)}function arrayBufferToBinaryString(t){for(var e="",i=new Uint8Array(t),n=i.byteLength,s=0;s<n;s++)e+=String.fromCharCode(i[s]);return e}function readAsBinaryString(t,e){var i=new FileReader,n="function"==typeof i.readAsBinaryString;i.onloadend=function(t){var i=t.target.result||"";if(n)return e(i);e(arrayBufferToBinaryString(i))},n?i.readAsBinaryString(t):i.readAsArrayBuffer(t)}function blobToBinaryString(t,e){readAsBinaryString(t,(function(t){e(t)}))}function blobToBase64(t,e){blobToBinaryString(t,(function(t){e(thisBtoa(t))}))}function readAsArrayBuffer(t,e){var i=new FileReader;i.onloadend=function(t){var i=t.target.result||new ArrayBuffer(0);e(i)},i.readAsArrayBuffer(t)}var setImmediateShim=global$1.setImmediate||global$1.setTimeout,MD5_CHUNK_SIZE=32768;function rawToBase64(t){return thisBtoa(t)}function sliceBlob(t,e,i){return t.webkitSlice?t.webkitSlice(e,i):t.slice(e,i)}function appendBlob(t,e,i,n,s){(i>0||n<e.size)&&(e=sliceBlob(e,i,n)),readAsArrayBuffer(e,(function(e){t.append(e),s()}))}function appendString(t,e,i,n,s){(i>0||n<e.length)&&(e=e.substring(i,n)),t.appendBinary(e),s()}function binaryMd5(t,e){var i="string"==typeof t,n=i?t.length:t.size,s=Math.min(MD5_CHUNK_SIZE,n),o=Math.ceil(n/s),r=0,a=i?new sparkMd5:new sparkMd5.ArrayBuffer,l=i?appendString:appendBlob;function c(){setImmediateShim(d)}function h(){var t=rawToBase64(a.end(!0));e(t),a.destroy()}function d(){var e=r*s;r++,l(a,t,e,e+s,r<o?c:h)}d()}function stringMd5(t){return sparkMd5.hash(t)}function rev(t,e){var i=clone$1(t);return e?(delete i._rev_tree,stringMd5(JSON.stringify(i))):uuid_1.v4().replace(/-/g,"").toLowerCase()}var uuid$1=uuid_1.v4;function winningRev(t){for(var e,i,n,s,o=t.rev_tree.slice();s=o.pop();){var r=s.ids,a=r[2],l=s.pos;if(a.length)for(var c=0,h=a.length;c<h;c++)o.push({pos:l+1,ids:a[c]});else{var d=!!r[1].deleted,u=r[0];e&&!(n!==d?n:i!==l?i<l:e<u)||(e=u,i=l,n=d)}}return i+"-"+e}function traverseRevTree(t,e){for(var i,n=t.slice();i=n.pop();)for(var s=i.pos,o=i.ids,r=o[2],a=e(0===r.length,s,o[0],i.ctx,o[1]),l=0,c=r.length;l<c;l++)n.push({pos:s+1,ids:r[l],ctx:a})}function sortByPos(t,e){return t.pos-e.pos}function collectLeaves(t){var e=[];traverseRevTree(t,(function(t,i,n,s,o){t&&e.push({rev:i+"-"+n,pos:i,opts:o})})),e.sort(sortByPos).reverse();for(var i=0,n=e.length;i<n;i++)delete e[i].pos;return e}function collectConflicts(t){for(var e=winningRev(t),i=collectLeaves(t.rev_tree),n=[],s=0,o=i.length;s<o;s++){var r=i[s];r.rev===e||r.opts.deleted||n.push(r.rev)}return n}function compactTree(t){var e=[];return traverseRevTree(t.rev_tree,(function(t,i,n,s,o){"available"!==o.status||t||(e.push(i+"-"+n),o.status="missing")})),e}function rootToLeaf(t){for(var e,i=[],n=t.slice();e=n.pop();){var s=e.pos,o=e.ids,r=o[0],a=o[1],l=o[2],c=0===l.length,h=e.history?e.history.slice():[];h.push({id:r,opts:a}),c&&i.push({pos:s+1-h.length,ids:h});for(var d=0,u=l.length;d<u;d++)n.push({pos:s+1,ids:l[d],history:h})}return i.reverse()}function sortByPos$1(t,e){return t.pos-e.pos}function binarySearch(t,e,i){for(var n,s=0,o=t.length;s<o;)i(t[n=s+o>>>1],e)<0?s=n+1:o=n;return s}function insertSorted(t,e,i){var n=binarySearch(t,e,i);t.splice(n,0,e)}function pathToTree(t,e){for(var i,n,s=e,o=t.length;s<o;s++){var r=t[s],a=[r.id,r.opts,[]];n?(n[2].push(a),n=a):i=n=a}return i}function compareTree(t,e){return t[0]<e[0]?-1:1}function mergeTree(t,e){for(var i=[{tree1:t,tree2:e}],n=!1;i.length>0;){var s=i.pop(),o=s.tree1,r=s.tree2;(o[1].status||r[1].status)&&(o[1].status="available"===o[1].status||"available"===r[1].status?"available":"missing");for(var a=0;a<r[2].length;a++)if(o[2][0]){for(var l=!1,c=0;c<o[2].length;c++)o[2][c][0]===r[2][a][0]&&(i.push({tree1:o[2][c],tree2:r[2][a]}),l=!0);l||(n="new_branch",insertSorted(o[2],r[2][a],compareTree))}else n="new_leaf",o[2][0]=r[2][a]}return{conflicts:n,tree:t}}function doMerge(t,e,i){var n,s=[],o=!1,r=!1;if(!t.length)return{tree:[e],conflicts:"new_leaf"};for(var a=0,l=t.length;a<l;a++){var c=t[a];if(c.pos===e.pos&&c.ids[0]===e.ids[0])n=mergeTree(c.ids,e.ids),s.push({pos:c.pos,ids:n.tree}),o=o||n.conflicts,r=!0;else if(!0!==i){var h=c.pos<e.pos?c:e,d=c.pos<e.pos?e:c,u=[],m=[];for(m.push({ids:h.ids,diff:d.pos-h.pos,parent:null,parentIdx:null});m.length>0;){var p=m.pop();if(0!==p.diff)for(var b=p.ids[2],f=0,g=b.length;f<g;f++)m.push({ids:b[f],diff:p.diff-1,parent:p.ids,parentIdx:f});else p.ids[0]===d.ids[0]&&u.push(p)}var y=u[0];y?(n=mergeTree(y.ids,d.ids),y.parent[2][y.parentIdx]=n.tree,s.push({pos:h.pos,ids:h.ids}),o=o||n.conflicts,r=!0):s.push(c)}else s.push(c)}return r||s.push(e),s.sort(sortByPos$1),{tree:s,conflicts:o||"internal_node"}}function stem(t,e){for(var i,n,s=rootToLeaf(t),o=0,r=s.length;o<r;o++){var a,l=s[o],c=l.ids;if(c.length>e){i||(i={});var h=c.length-e;a={pos:l.pos+h,ids:pathToTree(c,h)};for(var d=0;d<h;d++)i[l.pos+d+"-"+c[d].id]=!0}else a={pos:l.pos,ids:pathToTree(c,0)};n=n?doMerge(n,a,!0).tree:[a]}return i&&traverseRevTree(n,(function(t,e,n){delete i[e+"-"+n]})),{tree:n,revs:i?Object.keys(i):[]}}function merge$1(t,e,i){var n=doMerge(t,e),s=stem(n.tree,i);return{tree:s.tree,stemmedRevs:s.revs,conflicts:n.conflicts}}function revExists(t,e){for(var i,n=t.slice(),s=e.split("-"),o=parseInt(s[0],10),r=s[1];i=n.pop();){if(i.pos===o&&i.ids[0]===r)return!0;for(var a=i.ids[2],l=0,c=a.length;l<c;l++)n.push({pos:i.pos+1,ids:a[l]})}return!1}function getTrees(t){return t.ids}function isDeleted(t,e){e||(e=winningRev(t));for(var i,n=e.substring(e.indexOf("-")+1),s=t.rev_tree.map(getTrees);i=s.pop();){if(i[0]===n)return!!i[1].deleted;s=s.concat(i[2])}}function isLocalId(t){return/^_local/.test(t)}function latest(t,e){for(var i,n=e.rev_tree.slice();i=n.pop();){var s=i.pos,o=i.ids,r=o[0],a=o[1],l=o[2],c=0===l.length,h=i.history?i.history.slice():[];if(h.push({id:r,pos:s,opts:a}),c)for(var d=0,u=h.length;d<u;d++){var m=h[d];if(m.pos+"-"+m.id===t)return s+"-"+r}for(var p=0,b=l.length;p<b;p++)n.push({pos:s+1,ids:l[p],history:h})}throw new Error("Unable to resolve latest revision for id "+e.id+", rev "+t)}function tryCatchInChangeListener(t,i,n,s){try{t.emit("change",i,n,s)}catch(e){guardedConsole("error",'Error in .on("change", function):',e)}}function Changes$1(t,e,i){EventEmitter.call(this);var n=this;this.db=t;var s=(e=e?clone$1(e):{}).complete=once((function(e,i){e?listenerCount$1(n,"error")>0&&n.emit("error",e):n.emit("complete",i),n.removeAllListeners(),t.removeListener("destroyed",o)}));function o(){n.cancel()}i&&(n.on("complete",(function(t){i(null,t)})),n.on("error",i)),t.once("destroyed",o),e.onChange=function(t,e,i){n.isCancelled||tryCatchInChangeListener(n,t,e,i)};var r=new Promise((function(t,i){e.complete=function(e,n){e?i(e):t(n)}}));n.once("cancel",(function(){t.removeListener("destroyed",o),e.complete(null,{status:"cancelled"})})),this.then=r.then.bind(r),this.catch=r.catch.bind(r),this.then((function(t){s(null,t)}),s),t.taskqueue.isReady?n.validateChanges(e):t.taskqueue.addTask((function(t){t?e.complete(t):n.isCancelled?n.emit("cancel"):n.validateChanges(e)}))}function processChange(t,e,i){var n=[{rev:t._rev}];"all_docs"===i.style&&(n=collectLeaves(e.rev_tree).map((function(t){return{rev:t.rev}})));var s={id:e.id,changes:n,doc:t};return isDeleted(e,t._rev)&&(s.deleted=!0),i.conflicts&&(s.doc._conflicts=collectConflicts(e),s.doc._conflicts.length||delete s.doc._conflicts),s}function compare(t,e){return t<e?-1:t>e?1:0}function yankError(t,e){return function(i,n){i||n[0]&&n[0].error?((i=i||n[0]).docId=e,t(i)):t(null,n.length?n[0]:n)}}function cleanDocs(t){for(var e=0;e<t.length;e++){var i=t[e];if(i._deleted)delete i._attachments;else if(i._attachments)for(var n=Object.keys(i._attachments),s=0;s<n.length;s++){var o=n[s];i._attachments[o]=pick(i._attachments[o],["data","digest","content_type","length","revpos","stub"])}}}function compareByIdThenRev(t,e){var i=compare(t._id,e._id);return 0!==i?i:compare(t._revisions?t._revisions.start:0,e._revisions?e._revisions.start:0)}function computeHeight(t){var e={},i=[];return traverseRevTree(t,(function(t,n,s,o){var r=n+"-"+s;return t&&(e[r]=0),void 0!==o&&i.push({from:o,to:r}),r})),i.reverse(),i.forEach((function(t){e[t.from]=void 0===e[t.from]?1+e[t.to]:Math.min(e[t.from],1+e[t.to])})),e}function allDocsKeysParse(t){var e="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;t.keys=e,t.skip=0,delete t.limit,t.descending&&(e.reverse(),t.descending=!1)}function doNextCompaction(t){var e=t._compactionQueue[0],i=e.opts,n=e.callback;t.get("_local/compaction").catch((function(){return!1})).then((function(e){e&&e.last_seq&&(i.last_seq=e.last_seq),t._compact(i,(function(e,i){e?n(e):n(null,i),browser$3((function(){t._compactionQueue.shift(),t._compactionQueue.length&&doNextCompaction(t)}))}))}))}function attachmentNameError(t){return"_"===t.charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'"}function AbstractPouchDB(){for(var t in EventEmitter.call(this),AbstractPouchDB.prototype)"function"==typeof this[t]&&(this[t]=this[t].bind(this))}function TaskQueue(){this.isReady=!1,this.failed=!1,this.queue=[]}function parseAdapter(t,e){var i=t.match(/([a-z-]*):\/\/(.*)/);if(i)return{name:/https?/.test(i[1])?i[1]+"://"+i[2]:i[2],adapter:i[1]};var n=PouchDB.adapters,s=PouchDB.preferredAdapters,o=PouchDB.prefix,r=e.adapter;if(!r)for(var a=0;a<s.length&&"idb"===(r=s[a])&&"websql"in n&&hasLocalStorage()&&localStorage["_pouch__websqldb_"+o+t];++a)guardedConsole("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var l=n[r];return{name:l&&"use_prefix"in l&&!l.use_prefix?t:o+t,adapter:r}}function prepareForDestruction(t){function e(e){t.removeListener("closed",i),e||t.constructor.emit("destroyed",t.name)}function i(){t.removeListener("destroyed",e),t.constructor.emit("unref",t)}t.once("destroyed",e),t.once("closed",i),t.constructor.emit("ref",t)}function PouchDB(t,e){if(!(this instanceof PouchDB))return new PouchDB(t,e);var i=this;if(e=e||{},t&&"object"==typeof t&&(t=(e=t).name,delete e.name),void 0===e.deterministic_revs&&(e.deterministic_revs=!0),this.__opts=e=clone$1(e),i.auto_compaction=e.auto_compaction,i.prefix=PouchDB.prefix,"string"!=typeof t)throw new Error("Missing/invalid DB name");var n=parseAdapter((e.prefix||"")+t,e);if(e.name=n.name,e.adapter=e.adapter||n.adapter,i.name=t,i._adapter=e.adapter,PouchDB.emit("debug",["adapter","Picked adapter: ",e.adapter]),!PouchDB.adapters[e.adapter]||!PouchDB.adapters[e.adapter].valid())throw new Error("Invalid Adapter: "+e.adapter);AbstractPouchDB.call(i),i.taskqueue=new TaskQueue,i.adapter=e.adapter,PouchDB.adapters[e.adapter].call(i,e,(function(t){if(t)return i.taskqueue.fail(t);prepareForDestruction(i),i.emit("created",i),PouchDB.emit("created",i.name),i.taskqueue.ready(i)}))}inherits_browser(Changes$1,EventEmitter),Changes$1.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Changes$1.prototype.validateChanges=function(t){var e=t.complete,i=this;PouchDB._changesFilterPlugin?PouchDB._changesFilterPlugin.validate(t,(function(n){if(n)return e(n);i.doChanges(t)})):i.doChanges(t)},Changes$1.prototype.doChanges=function(t){var e=this,i=t.complete;if("live"in(t=clone$1(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=processChange,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(PouchDB._changesFilterPlugin){if(PouchDB._changesFilterPlugin.normalize(t),PouchDB._changesFilterPlugin.shouldFilter(this,t))return PouchDB._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach((function(e){e in t&&guardedConsole("warn",'The "'+e+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')}));"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=i;var n=this.db._changes(t);if(n&&"function"==typeof n.cancel){var s=e.cancel;e.cancel=argsarray((function(t){n.cancel(),s.apply(this,t)}))}}else this.db.info().then((function(n){e.isCancelled?i(null,{status:"cancelled"}):(t.since=n.update_seq,e.doChanges(t))}),i)},inherits_browser(AbstractPouchDB,EventEmitter),AbstractPouchDB.prototype.post=adapterFun("post",(function(t,e,i){if("function"==typeof e&&(i=e,e={}),"object"!=typeof t||Array.isArray(t))return i(createError(NOT_AN_OBJECT));this.bulkDocs({docs:[t]},e,yankError(i,t._id))})),AbstractPouchDB.prototype.put=adapterFun("put",(function(t,e,i){if("function"==typeof e&&(i=e,e={}),"object"!=typeof t||Array.isArray(t))return i(createError(NOT_AN_OBJECT));if(invalidIdError(t._id),isLocalId(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,i):this._putLocal(t,i);var n=this;function s(i){"function"==typeof n._put&&!1!==e.new_edits?n._put(t,e,i):n.bulkDocs({docs:[t]},e,yankError(i,t._id))}e.force&&t._rev?(function(){var i=t._rev.split("-"),n=i[1],s=parseInt(i[0],10)+1,o=rev();t._revisions={start:s,ids:[o,n]},t._rev=s+"-"+o,e.new_edits=!1}(),s((function(e){i(e,e?null:{ok:!0,id:t._id,rev:t._rev})}))):s(i)})),AbstractPouchDB.prototype.putAttachment=adapterFun("putAttachment",(function(t,e,i,n,s){var o=this;function r(t){var i="_rev"in t?parseInt(t._rev,10):0;return t._attachments=t._attachments||{},t._attachments[e]={content_type:s,data:n,revpos:++i},o.put(t)}return"function"==typeof s&&(s=n,n=i,i=null),void 0===s&&(s=n,n=i,i=null),s||guardedConsole("warn","Attachment",e,"on document",t,"is missing content_type"),o.get(t).then((function(t){if(t._rev!==i)throw createError(REV_CONFLICT);return r(t)}),(function(e){if(e.reason===MISSING_DOC.message)return r({_id:t});throw e}))})),AbstractPouchDB.prototype.removeAttachment=adapterFun("removeAttachment",(function(t,e,i,n){var s=this;s.get(t,(function(t,o){if(t)n(t);else if(o._rev===i){if(!o._attachments)return n();delete o._attachments[e],0===Object.keys(o._attachments).length&&delete o._attachments,s.put(o,n)}else n(createError(REV_CONFLICT))}))})),AbstractPouchDB.prototype.remove=adapterFun("remove",(function(t,e,i,n){var s;"string"==typeof e?(s={_id:t,_rev:e},"function"==typeof i&&(n=i,i={})):(s=t,"function"==typeof e?(n=e,i={}):(n=i,i=e)),(i=i||{}).was_delete=!0;var o={_id:s._id,_rev:s._rev||i.rev,_deleted:!0};if(isLocalId(o._id)&&"function"==typeof this._removeLocal)return this._removeLocal(s,n);this.bulkDocs({docs:[o]},i,yankError(n,o._id))})),AbstractPouchDB.prototype.revsDiff=adapterFun("revsDiff",(function(t,e,i){"function"==typeof e&&(i=e,e={});var n=Object.keys(t);if(!n.length)return i(null,{});var s=0,o=new ExportedMap;function r(t,e){o.has(t)||o.set(t,{missing:[]}),o.get(t).missing.push(e)}n.map((function(e){this._getRevisionTree(e,(function(a,l){if(a&&404===a.status&&"missing"===a.message)o.set(e,{missing:t[e]});else{if(a)return i(a);!function(e,i){var n=t[e].slice(0);traverseRevTree(i,(function(t,i,s,o,a){var l=i+"-"+s,c=n.indexOf(l);-1!==c&&(n.splice(c,1),"available"!==a.status&&r(e,l))})),n.forEach((function(t){r(e,t)}))}(e,l)}if(++s===n.length){var c={};return o.forEach((function(t,e){c[e]=t})),i(null,c)}}))}),this)})),AbstractPouchDB.prototype.bulkGet=adapterFun("bulkGet",(function(t,e){bulkGet(this,t,e)})),AbstractPouchDB.prototype.compactDocument=adapterFun("compactDocument",(function(t,e,i){var n=this;this._getRevisionTree(t,(function(s,o){if(s)return i(s);var r=computeHeight(o),a=[],l=[];Object.keys(r).forEach((function(t){r[t]>e&&a.push(t)})),traverseRevTree(o,(function(t,e,i,n,s){var o=e+"-"+i;"available"===s.status&&-1!==a.indexOf(o)&&l.push(o)})),n._doCompaction(t,l,i)}))})),AbstractPouchDB.prototype.compact=adapterFun("compact",(function(t,e){"function"==typeof t&&(e=t,t={}),t=t||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:t,callback:e}),1===this._compactionQueue.length&&doNextCompaction(this)})),AbstractPouchDB.prototype._compact=function(t,e){var i=this,n=[];i.changes({return_docs:!1,last_seq:t.last_seq||0}).on("change",(function(t){n.push(i.compactDocument(t.id,0))})).on("complete",(function(t){var s=t.last_seq;Promise.all(n).then((function(){return upsert(i,"_local/compaction",(function(t){return(!t.last_seq||t.last_seq<s)&&(t.last_seq=s,t)}))})).then((function(){e(null,{ok:!0})})).catch(e)})).on("error",e)},AbstractPouchDB.prototype.get=adapterFun("get",(function(t,e,i){if("function"==typeof e&&(i=e,e={}),"string"!=typeof t)return i(createError(INVALID_ID));if(isLocalId(t)&&"function"==typeof this._getLocal)return this._getLocal(t,i);var n=[],s=this;function o(){var o=[],r=n.length;if(!r)return i(null,o);n.forEach((function(n){s.get(t,{rev:n,revs:e.revs,latest:e.latest,attachments:e.attachments,binary:e.binary},(function(t,e){if(t)o.push({missing:n});else{for(var s,a=0,l=o.length;a<l;a++)if(o[a].ok&&o[a].ok._rev===e._rev){s=!0;break}s||o.push({ok:e})}--r||i(null,o)}))}))}if(!e.open_revs)return this._get(t,e,(function(n,o){if(n)return n.docId=t,i(n);var r=o.doc,a=o.metadata,l=o.ctx;if(e.conflicts){var c=collectConflicts(a);c.length&&(r._conflicts=c)}if(isDeleted(a,r._rev)&&(r._deleted=!0),e.revs||e.revs_info){for(var h=r._rev.split("-"),d=parseInt(h[0],10),u=h[1],m=rootToLeaf(a.rev_tree),p=null,b=0;b<m.length;b++){var f=m[b],g=f.ids.map((function(t){return t.id})).indexOf(u);(g===d-1||!p&&-1!==g)&&(p=f)}if(!p)return(n=new Error("invalid rev tree")).docId=t,i(n);var y=p.ids.map((function(t){return t.id})).indexOf(r._rev.split("-")[1])+1;if(p.ids.splice(y,p.ids.length-y),p.ids.reverse(),e.revs&&(r._revisions={start:p.pos+p.ids.length-1,ids:p.ids.map((function(t){return t.id}))}),e.revs_info){var v=p.pos+p.ids.length;r._revs_info=p.ids.map((function(t){return{rev:--v+"-"+t.id,status:t.opts.status}}))}}if(e.attachments&&r._attachments){var Z=r._attachments,x=Object.keys(Z).length;if(0===x)return i(null,r);Object.keys(Z).forEach((function(t){this._getAttachment(r._id,t,Z[t],{rev:r._rev,binary:e.binary,ctx:l},(function(e,n){var s=r._attachments[t];s.data=n,delete s.stub,delete s.length,--x||i(null,r)}))}),s)}else{if(r._attachments)for(var G in r._attachments)r._attachments.hasOwnProperty(G)&&(r._attachments[G].stub=!0);i(null,r)}}));if("all"===e.open_revs)this._getRevisionTree(t,(function(t,e){if(t)return i(t);n=collectLeaves(e).map((function(t){return t.rev})),o()}));else{if(!Array.isArray(e.open_revs))return i(createError(UNKNOWN_ERROR,"function_clause"));n=e.open_revs;for(var r=0;r<n.length;r++){var a=n[r];if("string"!=typeof a||!/^\d+-/.test(a))return i(createError(INVALID_REV))}o()}})),AbstractPouchDB.prototype.getAttachment=adapterFun("getAttachment",(function(t,e,i,n){var s=this;i instanceof Function&&(n=i,i={}),this._get(t,i,(function(o,r){return o?n(o):r.doc._attachments&&r.doc._attachments[e]?(i.ctx=r.ctx,i.binary=!0,void s._getAttachment(t,e,r.doc._attachments[e],i,n)):n(createError(MISSING_DOC))}))})),AbstractPouchDB.prototype.allDocs=adapterFun("allDocs",(function(t,e){if("function"==typeof t&&(e=t,t={}),t.skip=void 0!==t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return e(new TypeError("options.keys must be an array"));var i=["startkey","endkey","key"].filter((function(e){return e in t}))[0];if(i)return void e(createError(QUERY_PARSE_ERROR,"Query parameter `"+i+"` is not compatible with multi-get"));if(!isRemote(this)&&(allDocsKeysParse(t),0===t.keys.length))return this._allDocs({limit:0},e)}return this._allDocs(t,e)})),AbstractPouchDB.prototype.changes=function(t,e){return"function"==typeof t&&(e=t,t={}),(t=t||{}).return_docs="return_docs"in t?t.return_docs:!t.live,new Changes$1(this,t,e)},AbstractPouchDB.prototype.close=adapterFun("close",(function(t){return this._closed=!0,this.emit("closed"),this._close(t)})),AbstractPouchDB.prototype.info=adapterFun("info",(function(t){var e=this;this._info((function(i,n){if(i)return t(i);n.db_name=n.db_name||e.name,n.auto_compaction=!(!e.auto_compaction||isRemote(e)),n.adapter=e.adapter,t(null,n)}))})),AbstractPouchDB.prototype.id=adapterFun("id",(function(t){return this._id(t)})),AbstractPouchDB.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},AbstractPouchDB.prototype.bulkDocs=adapterFun("bulkDocs",(function(t,e,i){if("function"==typeof e&&(i=e,e={}),e=e||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return i(createError(MISSING_BULK_DOCS));for(var n=0;n<t.docs.length;++n)if("object"!=typeof t.docs[n]||Array.isArray(t.docs[n]))return i(createError(NOT_AN_OBJECT));var s;if(t.docs.forEach((function(t){t._attachments&&Object.keys(t._attachments).forEach((function(e){s=s||attachmentNameError(e),t._attachments[e].content_type||guardedConsole("warn","Attachment",e,"on document",t._id,"is missing content_type")}))})),s)return i(createError(BAD_REQUEST,s));"new_edits"in e||(e.new_edits=!("new_edits"in t)||t.new_edits);var o=this;e.new_edits||isRemote(o)||t.docs.sort(compareByIdThenRev),cleanDocs(t.docs);var r=t.docs.map((function(t){return t._id}));return this._bulkDocs(t,e,(function(t,n){if(t)return i(t);if(e.new_edits||(n=n.filter((function(t){return t.error}))),!isRemote(o))for(var s=0,a=n.length;s<a;s++)n[s].id=n[s].id||r[s];i(null,n)}))})),AbstractPouchDB.prototype.registerDependentDatabase=adapterFun("registerDependentDatabase",(function(t,e){var i=new this.constructor(t,this.__opts);upsert(this,"_local/_pouch_dependentDbs",(function(e){return e.dependentDbs=e.dependentDbs||{},!e.dependentDbs[t]&&(e.dependentDbs[t]=!0,e)})).then((function(){e(null,{db:i})})).catch(e)})),AbstractPouchDB.prototype.destroy=adapterFun("destroy",(function(t,e){"function"==typeof t&&(e=t,t={});var i=this,n=!("use_prefix"in i)||i.use_prefix;function s(){i._destroy(t,(function(t,n){if(t)return e(t);i._destroyed=!0,i.emit("destroyed"),e(null,n||{ok:!0})}))}if(isRemote(i))return s();i.get("_local/_pouch_dependentDbs",(function(t,o){if(t)return 404!==t.status?e(t):s();var r=i.constructor,a=Object.keys(o.dependentDbs).map((function(t){var e=n?t.replace(new RegExp("^"+r.prefix),""):t;return new r(e,i.__opts).destroy()}));Promise.all(a).then(s,e)}))})),TaskQueue.prototype.execute=function(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()},TaskQueue.prototype.fail=function(t){this.failed=t,this.execute()},TaskQueue.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},TaskQueue.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},inherits_browser(PouchDB,AbstractPouchDB);var a="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},f$1=fetch,h$3=Headers;PouchDB.adapters={},PouchDB.preferredAdapters=[],PouchDB.prefix="_pouch_";var eventEmitter=new EventEmitter;function setUpEventEmitter(t){Object.keys(EventEmitter.prototype).forEach((function(e){"function"==typeof EventEmitter.prototype[e]&&(t[e]=eventEmitter[e].bind(eventEmitter))}));var e=t._destructionListeners=new ExportedMap;t.on("ref",(function(t){e.has(t.name)||e.set(t.name,[]),e.get(t.name).push(t)})),t.on("unref",(function(t){if(e.has(t.name)){var i=e.get(t.name),n=i.indexOf(t);n<0||(i.splice(n,1),i.length>1?e.set(t.name,i):e.delete(t.name))}})),t.on("destroyed",(function(t){if(e.has(t)){var i=e.get(t);e.delete(t),i.forEach((function(t){t.emit("destroyed",!0)}))}}))}setUpEventEmitter(PouchDB),PouchDB.adapter=function(t,e,i){e.valid()&&(PouchDB.adapters[t]=e,i&&PouchDB.preferredAdapters.push(t))},PouchDB.plugin=function(t){if("function"==typeof t)t(PouchDB);else{if("object"!=typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach((function(e){PouchDB.prototype[e]=t[e]}))}return this.__defaults&&(PouchDB.__defaults=$inject_Object_assign({},this.__defaults)),PouchDB},PouchDB.defaults=function(t){function e(t,i){if(!(this instanceof e))return new e(t,i);i=i||{},t&&"object"==typeof t&&(t=(i=t).name,delete i.name),i=$inject_Object_assign({},e.__defaults,i),PouchDB.call(this,t,i)}return inherits_browser(e,PouchDB),e.preferredAdapters=PouchDB.preferredAdapters.slice(),Object.keys(PouchDB).forEach((function(t){t in e||(e[t]=PouchDB[t])})),e.__defaults=$inject_Object_assign({},this.__defaults,t),e},PouchDB.fetch=function(t,e){return f$1(t,e)};var version="7.2.1";function getFieldFromDoc(t,e){for(var i=t,n=0,s=e.length;n<s&&(i=i[e[n]]);n++);return i}function compare$1(t,e){return t<e?-1:t>e?1:0}function parseField(t){for(var e=[],i="",n=0,s=t.length;n<s;n++){var o=t[n];"."===o?n>0&&"\\"===t[n-1]?i=i.substring(0,i.length-1)+".":(e.push(i),i=""):i+=o}return e.push(i),e}var combinationFields=["$or","$nor","$not"];function isCombinationalField(t){return combinationFields.indexOf(t)>-1}function getKey(t){return Object.keys(t)[0]}function getValue$1(t){return t[getKey(t)]}function mergeAndedSelectors(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(i){var n=t[i];if("object"!=typeof n&&(n={$eq:n}),isCombinationalField(i))e[i]=n instanceof Array?n.map((function(t){return mergeAndedSelectors([t])})):mergeAndedSelectors([n]);else{var s=e[i]=e[i]||{};Object.keys(n).forEach((function(t){var e=n[t];return"$gt"===t||"$gte"===t?mergeGtGte(t,e,s):"$lt"===t||"$lte"===t?mergeLtLte(t,e,s):"$ne"===t?mergeNe(e,s):"$eq"===t?mergeEq(e,s):void(s[t]=e)}))}}))})),e}function mergeGtGte(t,e,i){void 0===i.$eq&&(void 0!==i.$gte?"$gte"===t?e>i.$gte&&(i.$gte=e):e>=i.$gte&&(delete i.$gte,i.$gt=e):void 0!==i.$gt?"$gte"===t?e>i.$gt&&(delete i.$gt,i.$gte=e):e>i.$gt&&(i.$gt=e):i[t]=e)}function mergeLtLte(t,e,i){void 0===i.$eq&&(void 0!==i.$lte?"$lte"===t?e<i.$lte&&(i.$lte=e):e<=i.$lte&&(delete i.$lte,i.$lt=e):void 0!==i.$lt?"$lte"===t?e<i.$lt&&(delete i.$lt,i.$lte=e):e<i.$lt&&(i.$lt=e):i[t]=e)}function mergeNe(t,e){"$ne"in e?e.$ne.push(t):e.$ne=[t]}function mergeEq(t,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=t}function mergeAndedSelectorsNested(t){for(var e in t){if(Array.isArray(t))for(var i in t)t[i].$and&&(t[i]=mergeAndedSelectors(t[i].$and));var n=t[e];"object"==typeof n&&mergeAndedSelectorsNested(n)}return t}function isAndInSelector(t,e){for(var i in t){"$and"===i&&(e=!0);var n=t[i];"object"==typeof n&&(e=isAndInSelector(n,e))}return e}function massageSelector(t){var e=clone$1(t),i=!1;isAndInSelector(e,!1)&&("$and"in(e=mergeAndedSelectorsNested(e))&&(e=mergeAndedSelectors(e.$and)),i=!0),["$or","$nor"].forEach((function(t){t in e&&e[t].forEach((function(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i],s=t[n];"object"==typeof s&&null!==s||(t[n]={$eq:s})}}))})),"$not"in e&&(e.$not=mergeAndedSelectors([e.$not]));for(var n=Object.keys(e),s=0;s<n.length;s++){var o=n[s],r=e[o];"object"!=typeof r||null===r?r={$eq:r}:"$ne"in r&&!i&&(r.$ne=[r.$ne]),e[o]=r}return e}function pad(t,e,i){for(var n="",s=i-t.length;n.length<s;)n+=e;return n}function padLeft(t,e,i){return pad(t,e,i)+t}var MIN_MAGNITUDE=-324,MAGNITUDE_DIGITS=3,SEP="";function collate(t,e){if(t===e)return 0;t=normalizeKey(t),e=normalizeKey(e);var i=collationIndex(t),n=collationIndex(e);if(i-n!=0)return i-n;switch(typeof t){case"number":return t-e;case"boolean":return t<e?-1:1;case"string":return stringCollate(t,e)}return Array.isArray(t)?arrayCollate(t,e):objectCollate(t,e)}function normalizeKey(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var e=t;if(Array.isArray(t)){var i=t.length;t=new Array(i);for(var n=0;n<i;n++)t[n]=normalizeKey(e[n])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var s in t={},e)if(e.hasOwnProperty(s)){var o=e[s];void 0!==o&&(t[s]=normalizeKey(o))}}}return t}function indexify(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return numToIndexableString(t);case"string":return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(t),i=e?t:Object.keys(t),n=-1,s=i.length,o="";if(e)for(;++n<s;)o+=toIndexableString(i[n]);else for(;++n<s;){var r=i[n];o+=toIndexableString(r)+toIndexableString(t[r])}return o}return""}function toIndexableString(t){return collationIndex(t=normalizeKey(t))+SEP+indexify(t)+"\0"}function parseNumber(t,e){var i,n=e;if("1"===t[e])i=0,e++;else{var s="0"===t[e];e++;var o="",r=t.substring(e,e+MAGNITUDE_DIGITS),a=parseInt(r,10)+MIN_MAGNITUDE;for(s&&(a=-a),e+=MAGNITUDE_DIGITS;;){var l=t[e];if("\0"===l)break;o+=l,e++}i=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),s&&(i-=10),0!==a&&(i=parseFloat(i+"e"+a))}return{num:i,length:e-n}}function pop$1(t,e){var i=t.pop();if(e.length){var n=e[e.length-1];i===n.element&&(e.pop(),n=e[e.length-1]);var s=n.element,o=n.index;Array.isArray(s)?s.push(i):o===t.length-2?s[t.pop()]=i:t.push(i)}}function parseIndexableString(t){for(var e=[],i=[],n=0;;){var s=t[n++];if("\0"!==s)switch(s){case"1":e.push(null);break;case"2":e.push("1"===t[n]),n++;break;case"3":var o=parseNumber(t,n);e.push(o.num),n+=o.length;break;case"4":for(var r="";;){var a=t[n];if("\0"===a)break;r+=a,n++}r=r.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(r);break;case"5":var l={element:[],index:e.length};e.push(l.element),i.push(l);break;case"6":var c={element:{},index:e.length};e.push(c.element),i.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+s)}else{if(1===e.length)return e.pop();pop$1(e,i)}}}function arrayCollate(t,e){for(var i=Math.min(t.length,e.length),n=0;n<i;n++){var s=collate(t[n],e[n]);if(0!==s)return s}return t.length===e.length?0:t.length>e.length?1:-1}function stringCollate(t,e){return t===e?0:t>e?1:-1}function objectCollate(t,e){for(var i=Object.keys(t),n=Object.keys(e),s=Math.min(i.length,n.length),o=0;o<s;o++){var r=collate(i[o],n[o]);if(0!==r)return r;if(0!==(r=collate(t[i[o]],e[n[o]])))return r}return i.length===n.length?0:i.length>n.length?1:-1}function collationIndex(t){var e=["boolean","number","string","object"].indexOf(typeof t);return~e?null===t?1:Array.isArray(t)?5:e<3?e+2:e+3:Array.isArray(t)?5:void 0}function numToIndexableString(t){if(0===t)return"1";var e=t.toExponential().split(/e\+?/),i=parseInt(e[1],10),n=t<0,s=n?"0":"2",o=padLeft(((n?-i:i)-MIN_MAGNITUDE).toString(),"0",MAGNITUDE_DIGITS);s+=SEP+o;var r=Math.abs(parseFloat(e[0]));n&&(r=10-r);var a=r.toFixed(20);return a=a.replace(/\.?0+$/,""),s+(SEP+a)}function createFieldSorter(t){function e(e){return t.map((function(t){var i=parseField(getKey(t));return getFieldFromDoc(e,i)}))}return function(t,i){var n=collate(e(t.doc),e(i.doc));return 0!==n?n:compare$1(t.doc._id,i.doc._id)}}function filterInMemoryFields(t,e,i){if(t=t.filter((function(t){return rowFilter(t.doc,e.selector,i)})),e.sort){var n=createFieldSorter(e.sort);t=t.sort(n),"string"!=typeof e.sort[0]&&"desc"===getValue$1(e.sort[0])&&(t=t.reverse())}if("limit"in e||"skip"in e){var s=e.skip||0;t=t.slice(s,("limit"in e?e.limit:t.length)+s)}return t}function rowFilter(t,e,i){return i.every((function(i){var n=e[i],s=parseField(i),o=getFieldFromDoc(t,s);return isCombinationalField(i)?matchCominationalSelector(i,n,t):matchSelector(n,t,s,o)}))}function matchSelector(t,e,i,n){return!t||("object"==typeof t?Object.keys(t).every((function(s){return match(s,e,t[s],i,n)})):t===n)}function matchCominationalSelector(t,e,i){return"$or"===t?e.some((function(t){return rowFilter(i,t,Object.keys(t))})):"$not"===t?!rowFilter(i,e,Object.keys(e)):!e.find((function(t){return rowFilter(i,t,Object.keys(t))}))}function match(t,e,i,n,s){if(!matchers[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return matchers[t](e,i,n,s)}function fieldExists(t){return null!=t}function fieldIsNotUndefined(t){return void 0!==t}function modField(t,e){var i=e[0],n=e[1];if(0===i)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(i,10)!==i)throw new Error("Divisor is not an integer");if(parseInt(n,10)!==n)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%i===n}function arrayContainsValue(t,e){return e.some((function(e){return t instanceof Array?t.indexOf(e)>-1:t===e}))}function arrayContainsAllValues(t,e){return e.every((function(e){return t.indexOf(e)>-1}))}function arraySize(t,e){return t.length===e}function regexMatch(t,e){return new RegExp(e).test(t)}function typeMatch(t,e){switch(e){case"null":return null===t;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t;case"string":return"string"==typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(e+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var matchers={$elemMatch:function(t,e,i,n){return!!Array.isArray(n)&&0!==n.length&&n.some("object"==typeof n[0]?function(t){return rowFilter(t,e,Object.keys(e))}:function(n){return matchSelector(e,t,i,n)})},$allMatch:function(t,e,i,n){return!!Array.isArray(n)&&0!==n.length&&n.every("object"==typeof n[0]?function(t){return rowFilter(t,e,Object.keys(e))}:function(n){return matchSelector(e,t,i,n)})},$eq:function(t,e,i,n){return fieldIsNotUndefined(n)&&0===collate(n,e)},$gte:function(t,e,i,n){return fieldIsNotUndefined(n)&&collate(n,e)>=0},$gt:function(t,e,i,n){return fieldIsNotUndefined(n)&&collate(n,e)>0},$lte:function(t,e,i,n){return fieldIsNotUndefined(n)&&collate(n,e)<=0},$lt:function(t,e,i,n){return fieldIsNotUndefined(n)&&collate(n,e)<0},$exists:function(t,e,i,n){return e?fieldIsNotUndefined(n):!fieldIsNotUndefined(n)},$mod:function(t,e,i,n){return fieldExists(n)&&modField(n,e)},$ne:function(t,e,i,n){return e.every((function(t){return 0!==collate(n,t)}))},$in:function(t,e,i,n){return fieldExists(n)&&arrayContainsValue(n,e)},$nin:function(t,e,i,n){return fieldExists(n)&&!arrayContainsValue(n,e)},$size:function(t,e,i,n){return fieldExists(n)&&arraySize(n,e)},$all:function(t,e,i,n){return Array.isArray(n)&&arrayContainsAllValues(n,e)},$regex:function(t,e,i,n){return fieldExists(n)&&regexMatch(n,e)},$type:function(t,e,i,n){return typeMatch(n,e)}};function matchesSelector(t,e){if("object"!=typeof e)throw new Error("Selector error: expected a JSON object");var i=filterInMemoryFields([{doc:t}],{selector:e=massageSelector(e)},Object.keys(e));return i&&1===i.length}function evalFilter(t){return scopeEval('"use strict";\nreturn '+t+";",{})}function evalView(t){return scopeEval(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+t+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}function validate(t,e){if(t.selector&&t.filter&&"_selector"!==t.filter)return e(new Error('selector invalid for filter "'+("string"==typeof t.filter?t.filter:"function")+'"'));e()}function normalize(t){t.view&&!t.filter&&(t.filter="_view"),t.selector&&!t.filter&&(t.filter="_selector"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=normalizeDesignDocFunctionName(t.view):t.filter=normalizeDesignDocFunctionName(t.filter))}function shouldFilter(t,e){return e.filter&&"string"==typeof e.filter&&!e.doc_ids&&!isRemote(t.db)}function filter(t,e){var i=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var n=createError(BAD_REQUEST,"`view` filter parameter not found or invalid.");return i(n)}var s=parseDesignDocFunctionName(e.view);t.db.get("_design/"+s[0],(function(n,o){if(t.isCancelled)return i(null,{status:"cancelled"});if(n)return i(generateErrorFromResponse(n));var r=o&&o.views&&o.views[s[1]]&&o.views[s[1]].map;if(!r)return i(createError(MISSING_DOC,o.views?"missing json key: "+s[1]:"missing json key: views"));e.filter=evalView(r),t.doChanges(e)}))}else if(e.selector)e.filter=function(t){return matchesSelector(t,e.selector)},t.doChanges(e);else{var o=parseDesignDocFunctionName(e.filter);t.db.get("_design/"+o[0],(function(n,s){if(t.isCancelled)return i(null,{status:"cancelled"});if(n)return i(generateErrorFromResponse(n));var r=s&&s.filters&&s.filters[o[1]];if(!r)return i(createError(MISSING_DOC,s&&s.filters?"missing json key: "+o[1]:"missing json key: filters"));e.filter=evalFilter(r),t.doChanges(e)}))}}function applyChangesFilterPlugin(t){t._changesFilterPlugin={validate,normalize,shouldFilter,filter}}function toObject(t){return t.reduce((function(t,e){return t[e]=!0,t}),{})}PouchDB.plugin(applyChangesFilterPlugin),PouchDB.version=version;var reservedWords=toObject(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),dataWords=toObject(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function parseRevisionInfo(t){if(!/^\d+-/.test(t))return createError(INVALID_REV);var e=t.indexOf("-"),i=t.substring(0,e),n=t.substring(e+1);return{prefix:parseInt(i,10),id:n}}function makeRevTreeFromRevisions(t,e){for(var i=t.start-t.ids.length+1,n=t.ids,s=[n[0],e,[]],o=1,r=n.length;o<r;o++)s=[n[o],{status:"missing"},[s]];return[{pos:i,ids:s}]}function parseDoc(t,e,i){var n,s,o;i||(i={deterministic_revs:!0});var r={status:"available"};if(t._deleted&&(r.deleted=!0),e)if(t._id||(t._id=uuid$1()),s=rev(t,i.deterministic_revs),t._rev){if((o=parseRevisionInfo(t._rev)).error)return o;t._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[s,r,[]]]]}],n=o.prefix+1}else t._rev_tree=[{pos:1,ids:[s,r,[]]}],n=1;else if(t._revisions&&(t._rev_tree=makeRevTreeFromRevisions(t._revisions,r),n=t._revisions.start,s=t._revisions.ids[0]),!t._rev_tree){if((o=parseRevisionInfo(t._rev)).error)return o;t._rev_tree=[{pos:n=o.prefix,ids:[s=o.id,r,[]]}]}invalidIdError(t._id),t._rev=n+"-"+s;var a={metadata:{},data:{}};for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var c="_"===l[0];if(c&&!reservedWords[l]){var h=createError(DOC_VALIDATION,l);throw h.message=DOC_VALIDATION.message+": "+l,h}c&&!dataWords[l]?a.metadata[l.slice(1)]=t[l]:a.data[l]=t[l]}return a}function parseBase64(t){try{return thisAtob(t)}catch(e){return{error:createError(BAD_ARG,"Attachment is not a valid base64 string")}}}function preprocessString(t,e,i){var n=parseBase64(t.data);if(n.error)return i(n.error);t.length=n.length,t.data="blob"===e?binStringToBluffer(n,t.content_type):"base64"===e?thisBtoa(n):n,binaryMd5(n,(function(e){t.digest="md5-"+e,i()}))}function preprocessBlob(t,e,i){binaryMd5(t.data,(function(n){t.digest="md5-"+n,t.length=t.data.size||t.data.length||0,"binary"===e?blobToBinaryString(t.data,(function(e){t.data=e,i()})):"base64"===e?blobToBase64(t.data,(function(e){t.data=e,i()})):i()}))}function preprocessAttachment(t,e,i){if(t.stub)return i();"string"==typeof t.data?preprocessString(t,e,i):preprocessBlob(t,e,i)}function preprocessAttachments(t,e,i){if(!t.length)return i();var n,s=0;function o(){s++,t.length===s&&(n?i(n):i())}t.forEach((function(t){var i=t.data&&t.data._attachments?Object.keys(t.data._attachments):[],s=0;if(!i.length)return o();function r(t){n=t,++s===i.length&&o()}for(var a in t.data._attachments)t.data._attachments.hasOwnProperty(a)&&preprocessAttachment(t.data._attachments[a],e,r)}))}function updateDoc(t,e,i,n,s,o,r,a){if(revExists(e.rev_tree,i.metadata.rev)&&!a)return n[s]=i,o();var l=e.winningRev||winningRev(e),c="deleted"in e?e.deleted:isDeleted(e,l),h="deleted"in i.metadata?i.metadata.deleted:isDeleted(i.metadata),d=/^1-/.test(i.metadata.rev);if(c&&!h&&a&&d){var u=i.data;u._rev=l,u._id=i.metadata.id,i=parseDoc(u,a)}var m=merge$1(e.rev_tree,i.metadata.rev_tree[0],t);if(a&&(c&&h&&"new_leaf"!==m.conflicts||!c&&"new_leaf"!==m.conflicts||c&&!h&&"new_branch"===m.conflicts)){var p=createError(REV_CONFLICT);return n[s]=p,o()}var b=i.metadata.rev;i.metadata.rev_tree=m.tree,i.stemmedRevs=m.stemmedRevs||[],e.rev_map&&(i.metadata.rev_map=e.rev_map);var f=winningRev(i.metadata),g=isDeleted(i.metadata,f),y=c===g?0:c<g?-1:1;r(i,f,g,b===f?g:isDeleted(i.metadata,b),!0,y,s,o)}function rootIsMissing(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}function processDocs(t,e,i,n,s,o,r,a,l){t=t||1e3;var c=a.new_edits,h=new ExportedMap,d=0,u=e.length;function m(){++d===u&&l&&l()}e.forEach((function(t,e){if(t._id&&isLocalId(t._id))i[t._deleted?"_removeLocal":"_putLocal"](t,{ctx:s},(function(t,i){o[e]=t||i,m()}));else{var n=t.metadata.id;h.has(n)?(u--,h.get(n).push([t,e])):h.set(n,[[t,e]])}})),h.forEach((function(e,i){var s=0;function l(){++s<e.length?h():m()}function h(){var h=e[s],d=h[0],u=h[1];if(n.has(i))updateDoc(t,n.get(i),d,o,u,l,r,c);else{var m=merge$1([],d.metadata.rev_tree[0],t);d.metadata.rev_tree=m.tree,d.stemmedRevs=m.stemmedRevs||[],function(t,e,i){var n=winningRev(t.metadata),s=isDeleted(t.metadata,n);if("was_delete"in a&&s)return o[e]=createError(MISSING_DOC,"deleted"),i();if(c&&rootIsMissing(t)){var l=createError(REV_CONFLICT);return o[e]=l,i()}r(t,n,s,s,!1,s?0:1,e,i)}(d,u,l)}}h()}))}var ADAPTER_VERSION=5,DOC_STORE="document-store",BY_SEQ_STORE="by-sequence",ATTACH_STORE="attach-store",ATTACH_AND_SEQ_STORE="attach-seq-store",META_STORE="meta-store",LOCAL_STORE="local-store",DETECT_BLOB_SUPPORT_STORE="detect-blob-support";function safeJsonParse(t){try{return JSON.parse(t)}catch(e){return vuvuzela.parse(t)}}function safeJsonStringify(t){try{return JSON.stringify(t)}catch(e){return vuvuzela.stringify(t)}}function idbError(t){return function(e){var i="unknown_error";e.target&&e.target.error&&(i=e.target.error.name||e.target.error.message),t(createError(IDB_ERROR,i))}}function encodeMetadata(t,e,i){return{data:safeJsonStringify(t),winningRev:e,deletedOrLocal:i?"1":"0",seq:t.seq,id:t.id}}function decodeMetadata(t){if(!t)return null;var e=safeJsonParse(t.data);return e.winningRev=t.winningRev,e.deleted="1"===t.deletedOrLocal,e.seq=t.seq,e}function decodeDoc(t){if(!t)return t;var e=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,e-1),t._rev=t._doc_id_rev.substring(e+1),delete t._doc_id_rev,t}function readBlobData(t,e,i,n){i?n(t?"string"!=typeof t?t:b64ToBluffer(t,e):createBlob([""],{type:e})):t?"string"!=typeof t?readAsBinaryString(t,(function(t){n(thisBtoa(t))})):n(t):n("")}function fetchAttachmentsIfNecessary(t,e,i,n){var s=Object.keys(t._attachments||{});if(!s.length)return n&&n();var o=0;function r(){++o===s.length&&n&&n()}s.forEach((function(n){e.attachments&&e.include_docs?function(t,e){var n=t._attachments[e],s=n.digest;i.objectStore(ATTACH_STORE).get(s).onsuccess=function(t){n.body=t.target.result.body,r()}}(t,n):(t._attachments[n].stub=!0,r())}))}function postProcessAttachments(t,e){return Promise.all(t.map((function(t){if(t.doc&&t.doc._attachments){var i=Object.keys(t.doc._attachments);return Promise.all(i.map((function(i){var n=t.doc._attachments[i];if("body"in n){var s=n.body,o=n.content_type;return new Promise((function(r){readBlobData(s,o,e,(function(e){t.doc._attachments[i]=$inject_Object_assign(pick(n,["digest","content_type"]),{data:e}),r()}))}))}})))}})))}function compactRevs(t,e,i){var n=[],s=i.objectStore(BY_SEQ_STORE),o=i.objectStore(ATTACH_STORE),r=i.objectStore(ATTACH_AND_SEQ_STORE),a=t.length;function l(){--a||n.length&&n.forEach((function(t){r.index("digestSeq").count(IDBKeyRange.bound(t+"::",t+"::",!1,!1)).onsuccess=function(e){e.target.result||o.delete(t)}}))}t.forEach((function(t){s.index("_doc_id_rev").getKey(e+"::"+t).onsuccess=function(t){var e=t.target.result;if("number"!=typeof e)return l();s.delete(e),r.index("seq").openCursor(IDBKeyRange.only(e)).onsuccess=function(t){var e=t.target.result;if(e){var i=e.value.digestSeq.split("::")[0];n.push(i),r.delete(e.primaryKey),e.continue()}else l()}}}))}function openTransactionSafely(t,e,i){try{return{txn:t.transaction(e,i)}}catch(n){return{error:n}}}var changesHandler=new Changes;function idbBulkDocs(t,e,i,n,s,o){for(var r,a,l,c,h,d,u,m,p=e.docs,b=0,f=p.length;b<f;b++){var g=p[b];g._id&&isLocalId(g._id)||(g=p[b]=parseDoc(g,i.new_edits,t)).error&&!u&&(u=g)}if(u)return o(u);var y=!1,v=0,Z=new Array(p.length),x=new ExportedMap,G=!1;function X(){y=!0,w()}function w(){m&&y&&(m.docCount+=v,d.put(m))}function V(){G||(changesHandler.notify(n._meta.name),o(null,Z))}function I(t,e,i,n,s,o,r,a){t.metadata.winningRev=e,t.metadata.deleted=i;var l=t.data;if(l._id=t.metadata.id,l._rev=t.metadata.rev,n&&(l._deleted=!0),l._attachments&&Object.keys(l._attachments).length)return function(t,e,i,n,s,o){var r=0,a=Object.keys(t.data._attachments);function l(){r===a.length&&S(t,e,i,n,s,o)}function h(){r++,l()}a.forEach((function(i){var n=t.data._attachments[i];if(n.stub)r++,l();else{var s=n.data;delete n.data,n.revpos=parseInt(e,10),function(t,e,i){c.count(t).onsuccess=function(n){if(n.target.result)return i();c.put({digest:t,body:e}).onsuccess=i}}(n.digest,s,h)}}))}(t,e,i,s,r,a);v+=o,w(),S(t,e,i,s,r,a)}function S(t,e,i,s,o,c){var d=t.data,u=t.metadata;function m(o){var l=t.stemmedRevs||[];s&&n.auto_compaction&&(l=l.concat(compactTree(t.metadata))),l&&l.length&&compactRevs(l,t.metadata.id,r),u.seq=o.target.result;var c=encodeMetadata(u,e,i);a.put(c).onsuccess=p}function p(){Z[o]={ok:!0,id:u.id,rev:u.rev},x.set(t.metadata.id,t.metadata),function(t,e,i){var n=0,s=Object.keys(t.data._attachments||{});if(!s.length)return i();function o(){++n===s.length&&i()}function r(i){var n=h.put({seq:e,digestSeq:t.data._attachments[i].digest+"::"+e});n.onsuccess=o,n.onerror=function(t){t.preventDefault(),t.stopPropagation(),o()}}for(var a=0;a<s.length;a++)r(s[a])}(t,u.seq,c)}d._doc_id_rev=u.id+"::"+u.rev,delete d._id,delete d._rev;var b=l.put(d);b.onsuccess=m,b.onerror=function(t){t.preventDefault(),t.stopPropagation(),l.index("_doc_id_rev").getKey(d._doc_id_rev).onsuccess=function(t){l.put(d,t.target.result).onsuccess=m}}}preprocessAttachments(p,n._meta.blobSupport?"blob":"base64",(function(e){if(e)return o(e);!function(){var e=openTransactionSafely(s,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE,LOCAL_STORE,ATTACH_AND_SEQ_STORE,META_STORE],"readwrite");if(e.error)return o(e.error);(r=e.txn).onabort=idbError(o),r.ontimeout=idbError(o),r.oncomplete=V,a=r.objectStore(DOC_STORE),l=r.objectStore(BY_SEQ_STORE),c=r.objectStore(ATTACH_STORE),h=r.objectStore(ATTACH_AND_SEQ_STORE),(d=r.objectStore(META_STORE)).get(META_STORE).onsuccess=function(t){m=t.target.result,w()},function(t){var e=[];if(p.forEach((function(t){t.data&&t.data._attachments&&Object.keys(t.data._attachments).forEach((function(i){var n=t.data._attachments[i];n.stub&&e.push(n.digest)}))})),!e.length)return t();var i,n=0;e.forEach((function(s){!function(t,e){c.get(t).onsuccess=function(i){if(i.target.result)e();else{var n=createError(MISSING_STUB,"unknown stub attachment with digest "+t);n.status=412,e(n)}}}(s,(function(s){s&&!i&&(i=s),++n===e.length&&t(i)}))}))}((function(e){if(e)return G=!0,o(e);!function(){if(p.length)for(var e=0,s=0,o=p.length;s<o;s++){var l=p[s];l._id&&isLocalId(l._id)?c():a.get(l.metadata.id).onsuccess=h}function c(){++e===p.length&&processDocs(t.revs_limit,p,n,x,r,Z,I,i,X)}function h(t){var e=decodeMetadata(t.target.result);e&&x.set(e.id,e),c()}}()}))}()}))}function runBatchedCursor(t,i,n,s,o){var r,a,l;function c(t){a=t.target.result,r&&o(r,a,l)}function h(t){r=t.target.result,a&&o(r,a,l)}function d(t){var e=t.target.result;if(!e)return o();o([e.key],[e.value],e)}-1===s&&(s=1e3),"function"==typeof t.getAll&&"function"==typeof t.getAllKeys&&s>1&&!n?(l={continue:function(){if(!r.length)return o();var n,l=r[r.length-1];if(i&&i.upper)try{n=IDBKeyRange.bound(l,i.upper,!0,i.upperOpen)}catch(e){if("DataError"===e.name&&0===e.code)return o()}else n=IDBKeyRange.lowerBound(l,!0);r=null,a=null,t.getAll(i=n,s).onsuccess=c,t.getAllKeys(i,s).onsuccess=h}},t.getAll(i,s).onsuccess=c,t.getAllKeys(i,s).onsuccess=h):n?t.openCursor(i,"prev").onsuccess=d:t.openCursor(i).onsuccess=d}function getAll(t,e,i){if("function"!=typeof t.getAll){var n=[];t.openCursor(e).onsuccess=function(t){var e=t.target.result;e?(n.push(e.value),e.continue()):i({target:{result:n}})}}else t.getAll(e).onsuccess=i}function allDocsKeys(t,e,i){var n=new Array(t.length),s=0;t.forEach((function(o,r){e.get(o).onsuccess=function(e){n[r]=e.target.result?e.target.result:{key:o,error:"not_found"},++s===t.length&&i(t,n,{})}}))}function createKeyRange(t,i,n,s,o){try{if(t&&i)return o?IDBKeyRange.bound(i,t,!n,!1):IDBKeyRange.bound(t,i,!1,!n);if(t)return o?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t);if(i)return o?IDBKeyRange.lowerBound(i,!n):IDBKeyRange.upperBound(i,!n);if(s)return IDBKeyRange.only(s)}catch(e){return{error:e}}return null}function idbAllDocs(t,e,i){var n,s,o="keys"in t&&t.keys,r=t.skip||0,a="number"==typeof t.limit?t.limit:-1;if(!o&&(s=(n=createKeyRange("startkey"in t&&t.startkey,"endkey"in t&&t.endkey,!1!==t.inclusive_end,"key"in t&&t.key,t.descending))&&n.error)&&("DataError"!==s.name||0!==s.code))return i(createError(IDB_ERROR,s.name));var l=[DOC_STORE,BY_SEQ_STORE,META_STORE];t.attachments&&l.push(ATTACH_STORE);var c=openTransactionSafely(e,l,"readonly");if(c.error)return i(c.error);var h=c.txn;h.oncomplete=function(){t.attachments?postProcessAttachments(y,t.binary).then(G):G()},h.onabort=idbError(i);var d,u,m,p=h.objectStore(DOC_STORE),b=h.objectStore(BY_SEQ_STORE),f=h.objectStore(META_STORE),g=b.index("_doc_id_rev"),y=[];function v(e,i){var n={id:i.id,key:i.id,value:{rev:e}};i.deleted?o&&(y.push(n),n.value.deleted=!0,n.doc=null):r--<=0&&(y.push(n),t.include_docs&&function(e,i,n){g.get(e.id+"::"+n).onsuccess=function(n){if(i.doc=decodeDoc(n.target.result)||{},t.conflicts){var s=collectConflicts(e);s.length&&(i.doc._conflicts=s)}fetchAttachmentsIfNecessary(i.doc,t,h)}}(i,n,e))}function Z(t){for(var e=0,i=t.length;e<i&&y.length!==a;e++){var n=t[e];if(n.error&&o)y.push(n);else{var s=decodeMetadata(n);v(s.winningRev,s)}}}function x(t,e,i){i&&(Z(e),y.length<a&&i.continue())}function G(){var e={total_rows:d,offset:t.skip,rows:y};t.update_seq&&void 0!==u&&(e.update_seq=u),i(null,e)}return f.get(META_STORE).onsuccess=function(t){d=t.target.result.docCount},t.update_seq&&(m=function(t){t.target.result&&t.target.result.length>0&&(u=t.target.result[0])},b.openCursor(null,"prev").onsuccess=function(t){var e=t.target.result,i=void 0;return e&&e.key&&(i=e.key),m({target:{result:[i]}})}),s||0===a?void 0:o?allDocsKeys(t.keys,p,x):-1===a?getAll(p,n,(function(e){var i=e.target.result;t.descending&&(i=i.reverse()),Z(i)})):void runBatchedCursor(p,n,t.descending,a+r,x)}function checkBlobSupport(t){return new Promise((function(e){var i=createBlob([""]),n=t.objectStore(DETECT_BLOB_SUPPORT_STORE).put(i,"key");n.onsuccess=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);e(i||!t||parseInt(t[1],10)>=43)},n.onerror=t.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)}})).catch((function(){return!1}))}function countDocs(t,e){t.objectStore(DOC_STORE).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(t){e(t.target.result)}}var running=!1,queue$1=[];function tryCode(t,e,i,n){try{t(e,i)}catch(e){n.emit("error",e)}}function applyNext(){!running&&queue$1.length&&(running=!0,queue$1.shift()())}function enqueueTask(t,e,i){queue$1.push((function(){t((function(t,n){tryCode(e,t,n,i),running=!1,browser$3((function(){applyNext()}))}))})),applyNext()}function changes(t,e,i,n){if((t=clone$1(t)).continuous){var s=i+":"+uuid$1();return changesHandler.addListener(i,s,e,t),changesHandler.notify(i),{cancel:function(){changesHandler.removeListener(i,s)}}}var o=t.doc_ids&&new ExportedSet(t.doc_ids);t.since=t.since||0;var r=t.since,a="limit"in t?t.limit:-1;0===a&&(a=1);var l,c,h,d,u=[],m=0,p=filterChange(t),b=new ExportedMap;function f(t,e,i,n){return i.seq!==e?n():i.winningRev===t._rev?n(i,t):void(d.get(t._id+"::"+i.winningRev).onsuccess=function(t){n(i,decodeDoc(t.target.result))})}function g(){t.complete(null,{results:u,last_seq:r})}var y=[DOC_STORE,BY_SEQ_STORE];t.attachments&&y.push(ATTACH_STORE);var v=openTransactionSafely(n,y,"readonly");if(v.error)return t.complete(v.error);(l=v.txn).onabort=idbError(t.complete),l.oncomplete=function(){!t.continuous&&t.attachments?postProcessAttachments(u).then(g):g()},c=l.objectStore(BY_SEQ_STORE),h=l.objectStore(DOC_STORE),d=c.index("_doc_id_rev"),runBatchedCursor(c,t.since&&!t.descending?IDBKeyRange.lowerBound(t.since,!0):null,t.descending,a,(function(e,i,n){if(n&&e.length){var s=new Array(e.length),c=new Array(e.length),d=0;i.forEach((function(i,r){!function(t,e,i){if(o&&!o.has(t._id))return i();var n=b.get(t._id);if(n)return f(t,e,n,i);h.get(t._id).onsuccess=function(s){n=decodeMetadata(s.target.result),b.set(t._id,n),f(t,e,n,i)}}(decodeDoc(i),e[r],(function(i,o){c[r]=i,s[r]=o,++d===e.length&&function(){for(var e=[],i=0,o=s.length;i<o&&m!==a;i++){var r=s[i];r&&e.push(g(c[i],r))}Promise.all(e).then((function(e){for(var i=0,n=e.length;i<n;i++)e[i]&&t.onChange(e[i])})).catch(t.complete),m!==a&&n.continue()}()}))}))}function g(e,i){var n=t.processChange(i,e,t);r=n.seq=e.seq;var s=p(n);return"object"==typeof s?Promise.reject(s):s?(m++,t.return_docs&&u.push(n),t.attachments&&t.include_docs?new Promise((function(e){fetchAttachmentsIfNecessary(i,t,l,(function(){postProcessAttachments([n],t.binary).then((function(){e(n)}))}))})):Promise.resolve(n)):Promise.resolve()}}))}var cachedDBs=new ExportedMap,blobSupportPromise,openReqList=new ExportedMap;function IdbPouch(t,e){var i=this;enqueueTask((function(e){init$1(i,t,e)}),e,i.constructor)}function init$1(t,e,i){var n=e.name,s=null;function o(t,e){var i=t.objectStore(DOC_STORE);i.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),i.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var s=n.value,o=isDeleted(s);s.deletedOrLocal=o?"1":"0",i.put(s),n.continue()}else e()}}function r(t,e){var i=t.objectStore(LOCAL_STORE),n=t.objectStore(DOC_STORE),s=t.objectStore(BY_SEQ_STORE);n.openCursor().onsuccess=function(t){var o=t.target.result;if(o){var r=o.value,a=r.id,l=isLocalId(a),c=winningRev(r);if(l){var h=a+"::"+c,d=a+"::",u=a+"::~",m=s.index("_doc_id_rev"),p=IDBKeyRange.bound(d,u,!1,!1),b=m.openCursor(p);b.onsuccess=function(t){if(b=t.target.result){var e=b.value;e._doc_id_rev===h&&i.put(e),s.delete(b.primaryKey),b.continue()}else n.delete(o.primaryKey),o.continue()}}else o.continue()}else e&&e()}}function a(t,e){var i=t.objectStore(BY_SEQ_STORE),n=t.objectStore(ATTACH_STORE),s=t.objectStore(ATTACH_AND_SEQ_STORE);n.count().onsuccess=function(t){if(!t.target.result)return e();i.openCursor().onsuccess=function(t){var i=t.target.result;if(!i)return e();for(var n=i.value,o=i.primaryKey,r=Object.keys(n._attachments||{}),a={},l=0;l<r.length;l++)a[n._attachments[r[l]].digest]=!0;var c=Object.keys(a);for(l=0;l<c.length;l++)s.put({seq:o,digestSeq:c[l]+"::"+o});i.continue()}}}function l(t){var e=t.objectStore(BY_SEQ_STORE),i=t.objectStore(DOC_STORE);i.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var s,o=(s=n.value).data?decodeMetadata(s):(s.deleted="1"===s.deletedOrLocal,s);if(o.winningRev=o.winningRev||winningRev(o),o.seq)return r();!function(){var t=o.id+"::",i=o.id+"::",n=e.index("_doc_id_rev").openCursor(IDBKeyRange.bound(t,i)),s=0;n.onsuccess=function(t){var e=t.target.result;if(!e)return o.seq=s,r();var i=e.primaryKey;i>s&&(s=i),e.continue()}}()}function r(){var t=encodeMetadata(o,o.winningRev,o.deleted);i.put(t).onsuccess=function(){n.continue()}}}}t._meta=null,t._remote=!1,t.type=function(){return"idb"},t._id=toPromise((function(e){e(null,t._meta.instanceId)})),t._bulkDocs=function(i,n,o){idbBulkDocs(e,i,n,t,s,o)},t._get=function(t,e,i){var n,o,r,a=e.ctx;if(!a){var l=openTransactionSafely(s,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE],"readonly");if(l.error)return i(l.error);a=l.txn}function c(){i(r,{doc:n,metadata:o,ctx:a})}a.objectStore(DOC_STORE).get(t).onsuccess=function(t){if(!(o=decodeMetadata(t.target.result)))return r=createError(MISSING_DOC,"missing"),c();var i;if(e.rev)i=e.latest?latest(e.rev,o):e.rev;else if(i=o.winningRev,isDeleted(o))return r=createError(MISSING_DOC,"deleted"),c();var s=a.objectStore(BY_SEQ_STORE),l=o.id+"::"+i;s.index("_doc_id_rev").get(l).onsuccess=function(t){if((n=t.target.result)&&(n=decodeDoc(n)),!n)return r=createError(MISSING_DOC,"missing"),c();c()}}},t._getAttachment=function(t,e,i,n,o){var r;if(n.ctx)r=n.ctx;else{var a=openTransactionSafely(s,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE],"readonly");if(a.error)return o(a.error);r=a.txn}var l=i.digest,c=i.content_type;r.objectStore(ATTACH_STORE).get(l).onsuccess=function(t){readBlobData(t.target.result.body,c,n.binary,(function(t){o(null,t)}))}},t._info=function(e){var i,n,o=openTransactionSafely(s,[META_STORE,BY_SEQ_STORE],"readonly");if(o.error)return e(o.error);var r=o.txn;r.objectStore(META_STORE).get(META_STORE).onsuccess=function(t){n=t.target.result.docCount},r.objectStore(BY_SEQ_STORE).openCursor(null,"prev").onsuccess=function(t){var e=t.target.result;i=e?e.key:0},r.oncomplete=function(){e(null,{doc_count:n,update_seq:i,idb_attachment_format:t._meta.blobSupport?"binary":"base64"})}},t._allDocs=function(t,e){idbAllDocs(t,s,e)},t._changes=function(e){return changes(e,t,n,s)},t._close=function(t){s.close(),cachedDBs.delete(n),t()},t._getRevisionTree=function(t,e){var i=openTransactionSafely(s,[DOC_STORE],"readonly");if(i.error)return e(i.error);i.txn.objectStore(DOC_STORE).get(t).onsuccess=function(t){var i=decodeMetadata(t.target.result);i?e(null,i.rev_tree):e(createError(MISSING_DOC))}},t._doCompaction=function(t,e,i){var n=openTransactionSafely(s,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE,ATTACH_AND_SEQ_STORE],"readwrite");if(n.error)return i(n.error);var o=n.txn;o.objectStore(DOC_STORE).get(t).onsuccess=function(i){var n=decodeMetadata(i.target.result);traverseRevTree(n.rev_tree,(function(t,i,n,s,o){-1!==e.indexOf(i+"-"+n)&&(o.status="missing")})),compactRevs(e,t,o);var s=n.winningRev,r=n.deleted;o.objectStore(DOC_STORE).put(encodeMetadata(n,s,r))},o.onabort=idbError(i),o.oncomplete=function(){i()}},t._getLocal=function(t,e){var i=openTransactionSafely(s,[LOCAL_STORE],"readonly");if(i.error)return e(i.error);var n=i.txn.objectStore(LOCAL_STORE).get(t);n.onerror=idbError(e),n.onsuccess=function(t){var i=t.target.result;i?(delete i._doc_id_rev,e(null,i)):e(createError(MISSING_DOC))}},t._putLocal=function(t,e,i){"function"==typeof e&&(i=e,e={}),delete t._revisions;var n=t._rev,o=t._id;t._rev=n?"0-"+(parseInt(n.split("-")[1],10)+1):"0-1";var r,a=e.ctx;if(!a){var l=openTransactionSafely(s,[LOCAL_STORE],"readwrite");if(l.error)return i(l.error);(a=l.txn).onerror=idbError(i),a.oncomplete=function(){r&&i(null,r)}}var c,h=a.objectStore(LOCAL_STORE);n?(c=h.get(o)).onsuccess=function(s){var o=s.target.result;o&&o._rev===n?h.put(t).onsuccess=function(){r={ok:!0,id:t._id,rev:t._rev},e.ctx&&i(null,r)}:i(createError(REV_CONFLICT))}:((c=h.add(t)).onerror=function(t){i(createError(REV_CONFLICT)),t.preventDefault(),t.stopPropagation()},c.onsuccess=function(){r={ok:!0,id:t._id,rev:t._rev},e.ctx&&i(null,r)})},t._removeLocal=function(t,e,i){"function"==typeof e&&(i=e,e={});var n,o=e.ctx;if(!o){var r=openTransactionSafely(s,[LOCAL_STORE],"readwrite");if(r.error)return i(r.error);(o=r.txn).oncomplete=function(){n&&i(null,n)}}var a=t._id,l=o.objectStore(LOCAL_STORE),c=l.get(a);c.onerror=idbError(i),c.onsuccess=function(s){var o=s.target.result;o&&o._rev===t._rev?(l.delete(a),n={ok:!0,id:a,rev:"0-0"},e.ctx&&i(null,n)):i(createError(MISSING_DOC))}},t._destroy=function(t,e){changesHandler.removeAllListeners(n);var i=openReqList.get(n);i&&i.result&&(i.result.close(),cachedDBs.delete(n));var s=indexedDB.deleteDatabase(n);s.onsuccess=function(){openReqList.delete(n),hasLocalStorage()&&n in localStorage&&delete localStorage[n],e(null,{ok:!0})},s.onerror=idbError(e)};var c=cachedDBs.get(n);if(c)return s=c.idb,t._meta=c.global,browser$3((function(){i(null,t)}));var h=indexedDB.open(n,ADAPTER_VERSION);openReqList.set(n,h),h.onupgradeneeded=function(t){var e=t.target.result;if(t.oldVersion<1)return function(t){var e=t.createObjectStore(DOC_STORE,{keyPath:"id"});t.createObjectStore(BY_SEQ_STORE,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),t.createObjectStore(ATTACH_STORE,{keyPath:"digest"}),t.createObjectStore(META_STORE,{keyPath:"id",autoIncrement:!1}),t.createObjectStore(DETECT_BLOB_SUPPORT_STORE),e.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),t.createObjectStore(LOCAL_STORE,{keyPath:"_id"});var i=t.createObjectStore(ATTACH_AND_SEQ_STORE,{autoIncrement:!0});i.createIndex("seq","seq"),i.createIndex("digestSeq","digestSeq",{unique:!0})}(e);var i=t.currentTarget.transaction;t.oldVersion<3&&function(t){t.createObjectStore(LOCAL_STORE,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(e),t.oldVersion<4&&function(t){var e=t.createObjectStore(ATTACH_AND_SEQ_STORE,{autoIncrement:!0});e.createIndex("seq","seq"),e.createIndex("digestSeq","digestSeq",{unique:!0})}(e);var n=[o,r,a,l],s=t.oldVersion;!function t(){var e=n[s-1];s++,e&&e(i,t)}()},h.onsuccess=function(e){(s=e.target.result).onversionchange=function(){s.close(),cachedDBs.delete(n)},s.onabort=function(t){guardedConsole("error","Database has a global failure",t.target.error),s.close(),cachedDBs.delete(n)};var o,r,a,l,c=s.transaction([META_STORE,DETECT_BLOB_SUPPORT_STORE,DOC_STORE],"readwrite"),h=!1;function d(){void 0!==a&&h&&(t._meta={name:n,instanceId:l,blobSupport:a},cachedDBs.set(n,{idb:s,global:t._meta}),i(null,t))}function u(){if(void 0!==r&&void 0!==o){var t=n+"_id";t in o?l=o[t]:o[t]=l=uuid$1(),o.docCount=r,c.objectStore(META_STORE).put(o)}}c.objectStore(META_STORE).get(META_STORE).onsuccess=function(t){o=t.target.result||{id:META_STORE},u()},countDocs(c,(function(t){r=t,u()})),blobSupportPromise||(blobSupportPromise=checkBlobSupport(c)),blobSupportPromise.then((function(t){a=t,d()})),c.oncomplete=function(){h=!0,d()},c.onabort=idbError(i)},h.onerror=function(t){var e=t.target.error&&t.target.error.message;e?-1!==e.indexOf("stored database is a higher version")&&(e=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):e="Failed to open indexedDB, are you in private browsing mode?",guardedConsole("error",e),i(createError(IDB_ERROR,e))}}function IDBPouch(t){t.adapter("idb",IdbPouch,!0)}function pool(t,e){return new Promise((function(i,n){var s,o=0,r=0,a=0,l=t.length;function c(){++a===l?s?n(s):i():u()}function h(){o--,c()}function d(t){o--,s=s||t,c()}function u(){for(;o<e&&r<l;)o++,t[r++]().then(h,d)}u()}))}IdbPouch.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}};var CHANGES_BATCH_SIZE=25,MAX_SIMULTANEOUS_REVS=50,DEFAULT_HEARTBEAT=1e4,supportsBulkGetMap={};function readAttachmentsAsBlobOrBuffer(t){var e=t.doc||t.ok,i=e&&e._attachments;i&&Object.keys(i).forEach((function(t){var e=i[t];e.data=b64ToBluffer(e.data,e.content_type)}))}function encodeDocId(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function preprocessAttachments$1(t){return t._attachments&&Object.keys(t._attachments)?Promise.all(Object.keys(t._attachments).map((function(e){var i=t._attachments[e];if(i.data&&"string"!=typeof i.data)return new Promise((function(t){blobToBase64(i.data,t)})).then((function(t){i.data=t}))}))):Promise.resolve()}function hasUrlPrefix(t){if(!t.prefix)return!1;var e=parseUri(t.prefix).protocol;return"http"===e||"https"===e}function getHost(t,e){if(hasUrlPrefix(e)){var i=e.name.substr(e.prefix.length);t=e.prefix.replace(/\/?$/,"/")+encodeURIComponent(i)}var n=parseUri(t);(n.user||n.password)&&(n.auth={username:n.user,password:n.password});var s=n.path.replace(/(^\/|\/$)/g,"").split("/");return n.db=s.pop(),-1===n.db.indexOf("%")&&(n.db=encodeURIComponent(n.db)),n.path=s.join("/"),n}function genDBUrl(t,e){return genUrl(t,t.db+"/"+e)}function genUrl(t,e){return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+(t.path?"/":"")+e}function paramsToStr(t){return"?"+Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&")}function shouldCacheBust(t){var e="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i=-1!==e.indexOf("msie"),n=-1!==e.indexOf("trident"),s=-1!==e.indexOf("edge");return(i||n||s)&&(!("method"in t)||"GET"===t.method)}function HttpPouch(t,e){var i=this,n=getHost(t.name,t),s=genDBUrl(n,"");t=clone$1(t);var o,r=function(e,i){if((i=i||{}).headers=i.headers||new h$3,i.credentials="include",t.auth||n.auth){var s=t.auth||n.auth,o=thisBtoa(unescape(encodeURIComponent(s.username+":"+s.password)));i.headers.set("Authorization","Basic "+o)}var r=t.headers||{};return Object.keys(r).forEach((function(t){i.headers.append(t,r[t])})),shouldCacheBust(i)&&(e+=(-1===e.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(t.fetch||f$1)(e,i)};function l(t,e){return adapterFun(t,argsarray((function(t){h().then((function(){return e.apply(this,t)})).catch((function(e){t.pop()(e)}))}))).bind(i)}function c(t,e,i){var n={};return(e=e||{}).headers=e.headers||new h$3,e.headers.get("Content-Type")||e.headers.set("Content-Type","application/json"),e.headers.get("Accept")||e.headers.set("Accept","application/json"),r(t,e).then((function(t){return n.ok=t.ok,n.status=t.status,t.json()})).then((function(t){if(n.data=t,!n.ok){n.data.status=n.status;var e=generateErrorFromResponse(n.data);if(i)return i(e);throw e}if(Array.isArray(n.data)&&(n.data=n.data.map((function(t){return t.error||t.missing?generateErrorFromResponse(t):t}))),!i)return n;i(null,n.data)}))}function h(){return t.skip_setup?Promise.resolve():o||((o=c(s).catch((function(t){return t&&t.status&&404===t.status?(explainError(404,"PouchDB is just detecting if the remote exists."),c(s,{method:"PUT"})):Promise.reject(t)})).catch((function(t){return!(!t||!t.status||412!==t.status)||Promise.reject(t)}))).catch((function(){o=null})),o)}function d(t){return t.split("/").map(encodeURIComponent).join("/")}browser$3((function(){e(null,i)})),i._remote=!0,i.type=function(){return"http"},i.id=l("id",(function(t){r(genUrl(n,"")).then((function(t){return t.json()})).catch((function(){return{}})).then((function(e){var i=e&&e.uuid?e.uuid+n.db:genDBUrl(n,"");t(null,i)}))})),i.compact=l("compact",(function(t,e){"function"==typeof t&&(e=t,t={}),t=clone$1(t),c(genDBUrl(n,"_compact"),{method:"POST"}).then((function(){!function n(){i.info((function(i,s){s&&!s.compact_running?e(null,{ok:!0}):setTimeout(n,t.interval||200)}))}()}))})),i.bulkGet=adapterFun("bulkGet",(function(t,e){var i=this;function s(e){var i={};t.revs&&(i.revs=!0),t.attachments&&(i.attachments=!0),t.latest&&(i.latest=!0),c(genDBUrl(n,"_bulk_get"+paramsToStr(i)),{method:"POST",body:JSON.stringify({docs:t.docs})}).then((function(i){t.attachments&&t.binary&&i.data.results.forEach((function(t){t.docs.forEach(readAttachmentsAsBlobOrBuffer)})),e(null,i.data)})).catch(e)}function o(){var n=MAX_SIMULTANEOUS_REVS,s=Math.ceil(t.docs.length/n),o=0,r=new Array(s);function a(t){return function(i,n){r[t]=n.results,++o===s&&e(null,{results:flatten(r)})}}for(var l=0;l<s;l++){var c=pick(t,["revs","attachments","binary","latest"]);c.docs=t.docs.slice(l*n,Math.min(t.docs.length,(l+1)*n)),bulkGet(i,c,a(l))}}var r=genUrl(n,""),a=supportsBulkGetMap[r];"boolean"!=typeof a?s((function(t,i){t?(supportsBulkGetMap[r]=!1,explainError(t.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):(supportsBulkGetMap[r]=!0,e(null,i))})):a?s(e):o()})),i._info=function(t){h().then((function(){return r(genDBUrl(n,""))})).then((function(t){return t.json()})).then((function(e){e.host=genDBUrl(n,""),t(null,e)})).catch(t)},i.fetch=function(t,e){return h().then((function(){var i="/"===t.substring(0,1)?genUrl(n,t.substring(1)):genDBUrl(n,t);return r(i,e)}))},i.get=l("get",(function(t,e,i){"function"==typeof e&&(i=e,e={});var s={};function o(t){var i=t._attachments,s=i&&Object.keys(i);if(i&&s.length)return pool(s.map((function(s){return function(){return function(s){var o=i[s],a=encodeDocId(t._id)+"/"+d(s)+"?rev="+t._rev;return r(genDBUrl(n,a)).then((function(t){return"buffer"in t?t.buffer():t.blob()})).then((function(t){if(e.binary){var i=Object.getOwnPropertyDescriptor(t.__proto__,"type");return i&&!i.set||(t.type=o.content_type),t}return new Promise((function(e){blobToBase64(t,e)}))})).then((function(t){delete o.stub,delete o.length,o.data=t}))}(s)}})),5)}(e=clone$1(e)).revs&&(s.revs=!0),e.revs_info&&(s.revs_info=!0),e.latest&&(s.latest=!0),e.open_revs&&("all"!==e.open_revs&&(e.open_revs=JSON.stringify(e.open_revs)),s.open_revs=e.open_revs),e.rev&&(s.rev=e.rev),e.conflicts&&(s.conflicts=e.conflicts),e.update_seq&&(s.update_seq=e.update_seq),t=encodeDocId(t),c(genDBUrl(n,t+paramsToStr(s))).then((function(t){return Promise.resolve().then((function(){if(e.attachments)return i=t.data,Array.isArray(i)?Promise.all(i.map((function(t){if(t.ok)return o(t.ok)}))):o(i);var i})).then((function(){i(null,t.data)}))})).catch((function(e){e.docId=t,i(e)}))})),i.remove=l("remove",(function(t,e,i,s){var o;"string"==typeof e?(o={_id:t,_rev:e},"function"==typeof i&&(s=i,i={})):(o=t,"function"==typeof e?(s=e,i={}):(s=i,i=e));var r=o._rev||i.rev;c(genDBUrl(n,encodeDocId(o._id))+"?rev="+r,{method:"DELETE"},s).catch(s)})),i.getAttachment=l("getAttachment",(function(t,e,i,s){"function"==typeof i&&(s=i,i={});var o,a=i.rev?"?rev="+i.rev:"",l=genDBUrl(n,encodeDocId(t))+"/"+d(e)+a;r(l,{method:"GET"}).then((function(t){if(o=t.headers.get("content-type"),t.ok)return void 0===process_1||process_1.browser||"function"!=typeof t.buffer?t.blob():t.buffer();throw t})).then((function(t){void 0===process_1||process_1.browser||(t.type=o),s(null,t)})).catch((function(t){s(t)}))})),i.removeAttachment=l("removeAttachment",(function(t,e,i,s){c(genDBUrl(n,encodeDocId(t)+"/"+d(e))+"?rev="+i,{method:"DELETE"},s).catch(s)})),i.putAttachment=l("putAttachment",(function(t,e,i,s,o,r){"function"==typeof o&&(r=o,o=s,s=i,i=null);var a=encodeDocId(t)+"/"+d(e),l=genDBUrl(n,a);if(i&&(l+="?rev="+i),"string"==typeof s){var h;try{h=thisAtob(s)}catch(u){return r(createError(BAD_ARG,"Attachment is not a valid base64 string"))}s=h?binStringToBluffer(h,o):""}c(l,{headers:new h$3({"Content-Type":o}),method:"PUT",body:s},r).catch(r)})),i._bulkDocs=function(t,e,i){t.new_edits=e.new_edits,h().then((function(){return Promise.all(t.docs.map(preprocessAttachments$1))})).then((function(){return c(genDBUrl(n,"_bulk_docs"),{method:"POST",body:JSON.stringify(t)},i)})).catch(i)},i._put=function(t,e,i){h().then((function(){return preprocessAttachments$1(t)})).then((function(){return c(genDBUrl(n,encodeDocId(t._id)),{method:"PUT",body:JSON.stringify(t)})})).then((function(t){i(null,t.data)})).catch((function(e){e.docId=t&&t._id,i(e)}))},i.allDocs=l("allDocs",(function(t,e){"function"==typeof t&&(e=t,t={});var i,s={},o="GET";(t=clone$1(t)).conflicts&&(s.conflicts=!0),t.update_seq&&(s.update_seq=!0),t.descending&&(s.descending=!0),t.include_docs&&(s.include_docs=!0),t.attachments&&(s.attachments=!0),t.key&&(s.key=JSON.stringify(t.key)),t.start_key&&(t.startkey=t.start_key),t.startkey&&(s.startkey=JSON.stringify(t.startkey)),t.end_key&&(t.endkey=t.end_key),t.endkey&&(s.endkey=JSON.stringify(t.endkey)),void 0!==t.inclusive_end&&(s.inclusive_end=!!t.inclusive_end),void 0!==t.limit&&(s.limit=t.limit),void 0!==t.skip&&(s.skip=t.skip);var r=paramsToStr(s);void 0!==t.keys&&(o="POST",i={keys:t.keys}),c(genDBUrl(n,"_all_docs"+r),{method:o,body:JSON.stringify(i)}).then((function(i){t.include_docs&&t.attachments&&t.binary&&i.data.rows.forEach(readAttachmentsAsBlobOrBuffer),e(null,i.data)})).catch(e)})),i._changes=function(t){var e="batch_size"in t?t.batch_size:CHANGES_BATCH_SIZE;(t=clone$1(t)).continuous&&!("heartbeat"in t)&&(t.heartbeat=DEFAULT_HEARTBEAT);var i={};"timeout"in t&&t.timeout&&(i.timeout=t.timeout);var s=void 0!==t.limit&&t.limit,o=s;if(t.style&&(i.style=t.style),(t.include_docs||t.filter&&"function"==typeof t.filter)&&(i.include_docs=!0),t.attachments&&(i.attachments=!0),t.continuous&&(i.feed="longpoll"),t.seq_interval&&(i.seq_interval=t.seq_interval),t.conflicts&&(i.conflicts=!0),t.descending&&(i.descending=!0),t.update_seq&&(i.update_seq=!0),"heartbeat"in t&&t.heartbeat&&(i.heartbeat=t.heartbeat),t.filter&&"string"==typeof t.filter&&(i.filter=t.filter),t.view&&"string"==typeof t.view&&(i.filter="_view",i.view=t.view),t.query_params&&"object"==typeof t.query_params)for(var r in t.query_params)t.query_params.hasOwnProperty(r)&&(i[r]=t.query_params[r]);var l,d="GET";t.doc_ids?(i.filter="_doc_ids",d="POST",l={doc_ids:t.doc_ids}):t.selector&&(i.filter="_selector",d="POST",l={selector:t.selector});var u,m=new a,p=function(r,a){if(!t.aborted){i.since=r,"object"==typeof i.since&&(i.since=JSON.stringify(i.since)),t.descending?s&&(i.limit=o):i.limit=!s||o>e?e:o;var p=genDBUrl(n,"_changes"+paramsToStr(i)),b={signal:m.signal,method:d,body:JSON.stringify(l)};u=r,t.aborted||h().then((function(){return c(p,b,a)})).catch(a)}},b={results:[]},f=function(i,n){if(!t.aborted){var r=0;if(n&&n.results){r=n.results.length,b.last_seq=n.last_seq;var a=null,l=null;"number"==typeof n.pending&&(a=n.pending),"string"!=typeof b.last_seq&&"number"!=typeof b.last_seq||(l=b.last_seq),n.results=n.results.filter((function(e){o--;var i=filterChange(t)(e);return i&&(t.include_docs&&t.attachments&&t.binary&&readAttachmentsAsBlobOrBuffer(e),t.return_docs&&b.results.push(e),t.onChange(e,a,l)),i}))}else if(i)return t.aborted=!0,void t.complete(i);n&&n.last_seq&&(u=n.last_seq),(!t.continuous||s&&o<=0)&&(s&&o<=0||n&&r<e||t.descending)?t.complete(null,b):browser$3((function(){p(u,f)}))}};return p(t.since||0,f),{cancel:function(){t.aborted=!0,m.abort()}}},i.revsDiff=l("revsDiff",(function(t,e,i){"function"==typeof e&&(i=e,e={}),c(genDBUrl(n,"_revs_diff"),{method:"POST",body:JSON.stringify(t)},i).catch(i)})),i._close=function(t){t()},i._destroy=function(t,e){c(genDBUrl(n,""),{method:"DELETE"}).then((function(t){e(null,t)})).catch((function(t){404===t.status?e(null,{ok:!0}):e(t)}))}}function HttpPouch$1(t){t.adapter("http",HttpPouch,!1),t.adapter("https",HttpPouch,!1)}function QueryParseError(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,QueryParseError)}catch(e){}}function NotFoundError(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,NotFoundError)}catch(e){}}function BuiltInError(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,BuiltInError)}catch(e){}}function promisedCallback(t,e){return e&&t.then((function(t){browser$3((function(){e(null,t)}))}),(function(t){browser$3((function(){e(t)}))})),t}function callbackify(t){return argsarray((function(e){var i=e.pop(),n=t.apply(this,e);return"function"==typeof i&&promisedCallback(n,i),n}))}function fin(t,e){return t.then((function(t){return e().then((function(){return t}))}),(function(t){return e().then((function(){throw t}))}))}function sequentialize(t,e){return function(){var i=arguments,n=this;return t.add((function(){return e.apply(n,i)}))}}function uniq(t){var e=new ExportedSet(t),i=new Array(e.size),n=-1;return e.forEach((function(t){i[++n]=t})),i}function mapToKeysArray(t){var e=new Array(t.size),i=-1;return t.forEach((function(t,n){e[++i]=n})),e}function createBuiltInError(t){return new BuiltInError("builtin "+t+" function requires map values to be numbers or number arrays")}function sum(t){for(var e=0,i=0,n=t.length;i<n;i++){var s=t[i];if("number"!=typeof s){if(!Array.isArray(s))throw createBuiltInError("_sum");e="number"==typeof e?[e]:e;for(var o=0,r=s.length;o<r;o++){var a=s[o];if("number"!=typeof a)throw createBuiltInError("_sum");void 0===e[o]?e.push(a):e[o]+=a}}else"number"==typeof e?e+=s:e[0]+=s}return e}HttpPouch.valid=function(){return!0},inherits_browser(QueryParseError,Error),inherits_browser(NotFoundError,Error),inherits_browser(BuiltInError,Error);var log=guardedConsole.bind(null,"log"),isArray$1=Array.isArray,toJSON=JSON.parse;function evalFunctionWithEval(t,e){return scopeEval("return ("+t.replace(/;\s*$/,"")+");",{emit:e,sum,log,isArray:isArray$1,toJSON})}function TaskQueue$1(){this.promise=new Promise((function(t){t()}))}function stringify$1(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function createViewSignature(t,e){return stringify$1(t)+stringify$1(e)+"undefined"}function createView(t,e,i,n,s,o){var r,a=createViewSignature(i,n);if(!s&&(r=t._cachedViews=t._cachedViews||{})[a])return r[a];var l=t.info().then((function(l){var c=l.db_name+"-mrview-"+(s?"temp":stringMd5(a));return upsert(t,"_local/"+o,(function(t){t.views=t.views||{};var i=e;-1===i.indexOf("/")&&(i=e+"/"+e);var n=t.views[i]=t.views[i]||{};if(!n[c])return n[c]=!0,t})).then((function(){return t.registerDependentDatabase(c).then((function(e){var s=e.db;s.auto_compaction=!0;var o={name:c,db:s,sourceDB:t,adapter:t.adapter,mapFun:i,reduceFun:n};return o.db.get("_local/lastSeq").catch((function(t){if(404!==t.status)throw t})).then((function(t){return o.seq=t?t.seq:0,r&&o.db.once("destroyed",(function(){delete r[a]})),o}))}))}))}));return r&&(r[a]=l),l}TaskQueue$1.prototype.add=function(t){return this.promise=this.promise.catch((function(){})).then((function(){return t()})),this.promise},TaskQueue$1.prototype.finish=function(){return this.promise};var persistentQueues={},tempViewQueue=new TaskQueue$1,CHANGES_BATCH_SIZE$1=50;function parseViewName(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function isGenOne(t){return 1===t.length&&/^1-/.test(t[0].rev)}function emitError(t,e){try{t.emit("error",e)}catch(i){guardedConsole("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),guardedConsole("error",e)}}function createAbstractMapReduce(t,i,n,s){function o(t,i,n){try{i(n)}catch(e){emitError(t,e)}}function r(t,i,n,s,o){try{return{output:i(n,s,o)}}catch(e){return emitError(t,e),{error:e}}}function a(t,e){var i=collate(t.key,e.key);return 0!==i?i:collate(t.value,e.value)}function l(t,e,i){return i=i||0,"number"==typeof e?t.slice(i,e+i):i>0?t.slice(i):t}function c(t){var e=t.value;return e&&"object"==typeof e&&e._id||t.id}function h(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&function(t){t.rows.forEach((function(t){var e=t.doc&&t.doc._attachments;e&&Object.keys(e).forEach((function(t){var i=e[t];e[t].data=b64ToBluffer(i.data,i.content_type)}))}))}(e),e}}function d(t,e,i,n){var s=e[t];void 0!==s&&(n&&(s=encodeURIComponent(JSON.stringify(s))),i.push(t+"="+s))}function u(t){if(void 0!==t){var e=Number(t);return isNaN(e)||e!==parseInt(t,10)?t:e}}function m(t,e){var i=t.descending?"endkey":"startkey",n=t.descending?"startkey":"endkey";if(void 0!==t[i]&&void 0!==t[n]&&collate(t[i],t[n])>0)throw new QueryParseError("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new QueryParseError("{include_docs:true} is invalid for reduce");if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level)throw new QueryParseError("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach((function(e){var i=function(t){if(t){if("number"!=typeof t)return new QueryParseError('Invalid value for integer: "'+t+'"');if(t<0)return new QueryParseError('Invalid value for positive integer: "'+t+'"')}}(t[e]);if(i)throw i}))}function p(t){return function(e){if(404===e.status)return t;throw e}}function b(t){var e="string"==typeof t?t:t.name,i=persistentQueues[e];return i||(i=persistentQueues[e]=new TaskQueue$1),i}function f(t){return sequentialize(b(t),(function(){return function(t){var e,n,s=i(t.mapFun,(function(t,i){var s={id:n._id,key:normalizeKey(t)};null!=i&&(s.value=normalizeKey(i)),e.push(s)})),r=t.seq||0;function l(e,i){return function(){return function(t,e,i){return t.db.get("_local/lastSeq").catch(p({_id:"_local/lastSeq",seq:0})).then((function(n){var s=mapToKeysArray(e);return Promise.all(s.map((function(i){return function(t,e,i){var n="_local/doc_"+t,s={_id:n,keys:[]},o=i.get(t),r=o[0];return(isGenOne(o[1])?Promise.resolve(s):e.db.get(n).catch(p(s))).then((function(t){return function(t){return t.keys.length?e.db.allDocs({keys:t.keys,include_docs:!0}):Promise.resolve({rows:[]})}(t).then((function(e){return function(t,e){for(var i=[],n=new ExportedSet,s=0,o=e.rows.length;s<o;s++){var a=e.rows[s].doc;if(a&&(i.push(a),n.add(a._id),a._deleted=!r.has(a._id),!a._deleted)){var l=r.get(a._id);"value"in l&&(a.value=l.value)}}var c=mapToKeysArray(r);return c.forEach((function(t){if(!n.has(t)){var e={_id:t},s=r.get(t);"value"in s&&(e.value=s.value),i.push(e)}})),t.keys=uniq(c.concat(t.keys)),i.push(t),i}(t,e)}))}))}(i,t,e)}))).then((function(e){var s=flatten(e);return n.seq=i,s.push(n),t.db.bulkDocs({docs:s})}))}))}(t,e,i)}}var c=new TaskQueue$1;function h(){return t.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:r,limit:CHANGES_BATCH_SIZE$1}).then(d)}function d(i){var d=i.results;if(d.length){var m=function(i){for(var l=new ExportedMap,c=0,h=i.length;c<h;c++){var d=i[c];if("_"!==d.doc._id[0]){e=[],(n=d.doc)._deleted||o(t.sourceDB,s,n),e.sort(a);var m=u(e);l.set(d.doc._id,[m,d.changes])}r=d.seq}return l}(d);if(c.add(l(m,r)),!(d.length<CHANGES_BATCH_SIZE$1))return h()}}function u(t){for(var e,i=new ExportedMap,n=0,s=t.length;n<s;n++){var o=t[n],r=[o.key,o.id];n>0&&0===collate(o.key,e)&&r.push(n),i.set(toIndexableString(r),o),e=o.key}return i}return h().then((function(){return c.finish()})).then((function(){t.seq=r}))}(t)}))()}function g(t,e){return sequentialize(b(t),(function(){return function(t,e){var i,s=t.reduceFun&&!1!==e.reduce,o=e.skip||0;function a(e){return e.include_docs=!0,t.db.allDocs(e).then((function(t){return i=t.total_rows,t.rows.map((function(t){if("value"in t.doc&&"object"==typeof t.doc.value&&null!==t.doc.value){var e=Object.keys(t.doc.value).sort(),i=["id","key","value"];if(!(e<i||e>i))return t.doc.value}var n=parseIndexableString(t.doc._id);return{key:n[0],id:n[1],value:"value"in t.doc?t.doc.value:null}}))}))}function h(a){var h;if(h=s?function(t,e,i){0===i.group_level&&delete i.group_level;var s=i.group||i.group_level,o=n(t.reduceFun),a=[],c=isNaN(i.group_level)?Number.POSITIVE_INFINITY:i.group_level;e.forEach((function(t){var e=a[a.length-1],i=s?t.key:null;if(s&&Array.isArray(i)&&(i=i.slice(0,c)),e&&0===collate(e.groupKey,i))return e.keys.push([t.key,t.id]),void e.values.push(t.value);a.push({keys:[[t.key,t.id]],values:[t.value],groupKey:i})})),e=[];for(var h=0,d=a.length;h<d;h++){var u=a[h],m=r(t.sourceDB,o,u.keys,u.values,!1);if(m.error&&m.error instanceof BuiltInError)throw m.error;e.push({value:m.error?null:m.output,key:u.groupKey})}return{rows:l(e,i.limit,i.skip)}}(t,a,e):{total_rows:i,offset:o,rows:a},e.update_seq&&(h.update_seq=t.seq),e.include_docs){var d=uniq(a.map(c));return t.sourceDB.allDocs({keys:d,include_docs:!0,conflicts:e.conflicts,attachments:e.attachments,binary:e.binary}).then((function(t){var e=new ExportedMap;return t.rows.forEach((function(t){e.set(t.id,t.doc)})),a.forEach((function(t){var i=c(t),n=e.get(i);n&&(t.doc=n)})),h}))}return h}if(void 0===e.keys||e.keys.length||(e.limit=0,delete e.keys),void 0!==e.keys){var d=e.keys.map((function(t){var i={startkey:toIndexableString([t]),endkey:toIndexableString([t,{}])};return e.update_seq&&(i.update_seq=!0),a(i)}));return Promise.all(d).then(flatten).then(h)}var u,m,p={descending:e.descending};if(e.update_seq&&(p.update_seq=!0),"start_key"in e&&(u=e.start_key),"startkey"in e&&(u=e.startkey),"end_key"in e&&(m=e.end_key),"endkey"in e&&(m=e.endkey),void 0!==u&&(p.startkey=toIndexableString(e.descending?[u,{}]:[u])),void 0!==m){var b=!1!==e.inclusive_end;e.descending&&(b=!b),p.endkey=toIndexableString(b?[m,{}]:[m])}if(void 0!==e.key){var f=toIndexableString([e.key]),g=toIndexableString([e.key,{}]);p.descending?(p.endkey=f,p.startkey=g):(p.startkey=f,p.endkey=g)}return s||("number"==typeof e.limit&&(p.limit=e.limit),p.skip=o),a(p).then(h)}(t,e)}))()}return{query:function(e,i,n){var o=this;"function"==typeof i&&(n=i,i={}),i=i?function(t){return t.group_level=u(t.group_level),t.limit=u(t.limit),t.skip=u(t.skip),t}(i):{},"function"==typeof e&&(e={map:e});var r=Promise.resolve().then((function(){return function(e,i,n){if("function"==typeof e._query)return function(t,e,i){return new Promise((function(n,s){t._query(e,i,(function(t,e){if(t)return s(t);n(e)}))}))}(e,i,n);if(isRemote(e))return function(t,e,i){var n,s,o,r=[],a="GET";if(d("reduce",i,r),d("include_docs",i,r),d("attachments",i,r),d("limit",i,r),d("descending",i,r),d("group",i,r),d("group_level",i,r),d("skip",i,r),d("stale",i,r),d("conflicts",i,r),d("startkey",i,r,!0),d("start_key",i,r,!0),d("endkey",i,r,!0),d("end_key",i,r,!0),d("inclusive_end",i,r),d("key",i,r,!0),d("update_seq",i,r),r=""===(r=r.join("&"))?"":"?"+r,void 0!==i.keys){var l="keys="+encodeURIComponent(JSON.stringify(i.keys));l.length+r.length+1<=2e3?r+=("?"===r[0]?"&":"?")+l:(a="POST","string"==typeof e?n={keys:i.keys}:e.keys=i.keys)}if("string"==typeof e){var c=parseViewName(e);return t.fetch("_design/"+c[0]+"/_view/"+c[1]+r,{headers:new h$3({"Content-Type":"application/json"}),method:a,body:JSON.stringify(n)}).then((function(t){return s=t.ok,o=t.status,t.json()})).then((function(t){if(!s)throw t.status=o,generateErrorFromResponse(t);return t.rows.forEach((function(t){if(t.value&&t.value.error&&"builtin_reduce_error"===t.value.error)throw new Error(t.reason)})),t})).then(h(i))}return n=n||{},Object.keys(e).forEach((function(t){n[t]=Array.isArray(e[t])?e[t]:e[t].toString()})),t.fetch("_temp_view"+r,{headers:new h$3({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(n)}).then((function(t){return s=t.ok,o=t.status,t.json()})).then((function(t){if(!s)throw t.status=o,generateErrorFromResponse(t);return t})).then(h(i))}(e,i,n);if("string"!=typeof i)return m(n,i),tempViewQueue.add((function(){return createView(e,"temp_view/temp_view",i.map,i.reduce,!0,t).then((function(t){return fin(f(t).then((function(){return g(t,n)})),(function(){return t.db.destroy()}))}))})),tempViewQueue.finish();var o=i,r=parseViewName(o),a=r[1];return e.get("_design/"+r[0]).then((function(i){var r=i.views&&i.views[a];if(!r)throw new NotFoundError("ddoc "+i._id+" has no view named "+a);return s(i,a),m(n,r),createView(e,o,r.map,r.reduce,!1,t).then((function(t){return"ok"===n.stale||"update_after"===n.stale?("update_after"===n.stale&&browser$3((function(){f(t)})),g(t,n)):f(t).then((function(){return g(t,n)}))}))}))}(o,e,i)}));return promisedCallback(r,n),r},viewCleanup:callbackify((function(){var e=this;return"function"==typeof e._viewCleanup?function(t){return new Promise((function(e,i){t._viewCleanup((function(t,n){if(t)return i(t);e(n)}))}))}(e):isRemote(e)?function(t){return t.fetch("_view_cleanup",{headers:new h$3({"Content-Type":"application/json"}),method:"POST"}).then((function(t){return t.json()}))}(e):function(e){return e.get("_local/"+t).then((function(t){var i=new ExportedMap;Object.keys(t.views).forEach((function(t){var e=parseViewName(t),n="_design/"+e[0],s=e[1],o=i.get(n);o||(o=new ExportedSet,i.set(n,o)),o.add(s)}));var n={keys:mapToKeysArray(i),include_docs:!0};return e.allDocs(n).then((function(n){var s={};n.rows.forEach((function(e){var n=e.key.substring(8);i.get(e.key).forEach((function(i){var o=n+"/"+i;t.views[o]||(o=i);var r=Object.keys(t.views[o]),a=e.doc&&e.doc.views&&e.doc.views[i];r.forEach((function(t){s[t]=s[t]||a}))}))}));var o=Object.keys(s).filter((function(t){return!s[t]})).map((function(t){return sequentialize(b(t),(function(){return new e.constructor(t,e.__opts).destroy()}))()}));return Promise.all(o).then((function(){return{ok:!0}}))}))}),p({ok:!0}))}(e)}))}}var builtInReduce={_sum:function(t,e){return sum(e)},_count:function(t,e){return e.length},_stats:function(t,e){return{sum:sum(e),min:Math.min.apply(null,e),max:Math.max.apply(null,e),count:e.length,sumsqr:function(t){for(var e=0,i=0,n=t.length;i<n;i++){var s=t[i];e+=s*s}return e}(e)}}};function getBuiltIn(t){if(/^_sum/.test(t))return builtInReduce._sum;if(/^_count/.test(t))return builtInReduce._count;if(/^_stats/.test(t))return builtInReduce._stats;if(/^_/.test(t))throw new Error(t+" is not a supported reduce function.")}function mapper(t,e){if("function"==typeof t&&2===t.length){var i=t;return function(t){return i(t,e)}}return evalFunctionWithEval(t.toString(),e)}function reducer(t){var e=t.toString();return getBuiltIn(e)||evalFunctionWithEval(e)}function ddocValidator(t,e){var i=t.views&&t.views[e];if("string"!=typeof i.map)throw new NotFoundError("ddoc "+t._id+" has no string view named "+e+", instead found object of type: "+typeof i.map)}var localDocName="mrviews",abstract=createAbstractMapReduce(localDocName,mapper,reducer,ddocValidator);function query(t,e,i){return abstract.query.call(this,t,e,i)}function viewCleanup(t){return abstract.viewCleanup.call(this,t)}var mapreduce={query,viewCleanup};function isGenOne$1(t){return/^1-/.test(t)}function fileHasChanged(t,e,i){return!t._attachments||!t._attachments[i]||t._attachments[i].digest!==e._attachments[i].digest}function getDocAttachments(t,e){var i=Object.keys(e._attachments);return Promise.all(i.map((function(i){return t.getAttachment(e._id,i,{rev:e._rev})})))}function getDocAttachmentsFromTargetOrSource(t,e,i){var n=isRemote(e)&&!isRemote(t),s=Object.keys(i._attachments);return n?t.get(i._id).then((function(n){return Promise.all(s.map((function(s){return fileHasChanged(n,i,s)?e.getAttachment(i._id,s):t.getAttachment(n._id,s)})))})).catch((function(t){if(404!==t.status)throw t;return getDocAttachments(e,i)})):getDocAttachments(e,i)}function createBulkGetOpts(t){var e=[];return Object.keys(t).forEach((function(i){t[i].missing.forEach((function(t){e.push({id:i,rev:t})}))})),{docs:e,revs:!0,latest:!0}}function getDocs(t,e,i,n){i=clone$1(i);var s=[],o=!0;return Promise.resolve().then((function(){var e=Object.keys(i).filter((function(t){var e=i[t].missing;return 1===e.length&&isGenOne$1(e[0])}));if(e.length>0)return function(e){return t.allDocs({keys:e,include_docs:!0,conflicts:!0}).then((function(t){if(n.cancelled)throw new Error("cancelled");t.rows.forEach((function(t){t.deleted||!t.doc||!isGenOne$1(t.value.rev)||function(t){return t._attachments&&Object.keys(t._attachments).length>0}(t.doc)||function(t){return t._conflicts&&t._conflicts.length>0}(t.doc)||(t.doc._conflicts&&delete t.doc._conflicts,s.push(t.doc),delete i[t.id])}))}))}(e)})).then((function(){var r=createBulkGetOpts(i);if(r.docs.length)return t.bulkGet(r).then((function(i){if(n.cancelled)throw new Error("cancelled");return Promise.all(i.results.map((function(i){return Promise.all(i.docs.map((function(i){var n=i.ok;return i.error&&(o=!1),n&&n._attachments?getDocAttachmentsFromTargetOrSource(e,t,n).then((function(t){var e=Object.keys(n._attachments);return t.forEach((function(t,i){var s=n._attachments[e[i]];delete s.stub,delete s.length,s.data=t})),n})):n})))}))).then((function(t){s=s.concat(flatten(t).filter(Boolean))}))}))})).then((function(){return{ok:o,docs:s}}))}var CHECKPOINT_VERSION=1,REPLICATOR="pouchdb",CHECKPOINT_HISTORY_SIZE=5,LOWEST_SEQ=0;function updateCheckpoint(t,e,i,n,s){return t.get(e).catch((function(i){if(404===i.status)return"http"!==t.adapter&&"https"!==t.adapter||explainError(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:n,_id:e,history:[],replicator:REPLICATOR,version:CHECKPOINT_VERSION};throw i})).then((function(o){if(!s.cancelled&&o.last_seq!==i)return o.history=(o.history||[]).filter((function(t){return t.session_id!==n})),o.history.unshift({last_seq:i,session_id:n}),o.history=o.history.slice(0,CHECKPOINT_HISTORY_SIZE),o.version=CHECKPOINT_VERSION,o.replicator=REPLICATOR,o.session_id=n,o.last_seq=i,t.put(o).catch((function(o){if(409===o.status)return updateCheckpoint(t,e,i,n,s);throw o}))}))}function Checkpointer(t,e,i,n,s){this.src=t,this.target=e,this.id=i,this.returnValue=n,this.opts=s||{}}Checkpointer.prototype.writeCheckpoint=function(t,e){var i=this;return this.updateTarget(t,e).then((function(){return i.updateSource(t,e)}))},Checkpointer.prototype.updateTarget=function(t,e){return this.opts.writeTargetCheckpoint?updateCheckpoint(this.target,this.id,t,e,this.returnValue):Promise.resolve(!0)},Checkpointer.prototype.updateSource=function(t,e){if(this.opts.writeSourceCheckpoint){var i=this;return updateCheckpoint(this.src,this.id,t,e,this.returnValue).catch((function(t){if(isForbiddenError(t))return i.opts.writeSourceCheckpoint=!1,!0;throw t}))}return Promise.resolve(!0)};var comparisons={undefined:function(t,e){return 0===collate(t.last_seq,e.last_seq)?e.last_seq:0},1:function(t,e){return compareReplicationLogs(e,t).last_seq}};function compareReplicationLogs(t,e){return t.session_id===e.session_id?{last_seq:t.last_seq,history:t.history}:compareReplicationHistory(t.history,e.history)}function compareReplicationHistory(t,e){var i=t[0],n=t.slice(1),s=e[0],o=e.slice(1);return i&&0!==e.length?hasSessionId(i.session_id,e)?{last_seq:i.last_seq,history:t}:hasSessionId(s.session_id,n)?{last_seq:s.last_seq,history:o}:compareReplicationHistory(n,o):{last_seq:LOWEST_SEQ,history:[]}}function hasSessionId(t,e){var i=e[0],n=e.slice(1);return!(!t||0===e.length)&&(t===i.session_id||hasSessionId(t,n))}function isForbiddenError(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}Checkpointer.prototype.getCheckpoint=function(){var t=this;return t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then((function(t){return t.last_seq||LOWEST_SEQ})).catch((function(t){if(404!==t.status)throw t;return LOWEST_SEQ})):t.target.get(t.id).then((function(e){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?e.last_seq||LOWEST_SEQ:t.src.get(t.id).then((function(t){return e.version!==t.version?LOWEST_SEQ:(i=e.version?e.version.toString():"undefined")in comparisons?comparisons[i](e,t):LOWEST_SEQ;var i}),(function(i){if(404===i.status&&e.last_seq)return t.src.put({_id:t.id,last_seq:LOWEST_SEQ}).then((function(){return LOWEST_SEQ}),(function(i){return isForbiddenError(i)?(t.opts.writeSourceCheckpoint=!1,e.last_seq):LOWEST_SEQ}));throw i}))})).catch((function(t){if(404!==t.status)throw t;return LOWEST_SEQ}))};var STARTING_BACK_OFF=0;function backOff(t,e,i,n){if(!1===t.retry)return e.emit("error",i),void e.removeAllListeners();if("function"!=typeof t.back_off_function&&(t.back_off_function=defaultBackOff),e.emit("requestError",i),"active"===e.state||"pending"===e.state){e.emit("paused",i),e.state="stopped";var s=function(){t.current_back_off=STARTING_BACK_OFF};e.once("paused",(function(){e.removeListener("active",s)})),e.once("active",s)}t.current_back_off=t.current_back_off||STARTING_BACK_OFF,t.current_back_off=t.back_off_function(t.current_back_off),setTimeout(n,t.current_back_off)}function sortObjectPropertiesByKey(t){return Object.keys(t).sort(collate).reduce((function(e,i){return e[i]=t[i],e}),{})}function generateReplicationId(t,e,i){var n=i.doc_ids?i.doc_ids.sort(collate):"",s=i.filter?i.filter.toString():"",o="",r="",a="";return i.selector&&(a=JSON.stringify(i.selector)),i.filter&&i.query_params&&(o=JSON.stringify(sortObjectPropertiesByKey(i.query_params))),i.filter&&"_view"===i.filter&&(r=i.view.toString()),Promise.all([t.id(),e.id()]).then((function(t){var e=t[0]+t[1]+s+r+o+n+a;return new Promise((function(t){binaryMd5(e,t)}))})).then((function(t){return"_local/"+t.replace(/\//g,".").replace(/\+/g,"_")}))}function replicate(t,e,i,n,s){var o,r,a=[],l={seq:0,changes:[],docs:[]},c=!1,h=!1,d=!1,u=0,m=i.continuous||i.live||!1,p=i.batch_size||100,b=i.batches_limit||10,f=!1,g=i.doc_ids,y=i.selector,v=[],Z=uuid$1();s=s||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var x={};function G(){return r?Promise.resolve():generateReplicationId(t,e,i).then((function(s){r=new Checkpointer(t,e,s,n,!1===i.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===i.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===i.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})}))}function X(){if(v=[],0!==o.docs.length){var t=o.docs;return e.bulkDocs({docs:t,new_edits:!1},{timeout:i.timeout}).then((function(e){if(n.cancelled)throw k(),new Error("cancelled");var i=Object.create(null);e.forEach((function(t){t.error&&(i[t.id]=t)}));var o=Object.keys(i).length;s.doc_write_failures+=o,s.docs_written+=t.length-o,t.forEach((function(t){var e=i[t._id];if(e){s.errors.push(e);var o=(e.name||"").toLowerCase();if("unauthorized"!==o&&"forbidden"!==o)throw e;n.emit("denied",clone$1(e))}else v.push(t)}))}),(function(e){throw s.doc_write_failures+=t.length,e}))}}function w(){if(o.error)throw new Error("There was a problem getting docs.");s.last_seq=u=o.seq;var t=clone$1(s);return v.length&&(t.docs=v,"number"==typeof o.pending&&(t.pending=o.pending,delete o.pending),n.emit("change",t)),c=!0,r.writeCheckpoint(o.seq,Z).then((function(){if(c=!1,n.cancelled)throw k(),new Error("cancelled");o=void 0,F()})).catch((function(t){throw T(t),t}))}function V(){return getDocs(t,e,o.diffs,n).then((function(t){o.error=!t.ok,t.docs.forEach((function(t){delete o.diffs[t._id],s.docs_read++,o.docs.push(t)}))}))}function I(){var t;n.cancelled||o||(0!==a.length?(o=a.shift(),(t={},o.changes.forEach((function(e){"_user/"!==e.id&&(t[e.id]=e.changes.map((function(t){return t.rev})))})),e.revsDiff(t).then((function(t){if(n.cancelled)throw k(),new Error("cancelled");o.diffs=t}))).then(V).then(X).then(w).then(I).catch((function(t){R("batch processing terminated with error",t)}))):S(!0))}function S(t){0!==l.changes.length?(t||h||l.changes.length>=p)&&(a.push(l),l={seq:0,changes:[],docs:[]},"pending"!==n.state&&"stopped"!==n.state||(n.state="active",n.emit("active")),I()):0!==a.length||o||((m&&x.live||h)&&(n.state="pending",n.emit("paused")),h&&k())}function R(t,e){d||(e.message||(e.message=t),s.ok=!1,s.status="aborting",a=[],l={seq:0,changes:[],docs:[]},k(e))}function k(o){if(!(d||n.cancelled&&(s.status="cancelled",c)))if(s.status=s.status||"complete",s.end_time=(new Date).toISOString(),s.last_seq=u,d=!0,o){(o=createError(o)).result=s;var r=(o.name||"").toLowerCase();"unauthorized"===r||"forbidden"===r?(n.emit("error",o),n.removeAllListeners()):backOff(i,n,o,(function(){replicate(t,e,i,n)}))}else n.emit("complete",s),n.removeAllListeners()}function C(t,e,s){if(n.cancelled)return k();"number"==typeof e&&(l.pending=e),filterChange(i)(t)&&(l.seq=t.seq||s,l.changes.push(t),browser$3((function(){S(0===a.length&&x.live)})))}function W(t){if(f=!1,n.cancelled)return k();if(t.results.length>0)x.since=t.results[t.results.length-1].seq,F(),S(!0);else{var e=function(){m?(x.live=!0,F()):h=!0,S(!0)};o||0!==t.results.length?e():(c=!0,r.writeCheckpoint(t.last_seq,Z).then((function(){c=!1,s.last_seq=u=t.last_seq,e()})).catch(T))}}function L(t){if(f=!1,n.cancelled)return k();R("changes rejected",t)}function F(){if(!f&&!h&&a.length<b){f=!0,n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",s);var e=t.changes(x).on("change",C);e.then(o,o),e.then(W).catch(L),i.retry&&(n._changes=e,n._abortChanges=s)}function s(){e.cancel()}function o(){n.removeListener("cancel",s)}}function M(){G().then((function(){if(!n.cancelled)return r.getCheckpoint().then((function(t){x={since:u=t,limit:p,batch_size:p,style:"all_docs",doc_ids:g,selector:y,return_docs:!0},i.filter&&("string"!=typeof i.filter?x.include_docs=!0:x.filter=i.filter),"heartbeat"in i&&(x.heartbeat=i.heartbeat),"timeout"in i&&(x.timeout=i.timeout),i.query_params&&(x.query_params=i.query_params),i.view&&(x.view=i.view),F()}));k()})).catch((function(t){R("getCheckpoint rejected with ",t)}))}function T(t){c=!1,R("writeCheckpoint completed with error",t)}n.ready(t,e),n.cancelled?k():(n._addedListeners||(n.once("cancel",k),"function"==typeof i.complete&&(n.once("error",i.complete),n.once("complete",(function(t){i.complete(null,t)}))),n._addedListeners=!0),void 0===i.since?M():G().then((function(){return c=!0,r.writeCheckpoint(i.since,Z)})).then((function(){c=!1,n.cancelled?k():(u=i.since,M())})).catch(T))}function Replication(){EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,e=new Promise((function(e,i){t.once("complete",e),t.once("error",i)}));t.then=function(t,i){return e.then(t,i)},t.catch=function(t){return e.catch(t)},t.catch((function(){}))}function toPouch(t,e){return"string"==typeof t?new(0,e.PouchConstructor)(t,e):t}function replicateWrapper(t,e,i,n){if("function"==typeof i&&(n=i,i={}),void 0===i&&(i={}),i.doc_ids&&!Array.isArray(i.doc_ids))throw createError(BAD_REQUEST,"`doc_ids` filter parameter is not a list.");i.complete=n,(i=clone$1(i)).continuous=i.continuous||i.live,i.retry="retry"in i&&i.retry,i.PouchConstructor=i.PouchConstructor||this;var s=new Replication(i);return replicate(toPouch(t,i),toPouch(e,i),i,s),s}function sync(t,e,i,n){return"function"==typeof i&&(n=i,i={}),void 0===i&&(i={}),(i=clone$1(i)).PouchConstructor=i.PouchConstructor||this,new Sync(t=toPouch(t,i),e=toPouch(e,i),i,n)}function Sync(t,e,i,n){var s=this;this.canceled=!1;var o=i.push?$inject_Object_assign({},i,i.push):i,r=i.pull?$inject_Object_assign({},i,i.pull):i;function a(t){s.emit("change",{direction:"pull",change:t})}function l(t){s.emit("change",{direction:"push",change:t})}function c(t){s.emit("denied",{direction:"push",doc:t})}function h(t){s.emit("denied",{direction:"pull",doc:t})}function d(){s.pushPaused=!0,s.pullPaused&&s.emit("paused")}function u(){s.pullPaused=!0,s.pushPaused&&s.emit("paused")}function m(){s.pushPaused=!1,s.pullPaused&&s.emit("active",{direction:"push"})}function p(){s.pullPaused=!1,s.pushPaused&&s.emit("active",{direction:"pull"})}this.push=replicateWrapper(t,e,o),this.pull=replicateWrapper(e,t,r),this.pushPaused=!0,this.pullPaused=!0;var b={};function f(t){return function(e,i){("change"===e&&(i===a||i===l)||"denied"===e&&(i===h||i===c)||"paused"===e&&(i===u||i===d)||"active"===e&&(i===p||i===m))&&(e in b||(b[e]={}),b[e][t]=!0,2===Object.keys(b[e]).length&&s.removeAllListeners(e))}}function g(t,e,i){-1==t.listeners(e).indexOf(i)&&t.on(e,i)}i.live&&(this.push.on("complete",s.pull.cancel.bind(s.pull)),this.pull.on("complete",s.push.cancel.bind(s.push))),this.on("newListener",(function(t){"change"===t?(g(s.pull,"change",a),g(s.push,"change",l)):"denied"===t?(g(s.pull,"denied",h),g(s.push,"denied",c)):"active"===t?(g(s.pull,"active",p),g(s.push,"active",m)):"paused"===t&&(g(s.pull,"paused",u),g(s.push,"paused",d))})),this.on("removeListener",(function(t){"change"===t?(s.pull.removeListener("change",a),s.push.removeListener("change",l)):"denied"===t?(s.pull.removeListener("denied",h),s.push.removeListener("denied",c)):"active"===t?(s.pull.removeListener("active",p),s.push.removeListener("active",m)):"paused"===t&&(s.pull.removeListener("paused",u),s.push.removeListener("paused",d))})),this.pull.on("removeListener",f("pull")),this.push.on("removeListener",f("push"));var y=Promise.all([this.push,this.pull]).then((function(t){var e={push:t[0],pull:t[1]};return s.emit("complete",e),n&&n(null,e),s.removeAllListeners(),e}),(function(t){if(s.cancel(),n?n(t):s.emit("error",t),s.removeAllListeners(),n)throw t}));this.then=function(t,e){return y.then(t,e)},this.catch=function(t){return y.catch(t)}}function replication(t){t.replicate=replicateWrapper,t.sync=sync,Object.defineProperty(t.prototype,"replicate",{get:function(){var t=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(e,i,n){return t.constructor.replicate(e,t,i,n)},to:function(e,i,n){return t.constructor.replicate(t,e,i,n)}}),this.replicateMethods}}),t.prototype.sync=function(t,e,i){return this.constructor.sync(this,t,e,i)}}function PouchError$1(t,e,i){Error.call(this,i),this.status=t,this.name=e,this.message=i,this.error=!0}inherits_browser(Replication,EventEmitter),Replication.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},Replication.prototype.ready=function(t,e){var i=this;function n(){i.cancel()}i._readyCalled||(i._readyCalled=!0,t.once("destroyed",n),e.once("destroyed",n),i.once("complete",(function(){t.removeListener("destroyed",n),e.removeListener("destroyed",n)})))},inherits_browser(Sync,EventEmitter),Sync.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},PouchDB.plugin(IDBPouch).plugin(HttpPouch$1).plugin(mapreduce).plugin(replication),inherits_browser(PouchError$1,Error),PouchError$1.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED$1=new PouchError$1(401,"unauthorized","Name or password is incorrect."),MISSING_BULK_DOCS$1=new PouchError$1(400,"bad_request","Missing JSON list of 'docs'"),MISSING_DOC$1=new PouchError$1(404,"not_found","missing"),REV_CONFLICT$1=new PouchError$1(409,"conflict","Document update conflict"),INVALID_ID$1=new PouchError$1(400,"bad_request","_id field must contain a string"),MISSING_ID$1=new PouchError$1(412,"missing_id","_id is required for puts"),RESERVED_ID$1=new PouchError$1(400,"bad_request","Only reserved document ids may start with underscore."),NOT_OPEN$1=new PouchError$1(412,"precondition_failed","Database not open"),UNKNOWN_ERROR$1=new PouchError$1(500,"unknown_error","Database encountered an unknown error"),BAD_ARG$1=new PouchError$1(500,"badarg","Some query argument is invalid"),INVALID_REQUEST$1=new PouchError$1(400,"invalid_request","Request was invalid"),QUERY_PARSE_ERROR$1=new PouchError$1(400,"query_parse_error","Some query parameter is invalid"),DOC_VALIDATION$1=new PouchError$1(500,"doc_validation","Bad special document member"),BAD_REQUEST$1=new PouchError$1(400,"bad_request","Something wrong with the request"),NOT_AN_OBJECT$1=new PouchError$1(400,"bad_request","Document must be a JSON object"),DB_MISSING$1=new PouchError$1(404,"not_found","Database not found"),IDB_ERROR$1=new PouchError$1(500,"indexed_db_went_bad","unknown"),WSQ_ERROR$1=new PouchError$1(500,"web_sql_went_bad","unknown"),LDB_ERROR$1=new PouchError$1(500,"levelDB_went_went_bad","unknown"),FORBIDDEN$1=new PouchError$1(403,"forbidden","Forbidden by design doc validate_doc_update function"),INVALID_REV$1=new PouchError$1(400,"bad_request","Invalid rev format"),FILE_EXISTS$1=new PouchError$1(412,"file_exists","The database could not be created, the file already exists."),MISSING_STUB$1=new PouchError$1(412,"missing_stub","A pre-existing attachment stub wasn't found"),INVALID_URL$1=new PouchError$1(413,"invalid_url","Provided URL is invalid");function generateErrorFromResponse$1(t){if("object"!=typeof t){var e=t;(t=UNKNOWN_ERROR$1).data=e}return"error"in t&&"conflict"===t.error&&(t.name="conflict",t.status=409),"name"in t||(t.name=t.error||"unknown"),"status"in t||(t.status=500),"message"in t||(t.message=t.message||t.reason),t}var h$4=Headers,ExportedSet$1,ExportedMap$1;function mangle$1(t){return"$"+t}function unmangle$1(t){return t.substring(1)}function Map$1$1(){this._store={}}function Set$1$1(t){if(this._store=new Map$1$1,t&&Array.isArray(t))for(var e=0,i=t.length;e<i;e++)this.add(t[e])}function supportsMapAndSet$1(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}Map$1$1.prototype.get=function(t){var e=mangle$1(t);return this._store[e]},Map$1$1.prototype.set=function(t,e){var i=mangle$1(t);return this._store[i]=e,!0},Map$1$1.prototype.has=function(t){return mangle$1(t)in this._store},Map$1$1.prototype.delete=function(t){var e=mangle$1(t),i=e in this._store;return delete this._store[e],i},Map$1$1.prototype.forEach=function(t){for(var e=Object.keys(this._store),i=0,n=e.length;i<n;i++){var s=e[i];t(this._store[s],s=unmangle$1(s))}},Object.defineProperty(Map$1$1.prototype,"size",{get:function(){return Object.keys(this._store).length}}),Set$1$1.prototype.add=function(t){return this._store.set(t,!0)},Set$1$1.prototype.has=function(t){return this._store.has(t)},Set$1$1.prototype.forEach=function(t){this._store.forEach((function(e,i){t(i)}))},Object.defineProperty(Set$1$1.prototype,"size",{get:function(){return this._store.size}}),supportsMapAndSet$1()?(ExportedSet$1=Set,ExportedMap$1=Map):(ExportedSet$1=Set$1$1,ExportedMap$1=Map$1$1);var thisAtob$1=function(t){return atob(t)};function createBlob$1(t,i){t=t||[],i=i||{};try{return new Blob(t,i)}catch(e){if("TypeError"!==e.name)throw e;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),s=0;s<t.length;s+=1)n.append(t[s]);return n.getBlob(i.type)}}function binaryStringToArrayBuffer$1(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),s=0;s<e;s++)n[s]=t.charCodeAt(s);return i}function binStringToBluffer$1(t,e){return createBlob$1([binaryStringToArrayBuffer$1(t)],{type:e})}function b64ToBluffer$1(t,e){return binStringToBluffer$1(thisAtob$1(t),e)}function pad$1(t,e,i){for(var n="",s=i-t.length;n.length<s;)n+=e;return n}function padLeft$1(t,e,i){return pad$1(t,e,i)+t}var MIN_MAGNITUDE$1=-324,MAGNITUDE_DIGITS$1=3,SEP$1="";function collate$1(t,e){if(t===e)return 0;t=normalizeKey$1(t),e=normalizeKey$1(e);var i=collationIndex$1(t),n=collationIndex$1(e);if(i-n!=0)return i-n;switch(typeof t){case"number":return t-e;case"boolean":return t<e?-1:1;case"string":return stringCollate$1(t,e)}return Array.isArray(t)?arrayCollate$1(t,e):objectCollate$1(t,e)}function normalizeKey$1(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var e=t;if(Array.isArray(t)){var i=t.length;t=new Array(i);for(var n=0;n<i;n++)t[n]=normalizeKey$1(e[n])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var s in t={},e)if(e.hasOwnProperty(s)){var o=e[s];void 0!==o&&(t[s]=normalizeKey$1(o))}}}return t}function indexify$1(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return numToIndexableString$1(t);case"string":return t.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(t),i=e?t:Object.keys(t),n=-1,s=i.length,o="";if(e)for(;++n<s;)o+=toIndexableString$1(i[n]);else for(;++n<s;){var r=i[n];o+=toIndexableString$1(r)+toIndexableString$1(t[r])}return o}return""}function toIndexableString$1(t){return collationIndex$1(t=normalizeKey$1(t))+SEP$1+indexify$1(t)+"\0"}function parseNumber$1(t,e){var i,n=e;if("1"===t[e])i=0,e++;else{var s="0"===t[e];e++;var o="",r=t.substring(e,e+MAGNITUDE_DIGITS$1),a=parseInt(r,10)+MIN_MAGNITUDE$1;for(s&&(a=-a),e+=MAGNITUDE_DIGITS$1;;){var l=t[e];if("\0"===l)break;o+=l,e++}i=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),s&&(i-=10),0!==a&&(i=parseFloat(i+"e"+a))}return{num:i,length:e-n}}function pop$2(t,e){var i=t.pop();if(e.length){var n=e[e.length-1];i===n.element&&(e.pop(),n=e[e.length-1]);var s=n.element,o=n.index;Array.isArray(s)?s.push(i):o===t.length-2?s[t.pop()]=i:t.push(i)}}function parseIndexableString$1(t){for(var e=[],i=[],n=0;;){var s=t[n++];if("\0"!==s)switch(s){case"1":e.push(null);break;case"2":e.push("1"===t[n]),n++;break;case"3":var o=parseNumber$1(t,n);e.push(o.num),n+=o.length;break;case"4":for(var r="";;){var a=t[n];if("\0"===a)break;r+=a,n++}r=r.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(r);break;case"5":var l={element:[],index:e.length};e.push(l.element),i.push(l);break;case"6":var c={element:{},index:e.length};e.push(c.element),i.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+s)}else{if(1===e.length)return e.pop();pop$2(e,i)}}}function arrayCollate$1(t,e){for(var i=Math.min(t.length,e.length),n=0;n<i;n++){var s=collate$1(t[n],e[n]);if(0!==s)return s}return t.length===e.length?0:t.length>e.length?1:-1}function stringCollate$1(t,e){return t===e?0:t>e?1:-1}function objectCollate$1(t,e){for(var i=Object.keys(t),n=Object.keys(e),s=Math.min(i.length,n.length),o=0;o<s;o++){var r=collate$1(i[o],n[o]);if(0!==r)return r;if(0!==(r=collate$1(t[i[o]],e[n[o]])))return r}return i.length===n.length?0:i.length>n.length?1:-1}function collationIndex$1(t){var e=["boolean","number","string","object"].indexOf(typeof t);return~e?null===t?1:Array.isArray(t)?5:e<3?e+2:e+3:Array.isArray(t)?5:void 0}function numToIndexableString$1(t){if(0===t)return"1";var e=t.toExponential().split(/e\+?/),i=parseInt(e[1],10),n=t<0,s=n?"0":"2",o=padLeft$1(((n?-i:i)-MIN_MAGNITUDE$1).toString(),"0",MAGNITUDE_DIGITS$1);s+=SEP$1+o;var r=Math.abs(parseFloat(e[0]));n&&(r=10-r);var a=r.toFixed(20);return a=a.replace(/\.?0+$/,""),s+(SEP$1+a)}function stringMd5$1(t){return sparkMd5.hash(t)}function isBinaryObject$1(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}function cloneArrayBuffer$1(t){if("function"==typeof t.slice)return t.slice(0);var e=new ArrayBuffer(t.byteLength),i=new Uint8Array(e),n=new Uint8Array(t);return i.set(n),e}function cloneBinaryObject$1(t){if(t instanceof ArrayBuffer)return cloneArrayBuffer$1(t);var e=t.size,i=t.type;return"function"==typeof t.slice?t.slice(0,e,i):t.webkitSlice(0,e,i)}var funcToString$1=Function.prototype.toString,objectCtorString$1=funcToString$1.call(Object),hasLocal$1,assign$1;function isPlainObject$1(t){var e=Object.getPrototypeOf(t);if(null===e)return!0;var i=e.constructor;return"function"==typeof i&&i instanceof i&&funcToString$1.call(i)==objectCtorString$1}function clone$2(t){var e,i,n;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){for(e=[],i=0,n=t.length;i<n;i++)e[i]=clone$2(t[i]);return e}if(t instanceof Date)return t.toISOString();if(isBinaryObject$1(t))return cloneBinaryObject$1(t);if(!isPlainObject$1(t))return t;for(i in e={},t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=clone$2(t[i]);void 0!==s&&(e[i]=s)}return e}function once$1(t){var e=!1;return argsarray((function(i){if(e)throw new Error("once called more than once");e=!0,t.apply(this,i)}))}function toPromise$1(t){return argsarray((function(i){i=clone$2(i);var n=this,s="function"==typeof i[i.length-1]&&i.pop(),o=new Promise((function(s,o){var r;try{var a=once$1((function(t,e){t?o(t):s(e)}));i.push(a),(r=t.apply(n,i))&&"function"==typeof r.then&&s(r)}catch(e){o(e)}}));return s&&o.then((function(t){s(null,t)}),s),o}))}function pick$1(t,e){for(var i={},n=0,s=e.length;n<s;n++){var o=e[n];o in t&&(i[o]=t[o])}return i}try{localStorage.setItem("_pouch_check_localstorage",1),hasLocal$1=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){hasLocal$1=!1}function hasLocalStorage$1(){return hasLocal$1}function attachBrowserEvents$1(t){hasLocalStorage$1()&&addEventListener("storage",(function(e){t.emit(e.key)}))}function Changes$2(){EventEmitter.call(this),this._listeners={},attachBrowserEvents$1(this)}function guardedConsole$1(t){if("undefined"!=typeof console&&"function"==typeof console[t]){var e=Array.prototype.slice.call(arguments,1);console[t].apply(console,e)}}inherits_browser(Changes$2,EventEmitter),Changes$2.prototype.addListener=function(t,e,i,n){if(!this._listeners[e]){var s=this,o=!1;this._listeners[e]=r,this.on(t,r)}function r(){if(s._listeners[e])if(o)o="waiting";else{o=!0;var t=pick$1(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);i.changes(t).on("change",(function(t){t.seq>n.since&&!n.cancelled&&(n.since=t.seq,n.onChange(t))})).on("complete",(function(){"waiting"===o&&browser$3(r),o=!1})).on("error",(function(){o=!1}))}}},Changes$2.prototype.removeListener=function(t,e){e in this._listeners&&(EventEmitter.prototype.removeListener.call(this,t,this._listeners[e]),delete this._listeners[e])},Changes$2.prototype.notifyLocalWindows=function(t){hasLocalStorage$1()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},Changes$2.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)},assign$1="function"==typeof Object.assign?Object.assign:function(t){for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};var assign$1$1=assign$1;function flatten$1(t){for(var e=[],i=0,n=t.length;i<n;i++)e=e.concat(t[i]);return e}function isRemote$1(t){return"boolean"==typeof t._remote?t._remote:"function"==typeof t.type&&(guardedConsole$1("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function upsert$1(t,e,i){return new Promise((function(n,s){t.get(e,(function(o,r){if(o){if(404!==o.status)return s(o);r={}}var a=r._rev,l=i(r);if(!l)return n({updated:!1,rev:a});l._id=e,l._rev=a,n(tryAndPut$1(t,l,i))}))}))}function tryAndPut$1(t,e,i){return t.put(e).then((function(t){return{updated:!0,rev:t.rev}}),(function(n){if(409!==n.status)throw n;return upsert$1(t,e._id,i)}))}function QueryParseError$1(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,QueryParseError$1)}catch(e){}}function NotFoundError$1(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,NotFoundError$1)}catch(e){}}function BuiltInError$1(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,BuiltInError$1)}catch(e){}}function promisedCallback$1(t,e){return e&&t.then((function(t){browser$3((function(){e(null,t)}))}),(function(t){browser$3((function(){e(t)}))})),t}function callbackify$1(t){return argsarray((function(e){var i=e.pop(),n=t.apply(this,e);return"function"==typeof i&&promisedCallback$1(n,i),n}))}function fin$1(t,e){return t.then((function(t){return e().then((function(){return t}))}),(function(t){return e().then((function(){throw t}))}))}function sequentialize$1(t,e){return function(){var i=arguments,n=this;return t.add((function(){return e.apply(n,i)}))}}function uniq$1(t){var e=new ExportedSet$1(t),i=new Array(e.size),n=-1;return e.forEach((function(t){i[++n]=t})),i}function mapToKeysArray$1(t){var e=new Array(t.size),i=-1;return t.forEach((function(t,n){e[++i]=n})),e}function TaskQueue$2(){this.promise=new Promise((function(t){t()}))}function stringify$2(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function createViewSignature$1(t,e){return stringify$2(t)+stringify$2(e)+"undefined"}function createView$1(t,e,i,n,s,o){var r,a=createViewSignature$1(i,n);if(!s&&(r=t._cachedViews=t._cachedViews||{})[a])return r[a];var l=t.info().then((function(l){var c=l.db_name+"-mrview-"+(s?"temp":stringMd5$1(a));return upsert$1(t,"_local/"+o,(function(t){t.views=t.views||{};var i=e;-1===i.indexOf("/")&&(i=e+"/"+e);var n=t.views[i]=t.views[i]||{};if(!n[c])return n[c]=!0,t})).then((function(){return t.registerDependentDatabase(c).then((function(e){var s=e.db;s.auto_compaction=!0;var o={name:c,db:s,sourceDB:t,adapter:t.adapter,mapFun:i,reduceFun:n};return o.db.get("_local/lastSeq").catch((function(t){if(404!==t.status)throw t})).then((function(t){return o.seq=t?t.seq:0,r&&o.db.once("destroyed",(function(){delete r[a]})),o}))}))}))}));return r&&(r[a]=l),l}inherits_browser(QueryParseError$1,Error),inherits_browser(NotFoundError$1,Error),inherits_browser(BuiltInError$1,Error),TaskQueue$2.prototype.add=function(t){return this.promise=this.promise.catch((function(){})).then((function(){return t()})),this.promise},TaskQueue$2.prototype.finish=function(){return this.promise};var persistentQueues$1={},tempViewQueue$1=new TaskQueue$2,CHANGES_BATCH_SIZE$2=50;function parseViewName$1(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function isGenOne$2(t){return 1===t.length&&/^1-/.test(t[0].rev)}function emitError$1(t,e){try{t.emit("error",e)}catch(i){guardedConsole$1("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),guardedConsole$1("error",e)}}function createAbstractMapReduce$1(t,i,n,s){function o(t,i,n){try{i(n)}catch(e){emitError$1(t,e)}}function r(t,i,n,s,o){try{return{output:i(n,s,o)}}catch(e){return emitError$1(t,e),{error:e}}}function a(t,e){var i=collate$1(t.key,e.key);return 0!==i?i:collate$1(t.value,e.value)}function l(t,e,i){return i=i||0,"number"==typeof e?t.slice(i,e+i):i>0?t.slice(i):t}function c(t){var e=t.value;return e&&"object"==typeof e&&e._id||t.id}function h(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&function(t){t.rows.forEach((function(t){var e=t.doc&&t.doc._attachments;e&&Object.keys(e).forEach((function(t){var i=e[t];e[t].data=b64ToBluffer$1(i.data,i.content_type)}))}))}(e),e}}function d(t,e,i,n){var s=e[t];void 0!==s&&(n&&(s=encodeURIComponent(JSON.stringify(s))),i.push(t+"="+s))}function u(t){if(void 0!==t){var e=Number(t);return isNaN(e)||e!==parseInt(t,10)?t:e}}function m(t,e){var i=t.descending?"endkey":"startkey",n=t.descending?"startkey":"endkey";if(void 0!==t[i]&&void 0!==t[n]&&collate$1(t[i],t[n])>0)throw new QueryParseError$1("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new QueryParseError$1("{include_docs:true} is invalid for reduce");if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level)throw new QueryParseError$1("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach((function(e){var i=function(t){if(t){if("number"!=typeof t)return new QueryParseError$1('Invalid value for integer: "'+t+'"');if(t<0)return new QueryParseError$1('Invalid value for positive integer: "'+t+'"')}}(t[e]);if(i)throw i}))}function p(t){return function(e){if(404===e.status)return t;throw e}}function b(t){var e="string"==typeof t?t:t.name,i=persistentQueues$1[e];return i||(i=persistentQueues$1[e]=new TaskQueue$2),i}function f(t){return sequentialize$1(b(t),(function(){return function(t){var e,n,s=i(t.mapFun,(function(t,i){var s={id:n._id,key:normalizeKey$1(t)};null!=i&&(s.value=normalizeKey$1(i)),e.push(s)})),r=t.seq||0;function l(e,i){return function(){return function(t,e,i){return t.db.get("_local/lastSeq").catch(p({_id:"_local/lastSeq",seq:0})).then((function(n){var s=mapToKeysArray$1(e);return Promise.all(s.map((function(i){return function(t,e,i){var n="_local/doc_"+t,s={_id:n,keys:[]},o=i.get(t),r=o[0];return(isGenOne$2(o[1])?Promise.resolve(s):e.db.get(n).catch(p(s))).then((function(t){return function(t){return t.keys.length?e.db.allDocs({keys:t.keys,include_docs:!0}):Promise.resolve({rows:[]})}(t).then((function(e){return function(t,e){for(var i=[],n=new ExportedSet$1,s=0,o=e.rows.length;s<o;s++){var a=e.rows[s].doc;if(a&&(i.push(a),n.add(a._id),a._deleted=!r.has(a._id),!a._deleted)){var l=r.get(a._id);"value"in l&&(a.value=l.value)}}var c=mapToKeysArray$1(r);return c.forEach((function(t){if(!n.has(t)){var e={_id:t},s=r.get(t);"value"in s&&(e.value=s.value),i.push(e)}})),t.keys=uniq$1(c.concat(t.keys)),i.push(t),i}(t,e)}))}))}(i,t,e)}))).then((function(e){var s=flatten$1(e);return n.seq=i,s.push(n),t.db.bulkDocs({docs:s})}))}))}(t,e,i)}}var c=new TaskQueue$2;function h(){return t.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:r,limit:CHANGES_BATCH_SIZE$2}).then(d)}function d(i){var d=i.results;if(d.length){var m=function(i){for(var l=new ExportedMap$1,c=0,h=i.length;c<h;c++){var d=i[c];if("_"!==d.doc._id[0]){e=[],(n=d.doc)._deleted||o(t.sourceDB,s,n),e.sort(a);var m=u(e);l.set(d.doc._id,[m,d.changes])}r=d.seq}return l}(d);if(c.add(l(m,r)),!(d.length<CHANGES_BATCH_SIZE$2))return h()}}function u(t){for(var e,i=new ExportedMap$1,n=0,s=t.length;n<s;n++){var o=t[n],r=[o.key,o.id];n>0&&0===collate$1(o.key,e)&&r.push(n),i.set(toIndexableString$1(r),o),e=o.key}return i}return h().then((function(){return c.finish()})).then((function(){t.seq=r}))}(t)}))()}function g(t,e){return sequentialize$1(b(t),(function(){return function(t,e){var i,s=t.reduceFun&&!1!==e.reduce,o=e.skip||0;function a(e){return e.include_docs=!0,t.db.allDocs(e).then((function(t){return i=t.total_rows,t.rows.map((function(t){if("value"in t.doc&&"object"==typeof t.doc.value&&null!==t.doc.value){var e=Object.keys(t.doc.value).sort(),i=["id","key","value"];if(!(e<i||e>i))return t.doc.value}var n=parseIndexableString$1(t.doc._id);return{key:n[0],id:n[1],value:"value"in t.doc?t.doc.value:null}}))}))}function h(a){var h;if(h=s?function(t,e,i){0===i.group_level&&delete i.group_level;var s=i.group||i.group_level,o=n(t.reduceFun),a=[],c=isNaN(i.group_level)?Number.POSITIVE_INFINITY:i.group_level;e.forEach((function(t){var e=a[a.length-1],i=s?t.key:null;if(s&&Array.isArray(i)&&(i=i.slice(0,c)),e&&0===collate$1(e.groupKey,i))return e.keys.push([t.key,t.id]),void e.values.push(t.value);a.push({keys:[[t.key,t.id]],values:[t.value],groupKey:i})})),e=[];for(var h=0,d=a.length;h<d;h++){var u=a[h],m=r(t.sourceDB,o,u.keys,u.values,!1);if(m.error&&m.error instanceof BuiltInError$1)throw m.error;e.push({value:m.error?null:m.output,key:u.groupKey})}return{rows:l(e,i.limit,i.skip)}}(t,a,e):{total_rows:i,offset:o,rows:a},e.update_seq&&(h.update_seq=t.seq),e.include_docs){var d=uniq$1(a.map(c));return t.sourceDB.allDocs({keys:d,include_docs:!0,conflicts:e.conflicts,attachments:e.attachments,binary:e.binary}).then((function(t){var e=new ExportedMap$1;return t.rows.forEach((function(t){e.set(t.id,t.doc)})),a.forEach((function(t){var i=c(t),n=e.get(i);n&&(t.doc=n)})),h}))}return h}if(void 0===e.keys||e.keys.length||(e.limit=0,delete e.keys),void 0!==e.keys){var d=e.keys.map((function(t){var i={startkey:toIndexableString$1([t]),endkey:toIndexableString$1([t,{}])};return e.update_seq&&(i.update_seq=!0),a(i)}));return Promise.all(d).then(flatten$1).then(h)}var u,m,p={descending:e.descending};if(e.update_seq&&(p.update_seq=!0),"start_key"in e&&(u=e.start_key),"startkey"in e&&(u=e.startkey),"end_key"in e&&(m=e.end_key),"endkey"in e&&(m=e.endkey),void 0!==u&&(p.startkey=toIndexableString$1(e.descending?[u,{}]:[u])),void 0!==m){var b=!1!==e.inclusive_end;e.descending&&(b=!b),p.endkey=toIndexableString$1(b?[m,{}]:[m])}if(void 0!==e.key){var f=toIndexableString$1([e.key]),g=toIndexableString$1([e.key,{}]);p.descending?(p.endkey=f,p.startkey=g):(p.startkey=f,p.endkey=g)}return s||("number"==typeof e.limit&&(p.limit=e.limit),p.skip=o),a(p).then(h)}(t,e)}))()}return{query:function(e,i,n){var o=this;"function"==typeof i&&(n=i,i={}),i=i?function(t){return t.group_level=u(t.group_level),t.limit=u(t.limit),t.skip=u(t.skip),t}(i):{},"function"==typeof e&&(e={map:e});var r=Promise.resolve().then((function(){return function(e,i,n){if("function"==typeof e._query)return function(t,e,i){return new Promise((function(n,s){t._query(e,i,(function(t,e){if(t)return s(t);n(e)}))}))}(e,i,n);if(isRemote$1(e))return function(t,e,i){var n,s,o,r=[],a="GET";if(d("reduce",i,r),d("include_docs",i,r),d("attachments",i,r),d("limit",i,r),d("descending",i,r),d("group",i,r),d("group_level",i,r),d("skip",i,r),d("stale",i,r),d("conflicts",i,r),d("startkey",i,r,!0),d("start_key",i,r,!0),d("endkey",i,r,!0),d("end_key",i,r,!0),d("inclusive_end",i,r),d("key",i,r,!0),d("update_seq",i,r),r=""===(r=r.join("&"))?"":"?"+r,void 0!==i.keys){var l="keys="+encodeURIComponent(JSON.stringify(i.keys));l.length+r.length+1<=2e3?r+=("?"===r[0]?"&":"?")+l:(a="POST","string"==typeof e?n={keys:i.keys}:e.keys=i.keys)}if("string"==typeof e){var c=parseViewName$1(e);return t.fetch("_design/"+c[0]+"/_view/"+c[1]+r,{headers:new h$4({"Content-Type":"application/json"}),method:a,body:JSON.stringify(n)}).then((function(t){return s=t.ok,o=t.status,t.json()})).then((function(t){if(!s)throw t.status=o,generateErrorFromResponse$1(t);return t.rows.forEach((function(t){if(t.value&&t.value.error&&"builtin_reduce_error"===t.value.error)throw new Error(t.reason)})),t})).then(h(i))}return n=n||{},Object.keys(e).forEach((function(t){n[t]=Array.isArray(e[t])?e[t]:e[t].toString()})),t.fetch("_temp_view"+r,{headers:new h$4({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(n)}).then((function(t){return s=t.ok,o=t.status,t.json()})).then((function(t){if(!s)throw t.status=o,generateErrorFromResponse$1(t);return t})).then(h(i))}(e,i,n);if("string"!=typeof i)return m(n,i),tempViewQueue$1.add((function(){return createView$1(e,"temp_view/temp_view",i.map,i.reduce,!0,t).then((function(t){return fin$1(f(t).then((function(){return g(t,n)})),(function(){return t.db.destroy()}))}))})),tempViewQueue$1.finish();var o=i,r=parseViewName$1(o),a=r[1];return e.get("_design/"+r[0]).then((function(i){var r=i.views&&i.views[a];if(!r)throw new NotFoundError$1("ddoc "+i._id+" has no view named "+a);return s(i,a),m(n,r),createView$1(e,o,r.map,r.reduce,!1,t).then((function(t){return"ok"===n.stale||"update_after"===n.stale?("update_after"===n.stale&&browser$3((function(){f(t)})),g(t,n)):f(t).then((function(){return g(t,n)}))}))}))}(o,e,i)}));return promisedCallback$1(r,n),r},viewCleanup:callbackify$1((function(){var e=this;return"function"==typeof e._viewCleanup?function(t){return new Promise((function(e,i){t._viewCleanup((function(t,n){if(t)return i(t);e(n)}))}))}(e):isRemote$1(e)?function(t){return t.fetch("_view_cleanup",{headers:new h$4({"Content-Type":"application/json"}),method:"POST"}).then((function(t){return t.json()}))}(e):function(e){return e.get("_local/"+t).then((function(t){var i=new ExportedMap$1;Object.keys(t.views).forEach((function(t){var e=parseViewName$1(t),n="_design/"+e[0],s=e[1],o=i.get(n);o||(o=new ExportedSet$1,i.set(n,o)),o.add(s)}));var n={keys:mapToKeysArray$1(i),include_docs:!0};return e.allDocs(n).then((function(n){var s={};n.rows.forEach((function(e){var n=e.key.substring(8);i.get(e.key).forEach((function(i){var o=n+"/"+i;t.views[o]||(o=i);var r=Object.keys(t.views[o]),a=e.doc&&e.doc.views&&e.doc.views[i];r.forEach((function(t){s[t]=s[t]||a}))}))}));var o=Object.keys(s).filter((function(t){return!s[t]})).map((function(t){return sequentialize$1(b(t),(function(){return new e.constructor(t,e.__opts).destroy()}))()}));return Promise.all(o).then((function(){return{ok:!0}}))}))}),p({ok:!0}))}(e)}))}}function getFieldFromDoc$1(t,e){for(var i=t,n=0,s=e.length;n<s&&(i=i[e[n]]);n++);return i}function setFieldInDoc(t,e,i){for(var n=0,s=e.length;n<s-1;n++){var o=e[n];t=t[o]=t[o]||{}}t[e[s-1]]=i}function compare$2(t,e){return t<e?-1:t>e?1:0}function parseField$1(t){for(var e=[],i="",n=0,s=t.length;n<s;n++){var o=t[n];"."===o?n>0&&"\\"===t[n-1]?i=i.substring(0,i.length-1)+".":(e.push(i),i=""):i+=o}return e.push(i),e}var combinationFields$1=["$or","$nor","$not"];function isCombinationalField$1(t){return combinationFields$1.indexOf(t)>-1}function getKey$1(t){return Object.keys(t)[0]}function getValue$2(t){return t[getKey$1(t)]}function mergeAndedSelectors$1(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(i){var n=t[i];if("object"!=typeof n&&(n={$eq:n}),isCombinationalField$1(i))e[i]=n instanceof Array?n.map((function(t){return mergeAndedSelectors$1([t])})):mergeAndedSelectors$1([n]);else{var s=e[i]=e[i]||{};Object.keys(n).forEach((function(t){var e=n[t];return"$gt"===t||"$gte"===t?mergeGtGte$1(t,e,s):"$lt"===t||"$lte"===t?mergeLtLte$1(t,e,s):"$ne"===t?mergeNe$1(e,s):"$eq"===t?mergeEq$1(e,s):void(s[t]=e)}))}}))})),e}function mergeGtGte$1(t,e,i){void 0===i.$eq&&(void 0!==i.$gte?"$gte"===t?e>i.$gte&&(i.$gte=e):e>=i.$gte&&(delete i.$gte,i.$gt=e):void 0!==i.$gt?"$gte"===t?e>i.$gt&&(delete i.$gt,i.$gte=e):e>i.$gt&&(i.$gt=e):i[t]=e)}function mergeLtLte$1(t,e,i){void 0===i.$eq&&(void 0!==i.$lte?"$lte"===t?e<i.$lte&&(i.$lte=e):e<=i.$lte&&(delete i.$lte,i.$lt=e):void 0!==i.$lt?"$lte"===t?e<i.$lt&&(delete i.$lt,i.$lte=e):e<i.$lt&&(i.$lt=e):i[t]=e)}function mergeNe$1(t,e){"$ne"in e?e.$ne.push(t):e.$ne=[t]}function mergeEq$1(t,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=t}function mergeAndedSelectorsNested$1(t){for(var e in t){if(Array.isArray(t))for(var i in t)t[i].$and&&(t[i]=mergeAndedSelectors$1(t[i].$and));var n=t[e];"object"==typeof n&&mergeAndedSelectorsNested$1(n)}return t}function isAndInSelector$1(t,e){for(var i in t){"$and"===i&&(e=!0);var n=t[i];"object"==typeof n&&(e=isAndInSelector$1(n,e))}return e}function massageSelector$1(t){var e=clone$2(t),i=!1;isAndInSelector$1(e,!1)&&("$and"in(e=mergeAndedSelectorsNested$1(e))&&(e=mergeAndedSelectors$1(e.$and)),i=!0),["$or","$nor"].forEach((function(t){t in e&&e[t].forEach((function(t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i],s=t[n];"object"==typeof s&&null!==s||(t[n]={$eq:s})}}))})),"$not"in e&&(e.$not=mergeAndedSelectors$1([e.$not]));for(var n=Object.keys(e),s=0;s<n.length;s++){var o=n[s],r=e[o];"object"!=typeof r||null===r?r={$eq:r}:"$ne"in r&&!i&&(r.$ne=[r.$ne]),e[o]=r}return e}function createFieldSorter$1(t){function e(e){return t.map((function(t){var i=parseField$1(getKey$1(t));return getFieldFromDoc$1(e,i)}))}return function(t,i){var n=collate$1(e(t.doc),e(i.doc));return 0!==n?n:compare$2(t.doc._id,i.doc._id)}}function filterInMemoryFields$1(t,e,i){if(t=t.filter((function(t){return rowFilter$1(t.doc,e.selector,i)})),e.sort){var n=createFieldSorter$1(e.sort);t=t.sort(n),"string"!=typeof e.sort[0]&&"desc"===getValue$2(e.sort[0])&&(t=t.reverse())}if("limit"in e||"skip"in e){var s=e.skip||0;t=t.slice(s,("limit"in e?e.limit:t.length)+s)}return t}function rowFilter$1(t,e,i){return i.every((function(i){var n=e[i],s=parseField$1(i),o=getFieldFromDoc$1(t,s);return isCombinationalField$1(i)?matchCominationalSelector$1(i,n,t):matchSelector$1(n,t,s,o)}))}function matchSelector$1(t,e,i,n){return!t||("object"==typeof t?Object.keys(t).every((function(s){return match$1(s,e,t[s],i,n)})):t===n)}function matchCominationalSelector$1(t,e,i){return"$or"===t?e.some((function(t){return rowFilter$1(i,t,Object.keys(t))})):"$not"===t?!rowFilter$1(i,e,Object.keys(e)):!e.find((function(t){return rowFilter$1(i,t,Object.keys(t))}))}function match$1(t,e,i,n,s){if(!matchers$1[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return matchers$1[t](e,i,n,s)}function fieldExists$1(t){return null!=t}function fieldIsNotUndefined$1(t){return void 0!==t}function modField$1(t,e){var i=e[0],n=e[1];if(0===i)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(i,10)!==i)throw new Error("Divisor is not an integer");if(parseInt(n,10)!==n)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%i===n}function arrayContainsValue$1(t,e){return e.some((function(e){return t instanceof Array?t.indexOf(e)>-1:t===e}))}function arrayContainsAllValues$1(t,e){return e.every((function(e){return t.indexOf(e)>-1}))}function arraySize$1(t,e){return t.length===e}function regexMatch$1(t,e){return new RegExp(e).test(t)}function typeMatch$1(t,e){switch(e){case"null":return null===t;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t;case"string":return"string"==typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(e+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var matchers$1={$elemMatch:function(t,e,i,n){return!!Array.isArray(n)&&0!==n.length&&n.some("object"==typeof n[0]?function(t){return rowFilter$1(t,e,Object.keys(e))}:function(n){return matchSelector$1(e,t,i,n)})},$allMatch:function(t,e,i,n){return!!Array.isArray(n)&&0!==n.length&&n.every("object"==typeof n[0]?function(t){return rowFilter$1(t,e,Object.keys(e))}:function(n){return matchSelector$1(e,t,i,n)})},$eq:function(t,e,i,n){return fieldIsNotUndefined$1(n)&&0===collate$1(n,e)},$gte:function(t,e,i,n){return fieldIsNotUndefined$1(n)&&collate$1(n,e)>=0},$gt:function(t,e,i,n){return fieldIsNotUndefined$1(n)&&collate$1(n,e)>0},$lte:function(t,e,i,n){return fieldIsNotUndefined$1(n)&&collate$1(n,e)<=0},$lt:function(t,e,i,n){return fieldIsNotUndefined$1(n)&&collate$1(n,e)<0},$exists:function(t,e,i,n){return e?fieldIsNotUndefined$1(n):!fieldIsNotUndefined$1(n)},$mod:function(t,e,i,n){return fieldExists$1(n)&&modField$1(n,e)},$ne:function(t,e,i,n){return e.every((function(t){return 0!==collate$1(n,t)}))},$in:function(t,e,i,n){return fieldExists$1(n)&&arrayContainsValue$1(n,e)},$nin:function(t,e,i,n){return fieldExists$1(n)&&!arrayContainsValue$1(n,e)},$size:function(t,e,i,n){return fieldExists$1(n)&&arraySize$1(n,e)},$all:function(t,e,i,n){return Array.isArray(n)&&arrayContainsAllValues$1(n,e)},$regex:function(t,e,i,n){return fieldExists$1(n)&&regexMatch$1(n,e)},$type:function(t,e,i,n){return typeMatch$1(n,e)}};function massageCreateIndexRequest(t){return(t=clone$2(t)).index||(t.index={}),["type","name","ddoc"].forEach((function(e){t.index[e]&&(t[e]=t.index[e],delete t.index[e])})),t.fields&&(t.index.fields=t.fields,delete t.fields),t.type||(t.type="json"),t}function dbFetch(t,e,i,n){var s,o;i.headers=new h$4({"Content-type":"application/json"}),t.fetch(e,i).then((function(t){return s=t.status,o=t.ok,t.json()})).then((function(t){if(o)n(null,t);else{t.status=s;var e=generateErrorFromResponse$1(t);n(e)}})).catch(n)}function createIndex(t,e,i){e=massageCreateIndexRequest(e),dbFetch(t,"_index",{method:"POST",body:JSON.stringify(e)},i)}function find(t,e,i){dbFetch(t,"_find",{method:"POST",body:JSON.stringify(e)},i)}function explain(t,e,i){dbFetch(t,"_explain",{method:"POST",body:JSON.stringify(e)},i)}function getIndexes(t,e){dbFetch(t,"_index",{method:"GET"},e)}function deleteIndex(t,e,i){var n=e.ddoc,s=e.name;return n?s?void dbFetch(t,"_index/"+[n,e.type||"json",s].map(encodeURIComponent).join("/"),{method:"DELETE"},i):i(new Error("you must provide an index's name")):i(new Error("you must provide an index's ddoc"))}function getArguments(t){return function(){for(var e=arguments.length,i=new Array(e),n=-1;++n<e;)i[n]=arguments[n];return t.call(this,i)}}function callbackify$2(t){return getArguments((function(e){var i=e.pop(),n=t.apply(this,e);return promisedCallback$2(n,i),n}))}function promisedCallback$2(t,e){return t.then((function(t){browser$3((function(){e(null,t)}))}),(function(t){browser$3((function(){e(t)}))})),t}var flatten$2=getArguments((function(t){for(var e=[],i=0,n=t.length;i<n;i++){var s=t[i];Array.isArray(s)?e=e.concat(flatten$2.apply(null,s)):e.push(s)}return e}));function mergeObjects(t){for(var e={},i=0,n=t.length;i<n;i++)e=assign$1$1(e,t[i]);return e}function pick$2(t,e){for(var i={},n=0,s=e.length;n<s;n++){var o=parseField$1(e[n]),r=getFieldFromDoc$1(t,o);void 0!==r&&setFieldInDoc(i,o,r)}return i}function oneArrayIsSubArrayOfOther(t,e){for(var i=0,n=Math.min(t.length,e.length);i<n;i++)if(t[i]!==e[i])return!1;return!0}function oneArrayIsStrictSubArrayOfOther(t,e){return!(t.length>e.length)&&oneArrayIsSubArrayOfOther(t,e)}function oneSetIsSubArrayOfOther(t,e){t=t.slice();for(var i=0,n=e.length;i<n;i++){var s=e[i];if(!t.length)break;var o=t.indexOf(s);if(-1===o)return!1;t.splice(o,1)}return!0}function arrayToObject(t){for(var e={},i=0,n=t.length;i<n;i++)e[t[i]]=!0;return e}function max(t,e){for(var i=null,n=-1,s=0,o=t.length;s<o;s++){var r=t[s],a=e(r);a>n&&(n=a,i=r)}return i}function arrayEquals(t,e){if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function uniq$2(t){for(var e={},i=0;i<t.length;i++)e["$"+t[i]]=!0;return Object.keys(e).map((function(t){return t.substring(1)}))}function createDeepMultiMapper(t,e){return function(i){for(var n=[],s=0,o=t.length;s<o;s++){for(var r=parseField$1(t[s]),a=i,l=0,c=r.length;l<c;l++)if(void 0===(a=a[r[l]]))return;n.push(a)}e(n)}}function createDeepSingleMapper(t,e){var i=parseField$1(t);return function(t){for(var n=t,s=0,o=i.length;s<o;s++)if(void 0===(n=n[i[s]]))return;e(n)}}function createShallowSingleMapper(t,e){return function(i){e(i[t])}}function createShallowMultiMapper(t,e){return function(i){for(var n=[],s=0,o=t.length;s<o;s++)n.push(i[t[s]]);e(n)}}function checkShallow(t){for(var e=0,i=t.length;e<i;e++)if(-1!==t[e].indexOf("."))return!1;return!0}function createMapper(t,e){var i=checkShallow(t),n=1===t.length;return i?n?createShallowSingleMapper(t[0],e):createShallowMultiMapper(t,e):n?createDeepSingleMapper(t[0],e):createDeepMultiMapper(t,e)}function mapper$1(t,e){return createMapper(Object.keys(t.fields),e)}function reducer$1(){throw new Error("reduce not supported")}function ddocValidator$1(t,e){var i=t.views[e];if(!i.map||!i.map.fields)throw new Error("ddoc "+t._id+" with view "+e+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}var abstractMapper=createAbstractMapReduce$1("indexes",mapper$1,reducer$1,ddocValidator$1);function abstractMapper$1(t){return t._customFindAbstractMapper||abstractMapper}function massageSort(t){if(!Array.isArray(t))throw new Error("invalid sort json - should be an array");return t.map((function(t){if("string"==typeof t){var e={};return e[t]="asc",e}return t}))}function massageUseIndex(t){var e=[];return"string"==typeof t?e.push(t):e=t,e.map((function(t){return t.replace("_design/","")}))}function massageIndexDef(t){return t.fields=t.fields.map((function(t){if("string"==typeof t){var e={};return e[t]="asc",e}return t})),t}function getKeyFromDoc(t,e){for(var i=[],n=0;n<e.def.fields.length;n++){var s=getKey$1(e.def.fields[n]);i.push(t[s])}return i}function filterInclusiveStart(t,e,i){for(var n=i.def.fields,s=0,o=t.length;s<o;s++){var r=getKeyFromDoc(t[s].doc,i);if(1===n.length)r=r[0];else for(;r.length>e.length;)r.pop();if(Math.abs(collate$1(r,e))>0)break}return s>0?t.slice(s):t}function reverseOptions(t){var e=clone$2(t);return delete e.startkey,delete e.endkey,delete e.inclusive_start,delete e.inclusive_end,"endkey"in t&&(e.startkey=t.endkey),"startkey"in t&&(e.endkey=t.startkey),"inclusive_start"in t&&(e.inclusive_end=t.inclusive_start),"inclusive_end"in t&&(e.inclusive_start=t.inclusive_end),e}function validateIndex(t){var e=t.fields.filter((function(t){return"asc"===getValue$2(t)}));if(0!==e.length&&e.length!==t.fields.length)throw new Error("unsupported mixed sorting")}function validateSort(t,e){if(e.defaultUsed&&t.sort){var i=t.sort.filter((function(t){return"_id"!==Object.keys(t)[0]})).map((function(t){return Object.keys(t)[0]}));if(i.length>0)throw new Error('Cannot sort on field(s) "'+i.join(",")+'" when using the default index')}}function validateFindRequest(t){if("object"!=typeof t.selector)throw new Error("you must provide a selector when you find()")}function getUserFields(t,e){var i,n=Object.keys(t),s=e?e.map(getKey$1):[];return i=n.length>=s.length?n:s,0===s.length?{fields:i}:{fields:i=i.sort((function(t,e){var i=s.indexOf(t);-1===i&&(i=Number.MAX_VALUE);var n=s.indexOf(e);return-1===n&&(n=Number.MAX_VALUE),i<n?-1:i>n?1:0})),sortOrder:e.map(getKey$1)}}function createIndex$1(t,e){var i,n=clone$2((e=massageCreateIndexRequest(e)).index);function s(){return i||(i=stringMd5$1(JSON.stringify(e)))}e.index=massageIndexDef(e.index),validateIndex(e.index);var o=e.name||"idx-"+s(),r=e.ddoc||"idx-"+s(),a="_design/"+r,l=!1,c=!1;return t.constructor.emit("debug",["find","creating index",a]),upsert$1(t,a,(function(t){return t._rev&&"query"!==t.language&&(l=!0),t.language="query",t.views=t.views||{},!(c=!!t.views[o])&&(t.views[o]={map:{fields:mergeObjects(e.index.fields)},reduce:"_count",options:{def:n}},t)})).then((function(){if(l)throw new Error('invalid language for ddoc with id "'+a+'" (should be "query")')})).then((function(){var e=r+"/"+o;return abstractMapper$1(t).query.call(t,e,{limit:0,reduce:!1}).then((function(){return{id:a,name:o,result:c?"exists":"created"}}))}))}function getIndexes$1(t){return t.allDocs({startkey:"_design/",endkey:"_design/",include_docs:!0}).then((function(t){var e={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return e.indexes=flatten$2(e.indexes,t.rows.filter((function(t){return"query"===t.doc.language})).map((function(t){return(void 0!==t.doc.views?Object.keys(t.doc.views):[]).map((function(e){return{ddoc:t.id,name:e,type:"json",def:massageIndexDef(t.doc.views[e].options.def)}}))}))),e.indexes.sort((function(t,e){return compare$2(t.name,e.name)})),e.total_rows=e.indexes.length,e}))}var COLLATE_LO=null,COLLATE_HI={"":{}};function checkFieldInIndex(t,e){for(var i=t.def.fields.map(getKey$1),n=0,s=i.length;n<s;n++)if(e===i[n])return!0;return!1}function userOperatorLosesPrecision(t,e){return"$eq"!==getKey$1(t[e])}function sortFieldsByIndex(t,e){var i=e.def.fields.map(getKey$1);return t.slice().sort((function(t,e){var n=i.indexOf(t),s=i.indexOf(e);return-1===n&&(n=Number.MAX_VALUE),-1===s&&(s=Number.MAX_VALUE),compare$2(n,s)}))}function getBasicInMemoryFields(t,e,i){for(var n=!1,s=0,o=(i=sortFieldsByIndex(i,t)).length;s<o;s++){var r=i[s];if(n||!checkFieldInIndex(t,r))return i.slice(s);s<o-1&&userOperatorLosesPrecision(e,r)&&(n=!0)}return[]}function getInMemoryFieldsFromNe(t){var e=[];return Object.keys(t).forEach((function(i){Object.keys(t[i]).forEach((function(t){"$ne"===t&&e.push(i)}))})),e}function getInMemoryFields(t,e,i,n){return sortFieldsByIndex(uniq$2(flatten$2(t,getBasicInMemoryFields(e,i,n),getInMemoryFieldsFromNe(i))),e)}function checkIndexFieldsMatch(t,e,i){if(e){var n=oneArrayIsStrictSubArrayOfOther(e,t),s=oneArrayIsSubArrayOfOther(i,t);return n&&s}return oneSetIsSubArrayOfOther(i,t)}var logicalMatchers=["$eq","$gt","$gte","$lt","$lte"];function isNonLogicalMatcher(t){return-1===logicalMatchers.indexOf(t)}function checkFieldsLogicallySound(t,e){var i=e[t[0]];return void 0===i||!(1===Object.keys(i).length&&"$ne"===getKey$1(i))}function checkIndexMatches(t,e,i,n){var s=t.def.fields.map(getKey$1);return!!checkIndexFieldsMatch(s,e,i)&&checkFieldsLogicallySound(s,n)}function findMatchingIndexes(t,e,i,n){return n.reduce((function(n,s){return checkIndexMatches(s,i,e,t)&&n.push(s),n}),[])}function findBestMatchingIndex(t,e,i,n,s){var o=findMatchingIndexes(t,e,i,n);if(0===o.length){if(s)throw{error:"no_usable_index",message:"There is no index available for this selector."};var r=n[0];return r.defaultUsed=!0,r}if(1===o.length&&!s)return o[0];var a=arrayToObject(e);if(s){var l="_design/"+s[0],c=2===s.length&&s[1],h=o.find((function(t){return!(!c||t.ddoc!==l||c!==t.name)||t.ddoc===l}));if(!h)throw{error:"unknown_error",message:"Could not find that index or could not use that index for the query"};return h}return max(o,(function(t){for(var e=t.def.fields.map(getKey$1),i=0,n=0,s=e.length;n<s;n++)a[e[n]]&&i++;return i}))}function getSingleFieldQueryOptsFor(t,e){switch(t){case"$eq":return{key:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}return{startkey:COLLATE_LO}}function getSingleFieldCoreQueryPlan(t,e){var i,n=getKey$1(e.def.fields[0]),s=t[n]||{},o=[];return Object.keys(s).forEach((function(t){isNonLogicalMatcher(t)&&o.push(n);var e=getSingleFieldQueryOptsFor(t,s[t]);i=i?mergeObjects([i,e]):e})),{queryOpts:i,inMemoryFields:o}}function getMultiFieldCoreQueryPlan(t,e){switch(t){case"$eq":return{startkey:e,endkey:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}}function getMultiFieldQueryOpts(t,e){var i,n,s=e.def.fields.map(getKey$1),o=[],r=[],a=[];function l(t){!1!==i&&r.push(COLLATE_LO),!1!==n&&a.push(COLLATE_HI),o=s.slice(t)}for(var c=0,h=s.length;c<h;c++){var d=t[s[c]];if(!d||!Object.keys(d).length){l(c);break}if(c>0){if(Object.keys(d).some(isNonLogicalMatcher)){l(c);break}var u="$gt"in d||"$gte"in d||"$lt"in d||"$lte"in d,m=Object.keys(t[s[c-1]]),p=arrayEquals(m,["$eq"]),b=arrayEquals(m,Object.keys(d));if(u&&!p&&!b){l(c);break}}for(var f=Object.keys(d),g=null,y=0;y<f.length;y++){var v=f[y],Z=getMultiFieldCoreQueryPlan(v,d[v]);g=g?mergeObjects([g,Z]):Z}r.push("startkey"in g?g.startkey:COLLATE_LO),a.push("endkey"in g?g.endkey:COLLATE_HI),"inclusive_start"in g&&(i=g.inclusive_start),"inclusive_end"in g&&(n=g.inclusive_end)}var x={startkey:r,endkey:a};return void 0!==i&&(x.inclusive_start=i),void 0!==n&&(x.inclusive_end=n),{queryOpts:x,inMemoryFields:o}}function getDefaultQueryPlan(t){return{queryOpts:{startkey:null},inMemoryFields:[Object.keys(t)]}}function getCoreQueryPlan(t,e){return e.defaultUsed?getDefaultQueryPlan(t):1===e.def.fields.length?getSingleFieldCoreQueryPlan(t,e):getMultiFieldQueryOpts(t,e)}function planQuery(t,e){var i=t.selector,n=getUserFields(i,t.sort),s=n.fields,o=findBestMatchingIndex(i,s,n.sortOrder,e,t.use_index),r=getCoreQueryPlan(i,o);return{queryOpts:r.queryOpts,index:o,inMemoryFields:getInMemoryFields(r.inMemoryFields,o,i,s)}}function indexToSignature(t){return t.ddoc.substring(8)+"/"+t.name}function doAllDocs(t,e){var i=clone$2(e);return i.descending?("endkey"in i&&"string"!=typeof i.endkey&&(i.endkey=""),"startkey"in i&&"string"!=typeof i.startkey&&(i.limit=0)):("startkey"in i&&"string"!=typeof i.startkey&&(i.startkey=""),"endkey"in i&&"string"!=typeof i.endkey&&(i.limit=0)),"key"in i&&"string"!=typeof i.key&&(i.limit=0),t.allDocs(i).then((function(t){return t.rows=t.rows.filter((function(t){return!/^_design\//.test(t.id)})),t}))}function find$1(t,e,i){return e.selector&&(e.selector=massageSelector$1(e.selector)),e.sort&&(e.sort=massageSort(e.sort)),e.use_index&&(e.use_index=massageUseIndex(e.use_index)),validateFindRequest(e),getIndexes$1(t).then((function(n){t.constructor.emit("debug",["find","planning query",e]);var s=planQuery(e,n.indexes);t.constructor.emit("debug",["find","query plan",s]);var o=s.index;validateSort(e,o);var r=assign$1$1({include_docs:!0,reduce:!1},s.queryOpts);return"startkey"in r&&"endkey"in r&&collate$1(r.startkey,r.endkey)>0?{docs:[]}:(e.sort&&"string"!=typeof e.sort[0]&&"desc"===getValue$2(e.sort[0])&&(r.descending=!0,r=reverseOptions(r)),s.inMemoryFields.length||("limit"in e&&(r.limit=e.limit),"skip"in e&&(r.skip=e.skip)),i?Promise.resolve(s,r):Promise.resolve().then((function(){if("_all_docs"===o.name)return doAllDocs(t,r);var e=indexToSignature(o);return abstractMapper$1(t).query.call(t,e,r)})).then((function(t){!1===r.inclusive_start&&(t.rows=filterInclusiveStart(t.rows,r.startkey,o)),s.inMemoryFields.length&&(t.rows=filterInMemoryFields$1(t.rows,e,s.inMemoryFields));var i={docs:t.rows.map((function(t){var i=t.doc;return e.fields?pick$2(i,e.fields):i}))};return o.defaultUsed&&(i.warning="no matching index found, create an index to optimize query time"),i})))}))}function explain$1(t,e){return find$1(t,e,!0).then((function(i){return{dbname:t.name,index:i.index,selector:e.selector,range:{start_key:i.queryOpts.startkey,end_key:i.queryOpts.endkey},opts:{use_index:e.use_index||[],bookmark:"nil",limit:e.limit,skip:e.skip,sort:e.sort||{},fields:e.fields,conflicts:!1,r:[49]},limit:e.limit,skip:e.skip||0,fields:e.fields}}))}function deleteIndex$1(t,e){if(!e.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!e.name)throw new Error("you must supply an index.name when deleting");var i=e.ddoc,n=e.name;return upsert$1(t,i,(function(t){return 1===Object.keys(t.views).length&&t.views[n]?{_id:i,_deleted:!0}:(delete t.views[n],t)})).then((function(){return abstractMapper$1(t).viewCleanup.apply(t)})).then((function(){return{ok:!0}}))}var createIndexAsCallback=callbackify$2(createIndex$1),findAsCallback=callbackify$2(find$1),explainAsCallback=callbackify$2(explain$1),getIndexesAsCallback=callbackify$2(getIndexes$1),deleteIndexAsCallback=callbackify$2(deleteIndex$1),plugin={};plugin.createIndex=toPromise$1((function(t,e){if("object"!=typeof t)return e(new Error("you must provide an index to create"));(isRemote$1(this)?createIndex:createIndexAsCallback)(this,t,e)})),plugin.find=toPromise$1((function(t,e){if(void 0===e&&(e=t,t=void 0),"object"!=typeof t)return e(new Error("you must provide search parameters to find()"));(isRemote$1(this)?find:findAsCallback)(this,t,e)})),plugin.explain=toPromise$1((function(t,e){if(void 0===e&&(e=t,t=void 0),"object"!=typeof t)return e(new Error("you must provide search parameters to explain()"));(isRemote$1(this)?explain:explainAsCallback)(this,t,e)})),plugin.getIndexes=toPromise$1((function(t){(isRemote$1(this)?getIndexes:getIndexesAsCallback)(this,t)})),plugin.deleteIndex=toPromise$1((function(t,e){if("object"!=typeof t)return e(new Error("you must provide an index to delete"));(isRemote$1(this)?deleteIndex:deleteIndexAsCallback)(this,t,e)})),PouchDB.plugin(plugin);class ZeaWcDataConnector{getDb(t){return new PouchDB(t,{auto_compaction:!0})}upsertDoc(t){return new Promise((e,i)=>{if(!t||!("type"in t)||!t.type){const t="ZeaWcDataConnector: Data must have a type property";console.error(t),e(t)}const n=this.getDb(t.type),s=()=>{n.put(t).then((function(t){e(t)})).catch(t=>{i(t)})};t._id?n.get(t._id).then(e=>{t=Object.assign(Object.assign({},e),t),s()}).catch(()=>{s()}):(t._id=`${t.type}|${(new Date).getTime()}`,s())})}getDoc(t){return new Promise(e=>{if(!t){const t="ZeaWcDataConnector: Id must be provided";console.error(t),e(t)}const i=t.split("|",0);this.getDb(i).get(t).then(t=>{e(t)}).catch((function(t){console.error(t),e(t)}))})}deleteDoc(t){return new Promise((e,i)=>{if(!t){const t="ZeaWcDataConnector: Id to delete must be provided";console.error(t),e(t)}const n=t.split("|")[0];this.getDb(n).get(t).then(t=>{t._deleted=!0,this.upsertDoc(t).then(()=>{e(t)}).catch((function(t){console.error(t),i(t)}))}).catch((function(t){console.error(t),i(t)}))})}getDocs(t){return new Promise((e,i)=>{if(!(t=Object.assign(Object.assign({},{limit:10,skip:0}),t)).type){const t="ZeaWcDataConnector: Type must be provided";console.error(t),e(t)}this.getDb(t.type).find({selector:{},limit:t.limit,skip:t.skip}).then((function(t){e(t)})).catch((function(t){i(t)}))})}destroyDb(t){return new Promise((e,i)=>{this.getDb(t).destroy().then(()=>{e()}).catch(t=>{i(t)})})}}const zeaFormDisciplinesSettingsCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-form-disciplines-settings{color:var(--color-freground-1);width:-webkit-min-content;width:-moz-min-content;width:min-content;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%}.form-top{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;width:-webkit-min-content;width:-moz-min-content;width:min-content;border:1px solid var(--color-grey-3);padding:10px 10px 10px 20px;border-bottom:none;-ms-flex-positive:0;flex-grow:0}.form-bottom{border:1px solid var(--color-grey-3);-ms-flex-positive:1;flex-grow:1;font-size:13px;position:relative;height:calc(100% - 80px);padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box}zea-input-text{margin:5px}.discipline-abbreviation{text-transform:uppercase;padding:8px;width:15px;height:15px;line-height:15px;text-align:center;border-radius:20px;margin:10px 20px 10px 10px;white-space:nowrap;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}#abbreviation-input{width:100px}#disciplines-input{width:200px}.discipline-row{display:-ms-flexbox;display:flex;width:100%;-ms-flex-align:center;align-items:center}.discipline-edit-row:hover,.discipline-row:hover{background-color:var(--color-grey-2)}.discipline-name{-ms-flex-positive:1;flex-grow:1}.discipline-tools{visibility:hidden;padding:0 3em 0 1em}.discipline-edit-tools zea-icon,.discipline-tools zea-icon{padding:4px}.discipline-edit-tools zea-icon:hover,.discipline-tools zea-icon:hover{background-color:var(--color-background-4);border-radius:15px}.discipline-edit-tools{padding:4px;-ms-flex-positive:1;flex-grow:1;text-align:right;padding:0 3em 0 1em}.discipline-row:hover .discipline-tools{visibility:visible}.discipline-edit-row{display:-ms-flexbox;display:flex;padding-left:10px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-align:center;align-items:center;display:none}",ZeaFormDisciplinesSettings=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.contentId="none",this.disciplines=[],this.db=new ZeaWcDataConnector,this.rowElements={},this.editRowElements={},this.nameElements={},this.abbrElements={},this.colorElements={},this.dialogResize=createEvent(this,"dialogResize",7)}getDefaultDisciplines(){const t=[];return"A\tArchitectural\t#F34235\n    C\tCivil\t#E81D62\n    E\tElectrical\t#292929\n    F\tFire Protection\t#9B26AF\n    FS\tFood Service\t#6639B6\n    G\tGeneral\t#3E50B4\n    GA\tGarage Architectural\t#2095F2\n    GE\tGarage Electrical\t#02A8F3\n    GM\tGarage Mechanical\t#00BBD3\n    GP\tGarage Plumbing\t#009587\n    GS\tGarage Structual\t#4BAE4F\n    H\tHVAC\t#8AC249\n    I\tInterior\t#CCDB38\n    IR\tIrrigation\t#FEEA3A\n    L\tLandscape\t#FEC006\n    M\tMechanical\t#FE9700\n    P\tPlumbing\t#FE5621\n    Q\tEquipment\t#785447\n    R\tResource\t#9D9D9D\n    S\tStructural\t#5F7C8A\n    T\tTelecommunications\t#F34235\n    X\tOther\t#E81D62\n    Z\tContractor / Shop Drawings\t#292929".split("\n").forEach((e,i)=>{const n=(e=e.replace(/(^\s*|\s*$)/,"")).split("\t");t.push({type:"disciplines",_id:"disciplines|default"+i,name:n[1],abbreviation:n[0],color:n[2],contentId:this.contentId})}),t}async applyDefaultDisciplines(){return new Promise(t=>{this.disciplines=this.getDefaultDisciplines();let e=0;this.disciplines.forEach(i=>{this.db.upsertDoc(i).then(()=>{e++,e==this.disciplines.length&&t()})})})}resetDefatuls(){return new Promise(t=>{this.db.destroyDb("disciplines").then(()=>{this.applyDefaultDisciplines().then(()=>{this.refreshDisciplines(),t()})})})}saveDiscipline(){const t={type:"disciplines",abbreviation:this.abbrInput.value,name:this.nameInput.value,color:this.colorInput.value,contentId:this.contentId};this.abbrInput.value="",this.nameInput.value="",this.db.upsertDoc(t).then(()=>{this.refreshDisciplines()})}updateDiscipline(t){this.db.upsertDoc({type:"disciplines",abbreviation:this.abbrElements[t].value,name:this.nameElements[t].value,color:this.colorElements[t].value,contentId:this.contentId,_id:t}).then(()=>{this.refreshDisciplines()})}refreshDisciplines(){this.db.getDocs({type:"disciplines",limit:1e3}).then(t=>{if(!t.docs||!t.docs.length)return this.disciplines=this.getDefaultDisciplines(),void this.applyDefaultDisciplines();this.disciplines=t.docs})}componentWillLoad(){this.refreshDisciplines()}deleteDisclipline(t){this.db.deleteDoc(t).then(()=>{this.refreshDisciplines()})}componentDidRender(){this.dialogResize.emit(this)}render(){return h("div",{class:"zea-form-disciplines-settings"},h("div",{class:"form-top"},h("div",null,h("zea-input-text",{ref:t=>this.abbrInput=t,label:"Abbreviation",id:"abbreviation-input"})),h("div",null,h("zea-input-text",{ref:t=>this.nameInput=t,label:"Discipline",id:"disciplines-input"})),h("div",null,h("zea-input",{ref:t=>this.colorInput=t,type:"color",label:"Color",showLabel:!1,colorPopupAlign:"top-left"})),h("div",null,h("zea-button",{variant:"solid",onClick:this.saveDiscipline.bind(this)},"ADD NEW")),h("div",null,h("zea-menu-separator",{orientation:"vertical"})),h("div",null,h("zea-menu",{type:"contextual",contextualAlign:"top-right",showAnchor:!0,anchorIcon:"ellipsis-vertical"},h("zea-menu-item",{onClick:this.resetDefatuls.bind(this)},h("zea-icon",{name:"refresh-circle-outline"})," Restore Defaults")))),h("div",{class:"form-bottom"},h("zea-scroll-pane",null,this.disciplines.map(t=>[h("div",{ref:e=>this.rowElements[t._id]=e,class:"discipline-row",id:t._id,key:t._id},h("div",{class:"discipline-abbreviation",style:{backgroundColor:t.color}},t.abbreviation),h("div",{class:"discipline-name"},t.name),h("div",{class:"discipline-tools"},h("zea-icon",{name:"create-outline",size:18,onClick:()=>{this.editRowElements[t._id].style.display="flex",this.rowElements[t._id].style.display="none"}}),h("zea-icon",{size:18,name:"trash-outline",onClick:()=>{this.deleteDisclipline(t._id)}}))),h("div",{ref:e=>this.editRowElements[t._id]=e,class:"discipline-edit-row",id:t._id+"-editor",key:t._id+"-editor"},h("div",null,h("zea-input-text",{ref:e=>this.abbrElements[t._id]=e,label:"Abbreviation",id:"abbreviation-input",value:t.abbreviation})),h("div",null,h("zea-input-text",{ref:e=>this.nameElements[t._id]=e,label:"Discipline",value:t.name,id:"disciplines-input"})),h("div",null,h("zea-input",{ref:e=>this.colorElements[t._id]=e,type:"color",label:"Color",showLabel:!1,value:t.color,colorPopupAlign:"top-left"})),h("div",{class:"discipline-edit-tools"},h("zea-icon",{name:"checkmark-outline",size:20,onClick:()=>{this.editRowElements[t._id].style.display="none",this.rowElements[t._id].style.display="flex",this.updateDiscipline(t._id)}}),h("zea-icon",{size:20,name:"close-outline",onClick:()=>{this.editRowElements[t._id].style.display="none",this.rowElements[t._id].style.display="flex"}})))]))))}static get style(){return zeaFormDisciplinesSettingsCss}},zeaFormDrawingSetupCss=".zea-form-drawing-setup{color:var(--color-foreground-1);display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%;width:100%;overflow:hidden}.discipline-row{display:-ms-flexbox;display:flex;width:100%;-ms-flex-align:center;align-items:center}.discipline-row:hover{background-color:var(--color-grey-2)}.discipline-name{-ms-flex-positive:1;flex-grow:1}.discipline-abbreviation{text-transform:uppercase;padding:8px;width:15px;height:15px;line-height:15px;text-align:center;border-radius:20px;margin:5px 10px 5px 5px;white-space:nowrap;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.input-container{margin-bottom:1em}zea-input-select-item:hover{background-color:var(--color-grey-2)}.scale-row{padding:5px}.inputs{-ms-flex-positive:1;flex-grow:1;padding:1em}.buttons{display:-ms-flexbox;display:flex;padding:1em}.buttons zea-button{margin:5px}.buttons div:nth-child(1){-ms-flex-positive:1;flex-grow:1}",ZeaFormDrawingSetup=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.disciplines=[],this.scales=[],this.db=new ZeaWcDataConnector}onDisciplinesSelect(t){console.log("value",t)}onScalesSelect(t){console.log("value",t)}componentWillLoad(){this.db.getDocs({type:"disciplines",limit:100}).then(t=>{this.disciplines=t.docs}),this.scales=[{_id:"scale1",name:"1/32' = 1'0\""},{_id:"scale2",name:"1/16' = 1'0\""},{_id:"scale3",name:"1/8' = 1'0\""},{_id:"scale4",name:"1/4' = 1'0\""},{_id:"scale5",name:"3/8' = 1'0\""},{_id:"scale6",name:"1/32 = 1'0\""},{_id:"scale7",name:"1/32 = 1'0\""},{_id:"scale8",name:"1/32 = 1'0\""},{_id:"scale9",name:"1/32 = 1'0\""},{_id:"scale10",name:"1/32 = 1'0\""}]}render(){return h("div",{class:"zea-form-drawing-setup"},h("div",{class:"inputs"},h("div",{class:"input-container"},h("zea-input-text",{ref:t=>this.drawingNumberInput=t,label:"Drawing Number",id:"drawing-number-input"})),h("div",{class:"input-container"},h("zea-input-text",{ref:t=>this.titleInput=t,label:"Title",id:"title-input"})),h("div",{class:"input-container"},h("zea-input-select",{selectCallback:this.onDisciplinesSelect.bind(this),label:"Discipline",id:"discipline-input"},this.disciplines.map(t=>h("zea-input-select-item",{value:t},h("div",{class:"discipline-row",id:t._id,key:t._id},h("div",{class:"discipline-abbreviation",style:{backgroundColor:t.color}},t.abbreviation),h("div",{class:"discipline-name"},t.name)))))),h("div",{class:"input-container"},h("zea-input-select",{selectCallback:this.onScalesSelect.bind(this),label:"Scale",id:"scale-input"},this.scales.map(t=>h("zea-input-select-item",{value:t},h("div",{class:"select-item-wrap scale-row",id:t._id,key:t._id},h("div",{class:"scale-name"},t.name))))))),h("div",{class:"buttons"},h("div",null,h("zea-button",{density:"small"},"FINISHED ALL")),h("div",null,h("zea-button",{density:"small"},"PREVIOUS"),h("zea-button",{density:"small"},"NEXT"))))}static get style(){return zeaFormDrawingSetupCss}},zeaFormMeasurementsSettingsCss=".zea-form-measurements-settings{color:var(--color-freground-1)}",ZeaFormMeasurementsSettings=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.test="Hello World"}render(){return h("div",{class:"zea-form-measurements-settings"},this.test)}static get style(){return zeaFormMeasurementsSettingsCss}},zeaFormProfileCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-form-profile{color:var(--color-foreground-1)}zea-form{width:280px;display:block;padding:20px;padding-top:0;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 auto}zea-input{margin:2em 0 1em;display:block}zea-input-text{margin:1em 0 0}",ZeaProfileForm=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.welcomeHtml="Welcome to Zea Construction. We just need <br />a few details and\n  then you're ready to go.",this.submitButtonText="SAVE",this.showLabels=!0,this.userData={},this.userRegistered=createEvent(this,"userRegistered",7)}submitCallback(t){this.formElement.isValid&&this.userRegistered.emit(t)}render(){return h("div",{class:"zea-form-profile"},h("zea-form",{ref:t=>this.formElement=t,id:"quick-access-form",submitCallback:this.submitCallback.bind(this),"submit-text":this.submitButtonText,validate:!0},this.welcomeHtml&&h("div",{innerHTML:this.welcomeHtml}),h("zea-input-text",{id:"quick-access-id",name:"id",showLabel:!1,hidden:!0,value:this.userData.id||""}),h("zea-input-text",{id:"quick-access-name",label:"First Name (required)",name:"firstName",showLabel:!0,required:!0,value:this.userData.firstName||""}),h("zea-input-text",{id:"quick-access-lastname",label:"Last Name",showLabel:this.showLabels,name:"lastName",value:this.userData.lastName||""}),h("zea-input-text",{id:"quick-access-email",label:"Email",showLabel:this.showLabels,name:"email",value:this.userData.email||""}),h("zea-input-text",{id:"quick-access-phone",label:"Phone",showLabel:this.showLabels,name:"phone",value:this.userData.phone||""}),h("zea-input-text",{id:"quick-access-company",label:"Company",showLabel:this.showLabels,name:"company",value:this.userData.company||""}),h("zea-input",{id:"quick-access-photo",type:"photo",label:"Photo",showLabel:this.showLabels,name:"avatar",value:this.userData.avatar||""}),h("zea-input-color",{id:"quick-access-color",label:"Color",showLabel:this.showLabels,name:"color",value:this.userData.color||""})))}static get style(){return zeaFormProfileCss}},svg={"draw-arrow":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="arrow"><path id="arrow1" serif:id="arrow" d="M118.973,142.33l-30.466,30.467c-6.181,6.181 -16.767,2.264 -17.44,-6.452l-7.037,-91.328c-0.229,-2.976 0.857,-5.909 2.967,-8.02c2.111,-2.11 5.044,-3.196 8.02,-2.967l91.327,7.037c8.729,0.661 12.646,11.247 6.465,17.428l-30.478,30.478l300.835,300.836c6.445,6.445 6.445,16.912 0,23.357c-6.446,6.445 -16.912,6.445 -23.358,0l-300.835,-300.836Z"/><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',"draw-freehand":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="freehand"><path id="pen" d="M324.403,142.611c-3.015,-3.092 -7.153,-4.834 -11.472,-4.829c-4.319,0.005 -8.453,1.756 -11.461,4.856l-187.543,193.243c-1.146,1.181 -2.104,2.532 -2.838,4.006l-26.409,70.002c-3.095,6.21 -1.833,13.707 3.123,18.562c4.957,4.856 12.478,5.962 18.623,2.74l68.378,-27.232c1.48,-0.776 2.83,-1.78 3.999,-2.974l188.421,-192.356c6.082,-6.209 6.094,-16.138 0.026,-22.361l-42.847,-43.657Zm30.305,-54.593l-21.677,22.234c-6.057,6.212 -6.058,16.119 -0.003,22.332l42.847,43.671c3.011,3.09 7.143,4.832 11.457,4.832c4.315,0 8.446,-1.743 11.457,-4.833l21.678,-22.248c14.614,-14.999 8.958,-45.329 -5.656,-60.328c-14.942,-15.315 -45.165,-20.971 -60.099,-5.663l-0.004,0.003Z"/><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',"draw-polygon":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="polygon"><path id="polygon1" serif:id="polygon" d="M266.945,355.799l-136.44,91.653c-5.263,3.536 -11.95,4.192 -17.801,1.747c-5.85,-2.445 -10.082,-7.664 -11.264,-13.894l-40.792,-214.944c-1.268,-6.68 1.156,-13.526 6.344,-17.92l161.322,-136.628c4.965,-4.206 11.747,-5.557 17.945,-3.575l191.685,61.294c7.799,2.494 13.1,9.732 13.124,17.92l0.615,208.352c0.016,5.271 -2.173,10.309 -6.038,13.893c-3.865,3.584 -9.052,5.389 -14.307,4.978l-164.393,-12.876Zm146.933,-26.352l-0.514,-174.147l-168.638,-53.924l-144.944,122.757l33.41,176.044l118.156,-79.371c3.531,-2.371 7.758,-3.481 11.998,-3.149l150.532,11.79Z"/><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',"draw-text":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="text"><path id="text1" serif:id="text" d="M63.725,112l0,-36c0,-6.623 5.377,-12 12,-12l360,0c6.623,0 12,5.377 12,12l0,36l0.275,0l0,50c0,6.623 -5.377,12 -12,12l-24,0c-6.623,0 -12,-5.377 -12,-12l0,-50l-120,0l0,288l45.381,0c6.623,0 12,5.377 12,12l0,24c0,6.623 -5.377,12 -12,12l-139.312,0c-6.623,0 -12,-5.377 -12,-12l0,-24c0,-6.623 5.377,-12 12,-12l45.931,0l0,-288l-119.725,0l0,50c0,6.623 -5.377,12 -12,12l-24,0c-6.623,0 -12,-5.377 -12,-12l0,-50l-0.55,0Z"/><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',"find-user":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="find-user"><g id="person"><path id="body" d="M364.305,393.842l-216.61,0c-5.738,0.074 -11.214,-2.444 -14.892,-6.849c-4,-4.782 -5.612,-11.311 -4.418,-17.914c5.194,-28.811 21.403,-53.014 46.879,-70.004c22.633,-15.083 51.303,-23.384 80.736,-23.384c29.433,0 58.103,8.307 80.736,23.384c25.476,16.984 41.685,41.186 46.879,69.998c1.194,6.603 -0.418,13.132 -4.418,17.913c-3.677,4.408 -9.153,6.929 -14.892,6.856Z" style="fill-rule:nonzero;"/><path id="head" d="M303.162,138.206c-11.975,-12.929 -28.701,-20.049 -47.162,-20.049c-18.559,0 -35.341,7.077 -47.26,19.925c-12.049,12.991 -17.92,30.646 -16.541,49.71c2.732,37.611 31.353,68.207 63.801,68.207c32.448,0 61.02,-30.59 63.795,-68.195c1.397,-18.892 -4.51,-36.51 -16.633,-49.598Z" style="fill-rule:nonzero;"/></g><g id="scan"><path id="_4" serif:id="4" d="M336,464l56,0c39.498,0 72,-32.502 72,-72c0,0 0,-56 0,-56c0,-8.831 -7.169,-16 -16,-16c-8.831,0 -16,7.169 -16,16l0,56c0,21.943 -18.057,40 -40,40l-56,0c-8.831,0 -16,7.169 -16,16c0,8.831 7.169,16 16,16Z"/><path id="_3" serif:id="3" d="M176,432l-56,0c-21.943,0 -40,-18.057 -40,-40c0,0 0,-56 0,-56c0,-8.831 -7.169,-16 -16,-16c-8.831,0 -16,7.169 -16,16l0,56c0,39.498 32.502,72 72,72c0,0 56,0 56,0c8.831,0 16,-7.169 16,-16c0,-8.831 -7.169,-16 -16,-16Z"/><path id="_2" serif:id="2" d="M464,176l0,-56c0,-39.498 -32.502,-72 -72,-72l-56,0c-8.831,0 -16,7.169 -16,16c0,8.831 7.169,16 16,16l56,0c21.943,0 40,18.057 40,40l0,56c0,8.831 7.169,16 16,16c8.831,0 16,-7.169 16,-16Z"/><path id="_1" serif:id="1" d="M80,176l0,-56c0,-21.943 18.057,-40 40,-40c0,0 56,0 56,0c8.831,0 16,-7.169 16,-16c0,-8.831 -7.169,-16 -16,-16l-56,0c-39.498,0 -72,32.502 -72,72l0,56c0,8.831 7.169,16 16,16c8.831,0 16,-7.169 16,-16Z"/></g><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',undo:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="undo"><path id="undo1" serif:id="undo" d="M173.041,264.618c48.562,-42.459 88.718,-55.437 122.014,-50.683c30.36,4.335 53.985,23.204 71.761,43.697c28.572,32.938 42.372,70.95 42.372,70.95l0,0c3.755,10.38 15.23,15.76 25.61,12.006c10.38,-3.754 15.76,-15.23 12.006,-25.61c0,0 -16.146,-44.792 -49.772,-83.557c-23.69,-27.31 -55.864,-51.308 -96.324,-57.084c-42.091,-6.01 -94.34,7.325 -156.009,61.939l-38.76,-38.76c-8.12,-8.12 -22.029,-2.975 -22.912,8.478l-9.246,119.989c-0.3,3.911 1.126,7.763 3.899,10.536c2.773,2.774 6.626,4.199 10.536,3.899l119.989,-9.246c11.469,-0.867 16.614,-14.776 8.494,-22.896l-43.658,-43.658Z" style="fill-rule:nonzero;"/><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',redo:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="redo"><path id="redo1" serif:id="redo" d="M348.701,264.618c-48.562,-42.459 -88.718,-55.437 -122.014,-50.683c-30.36,4.335 -53.985,23.204 -71.761,43.697c-28.573,32.938 -42.373,70.95 -42.373,70.95l0,0c-3.754,10.38 -15.229,15.76 -25.609,12.006c-10.381,-3.754 -15.761,-15.23 -12.006,-25.61c0,0 16.145,-44.792 49.772,-83.557c23.69,-27.31 55.864,-51.308 96.323,-57.084c42.092,-6.01 94.341,7.325 156.01,61.939l38.759,-38.76c8.121,-8.12 22.029,-2.975 22.913,8.478l9.246,119.989c0.3,3.911 -1.126,7.763 -3.899,10.536c-2.774,2.774 -6.626,4.199 -10.537,3.899l-119.989,-9.246c-11.468,-0.867 -16.614,-14.776 -8.493,-22.896l43.658,-43.658Z" style="fill-rule:nonzero;"/><rect id="keep-square" serif:id="keep square" x="0" y="0" width="512" height="512" style="fill:none;fill-rule:nonzero;"/></g></svg>',"settings-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M262.29 192.31a64 64 0 1057.4 57.4 64.13 64.13 0 00-57.4-57.4zM416.39 256a154.34 154.34 0 01-1.53 20.79l45.21 35.46a10.81 10.81 0 012.45 13.75l-42.77 74a10.81 10.81 0 01-13.14 4.59l-44.9-18.08a16.11 16.11 0 00-15.17 1.75A164.48 164.48 0 01325 400.8a15.94 15.94 0 00-8.82 12.14l-6.73 47.89a11.08 11.08 0 01-10.68 9.17h-85.54a11.11 11.11 0 01-10.69-8.87l-6.72-47.82a16.07 16.07 0 00-9-12.22 155.3 155.3 0 01-21.46-12.57 16 16 0 00-15.11-1.71l-44.89 18.07a10.81 10.81 0 01-13.14-4.58l-42.77-74a10.8 10.8 0 012.45-13.75l38.21-30a16.05 16.05 0 006-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 00-6.07-13.94l-38.19-30A10.81 10.81 0 0149.48 186l42.77-74a10.81 10.81 0 0113.14-4.59l44.9 18.08a16.11 16.11 0 0015.17-1.75A164.48 164.48 0 01187 111.2a15.94 15.94 0 008.82-12.14l6.73-47.89A11.08 11.08 0 01213.23 42h85.54a11.11 11.11 0 0110.69 8.87l6.72 47.82a16.07 16.07 0 009 12.22 155.3 155.3 0 0121.46 12.57 16 16 0 0015.11 1.71l44.89-18.07a10.81 10.81 0 0113.14 4.58l42.77 74a10.8 10.8 0 01-2.45 13.75l-38.21 30a16.05 16.05 0 00-6.05 14.08c.33 4.14.55 8.3.55 12.47z" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"link-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M208 352h-64a96 96 0 010-192h64M304 160h64a96 96 0 010 192h-64M163.29 256h187.42" stroke-linecap="round" stroke-linejoin="round" stroke-width="36" class="ionicon-fill-none"/></svg>',"copy-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><rect x="128" y="128" width="336" height="336" rx="57" ry="57" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path d="M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"arrow-back":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M244 400L100 256l144-144M120 256h292" class="ionicon-fill-none"/></svg>',"add-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" d="M256 112v288M400 256H112" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"refresh-circle-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M288 193s12.18-6-32-6a80 80 0 1080 80" stroke-linecap="round" stroke-miterlimit="10" stroke-width="28" class="ionicon-fill-none"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="28" d="M256 149l40 40-40 40" class="ionicon-fill-none"/><path d="M256 64C150 64 64 150 64 256s86 192 192 192 192-86 192-192S362 64 256 64z" stroke-miterlimit="10" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"create-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z"/></svg>',"trash-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path stroke-linecap="round" stroke-miterlimit="10" d="M80 112h352" class="ionicon-stroke-width"/><path d="M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40M256 176v224M184 176l8 224M328 176l-8 224" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"checkmark-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" d="M416 128L192 384l-96-96" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"close-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" d="M368 368L144 144M368 144L144 368" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"camera-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M350.54 148.68l-26.62-42.06C318.31 100.08 310.62 96 302 96h-92c-8.62 0-16.31 4.08-21.92 10.62l-26.62 42.06C155.85 155.23 148.62 160 140 160H80a32 32 0 00-32 32v192a32 32 0 0032 32h352a32 32 0 0032-32V192a32 32 0 00-32-32h-59c-8.65 0-16.85-4.77-22.46-11.32z" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><circle cx="256" cy="272" r="80" stroke-miterlimit="10" class="ionicon-fill-none ionicon-stroke-width"/><path stroke-linecap="round" stroke-linejoin="round" d="M124 158v-22h-24v22" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"chevron-up-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 328l144-144 144 144" class="ionicon-fill-none"/></svg>',"chevron-down-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 184l144 144 144-144" class="ionicon-fill-none"/></svg>',add:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-linejoin="round" d="M256 112v288M400 256H112" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"layers-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M434.8 137.65l-149.36-68.1c-16.19-7.4-42.69-7.4-58.88 0L77.3 137.65c-17.6 8-17.6 21.09 0 29.09l148 67.5c16.89 7.7 44.69 7.7 61.58 0l148-67.5c17.52-8 17.52-21.1-.08-29.09zM160 308.52l-82.7 37.11c-17.6 8-17.6 21.1 0 29.1l148 67.5c16.89 7.69 44.69 7.69 61.58 0l148-67.5c17.6-8 17.6-21.1 0-29.1l-79.94-38.47" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path d="M160 204.48l-82.8 37.16c-17.6 8-17.6 21.1 0 29.1l148 67.49c16.89 7.7 44.69 7.7 61.58 0l148-67.49c17.7-8 17.7-21.1.1-29.1L352 204.48" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"duplicate-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><rect x="128" y="128" width="336" height="336" rx="57" ry="57" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path d="M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24M296 216v160M376 296H216" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"navigate-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M448 64L64 240.14h200a8 8 0 018 8V448z" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"square-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M416 448H96a32.09 32.09 0 01-32-32V96a32.09 32.09 0 0132-32h320a32.09 32.09 0 0132 32v320a32.09 32.09 0 01-32 32z" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"ellipsis-vertical-circle-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><circle cx="256" cy="256" r="26"/><circle cx="256" cy="346" r="26"/><circle cx="256" cy="166" r="26"/><path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" stroke-miterlimit="10" class="ionicon-fill-none ionicon-stroke-width"/></svg>',menu:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path stroke-linecap="round" stroke-miterlimit="10" stroke-width="48" d="M88 152h336M88 256h336M88 360h336" class="ionicon-fill-none"/></svg>',"eye-outline":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg xmlns='http://www.w3.org/2000/svg' width='512' height='512' viewBox='0 0 512 512'><title>ionicons-v5-i</title><path d='M255.66,112c-77.94,0-157.89,45.11-220.83,135.33a16,16,0,0,0-.27,17.77C82.92,340.8,161.8,400,255.66,400,348.5,400,429,340.62,477.45,264.75a16.14,16.14,0,0,0,0-17.47C428.89,172.28,347.8,112,255.66,112Z' style='fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px'/><circle cx='256' cy='256' r='80' style='fill:none;stroke:#000;stroke-miterlimit:10;stroke-width:32px'/></svg>","eye-off-outline":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"><svg xmlns='http://www.w3.org/2000/svg' width='512' height='512' viewBox='0 0 512 512'><title>ionicons-v5-i</title><path d='M432,448a15.92,15.92,0,0,1-11.31-4.69l-352-352A16,16,0,0,1,91.31,68.69l352,352A16,16,0,0,1,432,448Z'/><path d='M255.66,384c-41.49,0-81.5-12.28-118.92-36.5-34.07-22-64.74-53.51-88.7-91l0-.08c19.94-28.57,41.78-52.73,65.24-72.21a2,2,0,0,0,.14-2.94L93.5,161.38a2,2,0,0,0-2.71-.12c-24.92,21-48.05,46.76-69.08,76.92a31.92,31.92,0,0,0-.64,35.54c26.41,41.33,60.4,76.14,98.28,100.65C162,402,207.9,416,255.66,416a239.13,239.13,0,0,0,75.8-12.58,2,2,0,0,0,.77-3.31l-21.58-21.58a4,4,0,0,0-3.83-1A204.8,204.8,0,0,1,255.66,384Z'/><path d='M490.84,238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349,110.55,302,96,255.66,96a227.34,227.34,0,0,0-74.89,12.83,2,2,0,0,0-.75,3.31l21.55,21.55a4,4,0,0,0,3.88,1A192.82,192.82,0,0,1,255.66,128c40.69,0,80.58,12.43,118.55,37,34.71,22.4,65.74,53.88,89.76,91a.13.13,0,0,1,0,.16,310.72,310.72,0,0,1-64.12,72.73,2,2,0,0,0-.15,2.95l19.9,19.89a2,2,0,0,0,2.7.13,343.49,343.49,0,0,0,68.64-78.48A32.2,32.2,0,0,0,490.84,238.6Z'/><path d='M256,160a95.88,95.88,0,0,0-21.37,2.4,2,2,0,0,0-1,3.38L346.22,278.34a2,2,0,0,0,3.38-1A96,96,0,0,0,256,160Z'/><path d='M165.78,233.66a2,2,0,0,0-3.38,1,96,96,0,0,0,115,115,2,2,0,0,0,1-3.38Z'/></svg>","caret-down":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"/></svg>',"caret-forward":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M190.06 414l163.12-139.78a24 24 0 000-36.44L190.06 98c-15.57-13.34-39.62-2.28-39.62 18.22v279.6c0 20.5 24.05 31.56 39.62 18.18z"/></svg>',"phone-portrait-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><rect x="128" y="16" width="256" height="480" rx="48" ry="48" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path d="M176 16h24a8 8 0 018 8h0a16 16 0 0016 16h64a16 16 0 0016-16h0a8 8 0 018-8h24" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/></svg>',"mail-outline":'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><rect x="48" y="96" width="416" height="320" rx="40" ry="40" stroke-linecap="round" stroke-linejoin="round" class="ionicon-fill-none ionicon-stroke-width"/><path stroke-linecap="round" stroke-linejoin="round" d="M112 160l144 112 144-112" class="ionicon-fill-none ionicon-stroke-width"/></svg>',create:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z"/><path d="M386.34 193.66L264.45 315.79A41.08 41.08 0 01247.58 326l-25.9 8.67a35.92 35.92 0 01-44.33-44.33l8.67-25.9a41.08 41.08 0 0110.19-16.87l122.13-121.91a8 8 0 00-5.65-13.66H104a56 56 0 00-56 56v240a56 56 0 0056 56h240a56 56 0 0056-56V199.31a8 8 0 00-13.66-5.65z"/></svg>',cash:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M448 400H64a16 16 0 010-32h384a16 16 0 010 32zM416 448H96a16 16 0 010-32h320a16 16 0 010 32zM32 272H16v48a32 32 0 0032 32h48v-16a64.07 64.07 0 00-64-64z"/><path d="M480 240h16v-64h-16a96.11 96.11 0 01-96-96V64H128v16a96.11 96.11 0 01-96 96H16v64h16a96.11 96.11 0 0196 96v16h256v-16a96.11 96.11 0 0196-96zm-224 64a96 96 0 1196-96 96.11 96.11 0 01-96 96z"/><circle cx="256" cy="208" r="64"/><path d="M416 336v16h48a32 32 0 0032-32v-48h-16a64.07 64.07 0 00-64 64zM480 144h16V96a32 32 0 00-32-32h-48v16a64.07 64.07 0 0064 64zM96 80V64H48a32 32 0 00-32 32v48h16a64.07 64.07 0 0064-64z"/></svg>'},getSvg=t=>svg[t],zeaIconCss=":host,zea-icon,.zea-icon{display:inline-block;vertical-align:middle;}ion-icon{display:block}.zea-custom-icon svg{width:100%;height:100%;fill:currentColor}.zea-custom-icon svg *{}.zea-custom-icon-inner{width:1em;height:1em}",ZeaIcon=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.type="ionic",this.size=24}render(){return"ionic"==this.type?h("div",{class:"zea-icon ionic"},h("ion-icon",{name:this.name,style:{fontSize:this.size+"px"}})):"zea"==this.type?h("div",{class:"zea-icon zea-custom-icon zea-icon-"+this.name},h("div",{class:"zea-custom-icon-inner",style:{fontSize:this.size+"px"},innerHTML:getSvg(this.name)})):void 0}static get style(){return zeaIconCss}},zeaImagesGalleryCss=":host{width:100%;height:100%}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-ig-container{display:grid;width:100%;height:100%;grid-template-rows:repeat(5, 1fr);grid-template-columns:repeat(4, 1fr);gap:0.7em}.zea-ig-image.featured{grid-column:span 2;grid-row:span 2}.zea-ig-image{background-repeat:no-repeat;background-size:cover;background-position:center}.zea-ig-image:hover{-webkit-filter:brightness(1.15);filter:brightness(1.15);-webkit-box-shadow:0px 0.25em 0.5em var(--color-shadow);box-shadow:0px 0.25em 0.5em var(--color-shadow);z-index:1}.zea-ig-zoomed.inactive{display:none}.zea-ig-zoomed.active{display:block;position:fixed;background-color:var(--color-background-1);padding:1%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:all 0.5s;transition:all 0.5s;z-index:1000}.zea-ig-zoomed-inner{background-size:cover;background-position:center;background-repeat:no-repeat;width:100%;height:100%}.zea-ig-zoomed.active.animate .zea-ig-zoomed-inner{background-size:contain}",ZeaImagesGallery=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.featured=2,this.columns=4,this.folder={children:[]},this.zoomedImageClass="zea-ig-zoomed inactive",this.zoomedImageUrl=""}static isFileImage(t){return ZeaImagesGallery.imagesMediaTypes.includes(t.type)}static getImageUrl(t){return"https://storage.googleapis.com/zea-drive-staging-projects-assets/"+t.idInStorage}resetImageLocation(){this.zoomedTop=this.bbox.top+"px",this.zoomedLeft=this.bbox.left+"px",this.zoomedWidth=this.bbox.width+"px",this.zoomedHeight=this.bbox.height+"px",this.zoomedOpacity="0"}zoomImageIn(t,e){this.zoomedImageUrl=ZeaImagesGallery.getImageUrl(e),this.bbox=t.target.getBoundingClientRect(),this.zoomedImageClass="zea-ig-zoomed active",this.resetImageLocation(),setTimeout(()=>{this.zoomedImageClass="zea-ig-zoomed active animate",this.zoomedTop="0px",this.zoomedLeft="0px",this.zoomedWidth="100%",this.zoomedHeight="100%",this.zoomedOpacity="1"},100)}zoomImageOut(){this.resetImageLocation(),setTimeout(()=>{this.zoomedImageClass="zea-ig-zoomed inactive"},400)}render(){const t=Object.values(this.folder.children).filter(ZeaImagesGallery.isFileImage),e=Math.ceil((t.length+3*this.featured)/this.columns);return h(Host,{class:"ZeaImagesGallery"},h("div",{class:this.zoomedImageClass,style:{top:this.zoomedTop,left:this.zoomedLeft,width:this.zoomedWidth,height:this.zoomedHeight,opacity:this.zoomedOpacity}},h("div",{class:"zea-ig-zoomed-inner",style:{backgroundImage:"url("+this.zoomedImageUrl+")"},onClick:()=>{this.zoomImageOut()}})),h("div",{class:"zea-ig-container",style:{gridTemplateColumns:"repeat("+this.columns+", 1fr)",gridTemplateRows:"repeat("+e+", 1fr)"}},t.map((t,e)=>h("div",{style:{backgroundImage:`url(${ZeaImagesGallery.getImageUrl(t)})`},class:"zea-ig-image "+(e<this.featured?" featured":""),onClick:e=>{this.zoomImageIn(e,t)},title:t.name}))))}static get style(){return zeaImagesGalleryCss}};ZeaImagesGallery.imagesMediaTypes=["image/jpeg","image/png","image/svg+xml"];const zeaInputCss=".zea-input{color:var(--color-foreground-1)}.input-label{font-size:11px;color:var(--color-grey-3)}.input-wrap{display:block;}input[type='text']{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;color:var(--color-foreground-2);background-color:transparent;border:none;outline:none;font-size:1em;border-bottom:1px solid var(--color-grey-3)}input[type='text'].invalid{border-bottom:1px solid var(--color-warning-2)}.invalid-message{color:var(--color-warning-2);padding:0.3em 0;font-size:12px}.photo-input{display:-ms-flexbox;display:flex;overflow:hidden}.photo-input input{position:absolute;left:-100000px}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.photo-input .input-label{display:block}.photo-thumb{-ms-flex-negative:0;flex-shrink:0;display:block;width:54px;height:54px;border-radius:30px;margin-right:10px;background-color:var(--color-secondary-1);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-size:12px;position:relative}.photo-copy{font-size:12px;color:var(--color-foreground-2)}#photo-preview{position:absolute;width:100%;height:100%;background-size:cover;border-radius:30px}.color-input{display:-ms-flexbox;display:flex;overflow:hidden}.color-input .input-label{display:block}.color-thumb{-ms-flex-negative:0;flex-shrink:0;display:block;width:54px;height:54px;border-radius:30px;margin-right:10px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-size:12px}.color-copy{font-size:12px;color:var(--color-foreground-2)}.color-popup{padding:7px;position:absolute;grid-template-columns:1fr 1fr 1fr 1fr;margin-top:-70px;margin-left:43px;border-radius:10px;background-color:var(--color-background-2);display:none;z-index:1000}.color-popup.top-left{margin-top:110px;margin-left:-54px}.color-popup.shown{display:grid}.color-option{padding:8px}.color-option.active{padding:0}.color-option.active .color-sample{width:32px;height:32px;border-radius:20px}.color-sample{width:16px;height:16px;border-radius:10px}.choosen-color{width:32px;height:32px;border-radius:20px}",ZeaInput=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.name="zea-input",this.type="text",this.label="Enter text...",this.invalidMessage="Not valid",this.required=!1,this.isValid=!0,this.autoValidate=!1,this.invalidMessageShown=!1,this.showLabel=!1,this.photoBase64="",this.colorPopupShown=!1,this.colorPopupAlign="bottom-right",this.colorOptions=["#F34235","#E81D62","#000000","#9B26AF","#6639B6","#3E50B4","#2095F2","#02A8F3","#00BBD3","#009587","#4BAE4F","#8AC249","#CCDB38","#FEEA3A","#FEC006","#FE9700","#FE5621","#785447","#9D9D9D","#5F7C8A"]}handleClick(t){t.composedPath().includes(this.colorPopup)||t.composedPath().includes(this.selectedColorContainer)||(this.colorPopupShown=!1)}checkValue(){this.inputElement&&("photo"==this.type?this.value=this.photoBase64:"color"==this.type?this.value=this.selectedColor:(this.value=this.inputElement.value,this.value.replace(/(^\s+|\s+$)/,"")),this.required&&(this.value?(this.isValid=!0,this.invalidMessageShown=!1):(this.invalidMessage="Field is required",this.isValid=!1,this.autoValidate&&(this.invalidMessageShown=!0))))}onKeyUp(t){this.checkValue(),t.stopPropagation()}onKeyDown(t){t.stopPropagation()}onColorClick(t){this.selectColor(t.currentTarget.dataset.color)}selectColor(t){const e=this.inputWrapElement.querySelector(`.color-option[data-color="${t}"]`);e&&(this.selectedColor=e.dataset.color,this.currentColorElement&&this.currentColorElement.classList.remove("active"),e.classList.add("active"),this.currentColorElement=e,this.value=this.selectedColor)}onPhotoChange(t){const e=t.currentTarget.files[0],i=new FileReader;i.addEventListener("load",()=>{this.photoBase64=""+i.result,this.value=this.photoBase64,this.checkValue()},!1),e&&i.readAsDataURL(e)}componentDidRender(){}componentWillLoad(){"color"!=this.type||this.selectedColor||this.value?"color"==this.type&&this.value&&(this.selectedColor=this.value):(this.selectedColor=this.colorOptions[Math.floor(Math.random()*this.colorOptions.length)],this.value=this.selectedColor),"photo"==this.type&&this.value&&(this.photoBase64=this.value)}componentDidLoad(){this.selectColor(this.selectedColor)}render(){const t={text:[this.showLabel&&h("label",{class:"input-label"},this.label),h("input",{ref:t=>this.inputElement=t,placeholder:this.showLabel?"":this.label,type:"text",value:this.value,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),class:{invalid:(this.autoValidate||this.invalidMessageShown)&&!this.isValid}})],photo:h("div",{class:"photo-input"},h("div",{class:"photo-thumb",onClick:()=>{this.inputElement.dispatchEvent(new MouseEvent("click"))}},h("zea-icon",{name:"camera-outline",size:30}),h("div",{id:"photo-preview",style:{backgroundImage:`url(${this.value})`}})),h("div",{class:"photo-copy"},h("label",{class:"input-label"},this.label),"Your photo lets people recognize you while working together."),h("input",{ref:t=>this.inputElement=t,type:"file",onChange:this.onPhotoChange.bind(this),class:{invalid:(this.autoValidate||this.invalidMessageShown)&&!this.isValid}})),color:h("div",{class:"color-input"},h("div",{class:"color-thumb"},h("div",{ref:t=>this.selectedColorContainer=t,class:"choosen-color",style:{backgroundColor:this.selectedColor},onClick:()=>{this.colorPopupShown=!this.colorPopupShown}}),h("div",{ref:t=>this.colorPopup=t,class:`color-popup ${this.colorPopupShown?"shown":""} ${this.colorPopupAlign}`},this.colorOptions.map(t=>h("div",{class:"color-option","data-color":t,onMouseDown:this.onColorClick.bind(this),onMouseUp:()=>{this.colorPopupShown=!1}},h("div",{class:"color-sample",style:{backgroundColor:t}}))))),this.showLabel&&h("div",{class:"color-copy"},h("label",{class:"input-label"},this.label),"Your color helps you stand out from other people."))};return h("div",{class:"input-wrap",ref:t=>this.inputWrapElement=t},t[this.type],!this.isValid&&this.invalidMessageShown&&h("div",{class:"invalid-message"},this.invalidMessage))}static get style(){return zeaInputCss}},zeaInputColorCss=".color-input{display:-ms-flexbox;display:flex;overflow:hidden}.color-input .input-label{display:block}.color-thumb{-ms-flex-negative:0;flex-shrink:0;display:block;width:54px;height:54px;border-radius:30px;margin-right:10px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;font-size:12px}.color-copy{font-size:12px;color:var(--color-foreground-2)}.color-popup{padding:7px;position:absolute;grid-template-columns:1fr 1fr 1fr 1fr;margin-top:-70px;margin-left:43px;border-radius:10px;background-color:var(--color-background-2);display:none;z-index:1000}.color-popup.top-left{margin-top:110px;margin-left:-54px}.color-popup.shown{display:grid}.color-option{padding:8px}.color-option:hover{padding:0px}.color-option.active:hover,.color-option.active{padding:0}.color-option:hover .color-sample{border:8px solid var(--color-background-1);border-radius:20px}.color-option.active:hover .color-sample,.color-option.active .color-sample{width:32px;height:32px;border-radius:20px;border:none}.color-sample{width:16px;height:16px;border-radius:10px}.choosen-color{width:32px;height:32px;border-radius:20px}",ZeaInputColor=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.showLabel=!1,this.invalidMessage="Not valid",this.invalidMessageShown=!1,this.required=!1,this.isValid=!0,this.colorPopupShown=!1,this.colorPopupAlign="bottom-right",this.label="Color",this.name="zea-input",this.colorOptions=["#F34235","#E81D62","#000000","#9B26AF","#6639B6","#3E50B4","#2095F2","#02A8F3","#00BBD3","#009587","#4BAE4F","#8AC249","#CCDB38","#FEEA3A","#FEC006","#FE9700","#FE5621","#785447","#9D9D9D","#5F7C8A"]}handleClick(t){t.composedPath().includes(this.colorPopup)||t.composedPath().includes(this.selectedColorContainer)||(this.colorPopupShown=!1)}onColorClick(t){this.selectColor(t.currentTarget.dataset.color)}selectColor(t){const e=this.inputWrapElement.querySelector(`.color-option[data-color="${t}"]`);e&&(this.selectedColor=e.dataset.color,this.currentColorElement&&this.currentColorElement.classList.remove("active"),e.classList.add("active"),this.currentColorElement=e,this.value=this.selectedColor)}componentWillLoad(){this.selectedColor||this.value?this.value&&(this.selectedColor=this.value):(this.selectedColor=this.colorOptions[Math.floor(Math.random()*this.colorOptions.length)],this.value=this.selectedColor)}componentDidLoad(){if(this.value){const t=this.inputWrapElement.querySelector(`.color-option[data-color="${this.value}"]`);if(!t)return;this.currentColorElement&&this.currentColorElement.classList.remove("active"),t.classList.add("active"),this.currentColorElement=t}}render(){return h("div",{class:"input-wrap",ref:t=>this.inputWrapElement=t},h("div",{class:"color-input"},h("div",{class:"color-thumb"},h("div",{ref:t=>this.selectedColorContainer=t,class:"choosen-color",style:{backgroundColor:this.selectedColor},onClick:()=>{this.colorPopupShown=!this.colorPopupShown}}),h("div",{ref:t=>this.colorPopup=t,class:`color-popup ${this.colorPopupShown?"shown":""} ${this.colorPopupAlign}`},this.colorOptions.map(t=>h("div",{class:"color-option","data-color":t,onMouseDown:this.onColorClick.bind(this),onMouseUp:()=>{this.colorPopupShown=!1}},h("div",{class:"color-sample",style:{backgroundColor:t}}))))),this.showLabel&&h("div",{class:"color-copy"},h("label",{class:"input-label"},this.label),"Your color helps you stand out from other people.")),!this.isValid&&this.invalidMessageShown&&h("div",{class:"invalid-message"},this.invalidMessage))}static get style(){return zeaInputColorCss}},zeaInputDateCss=".zea-input-date{color:var(--color-freground-1)}",ZeaInputDate=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.test="Hello World"}render(){return h("div",{class:"zea-input-date"},this.test)}static get style(){return zeaInputDateCss}},zeaInputPhotoCss=".zea-input-photo{color:var(--color-freground-1)}",ZeaInputPhoto=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.test="Hello World"}render(){return h("div",{class:"zea-input-photo"},this.test)}static get style(){return zeaInputPhotoCss}},zeaInputSearchCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-input-search{color:var(--color-foreground-1);display:-ms-inline-flexbox;display:inline-flex;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:center;align-items:center;width:2em;border-radius:3px;-webkit-transition:all 0.5s;transition:all 0.5s;background-color:transparent;border:1px solid transparent}path.icon{fill:var(--color-foreground-1)}.zea-input-search.active{width:100%;border:1px solid var(--color-grey-3);background-color:var(--color-background-1)}.zea-input-search-icon{height:2em;width:2em;display:inline-block;vertical-align:middle;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0.2em;-ms-flex-positive:0;flex-grow:0;-ms-flex-negative:0;flex-shrink:0}.zea-input-search-icon:hover{background-color:var(--color-grey-3);color:var(--color-button-text-1)}.zea-input-search.active .zea-input-search-icon:hover{background-color:var(--color-background-1)}input{display:block;height:100%;width:100%;border:none;background-color:transparent;outline:none;font-size:1em;color:var(--color-foreground-1)}.zea-input-search-text-container{height:2em;-ms-flex-positive:1;flex-grow:1;opacity:0;-webkit-transition:all 0.5s;transition:all 0.5s}.zea-input-search.active .zea-input-search-text-container{opacity:1}.zea-input-cancel{display:none;height:1.5em;width:1.5em;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-negative:0;flex-shrink:0}.active .zea-input-cancel{display:block;visibility:hidden}.tainted .zea-input-cancel{visibility:visible}",ZeaInputSearch=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.placeholder=""}toggleSearchBox(){this.mainContainer.classList.toggle("active"),this.mainInput.focus()}cancelSearch(){this.mainInput.value=""}componentDidLoad(){this.mainInput.addEventListener("keyup",()=>{this.mainInput.value.replace(/(^\s+|\s+$)/,"")?this.mainContainer.classList.add("tainted"):this.mainContainer.classList.remove("tainted")})}render(){return h("div",{class:"zea-input-search",ref:t=>{this.mainContainer=t}},h("span",{class:"zea-input-search-icon",onClick:()=>{this.toggleSearchBox()}},h("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24"},h("path",{class:"icon",d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),h("path",{d:"M0 0h24v24H0z",fill:"none"}))),h("span",{class:"zea-input-search-text-container"},h("input",{ref:t=>{this.mainInput=t},onBlur:()=>{setTimeout(()=>{this.mainContainer.classList.remove("active")},100)},onKeyDown:t=>{t.stopPropagation()},onKeyUp:t=>{t.stopPropagation()},class:"zea-input-search-text",type:"text",placeholder:this.placeholder})),h("span",{class:"zea-input-cancel",onClick:()=>{this.cancelSearch()}},h("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 512 512"},h("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z",class:"icon"}))))}get mainElement(){return this}static get style(){return zeaInputSearchCss}},zeaInputSelectCss=":host{display:inline-block;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:13px}.zea-input{color:var(--color-foreground-1)}.input-label{color:var(--color-grey-3);position:relative;-webkit-transition:all 0.2s linear;transition:all 0.2s linear;pointer-events:none}.empty .input-label{top:18px;font-size:13px}.not-empty .input-label,.focused .input-label{top:0;font-size:11px}.focused .input-label{color:var(--color-secondary-1)}.input-wrap{display:block;position:relative}.invalid-message{color:var(--color-warning-2);padding:0.3em 0;font-size:12px}.underliner{text-align:center;height:1px;background-color:var(--color-grey-3);overflow:hidden;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.underliner .expander{height:1px;background-color:var(--color-secondary-1);overflow:hidden;display:inline-block;width:0;-webkit-transition:width 0.2s linear;transition:width 0.2s linear}.focused .underliner .expander{width:100%}.selection-container{min-height:22px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.selection{-ms-flex-positive:1;flex-grow:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.options-container{display:none;position:absolute;width:100%;height:210px;max-height:initial;overflow:hidden;padding:2px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:2px 2px 13px 0px var(--color-background-4);box-shadow:2px 2px 13px 0px var(--color-background-4);background-color:var(--color-background-1);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1000;margin-top:1px}.options-container.shown{display:block}.discipline-row{display:-ms-flexbox;display:flex;width:100%;-ms-flex-align:center;align-items:center}.discipline-name{-ms-flex-positive:1;flex-grow:1}.discipline-abbreviation{text-transform:uppercase;padding:8px;width:15px;height:15px;line-height:15px;text-align:center;border-radius:20px;margin:5px 10px 5px 5px;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;white-space:nowrap}",ZeaInputSelect=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.name="zea-input",this.label="Enter text...",this.invalidMessage="Not valid",this.required=!1,this.isValid=!0,this.autoValidate=!1,this.invalidMessageShown=!1,this.showLabel=!0,this.optionsShown=!1}handleClick(t){t.composedPath().includes(this.inputWrapElement)||(this.optionsShown=!1)}checkValue(){this.inputElement&&(this.value=this.inputElement.value,this.value.replace(/(^\s+|\s+$)/,""),this.required&&(this.value?(this.isValid=!0,this.invalidMessageShown=!1):(this.invalidMessage="Field is required",this.isValid=!1,this.autoValidate&&(this.invalidMessageShown=!0))))}onContainerClick(){this.optionsShown=!this.optionsShown}onBlur(){this.inputWrapElement.classList.remove("focused")}onFocus(){this.inputWrapElement.classList.add("focused")}componentDidLoad(){this.optionsContainer.addEventListener("click",t=>{t.composedPath().forEach(t=>{if("ZEA-INPUT-SELECT-ITEM"==t.tagName){this.value=t.value,this.optionsShown=!1;const e=this.selectionContainer.querySelector(".selection");e.innerHTML="",e.appendChild(t.cloneNode(!0)),this.selectCallback&&this.selectCallback(this.value)}})})}placeOptionsContainer(){if(this.optionsShown){const t=105,e=210,i=this.inputWrapElement.getBoundingClientRect(),n=i.top+i.height,s=window.innerHeight;let o=e;if(this.optionsContainer.style.height=o+"px",this.optionsContainer.style.top=i.height+"px",n+o>s){const r=s-n;if(o=r,r<t){const n=i.top;n>t&&(o=Math.min(n,e),this.optionsContainer.style.top=-o+"px")}this.optionsContainer.style.height=o+"px"}}}componentDidRender(){this.placeOptionsContainer(),this.optionsScrollPane.refreshScrollbar()}render(){return h("div",{class:`input-wrap ${this.value?"not-empty":"empty"} ${this.optionsShown?"focused":""}`,ref:t=>this.inputWrapElement=t},this.showLabel&&h("label",{class:"input-label"},this.label),h("div",{ref:t=>this.selectionContainer=t,class:"selection-container",onClick:this.onContainerClick.bind(this)},h("div",{class:"selection"}),h("zea-icon",{name:this.optionsShown?"chevron-up-outline":"chevron-down-outline",size:13})),h("div",{ref:t=>this.optionsContainer=t,class:{"options-container":!0,shown:this.optionsShown}},h("zea-scroll-pane",{ref:t=>this.optionsScrollPane=t},h("slot",null))),h("div",{class:"underliner"},h("div",{class:"expander"})),!this.isValid&&this.invalidMessageShown&&h("div",{class:"invalid-message"},this.invalidMessage))}static get style(){return zeaInputSelectCss}},zeaInputSelectItemCss=":host{display:block}.zea-input-select-item{color:var(--color-freground-1)}::slotted(.select-item-wrap){padding:5px}",ZeaInputSelectItem=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h("div",{class:"zea-input-select-item"},h("slot",null))}static get style(){return zeaInputSelectItemCss}},zeaInputTextCss=":host{display:inline-block;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.hidden){display:none}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-input{color:var(--color-foreground-1)}.input-label{color:var(--color-foreground-3);position:relative;-webkit-transition:all 0.2s linear;transition:all 0.2s linear;pointer-events:none}.empty .input-label{top:18px;font-size:13px}.not-empty .input-label,.focused .input-label{top:0;font-size:11px}.focused .input-label{color:var(--color-secondary-1)}.input-wrap{display:block;position:relative}input[type='text']{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;color:var(--color-foreground-1);background-color:transparent;border:none;outline:none;font-size:1em;font-size:13px}.invalid-message{color:var(--color-warning-1);padding:0.3em 0;font-size:12px}.underliner{text-align:center;height:1px;background-color:var(--color-grey-3);overflow:hidden;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.underliner .expander{height:1px;background-color:var(--color-secondary-1);overflow:hidden;display:inline-block;width:0;-webkit-transition:width 0.2s linear;transition:width 0.2s linear}.focused .underliner .expander{width:100%}.invalid .underliner .expander{background-color:var(--color-warning-1);width:100%}.disabled .underliner{background-color:transparent;border-bottom:1px dotted var(--color-grey-3)}.hidden{display:none}",ZeaInputText=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.name="zea-input",this.label="Enter text...",this.invalidMessage="Not valid",this.required=!1,this.disabled=!1,this.isValid=!0,this.autoValidate=!1,this.invalidMessageShown=!1,this.showLabel=!0,this.hidden=!1}checkValue(){this.inputElement&&(this.value=this.inputElement.value,this.value.replace(/(^\s+|\s+$)/,""),this.required&&(this.value?(this.isValid=!0,this.invalidMessageShown=!1):(this.invalidMessage="Field is required",this.isValid=!1,this.autoValidate&&(this.invalidMessageShown=!0))))}onKeyUp(t){this.checkValue(),t.stopPropagation()}onKeyDown(t){t.stopPropagation()}onBlur(){this.inputWrapElement.classList.remove("focused")}onFocus(){this.inputWrapElement.classList.add("focused")}componentDidRender(){this.checkValue()}render(){return h(Host,{class:this.hidden?"hidden":""},h("div",{class:`input-wrap ${this.value?"not-empty":"empty"} ${this.invalidMessageShown?"invalid":"valid"} ${this.disabled?"disabled":""} ${this.hidden?"hidden":""}`,ref:t=>this.inputWrapElement=t},this.showLabel&&h("label",{class:"input-label"},this.label),h("input",{ref:t=>this.inputElement=t,type:"text",value:this.value,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),disabled:this.disabled,class:{invalid:(this.autoValidate||this.invalidMessageShown)&&!this.isValid}}),h("div",{class:"underliner"},h("div",{class:"expander"})),!this.isValid&&this.invalidMessageShown&&h("div",{class:"invalid-message"},this.invalidMessage)))}static get style(){return zeaInputTextCss}},zeaLayoutCss=":host{height:100%}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-layout{color:var(--color-foreground-1);display:-ms-flexbox;display:flex;width:100%;height:100%}.zea-layout.vertical{-ms-flex-direction:column;flex-direction:column}.zea-layout-cell{-ms-flex-positive:1;flex-grow:1;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:var(--color-background-1);width:100%;height:100%}.with-borders .zea-layout-cell{border:1px solid var(--color-grey-1)}.zea-layout-cell:nth-child(1){-ms-flex-positive:0;flex-grow:0;width:100px;height:auto}.zea-layout-cell:nth-child(3){-ms-flex-positive:0;flex-grow:0;width:100px;height:auto}.vertical .zea-layout-cell:nth-child(1){-ms-flex-positive:0;flex-grow:0;height:100px;width:auto}.vertical .zea-layout-cell:nth-child(3){-ms-flex-positive:0;flex-grow:0;height:100px;width:auto}.zea-resize-handle{position:absolute;display:block;content:'';width:6px;height:100%;background-color:transparent;background-repeat:no-repeat;background-position:center center;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAXCAYAAAAoRj52AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEFJREFUeNpinDRp0v+XL18yLF26lFFMTIwhJiYGzGf6/fs3w58/fxhgAMZnYsABRiWGrwQLCwsDMzMzXADGBwgwAF78GJLqRabNAAAAAElFTkSuQmCC);z-index:1000000;top:0;opacity:0.5;cursor:col-resize}.zea-resize-handle:hover{background-color:var(--color-background-2);opacity:1}.vertical .zea-resize-handle{left:0 !important;right:0 !important;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAGCAYAAAAooAWeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAD1JREFUeNpinDhx4v8/f/4wUBuwsrIysLx8+ZLh79+/VDechYWFgVFBQYGBVoBFTEyMdoZHR0cPzTAHCDAAG7UW+bsxwNcAAAAASUVORK5CYII=')}.zea-layout-cell:nth-child(1) .zea-resize-handle{right:-1px}.zea-layout-cell:nth-child(3) .zea-resize-handle{left:-1px}.vertical .zea-resize-handle{position:absolute;width:100%;height:6px;cursor:row-resize;margin-left:0;left:0;background-repeat:no-repeat}.vertical .zea-layout-cell:nth-child(1) .zea-resize-handle{bottom:-1px;top:auto}.vertical .zea-layout-cell:nth-child(3) .zea-resize-handle{top:-1px}",ZeaLayout=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.cellCount=3,this.orientation="horizontal",this.resizeCellA=!0,this.resizeCellC=!0,this.cellASize=100,this.cellCSize=100,this.resizeInterval=50,this.showBorders=!0,this.error="",this.minimumGap=20,this.maximunGap=50}handleMouseDown(t){this.activeHandle=t.target,document.getElementsByTagName("body")[0].style.cursor="vertical"===this.orientation?"row-resize":"col-resize",document.getElementsByTagName("body")[0].style.userSelect="none"}onMouseUp(){this.handleMouseUp()}onTouchEnd(){this.handleMouseUp()}handleMouseUp(){this.activeHandle=null,document.getElementsByTagName("body")[0].style.cursor="default",document.getElementsByTagName("body")[0].style.userSelect="initial"}onMouseMove(t){this.handleMouseMove.call(this,t)}onTouchMove(t){this.handleMouseMove.call(this,t)}handleMouseMove(t){if(this.activeHandle){const e=this.activeHandle.classList.contains("zea-handle-a");this.processDrag(t,"vertical"===this.orientation?"Y":"X",e?"a":"c")}}processDrag(t,e,i){const n=this.activeHandle,s=n.parentElement,o=s.getBoundingClientRect(),r=n.getBoundingClientRect(),a="X"==e?"left":"top",l="X"==e?"width":"height",c=this.cellB.getBoundingClientRect()[l];let h;h=t.touches?r[a]-t.touches[0]["page"+e]:r[a]-t["client"+e],h="a"==i?-h:h;let d=o[l]+h;s.style[l]=d+"px",d<this.minimumGap&&(d=this.minimumGap);const u=o[l]+c-this.minimumGap;d>u&&(d=u),this["a"==i?"cellASize":"cellCSize"]=d,s.style[l]=d+"px",this.triggerResize(d)}triggerResize(t){window.dispatchEvent(new CustomEvent("resize",{bubbles:!0,detail:t}))}layout(){let t,e;"vertical"===this.orientation?(t="height",e=this.layoutContainer.clientHeight):(t="width",e=this.layoutContainer.clientWidth);const i=e-this.cellASize-this.cellCSize;this.cellB.style[t]=i>=0?i+"px":"1px",this.cellA.style[t]=this.cellASize+"px",this.cellC.style[t]=this.cellCSize+"px"}componentDidLoad(){this.mainElement.addEventListener("dragstart",t=>{t.preventDefault(),t.stopPropagation()}),window.addEventListener("resize",()=>{this.layout()})}componentDidRender(){this.layout()}render(){const t={},e={};this.cellASize||(this.resizeCellA=!1),this.cellCSize||(this.resizeCellC=!1),void 0!==this.cellASize&&("vertical"===this.orientation?t.height=this.cellASize+"px":t.width=this.cellASize+"px"),void 0!==this.cellCSize&&("vertical"===this.orientation?e.height=this.cellCSize+"px":e.width=this.cellCSize+"px");const i=h("div",{class:"zea-layout-cell cell-a",style:t,ref:t=>this.cellA=t},this.resizeCellA&&h("div",{class:"zea-resize-handle zea-handle-a",onMouseDown:this.handleMouseDown.bind(this),onTouchStart:this.handleMouseDown.bind(this)}),h("slot",{name:"a"})),n=h("div",{class:"zea-layout-cell cell-b",ref:t=>this.cellB=t},h("slot",{name:"b"})),s=this.cellCount>2&&h("div",{class:"zea-layout-cell cell-c",style:e,ref:t=>this.cellC=t},this.resizeCellC&&h("div",{class:"zea-resize-handle zea-handle-c",onMouseDown:this.handleMouseDown.bind(this),onTouchStart:this.handleMouseDown.bind(this)}),h("slot",{name:"c"}));return h("div",{ref:t=>this.layoutContainer=t,class:`zea-layout ${this.orientation} ${this.showBorders?"with-borders":""}`},this.error||[i,n,s])}get mainElement(){return this}static get style(){return zeaLayoutCss}};var textarea;function decodeEntity(t){return(textarea=textarea||document.createElement("textarea")).innerHTML="&"+t,textarea.value}function typeOf(t){return Object.prototype.toString.call(t)}function isString(t){return"[object String]"===typeOf(t)}var hasOwn=Object.prototype.hasOwnProperty;function has$1(t,e){return!!t&&hasOwn.call(t,e)}function assign$2(t){var e=[].slice.call(arguments,1);return e.forEach((function(e){if(e){if("object"!=typeof e)throw new TypeError(e+"must be object");Object.keys(e).forEach((function(i){t[i]=e[i]}))}})),t}var UNESCAPE_MD_RE=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function unescapeMd(t){return t.indexOf("\\")<0?t:t.replace(UNESCAPE_MD_RE,"$1")}function isValidEntityCode(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||65535==(65535&t)||65534==(65535&t)||t>=0&&t<=8||11===t||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function fromCodePoint(t){return t>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):String.fromCharCode(t)}var NAMED_ENTITY_RE=/&([a-z#][a-z0-9]{1,31});/gi,DIGITAL_ENTITY_TEST_RE=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function replaceEntityPattern(t,e){var i=0,n=decodeEntity(e);return e!==n?n:35===e.charCodeAt(0)&&DIGITAL_ENTITY_TEST_RE.test(e)&&isValidEntityCode(i="x"===e[1].toLowerCase()?parseInt(e.slice(2),16):parseInt(e.slice(1),10))?fromCodePoint(i):t}function replaceEntities(t){return t.indexOf("&")<0?t:t.replace(NAMED_ENTITY_RE,replaceEntityPattern)}var HTML_ESCAPE_TEST_RE=/[&<>"]/,HTML_ESCAPE_REPLACE_RE=/[&<>"]/g,HTML_REPLACEMENTS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function replaceUnsafeChar(t){return HTML_REPLACEMENTS[t]}function escapeHtml(t){return HTML_ESCAPE_TEST_RE.test(t)?t.replace(HTML_ESCAPE_REPLACE_RE,replaceUnsafeChar):t}var utils=Object.freeze({isString,has:has$1,assign:assign$2,unescapeMd,isValidEntityCode,fromCodePoint,replaceEntities,escapeHtml}),rules={};function nextToken(t,e){return++e>=t.length-2?e:"paragraph_open"===t[e].type&&t[e].tight&&"inline"===t[e+1].type&&0===t[e+1].content.length&&"paragraph_close"===t[e+2].type&&t[e+2].tight?nextToken(t,e+2):e}rules.blockquote_open=function(){return"<blockquote>\n"},rules.blockquote_close=function(t,e){return"</blockquote>"+getBreak(t,e)},rules.code=function(t,e){return t[e].block?"<pre><code>"+escapeHtml(t[e].content)+"</code></pre>"+getBreak(t,e):"<code>"+escapeHtml(t[e].content)+"</code>"},rules.fence=function(t,e,i,n,s){var o,r,a=t[e],l="",c=i.langPrefix;if(a.params){if(r=(o=a.params.split(/\s+/g)).join(" "),has$1(s.rules.fence_custom,o[0]))return s.rules.fence_custom[o[0]](t,e,i,n,s);l=' class="'+c+escapeHtml(replaceEntities(unescapeMd(r)))+'"'}return"<pre><code"+l+">"+(i.highlight&&i.highlight.apply(i.highlight,[a.content].concat(o))||escapeHtml(a.content))+"</code></pre>"+getBreak(t,e)},rules.fence_custom={},rules.heading_open=function(t,e){return"<h"+t[e].hLevel+">"},rules.heading_close=function(t,e){return"</h"+t[e].hLevel+">\n"},rules.hr=function(t,e,i){return(i.xhtmlOut?"<hr />":"<hr>")+getBreak(t,e)},rules.bullet_list_open=function(){return"<ul>\n"},rules.bullet_list_close=function(t,e){return"</ul>"+getBreak(t,e)},rules.list_item_open=function(){return"<li>"},rules.list_item_close=function(){return"</li>\n"},rules.ordered_list_open=function(t,e){var i=t[e];return"<ol"+(i.order>1?' start="'+i.order+'"':"")+">\n"},rules.ordered_list_close=function(t,e){return"</ol>"+getBreak(t,e)},rules.paragraph_open=function(t,e){return t[e].tight?"":"<p>"},rules.paragraph_close=function(t,e){return(t[e].tight?"":"</p>")+(t[e].tight&&e&&"inline"===t[e-1].type&&!t[e-1].content?"":getBreak(t,e))},rules.link_open=function(t,e,i){var n=t[e].title?' title="'+escapeHtml(replaceEntities(t[e].title))+'"':"",s=i.linkTarget?' target="'+i.linkTarget+'"':"";return'<a href="'+escapeHtml(t[e].href)+'"'+n+s+">"},rules.link_close=function(){return"</a>"},rules.image=function(t,e,i){var n=' src="'+escapeHtml(t[e].src)+'"',s=t[e].title?' title="'+escapeHtml(replaceEntities(t[e].title))+'"':"";return"<img"+n+' alt="'+(t[e].alt?escapeHtml(replaceEntities(unescapeMd(t[e].alt))):"")+'"'+s+(i.xhtmlOut?" /":"")+">"},rules.table_open=function(){return"<table>\n"},rules.table_close=function(){return"</table>\n"},rules.thead_open=function(){return"<thead>\n"},rules.thead_close=function(){return"</thead>\n"},rules.tbody_open=function(){return"<tbody>\n"},rules.tbody_close=function(){return"</tbody>\n"},rules.tr_open=function(){return"<tr>"},rules.tr_close=function(){return"</tr>\n"},rules.th_open=function(t,e){var i=t[e];return"<th"+(i.align?' style="text-align:'+i.align+'"':"")+">"},rules.th_close=function(){return"</th>"},rules.td_open=function(t,e){var i=t[e];return"<td"+(i.align?' style="text-align:'+i.align+'"':"")+">"},rules.td_close=function(){return"</td>"},rules.strong_open=function(){return"<strong>"},rules.strong_close=function(){return"</strong>"},rules.em_open=function(){return"<em>"},rules.em_close=function(){return"</em>"},rules.del_open=function(){return"<del>"},rules.del_close=function(){return"</del>"},rules.ins_open=function(){return"<ins>"},rules.ins_close=function(){return"</ins>"},rules.mark_open=function(){return"<mark>"},rules.mark_close=function(){return"</mark>"},rules.sub=function(t,e){return"<sub>"+escapeHtml(t[e].content)+"</sub>"},rules.sup=function(t,e){return"<sup>"+escapeHtml(t[e].content)+"</sup>"},rules.hardbreak=function(t,e,i){return i.xhtmlOut?"<br />\n":"<br>\n"},rules.softbreak=function(t,e,i){return i.breaks?i.xhtmlOut?"<br />\n":"<br>\n":"\n"},rules.text=function(t,e){return escapeHtml(t[e].content)},rules.htmlblock=function(t,e){return t[e].content},rules.htmltag=function(t,e){return t[e].content},rules.abbr_open=function(t,e){return'<abbr title="'+escapeHtml(replaceEntities(t[e].title))+'">'},rules.abbr_close=function(){return"</abbr>"},rules.footnote_ref=function(t,e){var i=Number(t[e].id+1).toString(),n="fnref"+i;return t[e].subId>0&&(n+=":"+t[e].subId),'<sup class="footnote-ref"><a href="#fn'+i+'" id="'+n+'">['+i+"]</a></sup>"},rules.footnote_block_open=function(t,e,i){return(i.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},rules.footnote_block_close=function(){return"</ol>\n</section>\n"},rules.footnote_open=function(t,e){return'<li id="fn'+Number(t[e].id+1).toString()+'"  class="footnote-item">'},rules.footnote_close=function(){return"</li>\n"},rules.footnote_anchor=function(t,e){var i="fnref"+Number(t[e].id+1).toString();return t[e].subId>0&&(i+=":"+t[e].subId),' <a href="#'+i+'" class="footnote-backref"></a>'},rules.dl_open=function(){return"<dl>\n"},rules.dt_open=function(){return"<dt>"},rules.dd_open=function(){return"<dd>"},rules.dl_close=function(){return"</dl>\n"},rules.dt_close=function(){return"</dt>\n"},rules.dd_close=function(){return"</dd>\n"};var getBreak=rules.getBreak=function(t,e){return(e=nextToken(t,e))<t.length&&"list_item_close"===t[e].type?"":"\n"};function Renderer(){this.rules=assign$2({},rules),this.getBreak=rules.getBreak}function Ruler(){this.__rules__=[],this.__cache__=null}function block(t){t.inlineMode?t.tokens.push({type:"inline",content:t.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):t.block.parse(t.src,t.options,t.env,t.tokens)}function StateInline(t,e,i,n,s){this.src=t,this.env=n,this.options=i,this.parser=e,this.tokens=s,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}function parseLinkLabel(t,e){var i,n,s,o=-1,r=t.posMax,a=t.pos,l=t.isInLabel;if(t.isInLabel)return-1;if(t.labelUnmatchedScopes)return t.labelUnmatchedScopes--,-1;for(t.pos=e+1,t.isInLabel=!0,i=1;t.pos<r;){if(91===(s=t.src.charCodeAt(t.pos)))i++;else if(93===s&&0==--i){n=!0;break}t.parser.skipToken(t)}return n?(o=t.pos,t.labelUnmatchedScopes=0):t.labelUnmatchedScopes=i-1,t.pos=a,t.isInLabel=l,o}function parseAbbr(t,e,i,n){var s,o,r,a,l,c;if(42!==t.charCodeAt(0))return-1;if(91!==t.charCodeAt(1))return-1;if(-1===t.indexOf("]:"))return-1;if((o=parseLinkLabel(s=new StateInline(t,e,i,n,[]),1))<0||58!==t.charCodeAt(o+1))return-1;for(a=s.posMax,r=o+2;r<a&&10!==s.src.charCodeAt(r);r++);return l=t.slice(2,o),0===(c=t.slice(o+2,r).trim()).length?-1:(n.abbreviations||(n.abbreviations={}),void 0===n.abbreviations[":"+l]&&(n.abbreviations[":"+l]=c),r)}function abbr(t){var e,i,n,s,o=t.tokens;if(!t.inlineMode)for(e=1,i=o.length-1;e<i;e++)if("paragraph_open"===o[e-1].type&&"inline"===o[e].type&&"paragraph_close"===o[e+1].type){for(n=o[e].content;n.length&&!((s=parseAbbr(n,t.inline,t.options,t.env))<0);)n=n.slice(s).trim();o[e].content=n,n.length||(o[e-1].tight=!0,o[e+1].tight=!0)}}function normalizeLink(t){var e=replaceEntities(t);try{e=decodeURI(e)}catch(i){}return encodeURI(e)}function parseLinkDestination(t,e){var i,n,s,o=e,r=t.posMax;if(60===t.src.charCodeAt(e)){for(e++;e<r;){if(10===(i=t.src.charCodeAt(e)))return!1;if(62===i)return s=normalizeLink(unescapeMd(t.src.slice(o+1,e))),!!t.parser.validateLink(s)&&(t.pos=e+1,t.linkContent=s,!0);92===i&&e+1<r?e+=2:e++}return!1}for(n=0;e<r&&32!==(i=t.src.charCodeAt(e))&&!(i<32||127===i);)if(92===i&&e+1<r)e+=2;else{if(40===i&&++n>1)break;if(41===i&&--n<0)break;e++}return o!==e&&(s=unescapeMd(t.src.slice(o,e)),!!t.parser.validateLink(s)&&(t.linkContent=s,t.pos=e,!0))}function parseLinkTitle(t,e){var i,n=e,s=t.posMax,o=t.src.charCodeAt(e);if(34!==o&&39!==o&&40!==o)return!1;for(e++,40===o&&(o=41);e<s;){if((i=t.src.charCodeAt(e))===o)return t.pos=e+1,t.linkContent=unescapeMd(t.src.slice(n+1,e)),!0;92===i&&e+1<s?e+=2:e++}return!1}function normalizeReference(t){return t.trim().replace(/\s+/g," ").toUpperCase()}function parseReference(t,e,i,n){var s,o,r,a,l,c,h,d,u;if(91!==t.charCodeAt(0))return-1;if(-1===t.indexOf("]:"))return-1;if((o=parseLinkLabel(s=new StateInline(t,e,i,n,[]),0))<0||58!==t.charCodeAt(o+1))return-1;for(a=s.posMax,r=o+2;r<a&&(32===(l=s.src.charCodeAt(r))||10===l);r++);if(!parseLinkDestination(s,r))return-1;for(h=s.linkContent,c=r=s.pos,r+=1;r<a&&(32===(l=s.src.charCodeAt(r))||10===l);r++);for(r<a&&c!==r&&parseLinkTitle(s,r)?(d=s.linkContent,r=s.pos):(d="",r=c);r<a&&32===s.src.charCodeAt(r);)r++;return r<a&&10!==s.src.charCodeAt(r)?-1:(u=normalizeReference(t.slice(1,o)),void 0===n.references[u]&&(n.references[u]={title:d,href:h}),r)}function references(t){var e,i,n,s,o=t.tokens;if(t.env.references=t.env.references||{},!t.inlineMode)for(e=1,i=o.length-1;e<i;e++)if("inline"===o[e].type&&"paragraph_open"===o[e-1].type&&"paragraph_close"===o[e+1].type){for(n=o[e].content;n.length&&!((s=parseReference(n,t.inline,t.options,t.env))<0);)n=n.slice(s).trim();o[e].content=n,n.length||(o[e-1].tight=!0,o[e+1].tight=!0)}}function inline(t){var e,i,n,s=t.tokens;for(i=0,n=s.length;i<n;i++)"inline"===(e=s[i]).type&&t.inline.parse(e.content,t.options,t.env,e.children)}function footnote_block(t){var e,i,n,s,o,r,a,l,c,h=0,d=!1,u={};if(t.env.footnotes&&(t.tokens=t.tokens.filter((function(t){return"footnote_reference_open"===t.type?(d=!0,l=[],c=t.label,!1):"footnote_reference_close"===t.type?(d=!1,u[":"+c]=l,!1):(d&&l.push(t),!d)})),t.env.footnotes.list)){for(r=t.env.footnotes.list,t.tokens.push({type:"footnote_block_open",level:h++}),e=0,i=r.length;e<i;e++){for(t.tokens.push({type:"footnote_open",id:e,level:h++}),r[e].tokens?((a=[]).push({type:"paragraph_open",tight:!1,level:h++}),a.push({type:"inline",content:"",level:h,children:r[e].tokens}),a.push({type:"paragraph_close",tight:!1,level:--h})):r[e].label&&(a=u[":"+r[e].label]),t.tokens=t.tokens.concat(a),o="paragraph_close"===t.tokens[t.tokens.length-1].type?t.tokens.pop():null,s=r[e].count>0?r[e].count:1,n=0;n<s;n++)t.tokens.push({type:"footnote_anchor",id:e,subId:n,level:h});o&&t.tokens.push(o),t.tokens.push({type:"footnote_close",level:--h})}t.tokens.push({type:"footnote_block_close",level:--h})}}Renderer.prototype.renderInline=function(t,e,i){for(var n=this.rules,s=t.length,o=0,r="";s--;)r+=n[t[o].type](t,o++,e,i,this);return r},Renderer.prototype.render=function(t,e,i){for(var n=this.rules,s=t.length,o=-1,r="";++o<s;)r+="inline"===t[o].type?this.renderInline(t[o].children,e,i):n[t[o].type](t,o,e,i,this);return r},Ruler.prototype.__find__=function(t){for(var e=this.__rules__.length,i=-1;e--;)if(this.__rules__[++i].name===t)return i;return-1},Ruler.prototype.__compile__=function(){var t=this,e=[""];t.__rules__.forEach((function(t){t.enabled&&t.alt.forEach((function(t){e.indexOf(t)<0&&e.push(t)}))})),t.__cache__={},e.forEach((function(e){t.__cache__[e]=[],t.__rules__.forEach((function(i){i.enabled&&(e&&i.alt.indexOf(e)<0||t.__cache__[e].push(i.fn))}))}))},Ruler.prototype.at=function(t,e,i){var n=this.__find__(t),s=i||{};if(-1===n)throw new Error("Parser rule not found: "+t);this.__rules__[n].fn=e,this.__rules__[n].alt=s.alt||[],this.__cache__=null},Ruler.prototype.before=function(t,e,i,n){var s=this.__find__(t),o=n||{};if(-1===s)throw new Error("Parser rule not found: "+t);this.__rules__.splice(s,0,{name:e,enabled:!0,fn:i,alt:o.alt||[]}),this.__cache__=null},Ruler.prototype.after=function(t,e,i,n){var s=this.__find__(t),o=n||{};if(-1===s)throw new Error("Parser rule not found: "+t);this.__rules__.splice(s+1,0,{name:e,enabled:!0,fn:i,alt:o.alt||[]}),this.__cache__=null},Ruler.prototype.push=function(t,e,i){this.__rules__.push({name:t,enabled:!0,fn:e,alt:(i||{}).alt||[]}),this.__cache__=null},Ruler.prototype.enable=function(t,e){t=Array.isArray(t)?t:[t],e&&this.__rules__.forEach((function(t){t.enabled=!1})),t.forEach((function(t){var e=this.__find__(t);if(e<0)throw new Error("Rules manager: invalid rule name "+t);this.__rules__[e].enabled=!0}),this),this.__cache__=null},Ruler.prototype.disable=function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){var e=this.__find__(t);if(e<0)throw new Error("Rules manager: invalid rule name "+t);this.__rules__[e].enabled=!1}),this),this.__cache__=null},Ruler.prototype.getRules=function(t){return null===this.__cache__&&this.__compile__(),this.__cache__[t]||[]},StateInline.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},StateInline.prototype.push=function(t){this.pending&&this.pushPending(),this.tokens.push(t),this.pendingLevel=this.level},StateInline.prototype.cacheSet=function(t,e){for(var i=this.cache.length;i<=t;i++)this.cache.push(0);this.cache[t]=e},StateInline.prototype.cacheGet=function(t){return t<this.cache.length?this.cache[t]:0};var PUNCT_CHARS=" \n()[]'\".,!?-";function regEscape(t){return t.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function abbr2(t){var e,i,n,s,o,r,a,l,c,h,d,u,m=t.tokens;if(t.env.abbreviations)for(t.env.abbrRegExp||(u="(^|["+PUNCT_CHARS.split("").map(regEscape).join("")+"])("+Object.keys(t.env.abbreviations).map((function(t){return t.substr(1)})).sort((function(t,e){return e.length-t.length})).map(regEscape).join("|")+")($|["+PUNCT_CHARS.split("").map(regEscape).join("")+"])",t.env.abbrRegExp=new RegExp(u,"g")),h=t.env.abbrRegExp,i=0,n=m.length;i<n;i++)if("inline"===m[i].type)for(e=(s=m[i].children).length-1;e>=0;e--)if("text"===(o=s[e]).type){for(l=0,r=o.content,h.lastIndex=0,c=o.level,a=[];d=h.exec(r);)h.lastIndex>l&&a.push({type:"text",content:r.slice(l,d.index+d[1].length),level:c}),a.push({type:"abbr_open",title:t.env.abbreviations[":"+d[2]],level:c++}),a.push({type:"text",content:d[2],level:c}),a.push({type:"abbr_close",level:--c}),l=h.lastIndex-d[3].length;a.length&&(l<r.length&&a.push({type:"text",content:r.slice(l),level:c}),m[i].children=s=[].concat(s.slice(0,e),a,s.slice(e+1)))}}var RARE_RE=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,SCOPED_ABBR_RE=/\((c|tm|r|p)\)/gi,SCOPED_ABBR={c:"",r:"",p:"",tm:""};function replaceScopedAbbr(t){return t.indexOf("(")<0?t:t.replace(SCOPED_ABBR_RE,(function(t,e){return SCOPED_ABBR[e.toLowerCase()]}))}function replace(t){var e,i,n,s,o;if(t.options.typographer)for(o=t.tokens.length-1;o>=0;o--)if("inline"===t.tokens[o].type)for(e=(s=t.tokens[o].children).length-1;e>=0;e--)"text"===(i=s[e]).type&&(n=replaceScopedAbbr(n=i.content),RARE_RE.test(n)&&(n=n.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1$2").replace(/(^|\s)--(\s|$)/gm,"$1$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1$2")),i.content=n)}var QUOTE_TEST_RE=/['"]/,QUOTE_RE=/['"]/g,PUNCT_RE=/[-\s()\[\]]/,APOSTROPHE="";function isLetter(t,e){return!(e<0||e>=t.length||PUNCT_RE.test(t[e]))}function replaceAt(t,e,i){return t.substr(0,e)+i+t.substr(e+1)}function smartquotes(t){var e,i,n,s,o,r,a,l,c,h,d,u,m,p,b,f,g;if(t.options.typographer)for(g=[],b=t.tokens.length-1;b>=0;b--)if("inline"===t.tokens[b].type)for(f=t.tokens[b].children,g.length=0,e=0;e<f.length;e++)if("text"===(i=f[e]).type&&!QUOTE_TEST_RE.test(i.text)){for(a=f[e].level,m=g.length-1;m>=0&&!(g[m].level<=a);m--);g.length=m+1,o=0,r=(n=i.content).length;t:for(;o<r&&(QUOTE_RE.lastIndex=o,s=QUOTE_RE.exec(n));)if(l=!isLetter(n,s.index-1),p="'"===s[0],(c=!isLetter(n,o=s.index+1))||l){if(d=!c,u=!l)for(m=g.length-1;m>=0&&(h=g[m],!(g[m].level<a));m--)if(h.single===p&&g[m].level===a){h=g[m],p?(f[h.token].content=replaceAt(f[h.token].content,h.pos,t.options.quotes[2]),i.content=replaceAt(i.content,s.index,t.options.quotes[3])):(f[h.token].content=replaceAt(f[h.token].content,h.pos,t.options.quotes[0]),i.content=replaceAt(i.content,s.index,t.options.quotes[1])),g.length=m;continue t}d?g.push({token:e,pos:s.index,single:p,level:a}):u&&p&&(i.content=replaceAt(i.content,s.index,APOSTROPHE))}else p&&(i.content=replaceAt(i.content,s.index,APOSTROPHE))}}var _rules=[["block",block],["abbr",abbr],["references",references],["inline",inline],["footnote_tail",footnote_block],["abbr2",abbr2],["replacements",replace],["smartquotes",smartquotes]];function Core(){this.options={},this.ruler=new Ruler;for(var t=0;t<_rules.length;t++)this.ruler.push(_rules[t][0],_rules[t][1])}function StateBlock(t,e,i,n,s){var o,r,a,l,c,h,d;for(this.src=t,this.parser=e,this.options=i,this.env=n,this.tokens=s,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",h=0,d=!1,a=l=h=0,c=(r=this.src).length;l<c;l++){if(o=r.charCodeAt(l),!d){if(32===o){h++;continue}d=!0}10!==o&&l!==c-1||(10!==o&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(h),d=!1,h=0,a=l+1)}this.bMarks.push(r.length),this.eMarks.push(r.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}function code(t,e,i){var n,s;if(t.tShift[e]-t.blkIndent<4)return!1;for(s=n=e+1;n<i;)if(t.isEmpty(n))n++;else{if(!(t.tShift[n]-t.blkIndent>=4))break;s=++n}return t.line=n,t.tokens.push({type:"code",content:t.getLines(e,s,4+t.blkIndent,!0),block:!0,lines:[e,t.line],level:t.level}),!0}function fences(t,e,i,n){var s,o,r,a,l,c=!1,h=t.bMarks[e]+t.tShift[e],d=t.eMarks[e];if(h+3>d)return!1;if(126!==(s=t.src.charCodeAt(h))&&96!==s)return!1;if(l=h,(o=(h=t.skipChars(h,s))-l)<3)return!1;if((r=t.src.slice(h,d).trim()).indexOf("`")>=0)return!1;if(n)return!0;for(a=e;!(++a>=i||(h=l=t.bMarks[a]+t.tShift[a])<(d=t.eMarks[a])&&t.tShift[a]<t.blkIndent);)if(t.src.charCodeAt(h)===s&&!(t.tShift[a]-t.blkIndent>=4||(h=t.skipChars(h,s))-l<o||(h=t.skipSpaces(h))<d)){c=!0;break}return o=t.tShift[e],t.line=a+(c?1:0),t.tokens.push({type:"fence",params:r,content:t.getLines(e+1,a,o,!0),lines:[e,t.line],level:t.level}),!0}function blockquote(t,e,i,n){var s,o,r,a,l,c,h,d,u,m,p,b=t.bMarks[e]+t.tShift[e],f=t.eMarks[e];if(b>f)return!1;if(62!==t.src.charCodeAt(b++))return!1;if(t.level>=t.options.maxNesting)return!1;if(n)return!0;for(32===t.src.charCodeAt(b)&&b++,l=t.blkIndent,t.blkIndent=0,a=[t.bMarks[e]],t.bMarks[e]=b,o=(b=b<f?t.skipSpaces(b):b)>=f,r=[t.tShift[e]],t.tShift[e]=b-t.bMarks[e],d=t.parser.ruler.getRules("blockquote"),s=e+1;s<i&&!((b=t.bMarks[s]+t.tShift[s])>=(f=t.eMarks[s]));s++)if(62!==t.src.charCodeAt(b++)){if(o)break;for(p=!1,u=0,m=d.length;u<m;u++)if(d[u](t,s,i,!0)){p=!0;break}if(p)break;a.push(t.bMarks[s]),r.push(t.tShift[s]),t.tShift[s]=-1337}else 32===t.src.charCodeAt(b)&&b++,a.push(t.bMarks[s]),t.bMarks[s]=b,o=(b=b<f?t.skipSpaces(b):b)>=f,r.push(t.tShift[s]),t.tShift[s]=b-t.bMarks[s];for(c=t.parentType,t.parentType="blockquote",t.tokens.push({type:"blockquote_open",lines:h=[e,0],level:t.level++}),t.parser.tokenize(t,e,s),t.tokens.push({type:"blockquote_close",level:--t.level}),t.parentType=c,h[1]=t.line,u=0;u<r.length;u++)t.bMarks[u+e]=a[u],t.tShift[u+e]=r[u];return t.blkIndent=l,!0}function hr(t,e,i,n){var s,o,r,a=t.bMarks[e],l=t.eMarks[e];if((a+=t.tShift[e])>l)return!1;if(42!==(s=t.src.charCodeAt(a++))&&45!==s&&95!==s)return!1;for(o=1;a<l;){if((r=t.src.charCodeAt(a++))!==s&&32!==r)return!1;r===s&&o++}return!(o<3||(n||(t.line=e+1,t.tokens.push({type:"hr",lines:[e,t.line],level:t.level})),0))}function skipBulletListMarker(t,e){var i,n,s;return(n=t.bMarks[e]+t.tShift[e])>=(s=t.eMarks[e])||42!==(i=t.src.charCodeAt(n++))&&45!==i&&43!==i||n<s&&32!==t.src.charCodeAt(n)?-1:n}function skipOrderedListMarker(t,e){var i,n=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(n+1>=s)return-1;if((i=t.src.charCodeAt(n++))<48||i>57)return-1;for(;;){if(n>=s)return-1;if(!((i=t.src.charCodeAt(n++))>=48&&i<=57)){if(41===i||46===i)break;return-1}}return n<s&&32!==t.src.charCodeAt(n)?-1:n}function markTightParagraphs(t,e){var i,n,s=t.level+2;for(i=e+2,n=t.tokens.length-2;i<n;i++)t.tokens[i].level===s&&"paragraph_open"===t.tokens[i].type&&(t.tokens[i+2].tight=!0,t.tokens[i].tight=!0,i+=2)}function list(t,e,i,n){var s,o,r,a,l,c,h,d,u,m,p,b,f,g,y,v,Z,x,G,X,w,V=!0;if((d=skipOrderedListMarker(t,e))>=0)b=!0;else{if(!((d=skipBulletListMarker(t,e))>=0))return!1;b=!1}if(t.level>=t.options.maxNesting)return!1;if(p=t.src.charCodeAt(d-1),n)return!0;for(g=t.tokens.length,b?(h=t.bMarks[e]+t.tShift[e],m=Number(t.src.substr(h,d-h-1)),t.tokens.push({type:"ordered_list_open",order:m,lines:v=[e,0],level:t.level++})):t.tokens.push({type:"bullet_list_open",lines:v=[e,0],level:t.level++}),s=e,y=!1,x=t.parser.ruler.getRules("list");!(!(s<i)||((u=(f=t.skipSpaces(d))>=t.eMarks[s]?1:f-d)>4&&(u=1),u<1&&(u=1),o=d-t.bMarks[s]+u,t.tokens.push({type:"list_item_open",lines:Z=[e,0],level:t.level++}),a=t.blkIndent,l=t.tight,r=t.tShift[e],c=t.parentType,t.tShift[e]=f-t.bMarks[e],t.blkIndent=o,t.tight=!0,t.parentType="list",t.parser.tokenize(t,e,i,!0),t.tight&&!y||(V=!1),y=t.line-e>1&&t.isEmpty(t.line-1),t.blkIndent=a,t.tShift[e]=r,t.tight=l,t.parentType=c,t.tokens.push({type:"list_item_close",level:--t.level}),s=e=t.line,Z[1]=s,f=t.bMarks[e],s>=i)||t.isEmpty(s)||t.tShift[s]<t.blkIndent);){for(w=!1,G=0,X=x.length;G<X;G++)if(x[G](t,s,i,!0)){w=!0;break}if(w)break;if(b){if((d=skipOrderedListMarker(t,s))<0)break}else if((d=skipBulletListMarker(t,s))<0)break;if(p!==t.src.charCodeAt(d-1))break}return t.tokens.push({type:b?"ordered_list_close":"bullet_list_close",level:--t.level}),v[1]=s,t.line=s,V&&markTightParagraphs(t,g),!0}function footnote(t,e,i,n){var s,o,r,a,l,c=t.bMarks[e]+t.tShift[e],h=t.eMarks[e];if(c+4>h)return!1;if(91!==t.src.charCodeAt(c))return!1;if(94!==t.src.charCodeAt(c+1))return!1;if(t.level>=t.options.maxNesting)return!1;for(a=c+2;a<h;a++){if(32===t.src.charCodeAt(a))return!1;if(93===t.src.charCodeAt(a))break}return!(a===c+2||a+1>=h||58!==t.src.charCodeAt(++a)||(n||(a++,t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.refs||(t.env.footnotes.refs={}),l=t.src.slice(c+2,a-2),t.env.footnotes.refs[":"+l]=-1,t.tokens.push({type:"footnote_reference_open",label:l,level:t.level++}),s=t.bMarks[e],o=t.tShift[e],r=t.parentType,t.tShift[e]=t.skipSpaces(a)-a,t.bMarks[e]=a,t.blkIndent+=4,t.parentType="footnote",t.tShift[e]<t.blkIndent&&(t.tShift[e]+=t.blkIndent,t.bMarks[e]-=t.blkIndent),t.parser.tokenize(t,e,i,!0),t.parentType=r,t.blkIndent-=4,t.tShift[e]=o,t.bMarks[e]=s,t.tokens.push({type:"footnote_reference_close",level:--t.level})),0))}function heading(t,e,i,n){var s,o,r,a=t.bMarks[e]+t.tShift[e],l=t.eMarks[e];if(a>=l)return!1;if(35!==(s=t.src.charCodeAt(a))||a>=l)return!1;for(o=1,s=t.src.charCodeAt(++a);35===s&&a<l&&o<=6;)o++,s=t.src.charCodeAt(++a);return!(o>6||a<l&&32!==s||(n||(l=t.skipCharsBack(l,32,a),(r=t.skipCharsBack(l,35,a))>a&&32===t.src.charCodeAt(r-1)&&(l=r),t.line=e+1,t.tokens.push({type:"heading_open",hLevel:o,lines:[e,t.line],level:t.level}),a<l&&t.tokens.push({type:"inline",content:t.src.slice(a,l).trim(),level:t.level+1,lines:[e,t.line],children:[]}),t.tokens.push({type:"heading_close",hLevel:o,level:t.level})),0))}function lheading(t,e,i){var n,s,o,r=e+1;return!(r>=i||t.tShift[r]<t.blkIndent||t.tShift[r]-t.blkIndent>3||(s=t.bMarks[r]+t.tShift[r])>=(o=t.eMarks[r])||45!==(n=t.src.charCodeAt(s))&&61!==n||(s=t.skipChars(s,n),(s=t.skipSpaces(s))<o||(s=t.bMarks[e]+t.tShift[e],t.line=r+1,t.tokens.push({type:"heading_open",hLevel:61===n?1:2,lines:[e,t.line],level:t.level}),t.tokens.push({type:"inline",content:t.src.slice(s,t.eMarks[e]).trim(),level:t.level+1,lines:[e,t.line-1],children:[]}),t.tokens.push({type:"heading_close",hLevel:61===n?1:2,level:t.level}),0)))}Core.prototype.process=function(t){var e,i,n;for(e=0,i=(n=this.ruler.getRules("")).length;e<i;e++)n[e](t)},StateBlock.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]},StateBlock.prototype.skipEmptyLines=function(t){for(var e=this.lineMax;t<e&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t},StateBlock.prototype.skipSpaces=function(t){for(var e=this.src.length;t<e&&32===this.src.charCodeAt(t);t++);return t},StateBlock.prototype.skipChars=function(t,e){for(var i=this.src.length;t<i&&this.src.charCodeAt(t)===e;t++);return t},StateBlock.prototype.skipCharsBack=function(t,e,i){if(t<=i)return t;for(;t>i;)if(e!==this.src.charCodeAt(--t))return t+1;return t},StateBlock.prototype.getLines=function(t,e,i,n){var s,o,r,a,l=t;if(t>=e)return"";if(l+1===e)return o=this.bMarks[l]+Math.min(this.tShift[l],i),this.src.slice(o,n?this.eMarks[l]+1:this.eMarks[l]);for(r=new Array(e-t),s=0;l<e;l++,s++)(a=this.tShift[l])>i&&(a=i),a<0&&(a=0),r[s]=this.src.slice(o=this.bMarks[l]+a,l+1<e||n?this.eMarks[l]+1:this.eMarks[l]);return r.join("")};var html_blocks={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach((function(t){html_blocks[t]=!0}));var HTML_TAG_OPEN_RE=/^<([a-zA-Z]{1,15})[\s\/>]/,HTML_TAG_CLOSE_RE=/^<\/([a-zA-Z]{1,15})[\s>]/;function isLetter$1(t){var e=32|t;return e>=97&&e<=122}function htmlblock(t,e,i,n){var s,o,r,a=t.bMarks[e],l=t.eMarks[e],c=t.tShift[e];if(a+=c,!t.options.html)return!1;if(c>3||a+2>=l)return!1;if(60!==t.src.charCodeAt(a))return!1;if(33===(s=t.src.charCodeAt(a+1))||63===s){if(n)return!0}else{if(47!==s&&!isLetter$1(s))return!1;if(47===s){if(!(o=t.src.slice(a,l).match(HTML_TAG_CLOSE_RE)))return!1}else if(!(o=t.src.slice(a,l).match(HTML_TAG_OPEN_RE)))return!1;if(!0!==html_blocks[o[1].toLowerCase()])return!1;if(n)return!0}for(r=e+1;r<t.lineMax&&!t.isEmpty(r);)r++;return t.line=r,t.tokens.push({type:"htmlblock",level:t.level,lines:[e,t.line],content:t.getLines(e,r,0,!0)}),!0}function getLine(t,e){var i=t.bMarks[e]+t.blkIndent;return t.src.substr(i,t.eMarks[e]-i)}function table(t,e,i,n){var s,o,r,a,l,c,h,d,u,m,p;if(e+2>i)return!1;if(t.tShift[l=e+1]<t.blkIndent)return!1;if((r=t.bMarks[l]+t.tShift[l])>=t.eMarks[l])return!1;if(124!==(s=t.src.charCodeAt(r))&&45!==s&&58!==s)return!1;if(o=getLine(t,e+1),!/^[-:| ]+$/.test(o))return!1;if((c=o.split("|"))<=2)return!1;for(d=[],a=0;a<c.length;a++){if(!(u=c[a].trim())){if(0===a||a===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(u))return!1;58===u.charCodeAt(u.length-1)?d.push(58===u.charCodeAt(0)?"center":"right"):58===u.charCodeAt(0)?d.push("left"):d.push("")}if(-1===(o=getLine(t,e).trim()).indexOf("|"))return!1;if(c=o.replace(/^\||\|$/g,"").split("|"),d.length!==c.length)return!1;if(n)return!0;for(t.tokens.push({type:"table_open",lines:m=[e,0],level:t.level++}),t.tokens.push({type:"thead_open",lines:[e,e+1],level:t.level++}),t.tokens.push({type:"tr_open",lines:[e,e+1],level:t.level++}),a=0;a<c.length;a++)t.tokens.push({type:"th_open",align:d[a],lines:[e,e+1],level:t.level++}),t.tokens.push({type:"inline",content:c[a].trim(),lines:[e,e+1],level:t.level,children:[]}),t.tokens.push({type:"th_close",level:--t.level});for(t.tokens.push({type:"tr_close",level:--t.level}),t.tokens.push({type:"thead_close",level:--t.level}),t.tokens.push({type:"tbody_open",lines:p=[e+2,0],level:t.level++}),l=e+2;l<i&&!(t.tShift[l]<t.blkIndent)&&-1!==(o=getLine(t,l).trim()).indexOf("|");l++){for(c=o.replace(/^\||\|$/g,"").split("|"),t.tokens.push({type:"tr_open",level:t.level++}),a=0;a<c.length;a++)t.tokens.push({type:"td_open",align:d[a],level:t.level++}),h=c[a].substring(124===c[a].charCodeAt(0)?1:0,124===c[a].charCodeAt(c[a].length-1)?c[a].length-1:c[a].length).trim(),t.tokens.push({type:"inline",content:h,level:t.level,children:[]}),t.tokens.push({type:"td_close",level:--t.level});t.tokens.push({type:"tr_close",level:--t.level})}return t.tokens.push({type:"tbody_close",level:--t.level}),t.tokens.push({type:"table_close",level:--t.level}),m[1]=p[1]=l,t.line=l,!0}function skipMarker(t,e){var i,n,s=t.bMarks[e]+t.tShift[e],o=t.eMarks[e];return s>=o||126!==(n=t.src.charCodeAt(s++))&&58!==n||s===(i=t.skipSpaces(s))||i>=o?-1:i}function markTightParagraphs$1(t,e){var i,n,s=t.level+2;for(i=e+2,n=t.tokens.length-2;i<n;i++)t.tokens[i].level===s&&"paragraph_open"===t.tokens[i].type&&(t.tokens[i+2].tight=!0,t.tokens[i].tight=!0,i+=2)}function deflist(t,e,i,n){var s,o,r,a,l,c,h,d,u,m,p,b,f,g;if(n)return!(t.ddIndent<0)&&skipMarker(t,e)>=0;if(t.isEmpty(h=e+1)&&++h>i)return!1;if(t.tShift[h]<t.blkIndent)return!1;if((s=skipMarker(t,h))<0)return!1;if(t.level>=t.options.maxNesting)return!1;c=t.tokens.length,t.tokens.push({type:"dl_open",lines:l=[e,0],level:t.level++}),r=e,o=h;t:for(;;){for(g=!0,f=!1,t.tokens.push({type:"dt_open",lines:[r,r],level:t.level++}),t.tokens.push({type:"inline",content:t.getLines(r,r+1,t.blkIndent,!1).trim(),level:t.level+1,lines:[r,r],children:[]}),t.tokens.push({type:"dt_close",level:--t.level});;){if(t.tokens.push({type:"dd_open",lines:a=[h,0],level:t.level++}),b=t.tight,u=t.ddIndent,d=t.blkIndent,p=t.tShift[o],m=t.parentType,t.blkIndent=t.ddIndent=t.tShift[o]+2,t.tShift[o]=s-t.bMarks[o],t.tight=!0,t.parentType="deflist",t.parser.tokenize(t,o,i,!0),t.tight&&!f||(g=!1),f=t.line-o>1&&t.isEmpty(t.line-1),t.tShift[o]=p,t.tight=b,t.parentType=m,t.blkIndent=d,t.ddIndent=u,t.tokens.push({type:"dd_close",level:--t.level}),a[1]=h=t.line,h>=i)break t;if(t.tShift[h]<t.blkIndent)break t;if((s=skipMarker(t,h))<0)break;o=h}if(h>=i)break;if(t.isEmpty(r=h))break;if(t.tShift[r]<t.blkIndent)break;if((o=r+1)>=i)break;if(t.isEmpty(o)&&o++,o>=i)break;if(t.tShift[o]<t.blkIndent)break;if((s=skipMarker(t,o))<0)break}return t.tokens.push({type:"dl_close",level:--t.level}),l[1]=h,t.line=h,g&&markTightParagraphs$1(t,c),!0}function paragraph(t,e){var i,n,s,o,r,a,l=e+1;if(l<(i=t.lineMax)&&!t.isEmpty(l))for(a=t.parser.ruler.getRules("paragraph");l<i&&!t.isEmpty(l);l++)if(!(t.tShift[l]-t.blkIndent>3)){for(s=!1,o=0,r=a.length;o<r;o++)if(a[o](t,l,i,!0)){s=!0;break}if(s)break}return n=t.getLines(e,l,t.blkIndent,!1).trim(),t.line=l,n.length&&(t.tokens.push({type:"paragraph_open",tight:!1,lines:[e,t.line],level:t.level}),t.tokens.push({type:"inline",content:n,level:t.level+1,lines:[e,t.line],children:[]}),t.tokens.push({type:"paragraph_close",tight:!1,level:t.level})),!0}var _rules$1=[["code",code],["fences",fences,["paragraph","blockquote","list"]],["blockquote",blockquote,["paragraph","blockquote","list"]],["hr",hr,["paragraph","blockquote","list"]],["list",list,["paragraph","blockquote"]],["footnote",footnote,["paragraph"]],["heading",heading,["paragraph","blockquote"]],["lheading",lheading],["htmlblock",htmlblock,["paragraph","blockquote"]],["table",table,["paragraph"]],["deflist",deflist,["paragraph"]],["paragraph",paragraph]];function ParserBlock(){this.ruler=new Ruler;for(var t=0;t<_rules$1.length;t++)this.ruler.push(_rules$1[t][0],_rules$1[t][1],{alt:(_rules$1[t][2]||[]).slice()})}ParserBlock.prototype.tokenize=function(t,e,i){for(var n,s=this.ruler.getRules(""),o=s.length,r=e,a=!1;r<i&&(t.line=r=t.skipEmptyLines(r),!(r>=i))&&!(t.tShift[r]<t.blkIndent);){for(n=0;n<o&&!s[n](t,r,i,!1);n++);if(t.tight=!a,t.isEmpty(t.line-1)&&(a=!0),(r=t.line)<i&&t.isEmpty(r)){if(a=!0,++r<i&&"list"===t.parentType&&t.isEmpty(r))break;t.line=r}}};var TABS_SCAN_RE=/[\n\t]/g,NEWLINES_RE=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,SPACES_RE=/\u00a0/g;function isTerminatorChar(t){switch(t){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}function text(t,e){for(var i=t.pos;i<t.posMax&&!isTerminatorChar(t.src.charCodeAt(i));)i++;return i!==t.pos&&(e||(t.pending+=t.src.slice(t.pos,i)),t.pos=i,!0)}function newline(t,e){var i,n,s=t.pos;if(10!==t.src.charCodeAt(s))return!1;if(i=t.pending.length-1,n=t.posMax,!e)if(i>=0&&32===t.pending.charCodeAt(i))if(i>=1&&32===t.pending.charCodeAt(i-1)){for(var o=i-2;o>=0;o--)if(32!==t.pending.charCodeAt(o)){t.pending=t.pending.substring(0,o+1);break}t.push({type:"hardbreak",level:t.level})}else t.pending=t.pending.slice(0,-1),t.push({type:"softbreak",level:t.level});else t.push({type:"softbreak",level:t.level});for(s++;s<n&&32===t.src.charCodeAt(s);)s++;return t.pos=s,!0}ParserBlock.prototype.parse=function(t,e,i,n){var s,o=0,r=0;if(!t)return[];(t=(t=t.replace(SPACES_RE," ")).replace(NEWLINES_RE,"\n")).indexOf("\t")>=0&&(t=t.replace(TABS_SCAN_RE,(function(e,i){var n;return 10===t.charCodeAt(i)?(o=i+1,r=0,e):(n="    ".slice((i-o-r)%4),r=i-o+1,n)}))),s=new StateBlock(t,this,e,i,n),this.tokenize(s,s.line,s.lineMax)};for(var ESCAPED=[],i$4=0;i$4<256;i$4++)ESCAPED.push(0);function escape(t,e){var i,n=t.pos,s=t.posMax;if(92!==t.src.charCodeAt(n))return!1;if(++n<s){if((i=t.src.charCodeAt(n))<256&&0!==ESCAPED[i])return e||(t.pending+=t.src[n]),t.pos+=2,!0;if(10===i){for(e||t.push({type:"hardbreak",level:t.level}),n++;n<s&&32===t.src.charCodeAt(n);)n++;return t.pos=n,!0}}return e||(t.pending+="\\"),t.pos++,!0}function backticks(t,e){var i,n,s,o,r,a=t.pos;if(96!==t.src.charCodeAt(a))return!1;for(i=a,a++,n=t.posMax;a<n&&96===t.src.charCodeAt(a);)a++;for(s=t.src.slice(i,a),o=r=a;-1!==(o=t.src.indexOf("`",r));){for(r=o+1;r<n&&96===t.src.charCodeAt(r);)r++;if(r-o===s.length)return e||t.push({type:"code",content:t.src.slice(a,o).replace(/[ \n]+/g," ").trim(),block:!1,level:t.level}),t.pos=r,!0}return e||(t.pending+=s),t.pos+=s.length,!0}function del(t,e){var i,n,s,o,r,a=t.posMax,l=t.pos;if(126!==t.src.charCodeAt(l))return!1;if(e)return!1;if(l+4>=a)return!1;if(126!==t.src.charCodeAt(l+1))return!1;if(t.level>=t.options.maxNesting)return!1;if(o=l>0?t.src.charCodeAt(l-1):-1,r=t.src.charCodeAt(l+2),126===o)return!1;if(126===r)return!1;if(32===r||10===r)return!1;for(n=l+2;n<a&&126===t.src.charCodeAt(n);)n++;if(n>l+3)return t.pos+=n-l,e||(t.pending+=t.src.slice(l,n)),!0;for(t.pos=l+2,s=1;t.pos+1<a;){if(126===t.src.charCodeAt(t.pos)&&126===t.src.charCodeAt(t.pos+1)&&(o=t.src.charCodeAt(t.pos-1),126!==(r=t.pos+2<a?t.src.charCodeAt(t.pos+2):-1)&&126!==o&&(32!==o&&10!==o?s--:32!==r&&10!==r&&s++,s<=0))){i=!0;break}t.parser.skipToken(t)}return i?(t.posMax=t.pos,t.pos=l+2,e||(t.push({type:"del_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"del_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=a,!0):(t.pos=l,!1)}function ins(t,e){var i,n,s,o,r,a=t.posMax,l=t.pos;if(43!==t.src.charCodeAt(l))return!1;if(e)return!1;if(l+4>=a)return!1;if(43!==t.src.charCodeAt(l+1))return!1;if(t.level>=t.options.maxNesting)return!1;if(o=l>0?t.src.charCodeAt(l-1):-1,r=t.src.charCodeAt(l+2),43===o)return!1;if(43===r)return!1;if(32===r||10===r)return!1;for(n=l+2;n<a&&43===t.src.charCodeAt(n);)n++;if(n!==l+2)return t.pos+=n-l,e||(t.pending+=t.src.slice(l,n)),!0;for(t.pos=l+2,s=1;t.pos+1<a;){if(43===t.src.charCodeAt(t.pos)&&43===t.src.charCodeAt(t.pos+1)&&(o=t.src.charCodeAt(t.pos-1),43!==(r=t.pos+2<a?t.src.charCodeAt(t.pos+2):-1)&&43!==o&&(32!==o&&10!==o?s--:32!==r&&10!==r&&s++,s<=0))){i=!0;break}t.parser.skipToken(t)}return i?(t.posMax=t.pos,t.pos=l+2,e||(t.push({type:"ins_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"ins_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=a,!0):(t.pos=l,!1)}function mark$1(t,e){var i,n,s,o,r,a=t.posMax,l=t.pos;if(61!==t.src.charCodeAt(l))return!1;if(e)return!1;if(l+4>=a)return!1;if(61!==t.src.charCodeAt(l+1))return!1;if(t.level>=t.options.maxNesting)return!1;if(o=l>0?t.src.charCodeAt(l-1):-1,r=t.src.charCodeAt(l+2),61===o)return!1;if(61===r)return!1;if(32===r||10===r)return!1;for(n=l+2;n<a&&61===t.src.charCodeAt(n);)n++;if(n!==l+2)return t.pos+=n-l,e||(t.pending+=t.src.slice(l,n)),!0;for(t.pos=l+2,s=1;t.pos+1<a;){if(61===t.src.charCodeAt(t.pos)&&61===t.src.charCodeAt(t.pos+1)&&(o=t.src.charCodeAt(t.pos-1),61!==(r=t.pos+2<a?t.src.charCodeAt(t.pos+2):-1)&&61!==o&&(32!==o&&10!==o?s--:32!==r&&10!==r&&s++,s<=0))){i=!0;break}t.parser.skipToken(t)}return i?(t.posMax=t.pos,t.pos=l+2,e||(t.push({type:"mark_open",level:t.level++}),t.parser.tokenize(t),t.push({type:"mark_close",level:--t.level})),t.pos=t.posMax+2,t.posMax=a,!0):(t.pos=l,!1)}function isAlphaNum(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122}function scanDelims(t,e){var i,n,s,o=e,r=!0,a=!0,l=t.posMax,c=t.src.charCodeAt(e);for(i=e>0?t.src.charCodeAt(e-1):-1;o<l&&t.src.charCodeAt(o)===c;)o++;return o>=l&&(r=!1),(s=o-e)>=4?r=a=!1:(32!==(n=o<l?t.src.charCodeAt(o):-1)&&10!==n||(r=!1),32!==i&&10!==i||(a=!1),95===c&&(isAlphaNum(i)&&(r=!1),isAlphaNum(n)&&(a=!1))),{can_open:r,can_close:a,delims:s}}function emphasis(t,e){var i,n,s,o,r,a,l,c=t.posMax,h=t.pos,d=t.src.charCodeAt(h);if(95!==d&&42!==d)return!1;if(e)return!1;if(i=(l=scanDelims(t,h)).delims,!l.can_open)return t.pos+=i,e||(t.pending+=t.src.slice(h,t.pos)),!0;if(t.level>=t.options.maxNesting)return!1;for(t.pos=h+i,a=[i];t.pos<c;)if(t.src.charCodeAt(t.pos)!==d)t.parser.skipToken(t);else{if(n=(l=scanDelims(t,t.pos)).delims,l.can_close){for(o=a.pop(),r=n;o!==r;){if(r<o){a.push(o-r);break}if(r-=o,0===a.length)break;t.pos+=o,o=a.pop()}if(0===a.length){i=o,s=!0;break}t.pos+=n;continue}l.can_open&&a.push(n),t.pos+=n}return s?(t.posMax=t.pos,t.pos=h+i,e||(2!==i&&3!==i||t.push({type:"strong_open",level:t.level++}),1!==i&&3!==i||t.push({type:"em_open",level:t.level++}),t.parser.tokenize(t),1!==i&&3!==i||t.push({type:"em_close",level:--t.level}),2!==i&&3!==i||t.push({type:"strong_close",level:--t.level})),t.pos=t.posMax+i,t.posMax=c,!0):(t.pos=h,!1)}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(t){ESCAPED[t.charCodeAt(0)]=1}));var UNESCAPE_RE=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function sub(t,e){var i,n,s=t.posMax,o=t.pos;if(126!==t.src.charCodeAt(o))return!1;if(e)return!1;if(o+2>=s)return!1;if(t.level>=t.options.maxNesting)return!1;for(t.pos=o+1;t.pos<s;){if(126===t.src.charCodeAt(t.pos)){i=!0;break}t.parser.skipToken(t)}return i&&o+1!==t.pos?(n=t.src.slice(o+1,t.pos)).match(/(^|[^\\])(\\\\)*\s/)?(t.pos=o,!1):(t.posMax=t.pos,t.pos=o+1,e||t.push({type:"sub",level:t.level,content:n.replace(UNESCAPE_RE,"$1")}),t.pos=t.posMax+1,t.posMax=s,!0):(t.pos=o,!1)}var UNESCAPE_RE$1=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function sup(t,e){var i,n,s=t.posMax,o=t.pos;if(94!==t.src.charCodeAt(o))return!1;if(e)return!1;if(o+2>=s)return!1;if(t.level>=t.options.maxNesting)return!1;for(t.pos=o+1;t.pos<s;){if(94===t.src.charCodeAt(t.pos)){i=!0;break}t.parser.skipToken(t)}return i&&o+1!==t.pos?(n=t.src.slice(o+1,t.pos)).match(/(^|[^\\])(\\\\)*\s/)?(t.pos=o,!1):(t.posMax=t.pos,t.pos=o+1,e||t.push({type:"sup",level:t.level,content:n.replace(UNESCAPE_RE$1,"$1")}),t.pos=t.posMax+1,t.posMax=s,!0):(t.pos=o,!1)}function links(t,e){var i,n,s,o,r,a,l,c,h=!1,d=t.pos,u=t.posMax,m=t.pos,p=t.src.charCodeAt(m);if(33===p&&(h=!0,p=t.src.charCodeAt(++m)),91!==p)return!1;if(t.level>=t.options.maxNesting)return!1;if(i=m+1,(n=parseLinkLabel(t,m))<0)return!1;if((a=n+1)<u&&40===t.src.charCodeAt(a)){for(a++;a<u&&(32===(c=t.src.charCodeAt(a))||10===c);a++);if(a>=u)return!1;for(m=a,parseLinkDestination(t,a)?(o=t.linkContent,a=t.pos):o="",m=a;a<u&&(32===(c=t.src.charCodeAt(a))||10===c);a++);if(a<u&&m!==a&&parseLinkTitle(t,a))for(r=t.linkContent,a=t.pos;a<u&&(32===(c=t.src.charCodeAt(a))||10===c);a++);else r="";if(a>=u||41!==t.src.charCodeAt(a))return t.pos=d,!1;a++}else{if(t.linkLevel>0)return!1;for(;a<u&&(32===(c=t.src.charCodeAt(a))||10===c);a++);if(a<u&&91===t.src.charCodeAt(a)&&(m=a+1,(a=parseLinkLabel(t,a))>=0?s=t.src.slice(m,a++):a=m-1),s||(void 0===s&&(a=n+1),s=t.src.slice(i,n)),!(l=t.env.references[normalizeReference(s)]))return t.pos=d,!1;o=l.href,r=l.title}return e||(t.pos=i,t.posMax=n,h?t.push({type:"image",src:o,title:r,alt:t.src.substr(i,n-i),level:t.level}):(t.push({type:"link_open",href:o,title:r,level:t.level++}),t.linkLevel++,t.parser.tokenize(t),t.linkLevel--,t.push({type:"link_close",level:--t.level}))),t.pos=a,t.posMax=u,!0}function footnote_inline(t,e){var i,n,s,o,r=t.posMax,a=t.pos;return!(a+2>=r||94!==t.src.charCodeAt(a)||91!==t.src.charCodeAt(a+1)||t.level>=t.options.maxNesting||(i=a+2,(n=parseLinkLabel(t,a+1))<0||(e||(t.env.footnotes||(t.env.footnotes={}),t.env.footnotes.list||(t.env.footnotes.list=[]),s=t.env.footnotes.list.length,t.pos=i,t.posMax=n,t.push({type:"footnote_ref",id:s,level:t.level}),t.linkLevel++,o=t.tokens.length,t.parser.tokenize(t),t.env.footnotes.list[s]={tokens:t.tokens.splice(o)},t.linkLevel--),t.pos=n+1,t.posMax=r,0)))}function footnote_ref(t,e){var i,n,s,o,r=t.posMax,a=t.pos;if(a+3>r)return!1;if(!t.env.footnotes||!t.env.footnotes.refs)return!1;if(91!==t.src.charCodeAt(a))return!1;if(94!==t.src.charCodeAt(a+1))return!1;if(t.level>=t.options.maxNesting)return!1;for(n=a+2;n<r;n++){if(32===t.src.charCodeAt(n))return!1;if(10===t.src.charCodeAt(n))return!1;if(93===t.src.charCodeAt(n))break}return!(n===a+2||n>=r||(n++,i=t.src.slice(a+2,n-1),void 0===t.env.footnotes.refs[":"+i]||(e||(t.env.footnotes.list||(t.env.footnotes.list=[]),t.env.footnotes.refs[":"+i]<0?(t.env.footnotes.list[s=t.env.footnotes.list.length]={label:i,count:0},t.env.footnotes.refs[":"+i]=s):s=t.env.footnotes.refs[":"+i],o=t.env.footnotes.list[s].count,t.env.footnotes.list[s].count++,t.push({type:"footnote_ref",id:s,subId:o,level:t.level})),t.pos=n,t.posMax=r,0)))}var url_schemas=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],EMAIL_RE=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,AUTOLINK_RE=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function autolink(t,e){var i,n,s,o,r,a=t.pos;return!(60!==t.src.charCodeAt(a)||(i=t.src.slice(a)).indexOf(">")<0||((n=i.match(AUTOLINK_RE))?url_schemas.indexOf(n[1].toLowerCase())<0||(r=normalizeLink(o=n[0].slice(1,-1)),!t.parser.validateLink(o)||(e||(t.push({type:"link_open",href:r,level:t.level}),t.push({type:"text",content:o,level:t.level+1}),t.push({type:"link_close",level:t.level})),t.pos+=n[0].length,0)):!(s=i.match(EMAIL_RE))||(r=normalizeLink("mailto:"+(o=s[0].slice(1,-1))),!t.parser.validateLink(r)||(e||(t.push({type:"link_open",href:r,level:t.level}),t.push({type:"text",content:o,level:t.level+1}),t.push({type:"link_close",level:t.level})),t.pos+=s[0].length,0))))}function replace$1(t,e){return t=t.source,e=e||"",function i(n,s){return n?(t=t.replace(n,s=s.source||s),i):new RegExp(t,e)}}var attr_name=/[a-zA-Z_:][a-zA-Z0-9:._-]*/,unquoted=/[^"'=<>`\x00-\x20]+/,single_quoted=/'[^']*'/,double_quoted=/"[^"]*"/,attr_value=replace$1(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",unquoted)("single_quoted",single_quoted)("double_quoted",double_quoted)(),attribute=replace$1(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",attr_name)("attr_value",attr_value)(),open_tag=replace$1(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",attribute)(),close_tag=/<\/[A-Za-z][A-Za-z0-9]*\s*>/,comment=/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/,processing=/<[?].*?[?]>/,declaration=/<![A-Z]+\s+[^>]*>/,cdata=/<!\[CDATA\[[\s\S]*?\]\]>/,HTML_TAG_RE=replace$1(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",open_tag)("close_tag",close_tag)("comment",comment)("processing",processing)("declaration",declaration)("cdata",cdata)();function isLetter$2(t){var e=32|t;return e>=97&&e<=122}function htmltag(t,e){var i,n,s,o=t.pos;return!(!t.options.html||(s=t.posMax,60!==t.src.charCodeAt(o)||o+2>=s||33!==(i=t.src.charCodeAt(o+1))&&63!==i&&47!==i&&!isLetter$2(i)||!(n=t.src.slice(o).match(HTML_TAG_RE))||(e||t.push({type:"htmltag",content:t.src.slice(o,o+n[0].length),level:t.level}),t.pos+=n[0].length,0)))}var DIGITAL_RE=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,NAMED_RE=/^&([a-z][a-z0-9]{1,31});/i;function entity(t,e){var i,n,s=t.pos,o=t.posMax;if(38!==t.src.charCodeAt(s))return!1;if(s+1<o)if(35===t.src.charCodeAt(s+1)){if(n=t.src.slice(s).match(DIGITAL_RE))return e||(i="x"===n[1][0].toLowerCase()?parseInt(n[1].slice(1),16):parseInt(n[1],10),t.pending+=isValidEntityCode(i)?fromCodePoint(i):fromCodePoint(65533)),t.pos+=n[0].length,!0}else if(n=t.src.slice(s).match(NAMED_RE)){var r=decodeEntity(n[1]);if(n[1]!==r)return e||(t.pending+=r),t.pos+=n[0].length,!0}return e||(t.pending+="&"),t.pos++,!0}var _rules$2=[["text",text],["newline",newline],["escape",escape],["backticks",backticks],["del",del],["ins",ins],["mark",mark$1],["emphasis",emphasis],["sub",sub],["sup",sup],["links",links],["footnote_inline",footnote_inline],["footnote_ref",footnote_ref],["autolink",autolink],["htmltag",htmltag],["entity",entity]];function ParserInline(){this.ruler=new Ruler;for(var t=0;t<_rules$2.length;t++)this.ruler.push(_rules$2[t][0],_rules$2[t][1]);this.validateLink=validateLink}function validateLink(t){var e=t.trim().toLowerCase();return-1===(e=replaceEntities(e)).indexOf(":")||-1===["vbscript","javascript","file","data"].indexOf(e.split(":")[0])}ParserInline.prototype.skipToken=function(t){var e,i,n=this.ruler.getRules(""),s=n.length,o=t.pos;if((i=t.cacheGet(o))>0)t.pos=i;else{for(e=0;e<s;e++)if(n[e](t,!0))return void t.cacheSet(o,t.pos);t.pos++,t.cacheSet(o,t.pos)}},ParserInline.prototype.tokenize=function(t){for(var e,i,n=this.ruler.getRules(""),s=n.length,o=t.posMax;t.pos<o;){for(i=0;i<s&&!(e=n[i](t,!1));i++);if(e){if(t.pos>=o)break}else t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()},ParserInline.prototype.parse=function(t,e,i,n){var s=new StateInline(t,this,e,i,n);this.tokenize(s)};var defaultConfig={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},fullConfig={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},commonmarkConfig={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}},config$1={default:defaultConfig,full:fullConfig,commonmark:commonmarkConfig};function StateCore(t,e,i){this.src=e,this.env=i,this.options=t.options,this.tokens=[],this.inlineMode=!1,this.inline=t.inline,this.block=t.block,this.renderer=t.renderer,this.typographer=t.typographer}function Remarkable(t,e){"string"!=typeof t&&(e=t,t="default"),e&&null!=e.linkify&&console.warn("linkify option is removed. Use linkify plugin instead:\n\nimport Remarkable from 'remarkable';\nimport linkify from 'remarkable/linkify';\nnew Remarkable().use(linkify)\n"),this.inline=new ParserInline,this.block=new ParserBlock,this.core=new Core,this.renderer=new Renderer,this.ruler=new Ruler,this.options={},this.configure(config$1[t]),this.set(e||{})}Remarkable.prototype.set=function(t){assign$2(this.options,t)},Remarkable.prototype.configure=function(t){var e=this;if(!t)throw new Error("Wrong `remarkable` preset, check name/content");t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach((function(i){t.components[i].rules&&e[i].ruler.enable(t.components[i].rules,!0)}))},Remarkable.prototype.use=function(t,e){return t(this,e),this},Remarkable.prototype.parse=function(t,e){var i=new StateCore(this,t,e);return this.core.process(i),i.tokens},Remarkable.prototype.render=function(t,e){return this.renderer.render(this.parse(t,e=e||{}),this.options,e)},Remarkable.prototype.parseInline=function(t,e){var i=new StateCore(this,t,e);return i.inlineMode=!0,this.core.process(i),i.tokens},Remarkable.prototype.renderInline=function(t,e){return this.renderer.render(this.parseInline(t,e=e||{}),this.options,e)};const zeaMarkdownViewerCss=":host{display:block;color:var(--color-foreground-1)}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}a{color:var(--color-primary-1)}",ZeaMarkdownViewer=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}convertMdToHtml(){return(new Remarkable).render(this.mdText)}render(){const t=this.convertMdToHtml();return h("div",{innerHTML:t})}static get style(){return zeaMarkdownViewerCss}},zeaMenuCss="*{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host{display:inline-block;vertical-align:middle}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-menu{color:var(--color-foreground-1);-ms-flex-direction:column;flex-direction:column}.zea-menu .items{display:none}.menu-anchor{color:var(--color-foreground-1)}.zea-menu.shown{color:var(--color-foreground-1);display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.zea-menu.shown .items{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column}.dropdown slot{display:-ms-flexbox;display:flex}.zea-menu.contextual{position:relative}.contextual.menu-wrap{display:inline-block;position:relative;vertical-align:middle}.contextual .items{position:absolute;z-index:1000}.contextual.show-anchor .items{margin-top:25px}.contextual.top-right .items{-webkit-transform:translateX(-100%);transform:translateX(-100%);margin-left:100%}.toolbar.horizontal .items{-ms-flex-direction:row;flex-direction:row}.toolbar{background-color:var(--color-background-2);position:fixed;border-radius:30px}.dropdown .items,.contextual .items{background-color:var(--color-background-2)}",ZeaMenu=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.offset=[0,0],this.leftOffset="",this.topOffset="",this.type="dropdown",this.orientation="vertical",this.shown=!1,this.showAnchor=!1,this.anchorIcon="ellipsis-vertical-circle-outline",this.contextualAlign="top-left"}handleClick(t){t.currentTarget!=this.anchorElement?("contextual"!=this.type||this.isDescendant(this.hostElement,t.target)||(this.shown=!1),this.mouseIsDown=!1):this.shown=!this.shown}isDescendant(t,e){let i=e.parentNode;for(;null!=i;){if(i==t)return!0;i=i.parentNode}return!1}handleItemClick(t){"contextual"!=this.type||t.detail.hasSubitems||(this.shown=!1)}mousedownHandler(t){"toolbar"==this.type&&"ZEA-MENU"==t.currentTarget.tagName&&(this.mouseIsDown=!0,this.offset=[this.menuElement.offsetLeft-t.clientX,this.menuElement.offsetTop-t.clientY])}mousemoveHandler(t){"toolbar"==this.type&&this.mouseIsDown&&(this.menuElement.style.left=t.clientX+this.offset[0]+"px",this.menuElement.style.top=t.clientY+this.offset[1]+"px")}handleAnchorClick(t){this.handleClick(t),t.stopPropagation()}componentDidLoad(){"contextual"!=this.type&&(this.shown=!0)}componentDidRender(){this.setupChildren(),this.adjustPosition()}setupChildren(){this.itemsContainer.querySelector("slot").assignedNodes().forEach(t=>{"type"in t&&(t.type=this.type),"itemParent"in t&&(t.itemParent=this.hostElement),"rootMenu"in t&&(t.rootMenu=this.hostElement)})}adjustPosition(){"contextual"==this.type&&this.adjustContextualPosition()}adjustContextualPosition(){if(this.shown){const t=window.innerHeight,e=window.innerWidth;this.itemsContainer.style.transform="translate(0, 0)";const i=this.itemsContainer.getBoundingClientRect(),n=this.menuElement.getBoundingClientRect();let s="0",o="0";n.left+i.width>e&&(s="-100%"),n.top+i.height>t&&(o="-100%"),this.itemsContainer.style.transform=`translate(${s}, ${o})`}}render(){const t="contextual"==this.type&&this.showAnchor?h("div",{onMouseUp:this.handleAnchorClick.bind(this),class:"menu-anchor",ref:t=>this.anchorElement=t},h("zea-icon",{name:this.anchorIcon})):null,e={"zea-menu":!0};return e[this.type]=!0,e[this.orientation]=!0,e.shown=this.shown,e[this.contextualAlign]=!0,e["show-anchor"]=this.showAnchor,h("div",{class:e,ref:t=>this.menuElement=t},t,h("div",{ref:t=>this.itemsContainer=t,class:"items",style:{top:this.topOffset,left:this.leftOffset}},h("slot",null)))}get hostElement(){return this}static get style(){return zeaMenuCss}},zeaMenuColorCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-menu-color{--zea-menu-color-color:var(--theme-color);color:var(--zea-menu-color-color)}.zea-menu-color{width:24px;height:24px;border-radius:12px;display:block}",ZeaMenuColor=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.color="",this.fgColor=""}render(){return h("div",{class:"zea-menu-color",style:{backgroundColor:this.color}})}static get style(){return zeaMenuColorCss}},zeaMenuColorpickerCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.currentColor{margin:10px}.colorDropdown{display:none}.colorDropdown.shown{display:grid;grid-gap:10px;padding:10px;grid-template-columns:1fr 1fr 1fr;position:absolute;margin-top:-42px;margin-left:49px;border-radius:15px;background-color:var(--color-background-2)}",ZeaMenuColorpicker=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.colorElements=[],this.shown=!1}handleDropDownColorClick(t){t.target!=this.currentColor&&"ZEA-MENU-COLOR"==t.target.tagName&&(this.dropDownContainer.insertBefore(this.currentColor,this.dropDownContainer.childNodes[0]),this.currentColor=t.target,this.setActiveColors(),this.currentColorContainer.appendChild(this.currentColor),this.shown=!1,"callback"in this.currentColor&&this.runCallback(this.currentColor))}setActiveColors(){document.documentElement.style.setProperty("--toolbar-active-bg-color",this.currentColor.color),document.documentElement.style.setProperty("--toolbar-active-fg-color",this.currentColor.fgColor)}handleCurrentColorClick(){this.shown=!this.shown}componentDidRender(){this.setupChildren()}setupChildren(){this.dropDownContainer.querySelector("slot").assignedElements().forEach(t=>{"ZEA-MENU-COLOR"==t.tagName&&(this.colorElements.push(t),t.addEventListener("click",this.handleDropDownColorClick.bind(this)))}),this.currentColor||(this.currentColor=this.colorElements[0],this.setActiveColors()),this.currentColorContainer.appendChild(this.currentColor)}runCallback(element){element.callback&&("string"==typeof element.callback?eval(element.callback):element.callback(element))}render(){return h("div",{class:"zea-menu-colorpicker"},h("div",{onClick:this.handleCurrentColorClick.bind(this),class:"currentColor",ref:t=>this.currentColorContainer=t}),h("div",{class:"colorDropdown "+(this.shown?"shown":""),ref:t=>this.dropDownContainer=t},h("slot",null)))}static get style(){return zeaMenuColorpickerCss}},zeaMenuItemCss="*{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-menu-item{position:relative}.outer-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;color:var(--color-foreground-1);position:relative}.toolbar .outer-wrap{background-color:transparent;border-radius:30px;margin:5px}.pressed .outer-wrap{background-color:var(--color-grey-3)}.active .outer-wrap{background-color:var(--color-grey-3)}.standalone:hover .outer-wrap{background-color:var(--color-grey-3)}.zea-menu-item:hover{background-color:var(--color-grey-3)}.zea-menu-item.toolbar:hover{background-color:transparent}.toolbar.pressed .outer-wrap{background-color:var(--color-background-2)}.toolbar.active .outer-wrap{background-color:var(--toolbar-active-bg-color, var(--color-grey-3));color:var(--toolbar-active-fg-color, var(--color-foreground-1))}.inner-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;font-size:12px;padding:0 10px;min-height:40px;white-space:nowrap;-ms-flex-positive:1;flex-grow:1}zea-switch{margin-left:0.5em;pointer-events:none}zea-checkbox{margin-right:0.5em;pointer-events:none}::slotted(zea-icon){margin-right:5px;font-size:10px;pointer-events:none}.toolbar .inner-wrap{padding:5px;min-height:auto}.toolbar ::slotted(zea-icon){margin-right:0}.hotkey{display:block;opacity:0.75;font-size:0.8em;padding-left:10px;pointer-events:none}.keyboard-key{border:1px solid var(--color-grey-3);padding:2px;border-radius:5px;font-size:0.8em;text-align:center;min-width:10px;display:inline-block;background-color:var(--color-background-1);text-transform:uppercase;margin:0 2px}",ZeaMenuItem=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.switch=!1,this.active=!1,this.hasCheckbox=!1,this.hasRadio=!1,this.checked=!1,this.shown=!1,this.allowHover=!1,this.hotkey="",this.type="",this.hasSubitems=!1,this.isPushButton=!1,this.zeaMenuItemClick=createEvent(this,"zeaMenuItemClick",7),this.zeaMenuItemPressed=createEvent(this,"zeaMenuItemPressed",7)}windowClickHandler(t){t.composedPath().includes(this.rootMenu)&&(this.active=!1,t.detail.active=!0,t.detail.hasSubitems||"toolbar"==this.type||(this.active=!1))}handleWindowMouseup(t){(this.isPushButton||!this.isDescendant(this.rootMenu,t.target)&&"toolbar"!=this.type)&&(this.active=!1)}handleWindowTouchend(t){(this.isPushButton||!this.isDescendant(this.rootMenu,t.target)&&"toolbar"!=this.type)&&(this.active=!1)}isDescendant(t,e){let i=e.parentNode;for(;null!=i;){if(i==t)return!0;i=i.parentNode}return!1}componentDidRender(){}watchHandler(){this.setupChildren()}setupChildren(){this.container.querySelector("slot").assignedElements().forEach(t=>{"ZEA-MENU-SUBITEMS"==t.tagName&&(this.hasSubitems=!0,this.subitemsElement=t,this.subitemsElement.rootMenu=this.rootMenu,this.subitemsElement.parentItem=this.hostElement,this.subitemsElement.type=this.hostElement.parentElement.type,this.outerWrap.appendChild(this.subitemsElement),this.container.classList.add("has-subitems"),"ZEA-MENU"==this.hostElement.parentElement.tagName&&(this.subitemsElement.belongsToRoot=!0))})}handleItemClick(t){this.zeaMenuItemClick.emit(this.hostElement),this.active=!0,this.runCallback(t)}handleItemMouseDown(){this.container.classList.add("pressed"),this.zeaMenuItemPressed.emit(this.hostElement),this.checked=!this.checked,this.isPushButton&&(this.active=!0)}handleItemMouseUp(t){this.container.classList.remove("pressed"),this.handleItemClick(t),this.hasSubitems||"toolbar"==this.type||(this.active=!1)}runCallback(payLoad){this.callback&&("string"==typeof this.callback?eval(this.callback):this.callback(payLoad))}keydownHandler(t){if(t.target instanceof HTMLInputElement)return;const e=[];t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.metaKey&&e.push("ctrl"),t.ctrlKey&&e.push("ctrl"),"Alt"!=t.key&&"Control"!=t.key&&"Ctrl"!=t.key&&"Shift"!=t.key&&e.push(t.key),e.join("+").toLowerCase()==this.hotkey.toLowerCase()&&this.handleItemClick(new MouseEvent("click")),t.preventDefault()}keyComboAsHtml(){const t=this.hotkey.split("+"),e=[];return t.forEach(t=>{"ctrl"==(t=t.toLowerCase())?(e.push(h("span",{class:"keyboard-key"},"Ctrl")),e.push("+")):"alt"==t?(e.push(h("span",{class:"keyboard-key"},"Alt")),e.push("+")):"shift"==t?(e.push(h("span",{class:"keyboard-key"},"Shift")),e.push("+")):e.push(h("span",{class:"keyboard-key"},t))}),e}render(){return h("div",{ref:t=>this.container=t,class:`zea-menu-item ${this.type} ${this.active?"active":""} ${this.allowHover?"allow-hover":""}`},h("div",{class:"outer-wrap",ref:t=>this.outerWrap=t},h("div",{class:"inner-wrap",onMouseDown:this.handleItemMouseDown.bind(this),onMouseUp:this.handleItemMouseUp.bind(this),onTouchStart:this.handleItemMouseDown.bind(this),onTouchEnd:this.handleItemMouseUp.bind(this)},this.hasCheckbox?h("zea-checkbox",{isRadio:this.hasRadio,checked:this.checked,ref:t=>this.checkboxElement=t}):null,h("slot",null),this.switch?h("zea-switch",{checked:this.checked}):null,this.hotkey?h("span",{class:"hotkey"},this.keyComboAsHtml()):null)))}get hostElement(){return this}static get watchers(){return{rootMenu:["watchHandler"]}}static get style(){return zeaMenuItemCss}},zeaMenuSeparatorCss=".ruler{overflow:hidden;margin:0;height:1px;background-color:var(--color-grey-3)}.zea-menu-separator{}.zea-menu-separator.vertical{height:24px;width:21px}.vertical .ruler{width:1px;margin:0 10px;height:100%}.dropdown .ruler{height:100%;width:1px}",ZeaMenuSeparator=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.class="",this.orientation="horizontal"}render(){return h("div",{class:`zea-menu-separator ${this.class} ${this.orientation}`},h("div",{class:"ruler"}))}static get style(){return zeaMenuSeparatorCss}},zeaMenuSubitemsCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.fgpath{fill:var(--color-foreground-1)}.arrow{display:-ms-flexbox;display:flex}.subitems{display:none;position:absolute;left:100%;margin-top:-24px;padding-left:1px;background-color:var(--color-background-2)}.shown .subitems{display:block}.dropdown .subitems{left:0;margin-top:13px;padding-top:1px}",ZeaMenuSubitems=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.subitemsArray=[],this.shown=!1,this.type="",this.radioSelect=!1}windowClickHandler(t){const e=t.detail,i=this.isDescendant(this.hostElement,e);e==this.parentItem?this.shown=!this.shown:i&&e.hasSubitems||(this.shown=!1)}windowItemPressHandler(t){const e=this.isDescendant(this.hostElement,t.detail);this.radioSelect&&e&&this.subitemsArray.forEach(t=>{t.checked=!1})}handleWindowMouseup(t){this.isDescendant(this.rootMenu,t.target)||(this.shown=!1)}isDescendant(t,e){let i=e.parentNode;for(;null!=i;){if(i==t)return!0;i=i.parentNode}return!1}componentDidRender(){}watchHandler(){this.setupChildren()}setupChildren(){this.subitemsElement.querySelector("slot").assignedElements().forEach(t=>{"itemParent"in t&&(t.itemParent=this.hostElement),"rootMenu"in t&&(t.rootMenu=this.rootMenu),this.radioSelect&&(t.hasCheckbox=!0,t.hasRadio=!0),this.subitemsArray.push(t)})}render(){return h("div",{class:`zea-menu-subitems ${this.type} ${this.shown?"shown":""} `},h("div",{class:"arrow"},h("svg",{class:"branch-arrow-icon",xmlns:"http://www.w3.org/2000/svg",height:"13",viewBox:"0 0 24 24",width:"13"},h("path",{d:"M8 5v14l11-7z",class:"fgpath"}),h("path",{d:"M0 0h24v24H0z",fill:"none"}))),h("div",{class:"subitems",ref:t=>this.subitemsElement=t},h("slot",null)))}get hostElement(){return this}static get watchers(){return{rootMenu:["watchHandler"]}}static get style(){return zeaMenuSubitemsCss}},zeaNavigationDrawerCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-navigation-drawer{color:var(--color-foreground-1);display:inline-block;vertical-align:middle}.drawer{position:fixed;top:0;left:0;-webkit-transform:translateX(-100%);transform:translateX(-100%);width:192px;height:100vh;background-color:var(--color-background-1);z-index:10000000;-webkit-transition:-webkit-transform 0.3s;transition:-webkit-transform 0.3s;transition:transform 0.3s;transition:transform 0.3s, -webkit-transform 0.3s;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out}.shown .drawer{left:0;-webkit-transform:translateX(0);transform:translateX(0)}.toggle{position:relative;z-index:10000010;margin-right:12px;margin-left:7px;background-color:transparent;border-radius:50%;padding:4px;display:inline-block}.toggle:hover{background-color:var(--color-grey-3)}.drawer-content{padding-top:80px;padding-left:9px;font-size:14px}@media only screen and (max-width: 667px){.drawer{width:80%}}",ZeaNavigationDrawer=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.shown=!1,this.navDrawerOpen=createEvent(this,"navDrawerOpen",7),this.navDrawerClosed=createEvent(this,"navDrawerClosed",7)}handleClick(t){t.composedPath().includes(this.container)&&t.composedPath().includes(this.toggleButton)||(this.shown=!1,this.navDrawerClosed.emit(this))}onToggleClick(){this.shown=!this.shown,this.shown?this.navDrawerOpen.emit(this):this.navDrawerClosed.emit(this)}render(){return h("div",{ref:t=>this.container=t,class:{"zea-navigation-drawer":!0,shown:this.shown}},h("div",{class:"drawer"},h("div",{class:"drawer-content"},h("slot",null))),h("div",{class:"toggle",ref:t=>this.toggleButton=t,onClick:this.onToggleClick.bind(this)},h("zea-icon",{size:30,name:"menu"})))}static get style(){return zeaNavigationDrawerCss}},zeaPanelProgressBarCss=".zea-panel-progress-bar{color:var(--color-freground-1);position:absolute;top:0;left:0;right:0;bottom:0;background-color:var(--color-shadow);display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}",ZeaPanelProgressBar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h("div",{class:"zea-panel-progress-bar"},h("zea-dialog",{shown:!0,allowClose:!1,showTitle:!1,fullScreenMobile:!1,width:"300px"},h("div",{slot:"body"},h("slot",null),h("zea-progress-bar",{ref:t=>this.progressBar=t,type:"indeterminate"}))))}static get style(){return zeaPanelProgressBarCss}};class UxFactory{constructor(){this.treeItemFactories=[],this.widgetFactories=[],this.inspectorFactories=[]}registerInpector(t,e){this.inspectorFactories.push({inspector:t,rule:e})}constructInspector(...t){const e=t[0];for(let i=this.inspectorFactories.length;i-- >0;){const n=this.inspectorFactories[i];if(n.rule(e))return new n.inspector(...t)}console.warn(`Inspector factory not found for parameter '${e.getName()}' of class '${e.constructor.name}'`)}registerTreeItemElement(t,e){this.treeItemFactories.push({treeItemElement:t,rule:e})}constructTreeItemElement(...t){const e=t[0];for(let i=this.treeItemFactories.length;i-- >0;){const n=this.treeItemFactories[i];if(n.rule(e))return new n.treeItemElement(...t)}console.warn(`Tree item factory not found for parameter '${e.getName()}' of class '${e.constructor.name}'`)}registerWidget(t,e){this.widgetFactories.push({widget:t,rule:e})}findWidgetReg(t){for(let e=this.widgetFactories.length;e-- >0;){const i=this.widgetFactories[e];if(i.rule(t))return i}}constructWidget(...t){const e=t[0];for(let i=this.widgetFactories.length;i-- >0;){const n=this.widgetFactories[i];if(n.rule(e))return new n.widget(...t)}console.warn(`Widget factory not found for parameter '${e.getName()}' of class '${e.constructor.name}'`)}}const uxFactory=new UxFactory;function e(t,i){if(!e.watchedElementData){e.watchedElementData=[];const t=function(){e.watchedElementData.forEach((function(t){t.element.offsetWidth===t.offsetWidth&&t.element.offsetHeight===t.offsetHeight||(t.offsetWidth=t.element.offsetWidth,t.offsetHeight=t.element.offsetHeight,t.callback())}))};window.addEventListener("resize",t),new MutationObserver(t).observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}e.watchedElementData.push({element:t,offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight,callback:i})}const t=function(){const t=null!=(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Pixel/i)||navigator.userAgent.match(/Windows Phone/i)),e=function(){const t=navigator.userAgent;let e,i,n,s=navigator.appName,o=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);return-1!=(i=t.indexOf("Opera"))?(s="Opera",o=t.substring(i+6),-1!=(i=t.indexOf("Version"))&&(o=t.substring(i+8))):-1!=(i=t.indexOf("MSIE"))?(s="Microsoft Internet Explorer",o=t.substring(i+5)):-1!=(i=t.indexOf("Edge"))?(s="Edge",o=t.substring(i+4)):-1!=(i=t.indexOf("Chrome"))?(s="Chrome",o=t.substring(i+7)):-1!=(i=t.indexOf("Safari"))?(s="Safari",o=t.substring(i+7),-1!=(i=t.indexOf("Version"))&&(o=t.substring(i+8))):-1!=(i=t.indexOf("Firefox"))?(s="Firefox",o=t.substring(i+8)):(e=t.lastIndexOf(" ")+1)<(i=t.lastIndexOf("/"))&&(s=t.substring(e,i),o=t.substring(i+1),s.toLowerCase()==s.toUpperCase()&&(s=navigator.appName)),-1!=(n=o.indexOf(";"))&&(o=o.substring(0,n)),-1!=(n=o.indexOf(" "))&&(o=o.substring(0,n)),r=parseInt(""+o,10),isNaN(r)&&(o=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10)),{browserName:s,fullVersion:o,majorVersion:r,appName:navigator.appName,userAgent:navigator.userAgent}}(),i=function(){let t,e;try{t=document.createElement("canvas").getContext("webgl")}catch(t){}if(!t)return;try{e=document.createElement("canvas").getContext("webgl2")}catch(t){}const i=t.getExtension("WEBGL_debug_renderer_info");if(!i)return console.warn("Unable to determine GPU Info:"),{vendor:"Unknown",renderer:"Unknown",gpuVendor:"Unknown",maxTextureSize:"Unknown",supportsWebGL2:null!=e};const n=t.getParameter(i.UNMASKED_VENDOR_WEBGL),s=t.getParameter(i.UNMASKED_RENDERER_WEBGL),o=t.getParameter(t.MAX_TEXTURE_SIZE);let r;return s.match(/NVIDIA/i)?r="NVidia":s.match(/AMD/i)||s.match(/Radeon/i)?r="AMD":s.match(/Intel/i)?r="Intel":s.match(/Mali/i)?r="ARM":s.match(/Adreno/i)?r="Adreno":console.warn("Unable to determine GPU vendor:",s),{vendor:n,renderer:s,gpuVendor:r,maxTextureSize:o,supportsWebGL2:null!=e}}();let n="Low";if(i)if(t)n="Low";else{const t=i.renderer.replace(/[()]/g,"").split(" ");if("NVidia"==i.gpuVendor){const e=t.indexOf("GTX");if(-1!=e){const i=t[e+1];n=i.endsWith("M")?parseInt(i.substring(0,i.length-2))>=900?"Medium":"Low":parseInt(i)>=1030?"High":"Medium"}else n=-1!=t.indexOf("TITAN")||-1!=t.indexOf("Quadro")?"High":"Low"}else if("AMD"==i.gpuVendor){const e=t.indexOf("Radeon");if(-1!=e){const i=t.indexOf("RX");if(-1!=i)if("Vega"==t[i+1])n="High";else{const e=t[i+1];let s;e.endsWith("X")?(s=parseInt(e.substring(0,e.length-2)),n="High"):s=parseInt(e),n=s>=480?"High":"Medium"}else n="Pro"==t[e+1]?parseInt(t[i+1])>=450?"Medium":"Low":"Sky"==t[e+1]&&parseInt(t[i+1])>=700?"Medium":"Low"}else n=-1!=t.indexOf("FirePro")||-1!=t.indexOf("Quadro")?"High":"Low"}else("Adreno"==i.gpuVendor||"Intel"==i.gpuVendor)&&(n="Low")}return{isMobileDevice:t,isIOSDevice:null!=(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)),browserName:e.browserName,fullVersion:e.fullVersion,majorVersion:e.majorVersion,appName:e.appName,userAgent:e.userAgent,webGLSupported:null!=i,gpuDesc:i,deviceCategory:n}}();var a$1=Object.freeze({__proto__:null,SystemDesc:t});const i$5=Math.PI/180;Math.HALF_PI=.5*Math.PI,Math.TWO_PI=2*Math.PI,Math.radToDeg=function(t){return t/i$5},Math.degToRad=function(t){return t*i$5},Number.isNumeric=t=>!isNaN(parseFloat(t))&&isFinite(t),String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)};const m$2=function(t){let e,i,n,s=0;if(0===t.length)return s;for(e=0,n=t.length;e<n;e++)i=t.charCodeAt(e),s=(s<<5)-s+i,s|=0;return Math.abs(s)};function u(t,e=0,i=5){return JSON.stringify(t,(function(t,e){return e&&e.toFixed?Number(e.toFixed(i)):e}),e)}String.prototype.hash=function(){return m$2(this)},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.lpad=function(t,e){let i=this;for(;i.length<e;)i=t+i;return i},String.prototype.rpad=function(t,e){let i=this;for(;i.length<e;)i+=t;return i},Math.randomInt=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t},Math.lerp=(t,e,i)=>t+i*(e-t),Math.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},Math.nearestPow2=function(t){return Math.pow(2,Math.round(Math.log(t)/Math.log(2)))},Math.nearestPow10=function(t){return Math.pow(10,Math.round(Math.log10(t)/Math.log10(10)))},Math.nextPow2=function(t){let e=0;for(;t>0;)e++,t>>=1;return 1<<e},Math.fract=function(t){return 0==t?0:t<0?t>-1?-t:-t%Math.floor(-t):t<1?t:t%Math.floor(t)},Math.remap=function(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)},Math.convertFloat32ArrayToUInt16Array=function(t){const e=new Uint16Array(t.length),i=new Int32Array(t.buffer),n=t=>{let e=t>>16&32768,i=t>>12&2047;const n=t>>23&255;return n<103?e:n>142?(e|=31744,e|=(255==n?0:1)&&8388607&t,e):n<113?(i|=2048,e|=(i>>114-n)+(i>>113-n&1),e):(e|=n-112<<10|i>>1,e+=1&i,e)};for(let s=0;s<t.length;s++)e[s]=n(i[s]);return e},Math.decode16BitFloatFrom2xUInt8=t=>{const e=t[0],i=(120&e)>>3;let n=0==i?0:2048;const s=n+((7&e)<<8)+t[1];return n=0==i?1:0,(128&e?1:-1)*s*Math.pow(2,i+n-16)},Math.encode16BitFloatInto2xUInt8=t=>{c||(c=new Uint8Array(2));const e=t>=0?128:0;t=Math.abs(t);let i,n=15,s=1024;for(let l=15;l>0;l--)t<s&&(s/=2,n--);i=0==n?t/s/2:(t-s)/s;const o=Math.round(2048*i),r=o/256,a=o-256*r;return c[0]=e+8*n+r,c[1]=a,t>=2048&&(c[0]=255),c},Math.encode16BitFloat=t=>{const e=new Float32Array(1);return e[0]=t,(t=>{let e=t>>16&32768,i=t>>12&2047;const n=t>>23&255;return n<103?e:n>142?(e|=31744,e|=(255==n?0:1)&&8388607&t,e):n<113?(i|=2048,e|=(i>>114-n)+(i>>113-n&1),e):(e|=n-112<<10|i>>1,e+=1&i,e)})(new Int32Array(e.buffer)[0])},Math.decode16BitFloat=t=>{const e=(32768&t)>>15,i=(31744&t)>>10,n=1023&t;return 0==i?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):31==i?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,i-15)*(1+n/Math.pow(2,10))},Math.smoothStep=(t,e,i)=>{const n=Math.clamp((i-t)/(e-t),0,1);return n*n*(3-2*n)},Math.linStep=(t,e,i)=>Math.clamp((i-t)/(e-t),0,1);class p{isValid(){for(const t of this.__data)if(t==1/0||isNaN(t))return!1;return!0}static createFromFloat32Buffer(t,e){throw new Error("Not yet implemented for this type:"+this.constructor.name)}static numElements(){throw new Error("Not yet implemented for this type:"+this.constructor.name)}asArray(){return this.__data}toString(){return u(this.toJSON())}toJSON(){throw new Error("Not yet implemented for this type:"+this.constructor.name)}}const g=new class{constructor(){this.__types={},this.__names={},this.registerType("SInt32",5),this.registerType("UInt32",4),this.registerType("Float32",6)}registerType(t,e){this.__types[t]=e,e.name?this.__names[e.name]=t:this.__names[e]=t}getType(t){return this.__types[t]}getTypeName(t){if(this.__names[t])return this.__names[t];if(this.__names[t.name])return this.__names[t.name];throw t}};class _ extends p{constructor(t=0,e=0){super(),t instanceof Float32Array||t instanceof Uint32Array||t instanceof Int32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,2):null!=t&&"object"==typeof t?(this.__data=new Float32Array(2),this.fromJSON(t)):(this.__data=new Float32Array(2),this.__data[0]=t,this.__data[1]=e)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}set(t,e){this.__data[0]=t,this.__data[1]=e}setFromOther(t){this.x=t.x,this.y=t.y}equal(t){return this.x==t.x&&this.y==t.y}notEquals(t){return this.x!=t.x&&this.y!=t.y}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e}add(t){return new _(this.x+t.x,this.y+t.y)}addInPlace(t){this.x+=t.x,this.y+=t.y}subtract(t){return new _(this.x-t.x,this.y-t.y)}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}scale(t){return new _(this.x*t,this.y*t)}scaleInPlace(t){this.x*=t,this.y*=t}invert(){return new _(1/this.x,1/this.y)}invertInPlace(){return this.x=1/this.x,this.y=1/this.y,this}multiply(t){return new _(this.x*t.x,this.y*t.y)}multiplyInPlace(t){this.x*=t.x,this.y*=t.y}lengthSquared(){const t=this.__data[0],e=this.__data[1];return t*t+e*e}length(){return Math.sqrt(this.lengthSquared())}distanceTo(t){const e=this.__data[0]-t.x,i=this.__data[1]-t.y;return Math.sqrt(e*e+i*i)}normalize(){const t=this.__data[0],e=this.__data[1];let i=t*t+e*e;return i<Number.EPSILON?new _:(i=1/Math.sqrt(i),new _(t*i,e*i))}normalizeInPlace(){const t=this.__data[0],e=this.__data[1];let i=t*t+e*e;i<Number.EPSILON||(i=1/Math.sqrt(i),this.set(t*i,e*i))}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}angleTo(t){const e=this.normalize().dot(t.normalize());return e>1?0:e<-1?Math.PI:Math.acos(e)}signedAngleTo(t){const e=this.angleTo(t);return this.cross(t)<0?-e:e}rotate(t){const e=Math.cos(t),i=Math.sin(t);return new _(this.x*e-this.y*i,this.x*i+this.y*e)}lerp(t,e){const i=this.x,n=this.y;return new _(i+e*(t.x-i),n+e*(t.y-n))}setRandomDir(t=1){const e=2*Math.random()*Math.PI;return this.__data[0]=Math.cos(e)*zScale,this.__data[1]=Math.sin(e)*zScale,this}setRandom(t=1){return this.__data[0]=Math.random()*t,this.__data[1]=Math.random()*t,this}clone(){return new _(this.__data[0],this.__data[1])}asArray(){return this.__data}static create(...t){return new _(...t)}static createFromFloat32Buffer(t,e=0){return new _(t,4*e)}static createFromFloat32Array(t){return new _(t)}static numElements(){return 2}toJSON(){return{x:this.x,y:this.y}}fromJSON(t){this.x=t.x,this.y=t.y}}g.registerType("Vec2",_);class Z extends p{constructor(t=0,e=0,i=0){super(),t instanceof Float32Array||t instanceof Uint32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,3):null!=t&&"object"==typeof t?(this.__data=new Float32Array(3),this.fromJSON(t)):(this.__data=new Float32Array(3),this.__data[0]=t,this.__data[1]=e,this.__data[2]=i)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}get xy(){return new _(this.__data[0],this.__data[1])}get yz(){return new _(this.__data[1],this.__data[2])}set(t,e,i){this.x=t,this.y=void 0!==e?e:t,this.z=void 0!==i?i:t}setDataArray(t){this.__data=t}setFromOther(t){this.x=t.x,this.y=t.y,this.z=t.z}isNull(){return Math.abs(this.x)<Number.EPSILON&&Math.abs(this.y)<Number.EPSILON&&Math.abs(this.z)<Number.EPSILON}is111(){return Math.abs(1-this.x)<Number.EPSILON&&Math.abs(1-this.y)<Number.EPSILON&&Math.abs(1-this.z)<Number.EPSILON}equal(t){return this.x==t.x&&this.y==t.y&&this.z==t.z}notEquals(t){return this.x!=t.x&&this.y!=t.y&&this.z!=t.z}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e}add(t){return new Z(this.x+t.x,this.y+t.y,this.z+t.z)}addInPlace(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}subtract(t){return new Z(this.x-t.x,this.y-t.y,this.z-t.z)}subtractInPlace(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}multiply(t){return new Z(this.x*t.x,this.y*t.y,this.z*t.z)}multiplyInPlace(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}divide(t){return new Z(this.x/t.x,this.y/t.y,this.z/t.z)}divideInPlace(t){this.x/=t.x,this.y/=t.y,this.z/=t.z}scale(t){return new Z(this.x*t,this.y*t,this.z*t)}scaleInPlace(t){this.x*=t,this.y*=t,this.z*=t}negate(){return new Z(-this.x,-this.y,-this.z)}inverse(){return new Z(1/this.x,1/this.y,1/this.z)}lengthSquared(){const t=this.__data[0],e=this.__data[1],i=this.__data[2];return t*t+e*e+i*i}length(){return Math.sqrt(this.lengthSquared())}distanceTo(t){const e=this.__data[0]-t.x,i=this.__data[1]-t.y,n=this.__data[2]-t.z;return Math.sqrt(e*e+i*i+n*n)}normalize(){let t=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];return t<Number.EPSILON?new Z:(t=1/Math.sqrt(t),new Z(this.__data[0]*t,this.__data[1]*t,this.__data[2]*t))}normalizeInPlace(){let t=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];if(t<Number.EPSILON)return;t=Math.sqrt(t);const e=1/t;return this.__data[0]*=e,this.__data[1]*=e,this.__data[2]*=e,t}resize(t){const e=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];if(e<Number.EPSILON)return;const i=t/Math.sqrt(e);return new Z(this.__data[0]*i,this.__data[1]*i,this.__data[2]*i)}resizeInPlace(t){const e=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];if(e<Number.EPSILON)return;const i=t/Math.sqrt(e);this.__data[0]*=i,this.__data[1]*=i,this.__data[2]*=i}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const e=this.x,i=this.y,n=this.z,s=t.x,o=t.y,r=t.z;return new Z(i*r-n*o,n*s-e*r,e*o-i*s)}angleTo(t){const e=this.dot(t);return e>1?0:Math.acos(e)}lerp(t,e){const i=this.x,n=this.y,s=this.z;return new Z(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s))}abs(){return new Z(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}setRandomDir(t=1){const e=2*Math.random()*Math.PI,i=2*Math.random()-1,n=Math.sqrt(1-i*i)*t;return this.__data[0]=Math.cos(e)*n,this.__data[1]=Math.sin(e)*n,this.__data[2]=i*t,this}setRandom(t=1){return this.__data[0]=(Math.random()-.5)*t,this.__data[1]=(Math.random()-.5)*t,this.__data[2]=(Math.random()-.5)*t,this}clone(){return new Z(this.__data[0],this.__data[1],this.__data[2])}asArray(){return this.__data}static create(...t){return new Z(...t)}static createFromJSON(t){const e=new Z;return e.fromJSON(t),e}static createFromFloat32Buffer(t,e=0){return new Z(t,4*e)}static createFromFloat32Array(t){return new Z(t)}static numElements(){return 3}toJSON(){return{x:this.x,y:this.y,z:this.z}}fromJSON(t){this.x=t.x,this.y=t.y,this.z=t.z}}g.registerType("Vec3",Z);class G extends p{constructor(t=0,e=0,i=0,n=0){super(),t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,4):null!=t&&"object"==typeof t?(this.__data=new Float32Array(4),this.fromJSON(t)):(this.__data=new Float32Array(4),this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}get t(){return this.__data[3]}set t(t){this.__data[3]=t}get xyz(){return new Z(this.__data[0],this.__data[1],this.__data[2])}set(t,e,i,n){this.x=t,this.y=e,this.z=i,this.t=n}setFromOther(t){this.x=t.x,this.y=t.y,this.z=t.z,this.t=t.t}equal(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.t==t.t}notEquals(t){return this.x!=t.x&&this.y!=t.y&&this.z!=t.z&&this.t!=t.t}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&Math.abs(this.t-t.t)<e}add(t){return new G(this.x+t.x,this.y+t.y,this.z+t.z,this.t+t.t)}addInPlace(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.t+=t.t}subtract(t){return new G(this.x-t.x,this.y-t.y,this.z-t.z,this.t-t.t)}subtractInPlace(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.t-=t.t}multiply(t){return new G(this.x*t.x,this.y*t.y,this.z*t.z,this.t*t.t)}multiplyInPlace(t){this.x*=t.x,this.y*=t.y,this.z*=t.z,this.t*=t.t}divide(t){return new G(this.x/t.x,this.y/t.y,this.z/t.z,this.t/t.t)}divideInPlace(t){this.x/=t.x,this.y/=t.y,this.z/=t.z,this.t/=t.t}scale(t){return new G(this.x*t,this.y*t,this.z*t,this.t*t)}scaleInPlace(t){this.set(this.x*t,this.y*t,this.z*t,this.t*t)}length(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[2];return Math.sqrt(t*t+e*e+i*i+n*n)}lengthSquared(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];return t*t+e*e+i*i+n*n}normalize(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;return s<Number.EPSILON?new G:(s=1/Math.sqrt(s),new G(t*s,e*s,i*s))}normalizeInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;s<Number.EPSILON||(s=1/Math.sqrt(s),this.set(t*s,e*s,i*s,n*s))}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.t*b.t}cross(t){const e=this.x,i=this.y,n=this.z,s=this.t,o=t.x,r=t.y,a=t.z,l=t.t;return new G(i*a-n*r,n*l-s*a,s*o-e*l,e*r-i*o)}angleTo(t){const e=this.normalize(),i=t.normalize(),n=e.dot(i);return n>1?0:Math.acos(n)}lerp(t,e){const i=this.x,n=this.y,s=this.z;return at=this.t,new G(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s),at+e*(t.t-at))}random(t=1){const e=2*glMatrix.RANDOM()*Math.PI,i=2*glMatrix.RANDOM()-1,n=Math.sqrt(1-i*i)*t;return out[0]=Math.cos(e)*n,out[1]=Math.sin(e)*n,out[2]=i*t,out}clone(){return new G(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}toVec3(){return new Z(this.__data[0],this.__data[1],this.__data[2])}asArray(){return this.__data}static create(...t){return new Z(...t)}static createFromFloat32Buffer(t,e=0){return new G(t,4*e)}static numElements(){return 4}toJSON(){return{x:this.x,y:this.y,z:this.z,t:this.t}}}g.registerType("Vec4",G);class X extends p{constructor(t=0,e=0,i=0,n=255){super(),t instanceof Uint8Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Uint8Array(t,e,4):(this.__data=new Uint8Array(4),"string"==typeof t?t.startsWith("#")?this.setFromHex(t):this.setFromCSSColorName(t):(this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n))}get r(){return this.__data[0]}set r(t){this.__data[0]=t}get g(){return this.__data[1]}set g(t){this.__data[1]=t}get b(){return this.__data[2]}set b(t){this.__data[2]=t}get a(){return this.__data[3]}set a(t){this.__data[3]=t}set(t,e,i,n=255){this.r=t,this.g=e,this.b=i,this.a=n}setFromOther(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}setFromArray(t){this.r=t[0],this.g=t[1],this.b=t[2],this.a=4==t.length?t[3]:1}setFromHex(t){const e=function(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);e?this.set(e.r,e.g,e.b):console.warn("Invalid hex code:"+t)}setFromCSSColorName(t){t.startsWith("#")?this.setFromHex(t):this.setFromHex((t=>{const e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==e[t.toLowerCase()]&&e[t.toLowerCase()]})(t))}toHex(){function t(t){const e=t.toString(16);return 1==e.length?"0"+e:e}return"#"+t(this.r)+t(this.g)+t(this.b)}equal(t){return this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a}notequals(t){return this.r!=t.r&&this.g!=t.g&&this.b!=t.b&&this.a!=t.a}approxEqual(t,e=Number.EPSILON){return Math.abs(this.r-t.r)<e&&Math.abs(this.g-t.g)<e&&Math.abs(this.b-t.b)<e&&Math.abs(this.a-t.a)<e}add(t){return new X(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new X(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}scale(t){return new X(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){this.r*=t,this.g*=t,this.b*=t,this.a*=t}applyGamma(t){this.set(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toLinear(t=2.2){return new X(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toGamma(t=2.2){return new X(Math.pow(this.r,1/t),Math.pow(this.g,1/t),Math.pow(this.b,1/t),this.a)}luminance(){return.2126*this.r+.7152*this.g+.0722*this.b}lerp(t,e){const i=this.r,n=this.g,s=this.b,o=this.a;return new X(i+e*(t.r-i),n+e*(t.g-n),s+e*(t.b-s),o+e*(t.a-o))}static random(t=0,e=!1){return t>0?new X(t+Math.random()*(1-t),t+Math.random()*(1-t),t+Math.random()*(1-t),e?t+Math.random()*(1-t):1):t<0?new X(Math.random()*(1+t),Math.random()*(1+t),Math.random()*(1+t),e?Math.random()*(1+t):1):new X(Math.random(),Math.random(),Math.random(),e?Math.random():1)}clone(){return new X(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}asArray(){return this.__data}as3ComponentArray(){return[this.__data[0],this.__data[1],this.__data[2]]}static create(...t){return new X(...t)}static createFromFloat32Buffer(t,e=0){return new X(t,4*e)}static numElements(){return 4}toJSON(){return{r:this.r,g:this.g,b:this.b,a:this.a}}fromJSON(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}toCSSString(){return"rgba("+Math.round(255*this.r)+", "+Math.round(255*this.g)+", "+Math.round(255*this.b)+", "+this.a+")"}}g.registerType("RGBA",X);class y$2 extends p{constructor(t=0,e=0,i=0,n=1){super(),t instanceof Float32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,4):(this.__data=new Float32Array(4),"string"==typeof t?t.startsWith("#")?this.setFromHex(t):this.setFromCSSColorName(t):(this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n))}get r(){return this.__data[0]}set r(t){this.__data[0]=t}get g(){return this.__data[1]}set g(t){this.__data[1]=t}get b(){return this.__data[2]}set b(t){this.__data[2]=t}get a(){return this.__data[3]}set a(t){this.__data[3]=t}set(t,e,i,n=1){this.r=t,this.g=e,this.b=i,this.a=n}setFromOther(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}setFromScalarArray(t){this.r=t[0],this.g=t[1],this.b=t[2],this.a=4==t.length?t[3]:1}getAsRGBArray(){return[255*this.r,255*this.g,255*this.b]}getAsRGBDict(){return{r:255*this.r,g:255*this.g,b:255*this.b}}setFromRGB(t,e,i,n){this.r=t/255,this.g=e/255,this.b=i/255,this.a=n?n/255:1}setFromRGBArray(t){this.r=t[0]/255,this.g=t[1]/255,this.b=t[2]/255,this.a=4==t.length?t[3]/255:1}setFromRGBDict(t){this.r=t.r/255,this.g=t.g/255,this.b=t.b/255,this.a=4==t.a?t.a/255:1}setFromHex(t){const e=function(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);e?this.setFromRGB(e.r,e.g,e.b):console.warn("Invalid hex code:"+t)}setFromCSSColorName(t){t.startsWith("#")?this.setFromHex(t):this.setFromHex((t=>{const e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==e[t.toLowerCase()]&&e[t.toLowerCase()]})(t))}toHex(){function t(t){const e=Math.round(255*t).toString(16);return 1==e.length?"0"+e:e}return"#"+t(this.r)+t(this.g)+t(this.b)}equal(t){return this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a}notequals(t){return this.r!=t.r&&this.g!=t.g&&this.b!=t.b&&this.a!=t.a}approxEqual(t,e=Number.EPSILON){return Math.abs(this.r-t.r)<e&&Math.abs(this.g-t.g)<e&&Math.abs(this.b-t.b)<e&&Math.abs(this.a-t.a)<e}add(t){return new y$2(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new y$2(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}scale(t){return new y$2(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){this.r*=t,this.g*=t,this.b*=t,this.a*=t}applyGamma(t){this.set(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toLinear(t=2.2){return new y$2(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toGamma(t=2.2){return new y$2(Math.pow(this.r,1/t),Math.pow(this.g,1/t),Math.pow(this.b,1/t),this.a)}luminance(){return.2126*this.r+.7152*this.g+.0722*this.b}lerp(t,e){const i=this.r,n=this.g,s=this.b,o=this.a;return new y$2(i+e*(t.r-i),n+e*(t.g-n),s+e*(t.b-s),o+e*(t.a-o))}static random(t=0,e=!1){return t>0?new y$2(t+Math.random()*(1-t),t+Math.random()*(1-t),t+Math.random()*(1-t),e?t+Math.random()*(1-t):1):t<0?new y$2(Math.random()*(1+t),Math.random()*(1+t),Math.random()*(1+t),e?Math.random()*(1+t):1):new y$2(Math.random(),Math.random(),Math.random(),e?Math.random():1)}clone(){return new y$2(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}asArray(){return this.__data}as3ComponentArray(){return[this.__data[0],this.__data[1],this.__data[2]]}static create(...t){return new y$2(...t)}static createFromFloat32Buffer(t,e=0){return new y$2(t,4*e)}static numElements(){return 4}toJSON(){return{r:this.r,g:this.g,b:this.b,a:this.a}}fromJSON(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}toCSSString(){return"rgba("+Math.round(255*this.r)+", "+Math.round(255*this.g)+", "+Math.round(255*this.b)+", "+this.a+")"}}g.registerType("Color",y$2);class f extends p{constructor(t=0,e=0,i=0,n=0){if(super(),isNaN(n))switch(n){case"XYZ":this.order=0;break;case"YZX":this.order=1;break;case"ZXY":this.order=2;break;case"XZY":this.order=3;break;case"ZYX":this.order=4;break;case"YXZ":this.order=5;break;default:throw new Error("Invalid Euler Angles Order:"+n)}else this.order=n;t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,4):(this.__data=new Float32Array(3),this.__data[0]=t,this.__data[1]=e,this.__data[2]=i)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}set(t,e,i){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i}}g.registerType("EulerAngles",f);class V extends p{constructor(t=1,e=0,i=0,n=0,s=1,o=0,r=0,a=0,l=1){super(),t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,9):(this.__data=new Float32Array(9),this.set(t,e,i,n,s,o,r,a,l))}get m00(){return this.__data[0]}set m00(t){this.__data[0]=t}get m01(){return this.__data[1]}set m01(t){this.__data[1]=t}get m02(){return this.__data[2]}set m02(t){this.__data[2]=t}get m10(){return this.__data[3]}set m10(t){this.__data[3]=t}get m11(){return this.__data[4]}set m11(t){this.__data[4]=t}get m12(){return this.__data[5]}set m12(t){this.__data[5]=t}get m20(){return this.__data[6]}set m20(t){this.__data[6]=t}get m21(){return this.__data[7]}set m21(t){this.__data[7]=t}get m22(){return this.__data[8]}set m22(t){this.__data[8]=t}get xAxis(){return Z.createFromFloat32Buffer(this.__data.buffer,0)}set xAxis(t){this.xAxis.set(t.x,t.y,t.z)}get yAxis(){return Z.createFromFloat32Buffer(this.__data.buffer,3)}set yAxis(t){this.yAxis.set(t.x,t.y,t.z)}get zAxis(){return Z.createFromFloat32Buffer(this.__data.buffer,6)}set zAxis(t){this.zAxis.set(t.x,t.y,t.z)}set(t=1,e=0,i=0,n=0,s=1,o=0,r=0,a=0,l=1){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n,this.__data[4]=s,this.__data[5]=o,this.__data[6]=r,this.__data[7]=a,this.__data[8]=l}setIdentity(){this.set()}setFromMat(t){this.__data[0]=t.m00,this.__data[1]=t.m01,this.__data[2]=t.m02,this.__data[3]=t.m10,this.__data[4]=t.m11,this.__data[5]=t.m12,this.__data[6]=t.m20,this.__data[7]=t.m21,this.__data[8]=t.m22}setFromDirectionAndUpvector(t,e){const i=t,n=i.length();if(n<Number.EPSILON)return void this.setIdentity();i.scaleInPlace(1/n);const s=e.cross(i),o=s.length();o>Number.EPSILON&&s.scaleInPlace(1/o);const r=i.cross(s),a=r.length();a>Number.EPSILON&&r.scaleInPlace(1/a),this.set(s.x,s.y,s.z,r.x,r.y,r.z,i.x,i.y,i.z)}inverse(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=l*s-o*a,h=-l*n+o*r,d=a*n-s*r,u=t*c+e*h+i*d;return u?(u=1/u,new V(c*u,(-l*e+i*a)*u,(o*e-i*s)*u,h*u,(l*t-i*r)*u,(-o*t+i*n)*u,d*u,(-a*t+e*r)*u,(s*t-e*n)*u)):(console.warn("Unable to invert Mat3"),null)}invertInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=l*s-o*a,h=-l*n+o*r,d=a*n-s*r,u=t*c+e*h+i*d;return u?(u=1/u,this.set(c*u,(-l*e+i*a)*u,(o*e-i*s)*u,h*u,(l*t-i*r)*u,(-o*t+i*n)*u,d*u,(-a*t+e*r)*u,(s*t-e*n)*u),!0):(console.warn("Unable to invert Mat3"),!1)}transpose(){return V(this.__data[0],this.__data[3],this.__data[6],this.__data[1],this.__data[4],this.__data[7],this.__data[2],this.__data[5],this.__data[8])}transposeInPlace(){const t=this.__data[1],e=this.__data[2],i=this.__data[5];this.__data[1]=this.__data[3],this.__data[2]=this.__data[6],this.__data[3]=t,this.__data[5]=this.__data[7],this.__data[6]=e,this.__data[7]=i}transformVec3(t){return new Z(this.__data[0]*t.x+this.__data[1]*t.y+this.__data[2]*t.z,this.__data[3]*t.x+this.__data[4]*t.y+this.__data[5]*t.z,this.__data[6]*t.x+this.__data[7]*t.y+this.__data[8]*t.z)}clone(){return new V(this.__data[0],this.__data[1],this.__data[2],this.__data[3],this.__data[4],this.__data[5],this.__data[6],this.__data[7],this.__data[8],this.__data[9])}static create(...t){return new V(...t)}static createFromFloat32Buffer(t,e=0){return new V(t,4*e)}toJSON(){return this.__data}fromJSON(t){this.__data=new Float32Array(t)}toString(){return this.toJSON().toString()}}g.registerType("Mat3",V);class I extends p{constructor(t=1,e=0,i=0,n=0,s=0,o=1,r=0,a=0,l=0,c=0,h=1,d=0,u=0,m=0,p=0,b=1){super(),t instanceof Float32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,16):(this.__data=new Float32Array(16),this.set(t,e,i,n,s,o,r,a,l,c,h,d,u,m,p,b))}get m00(){return this.__data[0]}set m00(t){this.__data[0]=t}get m01(){return this.__data[1]}set m01(t){this.__data[1]=t}get m02(){return this.__data[2]}set m02(t){this.__data[2]=t}get m03(){return this.__data[3]}set m03(t){this.__data[3]=t}get m10(){return this.__data[4]}set m10(t){this.__data[4]=t}get m11(){return this.__data[5]}set m11(t){this.__data[5]=t}get m12(){return this.__data[6]}set m12(t){this.__data[6]=t}get m13(){return this.__data[7]}set m13(t){this.__data[7]=t}get m20(){return this.__data[8]}set m20(t){this.__data[8]=t}get m21(){return this.__data[9]}set m21(t){this.__data[9]=t}get m22(){return this.__data[10]}set m22(t){this.__data[10]=t}get m23(){return this.__data[11]}set m23(t){this.__data[11]=t}get m30(){return this.__data[12]}set m30(t){this.__data[12]=t}get m31(){return this.__data[13]}set m31(t){this.__data[13]=t}get m32(){return this.__data[14]}set m32(t){this.__data[14]=t}get m33(){return this.__data[15]}set m33(t){this.__data[15]=t}get xAxis(){return Z.createFromFloat32Buffer(this.__data.buffer,0)}set xAxis(t){this.xAxis.set(t.x,t.y,t.z)}get yAxis(){return Z.createFromFloat32Buffer(this.__data.buffer,4)}set yAxis(t){this.yAxis.set(t.x,t.y,t.z)}get zAxis(){return Z.createFromFloat32Buffer(this.__data.buffer,8)}set zAxis(t){this.zAxis.set(t.x,t.y,t.z)}get translation(){return Z.createFromFloat32Buffer(this.__data.buffer,12)}set translation(t){this.translation.set(t.x,t.y,t.z)}set(t=1,e=0,i=0,n=0,s=0,o=1,r=0,a=0,l=0,c=0,h=1,d=0,u=0,m=0,p=0,b=1){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n,this.__data[4]=s,this.__data[5]=o,this.__data[6]=r,this.__data[7]=a,this.__data[8]=l,this.__data[9]=c,this.__data[10]=h,this.__data[11]=d,this.__data[12]=u,this.__data[13]=m,this.__data[14]=p,this.__data[15]=b}setIdentity(){this.set()}setDataArray(t){this.__data=t}setFromMat4(t){this.__data[0]=t.m00,this.__data[1]=t.m01,this.__data[2]=t.m02,this.__data[3]=t.m03,this.__data[4]=t.m10,this.__data[5]=t.m11,this.__data[6]=t.m12,this.__data[7]=t.m13,this.__data[8]=t.m20,this.__data[9]=t.m21,this.__data[10]=t.m22,this.__data[11]=t.m23,this.__data[12]=t.m30,this.__data[13]=t.m31,this.__data[14]=t.m32,this.__data[15]=t.m33}toMat3(t){return new V(this.__data[0],this.__data[1],this.__data[2],this.__data[4],this.__data[5],this.__data[6],this.__data[8],this.__data[9],this.__data[10])}transposeInPlace(){const t=this.__data[1],e=this.__data[2],i=this.__data[3],n=this.__data[6],s=this.__data[7],o=this.__data[11];this.__data[1]=this.__data[4],this.__data[2]=this.__data[8],this.__data[3]=this.__data[12],this.__data[4]=t,this.__data[6]=this.__data[9],this.__data[7]=this.__data[13],this.__data[8]=e,this.__data[9]=n,this.__data[11]=this.__data[14],this.__data[12]=i,this.__data[13]=s,this.__data[14]=o}transpose(){return new I(this.__data[0],this.__data[4],this.__data[8],this.__data[12],this.__data[1],this.__data[5],this.__data[9],this.__data[13],this.__data[2],this.__data[6],this.__data[10],this.__data[14],this.__data[3],this.__data[7],this.__data[11],this.__data[15])}inverse(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=this.__data[9],h=this.__data[10],d=this.__data[11],u=this.__data[12],m=this.__data[13],p=this.__data[14],b=this.__data[15],f=t*o-e*s,g=t*r-i*s,y=t*a-n*s,v=e*r-i*o,Z=e*a-n*o,x=i*a-n*r,G=l*m-c*u,X=l*p-h*u,w=l*b-d*u,V=c*p-h*m,S=c*b-d*m,R=h*b-d*p;let k=f*R-g*S+y*V+v*w-Z*X+x*G;return k?(k=1/k,new I((o*R-r*S+a*V)*k,(i*S-e*R-n*V)*k,(m*x-p*Z+b*v)*k,(h*Z-c*x-d*v)*k,(r*w-s*R-a*X)*k,(t*R-i*w+n*X)*k,(p*y-u*x-b*g)*k,(l*x-h*y+d*g)*k,(s*S-o*w+a*G)*k,(e*w-t*S-n*G)*k,(u*Z-m*y+b*f)*k,(c*y-l*Z-d*f)*k,(o*X-s*V-r*G)*k,(t*V-e*X+i*G)*k,(m*g-u*v-p*f)*k,(l*v-c*g+h*f)*k)):(console.warn("Unable to invert Mat4"),null)}invertInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=this.__data[9],h=this.__data[10],d=this.__data[11],u=this.__data[12],m=this.__data[13],p=this.__data[14],b=this.__data[15],f=t*o-e*s,g=t*r-i*s,y=t*a-n*s,v=e*r-i*o,Z=e*a-n*o,x=i*a-n*r,G=l*m-c*u,X=l*p-h*u,w=l*b-d*u,V=c*p-h*m,I=c*b-d*m,S=h*b-d*p;let R=f*S-g*I+y*V+v*w-Z*X+x*G;return R?(R=1/R,this.set((o*S-r*I+a*V)*R,(i*I-e*S-n*V)*R,(m*x-p*Z+b*v)*R,(h*Z-c*x-d*v)*R,(r*w-s*S-a*X)*R,(t*S-i*w+n*X)*R,(p*y-u*x-b*g)*R,(l*x-h*y+d*g)*R,(s*I-o*w+a*G)*R,(e*w-t*I-n*G)*R,(u*Z-m*y+b*f)*R,(c*y-l*Z-d*f)*R,(o*X-s*V-r*G)*R,(t*V-e*X+i*G)*R,(m*g-u*v-p*f)*R,(l*v-c*g+h*f)*R),!0):(console.warn("Unable to invert Mat4"),!1)}setInverse(t){const e=t.__data[0],i=t.__data[1],n=t.__data[2],s=t.__data[3],o=t.__data[4],r=t.__data[5],a=t.__data[6],l=t.__data[7],c=t.__data[8],h=t.__data[9],d=t.__data[10],u=t.__data[11],m=t.__data[12],p=t.__data[13],b=t.__data[14],f=t.__data[15],g=e*r-i*o,y=e*a-n*o,v=e*l-s*o,Z=i*a-n*r,x=i*l-s*r,G=n*l-s*a,X=c*p-h*m,w=c*b-d*m,V=c*f-u*m,I=h*b-d*p,S=h*f-u*p,R=d*f-u*b;let k=g*R-y*S+v*I+Z*V-x*w+G*X;if(!k)throw new Error("Unable to invert Mat4");k=1/k,this.set((r*R-a*S+l*I)*k,(n*S-i*R-s*I)*k,(p*G-b*x+f*Z)*k,(d*x-h*G-u*Z)*k,(a*V-o*R-l*w)*k,(e*R-n*V+s*w)*k,(b*v-m*G-f*y)*k,(c*G-d*v+u*y)*k,(o*S-r*V+l*X)*k,(i*V-e*S-s*X)*k,(m*x-p*v+f*g)*k,(h*v-c*x-u*g)*k,(r*w-o*I-a*X)*k,(e*I-i*w+n*X)*k,(p*y-m*Z-b*g)*k,(c*Z-h*y+d*g)*k)}multiply(t){const e=this.__data[0],i=this.__data[1],n=this.__data[2],s=this.__data[3],o=this.__data[4],r=this.__data[5],a=this.__data[6],l=this.__data[7],c=this.__data[8],h=this.__data[9],d=this.__data[10],u=this.__data[11],m=this.__data[12],p=this.__data[13],b=this.__data[14],f=this.__data[15],g=t.asArray();let y=g[0],v=g[1],Z=g[2],x=g[3];const G=new I;return G.m00=y*e+v*o+Z*c+x*m,G.m01=y*i+v*r+Z*h+x*p,G.m02=y*n+v*a+Z*d+x*b,G.m03=y*s+v*l+Z*u+x*f,y=g[4],v=g[5],Z=g[6],x=g[7],G.m10=y*e+v*o+Z*c+x*m,G.m11=y*i+v*r+Z*h+x*p,G.m12=y*n+v*a+Z*d+x*b,G.m13=y*s+v*l+Z*u+x*f,y=g[8],v=g[9],Z=g[10],x=g[11],G.m20=y*e+v*o+Z*c+x*m,G.m21=y*i+v*r+Z*h+x*p,G.m22=y*n+v*a+Z*d+x*b,G.m23=y*s+v*l+Z*u+x*f,y=g[12],v=g[13],Z=g[14],x=g[15],G.m30=y*e+v*o+Z*c+x*m,G.m31=y*i+v*r+Z*h+x*p,G.m32=y*n+v*a+Z*d+x*b,G.m33=y*s+v*l+Z*u+x*f,G}multiplyInPlace(t){const e=this.asArray(),i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],u=e[10],m=e[11],p=e[12],b=e[13],f=e[14],g=e[15],y=t.asArray();let v=y[0],Z=y[1],x=y[2],G=y[3];return this.m00=v*i+Z*r+x*h+G*p,this.m01=v*n+Z*a+x*d+G*b,this.m02=v*s+Z*l+x*u+G*f,this.m03=v*o+Z*c+x*m+G*g,v=y[4],Z=y[5],x=y[6],G=y[7],this.m10=v*i+Z*r+x*h+G*p,this.m11=v*n+Z*a+x*d+G*b,this.m12=v*s+Z*l+x*u+G*f,this.m13=v*o+Z*c+x*m+G*g,v=y[8],Z=y[9],x=y[10],G=y[11],this.m20=v*i+Z*r+x*h+G*p,this.m21=v*n+Z*a+x*d+G*b,this.m22=v*s+Z*l+x*u+G*f,this.m23=v*o+Z*c+x*m+G*g,v=y[12],Z=y[13],x=y[14],G=y[15],this.m30=v*i+Z*r+x*h+G*p,this.m31=v*n+Z*a+x*d+G*b,this.m32=v*s+Z*l+x*u+G*f,this.m33=v*o+Z*c+x*m+G*g,this}postmultiplyInPlace(t){const e=t.asArray(),i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],u=e[10],m=e[11],p=e[12],b=e[13],f=e[14],g=e[15],y=this.asArray();let v=y[0],Z=y[1],x=y[2],G=y[3];return this.m00=v*i+Z*r+x*h+G*p,this.m01=v*n+Z*a+x*d+G*b,this.m02=v*s+Z*l+x*u+G*f,this.m03=v*o+Z*c+x*m+G*g,v=y[4],Z=y[5],x=y[6],G=y[7],this.m10=v*i+Z*r+x*h+G*p,this.m11=v*n+Z*a+x*d+G*b,this.m12=v*s+Z*l+x*u+G*f,this.m13=v*o+Z*c+x*m+G*g,v=y[8],Z=y[9],x=y[10],G=y[11],this.m20=v*i+Z*r+x*h+G*p,this.m21=v*n+Z*a+x*d+G*b,this.m22=v*s+Z*l+x*u+G*f,this.m23=v*o+Z*c+x*m+G*g,v=y[12],Z=y[13],x=y[14],G=y[15],this.m30=v*i+Z*r+x*h+G*p,this.m31=v*n+Z*a+x*d+G*b,this.m32=v*s+Z*l+x*u+G*f,this.m33=v*o+Z*c+x*m+G*g,this}translateInPlace(t){const e=this.__data,i=t.x,n=t.y,s=t.z;return e[12]=e[0]*i+e[4]*n+e[8]*s+e[12],e[13]=e[1]*i+e[5]*n+e[9]*s+e[13],e[14]=e[2]*i+e[6]*n+e[10]*s+e[14],e[15]=e[3]*i+e[7]*n+e[11]*s+e[15],this}setLookAt(t,e,i){const n=t.subtract(e),s=n.length();if(s<Number.EPSILON)return void this.setIdentity();n.scaleInPlace(1/s);const o=i.cross(n),r=o.length();r>Number.EPSILON&&o.scaleInPlace(1/r);const a=n.cross(o),l=a.length();l>Number.EPSILON&&a.scaleInPlace(1/l),this.set(o.x,o.y,o.z,0,a.x,a.y,a.z,0,n.x,n.y,n.z,0,t.x,t.y,t.z,1)}setRotation(t,e){const i=t.length();if(Math.abs(i)<Number.EPSILON)return null;const n=t.x/i,s=t.y/i,o=t.z/i,r=Math.sin(e),a=Math.cos(e),l=1-a,c=this.__data;return c[0]=n*n*l+a,c[1]=s*n*l+o*r,c[2]=o*n*l-s*r,c[3]=0,c[4]=n*s*l-o*r,c[5]=s*s*l+a,c[6]=o*s*l+n*r,c[7]=0,c[8]=n*o*l+s*r,c[9]=s*o*l-n*r,c[10]=o*o*l+a,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}setXRotation(t){const e=Math.sin(t),i=Math.cos(t),n=this.__data;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=e,n[7]=0,n[8]=0,n[9]=-e,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}setYRotation(t){const e=Math.sin(t),i=Math.cos(t),n=this.__data;return n[0]=i,n[1]=0,n[2]=-e,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=e,n[9]=0,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}setZRotation(t){const e=Math.sin(t),i=Math.cos(t),n=this.__data;return n[0]=i,n[1]=e,n[2]=0,n[3]=0,n[4]=-e,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}transformVec4(t){const e=this.__data,i=t.x,n=t.y,s=t.z,o=t.t;return new Vec4(e[0]*i+e[4]*n+e[8]*s+e[12]*o,e[1]*i+e[5]*n+e[9]*s+e[13]*o,e[2]*i+e[6]*n+e[10]*s+e[14]*o,e[3]*i+e[7]*n+e[11]*s+e[15]*o)}transformVec3(t){const e=this.__data,i=t.x,n=t.y,s=t.z;return new Z(e[0]*i+e[4]*n+e[8]*s+e[12],e[1]*i+e[5]*n+e[9]*s+e[13],e[2]*i+e[6]*n+e[10]*s+e[14])}rotateVec3(t){const e=this.__data,i=t.x,n=t.y,s=t.z;return new Z(e[0]*i+e[4]*n+e[8]*s,e[1]*i+e[5]*n+e[9]*s,e[2]*i+e[6]*n+e[10]*s)}setPerspectiveMatrix(t,e,i,n){const s=Math.tan(.5*Math.PI-.5*t),o=1/(i-n);this.set(s/e,0,0,0,0,s,0,0,0,0,(i+n)*o,-1,0,0,i*n*o*2,0)}setOrthographicMatrix(t,e,i,n,s,o){const r=1/(t-e),a=1/(i-n),l=1/(s-o);this.set(-2*r,0,0,0,0,-2*a,0,0,0,0,2*l,0,(t+e)*r,(n+i)*a,(o+s)*l,1)}setScale(t,e,i){t instanceof Z?this.set(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1):this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1)}setFromMat3x4Array(t){this.set(t[0],t[1],t[2],0,t[3],t[4],t[5],0,t[6],t[7],t[8],0,t[9],t[10],t[11],1)}static createFromFloat32Buffer(t,e=0){return new I(t,4*e)}clone(){return new I(this.__data[0],this.__data[1],this.__data[2],this.__data[3],this.__data[4],this.__data[5],this.__data[6],this.__data[7],this.__data[8],this.__data[9],this.__data[10],this.__data[11],this.__data[12],this.__data[13],this.__data[14],this.__data[15])}static create(...t){return new I(...t)}toJSON(){return this.__data}fromJSON(t){this.__data=new Float32Array(t)}}g.registerType("Mat4",I);class x extends p{constructor(t=0,e=0,i=0,n=1){if(super(),t instanceof ArrayBuffer)this.__data=new Float32Array(t,e,4);else if(this.__data=new Float32Array(4),"object"==typeof t){this.__data[0]=0,this.__data[1]=0,this.__data[2]=0,this.__data[3]=1;for(const e in t)Array.isArray(t[e])?this[e].call(this,...t[e]):this[e].call(this,t[e])}else this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}get w(){return this.__data[3]}set w(t){this.__data[3]=t}set(t,e,i,n){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n}setDataArray(t){this.__data=t}setFromOther(t){this.__data[0]=t.x,this.__data[1]=t.y,this.__data[2]=t.z,this.__data[3]=t.w}setFromEulerAngles(t){const e=new Z;switch(t.order){case 0:e.set(t.x,-t.y,t.z);break;case 1:e.set(t.y,-t.z,t.x);break;case 2:e.set(t.z,-t.x,t.y);break;case 3:e.set(t.x,t.z,t.y);break;case 4:e.set(t.z,t.y,t.x);break;case 5:e.set(t.y,t.x,t.z);break;default:throw new Error("sdrty")}const i=.5*e.x,n=.5*e.y,s=.5*e.z,o=Math.cos(i),r=Math.cos(n),a=Math.cos(s),l=Math.sin(i),c=Math.sin(n),h=Math.sin(s),d=o*a,u=o*h,m=l*a,p=l*h,b=r*m-c*u,f=r*p+c*d,g=r*u-c*m;switch(this.w=r*d+c*p,t.order){case 0:this.x=b,this.y=-f,this.z=g;break;case 1:this.x=g,this.y=b,this.z=-f;break;case 2:this.x=-f,this.y=g,this.z=b;break;case 3:this.x=b,this.y=g,this.z=f;break;case 4:this.x=g,this.y=f,this.z=b;break;case 5:this.x=f,this.y=b,this.z=g;break;default:throw new Error("sdrty")}}toEulerAngles(t){const e=new Z;switch(t){case 0:e.set(this.z,this.x,this.y);break;case 1:e.set(this.x,this.y,this.z);break;case 2:e.set(this.y,this.z,this.x);break;case 3:e.set(this.y,-this.x,this.z);break;case 4:e.set(this.x,-this.z,this.y);break;case 5:e.set(this.z,-this.y,this.x);break;default:throw new Error("Invalid rotation order:"+t)}const i=new Z,n=e.x*e.y+e.z*this.w;if(n>.49999)i.y=2*Math.atan2(e.x,this.w),i.z=.5*Math.PI,i.x=0;else if(n<-.49999)i.y=-2*Math.atan2(e.x,this.w),i.z=-.5*Math.PI,i.x=0;else{const t=e.x*e.x,s=e.z*e.z;i.y=Math.atan2(2*e.y*this.w-2*e.x*e.z,1-e.y*e.y*2-2*s),i.z=Math.asin(2*n),i.x=Math.atan2(2*e.x*this.w-2*e.y*e.z,1-2*t-2*s)}switch(t){case 0:return new f(i.y,i.z,i.x,t);case 1:return new f(i.x,i.y,i.z,t);case 2:return new f(i.z,i.x,i.y,t);case 3:return new f(-i.y,i.x,i.z,t);case 4:return new f(i.x,i.z,-i.y,t);case 5:return new f(i.z,-i.y,i.x,t)}}setFromAxisAndAngle(t,e){const i=e/2,n=t.normalize().scale(Math.sin(i));this.set(n.x,n.y,n.z,Math.cos(i))}setFromDirectionAndUpvector(t,e){const i=new V;i.setFromDirectionAndUpvector(t,e),this.setFromMat3(i)}setFrom2Vectors(t,e){t.normalize(),e.normalize();const i=t.cross(e),n=t.dot(e),s=Math.sqrt(2*(1+n));this.set(i.x/s,i.y/s,i.z/s,s/2),this.normalizeInPlace()}setFromMat3(t){const e=t.__data[0]+t.__data[4]+t.__data[8];let i;if(e>0)i=Math.sqrt(e+1),this.__data[3]=.5*i,i=.5/i,this.__data[0]=(t.__data[5]-t.__data[7])*i,this.__data[1]=(t.__data[6]-t.__data[2])*i,this.__data[2]=(t.__data[1]-t.__data[3])*i;else{let e=0;t.__data[4]>t.__data[0]&&(e=1),t.__data[8]>t.__data[3*e+e]&&(e=2);const n=(e+1)%3,s=(e+2)%3;i=Math.sqrt(t.__data[3*e+e]-t.__data[3*n+n]-t.__data[3*s+s]+1),this.__data[e]=.5*i,i=.5/i,this.__data[3]=(t.__data[3*n+s]-t.__data[3*s+n])*i,this.__data[n]=(t.__data[3*n+e]+t.__data[3*e+n])*i,this.__data[s]=(t.__data[3*s+e]+t.__data[3*e+s])*i}this.normalizeInPlace()}setFromMat4(t){const e=t.__data[0]+t.__data[5]+t.__data[10];let i;if(e>0)i=Math.sqrt(e+1),this.__data[3]=.5*i,i=.5/i,this.__data[0]=(t.__data[6]-t.__data[9])*i,this.__data[1]=(t.__data[8]-t.__data[2])*i,this.__data[2]=(t.__data[1]-t.__data[4])*i;else{let e=0;t.__data[5]>t.__data[0]&&(e=1),t.__data[10]>t.__data[4*e+e]&&(e=2);const n=(e+1)%3,s=(e+2)%3;i=Math.sqrt(t.__data[4*e+e]-t.__data[4*n+n]-t.__data[4*s+s]+1),this.__data[e]=.5*i,i=.5/i,this.__data[3]=(t.__data[4*n+s]-t.__data[4*s+n])*i,this.__data[n]=(t.__data[4*n+e]+t.__data[4*e+n])*i,this.__data[s]=(t.__data[4*s+e]+t.__data[4*e+s])*i}this.normalizeInPlace()}isIdentity(){return this.getAngle()<Number.EPSILON}getAngle(){return 2*Math.acos(this.w)}equal(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.w==t.w}notequals(t){return this.x!=t.x&&this.y!=t.y&&this.z!=t.z&&this.w!=t.w}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&Math.abs(this.w-t.w)<e}add(t){return new x(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addInPlace(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w}subtract(t){return new x(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}scale(t){return new x(this.x*t,this.y*t,this.z*t,this.w*t)}scaleInPlace(t){this.x*=t,this.y*=t,this.z*=t,this.w*=t}length(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];return Math.sqrt(t*t+e*e+i*i+n*n)}lengthSquared(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];return t*t+e*e+i*i+n*n}normalize(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;return s<Number.EPSILON?new x:(s=1/Math.sqrt(s),new x(t*s,e*s,i*s))}normalizeInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;s<Number.EPSILON||(s=1/Math.sqrt(s),this.set(t*s,e*s,i*s,n*s))}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}cross(t){const e=this.x,i=this.y,n=this.z,s=this.w,o=t.x,r=t.y,a=t.z,l=t.w;return new x(i*a-n*r,n*l-s*a,s*o-e*l,e*r-i*o)}conjugate(){return new x(-this.x,-this.y,-this.z,this.w)}inverse(){return this.conjugate()}alignWith(t){this.dot(t)<0&&this.set(-this.x,-this.y,-this.z,-this.w)}multiply(t){const e=this.__data[0],i=this.__data[1],n=this.__data[2],s=this.__data[3],o=t.__data[0],r=t.__data[1],a=t.__data[2],l=t.__data[3];return new x(e*l+s*o+i*a-n*r,i*l+s*r+n*o-e*a,n*l+s*a+e*r-i*o,s*l-e*o-i*r-n*a)}multiplyInPlace(t){const e=this.__data[0],i=this.__data[1],n=this.__data[2],s=this.__data[3],o=t.__data[0],r=t.__data[1],a=t.__data[2],l=t.__data[3];this.set(e*l+s*o+i*a-n*r,i*l+s*r+n*o-e*a,n*l+s*a+e*r-i*o,s*l-e*o-i*r-n*a)}rotateVec3(t){const e=new x(t.x,t.y,t.z,0),i=this.multiply(e).multiply(this.conjugate());return new Z(i.x,i.y,i.z)}rotateX(t){t*=.5;const e=this.x,i=this.y,n=this.z,s=this.w,o=Math.sin(t),r=Math.cos(t);this.x=e*r+s*o,this.y=i*r+n*o,this.z=n*r-i*o,this.w=s*r-e*o}rotateY(t){t*=.5;const e=this.x,i=this.y,n=this.z,s=this.w,o=Math.sin(t),r=Math.cos(t);this.x=e*r-n*o,this.y=i*r+s*o,this.z=n*r+e*o,this.w=s*r-i*o}rotateZ(t){t*=.5;const e=this.x,i=this.y,n=this.z,s=this.w,o=Math.sin(t),r=Math.cos(t);this.x=e*r+i*o,this.y=i*r-e*o,this.z=n*r+s*o,this.w=s*r-n*o}toMat3(){const t=this.x,e=this.y,i=this.z,n=this.w,s=t+t,o=e+e,r=i+i,a=t*s,l=e*s,c=e*o,h=i*s,d=i*o,u=i*r,m=n*s,p=n*o,b=n*r,f=new V;return f.__data[0]=1-c-u,f.__data[3]=l-b,f.__data[6]=h+p,f.__data[1]=l+b,f.__data[4]=1-a-u,f.__data[7]=d-m,f.__data[2]=h-p,f.__data[5]=d+m,f.__data[8]=1-a-c,f}getXaxis(){return new Z(1-2*(this.z*this.z+this.y*this.y),2*(this.x*this.y+this.z*this.w),2*(this.x*this.z-this.y*this.w))}getYaxis(){return new Z(2*(this.x*this.y-this.z*this.w),1-2*(this.z*this.z+this.x*this.x),2*(this.y*this.z+this.x*this.w))}getZaxis(){const t=this.x*this.x,e=this.x*this.z,i=this.x*this.w,n=this.y*this.y,s=this.y*this.z,o=this.y*this.w;return new Z,new Z(2*(o+e),2*(s-i),1-2*(n+t))}mirror(t){switch(t){case 0:return new x(this.z,this.w,this.x,this.y);case 1:return new x(-this.w,this.z,this.y,-this.x);case 2:return new x(this.x,this.y,this.z,-this.w)}}toMat4(){const t=this.x,e=this.y,i=this.z,n=this.w,s=t+t,o=e+e,r=i+i,a=t*s,l=e*s,c=e*o,h=i*s,d=i*o,u=i*r,m=n*s,p=n*o,b=n*r,f=new I;return f.__data[0]=1-c-u,f.__data[4]=l-b,f.__data[8]=h+p,f.__data[1]=l+b,f.__data[5]=1-a-u,f.__data[9]=d-m,f.__data[2]=h-p,f.__data[6]=d+m,f.__data[10]=1-a-c,f}lerp(t,e){const i=new x(this.x+e*(t.x-this.x),this.y+e*(t.y-this.y),this.z+e*(t.z-this.z),this.w+e*(t.w-this.w));return i.normalizeInPlace(),i}static create(...t){return new x(...t)}static createFromFloat32Buffer(t,e=0){return new x(t,4*e)}static numElements(){return 4}clone(){return new x(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}toJSON(){return{x:this.x,y:this.y,z:this.z,w:this.w}}fromJSON(t){this.__data[0]=t.x,this.__data[1]=t.y,this.__data[2]=t.z,this.__data[3]=t.w,this.normalizeInPlace()}}g.registerType("Quat",x);class R{constructor(t,e){this.start=t instanceof Z?t:new Z,this.dir=e instanceof Z?e:new Z}closestPoint(t){const e=t.subtract(this.start).dot(this.dir);if(e<Number.EPSILON)return this.start;const i=e/this.dir.dot(this.dir);return this.start.add(this.dir.scale(i))}pointAtDist(t){return this.start.add(this.dir.scale(t))}intersectRayVector(t){const e=this.dir,i=t.dir,n=this.start.subtract(t.start),s=e.dot(e),o=e.dot(i),r=i.dot(i),a=e.dot(n),l=i.dot(n);if(0==s&&0==r)return this.start.distanceTo(t.start);if(0==s)return t.closestPoint(this.start);if(0==r)return this.closestPoint(t.start);const c=s*r-o*o;let h,d;return c<.001?(h=0,d=o>r?a/o:l/r):(h=(o*l-r*a)/c,d=(s*l-o*a)/c),[h,d]}intersectRayPlane(t){const e=this.start.subtract(t.start),i=t.dir.dot(this.dir),n=-t.dir.dot(e);if(Math.abs(i)<Number.PRECISION)return-1;const s=n/i;return s<-Number.PRECISION?-1:s}clone(){return new R(this.start.clone(),this.dir.clone())}static create(...t){return new R(...t)}toJSON(){return{start:this.start,dir:this.dir}}fromJSON(t){this.start.fromJSON(t.start),this.dir.fromJSON(t.dir)}toString(){return u(this.toJSON())}}g.registerType("Ray",R),new Z(1,1,1);class S{constructor(t,e,i){if(t instanceof Float32Array)this.setFromFloat32Array(t);else{if(t instanceof Z)this.tr=t;else{if(t instanceof x&&null==e&&null==i)return this.tr=new Z,this.ori=t,void(this.sc=new Z(1,1,1));this.tr=new Z}this.ori=e instanceof x?e:new x,this.sc=i instanceof Z?i:new Z(1,1,1)}}set(t,e,i){this.tr=t,this.ori=e,i instanceof Z&&(this.sc=i)}setFromOther(t){this.tr=t.tr,this.ori=t.ori,this.sc=t.sc}isIdentity(){return this.tr.isNull()&&this.ori.isIdentity()&&this.sc.is111()}setLookAt(t,e,i){const n=t.subtract(e);if(n.length()<Number.EPSILON)throw new Error("Invalid dir");this.ori.setFromDirectionAndUpvector(n,i),this.tr=t}multiply(t){let e=this.sc;return this.sc.x==this.sc.y&&this.sc.x==this.sc.z||(e=t.ori.rotateVec3(this.sc),Math.sign(e.x)!=Math.sign(this.sc.x)&&(e.x=-e.x),Math.sign(e.y)!=Math.sign(this.sc.y)&&(e.y=-e.y),Math.sign(e.z)!=Math.sign(this.sc.z)&&(e.z=-e.z)),new S(this.tr.add(this.ori.rotateVec3(e.multiply(t.tr))),this.ori.multiply(t.ori),e.multiply(t.sc))}inverse(){const t=new S;return t.ori=this.ori.inverse(),this.sc.x!=this.sc.y||this.sc.x!=this.sc.z?(t.sc=t.ori.rotateVec3(this.sc),Math.sign(t.sc.x)!=Math.sign(this.sc.x)&&(t.sc.x=-t.sc.x),Math.sign(t.sc.y)!=Math.sign(this.sc.y)&&(t.sc.y=-t.sc.y),Math.sign(t.sc.z)!=Math.sign(this.sc.z)&&(t.sc.z=-t.sc.z)):t.sc=this.sc.inverse(),t.tr=t.ori.rotateVec3(this.tr.negate().multiply(t.sc)),t}transformVec3(t){return this.tr.add(this.ori.rotateVec3(this.sc.multiply(t)))}toMat4(){const t=new I(this.sc.x,0,0,0,0,this.sc.y,0,0,0,0,this.sc.z,0,0,0,0,1),e=this.ori.toMat4(),i=new I;return i.translation=this.tr,i.multiply(e).multiply(t)}fromMat4(t){this.tr=t.translation,this.ori.setFromMat4(t)}setFromFloat32Array(t){if(7==t.length)return this.tr=new Z(t.buffer,t.byteOffset),this.ori=new x(t.buffer,t.byteOffset+12),void(this.sc=new Z(1,1,1));if(8!=t.length)return 10==t.length?(this.tr=new Z(t.buffer,t.byteOffset),this.ori=new x(t.buffer,t.byteOffset+12),void(this.sc=new Z(t.buffer,t.byteOffset+21))):void 0;{this.tr=new Z(t.buffer,t.byteOffset),this.ori=new x(t.buffer,t.byteOffset+12);const e=t[7];this.sc=new Z(e,e,e)}}clone(){return new S(this.tr.clone(),this.ori.clone(),this.sc.clone())}static create(...t){return new S(...t)}toJSON(){const t={tr:this.tr.toJSON(),ori:this.ori.toJSON()};return this.sc.is111()||(t.sc=this.sc.toJSON()),t}fromJSON(t){this.tr.fromJSON(t.tr),this.ori.fromJSON(t.ori),t.sc&&this.sc.fromJSON(t.sc)}toString(){return u(this.toJSON())}}g.registerType("Xfo",S);class L{constructor(t,e){this.p0=t instanceof _?t:new _(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.p1=e instanceof _?e:new _(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY)}set(t,e){this.p0=t,this.p1=e}reset(){this.p0.x=Number.POSITIVE_INFINITY,this.p1.x=Number.NEGATIVE_INFINITY,this.p0.y=Number.POSITIVE_INFINITY,this.p1.y=Number.NEGATIVE_INFINITY}isValid(){return this.p0.x!=Number.POSITIVE_INFINITY&&this.p1.x!=Number.NEGATIVE_INFINITY&&this.p0.y!=Number.POSITIVE_INFINITY&&this.p1.y!=Number.NEGATIVE_INFINITY}addPoint(t){(this.p0.x==Number.POSITIVE_INFINITY||t.x<this.p0.x)&&(this.p0.x=t.x),(this.p0.y==Number.POSITIVE_INFINITY||t.y<this.p0.y)&&(this.p0.y=t.y),(this.p1.y==Number.NEGATIVE_INFINITY||t.x>this.p1.x)&&(this.p1.x=t.x),(this.p1.y==Number.NEGATIVE_INFINITY||t.y>this.p1.y)&&(this.p1.y=t.y)}size(){return this.p1.subtract(this.p0)}diagonal(){return this.p1.subtract(this.p0)}center(){const t=this.p1.subtract(this.p0);return t.scaleInPlace(.5),t.addInPlace(this.p0),t}static create(...t){return new L(...t)}toJSON(){return{p0:this.p0.toJSON(),p1:this.p1.toJSON()}}toString(){return u(this.toJSON())}}g.registerType("Box2",L);class W extends p{constructor(t,e=0){super(),this.pos=t instanceof Z?t:new Z,this.radius=e}clone(){return new Sphere(this.pos.clone(),this.radius)}intersectsBox(t){return t.intersectsSphere(this)}static create(...t){return new Sphere(...t)}toJSON(){return{pos:this.pos.toJSON(),radius:this.radius}}toString(){return u(this.toJSON())}}g.registerType("SphereType",W);class v{constructor(t,e){t instanceof Float32Array?this.setFromFloat32Array(t):(this.p0=t instanceof Z?t:new Z(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.p1=e instanceof Z?e:new Z(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY))}get min(){return this.p0}get max(){return this.p1}set(t,e){this.p0=t,this.p1=e}reset(){this.p0.x=Number.POSITIVE_INFINITY,this.p1.x=Number.NEGATIVE_INFINITY,this.p0.y=Number.POSITIVE_INFINITY,this.p1.y=Number.NEGATIVE_INFINITY,this.p0.z=Number.POSITIVE_INFINITY,this.p1.z=Number.NEGATIVE_INFINITY}isValid(){return this.p0.x!=Number.POSITIVE_INFINITY&&this.p1.x!=Number.NEGATIVE_INFINITY&&this.p0.y!=Number.POSITIVE_INFINITY&&this.p1.y!=Number.NEGATIVE_INFINITY&&this.p0.z!=Number.POSITIVE_INFINITY&&this.p1.z!=Number.NEGATIVE_INFINITY}addPoint(t){t.x!=Number.POSITIVE_INFINITY&&t.x!=Number.NEGATIVE_INFINITY&&(t.x<this.p0.x&&(this.p0.x=t.x),t.x>this.p1.x&&(this.p1.x=t.x)),t.y!=Number.POSITIVE_INFINITY&&t.y!=Number.NEGATIVE_INFINITY&&(t.y<this.p0.y&&(this.p0.y=t.y),t.y>this.p1.y&&(this.p1.y=t.y)),t.z!=Number.POSITIVE_INFINITY&&t.z!=Number.NEGATIVE_INFINITY&&(t.z<this.p0.z&&(this.p0.z=t.z),t.z>this.p1.z&&(this.p1.z=t.z))}addBox3(t,e){e?(this.addPoint(e.transformVec3(t.p0)),this.addPoint(e.transformVec3(new Z(t.p0.x,t.p0.y,t.p1.z))),this.addPoint(e.transformVec3(new Z(t.p0.x,t.p1.y,t.p0.z))),this.addPoint(e.transformVec3(new Z(t.p1.x,t.p0.y,t.p0.z))),this.addPoint(e.transformVec3(new Z(t.p0.x,t.p1.y,t.p1.z))),this.addPoint(e.transformVec3(new Z(t.p1.x,t.p0.y,t.p1.z))),this.addPoint(e.transformVec3(new Z(t.p1.x,t.p1.y,t.p0.z))),this.addPoint(e.transformVec3(t.p1))):(this.addPoint(t.p0),this.addPoint(t.p1))}size(){return this.p1.subtract(this.p0)}diagonal(){return this.p1.subtract(this.p0)}center(){const t=this.p1.subtract(this.p0);return t.scaleInPlace(.5),t.addInPlace(this.p0),t}toMat4(){return new I(this.p1.x-this.p0.x,0,0,0,0,this.p1.y-this.p0.y,0,0,0,0,this.p1.z-this.p0.z,0,this.p0.x,this.p0.y,this.p0.z,1)}getBoundingSphere(){return new W(this.center(),.5*this.diagonal().length())}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return closestPoint.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}clone(){return new v(this.p0.clone(),this.p1.clone())}static create(...t){return new v(...t)}static sizeInBytes(){return 24}toJSON(){return{p0:this.p0.toJSON(),p1:this.p1.toJSON()}}fromJSON(t){this.p0.fromJSON(t.p0),this.p1.fromJSON(t.p1)}loadBin(t,e){this.p0.loadBin(t,e),this.p0.loadBin(t,e+12)}setFromFloat32Array(t){this.p0=new Z(t.buffer,t.byteOffset),this.p1=new Z(t.buffer,t.byteOffset+12)}toString(){return u(this.toJSON())}}g.registerType("Box3",v);class T extends p{constructor(t,e=0){super(),this.normal=t instanceof Z?t:new Z,this.w=e}set(t,e,i,n){this.normal.set(t,e,i),this.w=n}divideScalar(t){this.normal.scaleInPlace(1/t),this.w/=t}distanceToPoint(t){return t.dot(this.normal)+this.w}normalizeInPlace(){const t=1/this.normal.length();this.normal.scaleInPlace(t),this.w*=t}clone(){return new Plane(this.normal.clone(),this.w)}static create(...t){return new Plane(...t)}toJSON(){return{normal:this.normal.toJSON(),w:this.w}}toString(){return u(this.toJSON())}}g.registerType("PlaneType",T);class F{constructor(t,e,i,n,s,o){this.planes=[t||new T,e||new T,i||new T,n||new T,s||new T,o||new T]}setFromMatrix(t){const e=t,i=this.planes;i[0].set(e.m03-e.m00,e.m13-e.m10,e.m23-e.m20,e.m33-e.m30),i[1].set(e.m03+e.m00,e.m13+e.m10,e.m23+e.m20,e.m33+e.m30),i[2].set(e.m03+e.m01,e.m13+e.m11,e.m23+e.m21,e.m33+e.m31),i[3].set(e.m03-e.m01,e.m13-e.m11,e.m23-e.m21,e.m33-e.m31),i[4].set(e.m03-e.m02,e.m13-e.m12,e.m23-e.m22,e.m33-e.m32),i[5].set(e.m03+e.m02,e.m13+e.m12,e.m23+e.m22,e.m33+e.m32),i.forEach(t=>t.normalizeInPlace())}intersectsBox(t){const e=new Z,i=this.planes,{min:n,max:s}=t;for(let o=0;o<6;o++){const t=i[o];if(e.x=t.normal.x>0?s.x:n.x,e.y=t.normal.y>0?s.y:n.y,e.z=t.normal.z>0?s.z:n.z,t.distanceToPoint(e)<0)return!1}return!0}toJSON(){return{p0:this.p0.toJSON(),p1:this.p1.toJSON(),p2:this.p2.toJSON(),p3:this.p3.toJSON(),p4:this.p4.toJSON(),p5:this.p5.toJSON()}}fromJSON(t){this.p0.fromJSON(t.p0),this.p1.fromJSON(t.p1),this.p2.fromJSON(t.p2),this.p3.fromJSON(t.p3),this.p4.fromJSON(t.p4),this.p5.fromJSON(t.p5)}toString(){return u(this.toJSON())}}g.registerType("Frustum",F);var M=Object.freeze({__proto__:null,UInt8:0,SInt8:1,SInt16:3,UInt16:2,SInt32:5,UInt32:4,Float32:6,hashStr:m$2,JSON_stringify_fixedPrecision:u,AttrValue:p,Vec2:_,Vec3:Z,Vec4:G,RGBA:X,Color:y$2,EulerAngles:f,Quat:x,Ray:R,Mat3:V,Mat4:I,Xfo:S,Box2:L,Box3:v,Frustum:F,PlaneType:T,SphereType:W,typeRegistry:g});class Y{constructor(){this.__slots={}}addListener(t,e){if(null==e)throw new Error("a function callback must be passed to EventEmitter.addListener");this.__slots[t]||(this.__slots[t]=[]);const i=this.__slots[t];if(-1!=i.indexOf(e))return void console.warn("listener '"+e.name+"' already connected to EventEmitter with eventName:"+t);const n=i.length;return i[n]=e,n}removeListener(t,e){if(null==e)throw new Error("a function callback must be passed to EventEmitter.disconnect");const i=this.__slots[t],n=[];if(i&&i.forEach((t,i)=>{t===e&&n.push(i)}),0==n.length){const t=this.getName?this.getName():this.constructor.name;console.warn("Error in removeListener. listener :"+e.name+" was not connected to this event emitter:"+t)}else for(const s of n)i[s]=void 0}removeListenerById(t,e){const i=this.__slots[t];if(i){if(!i[e])throw new Error("Invalid ID");i[e]=void 0}else console.warn("callback :"+e+" was not connected to this signal:"+t)}on(t,e){return this.addListener(t,e)}once(t,e){const i=this.addListener(t,n=>{e(n),this.removeListenerById(t,i)})}off(t,e){"number"==typeof e?this.removeListenerById(t,e):this.removeListener(t,e)}emit(t,e){const i=this.__slots[t];if(!i)return;const n=i.length;for(let s=0;s<n;s++){const t=i[s];t&&t(e)}}}class C extends Y{constructor(t=0,e=0){super(),this.root={x:0,y:0,w:t,h:e}}fit(t){if(0==t.length)return;let e=!1;this.root.w<t[0].w&&(this.root.w=t[0].w,e=!0),this.root.h<t[0].h&&(this.root.h=t[0].h,e=!0),e&&this.emit("resized",{width:this.root.w,height:this.root.h}),t.forEach(t=>{t.fit=this.__addBlock(t)})}__addBlock(t){const e=this.findNode(this.root,t.w,t.h);return e?this.splitNode(e,t.w,t.h):this.growNode(t.w,t.h)}addBlock(t){let e=!1;this.root.w<t.w&&(this.root.w=t.w,e=!0),this.root.h<t.h&&(this.root.h=t.h,e=!0),e&&this.emit("resized",{width:this.root.w,height:this.root.h});const i=this.findNode(this.root,t.w,t.h);return i?this.splitNode(i,t.w,t.h):this.growNode(t.w,t.h)}findNode(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.w&&i<=t.h?t:null}splitNode(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i},t.right={x:t.x+e,y:t.y,w:t.w-e,h:i},t}growNode(t,e){const i=t<=this.root.w,n=e<=this.root.h,s=i&&this.root.w>=this.root.h+e;return n&&this.root.h>=this.root.w+t?this.growRight(t,e):s?this.growDown(t,e):n?this.growRight(t,e):i?this.growDown(t,e):null}growRight(t,e){this.root={used:!0,x:0,y:0,w:this.root.w+t,h:this.root.h,down:this.root,right:{x:this.root.w,y:0,w:t,h:this.root.h}};const i=this.findNode(this.root,t,e);let n;return i&&(n=this.splitNode(i,t,e)),this.emit("resized",{width:this.root.w,height:this.root.h}),n}growDown(t,e){this.root={used:!0,x:0,y:0,w:this.root.w,h:this.root.h+e,down:{x:0,y:this.root.h,w:this.root.w,h:e},right:this.root};const i=this.findNode(this.root,t,e);let n;return i&&(n=this.splitNode(i,t,e)),this.emit("resized",{width:this.root.w,height:this.root.h}),n}}class N extends Y{constructor(t=0){super(),this.__asyncCount=t,this.ready=!1,this.incAsyncCount=(t=1)=>{this.__asyncCount+=t,this.ready=!1},this.decAsyncCount=()=>{this.__asyncCount>0&&(this.__asyncCount--,0==this.__asyncCount&&this.__asyncsCompleted())},this.__asyncsCompleted=()=>{this.emit("ready",{})}}get count(){return this.__asyncCount}}const K=t=>{if(window.TextDecoder)return new TextDecoder("utf-8").decode(t);{let e="";for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e}};var w$1=Object.freeze({__proto__:null,GrowingPacker:C,Async:N,EventEmitter:Y,decodeText:K});let z=0;class U extends Y{constructor(){if(super(),"RefCounted"==this.constructor.name)throw new Error("RefCounted should not be instantiated directly.");this.__id=++z,this.__refs=[],this.__destroyed=!1}getId(){return this.__id}numRefs(){return this.__refs.length}addRef(t){if(!t)throw new Error("Error in RefCounted.addRef: Must provide a referer");return this.__refs.push(t),!0}removeRef(t){if(!t)throw new Error("Error in RefCounted.removeRef: Must provide a referer");const e=this.__refs.indexOf(t);if(-1==e)throw new Error("Error in RefCounted.removeRef: referer not found in refs list.");this.__refs.splice(e,1),0==this.__refs.length&&this.destroy()}getRefer(t){return this.__refs[t]}getRefIndex(t){return this.__refs.indexOf(t)}isDestroyed(){return this.__destroyed}destroy(){this.__destroyed=!0,this.emit("destructing",{})}}const J=new class{constructor(){this.__registeredClasses={},this.__classNames={},this.__classList=[]}registerClass(t,e){this.__registeredClasses[t]={cls:e,callbacks:[]};const i=this.__classList.length;this.__classList.push(e),this.__classNames[i]=t}getClass(t){if(this.__registeredClasses[t])return this.__registeredClasses[t].cls}getClassName(t){const e=this.__classList.indexOf(t.constructor);return this.__classNames[e]?this.__classNames[e]:(console.warn("Class not registered:",t.constructor.name),t.constructor.name)}constructClass(t){const e=this.__registeredClasses[t];if(!e)return console.warn("Factory not registered:"+t),null;this.__constructing=!0;const i=Array.prototype.slice.call(arguments,1),n=new e.cls(...i);return this.__constructing=!1,n}},P={NORMAL:0,OPERATOR_GETVALUE:1},E={USER_SETVALUE:0,REMOTEUSER_SETVALUE:1,USER_SETVALUE_DONE:2,OPERATOR_SETVALUE:3,OPERATOR_DIRTIED:4,COMPUTED_VALUE:4,GENERATED_VALUE:4,DATA_LOAD:4},H={USER_EDITED:2,DISABLED:4},k=0,B=1,D=2;class O extends Y{constructor(t){super(),this.__name=t,this.__cleanerFns=[],this.__boundOps=[],this.__state=k,this.__flags=0,this.getName=this.getName.bind(this),this.setName=this.setName.bind(this),this.getValue=this.getValue.bind(this),this.setValue=this.setValue.bind(this)}getName(){return this.__name}setName(t){if(t!=this.__name){const e=this.__name;this.__name=t,this.emit("nameChanged",{mode:this.__name},e)}}getOwner(){return this.ownerItem}setOwner(t){this.ownerItem=t}getPath(){const t=this.getOwner();if(t&&t.getName){if(t.getPath){const e=t.getPath().slice();return e.push(this.__name),e}return[t.getName(),this.__name]}return[this.__name]}setFlag(t){this.__flags|=t}clearFlag(t){this.__flags&=~t}testFlag(t){return 0!=(this.__flags&t)}getValue(){}setValue(t){}setEnabled(t){console.warn("Deprecated Method: This method will be removed soon."),t?this.setFlag(H.DISABLED):this.clearFlag(H.DISABLED)}isEnabled(){console.warn("Deprecated Method: This method will be removed soon."),this.testFlag(H.DISABLED)}bindOperator(t){this.__boundOps.push(t),this.__state=B,this.emit("valueChanged",{mode:E.OPERATOR_DIRTIED})}unbindOperator(t){const e=this.__boundOps.indexOf(t);if(-1==e)return!1;this.__boundOps.splice(e,1),this.__state=B,this.emit("valueChanged",{mode:E.OPERATOR_DIRTIED})}setDirty(t){return-1==this.__cleanerFns.indexOf(t)&&(this.__cleanerFns.push(t),this.__state=B,this.emit("valueChanged",{mode:E.OPERATOR_DIRTIED}),!0)}setDirtyFromOp(){return this.__state==k&&(this.__state=B,this.emit("valueChanged",{mode:E.OPERATOR_DIRTIED})),!0}isDirty(){return this.__state==B}_clean(){this.__state=D;const t=this.__cleanerFns;this.__cleanerFns=[];for(const e of t){const t=e(this.__value);null!=t&&(this.__value=t)}for(const e of this.__boundOps)e.evaluate();this.__state=k}removeCleanerFn(t){const e=this.__cleanerFns.indexOf(t);if(-1==e)return 0;this.__cleanerFns.splice(e,1)}clone(t){console.error("TOOD: implment me")}destroy(){}}class Q extends O{constructor(t,e,i){super(t),this.__value=e,this.__dataType=i||e.constructor.name}getDataType(){return this.__dataType}getValue(t=P.NORMAL){return this.__state==B&&this._clean(),this.__value}setClean(t){this.__value=t}setValue(t,e=E.USER_SETVALUE){if(this.__cleanerFns.length>0&&(this.__cleanerFns=[]),null==t)throw"undefined was passed into the setvalue for param:"+this.getName();(t.fromJSON||this.__value!=t)&&(this.__value=t,e!=E.USER_SETVALUE&&e!=E.REMOTEUSER_SETVALUE||this.setFlag(H.USER_EDITED),e!=E.OPERATOR_SETVALUE&&this.emit("valueChanged",{mode:e}))}setValueDone(){this.emit("valueChanged",{mode:E.USER_SETVALUE_DONE})}toJSON(t,e){return this.__value.toJSON?{value:this.__value.toJSON(t,e)}:{value:this.__value}}fromJSON(t,e,i){null!=t.value?(this.setFlag(H.USER_EDITED),t.value.type&&null==this.__value&&(this.__value=J.constructClass(t.value.type)),null!=this.__value&&this.__value.fromJSON?(this.__value.fromJSON(t.value,e),this.emit("valueChanged",{mode:E.DATA_LOAD})):this.setValue(t.value,E.DATA_LOAD)):console.warn("Invalid Parameter JSON")}readBinary(t,e){console.error("TODO")}clone(t){const e=this.__value;return e.clone&&(e=e.clone()),new Q(this.__name,e,this.__dataType)}}let A=0;class q extends Y{constructor(){super(),this.__id=++A,this.__params=[],this.__paramMapping={},this.__paramSignalIds={}}getId(){return this.__id}numParameters(){return this.__params.length}getParameters(){return this.__params}getParameterIndex(t){return this.__paramMapping[t]}getParameterByIndex(t){return this.__params[t]}hasParameter(t){return t in this.__paramMapping}getParameter(t){const e=this.__paramMapping[t];return-1==e?null:this.__params[e]}__parameterValueChanged(t){this.emit("parameterValueChanged",t)}addParameter(t){const e=t.getName();return null!=this.__paramMapping[e]&&(console.warn("Replacing Parameter:"+e),this.removeParameter(e)),this.__paramSignalIds[e]=t.addListener("valueChanged",e=>this.__parameterValueChanged({...e,param:t})),this.__params.push(t),this.__paramMapping[e]=this.__params.length-1,t.setOwner(this),this.emit("parameterAdded",{name:e}),t}insertParameter(t,e){const i=t.getName();null!=this.__paramMapping[i]&&(console.warn("Replacing Parameter:"+i),this.removeParameter(i)),this.__paramSignalIds[i]=t.addListener("valueChanged",e=>this.__parameterValueChanged({...e,param:t})),this.__params.splice(e,0,t);const n={};for(let s=0;s<this.__params.length;s++)n[this.__params[s].getName()]=s;return this.__paramMapping=n,this.emit("parameterAdded",{name:i}),t}removeParameter(t){null==this.__paramMapping[t]&&console.throw("Unable to Remove Parameter:"+t);const e=this.__paramMapping[t];this.__params[this.__paramMapping[t]].removeListenerById("valueChanged",this.__paramSignalIds[t]),this.__params.splice(e,1);const i={};for(let n=0;n<this.__params.length;n++)i[this.__params[n].getName()]=n;this.__paramMapping=i,this.emit("parameterRemoved",{name})}replaceParameter(t){const e=t.getName(),i=this.__paramMapping[e];return this.__params[this.__paramMapping[e]].removeListenerById("valueChanged",this.__paramSignalIds[e]),this.__paramSignalIds[e]=t.addListener("valueChanged",e=>this.__parameterValueChanged({...e,param:t})),this.__params[i]=t,t}toJSON(t,e){const i={};let n=0;for(const s of this.__params){if(!s.testFlag(H.USER_EDITED))continue;const o=s.toJSON(t,e);o&&(i[s.getName()]=o,n++)}if(n>0)return{params:i}}fromJSON(t,e,i){if(t.params)for(const n in t.params){const i=t.params[n],s=this.getParameter(n);s?i.paramPath?e.resolvePath(i.paramPath,t=>{this.replaceParameter(t)},()=>{console.warn("Unable to resolve shared parameter:"+i.paramPath)}):s.fromJSON(i,e):console.warn("Param not found:"+n)}}readBinary(t,e){if(e.versions["zea-engine"].greaterOrEqualThan([0,0,3])){const i=t.loadUInt32();for(let n=0;n<i;n++){const i=t.loadStr(),n=t.loadStr();let s=this.getParameter(n);if(!s){if(s=J.constructClass(i,n),!s){console.error("Unable to construct prop:"+n+" of type:"+i);continue}this.addParameter(s)}s.readBinary(t,e)}}}toString(){return JSON.stringify(this.toJSON(),null,2)}copyFrom(t,e){let i=t.numParameters();for(;i--;){const e=t.getParameterByIndex(i),n=this.getParameter(e.getName());n?n.setValue(e.getValue(),E.OPERATOR_SETVALUE):this.addParameter(e.clone())}}}const $={USER_EDITED:2,IGNORE_BBOX:4,BIN_NODE:8,INVISIBLE:16};let ee=0;class te extends q{constructor(t){super(),this.__name=t||"",this.__path=[this.__name],this.__ownerItem=void 0,this.__flags=0,this.__selectable=!0,this.__selected=!1,this.__metaData={},ee++}static getNumBaseItems(){return ee}__parameterValueChanged(t){super.__parameterValueChanged(t),t.mode!=E.USER_SETVALUE&&t.mode!=E.REMOTEUSER_SETVALUE||this.setFlag($.USER_EDITED)}getName(){return this.__name}setName(t,e=E.USER_SETVALUE){if(this.__name!=t){const i=this.__name;this.__name=t,this.__updatePath(),this.emit("nameChanged",{newName:t,oldName:i,mode:e})}}__updatePath(){null==this.__ownerItem?this.__path=[this.__name]:(this.__path=this.__ownerItem.getPath().slice(),this.__path.push(this.__name))}getPath(){return this.__path}setFlag(t){this.__flags|=t}clearFlag(t){this.__flags&=~t}testFlag(t){return 0!=(this.__flags&t)}resolvePath(t,e){if(e==t.length)return this;if(">"==t[e]&&e==t.length-1)return this.getParameter(t[e+1]);const i=this.getParameter(t[e]);if(i)return i;throw new Error("Invalid path:"+t+" member not found")}getOwner(){return this.__ownerItem}setOwner(t){this.__ownerItem!==t&&(this.__ownerItem=t,this.__updatePath())}getSelectable(){return this.__selectable}setSelectable(t){return this.__selectable!=t&&(this.__selectable=t,!0)}isSelected(){return this.__selected}getSelected(){return this.__selected}setSelected(t){this.__selected=t,this.emit("selectedChanged",{selected:this.__selected})}getMetadata(t){return this.__metaData[t]}hasMetadata(t){return t in this.__metaData}setMetadata(t,e){this.__metaData[t]=e}deleteMetadata(t){delete this.__metaData[t]}toJSON(t,e){let i=super.toJSON(t,e);return!i&&this.testFlag($.USER_EDITED)&&(i={}),i&&(i.name=this.__name,this.testFlag($.BIN_NODE)||(i.type=J.getClassName(this))),i}fromJSON(t,e,i){t.name&&(this.__name=t.name),super.fromJSON(t,e,i),this.__flags|=$.USER_EDITED}readBinary(t,e){t.loadStr(),this.setName(t.loadStr()),super.readBinary(t,e)}clone(t){throw new Error(this.constructor.name+" does not implment its clone method")}copyFrom(t,e){super.copyFrom(t,e),this.setName(t.getName())}destroy(){super.destroy()}}const ae=function(t){return t.substring(0,t.lastIndexOf("/"))+"/"},ie=function(t,e,i,n){const s=new XMLHttpRequest;s.responseType=e;try{s.addListener("timeout",(function(){throw new Error("The request for "+t+" timed out.")})),s.addListener("error",(function(){throw new Error("The request for "+t+": xhr.readyState:"+s.readyState)})),s.addListener("abort",(function(){throw new Error("The request for "+t+": xhr.readyState:"+s.readyState)})),s.addListener("loadend",(function(){200==s.status?i(s):n(s.statusText)})),s.open("GET",t,!0),s.send()}catch(t){n(t)}},se=function(t,e,i){ie(t,"text",t=>{e(t.responseText)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},ne=function(t,e,i){ie(t,"json",t=>{e(t.response,t)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},le=function(t,e,i){ie(t,"document",t=>{e(t.responseXML)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},re$1=function(t,e,i){ie(t,"arraybuffer",t=>{e(t.response)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},de="[object process]"===Object.prototype.toString.call(void 0!==process_1?process_1:0),oe=de&&"function"==typeof module.require?module.require:null;function he(t,e=null,i=!1){const n=de?function(t,e){return Buffer.from(t,"base64").toString(e?"utf16":"utf8")}(t,i):function(t,e){const i=atob(t);if(e){const t=new Uint8Array(i.length);return Array.prototype.forEach.call(t,(t,e,n)=>{n[e]=i.charCodeAt(e)}),String.fromCharCode.apply(null,new Uint16Array(t.buffer))}return i}(t,i),s=n.indexOf("\n",10)+1,o=n.substring(s)+(e?"//# sourceMappingURL="+e:"");if(oe){const t=oe("worker_threads").Worker;return function(e){return new t(o,Object.assign({},e,{eval:!0}))}}const r=new Blob([o],{type:"application/javascript"}),a=URL.createObjectURL(r);return function(t){return new Worker(a,t)}}var ce=he("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpNb2R1bGU9e0VOVklST05NRU5UOiJXT1JLRVIifTtjb25zdCBlPXt9O3ZhciB0Oyh0PWUpLnVucGFja0JyaWRnZT1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQ9e307ZnVuY3Rpb24gcihuKXtpZih0W25dKXJldHVybiB0W25dLmV4cG9ydHM7dmFyIG89dFtuXT17aTpuLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIGVbbl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsciksby5sPSEwLG8uZXhwb3J0c31yZXR1cm4gci5tPWUsci5jPXQsci5kPWZ1bmN0aW9uKGUsdCxuKXtyLm8oZSx0KXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7ZW51bWVyYWJsZTohMCxnZXQ6bn0pfSxyLnI9ZnVuY3Rpb24oZSl7InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZToiTW9kdWxlIn0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KX0sci50PWZ1bmN0aW9uKGUsdCl7aWYoMSZ0JiYoZT1yKGUpKSw4JnQpcmV0dXJuIGU7aWYoNCZ0JiYib2JqZWN0Ij09dHlwZW9mIGUmJmUmJmUuX19lc01vZHVsZSlyZXR1cm4gZTt2YXIgbj1PYmplY3QuY3JlYXRlKG51bGwpO2lmKHIucihuKSxPYmplY3QuZGVmaW5lUHJvcGVydHkobiwiZGVmYXVsdCIse2VudW1lcmFibGU6ITAsdmFsdWU6ZX0pLDImdCYmInN0cmluZyIhPXR5cGVvZiBlKWZvcih2YXIgbyBpbiBlKXIuZChuLG8sZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19LmJpbmQobnVsbCxvKSk7cmV0dXJuIG59LHIubj1mdW5jdGlvbihlKXt2YXIgdD1lJiZlLl9fZXNNb2R1bGU/ZnVuY3Rpb24oKXtyZXR1cm4gZS5kZWZhdWx0fTpmdW5jdGlvbigpe3JldHVybiBlfTtyZXR1cm4gci5kKHQsImEiLHQpLHR9LHIubz1mdW5jdGlvbihlLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KX0sci5wPSIiLHIoci5zPTIpfShbZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTtjb25zdCBvPXIoMSksaT17MDoiRVJBUl9TVUNDRVNTIiwxMDoiRVJBUl9FTkRfQVJDSElWRSIsMTE6IkVSQVJfTk9fTUVNT1JZIiwxMjoiRVJBUl9CQURfREFUQSIsMTM6IkVSQVJfQkFEX0FSQ0hJVkUiLDE0OiJFUkFSX1VOS05PV05fRk9STUFUIiwxNToiRVJBUl9FT1BFTiIsMTY6IkVSQVJfRUNSRUFURSIsMTc6IkVSQVJfRUNMT1NFIiwxODoiRVJBUl9FUkVBRCIsMTk6IkVSQVJfRVdSSVRFIiwyMDoiRVJBUl9TTUFMTF9CVUYiLDIxOiJFUkFSX1VOS05PV04iLDIyOiJFUkFSX01JU1NJTkdfUEFTU1dPUkQiLDIzOiJFUkFSX0VSRUZFUkVOQ0UiLDI0OiJFUkFSX0JBRF9QQVNTV09SRCJ9LGE9ezA6IlN1Y2Nlc3MiLDExOiJOb3QgZW5vdWdoIG1lbW9yeSIsMTI6IkFyY2hpdmUgaGVhZGVyIG9yIGRhdGEgYXJlIGRhbWFnZWQiLDEzOiJGaWxlIGlzIG5vdCBSQVIgYXJjaGl2ZSIsMTQ6IlVua25vd24gYXJjaGl2ZSBmb3JtYXQiLDE1OiJGaWxlIG9wZW4gZXJyb3IiLDE2OiJGaWxlIGNyZWF0ZSBlcnJvciIsMTc6IkZpbGUgY2xvc2UgZXJyb3IiLDE4OiJGaWxlIHJlYWQgZXJyb3IiLDE5OiJGaWxlIHdyaXRlIGVycm9yIiwyMDoiQnVmZmVyIGZvciBhcmNoaXZlIGNvbW1lbnQgaXMgdG9vIHNtYWxsLCBjb21tZW50IHRydW5jYXRlZCIsMjE6IlVua25vd24gZXJyb3IiLDIyOiJQYXNzd29yZCBmb3IgZW5jcnlwdGVkIGZpbGUgb3IgaGVhZGVyIGlzIG5vdCBzcGVjaWZpZWQiLDIzOiJDYW5ub3Qgb3BlbiBmaWxlIHNvdXJjZSBmb3IgcmVmZXJlbmNlIHJlY29yZCIsMjQ6Ildyb25nIHBhc3N3b3JkIGlzIHNwZWNpZmllZCJ9O2NsYXNzIHN7Y29uc3RydWN0b3IoZT0iIil7dGhpcy5fcGFzc3dvcmQ9ZSx0aGlzLl9hcmNoaXZlPW51bGx9Z2V0RmlsZUxpc3QoKXtsZXQgZSxbdCxyXT10aGlzLm9wZW5BcmMoITApO2lmKCJTVUNDRVNTIiE9PXQuc3RhdGUpZT1bdCxudWxsXTtlbHNle2xldCB0LG4sbz1bXTtmb3IoO1t0LG5dPXRoaXMucHJvY2Vzc05leHRGaWxlKCgpPT4hMCksIlNVQ0NFU1MiPT09dC5zdGF0ZTspby5wdXNoKG4uZmlsZUhlYWRlcik7ZT0iRVJBUl9FTkRfQVJDSElWRSIhPT10LnJlYXNvbj9bdCxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2FyY0hlYWRlcjpyLGZpbGVIZWFkZXJzOm99XX1yZXR1cm4gdGhpcy5jbG9zZUFyYygpLGV9ZXh0cmFjdEFsbCgpe2xldCBlLFt0LHJdPXRoaXMub3BlbkFyYyghMSk7aWYoIlNVQ0NFU1MiIT09dC5zdGF0ZSllPVt0LG51bGxdO2Vsc2V7bGV0IHQsbixvPVtdO2Zvcig7W3Qsbl09dGhpcy5wcm9jZXNzTmV4dEZpbGUoKCk9PiExKSwiU1VDQ0VTUyI9PT10LnN0YXRlOylvLnB1c2gobik7ZT0iRVJBUl9FTkRfQVJDSElWRSIhPT10LnJlYXNvbj9bdCxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2FyY0hlYWRlcjpyLGZpbGVzOm99XX1yZXR1cm4gdGhpcy5jbG9zZUFyYygpLGV9ZXh0cmFjdEZpbGVzKGUsdCl7bGV0IHIsW24sb109dGhpcy5vcGVuQXJjKCExLHQpLGk9e307Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDsrK3QpaVtlW3RdXT10O2lmKCJTVUNDRVNTIiE9PW4uc3RhdGUpcj1bbixudWxsXTtlbHNle2xldCB0LG4sYT1BcnJheShlLmxlbmd0aCkuZmlsbChudWxsKSxzPTA7Zm9yKDs7KXtsZXQgcj0hMSxvPW51bGw7aWYoW3Qsbl09dGhpcy5wcm9jZXNzTmV4dEZpbGUoZT0+ZSBpbiBpPyhvPWlbZV0sITEpOihyPSEwLCEwKSksIlNVQ0NFU1MiIT09dC5zdGF0ZSlicmVhaztpZighciYmKGFbb109biwrK3M9PT1lLmxlbmd0aCkpe3QucmVhc29uPSJFUkFSX0VORF9BUkNISVZFIjticmVha319cj0iRVJBUl9FTkRfQVJDSElWRSIhPT10LnJlYXNvbj9bdCxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2FyY0hlYWRlcjpvLGZpbGVzOmF9XX1yZXR1cm4gdGhpcy5jbG9zZUFyYygpLHJ9ZmlsZUNyZWF0ZWQoZSl7fWNsb3NlKGUpe3RoaXMuX2xhc3RGaWxlQ29udGVudD10aGlzLmNsb3NlRmlsZShlKX1vcGVuQXJjKGUsdCl7by5FeHQuY3VycmVudD10aGlzLHRoaXMuX2FyY2hpdmU9bmV3IG4uUmFyQXJjaGl2ZTtsZXQgcixpPXRoaXMuX2FyY2hpdmUub3Blbih0aGlzLl9maWxlUGF0aCx0fHx0aGlzLl9wYXNzd29yZCxlKTtyZXR1cm4gcj0wIT09aS5zdGF0ZS5lcnJDb2RlP1t0aGlzLmdldEZhaWxJbmZvKGkuc3RhdGUuZXJyQ29kZSxpLnN0YXRlLmVyclR5cGUpLG51bGxdOlt7c3RhdGU6IlNVQ0NFU1MifSx7Y29tbWVudDppLmNvbW1lbnQsZmxhZ3M6e3ZvbHVtZTowIT0oMSZpLmZsYWdzKSxsb2NrOjAhPSg0JmkuZmxhZ3MpLHNvbGlkOjAhPSg4JmkuZmxhZ3MpLGF1dGhJbmZvOjAhPSgzMiZpLmZsYWdzKSxyZWNvdmVyeVJlY29yZDowIT0oNjQmaS5mbGFncyksaGVhZGVyRW5jcnlwdGVkOjAhPSgxMjgmaS5mbGFncyl9fV0sby5FeHQuY3VycmVudD1udWxsLHJ9cHJvY2Vzc05leHRGaWxlKGUpe2xldCB0O28uRXh0LmN1cnJlbnQ9dGhpcztsZXQgcj10aGlzLl9hcmNoaXZlLmdldEZpbGVIZWFkZXIoKSxuPVt7c3RhdGU6IlNVQ0NFU1MifSxudWxsXTtpZigwPT09ci5zdGF0ZS5lcnJDb2RlKXtsZXQgdD1lKHIubmFtZSk7dGhpcy5fbGFzdEZpbGVDb250ZW50PW51bGw7bGV0IG89dGhpcy5fYXJjaGl2ZS5yZWFkRmlsZSh0KTswPT09by5lcnJDb2RlfHx0fHwoblswXT10aGlzLmdldEZhaWxJbmZvKG8uZXJyQ29kZSxvLmVyclR5cGUpLDIyPT09by5lcnJDb2RlP289dGhpcy5fYXJjaGl2ZS5yZWFkRmlsZSghMCk6by5lcnJDb2RlPTApLDA9PT1vLmVyckNvZGU/blsxXT10aGlzLl9sYXN0RmlsZUNvbnRlbnQ6KHIuc3RhdGUuZXJyQ29kZT1vLmVyckNvZGUsci5zdGF0ZS5lcnJUeXBlPW8uZXJyVHlwZSksdGhpcy5fbGFzdEZpbGVDb250ZW50PW51bGx9cmV0dXJuIHQ9MCE9PXIuc3RhdGUuZXJyQ29kZT9bdGhpcy5nZXRGYWlsSW5mbyhyLnN0YXRlLmVyckNvZGUsci5zdGF0ZS5lcnJUeXBlKSxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2ZpbGVIZWFkZXI6e25hbWU6ci5uYW1lLGZsYWdzOntlbmNyeXB0ZWQ6MCE9KDQmci5mbGFncyksc29saWQ6MCE9KDE2JnIuZmxhZ3MpLGRpcmVjdG9yeTowIT0oMzImci5mbGFncyl9LHBhY2tTaXplOnIucGFja1NpemUsdW5wU2l6ZTpyLnVucFNpemUsY3JjOnIuY3JjLHRpbWU6ZnVuY3Rpb24oZSl7Y29uc3QgdD1bNSw2LDUsNSw0LDddO2xldCByPVtdO2ZvcihsZXQgbiBvZiB0KXIucHVzaChlJigxPDxuKS0xKSxlPj49bjtsZXQgbj1lPT5lPDEwPyIwIitlOiIiK2U7cmV0dXJuYCR7MTk4MCsocj1yLnJldmVyc2UoKSlbMF19LSR7bihyWzFdKX0tJHtuKHJbMl0pfVQke24oclszXSl9OiR7bihyWzRdKX06JHtuKDIqcls1XSl9LjAwMGB9KHIudGltZSksdW5wVmVyOmAke01hdGguZmxvb3Ioci51bnBWZXIvMTApfS4ke3IudW5wVmVyJTEwfWAsbWV0aG9kOmZ1bmN0aW9uKGUpe3JldHVybns0ODoiU3RvcmluZyIsNDk6IkZhc3Rlc3QiLDUwOiJGYXN0Iiw1MToiTm9ybWFsIiw1MjoiR29vZCIsNTM6IkJlc3QifVtlXXx8IlVua25vd24ifShyLm1ldGhvZCl9LGV4dHJhY3Q6bn1dLG8uRXh0LmN1cnJlbnQ9bnVsbCx0fWNsb3NlQXJjKCl7by5FeHQuY3VycmVudD10aGlzLHRoaXMuX2FyY2hpdmUuZGVsZXRlKCksby5FeHQuY3VycmVudD1udWxsLHRoaXMuX2FyY2hpdmU9bnVsbH1nZXRGYWlsSW5mbyhlLHQpe3JldHVybntzdGF0ZToiRkFJTCIscmVhc29uOmlbZV0sbXNnOmFbZV19fX1zLl9jdXJyZW50PW51bGwsdC5FeHRyYWN0b3I9c30sZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LkV4dD17Y3VycmVudDpudWxsfX0sZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSxmdW5jdGlvbihlKXtmb3IodmFyIHIgaW4gZSl0Lmhhc093blByb3BlcnR5KHIpfHwodFtyXT1lW3JdKX0ocigzKSk7dmFyIG49cigxKTt0LkV4dD1uLkV4dH0sZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTtjb25zdCBuPXIoNCksbz1yKDYpO3QuY3JlYXRlRXh0cmFjdG9yRnJvbURhdGE9ZnVuY3Rpb24oZSx0PSIiKXtyZXR1cm4gbmV3IG4uRGF0YUV4dHJhY3RvcihlLHQpfSx0LmNyZWF0ZUV4dHJhY3RvckZyb21GaWxlPWZ1bmN0aW9uKGUsdD0iIixyPSIiKXtyZXR1cm4gbmV3IG8uRmlsZUV4dHJhY3RvcihlLHQscil9fSxmdW5jdGlvbihlLHQscil7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO2NvbnN0IG89cig1KSxpPXIoMCk7dC5EYXRhRXh0cmFjdG9yPWNsYXNzIGV4dGVuZHMgaS5FeHRyYWN0b3J7Y29uc3RydWN0b3IoZSx0KXtzdXBlcih0KSx0aGlzLmRhdGFGaWxlcz17fSx0aGlzLmRhdGFGaWxlTWFwPXt9LHRoaXMuY3VycmVudEZkPTE7bGV0IHI9e2ZpbGU6bmV3IG8uRGF0YUZpbGUobmV3IFVpbnQ4QXJyYXkoZSkpLGZkOnRoaXMuY3VycmVudEZkKyt9O3RoaXMuX2ZpbGVQYXRoPSJfZGVmYXVsdFVucmFySlNfLnJhciIsdGhpcy5kYXRhRmlsZXNbdGhpcy5fZmlsZVBhdGhdPXIsdGhpcy5kYXRhRmlsZU1hcFtyLmZkXT10aGlzLl9maWxlUGF0aH1vcGVuKGUpe2xldCB0PXRoaXMuZGF0YUZpbGVzW2VdO3JldHVybiB0P3QuZmQ6MH1jcmVhdGUoZSl7bGV0IHQ9dGhpcy5jdXJyZW50RmQrKztyZXR1cm4gdGhpcy5kYXRhRmlsZXNbZV09e2ZpbGU6bmV3IG8uRGF0YUZpbGUsZmQ6dGhpcy5jdXJyZW50RmQrK30sdGhpcy5kYXRhRmlsZU1hcFt0XT1lLHR9Y2xvc2VGaWxlKGUpe2xldCB0PXRoaXMuZGF0YUZpbGVzW3RoaXMuZGF0YUZpbGVNYXBbZV1dO2lmKCF0KXJldHVybiBudWxsO2xldCByPXQuZmlsZS5yZWFkQWxsKCk7cmV0dXJuIDEhPT1lPyhkZWxldGUgdGhpcy5kYXRhRmlsZXNbdGhpcy5kYXRhRmlsZU1hcFtlXV0sZGVsZXRlIHRoaXMuZGF0YUZpbGVNYXBbZV0pOnQuZmlsZS5zZWVrKDAsIlNFVCIpLHJ9cmVhZChlLHQscil7bGV0IG89dGhpcy5kYXRhRmlsZXNbdGhpcy5kYXRhRmlsZU1hcFtlXV07aWYoIW8pcmV0dXJuLTE7bGV0IGk9by5maWxlLnJlYWQocik7cmV0dXJuIG51bGw9PT1pPy0xOihuLkhFQVBVOC5zZXQoaSx0KSxpLmJ5dGVMZW5ndGgpfXdyaXRlKGUsdCxyKXtsZXQgbz10aGlzLmRhdGFGaWxlc1t0aGlzLmRhdGFGaWxlTWFwW2VdXTtyZXR1cm4hIW8mJihvLmZpbGUud3JpdGUobi5IRUFQVTguc2xpY2UodCx0K3IpKSwhMCl9dGVsbChlKXtsZXQgdD10aGlzLmRhdGFGaWxlc1t0aGlzLmRhdGFGaWxlTWFwW2VdXTtyZXR1cm4gdD90LmZpbGUudGVsbCgpOi0xfXNlZWsoZSx0LHIpe2xldCBuPXRoaXMuZGF0YUZpbGVzW3RoaXMuZGF0YUZpbGVNYXBbZV1dO3JldHVybiEhbiYmbi5maWxlLnNlZWsodCxyKX19fSxmdW5jdGlvbihlLHQscil7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuRGF0YUZpbGU9Y2xhc3N7Y29uc3RydWN0b3IoZSl7dGhpcy5idWZmZXJzPVtdLHRoaXMucG9zPTAsdGhpcy5zaXplPTAsZSYmKHRoaXMuYnVmZmVycy5wdXNoKGUpLHRoaXMuc2l6ZT1lLmJ5dGVMZW5ndGgsdGhpcy5wb3M9MCl9cmVhZChlKXtpZih0aGlzLmZsYXR0ZW4oKSxlK3RoaXMucG9zPnRoaXMuc2l6ZSlyZXR1cm4gbnVsbDtsZXQgdD10aGlzLnBvcztyZXR1cm4gdGhpcy5wb3MrPWUsdGhpcy5idWZmZXJzWzBdLnNsaWNlKHQsdGhpcy5wb3MpfXJlYWRBbGwoKXtyZXR1cm4gdGhpcy5mbGF0dGVuKCksdGhpcy5idWZmZXJzWzBdfXdyaXRlKGUpe3JldHVybiB0aGlzLmJ1ZmZlcnMucHVzaChlKSx0aGlzLnNpemUrPWUuYnl0ZUxlbmd0aCx0aGlzLnBvcys9ZS5ieXRlTGVuZ3RoLCEwfXRlbGwoKXtyZXR1cm4gdGhpcy5wb3N9c2VlayhlLHQpe2xldCByPXRoaXMucG9zO3JldHVybiJTRVQiPT09dD9yPWU6IkNVUiI9PT10P3IrPWU6cj10aGlzLnNpemUtZSwhKHI8MHx8cj50aGlzLnNpemV8fCh0aGlzLnBvcz1yLDApKX1mbGF0dGVuKCl7aWYodGhpcy5idWZmZXJzLmxlbmd0aDw9MSlyZXR1cm47bGV0IGU9bmV3IFVpbnQ4QXJyYXkodGhpcy5zaXplKSx0PTA7Zm9yKGxldCByIG9mIHRoaXMuYnVmZmVycyllLnNldChyLHQpLHQrPXIuYnl0ZUxlbmd0aDt0aGlzLmJ1ZmZlcnM9W2VdfX19LGZ1bmN0aW9uKGUsdCxyKXsoZnVuY3Rpb24oZSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO2NvbnN0IG89cigxMiksaT1yKDEzKSxhPXIoMCk7dC5GaWxlRXh0cmFjdG9yPWNsYXNzIGV4dGVuZHMgYS5FeHRyYWN0b3J7Y29uc3RydWN0b3IoZSx0LHIpe3N1cGVyKHIpLHRoaXMuX2ZpbGVQYXRoPWUsdGhpcy5maWxlTWFwPXt9LHRoaXMuX3RhcmdldD10fW9wZW4oZSl7bGV0IHQ9by5vcGVuU3luYyhlLCJyIik7cmV0dXJuIHRoaXMuZmlsZU1hcFt0XT17c2l6ZTpvLmZzdGF0U3luYyh0KS5zaXplLHBvczowLG5hbWU6ZX0sdH1jcmVhdGUoZSl7bGV0IHQ9aS5qb2luKHRoaXMuX3RhcmdldCxlKTtpLnBhcnNlKHQpLmRpci5zcGxpdCgiLyIpLnJlZHVjZSgoZSx0KT0+KGUrPXQrIi8iLG8uZXhpc3RzU3luYyhlKXx8by5ta2RpclN5bmMoZSksZSksIiIpO2xldCByPW8ub3BlblN5bmModCwidyIpO3JldHVybiB0aGlzLmZpbGVNYXBbcl09e3NpemU6MCxwb3M6MCxuYW1lOmV9LHJ9Y2xvc2VGaWxlKGUpe3JldHVybiBkZWxldGUgdGhpcy5maWxlTWFwW2VdLG8uY2xvc2VTeW5jKGUpLG51bGx9cmVhZCh0LHIsaSl7bGV0IGE9dGhpcy5maWxlTWFwW3RdLHM9bmV3IGUoaSksdT1vLnJlYWRTeW5jKHQscywwLGksYS5wb3MpO3JldHVybiBuLkhFQVBVOC5zZXQocyxyKSxhLnBvcys9dSx1fXdyaXRlKHQscixpKXtsZXQgYT10aGlzLmZpbGVNYXBbdF0scz1vLndyaXRlU3luYyh0LG5ldyBlKG4uSEVBUFU4LnN1YmFycmF5KHIscitpKSksMCxpKTtyZXR1cm4gYS5wb3MrPXMsYS5zaXplKz1zLHM9PT1pfXRlbGwoZSl7cmV0dXJuIHRoaXMuZmlsZU1hcFtlXS5wb3N9c2VlayhlLHQscil7bGV0IG49dGhpcy5maWxlTWFwW2VdLG89bi5wb3M7cmV0dXJuIlNFVCI9PT1yP289MDoiRU5EIj09PXImJihvPW4uc2l6ZSksISgobys9dCk8MHx8bz5uLnNpemV8fChuLnBvcz1vLDApKX19fSkuY2FsbCh0aGlzLHIoNykuQnVmZmVyKX0sZnVuY3Rpb24oZSx0LHIpeyhmdW5jdGlvbihlKXsKLyohCiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLgogKgogKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz4KICogQGxpY2Vuc2UgIE1JVAogKi8KdmFyIG49cig5KSxvPXIoMTApLGk9cigxMSk7ZnVuY3Rpb24gYSgpe3JldHVybiB1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/MjE0NzQ4MzY0NzoxMDczNzQxODIzfWZ1bmN0aW9uIHMoZSx0KXtpZihhKCk8dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiSW52YWxpZCB0eXBlZCBhcnJheSBsZW5ndGgiKTtyZXR1cm4gdS5UWVBFRF9BUlJBWV9TVVBQT1JUPyhlPW5ldyBVaW50OEFycmF5KHQpKS5fX3Byb3RvX189dS5wcm90b3R5cGU6KG51bGw9PT1lJiYoZT1uZXcgdSh0KSksZS5sZW5ndGg9dCksZX1mdW5jdGlvbiB1KGUsdCxyKXtpZighKHUuVFlQRURfQVJSQVlfU1VQUE9SVHx8dGhpcyBpbnN0YW5jZW9mIHUpKXJldHVybiBuZXcgdShlLHQscik7aWYoIm51bWJlciI9PXR5cGVvZiBlKXtpZigic3RyaW5nIj09dHlwZW9mIHQpdGhyb3cgbmV3IEVycm9yKCJJZiBlbmNvZGluZyBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZyIpO3JldHVybiBmKHRoaXMsZSl9cmV0dXJuIGModGhpcyxlLHQscil9ZnVuY3Rpb24gYyhlLHQscixuKXtpZigibnVtYmVyIj09dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgQXJyYXlCdWZmZXImJnQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9mdW5jdGlvbihlLHQscixuKXtpZih0LmJ5dGVMZW5ndGgscjwwfHx0LmJ5dGVMZW5ndGg8cil0aHJvdyBuZXcgUmFuZ2VFcnJvcigiJ29mZnNldCcgaXMgb3V0IG9mIGJvdW5kcyIpO2lmKHQuYnl0ZUxlbmd0aDxyKyhufHwwKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiJ2xlbmd0aCcgaXMgb3V0IG9mIGJvdW5kcyIpO3JldHVybiB0PXZvaWQgMD09PXImJnZvaWQgMD09PW4/bmV3IFVpbnQ4QXJyYXkodCk6dm9pZCAwPT09bj9uZXcgVWludDhBcnJheSh0LHIpOm5ldyBVaW50OEFycmF5KHQscixuKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KGU9dCkuX19wcm90b19fPXUucHJvdG90eXBlOmU9ZChlLHQpLGV9KGUsdCxyLG4pOiJzdHJpbmciPT10eXBlb2YgdD9mdW5jdGlvbihlLHQscil7aWYoInN0cmluZyI9PXR5cGVvZiByJiYiIiE9PXJ8fChyPSJ1dGY4IiksIXUuaXNFbmNvZGluZyhyKSl0aHJvdyBuZXcgVHlwZUVycm9yKCciZW5jb2RpbmciIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKTt2YXIgbj0wfHAodCxyKSxvPShlPXMoZSxuKSkud3JpdGUodCxyKTtyZXR1cm4gbyE9PW4mJihlPWUuc2xpY2UoMCxvKSksZX0oZSx0LHIpOmZ1bmN0aW9uKGUsdCl7aWYodS5pc0J1ZmZlcih0KSl7dmFyIHI9MHxoKHQubGVuZ3RoKTtyZXR1cm4gMD09PShlPXMoZSxyKSkubGVuZ3RofHx0LmNvcHkoZSwwLDAsciksZX1pZih0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiZ0LmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHwibGVuZ3RoImluIHQpcmV0dXJuIm51bWJlciIhPXR5cGVvZiB0Lmxlbmd0aHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUhPWV9KHQubGVuZ3RoKT9zKGUsMCk6ZChlLHQpO2lmKCJCdWZmZXIiPT09dC50eXBlJiZpKHQuZGF0YSkpcmV0dXJuIGQoZSx0LmRhdGEpfXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4iKX0oZSx0KX1mdW5jdGlvbiBsKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSl0aHJvdyBuZXcgVHlwZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpO2lmKGU8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcignInNpemUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJyl9ZnVuY3Rpb24gZihlLHQpe2lmKGwodCksZT1zKGUsdDwwPzA6MHxoKHQpKSwhdS5UWVBFRF9BUlJBWV9TVVBQT1JUKWZvcih2YXIgcj0wO3I8dDsrK3IpZVtyXT0wO3JldHVybiBlfWZ1bmN0aW9uIGQoZSx0KXt2YXIgcj10Lmxlbmd0aDwwPzA6MHxoKHQubGVuZ3RoKTtlPXMoZSxyKTtmb3IodmFyIG49MDtuPHI7bis9MSllW25dPTI1NSZ0W25dO3JldHVybiBlfWZ1bmN0aW9uIGgoZSl7aWYoZT49YSgpKXRocm93IG5ldyBSYW5nZUVycm9yKCJBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtIHNpemU6IDB4IithKCkudG9TdHJpbmcoMTYpKyIgYnl0ZXMiKTtyZXR1cm4gMHxlfWZ1bmN0aW9uIHAoZSx0KXtpZih1LmlzQnVmZmVyKGUpKXJldHVybiBlLmxlbmd0aDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiYiZnVuY3Rpb24iPT10eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3JiYoQXJyYXlCdWZmZXIuaXNWaWV3KGUpfHxlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKXJldHVybiBlLmJ5dGVMZW5ndGg7InN0cmluZyIhPXR5cGVvZiBlJiYoZT0iIitlKTt2YXIgcj1lLmxlbmd0aDtpZigwPT09cilyZXR1cm4gMDtmb3IodmFyIG49ITE7Oylzd2l0Y2godCl7Y2FzZSJhc2NpaSI6Y2FzZSJsYXRpbjEiOmNhc2UiYmluYXJ5IjpyZXR1cm4gcjtjYXNlInV0ZjgiOmNhc2UidXRmLTgiOmNhc2Ugdm9pZCAwOnJldHVybiBVKGUpLmxlbmd0aDtjYXNlInVjczIiOmNhc2UidWNzLTIiOmNhc2UidXRmMTZsZSI6Y2FzZSJ1dGYtMTZsZSI6cmV0dXJuIDIqcjtjYXNlImhleCI6cmV0dXJuIHI+Pj4xO2Nhc2UiYmFzZTY0IjpyZXR1cm4geihlKS5sZW5ndGg7ZGVmYXVsdDppZihuKXJldHVybiBVKGUpLmxlbmd0aDt0PSgiIit0KS50b0xvd2VyQ2FzZSgpLG49ITB9fWZ1bmN0aW9uIG0oZSx0LHIpe3ZhciBuPWVbdF07ZVt0XT1lW3JdLGVbcl09bn1mdW5jdGlvbiB5KGUsdCxyLG4sbyl7aWYoMD09PWUubGVuZ3RoKXJldHVybi0xO2lmKCJzdHJpbmciPT10eXBlb2Ygcj8obj1yLHI9MCk6cj4yMTQ3NDgzNjQ3P3I9MjE0NzQ4MzY0NzpyPC0yMTQ3NDgzNjQ4JiYocj0tMjE0NzQ4MzY0OCkscj0rcixpc05hTihyKSYmKHI9bz8wOmUubGVuZ3RoLTEpLHI8MCYmKHI9ZS5sZW5ndGgrcikscj49ZS5sZW5ndGgpe2lmKG8pcmV0dXJuLTE7cj1lLmxlbmd0aC0xfWVsc2UgaWYocjwwKXtpZighbylyZXR1cm4tMTtyPTB9aWYoInN0cmluZyI9PXR5cGVvZiB0JiYodD11LmZyb20odCxuKSksdS5pc0J1ZmZlcih0KSlyZXR1cm4gMD09PXQubGVuZ3RoPy0xOkUoZSx0LHIsbixvKTtpZigibnVtYmVyIj09dHlwZW9mIHQpcmV0dXJuIHQmPTI1NSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQmJiJmdW5jdGlvbiI9PXR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mP28/VWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGUsdCxyKTpVaW50OEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGUsdCxyKTpFKGUsW3RdLHIsbixvKTt0aHJvdyBuZXcgVHlwZUVycm9yKCJ2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXIiKX1mdW5jdGlvbiBFKGUsdCxyLG4sbyl7dmFyIGksYT0xLHM9ZS5sZW5ndGgsdT10Lmxlbmd0aDtpZih2b2lkIDAhPT1uJiYoInVjczIiPT09KG49U3RyaW5nKG4pLnRvTG93ZXJDYXNlKCkpfHwidWNzLTIiPT09bnx8InV0ZjE2bGUiPT09bnx8InV0Zi0xNmxlIj09PW4pKXtpZihlLmxlbmd0aDwyfHx0Lmxlbmd0aDwyKXJldHVybi0xO2E9MixzLz0yLHUvPTIsci89Mn1mdW5jdGlvbiBjKGUsdCl7cmV0dXJuIDE9PT1hP2VbdF06ZS5yZWFkVUludDE2QkUodCphKX1pZihvKXt2YXIgbD0tMTtmb3IoaT1yO2k8cztpKyspaWYoYyhlLGkpPT09Yyh0LC0xPT09bD8wOmktbCkpe2lmKC0xPT09bCYmKGw9aSksaS1sKzE9PT11KXJldHVybiBsKmF9ZWxzZS0xIT09bCYmKGktPWktbCksbD0tMX1lbHNlIGZvcihyK3U+cyYmKHI9cy11KSxpPXI7aT49MDtpLS0pe2Zvcih2YXIgZj0hMCxkPTA7ZDx1O2QrKylpZihjKGUsaStkKSE9PWModCxkKSl7Zj0hMTticmVha31pZihmKXJldHVybiBpfXJldHVybi0xfWZ1bmN0aW9uIGcoZSx0LHIsbil7cj1OdW1iZXIocil8fDA7dmFyIG89ZS5sZW5ndGgtcjtuPyhuPU51bWJlcihuKSk+byYmKG49byk6bj1vO3ZhciBpPXQubGVuZ3RoO2lmKGklMiE9MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGhleCBzdHJpbmciKTtuPmkvMiYmKG49aS8yKTtmb3IodmFyIGE9MDthPG47KythKXt2YXIgcz1wYXJzZUludCh0LnN1YnN0cigyKmEsMiksMTYpO2lmKGlzTmFOKHMpKXJldHVybiBhO2VbcithXT1zfXJldHVybiBhfWZ1bmN0aW9uIHYoZSx0LHIsbil7cmV0dXJuICQoVSh0LGUubGVuZ3RoLXIpLGUscixuKX1mdW5jdGlvbiB3KGUsdCxyLG4pe3JldHVybiAkKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxyPTA7cjxlLmxlbmd0aDsrK3IpdC5wdXNoKDI1NSZlLmNoYXJDb2RlQXQocikpO3JldHVybiB0fSh0KSxlLHIsbil9ZnVuY3Rpb24gXyhlLHQscixuKXtyZXR1cm4gdyhlLHQscixuKX1mdW5jdGlvbiBiKGUsdCxyLG4pe3JldHVybiAkKHoodCksZSxyLG4pfWZ1bmN0aW9uIEEoZSx0LHIsbil7cmV0dXJuICQoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHIsbixvLGk9W10sYT0wO2E8ZS5sZW5ndGgmJiEoKHQtPTIpPDApOysrYSluPShyPWUuY2hhckNvZGVBdChhKSk+Pjgsbz1yJTI1NixpLnB1c2gobyksaS5wdXNoKG4pO3JldHVybiBpfSh0LGUubGVuZ3RoLXIpLGUscixuKX1mdW5jdGlvbiBUKGUsdCxyKXtyZXR1cm4gMD09PXQmJnI9PT1lLmxlbmd0aD9uLmZyb21CeXRlQXJyYXkoZSk6bi5mcm9tQnl0ZUFycmF5KGUuc2xpY2UodCxyKSl9ZnVuY3Rpb24gUyhlLHQscil7cj1NYXRoLm1pbihlLmxlbmd0aCxyKTtmb3IodmFyIG49W10sbz10O288cjspe3ZhciBpLGEscyx1LGM9ZVtvXSxsPW51bGwsZj1jPjIzOT80OmM+MjIzPzM6Yz4xOTE/MjoxO2lmKG8rZjw9cilzd2l0Y2goZil7Y2FzZSAxOmM8MTI4JiYobD1jKTticmVhaztjYXNlIDI6MTI4PT0oMTkyJihpPWVbbysxXSkpJiYodT0oMzEmYyk8PDZ8NjMmaSk+MTI3JiYobD11KTticmVhaztjYXNlIDM6aT1lW28rMV0sYT1lW28rMl0sMTI4PT0oMTkyJmkpJiYxMjg9PSgxOTImYSkmJih1PSgxNSZjKTw8MTJ8KDYzJmkpPDw2fDYzJmEpPjIwNDcmJih1PDU1Mjk2fHx1PjU3MzQzKSYmKGw9dSk7YnJlYWs7Y2FzZSA0Omk9ZVtvKzFdLGE9ZVtvKzJdLHM9ZVtvKzNdLDEyOD09KDE5MiZpKSYmMTI4PT0oMTkyJmEpJiYxMjg9PSgxOTImcykmJih1PSgxNSZjKTw8MTh8KDYzJmkpPDwxMnwoNjMmYSk8PDZ8NjMmcyk+NjU1MzUmJnU8MTExNDExMiYmKGw9dSl9bnVsbD09PWw/KGw9NjU1MzMsZj0xKTpsPjY1NTM1JiYobC09NjU1MzYsbi5wdXNoKGw+Pj4xMCYxMDIzfDU1Mjk2KSxsPTU2MzIwfDEwMjMmbCksbi5wdXNoKGwpLG8rPWZ9cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0PWUubGVuZ3RoO2lmKHQ8PWspcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLGUpO2Zvcih2YXIgcj0iIixuPTA7bjx0OylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZyxlLnNsaWNlKG4sbis9aykpO3JldHVybiByfShuKX10LkJ1ZmZlcj11LHQuU2xvd0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4rZSE9ZSYmKGU9MCksdS5hbGxvYygrZSl9LHQuSU5TUEVDVF9NQVhfQllURVM9NTAsdS5UWVBFRF9BUlJBWV9TVVBQT1JUPXZvaWQgMCE9PWUuVFlQRURfQVJSQVlfU1VQUE9SVD9lLlRZUEVEX0FSUkFZX1NVUFBPUlQ6ZnVuY3Rpb24oKXt0cnl7dmFyIGU9bmV3IFVpbnQ4QXJyYXkoMSk7cmV0dXJuIGUuX19wcm90b19fPXtfX3Byb3RvX186VWludDhBcnJheS5wcm90b3R5cGUsZm9vOmZ1bmN0aW9uKCl7cmV0dXJuIDQyfX0sNDI9PT1lLmZvbygpJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5zdWJhcnJheSYmMD09PWUuc3ViYXJyYXkoMSwxKS5ieXRlTGVuZ3RofWNhdGNoKGUpe3JldHVybiExfX0oKSx0LmtNYXhMZW5ndGg9YSgpLHUucG9vbFNpemU9ODE5Mix1Ll9hdWdtZW50PWZ1bmN0aW9uKGUpe3JldHVybiBlLl9fcHJvdG9fXz11LnByb3RvdHlwZSxlfSx1LmZyb209ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBjKG51bGwsZSx0LHIpfSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQmJih1LnByb3RvdHlwZS5fX3Byb3RvX189VWludDhBcnJheS5wcm90b3R5cGUsdS5fX3Byb3RvX189VWludDhBcnJheSwidW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnNwZWNpZXMmJnVbU3ltYm9sLnNwZWNpZXNdPT09dSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHUsU3ltYm9sLnNwZWNpZXMse3ZhbHVlOm51bGwsY29uZmlndXJhYmxlOiEwfSkpLHUuYWxsb2M9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBmdW5jdGlvbihlLHQscixuKXtyZXR1cm4gbCh0KSx0PD0wP3MoZSx0KTp2b2lkIDAhPT1yPyJzdHJpbmciPT10eXBlb2Ygbj9zKGUsdCkuZmlsbChyLG4pOnMoZSx0KS5maWxsKHIpOnMoZSx0KX0obnVsbCxlLHQscil9LHUuYWxsb2NVbnNhZmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGYobnVsbCxlKX0sdS5hbGxvY1Vuc2FmZVNsb3c9ZnVuY3Rpb24oZSl7cmV0dXJuIGYobnVsbCxlKX0sdS5pc0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4hKG51bGw9PWV8fCFlLl9pc0J1ZmZlcil9LHUuY29tcGFyZT1mdW5jdGlvbihlLHQpe2lmKCF1LmlzQnVmZmVyKGUpfHwhdS5pc0J1ZmZlcih0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzIik7aWYoZT09PXQpcmV0dXJuIDA7Zm9yKHZhciByPWUubGVuZ3RoLG49dC5sZW5ndGgsbz0wLGk9TWF0aC5taW4ocixuKTtvPGk7KytvKWlmKGVbb10hPT10W29dKXtyPWVbb10sbj10W29dO2JyZWFrfXJldHVybiByPG4/LTE6bjxyPzE6MH0sdS5pc0VuY29kaW5nPWZ1bmN0aW9uKGUpe3N3aXRjaChTdHJpbmcoZSkudG9Mb3dlckNhc2UoKSl7Y2FzZSJoZXgiOmNhc2UidXRmOCI6Y2FzZSJ1dGYtOCI6Y2FzZSJhc2NpaSI6Y2FzZSJsYXRpbjEiOmNhc2UiYmluYXJ5IjpjYXNlImJhc2U2NCI6Y2FzZSJ1Y3MyIjpjYXNlInVjcy0yIjpjYXNlInV0ZjE2bGUiOmNhc2UidXRmLTE2bGUiOnJldHVybiEwO2RlZmF1bHQ6cmV0dXJuITF9fSx1LmNvbmNhdD1mdW5jdGlvbihlLHQpe2lmKCFpKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIHUuYWxsb2MoMCk7dmFyIHI7aWYodm9pZCAwPT09dClmb3IodD0wLHI9MDtyPGUubGVuZ3RoOysrcil0Kz1lW3JdLmxlbmd0aDt2YXIgbj11LmFsbG9jVW5zYWZlKHQpLG89MDtmb3Iocj0wO3I8ZS5sZW5ndGg7KytyKXt2YXIgYT1lW3JdO2lmKCF1LmlzQnVmZmVyKGEpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTthLmNvcHkobixvKSxvKz1hLmxlbmd0aH1yZXR1cm4gbn0sdS5ieXRlTGVuZ3RoPXAsdS5wcm90b3R5cGUuX2lzQnVmZmVyPSEwLHUucHJvdG90eXBlLnN3YXAxNj1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGUlMiE9MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDE2LWJpdHMiKTtmb3IodmFyIHQ9MDt0PGU7dCs9MiltKHRoaXMsdCx0KzEpO3JldHVybiB0aGlzfSx1LnByb3RvdHlwZS5zd2FwMzI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxlbmd0aDtpZihlJTQhPTApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzIik7Zm9yKHZhciB0PTA7dDxlO3QrPTQpbSh0aGlzLHQsdCszKSxtKHRoaXMsdCsxLHQrMik7cmV0dXJuIHRoaXN9LHUucHJvdG90eXBlLnN3YXA2ND1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGUlOCE9MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMiKTtmb3IodmFyIHQ9MDt0PGU7dCs9OCltKHRoaXMsdCx0KzcpLG0odGhpcyx0KzEsdCs2KSxtKHRoaXMsdCsyLHQrNSksbSh0aGlzLHQrMyx0KzQpO3JldHVybiB0aGlzfSx1LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBlPTB8dGhpcy5sZW5ndGg7cmV0dXJuIDA9PT1lPyIiOjA9PT1hcmd1bWVudHMubGVuZ3RoP1ModGhpcywwLGUpOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj0hMTtpZigodm9pZCAwPT09dHx8dDwwKSYmKHQ9MCksdD50aGlzLmxlbmd0aClyZXR1cm4iIjtpZigodm9pZCAwPT09cnx8cj50aGlzLmxlbmd0aCkmJihyPXRoaXMubGVuZ3RoKSxyPD0wKXJldHVybiIiO2lmKChyPj4+PTApPD0odD4+Pj0wKSlyZXR1cm4iIjtmb3IoZXx8KGU9InV0ZjgiKTs7KXN3aXRjaChlKXtjYXNlImhleCI6cmV0dXJuIFIodGhpcyx0LHIpO2Nhc2UidXRmOCI6Y2FzZSJ1dGYtOCI6cmV0dXJuIFModGhpcyx0LHIpO2Nhc2UiYXNjaWkiOnJldHVybiBQKHRoaXMsdCxyKTtjYXNlImxhdGluMSI6Y2FzZSJiaW5hcnkiOnJldHVybiBEKHRoaXMsdCxyKTtjYXNlImJhc2U2NCI6cmV0dXJuIFQodGhpcyx0LHIpO2Nhc2UidWNzMiI6Y2FzZSJ1Y3MtMiI6Y2FzZSJ1dGYxNmxlIjpjYXNlInV0Zi0xNmxlIjpyZXR1cm4gTyh0aGlzLHQscik7ZGVmYXVsdDppZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrZSk7ZT0oZSsiIikudG9Mb3dlckNhc2UoKSxuPSEwfX0uYXBwbHkodGhpcyxhcmd1bWVudHMpfSx1LnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7aWYoIXUuaXNCdWZmZXIoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciIpO3JldHVybiB0aGlzPT09ZXx8MD09PXUuY29tcGFyZSh0aGlzLGUpfSx1LnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7dmFyIGU9IiIscj10LklOU1BFQ1RfTUFYX0JZVEVTO3JldHVybiB0aGlzLmxlbmd0aD4wJiYoZT10aGlzLnRvU3RyaW5nKCJoZXgiLDAscikubWF0Y2goLy57Mn0vZykuam9pbigiICIpLHRoaXMubGVuZ3RoPnImJihlKz0iIC4uLiAiKSksIjxCdWZmZXIgIitlKyI+In0sdS5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihlLHQscixuLG8pe2lmKCF1LmlzQnVmZmVyKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIiKTtpZih2b2lkIDA9PT10JiYodD0wKSx2b2lkIDA9PT1yJiYocj1lP2UubGVuZ3RoOjApLHZvaWQgMD09PW4mJihuPTApLHZvaWQgMD09PW8mJihvPXRoaXMubGVuZ3RoKSx0PDB8fHI+ZS5sZW5ndGh8fG48MHx8bz50aGlzLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigib3V0IG9mIHJhbmdlIGluZGV4Iik7aWYobj49byYmdD49cilyZXR1cm4gMDtpZihuPj1vKXJldHVybi0xO2lmKHQ+PXIpcmV0dXJuIDE7aWYodGhpcz09PWUpcmV0dXJuIDA7Zm9yKHZhciBpPShvPj4+PTApLShuPj4+PTApLGE9KHI+Pj49MCktKHQ+Pj49MCkscz1NYXRoLm1pbihpLGEpLGM9dGhpcy5zbGljZShuLG8pLGw9ZS5zbGljZSh0LHIpLGY9MDtmPHM7KytmKWlmKGNbZl0hPT1sW2ZdKXtpPWNbZl0sYT1sW2ZdO2JyZWFrfXJldHVybiBpPGE/LTE6YTxpPzE6MH0sdS5wcm90b3R5cGUuaW5jbHVkZXM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybi0xIT09dGhpcy5pbmRleE9mKGUsdCxyKX0sdS5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbihlLHQscil7cmV0dXJuIHkodGhpcyxlLHQsciwhMCl9LHUucHJvdG90eXBlLmxhc3RJbmRleE9mPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4geSh0aGlzLGUsdCxyLCExKX0sdS5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZSx0LHIsbil7aWYodm9pZCAwPT09dCluPSJ1dGY4IixyPXRoaXMubGVuZ3RoLHQ9MDtlbHNlIGlmKHZvaWQgMD09PXImJiJzdHJpbmciPT10eXBlb2YgdCluPXQscj10aGlzLmxlbmd0aCx0PTA7ZWxzZXtpZighaXNGaW5pdGUodCkpdGhyb3cgbmV3IEVycm9yKCJCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCIpO3R8PTAsaXNGaW5pdGUocik/KHJ8PTAsdm9pZCAwPT09biYmKG49InV0ZjgiKSk6KG49cixyPXZvaWQgMCl9dmFyIG89dGhpcy5sZW5ndGgtdDtpZigodm9pZCAwPT09cnx8cj5vKSYmKHI9byksZS5sZW5ndGg+MCYmKHI8MHx8dDwwKXx8dD50aGlzLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMiKTtufHwobj0idXRmOCIpO2Zvcih2YXIgaT0hMTs7KXN3aXRjaChuKXtjYXNlImhleCI6cmV0dXJuIGcodGhpcyxlLHQscik7Y2FzZSJ1dGY4IjpjYXNlInV0Zi04IjpyZXR1cm4gdih0aGlzLGUsdCxyKTtjYXNlImFzY2lpIjpyZXR1cm4gdyh0aGlzLGUsdCxyKTtjYXNlImxhdGluMSI6Y2FzZSJiaW5hcnkiOnJldHVybiBfKHRoaXMsZSx0LHIpO2Nhc2UiYmFzZTY0IjpyZXR1cm4gYih0aGlzLGUsdCxyKTtjYXNlInVjczIiOmNhc2UidWNzLTIiOmNhc2UidXRmMTZsZSI6Y2FzZSJ1dGYtMTZsZSI6cmV0dXJuIEEodGhpcyxlLHQscik7ZGVmYXVsdDppZihpKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrbik7bj0oIiIrbikudG9Mb3dlckNhc2UoKSxpPSEwfX0sdS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6IkJ1ZmZlciIsZGF0YTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLl9hcnJ8fHRoaXMsMCl9fTt2YXIgaz00MDk2O2Z1bmN0aW9uIFAoZSx0LHIpe3ZhciBuPSIiO3I9TWF0aC5taW4oZS5sZW5ndGgscik7Zm9yKHZhciBvPXQ7bzxyOysrbyluKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDEyNyZlW29dKTtyZXR1cm4gbn1mdW5jdGlvbiBEKGUsdCxyKXt2YXIgbj0iIjtyPU1hdGgubWluKGUubGVuZ3RoLHIpO2Zvcih2YXIgbz10O288cjsrK28pbis9U3RyaW5nLmZyb21DaGFyQ29kZShlW29dKTtyZXR1cm4gbn1mdW5jdGlvbiBSKGUsdCxyKXt2YXIgbj1lLmxlbmd0aDsoIXR8fHQ8MCkmJih0PTApLCghcnx8cjwwfHxyPm4pJiYocj1uKTtmb3IodmFyIG89IiIsaT10O2k8cjsrK2kpbys9aihlW2ldKTtyZXR1cm4gb31mdW5jdGlvbiBPKGUsdCxyKXtmb3IodmFyIG49ZS5zbGljZSh0LHIpLG89IiIsaT0wO2k8bi5sZW5ndGg7aSs9MilvKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG5baV0rMjU2Km5baSsxXSk7cmV0dXJuIG99ZnVuY3Rpb24gQyhlLHQscil7aWYoZSUxIT0wfHxlPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm9mZnNldCBpcyBub3QgdWludCIpO2lmKGUrdD5yKXRocm93IG5ldyBSYW5nZUVycm9yKCJUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoIil9ZnVuY3Rpb24gTihlLHQscixuLG8saSl7aWYoIXUuaXNCdWZmZXIoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcignImJ1ZmZlciIgYXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciBpbnN0YW5jZScpO2lmKHQ+b3x8dDxpKXRocm93IG5ldyBSYW5nZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKTtpZihyK24+ZS5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEYoZSx0LHIsbil7dDwwJiYodD02NTUzNSt0KzEpO2Zvcih2YXIgbz0wLGk9TWF0aC5taW4oZS5sZW5ndGgtciwyKTtvPGk7KytvKWVbcitvXT0odCYyNTU8PDgqKG4/bzoxLW8pKT4+PjgqKG4/bzoxLW8pfWZ1bmN0aW9uIE0oZSx0LHIsbil7dDwwJiYodD00Mjk0OTY3Mjk1K3QrMSk7Zm9yKHZhciBvPTAsaT1NYXRoLm1pbihlLmxlbmd0aC1yLDQpO288aTsrK28pZVtyK29dPXQ+Pj44KihuP286My1vKSYyNTV9ZnVuY3Rpb24gSShlLHQscixuLG8saSl7aWYocituPmUubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJJbmRleCBvdXQgb2YgcmFuZ2UiKTtpZihyPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEIoZSx0LHIsbixpKXtyZXR1cm4gaXx8SShlLDAsciw0KSxvLndyaXRlKGUsdCxyLG4sMjMsNCkscis0fWZ1bmN0aW9uIEwoZSx0LHIsbixpKXtyZXR1cm4gaXx8SShlLDAsciw4KSxvLndyaXRlKGUsdCxyLG4sNTIsOCkscis4fXUucHJvdG90eXBlLnNsaWNlPWZ1bmN0aW9uKGUsdCl7dmFyIHIsbj10aGlzLmxlbmd0aDtpZigoZT1+fmUpPDA/KGUrPW4pPDAmJihlPTApOmU+biYmKGU9biksKHQ9dm9pZCAwPT09dD9uOn5+dCk8MD8odCs9bik8MCYmKHQ9MCk6dD5uJiYodD1uKSx0PGUmJih0PWUpLHUuVFlQRURfQVJSQVlfU1VQUE9SVCkocj10aGlzLnN1YmFycmF5KGUsdCkpLl9fcHJvdG9fXz11LnByb3RvdHlwZTtlbHNle3ZhciBvPXQtZTtyPW5ldyB1KG8sdm9pZCAwKTtmb3IodmFyIGk9MDtpPG87KytpKXJbaV09dGhpc1tpK2VdfXJldHVybiByfSx1LnByb3RvdHlwZS5yZWFkVUludExFPWZ1bmN0aW9uKGUsdCxyKXtlfD0wLHR8PTAscnx8QyhlLHQsdGhpcy5sZW5ndGgpO2Zvcih2YXIgbj10aGlzW2VdLG89MSxpPTA7KytpPHQmJihvKj0yNTYpOyluKz10aGlzW2UraV0qbztyZXR1cm4gbn0sdS5wcm90b3R5cGUucmVhZFVJbnRCRT1mdW5jdGlvbihlLHQscil7ZXw9MCx0fD0wLHJ8fEMoZSx0LHRoaXMubGVuZ3RoKTtmb3IodmFyIG49dGhpc1tlKy0tdF0sbz0xO3Q+MCYmKG8qPTI1Nik7KW4rPXRoaXNbZSstLXRdKm87cmV0dXJuIG59LHUucHJvdG90eXBlLnJlYWRVSW50OD1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsMSx0aGlzLmxlbmd0aCksdGhpc1tlXX0sdS5wcm90b3R5cGUucmVhZFVJbnQxNkxFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSwyLHRoaXMubGVuZ3RoKSx0aGlzW2VdfHRoaXNbZSsxXTw8OH0sdS5wcm90b3R5cGUucmVhZFVJbnQxNkJFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSwyLHRoaXMubGVuZ3RoKSx0aGlzW2VdPDw4fHRoaXNbZSsxXX0sdS5wcm90b3R5cGUucmVhZFVJbnQzMkxFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSw0LHRoaXMubGVuZ3RoKSwodGhpc1tlXXx0aGlzW2UrMV08PDh8dGhpc1tlKzJdPDwxNikrMTY3NzcyMTYqdGhpc1tlKzNdfSx1LnByb3RvdHlwZS5yZWFkVUludDMyQkU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8QyhlLDQsdGhpcy5sZW5ndGgpLDE2Nzc3MjE2KnRoaXNbZV0rKHRoaXNbZSsxXTw8MTZ8dGhpc1tlKzJdPDw4fHRoaXNbZSszXSl9LHUucHJvdG90eXBlLnJlYWRJbnRMRT1mdW5jdGlvbihlLHQscil7ZXw9MCx0fD0wLHJ8fEMoZSx0LHRoaXMubGVuZ3RoKTtmb3IodmFyIG49dGhpc1tlXSxvPTEsaT0wOysraTx0JiYobyo9MjU2KTspbis9dGhpc1tlK2ldKm87cmV0dXJuIG4+PShvKj0xMjgpJiYobi09TWF0aC5wb3coMiw4KnQpKSxufSx1LnByb3RvdHlwZS5yZWFkSW50QkU9ZnVuY3Rpb24oZSx0LHIpe2V8PTAsdHw9MCxyfHxDKGUsdCx0aGlzLmxlbmd0aCk7Zm9yKHZhciBuPXQsbz0xLGk9dGhpc1tlKy0tbl07bj4wJiYobyo9MjU2KTspaSs9dGhpc1tlKy0tbl0qbztyZXR1cm4gaT49KG8qPTEyOCkmJihpLT1NYXRoLnBvdygyLDgqdCkpLGl9LHUucHJvdG90eXBlLnJlYWRJbnQ4PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSwxLHRoaXMubGVuZ3RoKSwxMjgmdGhpc1tlXT8tMSooMjU1LXRoaXNbZV0rMSk6dGhpc1tlXX0sdS5wcm90b3R5cGUucmVhZEludDE2TEU9ZnVuY3Rpb24oZSx0KXt0fHxDKGUsMix0aGlzLmxlbmd0aCk7dmFyIHI9dGhpc1tlXXx0aGlzW2UrMV08PDg7cmV0dXJuIDMyNzY4JnI/NDI5NDkwMTc2MHxyOnJ9LHUucHJvdG90eXBlLnJlYWRJbnQxNkJFPWZ1bmN0aW9uKGUsdCl7dHx8QyhlLDIsdGhpcy5sZW5ndGgpO3ZhciByPXRoaXNbZSsxXXx0aGlzW2VdPDw4O3JldHVybiAzMjc2OCZyPzQyOTQ5MDE3NjB8cjpyfSx1LnByb3RvdHlwZS5yZWFkSW50MzJMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsNCx0aGlzLmxlbmd0aCksdGhpc1tlXXx0aGlzW2UrMV08PDh8dGhpc1tlKzJdPDwxNnx0aGlzW2UrM108PDI0fSx1LnByb3RvdHlwZS5yZWFkSW50MzJCRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsNCx0aGlzLmxlbmd0aCksdGhpc1tlXTw8MjR8dGhpc1tlKzFdPDwxNnx0aGlzW2UrMl08PDh8dGhpc1tlKzNdfSx1LnByb3RvdHlwZS5yZWFkRmxvYXRMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsNCx0aGlzLmxlbmd0aCksby5yZWFkKHRoaXMsZSwhMCwyMyw0KX0sdS5wcm90b3R5cGUucmVhZEZsb2F0QkU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8QyhlLDQsdGhpcy5sZW5ndGgpLG8ucmVhZCh0aGlzLGUsITEsMjMsNCl9LHUucHJvdG90eXBlLnJlYWREb3VibGVMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsOCx0aGlzLmxlbmd0aCksby5yZWFkKHRoaXMsZSwhMCw1Miw4KX0sdS5wcm90b3R5cGUucmVhZERvdWJsZUJFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSw4LHRoaXMubGVuZ3RoKSxvLnJlYWQodGhpcyxlLCExLDUyLDgpfSx1LnByb3RvdHlwZS53cml0ZVVJbnRMRT1mdW5jdGlvbihlLHQscixuKXtlPStlLHR8PTAscnw9MCxufHxOKHRoaXMsZSx0LHIsTWF0aC5wb3coMiw4KnIpLTEsMCk7dmFyIG89MSxpPTA7Zm9yKHRoaXNbdF09MjU1JmU7KytpPHImJihvKj0yNTYpOyl0aGlzW3QraV09ZS9vJjI1NTtyZXR1cm4gdCtyfSx1LnByb3RvdHlwZS53cml0ZVVJbnRCRT1mdW5jdGlvbihlLHQscixuKXtlPStlLHR8PTAscnw9MCxufHxOKHRoaXMsZSx0LHIsTWF0aC5wb3coMiw4KnIpLTEsMCk7dmFyIG89ci0xLGk9MTtmb3IodGhpc1t0K29dPTI1NSZlOy0tbz49MCYmKGkqPTI1Nik7KXRoaXNbdCtvXT1lL2kmMjU1O3JldHVybiB0K3J9LHUucHJvdG90eXBlLndyaXRlVUludDg9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlPStlLHR8PTAscnx8Tih0aGlzLGUsdCwxLDI1NSwwKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlR8fChlPU1hdGguZmxvb3IoZSkpLHRoaXNbdF09MjU1JmUsdCsxfSx1LnByb3RvdHlwZS53cml0ZVVJbnQxNkxFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT0rZSx0fD0wLHJ8fE4odGhpcyxlLHQsMiw2NTUzNSwwKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09MjU1JmUsdGhpc1t0KzFdPWU+Pj44KTpGKHRoaXMsZSx0LCEwKSx0KzJ9LHUucHJvdG90eXBlLndyaXRlVUludDE2QkU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlPStlLHR8PTAscnx8Tih0aGlzLGUsdCwyLDY1NTM1LDApLHUuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT1lPj4+OCx0aGlzW3QrMV09MjU1JmUpOkYodGhpcyxlLHQsITEpLHQrMn0sdS5wcm90b3R5cGUud3JpdGVVSW50MzJMRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDQsNDI5NDk2NzI5NSwwKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdCszXT1lPj4+MjQsdGhpc1t0KzJdPWU+Pj4xNix0aGlzW3QrMV09ZT4+PjgsdGhpc1t0XT0yNTUmZSk6TSh0aGlzLGUsdCwhMCksdCs0fSx1LnByb3RvdHlwZS53cml0ZVVJbnQzMkJFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT0rZSx0fD0wLHJ8fE4odGhpcyxlLHQsNCw0Mjk0OTY3Mjk1LDApLHUuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT1lPj4+MjQsdGhpc1t0KzFdPWU+Pj4xNix0aGlzW3QrMl09ZT4+PjgsdGhpc1t0KzNdPTI1NSZlKTpNKHRoaXMsZSx0LCExKSx0KzR9LHUucHJvdG90eXBlLndyaXRlSW50TEU9ZnVuY3Rpb24oZSx0LHIsbil7aWYoZT0rZSx0fD0wLCFuKXt2YXIgbz1NYXRoLnBvdygyLDgqci0xKTtOKHRoaXMsZSx0LHIsby0xLC1vKX12YXIgaT0wLGE9MSxzPTA7Zm9yKHRoaXNbdF09MjU1JmU7KytpPHImJihhKj0yNTYpOyllPDAmJjA9PT1zJiYwIT09dGhpc1t0K2ktMV0mJihzPTEpLHRoaXNbdCtpXT0oZS9hPj4wKS1zJjI1NTtyZXR1cm4gdCtyfSx1LnByb3RvdHlwZS53cml0ZUludEJFPWZ1bmN0aW9uKGUsdCxyLG4pe2lmKGU9K2UsdHw9MCwhbil7dmFyIG89TWF0aC5wb3coMiw4KnItMSk7Tih0aGlzLGUsdCxyLG8tMSwtbyl9dmFyIGk9ci0xLGE9MSxzPTA7Zm9yKHRoaXNbdCtpXT0yNTUmZTstLWk+PTAmJihhKj0yNTYpOyllPDAmJjA9PT1zJiYwIT09dGhpc1t0K2krMV0mJihzPTEpLHRoaXNbdCtpXT0oZS9hPj4wKS1zJjI1NTtyZXR1cm4gdCtyfSx1LnByb3RvdHlwZS53cml0ZUludDg9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlPStlLHR8PTAscnx8Tih0aGlzLGUsdCwxLDEyNywtMTI4KSx1LlRZUEVEX0FSUkFZX1NVUFBPUlR8fChlPU1hdGguZmxvb3IoZSkpLGU8MCYmKGU9MjU1K2UrMSksdGhpc1t0XT0yNTUmZSx0KzF9LHUucHJvdG90eXBlLndyaXRlSW50MTZMRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDIsMzI3NjcsLTMyNzY4KSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09MjU1JmUsdGhpc1t0KzFdPWU+Pj44KTpGKHRoaXMsZSx0LCEwKSx0KzJ9LHUucHJvdG90eXBlLndyaXRlSW50MTZCRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDIsMzI3NjcsLTMyNzY4KSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09ZT4+PjgsdGhpc1t0KzFdPTI1NSZlKTpGKHRoaXMsZSx0LCExKSx0KzJ9LHUucHJvdG90eXBlLndyaXRlSW50MzJMRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDQsMjE0NzQ4MzY0NywtMjE0NzQ4MzY0OCksdS5UWVBFRF9BUlJBWV9TVVBQT1JUPyh0aGlzW3RdPTI1NSZlLHRoaXNbdCsxXT1lPj4+OCx0aGlzW3QrMl09ZT4+PjE2LHRoaXNbdCszXT1lPj4+MjQpOk0odGhpcyxlLHQsITApLHQrNH0sdS5wcm90b3R5cGUud3JpdGVJbnQzMkJFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT0rZSx0fD0wLHJ8fE4odGhpcyxlLHQsNCwyMTQ3NDgzNjQ3LC0yMTQ3NDgzNjQ4KSxlPDAmJihlPTQyOTQ5NjcyOTUrZSsxKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09ZT4+PjI0LHRoaXNbdCsxXT1lPj4+MTYsdGhpc1t0KzJdPWU+Pj44LHRoaXNbdCszXT0yNTUmZSk6TSh0aGlzLGUsdCwhMSksdCs0fSx1LnByb3RvdHlwZS53cml0ZUZsb2F0TEU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBCKHRoaXMsZSx0LCEwLHIpfSx1LnByb3RvdHlwZS53cml0ZUZsb2F0QkU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBCKHRoaXMsZSx0LCExLHIpfSx1LnByb3RvdHlwZS53cml0ZURvdWJsZUxFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gTCh0aGlzLGUsdCwhMCxyKX0sdS5wcm90b3R5cGUud3JpdGVEb3VibGVCRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIEwodGhpcyxlLHQsITEscil9LHUucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSx0LHIsbil7aWYocnx8KHI9MCksbnx8MD09PW58fChuPXRoaXMubGVuZ3RoKSx0Pj1lLmxlbmd0aCYmKHQ9ZS5sZW5ndGgpLHR8fCh0PTApLG4+MCYmbjxyJiYobj1yKSxuPT09cilyZXR1cm4gMDtpZigwPT09ZS5sZW5ndGh8fDA9PT10aGlzLmxlbmd0aClyZXR1cm4gMDtpZih0PDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoInRhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMiKTtpZihyPDB8fHI+PXRoaXMubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzIik7aWYobjwwKXRocm93IG5ldyBSYW5nZUVycm9yKCJzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcyIpO24+dGhpcy5sZW5ndGgmJihuPXRoaXMubGVuZ3RoKSxlLmxlbmd0aC10PG4tciYmKG49ZS5sZW5ndGgtdCtyKTt2YXIgbyxpPW4tcjtpZih0aGlzPT09ZSYmcjx0JiZ0PG4pZm9yKG89aS0xO28+PTA7LS1vKWVbbyt0XT10aGlzW28rcl07ZWxzZSBpZihpPDFlM3x8IXUuVFlQRURfQVJSQVlfU1VQUE9SVClmb3Iobz0wO288aTsrK28pZVtvK3RdPXRoaXNbbytyXTtlbHNlIFVpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKGUsdGhpcy5zdWJhcnJheShyLHIraSksdCk7cmV0dXJuIGl9LHUucHJvdG90eXBlLmZpbGw9ZnVuY3Rpb24oZSx0LHIsbil7aWYoInN0cmluZyI9PXR5cGVvZiBlKXtpZigic3RyaW5nIj09dHlwZW9mIHQ/KG49dCx0PTAscj10aGlzLmxlbmd0aCk6InN0cmluZyI9PXR5cGVvZiByJiYobj1yLHI9dGhpcy5sZW5ndGgpLDE9PT1lLmxlbmd0aCl7dmFyIG89ZS5jaGFyQ29kZUF0KDApO288MjU2JiYoZT1vKX1pZih2b2lkIDAhPT1uJiYic3RyaW5nIiE9dHlwZW9mIG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZyIpO2lmKCJzdHJpbmciPT10eXBlb2YgbiYmIXUuaXNFbmNvZGluZyhuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIGVuY29kaW5nOiAiK24pfWVsc2UibnVtYmVyIj09dHlwZW9mIGUmJihlJj0yNTUpO2lmKHQ8MHx8dGhpcy5sZW5ndGg8dHx8dGhpcy5sZW5ndGg8cil0aHJvdyBuZXcgUmFuZ2VFcnJvcigiT3V0IG9mIHJhbmdlIGluZGV4Iik7aWYocjw9dClyZXR1cm4gdGhpczt2YXIgaTtpZih0Pj4+PTAscj12b2lkIDA9PT1yP3RoaXMubGVuZ3RoOnI+Pj4wLGV8fChlPTApLCJudW1iZXIiPT10eXBlb2YgZSlmb3IoaT10O2k8cjsrK2kpdGhpc1tpXT1lO2Vsc2V7dmFyIGE9dS5pc0J1ZmZlcihlKT9lOlUobmV3IHUoZSxuKS50b1N0cmluZygpKSxzPWEubGVuZ3RoO2ZvcihpPTA7aTxyLXQ7KytpKXRoaXNbaSt0XT1hW2klc119cmV0dXJuIHRoaXN9O3ZhciB4PS9bXitcLzAtOUEtWmEtei1fXS9nO2Z1bmN0aW9uIGooZSl7cmV0dXJuIGU8MTY/IjAiK2UudG9TdHJpbmcoMTYpOmUudG9TdHJpbmcoMTYpfWZ1bmN0aW9uIFUoZSx0KXt2YXIgcjt0PXR8fDEvMDtmb3IodmFyIG49ZS5sZW5ndGgsbz1udWxsLGk9W10sYT0wO2E8bjsrK2Epe2lmKChyPWUuY2hhckNvZGVBdChhKSk+NTUyOTUmJnI8NTczNDQpe2lmKCFvKXtpZihyPjU2MzE5KXsodC09Myk+LTEmJmkucHVzaCgyMzksMTkxLDE4OSk7Y29udGludWV9aWYoYSsxPT09bil7KHQtPTMpPi0xJiZpLnB1c2goMjM5LDE5MSwxODkpO2NvbnRpbnVlfW89cjtjb250aW51ZX1pZihyPDU2MzIwKXsodC09Myk+LTEmJmkucHVzaCgyMzksMTkxLDE4OSksbz1yO2NvbnRpbnVlfXI9NjU1MzYrKG8tNTUyOTY8PDEwfHItNTYzMjApfWVsc2UgbyYmKHQtPTMpPi0xJiZpLnB1c2goMjM5LDE5MSwxODkpO2lmKG89bnVsbCxyPDEyOCl7aWYoKHQtPTEpPDApYnJlYWs7aS5wdXNoKHIpfWVsc2UgaWYocjwyMDQ4KXtpZigodC09Mik8MClicmVhaztpLnB1c2gocj4+NnwxOTIsNjMmcnwxMjgpfWVsc2UgaWYocjw2NTUzNil7aWYoKHQtPTMpPDApYnJlYWs7aS5wdXNoKHI+PjEyfDIyNCxyPj42JjYzfDEyOCw2MyZyfDEyOCl9ZWxzZXtpZighKHI8MTExNDExMikpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGNvZGUgcG9pbnQiKTtpZigodC09NCk8MClicmVhaztpLnB1c2gocj4+MTh8MjQwLHI+PjEyJjYzfDEyOCxyPj42JjYzfDEyOCw2MyZyfDEyOCl9fXJldHVybiBpfWZ1bmN0aW9uIHooZSl7cmV0dXJuIG4udG9CeXRlQXJyYXkoZnVuY3Rpb24oZSl7aWYoKGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUudHJpbT9lLnRyaW0oKTplLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKX0oZSkucmVwbGFjZSh4LCIiKSkubGVuZ3RoPDIpcmV0dXJuIiI7Zm9yKDtlLmxlbmd0aCU0IT0wOyllKz0iPSI7cmV0dXJuIGV9KGUpKX1mdW5jdGlvbiAkKGUsdCxyLG4pe2Zvcih2YXIgbz0wO288biYmIShvK3I+PXQubGVuZ3RofHxvPj1lLmxlbmd0aCk7KytvKXRbbytyXT1lW29dO3JldHVybiBvfX0pLmNhbGwodGhpcyxyKDgpKX0sZnVuY3Rpb24oZSx0KXt2YXIgcjtyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCk7dHJ5e3I9cnx8RnVuY3Rpb24oInJldHVybiB0aGlzIikoKXx8KDAsZXZhbCkoInRoaXMiKX1jYXRjaChlKXsib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyYmKHI9d2luZG93KX1lLmV4cG9ydHM9cn0sZnVuY3Rpb24oZSx0LHIpe3QuYnl0ZUxlbmd0aD1mdW5jdGlvbihlKXt2YXIgdD1jKGUpLHI9dFswXSxuPXRbMV07cmV0dXJuIDMqKHIrbikvNC1ufSx0LnRvQnl0ZUFycmF5PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxyPWMoZSksbj1yWzBdLGE9clsxXSxzPW5ldyBpKGZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gMyoodCtyKS80LXJ9KDAsbixhKSksdT0wLGw9YT4wP24tNDpuLGY9MDtmPGw7Zis9NCl0PW9bZS5jaGFyQ29kZUF0KGYpXTw8MTh8b1tlLmNoYXJDb2RlQXQoZisxKV08PDEyfG9bZS5jaGFyQ29kZUF0KGYrMildPDw2fG9bZS5jaGFyQ29kZUF0KGYrMyldLHNbdSsrXT10Pj4xNiYyNTUsc1t1KytdPXQ+PjgmMjU1LHNbdSsrXT0yNTUmdDtyZXR1cm4gMj09PWEmJih0PW9bZS5jaGFyQ29kZUF0KGYpXTw8MnxvW2UuY2hhckNvZGVBdChmKzEpXT4+NCxzW3UrK109MjU1JnQpLDE9PT1hJiYodD1vW2UuY2hhckNvZGVBdChmKV08PDEwfG9bZS5jaGFyQ29kZUF0KGYrMSldPDw0fG9bZS5jaGFyQ29kZUF0KGYrMildPj4yLHNbdSsrXT10Pj44JjI1NSxzW3UrK109MjU1JnQpLHN9LHQuZnJvbUJ5dGVBcnJheT1mdW5jdGlvbihlKXtmb3IodmFyIHQscj1lLmxlbmd0aCxvPXIlMyxpPVtdLGE9MCxzPXItbzthPHM7YSs9MTYzODMpaS5wdXNoKGYoZSxhLGErMTYzODM+cz9zOmErMTYzODMpKTtyZXR1cm4gMT09PW8/KHQ9ZVtyLTFdLGkucHVzaChuW3Q+PjJdK25bdDw8NCY2M10rIj09IikpOjI9PT1vJiYodD0oZVtyLTJdPDw4KStlW3ItMV0saS5wdXNoKG5bdD4+MTBdK25bdD4+NCY2M10rblt0PDwyJjYzXSsiPSIpKSxpLmpvaW4oIiIpfTtmb3IodmFyIG49W10sbz1bXSxpPSJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheT9VaW50OEFycmF5OkFycmF5LGE9IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iLHM9MCx1PWEubGVuZ3RoO3M8dTsrK3MpbltzXT1hW3NdLG9bYS5jaGFyQ29kZUF0KHMpXT1zO2Z1bmN0aW9uIGMoZSl7dmFyIHQ9ZS5sZW5ndGg7aWYodCU0PjApdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0Iik7dmFyIHI9ZS5pbmRleE9mKCI9Iik7cmV0dXJuLTE9PT1yJiYocj10KSxbcixyPT09dD8wOjQtciU0XX1mdW5jdGlvbiBsKGUpe3JldHVybiBuW2U+PjE4JjYzXStuW2U+PjEyJjYzXStuW2U+PjYmNjNdK25bNjMmZV19ZnVuY3Rpb24gZihlLHQscil7Zm9yKHZhciBuLG89W10saT10O2k8cjtpKz0zKW49KGVbaV08PDE2JjE2NzExNjgwKSsoZVtpKzFdPDw4JjY1MjgwKSsoMjU1JmVbaSsyXSksby5wdXNoKGwobikpO3JldHVybiBvLmpvaW4oIiIpfW9bIi0iLmNoYXJDb2RlQXQoMCldPTYyLG9bIl8iLmNoYXJDb2RlQXQoMCldPTYzfSxmdW5jdGlvbihlLHQpe3QucmVhZD1mdW5jdGlvbihlLHQscixuLG8pe3ZhciBpLGEscz04Km8tbi0xLHU9KDE8PHMpLTEsYz11Pj4xLGw9LTcsZj1yP28tMTowLGQ9cj8tMToxLGg9ZVt0K2ZdO2ZvcihmKz1kLGk9aCYoMTw8LWwpLTEsaD4+PS1sLGwrPXM7bD4wO2k9MjU2KmkrZVt0K2ZdLGYrPWQsbC09OCk7Zm9yKGE9aSYoMTw8LWwpLTEsaT4+PS1sLGwrPW47bD4wO2E9MjU2KmErZVt0K2ZdLGYrPWQsbC09OCk7aWYoMD09PWkpaT0xLWM7ZWxzZXtpZihpPT09dSlyZXR1cm4gYT9OYU46MS8wKihoPy0xOjEpO2ErPU1hdGgucG93KDIsbiksaS09Y31yZXR1cm4oaD8tMToxKSphKk1hdGgucG93KDIsaS1uKX0sdC53cml0ZT1mdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGEscyx1LGM9OCppLW8tMSxsPSgxPDxjKS0xLGY9bD4+MSxkPTIzPT09bz9NYXRoLnBvdygyLC0yNCktTWF0aC5wb3coMiwtNzcpOjAsaD1uPzA6aS0xLHA9bj8xOi0xLG09dDwwfHwwPT09dCYmMS90PDA/MTowO2Zvcih0PU1hdGguYWJzKHQpLGlzTmFOKHQpfHx0PT09MS8wPyhzPWlzTmFOKHQpPzE6MCxhPWwpOihhPU1hdGguZmxvb3IoTWF0aC5sb2codCkvTWF0aC5MTjIpLHQqKHU9TWF0aC5wb3coMiwtYSkpPDEmJihhLS0sdSo9MiksKHQrPWErZj49MT9kL3U6ZCpNYXRoLnBvdygyLDEtZikpKnU+PTImJihhKyssdS89MiksYStmPj1sPyhzPTAsYT1sKTphK2Y+PTE/KHM9KHQqdS0xKSpNYXRoLnBvdygyLG8pLGErPWYpOihzPXQqTWF0aC5wb3coMixmLTEpKk1hdGgucG93KDIsbyksYT0wKSk7bz49ODtlW3IraF09MjU1JnMsaCs9cCxzLz0yNTYsby09OCk7Zm9yKGE9YTw8b3xzLGMrPW87Yz4wO2VbcitoXT0yNTUmYSxoKz1wLGEvPTI1NixjLT04KTtlW3IraC1wXXw9MTI4Km19fSxmdW5jdGlvbihlLHQpe3ZhciByPXt9LnRvU3RyaW5nO2UuZXhwb3J0cz1BcnJheS5pc0FycmF5fHxmdW5jdGlvbihlKXtyZXR1cm4iW29iamVjdCBBcnJheV0iPT1yLmNhbGwoZSl9fSxmdW5jdGlvbih0LHIpe3QuZXhwb3J0cz1lfSxmdW5jdGlvbihlLHQscil7KGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHIoZSx0KXtmb3IodmFyIHI9MCxuPWUubGVuZ3RoLTE7bj49MDtuLS0pe3ZhciBvPWVbbl07Ii4iPT09bz9lLnNwbGljZShuLDEpOiIuLiI9PT1vPyhlLnNwbGljZShuLDEpLHIrKyk6ciYmKGUuc3BsaWNlKG4sMSksci0tKX1pZih0KWZvcig7ci0tO3IpZS51bnNoaWZ0KCIuLiIpO3JldHVybiBlfXZhciBuPS9eKFwvP3wpKFtcc1xTXSo/KSgoPzpcLnsxLDJ9fFteXC9dKz98KShcLlteLlwvXSp8KSkoPzpbXC9dKikkLyxvPWZ1bmN0aW9uKGUpe3JldHVybiBuLmV4ZWMoZSkuc2xpY2UoMSl9O2Z1bmN0aW9uIGkoZSx0KXtpZihlLmZpbHRlcilyZXR1cm4gZS5maWx0ZXIodCk7Zm9yKHZhciByPVtdLG49MDtuPGUubGVuZ3RoO24rKyl0KGVbbl0sbixlKSYmci5wdXNoKGVbbl0pO3JldHVybiByfXQucmVzb2x2ZT1mdW5jdGlvbigpe2Zvcih2YXIgdD0iIixuPSExLG89YXJndW1lbnRzLmxlbmd0aC0xO28+PS0xJiYhbjtvLS0pe3ZhciBhPW8+PTA/YXJndW1lbnRzW29dOmUuY3dkKCk7aWYoInN0cmluZyIhPXR5cGVvZiBhKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50cyB0byBwYXRoLnJlc29sdmUgbXVzdCBiZSBzdHJpbmdzIik7YSYmKHQ9YSsiLyIrdCxuPSIvIj09PWEuY2hhckF0KDApKX1yZXR1cm4obj8iLyI6IiIpKyh0PXIoaSh0LnNwbGl0KCIvIiksKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhbikuam9pbigiLyIpKXx8Ii4ifSx0Lm5vcm1hbGl6ZT1mdW5jdGlvbihlKXt2YXIgbj10LmlzQWJzb2x1dGUoZSksbz0iLyI9PT1hKGUsLTEpO3JldHVybihlPXIoaShlLnNwbGl0KCIvIiksKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhbikuam9pbigiLyIpKXx8bnx8KGU9Ii4iKSxlJiZvJiYoZSs9Ii8iKSwobj8iLyI6IiIpK2V9LHQuaXNBYnNvbHV0ZT1mdW5jdGlvbihlKXtyZXR1cm4iLyI9PT1lLmNoYXJBdCgwKX0sdC5qb2luPWZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO3JldHVybiB0Lm5vcm1hbGl6ZShpKGUsKGZ1bmN0aW9uKGUsdCl7aWYoInN0cmluZyIhPXR5cGVvZiBlKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50cyB0byBwYXRoLmpvaW4gbXVzdCBiZSBzdHJpbmdzIik7cmV0dXJuIGV9KSkuam9pbigiLyIpKX0sdC5yZWxhdGl2ZT1mdW5jdGlvbihlLHIpe2Z1bmN0aW9uIG4oZSl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aCYmIiI9PT1lW3RdO3QrKyk7Zm9yKHZhciByPWUubGVuZ3RoLTE7cj49MCYmIiI9PT1lW3JdO3ItLSk7cmV0dXJuIHQ+cj9bXTplLnNsaWNlKHQsci10KzEpfWU9dC5yZXNvbHZlKGUpLnN1YnN0cigxKSxyPXQucmVzb2x2ZShyKS5zdWJzdHIoMSk7Zm9yKHZhciBvPW4oZS5zcGxpdCgiLyIpKSxpPW4oci5zcGxpdCgiLyIpKSxhPU1hdGgubWluKG8ubGVuZ3RoLGkubGVuZ3RoKSxzPWEsdT0wO3U8YTt1KyspaWYob1t1XSE9PWlbdV0pe3M9dTticmVha312YXIgYz1bXTtmb3IodT1zO3U8by5sZW5ndGg7dSsrKWMucHVzaCgiLi4iKTtyZXR1cm4oYz1jLmNvbmNhdChpLnNsaWNlKHMpKSkuam9pbigiLyIpfSx0LnNlcD0iLyIsdC5kZWxpbWl0ZXI9IjoiLHQuZGlybmFtZT1mdW5jdGlvbihlKXt2YXIgdD1vKGUpLHI9dFswXSxuPXRbMV07cmV0dXJuIHJ8fG4/KG4mJihuPW4uc3Vic3RyKDAsbi5sZW5ndGgtMSkpLHIrbik6Ii4ifSx0LmJhc2VuYW1lPWZ1bmN0aW9uKGUsdCl7dmFyIHI9byhlKVsyXTtyZXR1cm4gdCYmci5zdWJzdHIoLTEqdC5sZW5ndGgpPT09dCYmKHI9ci5zdWJzdHIoMCxyLmxlbmd0aC10Lmxlbmd0aCkpLHJ9LHQuZXh0bmFtZT1mdW5jdGlvbihlKXtyZXR1cm4gbyhlKVszXX07dmFyIGE9ImIiPT09ImFiIi5zdWJzdHIoLTEpP2Z1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZS5zdWJzdHIodCxyKX06ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0PDAmJih0PWUubGVuZ3RoK3QpLGUuc3Vic3RyKHQscil9fSkuY2FsbCh0aGlzLHIoMTQpKX0sZnVuY3Rpb24oZSx0KXt2YXIgcixuLG89ZS5leHBvcnRzPXt9O2Z1bmN0aW9uIGkoKXt0aHJvdyBuZXcgRXJyb3IoInNldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQiKX1mdW5jdGlvbiBhKCl7dGhyb3cgbmV3IEVycm9yKCJjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQiKX1mdW5jdGlvbiBzKGUpe2lmKHI9PT1zZXRUaW1lb3V0KXJldHVybiBzZXRUaW1lb3V0KGUsMCk7aWYoKHI9PT1pfHwhcikmJnNldFRpbWVvdXQpcmV0dXJuIHI9c2V0VGltZW91dCxzZXRUaW1lb3V0KGUsMCk7dHJ5e3JldHVybiByKGUsMCl9Y2F0Y2godCl7dHJ5e3JldHVybiByLmNhbGwobnVsbCxlLDApfWNhdGNoKHQpe3JldHVybiByLmNhbGwodGhpcyxlLDApfX19IWZ1bmN0aW9uKCl7dHJ5e3I9ImZ1bmN0aW9uIj09dHlwZW9mIHNldFRpbWVvdXQ/c2V0VGltZW91dDppfWNhdGNoKGUpe3I9aX10cnl7bj0iZnVuY3Rpb24iPT10eXBlb2YgY2xlYXJUaW1lb3V0P2NsZWFyVGltZW91dDphfWNhdGNoKGUpe249YX19KCk7dmFyIHUsYz1bXSxsPSExLGY9LTE7ZnVuY3Rpb24gZCgpe2wmJnUmJihsPSExLHUubGVuZ3RoP2M9dS5jb25jYXQoYyk6Zj0tMSxjLmxlbmd0aCYmaCgpKX1mdW5jdGlvbiBoKCl7aWYoIWwpe3ZhciBlPXMoZCk7bD0hMDtmb3IodmFyIHQ9Yy5sZW5ndGg7dDspe2Zvcih1PWMsYz1bXTsrK2Y8dDspdSYmdVtmXS5ydW4oKTtmPS0xLHQ9Yy5sZW5ndGh9dT1udWxsLGw9ITEsZnVuY3Rpb24oZSl7aWYobj09PWNsZWFyVGltZW91dClyZXR1cm4gY2xlYXJUaW1lb3V0KGUpO2lmKChuPT09YXx8IW4pJiZjbGVhclRpbWVvdXQpcmV0dXJuIG49Y2xlYXJUaW1lb3V0LGNsZWFyVGltZW91dChlKTt0cnl7bihlKX1jYXRjaCh0KXt0cnl7cmV0dXJuIG4uY2FsbChudWxsLGUpfWNhdGNoKHQpe3JldHVybiBuLmNhbGwodGhpcyxlKX19fShlKX19ZnVuY3Rpb24gcChlLHQpe3RoaXMuZnVuPWUsdGhpcy5hcnJheT10fWZ1bmN0aW9uIG0oKXt9by5uZXh0VGljaz1mdW5jdGlvbihlKXt2YXIgdD1uZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aC0xKTtpZihhcmd1bWVudHMubGVuZ3RoPjEpZm9yKHZhciByPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKyl0W3ItMV09YXJndW1lbnRzW3JdO2MucHVzaChuZXcgcChlLHQpKSwxIT09Yy5sZW5ndGh8fGx8fHMoaCl9LHAucHJvdG90eXBlLnJ1bj1mdW5jdGlvbigpe3RoaXMuZnVuLmFwcGx5KG51bGwsdGhpcy5hcnJheSl9LG8udGl0bGU9ImJyb3dzZXIiLG8uYnJvd3Nlcj0hMCxvLmVudj17fSxvLmFyZ3Y9W10sby52ZXJzaW9uPSIiLG8udmVyc2lvbnM9e30sby5vbj1tLG8uYWRkTGlzdGVuZXI9bSxvLm9uY2U9bSxvLm9mZj1tLG8ucmVtb3ZlTGlzdGVuZXI9bSxvLnJlbW92ZUFsbExpc3RlbmVycz1tLG8uZW1pdD1tLG8ucHJlcGVuZExpc3RlbmVyPW0sby5wcmVwZW5kT25jZUxpc3RlbmVyPW0sby5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuW119LG8uYmluZGluZz1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoInByb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkIil9LG8uY3dkPWZ1bmN0aW9uKCl7cmV0dXJuIi8ifSxvLmNoZGlyPWZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcigicHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkIil9LG8udW1hc2s9ZnVuY3Rpb24oKXtyZXR1cm4gMH19XSl9KHQuZnMpO2NvbnN0IHI9ZS51bnBhY2tCcmlkZ2U7bGV0IG47dmFyIG89ZnVuY3Rpb24oZSl7Y29uc3QgdD17fTtjcmVkZW50aWFscz0ib21pdCI7dmFyIG4sbz12b2lkIDAhPT10P3Q6e30saT1yLkV4dCxhPXtvcGVuOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY3VycmVudC5vcGVuLmFwcGx5KGkuY3VycmVudCxhcmd1bWVudHMpfSxjbG9zZTpmdW5jdGlvbigpe3JldHVybiBpLmN1cnJlbnQuY2xvc2UuYXBwbHkoaS5jdXJyZW50LGFyZ3VtZW50cyl9LHJlYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5jdXJyZW50LnJlYWQuYXBwbHkoaS5jdXJyZW50LGFyZ3VtZW50cyl9LHdyaXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY3VycmVudC53cml0ZS5hcHBseShpLmN1cnJlbnQsYXJndW1lbnRzKX0sdGVsbDpmdW5jdGlvbigpe3JldHVybiBpLmN1cnJlbnQudGVsbC5hcHBseShpLmN1cnJlbnQsYXJndW1lbnRzKX0sc2VlazpmdW5jdGlvbigpe3JldHVybiBpLmN1cnJlbnQuc2Vlay5hcHBseShpLmN1cnJlbnQsYXJndW1lbnRzKX0sY3JlYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY3VycmVudC5jcmVhdGUuYXBwbHkoaS5jdXJyZW50LGFyZ3VtZW50cyl9fSxzPXt9O2ZvcihuIGluIG8pby5oYXNPd25Qcm9wZXJ0eShuKSYmKHNbbl09b1tuXSk7by5hcmd1bWVudHM9W10sby50aGlzUHJvZ3JhbT0iLi90aGlzLnByb2dyYW0iLG8ucXVpdD1mdW5jdGlvbihlLHQpe3Rocm93IHR9LG8ucHJlUnVuPVtdLG8ucG9zdFJ1bj1bXTt2YXIgdT0hMSxjPSExLGw9ITE7aWYoby5FTlZJUk9OTUVOVCl7aWYoIldFQiI9PT1vLkVOVklST05NRU5UKXU9ITA7ZWxzZSBpZigiV09SS0VSIj09PW8uRU5WSVJPTk1FTlQpYz0hMDtlbHNlIGlmKCJOT0RFIj09PW8uRU5WSVJPTk1FTlQpbD0hMDtlbHNlIGlmKCJTSEVMTCIhPT1vLkVOVklST05NRU5UKXRocm93IG5ldyBFcnJvcigiTW9kdWxlWydFTlZJUk9OTUVOVCddIHZhbHVlIGlzIG5vdCB2YWxpZC4gbXVzdCBiZSBvbmUgb2Y6IFdFQnxXT1JLRVJ8Tk9ERXxTSEVMTC4iKX1lbHNlIHU9Im9iamVjdCI9PXR5cGVvZiB3aW5kb3csYz0iZnVuY3Rpb24iPT10eXBlb2YgaW1wb3J0U2NyaXB0cyxsPSJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJiF1JiYhYztmb3IobiBpbih1fHxjKSYmKG8ucmVhZD1mdW5jdGlvbihlKXt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnNlbmQobnVsbCksdC5yZXNwb25zZVRleHR9LGMmJihvLnJlYWRCaW5hcnk9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiB0Lm9wZW4oIkdFVCIsZSwhMSksdC5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIix0LnNlbmQobnVsbCksbmV3IFVpbnQ4QXJyYXkodC5yZXNwb25zZSl9KSxvLnJlYWRBc3luYz1mdW5jdGlvbihlLHQscil7dmFyIG49bmV3IFhNTEh0dHBSZXF1ZXN0O24ub3BlbigiR0VUIixlLCEwKSxuLnJlc3BvbnNlVHlwZT0iYXJyYXlidWZmZXIiLG4ub25sb2FkPWZ1bmN0aW9uKCl7MjAwPT1uLnN0YXR1c3x8MD09bi5zdGF0dXMmJm4ucmVzcG9uc2U/dChuLnJlc3BvbnNlKTpyKCl9LG4ub25lcnJvcj1yLG4uc2VuZChudWxsKX0sby5zZXRXaW5kb3dUaXRsZT1mdW5jdGlvbihlKXtkb2N1bWVudC50aXRsZT1lfSksby5wcmludD0idW5kZWZpbmVkIiE9dHlwZW9mIGNvbnNvbGU/Y29uc29sZS5sb2cuYmluZChjb25zb2xlKToidW5kZWZpbmVkIiE9dHlwZW9mIHByaW50P3ByaW50Om51bGwsby5wcmludEVycj0idW5kZWZpbmVkIiE9dHlwZW9mIHByaW50RXJyP3ByaW50RXJyOiJ1bmRlZmluZWQiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuLmJpbmQoY29uc29sZSl8fG8ucHJpbnQsby5wcmludD1vLnByaW50LG8ucHJpbnRFcnI9by5wcmludEVycixzKXMuaGFzT3duUHJvcGVydHkobikmJihvW25dPXNbbl0pO3M9dm9pZCAwO2Z1bmN0aW9uIGYoZSl7eSgheCk7dmFyIHQ9TDtyZXR1cm4gTD1MK2UrMTUmLTE2LHR9ZnVuY3Rpb24gZChlKXt5KCQpO3ZhciB0PUZbJD4+Ml0scj10K2UrMTUmLTE2O2lmKChGWyQ+PjJdPXIscj49cSkmJiFIKCkpcmV0dXJuIEZbJD4+Ml09dCwwO3JldHVybiB0fWZ1bmN0aW9uIGgoZSx0KXtyZXR1cm4gdHx8KHQ9MTYpLGU9TWF0aC5jZWlsKGUvdCkqdH1mdW5jdGlvbiBwKGUpe3N3aXRjaChlKXtjYXNlImkxIjpjYXNlImk4IjpyZXR1cm4gMTtjYXNlImkxNiI6cmV0dXJuIDI7Y2FzZSJpMzIiOnJldHVybiA0O2Nhc2UiaTY0IjpyZXR1cm4gODtjYXNlImZsb2F0IjpyZXR1cm4gNDtjYXNlImRvdWJsZSI6cmV0dXJuIDg7ZGVmYXVsdDppZigiKiI9PT1lW2UubGVuZ3RoLTFdKXJldHVybiA0O2lmKCJpIj09PWVbMF0pe3ZhciB0PXBhcnNlSW50KGUuc3Vic3RyKDEpKTtyZXR1cm4geSh0JTg9PTApLHQvOH1yZXR1cm4gMH19bmV3IEFycmF5KDApO3ZhciBtPTA7ZnVuY3Rpb24geShlLHQpe2V8fHJyKCJBc3NlcnRpb24gZmFpbGVkOiAiK3QpfWZ1bmN0aW9uIEUoZSx0LHIsbil7c3dpdGNoKCIqIj09PShyPXJ8fCJpOCIpLmNoYXJBdChyLmxlbmd0aC0xKSYmKHI9ImkzMiIpLHIpe2Nhc2UiaTEiOmNhc2UiaTgiOlJbZT4+MF09dDticmVhaztjYXNlImkxNiI6Q1tlPj4xXT10O2JyZWFrO2Nhc2UiaTMyIjpGW2U+PjJdPXQ7YnJlYWs7Y2FzZSJpNjQiOnRlbXBJNjQ9W3Q+Pj4wLCh0ZW1wRG91YmxlPXQsK25lKHRlbXBEb3VibGUpPj0xP3RlbXBEb3VibGU+MD8oMHxhZSgraWUodGVtcERvdWJsZS80Mjk0OTY3Mjk2KSw0Mjk0OTY3Mjk1KSk+Pj4wOn5+K29lKCh0ZW1wRG91YmxlLSsofn50ZW1wRG91YmxlPj4+MCkpLzQyOTQ5NjcyOTYpPj4+MDowKV0sRltlPj4yXT10ZW1wSTY0WzBdLEZbZSs0Pj4yXT10ZW1wSTY0WzFdO2JyZWFrO2Nhc2UiZmxvYXQiOklbZT4+Ml09dDticmVhaztjYXNlImRvdWJsZSI6QltlPj4zXT10O2JyZWFrO2RlZmF1bHQ6cnIoImludmFsaWQgdHlwZSBmb3Igc2V0VmFsdWU6ICIrcil9fWZ1bmN0aW9uIGcoZSx0LHIsbil7dmFyIG8saTsibnVtYmVyIj09dHlwZW9mIGU/KG89ITAsaT1lKToobz0hMSxpPWUubGVuZ3RoKTt2YXIgYSxzPSJzdHJpbmciPT10eXBlb2YgdD90Om51bGw7aWYoYT00PT1yP246WyJmdW5jdGlvbiI9PXR5cGVvZiBKdD9KdDpmLFF0LGYsZF1bdm9pZCAwPT09cj8yOnJdKE1hdGgubWF4KGkscz8xOnQubGVuZ3RoKSksbyl7dmFyIHU7Zm9yKG49YSx5KDA9PSgzJmEpKSx1PWErKC00JmkpO248dTtuKz00KUZbbj4+Ml09MDtmb3IodT1hK2k7bjx1OylSW24rKz4+MF09MDtyZXR1cm4gYX1pZigiaTgiPT09cylyZXR1cm4gZS5zdWJhcnJheXx8ZS5zbGljZT9PLnNldChlLGEpOk8uc2V0KG5ldyBVaW50OEFycmF5KGUpLGEpLGE7Zm9yKHZhciBjLGwsaCxtPTA7bTxpOyl7dmFyIGc9ZVttXTswIT09KGM9c3x8dFttXSk/KCJpNjQiPT1jJiYoYz0iaTMyIiksRShhK20sZyxjKSxoIT09YyYmKGw9cChjKSxoPWMpLG0rPWwpOm0rK31yZXR1cm4gYX1mdW5jdGlvbiB2KGUsdCl7aWYoMD09PXR8fCFlKXJldHVybiIiO2Zvcih2YXIgcixuPTAsbz0wO258PXI9T1tlK28+PjBdLCgwIT1yfHx0KSYmKG8rKywhdHx8byE9dCk7KTt0fHwodD1vKTt2YXIgaT0iIjtpZihuPDEyOCl7Zm9yKHZhciBhO3Q+MDspYT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZyxPLnN1YmFycmF5KGUsZStNYXRoLm1pbih0LDEwMjQpKSksaT1pP2krYTphLGUrPTEwMjQsdC09MTAyNDtyZXR1cm4gaX1yZXR1cm4gYihlKX12YXIgdz0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnZvaWQgMDtmdW5jdGlvbiBfKGUsdCl7Zm9yKHZhciByPXQ7ZVtyXTspKytyO2lmKHItdD4xNiYmZS5zdWJhcnJheSYmdylyZXR1cm4gdy5kZWNvZGUoZS5zdWJhcnJheSh0LHIpKTtmb3IodmFyIG4sbyxpLGEscyx1PSIiOzspe2lmKCEobj1lW3QrK10pKXJldHVybiB1O2lmKDEyOCZuKWlmKG89NjMmZVt0KytdLDE5MiE9KDIyNCZuKSlpZihpPTYzJmVbdCsrXSwyMjQ9PSgyNDAmbik/bj0oMTUmbik8PDEyfG88PDZ8aTooYT02MyZlW3QrK10sMjQwPT0oMjQ4Jm4pP249KDcmbik8PDE4fG88PDEyfGk8PDZ8YToocz02MyZlW3QrK10sbj0yNDg9PSgyNTImbik/KDMmbik8PDI0fG88PDE4fGk8PDEyfGE8PDZ8czooMSZuKTw8MzB8bzw8MjR8aTw8MTh8YTw8MTJ8czw8Nnw2MyZlW3QrK10pKSxuPDY1NTM2KXUrPVN0cmluZy5mcm9tQ2hhckNvZGUobik7ZWxzZXt2YXIgYz1uLTY1NTM2O3UrPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8Yz4+MTAsNTYzMjB8MTAyMyZjKX1lbHNlIHUrPVN0cmluZy5mcm9tQ2hhckNvZGUoKDMxJm4pPDw2fG8pO2Vsc2UgdSs9U3RyaW5nLmZyb21DaGFyQ29kZShuKX19ZnVuY3Rpb24gYihlKXtyZXR1cm4gXyhPLGUpfWZ1bmN0aW9uIEEoZSx0LHIsbil7aWYoIShuPjApKXJldHVybiAwO2Zvcih2YXIgbz1yLGk9cituLTEsYT0wO2E8ZS5sZW5ndGg7KythKXt2YXIgcz1lLmNoYXJDb2RlQXQoYSk7aWYocz49NTUyOTYmJnM8PTU3MzQzJiYocz02NTUzNisoKDEwMjMmcyk8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK2EpKSxzPD0xMjcpe2lmKHI+PWkpYnJlYWs7dFtyKytdPXN9ZWxzZSBpZihzPD0yMDQ3KXtpZihyKzE+PWkpYnJlYWs7dFtyKytdPTE5MnxzPj42LHRbcisrXT0xMjh8NjMmc31lbHNlIGlmKHM8PTY1NTM1KXtpZihyKzI+PWkpYnJlYWs7dFtyKytdPTIyNHxzPj4xMix0W3IrK109MTI4fHM+PjYmNjMsdFtyKytdPTEyOHw2MyZzfWVsc2UgaWYoczw9MjA5NzE1MSl7aWYociszPj1pKWJyZWFrO3RbcisrXT0yNDB8cz4+MTgsdFtyKytdPTEyOHxzPj4xMiY2Myx0W3IrK109MTI4fHM+PjYmNjMsdFtyKytdPTEyOHw2MyZzfWVsc2UgaWYoczw9NjcxMDg4NjMpe2lmKHIrND49aSlicmVhazt0W3IrK109MjQ4fHM+PjI0LHRbcisrXT0xMjh8cz4+MTgmNjMsdFtyKytdPTEyOHxzPj4xMiY2Myx0W3IrK109MTI4fHM+PjYmNjMsdFtyKytdPTEyOHw2MyZzfWVsc2V7aWYocis1Pj1pKWJyZWFrO3RbcisrXT0yNTJ8cz4+MzAsdFtyKytdPTEyOHxzPj4yNCY2Myx0W3IrK109MTI4fHM+PjE4JjYzLHRbcisrXT0xMjh8cz4+MTImNjMsdFtyKytdPTEyOHxzPj42JjYzLHRbcisrXT0xMjh8NjMmc319cmV0dXJuIHRbcl09MCxyLW99ZnVuY3Rpb24gVChlLHQscil7cmV0dXJuIEEoZSxPLHQscil9ZnVuY3Rpb24gUyhlKXtmb3IodmFyIHQ9MCxyPTA7cjxlLmxlbmd0aDsrK3Ipe3ZhciBuPWUuY2hhckNvZGVBdChyKTtuPj01NTI5NiYmbjw9NTczNDMmJihuPTY1NTM2KygoMTAyMyZuKTw8MTApfDEwMjMmZS5jaGFyQ29kZUF0KCsrcikpLG48PTEyNz8rK3Q6dCs9bjw9MjA0Nz8yOm48PTY1NTM1PzM6bjw9MjA5NzE1MT80Om48PTY3MTA4ODYzPzU6Nn1yZXR1cm4gdH0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyJiZuZXcgVGV4dERlY29kZXIoInV0Zi0xNmxlIik7ZnVuY3Rpb24gayhlKXtmb3IodmFyIHQ9MCxyPSIiOzspe3ZhciBuPUZbZSs0KnQ+PjJdO2lmKDA9PW4pcmV0dXJuIHI7aWYoKyt0LG4+PTY1NTM2KXt2YXIgbz1uLTY1NTM2O3IrPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8bz4+MTAsNTYzMjB8MTAyMyZvKX1lbHNlIHIrPVN0cmluZy5mcm9tQ2hhckNvZGUobil9fWZ1bmN0aW9uIFAoKXt2YXIgZT1mdW5jdGlvbigpe3ZhciBlPW5ldyBFcnJvcjtpZighZS5zdGFjayl7dHJ5e3Rocm93IG5ldyBFcnJvcigwKX1jYXRjaCh0KXtlPXR9aWYoIWUuc3RhY2spcmV0dXJuIihubyBzdGFjayB0cmFjZSBhdmFpbGFibGUpIn1yZXR1cm4gZS5zdGFjay50b1N0cmluZygpfSgpO3JldHVybiBvLmV4dHJhU3RhY2tUcmFjZSYmKGUrPSJcbiIrby5leHRyYVN0YWNrVHJhY2UoKSksZS5yZXBsYWNlKC9fX1pbXHdcZF9dKy9nLChmdW5jdGlvbihlKXtyZXR1cm4gZT09ZT9lOmUrIiBbIitlKyJdIn0pKX12YXIgRCxSLE8sQyxOLEYsTSxJLEIsTCx4LGosVSx6LCQ7ZnVuY3Rpb24gVyhlLHQpe3JldHVybiBlJXQ+MCYmKGUrPXQtZSV0KSxlfWZ1bmN0aW9uIFkoZSl7by5idWZmZXI9RD1lfWZ1bmN0aW9uIFYoKXtvLkhFQVA4PVI9bmV3IEludDhBcnJheShEKSxvLkhFQVAxNj1DPW5ldyBJbnQxNkFycmF5KEQpLG8uSEVBUDMyPUY9bmV3IEludDMyQXJyYXkoRCksby5IRUFQVTg9Tz1uZXcgVWludDhBcnJheShEKSxvLkhFQVBVMTY9Tj1uZXcgVWludDE2QXJyYXkoRCksby5IRUFQVTMyPU09bmV3IFVpbnQzMkFycmF5KEQpLG8uSEVBUEYzMj1JPW5ldyBGbG9hdDMyQXJyYXkoRCksby5IRUFQRjY0PUI9bmV3IEZsb2F0NjRBcnJheShEKX1mdW5jdGlvbiBIKCl7dmFyIGU9by51c2luZ1dhc20/NjU1MzY6MTY3NzcyMTYsdD0yMTQ3NDgzNjQ4LWU7aWYoRlskPj4yXT50KXJldHVybiExO3ZhciByPXE7Zm9yKHE9TWF0aC5tYXgocSwxNjc3NzIxNik7cTxGWyQ+PjJdOylxPXE8PTUzNjg3MDkxMj9XKDIqcSxlKTpNYXRoLm1pbihXKCgzKnErMjE0NzQ4MzY0OCkvNCxlKSx0KTt2YXIgbj1vLnJlYWxsb2NCdWZmZXIocSk7cmV0dXJuIG4mJm4uYnl0ZUxlbmd0aD09cT8oWShuKSxWKCksITApOihxPXIsITEpfUw9VT0kPTAseD0hMSxvLnJlYWxsb2NCdWZmZXJ8fChvLnJlYWxsb2NCdWZmZXI9ZnVuY3Rpb24oZSl7dmFyIHQ7dHJ5e2lmKEFycmF5QnVmZmVyLnRyYW5zZmVyKXQ9QXJyYXlCdWZmZXIudHJhbnNmZXIoRCxlKTtlbHNle3ZhciByPVI7dD1uZXcgQXJyYXlCdWZmZXIoZSksbmV3IEludDhBcnJheSh0KS5zZXQocil9fWNhdGNoKGUpe3JldHVybiExfXJldHVybiEhWHQodCkmJnR9KTt0cnl7RnVuY3Rpb24ucHJvdG90eXBlLmNhbGwuYmluZChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEFycmF5QnVmZmVyLnByb3RvdHlwZSwiYnl0ZUxlbmd0aCIpLmdldCkobmV3IEFycmF5QnVmZmVyKDQpKX1jYXRjaChlKXsoZnVuY3Rpb24oZSl7cmV0dXJuIGUuYnl0ZUxlbmd0aH0pfXZhciBHPW8uVE9UQUxfU1RBQ0t8fDUyNDI4ODAscT1vLlRPVEFMX01FTU9SWXx8MTY3NzcyMTY7aWYocTxHJiZvLnByaW50RXJyKCJUT1RBTF9NRU1PUlkgc2hvdWxkIGJlIGxhcmdlciB0aGFuIFRPVEFMX1NUQUNLLCB3YXMgIitxKyIhIChUT1RBTF9TVEFDSz0iK0crIikiKSxvLmJ1ZmZlcj9EPW8uYnVmZmVyOigib2JqZWN0Ij09dHlwZW9mIFdlYkFzc2VtYmx5JiYiZnVuY3Rpb24iPT10eXBlb2YgV2ViQXNzZW1ibHkuTWVtb3J5PyhvLndhc21NZW1vcnk9bmV3IFdlYkFzc2VtYmx5Lk1lbW9yeSh7aW5pdGlhbDpxLzY1NTM2fSksRD1vLndhc21NZW1vcnkuYnVmZmVyKTpEPW5ldyBBcnJheUJ1ZmZlcihxKSxvLmJ1ZmZlcj1EKSxWKCksRlswXT0xNjY4NTA5MDI5LENbMV09MjU0NTksMTE1IT09T1syXXx8OTkhPT1PWzNdKXRocm93IlJ1bnRpbWUgZXJyb3I6IGV4cGVjdGVkIHRoZSBzeXN0ZW0gdG8gYmUgbGl0dGxlLWVuZGlhbiEiO2Z1bmN0aW9uIFgoZSl7Zm9yKDtlLmxlbmd0aD4wOyl7dmFyIHQ9ZS5zaGlmdCgpO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0KXt2YXIgcj10LmZ1bmM7Im51bWJlciI9PXR5cGVvZiByP3ZvaWQgMD09PXQuYXJnP28uZHluQ2FsbF92KHIpOm8uZHluQ2FsbF92aShyLHQuYXJnKTpyKHZvaWQgMD09PXQuYXJnP251bGw6dC5hcmcpfWVsc2UgdCgpfX12YXIgSz1bXSxKPVtdLFo9W10sUT1bXSxlZT1bXSx0ZT0hMTtmdW5jdGlvbiByZShlLHQscil7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDsrK24pUlt0Kys+PjBdPWUuY2hhckNvZGVBdChuKTtyfHwoUlt0Pj4wXT0wKX12YXIgbmU9TWF0aC5hYnMsb2U9TWF0aC5jZWlsLGllPU1hdGguZmxvb3IsYWU9TWF0aC5taW4sc2U9MCx1ZT1udWxsO2Z1bmN0aW9uIGNlKGUpe3NlKyssby5tb25pdG9yUnVuRGVwZW5kZW5jaWVzJiZvLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMoc2UpfWZ1bmN0aW9uIGxlKGUpe2lmKHNlLS0sby5tb25pdG9yUnVuRGVwZW5kZW5jaWVzJiZvLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMoc2UpLDA9PXNlJiZ1ZSl7dmFyIHQ9dWU7dWU9bnVsbCx0KCl9fW8ucHJlbG9hZGVkSW1hZ2VzPXt9LG8ucHJlbG9hZGVkQXVkaW9zPXt9O2Z1bmN0aW9uIGZlKGUpe3JldHVybiBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGg/ZS5zdGFydHNXaXRoKCJkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsIik6MD09PWUuaW5kZXhPZigiZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LCIpfSFmdW5jdGlvbigpe3ZhciB0PSJ1bnBhY2sud2FzdCIscj0idW5wYWNrLnRlbXAuYXNtLmpzIjsiZnVuY3Rpb24iPT10eXBlb2Ygby5sb2NhdGVGaWxlJiYoZmUodCl8fCh0PW8ubG9jYXRlRmlsZSh0KSksZmUoZSl8fChlPW8ubG9jYXRlRmlsZShlKSksZmUocil8fChyPW8ubG9jYXRlRmlsZShyKSkpO3ZhciBuPXtnbG9iYWw6bnVsbCxlbnY6bnVsbCxhc20yd2FzbTp7ImY2NC1yZW0iOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUldH0sZGVidWdnZXI6ZnVuY3Rpb24oKXt9fSxwYXJlbnQ6b30saT1udWxsO2Z1bmN0aW9uIGEoKXt0cnl7aWYoby53YXNtQmluYXJ5KXJldHVybiBuZXcgVWludDhBcnJheShvLndhc21CaW5hcnkpO2lmKG8ucmVhZEJpbmFyeSlyZXR1cm4gby5yZWFkQmluYXJ5KGUpO3Rocm93Im9uIHRoZSB3ZWIsIHdlIG5lZWQgdGhlIHdhc20gYmluYXJ5IHRvIGJlIHByZWxvYWRlZCBhbmQgc2V0IG9uIE1vZHVsZVsnd2FzbUJpbmFyeSddLiBlbWNjLnB5IHdpbGwgZG8gdGhhdCBmb3IgeW91IHdoZW4gZ2VuZXJhdGluZyBIVE1MIChidXQgbm90IEpTKSJ9Y2F0Y2goZSl7cnIoZSl9fWZ1bmN0aW9uIHModCxyLHMpe2lmKCJvYmplY3QiIT10eXBlb2YgV2ViQXNzZW1ibHkpcmV0dXJuIG8ucHJpbnRFcnIoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKSwhMTtpZighKG8ud2FzbU1lbW9yeSBpbnN0YW5jZW9mIFdlYkFzc2VtYmx5Lk1lbW9yeSkpcmV0dXJuIG8ucHJpbnRFcnIoIm5vIG5hdGl2ZSB3YXNtIE1lbW9yeSBpbiB1c2UiKSwhMTtmdW5jdGlvbiBsKGUsdCl7KGk9ZS5leHBvcnRzKS5tZW1vcnkmJmZ1bmN0aW9uKGUpe3ZhciB0PW8uYnVmZmVyO2UuYnl0ZUxlbmd0aDx0LmJ5dGVMZW5ndGgmJm8ucHJpbnRFcnIoInRoZSBuZXcgYnVmZmVyIGluIG1lcmdlTWVtb3J5IGlzIHNtYWxsZXIgdGhhbiB0aGUgcHJldmlvdXMgb25lLiBpbiBuYXRpdmUgd2FzbSwgd2Ugc2hvdWxkIGdyb3cgbWVtb3J5IGhlcmUiKTt2YXIgcj1uZXcgSW50OEFycmF5KHQpO25ldyBJbnQ4QXJyYXkoZSkuc2V0KHIpLFkoZSksVigpfShpLm1lbW9yeSksby5hc209aSxvLnVzaW5nV2FzbT0hMCxsZSgpfWlmKHIubWVtb3J5PW8ud2FzbU1lbW9yeSxuLmdsb2JhbD17TmFOOk5hTixJbmZpbml0eToxLzB9LG5bImdsb2JhbC5NYXRoIl09TWF0aCxuLmVudj1yLGNlKCksby5pbnN0YW50aWF0ZVdhc20pdHJ5e3JldHVybiBvLmluc3RhbnRpYXRlV2FzbShuLGwpfWNhdGNoKGUpe3JldHVybiBvLnByaW50RXJyKCJNb2R1bGUuaW5zdGFudGlhdGVXYXNtIGNhbGxiYWNrIGZhaWxlZCB3aXRoIGVycm9yOiAiK2UpLCExfWZ1bmN0aW9uIGYoZSl7bChlLmluc3RhbmNlLGUubW9kdWxlKX1mdW5jdGlvbiBkKHQpeyhvLndhc21CaW5hcnl8fCF1JiYhY3x8ImZ1bmN0aW9uIiE9dHlwZW9mIGZldGNoP25ldyBQcm9taXNlKChmdW5jdGlvbihlLHQpe2UoYSgpKX0pKTpmZXRjaChlLHtjcmVkZW50aWFsczoib21pdCJ9KS50aGVuKChmdW5jdGlvbih0KXtpZighdC5vayl0aHJvdyJmYWlsZWQgdG8gbG9hZCB3YXNtIGJpbmFyeSBmaWxlIGF0ICciK2UrIiciO3JldHVybiB0LmFycmF5QnVmZmVyKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKCl7cmV0dXJuIGEoKX0pKSkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGUsbil9KSkudGhlbih0KS5jYXRjaCgoZnVuY3Rpb24oZSl7by5wcmludEVycigiZmFpbGVkIHRvIGFzeW5jaHJvbm91c2x5IHByZXBhcmUgd2FzbTogIitlKSxycihlKX0pKX1yZXR1cm4gby53YXNtQmluYXJ5fHwiZnVuY3Rpb24iIT10eXBlb2YgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmd8fGZlKGUpfHwiZnVuY3Rpb24iIT10eXBlb2YgZmV0Y2g/ZChmKTpXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZyhmZXRjaChlLHtjcmVkZW50aWFsczoib21pdCJ9KSxuKS50aGVuKGYpLmNhdGNoKChmdW5jdGlvbihlKXtvLnByaW50RXJyKCJ3YXNtIHN0cmVhbWluZyBjb21waWxlIGZhaWxlZDogIitlKSxvLnByaW50RXJyKCJmYWxsaW5nIGJhY2sgdG8gQXJyYXlCdWZmZXIgaW5zdGFudGlhdGlvbiIpLGQoZil9KSkse319by5hc21QcmVsb2FkPW8uYXNtLG8ucmVhbGxvY0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oZSl7ZT1XKGUsby51c2luZ1dhc20/NjU1MzY6MTY3NzcyMTYpO3ZhciB0PW8uYnVmZmVyLmJ5dGVMZW5ndGg7aWYoby51c2luZ1dhc20pdHJ5e3JldHVybi0xIT09by53YXNtTWVtb3J5Lmdyb3coKGUtdCkvNjU1MzYpP28uYnVmZmVyPW8ud2FzbU1lbW9yeS5idWZmZXI6bnVsbH1jYXRjaChlKXtyZXR1cm4gbnVsbH19KGUpfSxvLmFzbT1mdW5jdGlvbihlLHQscil7aWYoISh0PXQpLnRhYmxlKXt2YXIgbj1vLndhc21UYWJsZVNpemU7dm9pZCAwPT09biYmKG49MTAyNCk7dmFyIGk9by53YXNtTWF4VGFibGVTaXplOyJvYmplY3QiPT10eXBlb2YgV2ViQXNzZW1ibHkmJiJmdW5jdGlvbiI9PXR5cGVvZiBXZWJBc3NlbWJseS5UYWJsZT90LnRhYmxlPXZvaWQgMCE9PWk/bmV3IFdlYkFzc2VtYmx5LlRhYmxlKHtpbml0aWFsOm4sbWF4aW11bTppLGVsZW1lbnQ6ImFueWZ1bmMifSk6bmV3IFdlYkFzc2VtYmx5LlRhYmxlKHtpbml0aWFsOm4sZWxlbWVudDoiYW55ZnVuYyJ9KTp0LnRhYmxlPW5ldyBBcnJheShuKSxvLndhc21UYWJsZT10LnRhYmxlfXZhciBhO3JldHVybiB0Lm1lbW9yeUJhc2V8fCh0Lm1lbW9yeUJhc2U9by5TVEFUSUNfQkFTRSksdC50YWJsZUJhc2V8fCh0LnRhYmxlQmFzZT0wKSwoYT1zKDAsdCkpfHxycigibm8gYmluYXJ5ZW4gbWV0aG9kIHN1Y2NlZWRlZC4gY29uc2lkZXIgZW5hYmxpbmcgbW9yZSBvcHRpb25zLCBsaWtlIGludGVycHJldGluZywgaWYgeW91IHdhbnQgdGhhdDogaHR0cHM6Ly9naXRodWIuY29tL2tyaXBrZW4vZW1zY3JpcHRlbi93aWtpL1dlYkFzc2VtYmx5I2JpbmFyeWVuLW1ldGhvZHMiKSxhfX0oKSxMPTY3OTg0LEoucHVzaCh7ZnVuYzpmdW5jdGlvbigpe0d0KCl9fSx7ZnVuYzpmdW5jdGlvbigpe0h0KCl9fSx7ZnVuYzpmdW5jdGlvbigpe1Z0KCl9fSx7ZnVuYzpmdW5jdGlvbigpe1l0KCl9fSk7by5TVEFUSUNfQkFTRT0xMDI0LG8uU1RBVElDX0JVTVA9NjY5NjAsTCs9MTY7dmFyIGRlPXtsYXN0OjAsY2F1Z2h0OltdLGluZm9zOnt9LGRlQWRqdXN0OmZ1bmN0aW9uKGUpe2lmKCFlfHxkZS5pbmZvc1tlXSlyZXR1cm4gZTtmb3IodmFyIHQgaW4gZGUuaW5mb3Mpe3ZhciByPSt0O2lmKGRlLmluZm9zW3JdLmFkanVzdGVkPT09ZSlyZXR1cm4gcn1yZXR1cm4gZX0sYWRkUmVmOmZ1bmN0aW9uKGUpe2UmJmRlLmluZm9zW2VdLnJlZmNvdW50Kyt9LGRlY1JlZjpmdW5jdGlvbihlKXtpZihlKXt2YXIgdD1kZS5pbmZvc1tlXTt5KHQucmVmY291bnQ+MCksdC5yZWZjb3VudC0tLDAhPT10LnJlZmNvdW50fHx0LnJldGhyb3dufHwodC5kZXN0cnVjdG9yJiZvLmR5bkNhbGxfdmkodC5kZXN0cnVjdG9yLGUpLGRlbGV0ZSBkZS5pbmZvc1tlXSxoZShlKSl9fSxjbGVhclJlZjpmdW5jdGlvbihlKXtlJiYoZGUuaW5mb3NbZV0ucmVmY291bnQ9MCl9fTtmdW5jdGlvbiBoZShlKXt0cnl7cmV0dXJuIEt0KGUpfWNhdGNoKGUpe319ZnVuY3Rpb24gcGUoKXt2YXIgZT1kZS5sYXN0O2lmKCFlKXJldHVybiAwfChadCgwKSwwKTt2YXIgdD1kZS5pbmZvc1tlXSxyPXQudHlwZTtpZighcilyZXR1cm4gMHwoWnQoMCksZSk7dmFyIG49QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtvLl9fX2N4YV9pc19wb2ludGVyX3R5cGUocik7cGUuYnVmZmVyfHwocGUuYnVmZmVyPUp0KDQpKSxGW3BlLmJ1ZmZlcj4+Ml09ZSxlPXBlLmJ1ZmZlcjtmb3IodmFyIGk9MDtpPG4ubGVuZ3RoO2krKylpZihuW2ldJiZvLl9fX2N4YV9jYW5fY2F0Y2gobltpXSxyLGUpKXJldHVybiBlPUZbZT4+Ml0sdC5hZGp1c3RlZD1lLDB8KFp0KG5baV0pLGUpO3JldHVybiBlPUZbZT4+Ml0sMHwoWnQociksZSl9dmFyIG1lPXtFUEVSTToxLEVOT0VOVDoyLEVTUkNIOjMsRUlOVFI6NCxFSU86NSxFTlhJTzo2LEUyQklHOjcsRU5PRVhFQzo4LEVCQURGOjksRUNISUxEOjEwLEVBR0FJTjoxMSxFV09VTERCTE9DSzoxMSxFTk9NRU06MTIsRUFDQ0VTOjEzLEVGQVVMVDoxNCxFTk9UQkxLOjE1LEVCVVNZOjE2LEVFWElTVDoxNyxFWERFVjoxOCxFTk9ERVY6MTksRU5PVERJUjoyMCxFSVNESVI6MjEsRUlOVkFMOjIyLEVORklMRToyMyxFTUZJTEU6MjQsRU5PVFRZOjI1LEVUWFRCU1k6MjYsRUZCSUc6MjcsRU5PU1BDOjI4LEVTUElQRToyOSxFUk9GUzozMCxFTUxJTks6MzEsRVBJUEU6MzIsRURPTTozMyxFUkFOR0U6MzQsRU5PTVNHOjQyLEVJRFJNOjQzLEVDSFJORzo0NCxFTDJOU1lOQzo0NSxFTDNITFQ6NDYsRUwzUlNUOjQ3LEVMTlJORzo0OCxFVU5BVENIOjQ5LEVOT0NTSTo1MCxFTDJITFQ6NTEsRURFQURMSzozNSxFTk9MQ0s6MzcsRUJBREU6NTIsRUJBRFI6NTMsRVhGVUxMOjU0LEVOT0FOTzo1NSxFQkFEUlFDOjU2LEVCQURTTFQ6NTcsRURFQURMT0NLOjM1LEVCRk9OVDo1OSxFTk9TVFI6NjAsRU5PREFUQTo2MSxFVElNRTo2MixFTk9TUjo2MyxFTk9ORVQ6NjQsRU5PUEtHOjY1LEVSRU1PVEU6NjYsRU5PTElOSzo2NyxFQURWOjY4LEVTUk1OVDo2OSxFQ09NTTo3MCxFUFJPVE86NzEsRU1VTFRJSE9QOjcyLEVET1RET1Q6NzMsRUJBRE1TRzo3NCxFTk9UVU5JUTo3NixFQkFERkQ6NzcsRVJFTUNIRzo3OCxFTElCQUNDOjc5LEVMSUJCQUQ6ODAsRUxJQlNDTjo4MSxFTElCTUFYOjgyLEVMSUJFWEVDOjgzLEVOT1NZUzozOCxFTk9URU1QVFk6MzksRU5BTUVUT09MT05HOjM2LEVMT09QOjQwLEVPUE5PVFNVUFA6OTUsRVBGTk9TVVBQT1JUOjk2LEVDT05OUkVTRVQ6MTA0LEVOT0JVRlM6MTA1LEVBRk5PU1VQUE9SVDo5NyxFUFJPVE9UWVBFOjkxLEVOT1RTT0NLOjg4LEVOT1BST1RPT1BUOjkyLEVTSFVURE9XTjoxMDgsRUNPTk5SRUZVU0VEOjExMSxFQUREUklOVVNFOjk4LEVDT05OQUJPUlRFRDoxMDMsRU5FVFVOUkVBQ0g6MTAxLEVORVRET1dOOjEwMCxFVElNRURPVVQ6MTEwLEVIT1NURE9XTjoxMTIsRUhPU1RVTlJFQUNIOjExMyxFSU5QUk9HUkVTUzoxMTUsRUFMUkVBRFk6MTE0LEVERVNUQUREUlJFUTo4OSxFTVNHU0laRTo5MCxFUFJPVE9OT1NVUFBPUlQ6OTMsRVNPQ0tUTk9TVVBQT1JUOjk0LEVBRERSTk9UQVZBSUw6OTksRU5FVFJFU0VUOjEwMixFSVNDT05OOjEwNixFTk9UQ09OTjoxMDcsRVRPT01BTllSRUZTOjEwOSxFVVNFUlM6ODcsRURRVU9UOjEyMixFU1RBTEU6MTE2LEVOT1RTVVA6OTUsRU5PTUVESVVNOjEyMyxFSUxTRVE6ODQsRU9WRVJGTE9XOjc1LEVDQU5DRUxFRDoxMjUsRU5PVFJFQ09WRVJBQkxFOjEzMSxFT1dORVJERUFEOjEzMCxFU1RSUElQRTo4Nn07ZnVuY3Rpb24geWUoZSl7cmV0dXJuIG8uX19fZXJybm9fbG9jYXRpb24mJihGW28uX19fZXJybm9fbG9jYXRpb24oKT4+Ml09ZSksZX12YXIgRWU9ezA6IlN1Y2Nlc3MiLDE6Ik5vdCBzdXBlci11c2VyIiwyOiJObyBzdWNoIGZpbGUgb3IgZGlyZWN0b3J5IiwzOiJObyBzdWNoIHByb2Nlc3MiLDQ6IkludGVycnVwdGVkIHN5c3RlbSBjYWxsIiw1OiJJL08gZXJyb3IiLDY6Ik5vIHN1Y2ggZGV2aWNlIG9yIGFkZHJlc3MiLDc6IkFyZyBsaXN0IHRvbyBsb25nIiw4OiJFeGVjIGZvcm1hdCBlcnJvciIsOToiQmFkIGZpbGUgbnVtYmVyIiwxMDoiTm8gY2hpbGRyZW4iLDExOiJObyBtb3JlIHByb2Nlc3NlcyIsMTI6Ik5vdCBlbm91Z2ggY29yZSIsMTM6IlBlcm1pc3Npb24gZGVuaWVkIiwxNDoiQmFkIGFkZHJlc3MiLDE1OiJCbG9jayBkZXZpY2UgcmVxdWlyZWQiLDE2OiJNb3VudCBkZXZpY2UgYnVzeSIsMTc6IkZpbGUgZXhpc3RzIiwxODoiQ3Jvc3MtZGV2aWNlIGxpbmsiLDE5OiJObyBzdWNoIGRldmljZSIsMjA6Ik5vdCBhIGRpcmVjdG9yeSIsMjE6IklzIGEgZGlyZWN0b3J5IiwyMjoiSW52YWxpZCBhcmd1bWVudCIsMjM6IlRvbyBtYW55IG9wZW4gZmlsZXMgaW4gc3lzdGVtIiwyNDoiVG9vIG1hbnkgb3BlbiBmaWxlcyIsMjU6Ik5vdCBhIHR5cGV3cml0ZXIiLDI2OiJUZXh0IGZpbGUgYnVzeSIsMjc6IkZpbGUgdG9vIGxhcmdlIiwyODoiTm8gc3BhY2UgbGVmdCBvbiBkZXZpY2UiLDI5OiJJbGxlZ2FsIHNlZWsiLDMwOiJSZWFkIG9ubHkgZmlsZSBzeXN0ZW0iLDMxOiJUb28gbWFueSBsaW5rcyIsMzI6IkJyb2tlbiBwaXBlIiwzMzoiTWF0aCBhcmcgb3V0IG9mIGRvbWFpbiBvZiBmdW5jIiwzNDoiTWF0aCByZXN1bHQgbm90IHJlcHJlc2VudGFibGUiLDM1OiJGaWxlIGxvY2tpbmcgZGVhZGxvY2sgZXJyb3IiLDM2OiJGaWxlIG9yIHBhdGggbmFtZSB0b28gbG9uZyIsMzc6Ik5vIHJlY29yZCBsb2NrcyBhdmFpbGFibGUiLDM4OiJGdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQiLDM5OiJEaXJlY3Rvcnkgbm90IGVtcHR5Iiw0MDoiVG9vIG1hbnkgc3ltYm9saWMgbGlua3MiLDQyOiJObyBtZXNzYWdlIG9mIGRlc2lyZWQgdHlwZSIsNDM6IklkZW50aWZpZXIgcmVtb3ZlZCIsNDQ6IkNoYW5uZWwgbnVtYmVyIG91dCBvZiByYW5nZSIsNDU6IkxldmVsIDIgbm90IHN5bmNocm9uaXplZCIsNDY6IkxldmVsIDMgaGFsdGVkIiw0NzoiTGV2ZWwgMyByZXNldCIsNDg6IkxpbmsgbnVtYmVyIG91dCBvZiByYW5nZSIsNDk6IlByb3RvY29sIGRyaXZlciBub3QgYXR0YWNoZWQiLDUwOiJObyBDU0kgc3RydWN0dXJlIGF2YWlsYWJsZSIsNTE6IkxldmVsIDIgaGFsdGVkIiw1MjoiSW52YWxpZCBleGNoYW5nZSIsNTM6IkludmFsaWQgcmVxdWVzdCBkZXNjcmlwdG9yIiw1NDoiRXhjaGFuZ2UgZnVsbCIsNTU6Ik5vIGFub2RlIiw1NjoiSW52YWxpZCByZXF1ZXN0IGNvZGUiLDU3OiJJbnZhbGlkIHNsb3QiLDU5OiJCYWQgZm9udCBmaWxlIGZtdCIsNjA6IkRldmljZSBub3QgYSBzdHJlYW0iLDYxOiJObyBkYXRhIChmb3Igbm8gZGVsYXkgaW8pIiw2MjoiVGltZXIgZXhwaXJlZCIsNjM6Ik91dCBvZiBzdHJlYW1zIHJlc291cmNlcyIsNjQ6Ik1hY2hpbmUgaXMgbm90IG9uIHRoZSBuZXR3b3JrIiw2NToiUGFja2FnZSBub3QgaW5zdGFsbGVkIiw2NjoiVGhlIG9iamVjdCBpcyByZW1vdGUiLDY3OiJUaGUgbGluayBoYXMgYmVlbiBzZXZlcmVkIiw2ODoiQWR2ZXJ0aXNlIGVycm9yIiw2OToiU3Jtb3VudCBlcnJvciIsNzA6IkNvbW11bmljYXRpb24gZXJyb3Igb24gc2VuZCIsNzE6IlByb3RvY29sIGVycm9yIiw3MjoiTXVsdGlob3AgYXR0ZW1wdGVkIiw3MzoiQ3Jvc3MgbW91bnQgcG9pbnQgKG5vdCByZWFsbHkgZXJyb3IpIiw3NDoiVHJ5aW5nIHRvIHJlYWQgdW5yZWFkYWJsZSBtZXNzYWdlIiw3NToiVmFsdWUgdG9vIGxhcmdlIGZvciBkZWZpbmVkIGRhdGEgdHlwZSIsNzY6IkdpdmVuIGxvZy4gbmFtZSBub3QgdW5pcXVlIiw3NzoiZi5kLiBpbnZhbGlkIGZvciB0aGlzIG9wZXJhdGlvbiIsNzg6IlJlbW90ZSBhZGRyZXNzIGNoYW5nZWQiLDc5OiJDYW4gICBhY2Nlc3MgYSBuZWVkZWQgc2hhcmVkIGxpYiIsODA6IkFjY2Vzc2luZyBhIGNvcnJ1cHRlZCBzaGFyZWQgbGliIiw4MToiLmxpYiBzZWN0aW9uIGluIGEub3V0IGNvcnJ1cHRlZCIsODI6IkF0dGVtcHRpbmcgdG8gbGluayBpbiB0b28gbWFueSBsaWJzIiw4MzoiQXR0ZW1wdGluZyB0byBleGVjIGEgc2hhcmVkIGxpYnJhcnkiLDg0OiJJbGxlZ2FsIGJ5dGUgc2VxdWVuY2UiLDg2OiJTdHJlYW1zIHBpcGUgZXJyb3IiLDg3OiJUb28gbWFueSB1c2VycyIsODg6IlNvY2tldCBvcGVyYXRpb24gb24gbm9uLXNvY2tldCIsODk6IkRlc3RpbmF0aW9uIGFkZHJlc3MgcmVxdWlyZWQiLDkwOiJNZXNzYWdlIHRvbyBsb25nIiw5MToiUHJvdG9jb2wgd3JvbmcgdHlwZSBmb3Igc29ja2V0Iiw5MjoiUHJvdG9jb2wgbm90IGF2YWlsYWJsZSIsOTM6IlVua25vd24gcHJvdG9jb2wiLDk0OiJTb2NrZXQgdHlwZSBub3Qgc3VwcG9ydGVkIiw5NToiTm90IHN1cHBvcnRlZCIsOTY6IlByb3RvY29sIGZhbWlseSBub3Qgc3VwcG9ydGVkIiw5NzoiQWRkcmVzcyBmYW1pbHkgbm90IHN1cHBvcnRlZCBieSBwcm90b2NvbCBmYW1pbHkiLDk4OiJBZGRyZXNzIGFscmVhZHkgaW4gdXNlIiw5OToiQWRkcmVzcyBub3QgYXZhaWxhYmxlIiwxMDA6Ik5ldHdvcmsgaW50ZXJmYWNlIGlzIG5vdCBjb25maWd1cmVkIiwxMDE6Ik5ldHdvcmsgaXMgdW5yZWFjaGFibGUiLDEwMjoiQ29ubmVjdGlvbiByZXNldCBieSBuZXR3b3JrIiwxMDM6IkNvbm5lY3Rpb24gYWJvcnRlZCIsMTA0OiJDb25uZWN0aW9uIHJlc2V0IGJ5IHBlZXIiLDEwNToiTm8gYnVmZmVyIHNwYWNlIGF2YWlsYWJsZSIsMTA2OiJTb2NrZXQgaXMgYWxyZWFkeSBjb25uZWN0ZWQiLDEwNzoiU29ja2V0IGlzIG5vdCBjb25uZWN0ZWQiLDEwODoiQ2FuJ3Qgc2VuZCBhZnRlciBzb2NrZXQgc2h1dGRvd24iLDEwOToiVG9vIG1hbnkgcmVmZXJlbmNlcyIsMTEwOiJDb25uZWN0aW9uIHRpbWVkIG91dCIsMTExOiJDb25uZWN0aW9uIHJlZnVzZWQiLDExMjoiSG9zdCBpcyBkb3duIiwxMTM6Ikhvc3QgaXMgdW5yZWFjaGFibGUiLDExNDoiU29ja2V0IGFscmVhZHkgY29ubmVjdGVkIiwxMTU6IkNvbm5lY3Rpb24gYWxyZWFkeSBpbiBwcm9ncmVzcyIsMTE2OiJTdGFsZSBmaWxlIGhhbmRsZSIsMTIyOiJRdW90YSBleGNlZWRlZCIsMTIzOiJObyBtZWRpdW0gKGluIHRhcGUgZHJpdmUpIiwxMjU6Ik9wZXJhdGlvbiBjYW5jZWxlZCIsMTMwOiJQcmV2aW91cyBvd25lciBkaWVkIiwxMzE6IlN0YXRlIG5vdCByZWNvdmVyYWJsZSJ9LGdlPXtzcGxpdFBhdGg6ZnVuY3Rpb24oZSl7cmV0dXJuL14oXC8/fCkoW1xzXFNdKj8pKCg/OlwuezEsMn18W15cL10rP3wpKFwuW14uXC9dKnwpKSg/OltcL10qKSQvLmV4ZWMoZSkuc2xpY2UoMSl9LG5vcm1hbGl6ZUFycmF5OmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPTAsbj1lLmxlbmd0aC0xO24+PTA7bi0tKXt2YXIgbz1lW25dOyIuIj09PW8/ZS5zcGxpY2UobiwxKToiLi4iPT09bz8oZS5zcGxpY2UobiwxKSxyKyspOnImJihlLnNwbGljZShuLDEpLHItLSl9aWYodClmb3IoO3I7ci0tKWUudW5zaGlmdCgiLi4iKTtyZXR1cm4gZX0sbm9ybWFsaXplOmZ1bmN0aW9uKGUpe3ZhciB0PSIvIj09PWUuY2hhckF0KDApLHI9Ii8iPT09ZS5zdWJzdHIoLTEpO3JldHVybihlPWdlLm5vcm1hbGl6ZUFycmF5KGUuc3BsaXQoIi8iKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhdCkuam9pbigiLyIpKXx8dHx8KGU9Ii4iKSxlJiZyJiYoZSs9Ii8iKSwodD8iLyI6IiIpK2V9LGRpcm5hbWU6ZnVuY3Rpb24oZSl7dmFyIHQ9Z2Uuc3BsaXRQYXRoKGUpLHI9dFswXSxuPXRbMV07cmV0dXJuIHJ8fG4/KG4mJihuPW4uc3Vic3RyKDAsbi5sZW5ndGgtMSkpLHIrbik6Ii4ifSxiYXNlbmFtZTpmdW5jdGlvbihlKXtpZigiLyI9PT1lKXJldHVybiIvIjt2YXIgdD1lLmxhc3RJbmRleE9mKCIvIik7cmV0dXJuLTE9PT10P2U6ZS5zdWJzdHIodCsxKX0sZXh0bmFtZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2Uuc3BsaXRQYXRoKGUpWzNdfSxqb2luOmZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO3JldHVybiBnZS5ub3JtYWxpemUoZS5qb2luKCIvIikpfSxqb2luMjpmdW5jdGlvbihlLHQpe3JldHVybiBnZS5ub3JtYWxpemUoZSsiLyIrdCl9LHJlc29sdmU6ZnVuY3Rpb24oKXtmb3IodmFyIGU9IiIsdD0hMSxyPWFyZ3VtZW50cy5sZW5ndGgtMTtyPj0tMSYmIXQ7ci0tKXt2YXIgbj1yPj0wP2FyZ3VtZW50c1tyXTpUZS5jd2QoKTtpZigic3RyaW5nIiE9dHlwZW9mIG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiQXJndW1lbnRzIHRvIHBhdGgucmVzb2x2ZSBtdXN0IGJlIHN0cmluZ3MiKTtpZighbilyZXR1cm4iIjtlPW4rIi8iK2UsdD0iLyI9PT1uLmNoYXJBdCgwKX1yZXR1cm4odD8iLyI6IiIpKyhlPWdlLm5vcm1hbGl6ZUFycmF5KGUuc3BsaXQoIi8iKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhdCkuam9pbigiLyIpKXx8Ii4ifSxyZWxhdGl2ZTpmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIHIoZSl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aCYmIiI9PT1lW3RdO3QrKyk7Zm9yKHZhciByPWUubGVuZ3RoLTE7cj49MCYmIiI9PT1lW3JdO3ItLSk7cmV0dXJuIHQ+cj9bXTplLnNsaWNlKHQsci10KzEpfWU9Z2UucmVzb2x2ZShlKS5zdWJzdHIoMSksdD1nZS5yZXNvbHZlKHQpLnN1YnN0cigxKTtmb3IodmFyIG49cihlLnNwbGl0KCIvIikpLG89cih0LnNwbGl0KCIvIikpLGk9TWF0aC5taW4obi5sZW5ndGgsby5sZW5ndGgpLGE9aSxzPTA7czxpO3MrKylpZihuW3NdIT09b1tzXSl7YT1zO2JyZWFrfXZhciB1PVtdO2ZvcihzPWE7czxuLmxlbmd0aDtzKyspdS5wdXNoKCIuLiIpO3JldHVybih1PXUuY29uY2F0KG8uc2xpY2UoYSkpKS5qb2luKCIvIil9fSx2ZT17dHR5czpbXSxpbml0OmZ1bmN0aW9uKCl7fSxzaHV0ZG93bjpmdW5jdGlvbigpe30scmVnaXN0ZXI6ZnVuY3Rpb24oZSx0KXt2ZS50dHlzW2VdPXtpbnB1dDpbXSxvdXRwdXQ6W10sb3BzOnR9LFRlLnJlZ2lzdGVyRGV2aWNlKGUsdmUuc3RyZWFtX29wcyl9LHN0cmVhbV9vcHM6e29wZW46ZnVuY3Rpb24oZSl7dmFyIHQ9dmUudHR5c1tlLm5vZGUucmRldl07aWYoIXQpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PREVWKTtlLnR0eT10LGUuc2Vla2FibGU9ITF9LGNsb3NlOmZ1bmN0aW9uKGUpe2UudHR5Lm9wcy5mbHVzaChlLnR0eSl9LGZsdXNoOmZ1bmN0aW9uKGUpe2UudHR5Lm9wcy5mbHVzaChlLnR0eSl9LHJlYWQ6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighZS50dHl8fCFlLnR0eS5vcHMuZ2V0X2NoYXIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5YSU8pO2Zvcih2YXIgaT0wLGE9MDthPG47YSsrKXt2YXIgczt0cnl7cz1lLnR0eS5vcHMuZ2V0X2NoYXIoZS50dHkpfWNhdGNoKGUpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTyl9aWYodm9pZCAwPT09cyYmMD09PWkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUFHQUlOKTtpZihudWxsPT1zKWJyZWFrO2krKyx0W3IrYV09c31yZXR1cm4gaSYmKGUubm9kZS50aW1lc3RhbXA9RGF0ZS5ub3coKSksaX0sd3JpdGU6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighZS50dHl8fCFlLnR0eS5vcHMucHV0X2NoYXIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5YSU8pO2Zvcih2YXIgaT0wO2k8bjtpKyspdHJ5e2UudHR5Lm9wcy5wdXRfY2hhcihlLnR0eSx0W3IraV0pfWNhdGNoKGUpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTyl9cmV0dXJuIG4mJihlLm5vZGUudGltZXN0YW1wPURhdGUubm93KCkpLGl9fSxkZWZhdWx0X3R0eV9vcHM6e2dldF9jaGFyOmZ1bmN0aW9uKGUpe2lmKCFlLmlucHV0Lmxlbmd0aCl7dmFyIHQ9bnVsbDtpZihsKXt2YXIgcj1uZXcgQnVmZmVyKDI1Niksbj0wLG89IndpbjMyIiE9cHJvY2Vzcy5wbGF0Zm9ybSxpPXByb2Nlc3Muc3RkaW4uZmQ7aWYobyl7dmFyIGE9ITE7dHJ5e2k9ZnMub3BlblN5bmMoIi9kZXYvc3RkaW4iLCJyIiksYT0hMH1jYXRjaChlKXt9fXRyeXtuPWZzLnJlYWRTeW5jKGksciwwLDI1NixudWxsKX1jYXRjaChlKXtpZigtMT09ZS50b1N0cmluZygpLmluZGV4T2YoIkVPRiIpKXRocm93IGU7bj0wfWEmJmZzLmNsb3NlU3luYyhpKSx0PW4+MD9yLnNsaWNlKDAsbikudG9TdHJpbmcoInV0Zi04Iik6bnVsbH1lbHNlInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJiJmdW5jdGlvbiI9PXR5cGVvZiB3aW5kb3cucHJvbXB0P251bGwhPT0odD13aW5kb3cucHJvbXB0KCJJbnB1dDogIikpJiYodCs9IlxuIik6ImZ1bmN0aW9uIj09dHlwZW9mIHJlYWRsaW5lJiZudWxsIT09KHQ9cmVhZGxpbmUoKSkmJih0Kz0iXG4iKTtpZighdClyZXR1cm4gbnVsbDtlLmlucHV0PSR0KHQsITApfXJldHVybiBlLmlucHV0LnNoaWZ0KCl9LHB1dF9jaGFyOmZ1bmN0aW9uKGUsdCl7bnVsbD09PXR8fDEwPT09dD8oby5wcmludChfKGUub3V0cHV0LDApKSxlLm91dHB1dD1bXSk6MCE9dCYmZS5vdXRwdXQucHVzaCh0KX0sZmx1c2g6ZnVuY3Rpb24oZSl7ZS5vdXRwdXQmJmUub3V0cHV0Lmxlbmd0aD4wJiYoby5wcmludChfKGUub3V0cHV0LDApKSxlLm91dHB1dD1bXSl9fSxkZWZhdWx0X3R0eTFfb3BzOntwdXRfY2hhcjpmdW5jdGlvbihlLHQpe251bGw9PT10fHwxMD09PXQ/KG8ucHJpbnRFcnIoXyhlLm91dHB1dCwwKSksZS5vdXRwdXQ9W10pOjAhPXQmJmUub3V0cHV0LnB1c2godCl9LGZsdXNoOmZ1bmN0aW9uKGUpe2Uub3V0cHV0JiZlLm91dHB1dC5sZW5ndGg+MCYmKG8ucHJpbnRFcnIoXyhlLm91dHB1dCwwKSksZS5vdXRwdXQ9W10pfX19LHdlPXtvcHNfdGFibGU6bnVsbCxtb3VudDpmdW5jdGlvbihlKXtyZXR1cm4gd2UuY3JlYXRlTm9kZShudWxsLCIvIiwxNjg5NSwwKX0sY3JlYXRlTm9kZTpmdW5jdGlvbihlLHQscixuKXtpZihUZS5pc0Jsa2RldihyKXx8VGUuaXNGSUZPKHIpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKTt3ZS5vcHNfdGFibGV8fCh3ZS5vcHNfdGFibGU9e2Rpcjp7bm9kZTp7Z2V0YXR0cjp3ZS5ub2RlX29wcy5nZXRhdHRyLHNldGF0dHI6d2Uubm9kZV9vcHMuc2V0YXR0cixsb29rdXA6d2Uubm9kZV9vcHMubG9va3VwLG1rbm9kOndlLm5vZGVfb3BzLm1rbm9kLHJlbmFtZTp3ZS5ub2RlX29wcy5yZW5hbWUsdW5saW5rOndlLm5vZGVfb3BzLnVubGluayxybWRpcjp3ZS5ub2RlX29wcy5ybWRpcixyZWFkZGlyOndlLm5vZGVfb3BzLnJlYWRkaXIsc3ltbGluazp3ZS5ub2RlX29wcy5zeW1saW5rfSxzdHJlYW06e2xsc2Vlazp3ZS5zdHJlYW1fb3BzLmxsc2Vla319LGZpbGU6e25vZGU6e2dldGF0dHI6d2Uubm9kZV9vcHMuZ2V0YXR0cixzZXRhdHRyOndlLm5vZGVfb3BzLnNldGF0dHJ9LHN0cmVhbTp7bGxzZWVrOndlLnN0cmVhbV9vcHMubGxzZWVrLHJlYWQ6d2Uuc3RyZWFtX29wcy5yZWFkLHdyaXRlOndlLnN0cmVhbV9vcHMud3JpdGUsYWxsb2NhdGU6d2Uuc3RyZWFtX29wcy5hbGxvY2F0ZSxtbWFwOndlLnN0cmVhbV9vcHMubW1hcCxtc3luYzp3ZS5zdHJlYW1fb3BzLm1zeW5jfX0sbGluazp7bm9kZTp7Z2V0YXR0cjp3ZS5ub2RlX29wcy5nZXRhdHRyLHNldGF0dHI6d2Uubm9kZV9vcHMuc2V0YXR0cixyZWFkbGluazp3ZS5ub2RlX29wcy5yZWFkbGlua30sc3RyZWFtOnt9fSxjaHJkZXY6e25vZGU6e2dldGF0dHI6d2Uubm9kZV9vcHMuZ2V0YXR0cixzZXRhdHRyOndlLm5vZGVfb3BzLnNldGF0dHJ9LHN0cmVhbTpUZS5jaHJkZXZfc3RyZWFtX29wc319KTt2YXIgbz1UZS5jcmVhdGVOb2RlKGUsdCxyLG4pO3JldHVybiBUZS5pc0RpcihvLm1vZGUpPyhvLm5vZGVfb3BzPXdlLm9wc190YWJsZS5kaXIubm9kZSxvLnN0cmVhbV9vcHM9d2Uub3BzX3RhYmxlLmRpci5zdHJlYW0sby5jb250ZW50cz17fSk6VGUuaXNGaWxlKG8ubW9kZSk/KG8ubm9kZV9vcHM9d2Uub3BzX3RhYmxlLmZpbGUubm9kZSxvLnN0cmVhbV9vcHM9d2Uub3BzX3RhYmxlLmZpbGUuc3RyZWFtLG8udXNlZEJ5dGVzPTAsby5jb250ZW50cz1udWxsKTpUZS5pc0xpbmsoby5tb2RlKT8oby5ub2RlX29wcz13ZS5vcHNfdGFibGUubGluay5ub2RlLG8uc3RyZWFtX29wcz13ZS5vcHNfdGFibGUubGluay5zdHJlYW0pOlRlLmlzQ2hyZGV2KG8ubW9kZSkmJihvLm5vZGVfb3BzPXdlLm9wc190YWJsZS5jaHJkZXYubm9kZSxvLnN0cmVhbV9vcHM9d2Uub3BzX3RhYmxlLmNocmRldi5zdHJlYW0pLG8udGltZXN0YW1wPURhdGUubm93KCksZSYmKGUuY29udGVudHNbdF09byksb30sZ2V0RmlsZURhdGFBc1JlZ3VsYXJBcnJheTpmdW5jdGlvbihlKXtpZihlLmNvbnRlbnRzJiZlLmNvbnRlbnRzLnN1YmFycmF5KXtmb3IodmFyIHQ9W10scj0wO3I8ZS51c2VkQnl0ZXM7KytyKXQucHVzaChlLmNvbnRlbnRzW3JdKTtyZXR1cm4gdH1yZXR1cm4gZS5jb250ZW50c30sZ2V0RmlsZURhdGFBc1R5cGVkQXJyYXk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY29udGVudHM/ZS5jb250ZW50cy5zdWJhcnJheT9lLmNvbnRlbnRzLnN1YmFycmF5KDAsZS51c2VkQnl0ZXMpOm5ldyBVaW50OEFycmF5KGUuY29udGVudHMpOm5ldyBVaW50OEFycmF5fSxleHBhbmRGaWxlU3RvcmFnZTpmdW5jdGlvbihlLHQpe2lmKGUuY29udGVudHMmJmUuY29udGVudHMuc3ViYXJyYXkmJnQ+ZS5jb250ZW50cy5sZW5ndGgmJihlLmNvbnRlbnRzPXdlLmdldEZpbGVEYXRhQXNSZWd1bGFyQXJyYXkoZSksZS51c2VkQnl0ZXM9ZS5jb250ZW50cy5sZW5ndGgpLCFlLmNvbnRlbnRzfHxlLmNvbnRlbnRzLnN1YmFycmF5KXt2YXIgcj1lLmNvbnRlbnRzP2UuY29udGVudHMubGVuZ3RoOjA7aWYocj49dClyZXR1cm47dD1NYXRoLm1heCh0LHIqKHI8MTA0ODU3Nj8yOjEuMTI1KXwwKSwwIT1yJiYodD1NYXRoLm1heCh0LDI1NikpO3ZhciBuPWUuY29udGVudHM7cmV0dXJuIGUuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkodCksdm9pZChlLnVzZWRCeXRlcz4wJiZlLmNvbnRlbnRzLnNldChuLnN1YmFycmF5KDAsZS51c2VkQnl0ZXMpLDApKX1mb3IoIWUuY29udGVudHMmJnQ+MCYmKGUuY29udGVudHM9W10pO2UuY29udGVudHMubGVuZ3RoPHQ7KWUuY29udGVudHMucHVzaCgwKX0scmVzaXplRmlsZVN0b3JhZ2U6ZnVuY3Rpb24oZSx0KXtpZihlLnVzZWRCeXRlcyE9dCl7aWYoMD09dClyZXR1cm4gZS5jb250ZW50cz1udWxsLHZvaWQoZS51c2VkQnl0ZXM9MCk7aWYoIWUuY29udGVudHN8fGUuY29udGVudHMuc3ViYXJyYXkpe3ZhciByPWUuY29udGVudHM7cmV0dXJuIGUuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5QnVmZmVyKHQpKSxyJiZlLmNvbnRlbnRzLnNldChyLnN1YmFycmF5KDAsTWF0aC5taW4odCxlLnVzZWRCeXRlcykpKSx2b2lkKGUudXNlZEJ5dGVzPXQpfWlmKGUuY29udGVudHN8fChlLmNvbnRlbnRzPVtdKSxlLmNvbnRlbnRzLmxlbmd0aD50KWUuY29udGVudHMubGVuZ3RoPXQ7ZWxzZSBmb3IoO2UuY29udGVudHMubGVuZ3RoPHQ7KWUuY29udGVudHMucHVzaCgwKTtlLnVzZWRCeXRlcz10fX0sbm9kZV9vcHM6e2dldGF0dHI6ZnVuY3Rpb24oZSl7dmFyIHQ9e307cmV0dXJuIHQuZGV2PVRlLmlzQ2hyZGV2KGUubW9kZSk/ZS5pZDoxLHQuaW5vPWUuaWQsdC5tb2RlPWUubW9kZSx0Lm5saW5rPTEsdC51aWQ9MCx0LmdpZD0wLHQucmRldj1lLnJkZXYsVGUuaXNEaXIoZS5tb2RlKT90LnNpemU9NDA5NjpUZS5pc0ZpbGUoZS5tb2RlKT90LnNpemU9ZS51c2VkQnl0ZXM6VGUuaXNMaW5rKGUubW9kZSk/dC5zaXplPWUubGluay5sZW5ndGg6dC5zaXplPTAsdC5hdGltZT1uZXcgRGF0ZShlLnRpbWVzdGFtcCksdC5tdGltZT1uZXcgRGF0ZShlLnRpbWVzdGFtcCksdC5jdGltZT1uZXcgRGF0ZShlLnRpbWVzdGFtcCksdC5ibGtzaXplPTQwOTYsdC5ibG9ja3M9TWF0aC5jZWlsKHQuc2l6ZS90LmJsa3NpemUpLHR9LHNldGF0dHI6ZnVuY3Rpb24oZSx0KXt2b2lkIDAhPT10Lm1vZGUmJihlLm1vZGU9dC5tb2RlKSx2b2lkIDAhPT10LnRpbWVzdGFtcCYmKGUudGltZXN0YW1wPXQudGltZXN0YW1wKSx2b2lkIDAhPT10LnNpemUmJndlLnJlc2l6ZUZpbGVTdG9yYWdlKGUsdC5zaXplKX0sbG9va3VwOmZ1bmN0aW9uKGUsdCl7dGhyb3cgVGUuZ2VuZXJpY0Vycm9yc1ttZS5FTk9FTlRdfSxta25vZDpmdW5jdGlvbihlLHQscixuKXtyZXR1cm4gd2UuY3JlYXRlTm9kZShlLHQscixuKX0scmVuYW1lOmZ1bmN0aW9uKGUsdCxyKXtpZihUZS5pc0RpcihlLm1vZGUpKXt2YXIgbjt0cnl7bj1UZS5sb29rdXBOb2RlKHQscil9Y2F0Y2goZSl7fWlmKG4pZm9yKHZhciBvIGluIG4uY29udGVudHMpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PVEVNUFRZKX1kZWxldGUgZS5wYXJlbnQuY29udGVudHNbZS5uYW1lXSxlLm5hbWU9cix0LmNvbnRlbnRzW3JdPWUsZS5wYXJlbnQ9dH0sdW5saW5rOmZ1bmN0aW9uKGUsdCl7ZGVsZXRlIGUuY29udGVudHNbdF19LHJtZGlyOmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUubG9va3VwTm9kZShlLHQpO2Zvcih2YXIgbiBpbiByLmNvbnRlbnRzKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RFTVBUWSk7ZGVsZXRlIGUuY29udGVudHNbdF19LHJlYWRkaXI6ZnVuY3Rpb24oZSl7dmFyIHQ9WyIuIiwiLi4iXTtmb3IodmFyIHIgaW4gZS5jb250ZW50cyllLmNvbnRlbnRzLmhhc093blByb3BlcnR5KHIpJiZ0LnB1c2gocik7cmV0dXJuIHR9LHN5bWxpbms6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXdlLmNyZWF0ZU5vZGUoZSx0LDQxNDcxLDApO3JldHVybiBuLmxpbms9cixufSxyZWFkbGluazpmdW5jdGlvbihlKXtpZighVGUuaXNMaW5rKGUubW9kZSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtyZXR1cm4gZS5saW5rfX0sc3RyZWFtX29wczp7cmVhZDpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWUubm9kZS5jb250ZW50cztpZihvPj1lLm5vZGUudXNlZEJ5dGVzKXJldHVybiAwO3ZhciBhPU1hdGgubWluKGUubm9kZS51c2VkQnl0ZXMtbyxuKTtpZih5KGE+PTApLGE+OCYmaS5zdWJhcnJheSl0LnNldChpLnN1YmFycmF5KG8sbythKSxyKTtlbHNlIGZvcih2YXIgcz0wO3M8YTtzKyspdFtyK3NdPWlbbytzXTtyZXR1cm4gYX0sd3JpdGU6ZnVuY3Rpb24oZSx0LHIsbixvLGkpe2lmKCFuKXJldHVybiAwO3ZhciBhPWUubm9kZTtpZihhLnRpbWVzdGFtcD1EYXRlLm5vdygpLHQuc3ViYXJyYXkmJighYS5jb250ZW50c3x8YS5jb250ZW50cy5zdWJhcnJheSkpe2lmKGkpcmV0dXJuIGEuY29udGVudHM9dC5zdWJhcnJheShyLHIrbiksYS51c2VkQnl0ZXM9bixuO2lmKDA9PT1hLnVzZWRCeXRlcyYmMD09PW8pcmV0dXJuIGEuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkodC5zdWJhcnJheShyLHIrbikpLGEudXNlZEJ5dGVzPW4sbjtpZihvK248PWEudXNlZEJ5dGVzKXJldHVybiBhLmNvbnRlbnRzLnNldCh0LnN1YmFycmF5KHIscituKSxvKSxufWlmKHdlLmV4cGFuZEZpbGVTdG9yYWdlKGEsbytuKSxhLmNvbnRlbnRzLnN1YmFycmF5JiZ0LnN1YmFycmF5KWEuY29udGVudHMuc2V0KHQuc3ViYXJyYXkocixyK24pLG8pO2Vsc2UgZm9yKHZhciBzPTA7czxuO3MrKylhLmNvbnRlbnRzW28rc109dFtyK3NdO3JldHVybiBhLnVzZWRCeXRlcz1NYXRoLm1heChhLnVzZWRCeXRlcyxvK24pLG59LGxsc2VlazpmdW5jdGlvbihlLHQscil7dmFyIG49dDtpZigxPT09cj9uKz1lLnBvc2l0aW9uOjI9PT1yJiZUZS5pc0ZpbGUoZS5ub2RlLm1vZGUpJiYobis9ZS5ub2RlLnVzZWRCeXRlcyksbjwwKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7cmV0dXJuIG59LGFsbG9jYXRlOmZ1bmN0aW9uKGUsdCxyKXt3ZS5leHBhbmRGaWxlU3RvcmFnZShlLm5vZGUsdCtyKSxlLm5vZGUudXNlZEJ5dGVzPU1hdGgubWF4KGUubm9kZS51c2VkQnl0ZXMsdCtyKX0sbW1hcDpmdW5jdGlvbihlLHQscixuLG8saSxhKXtpZighVGUuaXNGaWxlKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9ERVYpO3ZhciBzLHUsYz1lLm5vZGUuY29udGVudHM7aWYoMiZhfHxjLmJ1ZmZlciE9PXQmJmMuYnVmZmVyIT09dC5idWZmZXIpe2lmKChvPjB8fG8rbjxlLm5vZGUudXNlZEJ5dGVzKSYmKGM9Yy5zdWJhcnJheT9jLnN1YmFycmF5KG8sbytuKTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjLG8sbytuKSksdT0hMCwhKHM9SnQobikpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT01FTSk7dC5zZXQoYyxzKX1lbHNlIHU9ITEscz1jLmJ5dGVPZmZzZXQ7cmV0dXJue3B0cjpzLGFsbG9jYXRlZDp1fX0sbXN5bmM6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighVGUuaXNGaWxlKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9ERVYpO2lmKDImbylyZXR1cm4gMDt3ZS5zdHJlYW1fb3BzLndyaXRlKGUsdCwwLG4sciwhMSk7cmV0dXJuIDB9fX0sX2U9e2Riczp7fSxpbmRleGVkREI6ZnVuY3Rpb24oKXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGluZGV4ZWREQilyZXR1cm4gaW5kZXhlZERCO3ZhciBlPW51bGw7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJihlPXdpbmRvdy5pbmRleGVkREJ8fHdpbmRvdy5tb3pJbmRleGVkREJ8fHdpbmRvdy53ZWJraXRJbmRleGVkREJ8fHdpbmRvdy5tc0luZGV4ZWREQikseShlLCJJREJGUyB1c2VkLCBidXQgaW5kZXhlZERCIG5vdCBzdXBwb3J0ZWQiKSxlfSxEQl9WRVJTSU9OOjIxLERCX1NUT1JFX05BTUU6IkZJTEVfREFUQSIsbW91bnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlLm1vdW50LmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc3luY2ZzOmZ1bmN0aW9uKGUsdCxyKXtfZS5nZXRMb2NhbFNldChlLChmdW5jdGlvbihuLG8pe2lmKG4pcmV0dXJuIHIobik7X2UuZ2V0UmVtb3RlU2V0KGUsKGZ1bmN0aW9uKGUsbil7aWYoZSlyZXR1cm4gcihlKTt2YXIgaT10P246byxhPXQ/bzpuO19lLnJlY29uY2lsZShpLGEscil9KSl9KSl9LGdldERCOmZ1bmN0aW9uKGUsdCl7dmFyIHIsbj1fZS5kYnNbZV07aWYobilyZXR1cm4gdChudWxsLG4pO3RyeXtyPV9lLmluZGV4ZWREQigpLm9wZW4oZSxfZS5EQl9WRVJTSU9OKX1jYXRjaChlKXtyZXR1cm4gdChlKX1pZighcilyZXR1cm4gdCgiVW5hYmxlIHRvIGNvbm5lY3QgdG8gSW5kZXhlZERCIik7ci5vbnVwZ3JhZGVuZWVkZWQ9ZnVuY3Rpb24oZSl7dmFyIHQscj1lLnRhcmdldC5yZXN1bHQsbj1lLnRhcmdldC50cmFuc2FjdGlvbjsodD1yLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoX2UuREJfU1RPUkVfTkFNRSk/bi5vYmplY3RTdG9yZShfZS5EQl9TVE9SRV9OQU1FKTpyLmNyZWF0ZU9iamVjdFN0b3JlKF9lLkRCX1NUT1JFX05BTUUpKS5pbmRleE5hbWVzLmNvbnRhaW5zKCJ0aW1lc3RhbXAiKXx8dC5jcmVhdGVJbmRleCgidGltZXN0YW1wIiwidGltZXN0YW1wIix7dW5pcXVlOiExfSl9LHIub25zdWNjZXNzPWZ1bmN0aW9uKCl7bj1yLnJlc3VsdCxfZS5kYnNbZV09bix0KG51bGwsbil9LHIub25lcnJvcj1mdW5jdGlvbihlKXt0KHRoaXMuZXJyb3IpLGUucHJldmVudERlZmF1bHQoKX19LGdldExvY2FsU2V0OmZ1bmN0aW9uKGUsdCl7dmFyIHI9e307ZnVuY3Rpb24gbihlKXtyZXR1cm4iLiIhPT1lJiYiLi4iIT09ZX1mdW5jdGlvbiBvKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZ2Uuam9pbjIoZSx0KX19Zm9yKHZhciBpPVRlLnJlYWRkaXIoZS5tb3VudHBvaW50KS5maWx0ZXIobikubWFwKG8oZS5tb3VudHBvaW50KSk7aS5sZW5ndGg7KXt2YXIgYSxzPWkucG9wKCk7dHJ5e2E9VGUuc3RhdChzKX1jYXRjaChlKXtyZXR1cm4gdChlKX1UZS5pc0RpcihhLm1vZGUpJiZpLnB1c2guYXBwbHkoaSxUZS5yZWFkZGlyKHMpLmZpbHRlcihuKS5tYXAobyhzKSkpLHJbc109e3RpbWVzdGFtcDphLm10aW1lfX1yZXR1cm4gdChudWxsLHt0eXBlOiJsb2NhbCIsZW50cmllczpyfSl9LGdldFJlbW90ZVNldDpmdW5jdGlvbihlLHQpe3ZhciByPXt9O19lLmdldERCKGUubW91bnRwb2ludCwoZnVuY3Rpb24oZSxuKXtpZihlKXJldHVybiB0KGUpO3RyeXt2YXIgbz1uLnRyYW5zYWN0aW9uKFtfZS5EQl9TVE9SRV9OQU1FXSwicmVhZG9ubHkiKTtvLm9uZXJyb3I9ZnVuY3Rpb24oZSl7dCh0aGlzLmVycm9yKSxlLnByZXZlbnREZWZhdWx0KCl9LG8ub2JqZWN0U3RvcmUoX2UuREJfU1RPUkVfTkFNRSkuaW5kZXgoInRpbWVzdGFtcCIpLm9wZW5LZXlDdXJzb3IoKS5vbnN1Y2Nlc3M9ZnVuY3Rpb24oZSl7dmFyIG89ZS50YXJnZXQucmVzdWx0O2lmKCFvKXJldHVybiB0KG51bGwse3R5cGU6InJlbW90ZSIsZGI6bixlbnRyaWVzOnJ9KTtyW28ucHJpbWFyeUtleV09e3RpbWVzdGFtcDpvLmtleX0sby5jb250aW51ZSgpfX1jYXRjaChlKXtyZXR1cm4gdChlKX19KSl9LGxvYWRMb2NhbEVudHJ5OmZ1bmN0aW9uKGUsdCl7dmFyIHIsbjt0cnl7bj1UZS5sb29rdXBQYXRoKGUpLm5vZGUscj1UZS5zdGF0KGUpfWNhdGNoKGUpe3JldHVybiB0KGUpfXJldHVybiBUZS5pc0RpcihyLm1vZGUpP3QobnVsbCx7dGltZXN0YW1wOnIubXRpbWUsbW9kZTpyLm1vZGV9KTpUZS5pc0ZpbGUoci5tb2RlKT8obi5jb250ZW50cz13ZS5nZXRGaWxlRGF0YUFzVHlwZWRBcnJheShuKSx0KG51bGwse3RpbWVzdGFtcDpyLm10aW1lLG1vZGU6ci5tb2RlLGNvbnRlbnRzOm4uY29udGVudHN9KSk6dChuZXcgRXJyb3IoIm5vZGUgdHlwZSBub3Qgc3VwcG9ydGVkIikpfSxzdG9yZUxvY2FsRW50cnk6ZnVuY3Rpb24oZSx0LHIpe3RyeXtpZihUZS5pc0Rpcih0Lm1vZGUpKVRlLm1rZGlyKGUsdC5tb2RlKTtlbHNle2lmKCFUZS5pc0ZpbGUodC5tb2RlKSlyZXR1cm4gcihuZXcgRXJyb3IoIm5vZGUgdHlwZSBub3Qgc3VwcG9ydGVkIikpO1RlLndyaXRlRmlsZShlLHQuY29udGVudHMse2Nhbk93bjohMH0pfVRlLmNobW9kKGUsdC5tb2RlKSxUZS51dGltZShlLHQudGltZXN0YW1wLHQudGltZXN0YW1wKX1jYXRjaChlKXtyZXR1cm4gcihlKX1yKG51bGwpfSxyZW1vdmVMb2NhbEVudHJ5OmZ1bmN0aW9uKGUsdCl7dHJ5e1RlLmxvb2t1cFBhdGgoZSk7dmFyIHI9VGUuc3RhdChlKTtUZS5pc0RpcihyLm1vZGUpP1RlLnJtZGlyKGUpOlRlLmlzRmlsZShyLm1vZGUpJiZUZS51bmxpbmsoZSl9Y2F0Y2goZSl7cmV0dXJuIHQoZSl9dChudWxsKX0sbG9hZFJlbW90ZUVudHJ5OmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj1lLmdldCh0KTtuLm9uc3VjY2Vzcz1mdW5jdGlvbihlKXtyKG51bGwsZS50YXJnZXQucmVzdWx0KX0sbi5vbmVycm9yPWZ1bmN0aW9uKGUpe3IodGhpcy5lcnJvciksZS5wcmV2ZW50RGVmYXVsdCgpfX0sc3RvcmVSZW1vdGVFbnRyeTpmdW5jdGlvbihlLHQscixuKXt2YXIgbz1lLnB1dChyLHQpO28ub25zdWNjZXNzPWZ1bmN0aW9uKCl7bihudWxsKX0sby5vbmVycm9yPWZ1bmN0aW9uKGUpe24odGhpcy5lcnJvciksZS5wcmV2ZW50RGVmYXVsdCgpfX0scmVtb3ZlUmVtb3RlRW50cnk6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUuZGVsZXRlKHQpO24ub25zdWNjZXNzPWZ1bmN0aW9uKCl7cihudWxsKX0sbi5vbmVycm9yPWZ1bmN0aW9uKGUpe3IodGhpcy5lcnJvciksZS5wcmV2ZW50RGVmYXVsdCgpfX0scmVjb25jaWxlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj0wLG89W107T2JqZWN0LmtleXMoZS5lbnRyaWVzKS5mb3JFYWNoKChmdW5jdGlvbihyKXt2YXIgaT1lLmVudHJpZXNbcl0sYT10LmVudHJpZXNbcl07KCFhfHxpLnRpbWVzdGFtcD5hLnRpbWVzdGFtcCkmJihvLnB1c2gociksbisrKX0pKTt2YXIgaT1bXTtpZihPYmplY3Qua2V5cyh0LmVudHJpZXMpLmZvckVhY2goKGZ1bmN0aW9uKHIpe3QuZW50cmllc1tyXTtlLmVudHJpZXNbcl18fChpLnB1c2gociksbisrKX0pKSwhbilyZXR1cm4gcihudWxsKTt2YXIgYT0wLHM9KCJyZW1vdGUiPT09ZS50eXBlP2UuZGI6dC5kYikudHJhbnNhY3Rpb24oW19lLkRCX1NUT1JFX05BTUVdLCJyZWFkd3JpdGUiKSx1PXMub2JqZWN0U3RvcmUoX2UuREJfU1RPUkVfTkFNRSk7ZnVuY3Rpb24gYyhlKXtyZXR1cm4gZT9jLmVycm9yZWQ/dm9pZCAwOihjLmVycm9yZWQ9ITAscihlKSk6KythPj1uP3IobnVsbCk6dm9pZCAwfXMub25lcnJvcj1mdW5jdGlvbihlKXtjKHRoaXMuZXJyb3IpLGUucHJldmVudERlZmF1bHQoKX0sby5zb3J0KCkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ImxvY2FsIj09PXQudHlwZT9fZS5sb2FkUmVtb3RlRW50cnkodSxlLChmdW5jdGlvbih0LHIpe2lmKHQpcmV0dXJuIGModCk7X2Uuc3RvcmVMb2NhbEVudHJ5KGUscixjKX0pKTpfZS5sb2FkTG9jYWxFbnRyeShlLChmdW5jdGlvbih0LHIpe2lmKHQpcmV0dXJuIGModCk7X2Uuc3RvcmVSZW1vdGVFbnRyeSh1LGUscixjKX0pKX0pKSxpLnNvcnQoKS5yZXZlcnNlKCkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ImxvY2FsIj09PXQudHlwZT9fZS5yZW1vdmVMb2NhbEVudHJ5KGUsYyk6X2UucmVtb3ZlUmVtb3RlRW50cnkodSxlLGMpfSkpfX0sYmU9e2lzV2luZG93czohMSxzdGF0aWNJbml0OmZ1bmN0aW9uKCl7YmUuaXNXaW5kb3dzPSEhcHJvY2Vzcy5wbGF0Zm9ybS5tYXRjaCgvXndpbi8pO3ZhciBlPXByb2Nlc3MuYmluZGluZygiY29uc3RhbnRzIik7ZS5mcyYmKGU9ZS5mcyksYmUuZmxhZ3NGb3JOb2RlTWFwPXsxMDI0OmUuT19BUFBFTkQsNjQ6ZS5PX0NSRUFULDEyODplLk9fRVhDTCwwOmUuT19SRE9OTFksMjplLk9fUkRXUiw0MDk2OmUuT19TWU5DLDUxMjplLk9fVFJVTkMsMTplLk9fV1JPTkxZfX0sYnVmZmVyRnJvbTpmdW5jdGlvbihlKXtyZXR1cm4gQnVmZmVyLmFsbG9jP0J1ZmZlci5mcm9tKGUpOm5ldyBCdWZmZXIoZSl9LG1vdW50OmZ1bmN0aW9uKGUpe3JldHVybiB5KGwpLGJlLmNyZWF0ZU5vZGUobnVsbCwiLyIsYmUuZ2V0TW9kZShlLm9wdHMucm9vdCksMCl9LGNyZWF0ZU5vZGU6ZnVuY3Rpb24oZSx0LHIsbil7aWYoIVRlLmlzRGlyKHIpJiYhVGUuaXNGaWxlKHIpJiYhVGUuaXNMaW5rKHIpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIG89VGUuY3JlYXRlTm9kZShlLHQscik7cmV0dXJuIG8ubm9kZV9vcHM9YmUubm9kZV9vcHMsby5zdHJlYW1fb3BzPWJlLnN0cmVhbV9vcHMsb30sZ2V0TW9kZTpmdW5jdGlvbihlKXt2YXIgdDt0cnl7dD1mcy5sc3RhdFN5bmMoZSksYmUuaXNXaW5kb3dzJiYodC5tb2RlPXQubW9kZXwoMjkyJnQubW9kZSk+PjIpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX1yZXR1cm4gdC5tb2RlfSxyZWFsUGF0aDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9W107ZS5wYXJlbnQhPT1lOyl0LnB1c2goZS5uYW1lKSxlPWUucGFyZW50O3JldHVybiB0LnB1c2goZS5tb3VudC5vcHRzLnJvb3QpLHQucmV2ZXJzZSgpLGdlLmpvaW4uYXBwbHkobnVsbCx0KX0sZmxhZ3NGb3JOb2RlOmZ1bmN0aW9uKGUpe2UmPS0yMDk3MTUzLGUmPS0yMDQ5LGUmPS0zMjc2OSxlJj0tNTI0Mjg5O3ZhciB0PTA7Zm9yKHZhciByIGluIGJlLmZsYWdzRm9yTm9kZU1hcCllJnImJih0fD1iZS5mbGFnc0Zvck5vZGVNYXBbcl0sZV49cik7aWYoZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO3JldHVybiB0fSxub2RlX29wczp7Z2V0YXR0cjpmdW5jdGlvbihlKXt2YXIgdCxyPWJlLnJlYWxQYXRoKGUpO3RyeXt0PWZzLmxzdGF0U3luYyhyKX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9cmV0dXJuIGJlLmlzV2luZG93cyYmIXQuYmxrc2l6ZSYmKHQuYmxrc2l6ZT00MDk2KSxiZS5pc1dpbmRvd3MmJiF0LmJsb2NrcyYmKHQuYmxvY2tzPSh0LnNpemUrdC5ibGtzaXplLTEpL3QuYmxrc2l6ZXwwKSx7ZGV2OnQuZGV2LGlubzp0Lmlubyxtb2RlOnQubW9kZSxubGluazp0Lm5saW5rLHVpZDp0LnVpZCxnaWQ6dC5naWQscmRldjp0LnJkZXYsc2l6ZTp0LnNpemUsYXRpbWU6dC5hdGltZSxtdGltZTp0Lm10aW1lLGN0aW1lOnQuY3RpbWUsYmxrc2l6ZTp0LmJsa3NpemUsYmxvY2tzOnQuYmxvY2tzfX0sc2V0YXR0cjpmdW5jdGlvbihlLHQpe3ZhciByPWJlLnJlYWxQYXRoKGUpO3RyeXtpZih2b2lkIDAhPT10Lm1vZGUmJihmcy5jaG1vZFN5bmMocix0Lm1vZGUpLGUubW9kZT10Lm1vZGUpLHZvaWQgMCE9PXQudGltZXN0YW1wKXt2YXIgbj1uZXcgRGF0ZSh0LnRpbWVzdGFtcCk7ZnMudXRpbWVzU3luYyhyLG4sbil9dm9pZCAwIT09dC5zaXplJiZmcy50cnVuY2F0ZVN5bmMocix0LnNpemUpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LGxvb2t1cDpmdW5jdGlvbihlLHQpe3ZhciByPWdlLmpvaW4yKGJlLnJlYWxQYXRoKGUpLHQpLG49YmUuZ2V0TW9kZShyKTtyZXR1cm4gYmUuY3JlYXRlTm9kZShlLHQsbil9LG1rbm9kOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPWJlLmNyZWF0ZU5vZGUoZSx0LHIsbiksaT1iZS5yZWFsUGF0aChvKTt0cnl7VGUuaXNEaXIoby5tb2RlKT9mcy5ta2RpclN5bmMoaSxvLm1vZGUpOmZzLndyaXRlRmlsZVN5bmMoaSwiIix7bW9kZTpvLm1vZGV9KX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9cmV0dXJuIG99LHJlbmFtZTpmdW5jdGlvbihlLHQscil7dmFyIG49YmUucmVhbFBhdGgoZSksbz1nZS5qb2luMihiZS5yZWFsUGF0aCh0KSxyKTt0cnl7ZnMucmVuYW1lU3luYyhuLG8pfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LHVubGluazpmdW5jdGlvbihlLHQpe3ZhciByPWdlLmpvaW4yKGJlLnJlYWxQYXRoKGUpLHQpO3RyeXtmcy51bmxpbmtTeW5jKHIpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LHJtZGlyOmZ1bmN0aW9uKGUsdCl7dmFyIHI9Z2Uuam9pbjIoYmUucmVhbFBhdGgoZSksdCk7dHJ5e2ZzLnJtZGlyU3luYyhyKX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9fSxyZWFkZGlyOmZ1bmN0aW9uKGUpe3ZhciB0PWJlLnJlYWxQYXRoKGUpO3RyeXtyZXR1cm4gZnMucmVhZGRpclN5bmModCl9Y2F0Y2goZSl7aWYoIWUuY29kZSl0aHJvdyBlO3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lW2UuY29kZV0pfX0sc3ltbGluazpmdW5jdGlvbihlLHQscil7dmFyIG49Z2Uuam9pbjIoYmUucmVhbFBhdGgoZSksdCk7dHJ5e2ZzLnN5bWxpbmtTeW5jKHIsbil9Y2F0Y2goZSl7aWYoIWUuY29kZSl0aHJvdyBlO3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lW2UuY29kZV0pfX0scmVhZGxpbms6ZnVuY3Rpb24oZSl7dmFyIHQ9YmUucmVhbFBhdGgoZSk7dHJ5e3JldHVybiB0PWZzLnJlYWRsaW5rU3luYyh0KSx0PU5PREVKU19QQVRILnJlbGF0aXZlKE5PREVKU19QQVRILnJlc29sdmUoZS5tb3VudC5vcHRzLnJvb3QpLHQpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19fSxzdHJlYW1fb3BzOntvcGVuOmZ1bmN0aW9uKGUpe3ZhciB0PWJlLnJlYWxQYXRoKGUubm9kZSk7dHJ5e1RlLmlzRmlsZShlLm5vZGUubW9kZSkmJihlLm5mZD1mcy5vcGVuU3luYyh0LGJlLmZsYWdzRm9yTm9kZShlLmZsYWdzKSkpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LGNsb3NlOmZ1bmN0aW9uKGUpe3RyeXtUZS5pc0ZpbGUoZS5ub2RlLm1vZGUpJiZlLm5mZCYmZnMuY2xvc2VTeW5jKGUubmZkKX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9fSxyZWFkOmZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYoMD09PW4pcmV0dXJuIDA7dHJ5e3JldHVybiBmcy5yZWFkU3luYyhlLm5mZCxiZS5idWZmZXJGcm9tKHQuYnVmZmVyKSxyLG4sbyl9Y2F0Y2goZSl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9fSx3cml0ZTpmdW5jdGlvbihlLHQscixuLG8pe3RyeXtyZXR1cm4gZnMud3JpdGVTeW5jKGUubmZkLGJlLmJ1ZmZlckZyb20odC5idWZmZXIpLHIsbixvKX1jYXRjaChlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LGxsc2VlazpmdW5jdGlvbihlLHQscil7dmFyIG49dDtpZigxPT09ciluKz1lLnBvc2l0aW9uO2Vsc2UgaWYoMj09PXImJlRlLmlzRmlsZShlLm5vZGUubW9kZSkpdHJ5e24rPWZzLmZzdGF0U3luYyhlLm5mZCkuc2l6ZX1jYXRjaChlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX1pZihuPDApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtyZXR1cm4gbn19fSxBZT17RElSX01PREU6MTY4OTUsRklMRV9NT0RFOjMzMjc5LHJlYWRlcjpudWxsLG1vdW50OmZ1bmN0aW9uKGUpe3koYyksQWUucmVhZGVyfHwoQWUucmVhZGVyPW5ldyBGaWxlUmVhZGVyU3luYyk7dmFyIHQ9QWUuY3JlYXRlTm9kZShudWxsLCIvIixBZS5ESVJfTU9ERSwwKSxyPXt9O2Z1bmN0aW9uIG4oZSl7Zm9yKHZhciBuPWUuc3BsaXQoIi8iKSxvPXQsaT0wO2k8bi5sZW5ndGgtMTtpKyspe3ZhciBhPW4uc2xpY2UoMCxpKzEpLmpvaW4oIi8iKTtyW2FdfHwoclthXT1BZS5jcmVhdGVOb2RlKG8sbltpXSxBZS5ESVJfTU9ERSwwKSksbz1yW2FdfXJldHVybiBvfWZ1bmN0aW9uIG8oZSl7dmFyIHQ9ZS5zcGxpdCgiLyIpO3JldHVybiB0W3QubGVuZ3RoLTFdfXJldHVybiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGUub3B0cy5maWxlc3x8W10sKGZ1bmN0aW9uKGUpe0FlLmNyZWF0ZU5vZGUobihlLm5hbWUpLG8oZS5uYW1lKSxBZS5GSUxFX01PREUsMCxlLGUubGFzdE1vZGlmaWVkRGF0ZSl9KSksKGUub3B0cy5ibG9ic3x8W10pLmZvckVhY2goKGZ1bmN0aW9uKGUpe0FlLmNyZWF0ZU5vZGUobihlLm5hbWUpLG8oZS5uYW1lKSxBZS5GSUxFX01PREUsMCxlLmRhdGEpfSkpLChlLm9wdHMucGFja2FnZXN8fFtdKS5mb3JFYWNoKChmdW5jdGlvbihlKXtlLm1ldGFkYXRhLmZpbGVzLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciByPXQuZmlsZW5hbWUuc3Vic3RyKDEpO0FlLmNyZWF0ZU5vZGUobihyKSxvKHIpLEFlLkZJTEVfTU9ERSwwLGUuYmxvYi5zbGljZSh0LnN0YXJ0LHQuZW5kKSl9KSl9KSksdH0sY3JlYXRlTm9kZTpmdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGE9VGUuY3JlYXRlTm9kZShlLHQscik7cmV0dXJuIGEubW9kZT1yLGEubm9kZV9vcHM9QWUubm9kZV9vcHMsYS5zdHJlYW1fb3BzPUFlLnN0cmVhbV9vcHMsYS50aW1lc3RhbXA9KGl8fG5ldyBEYXRlKS5nZXRUaW1lKCkseShBZS5GSUxFX01PREUhPT1BZS5ESVJfTU9ERSkscj09PUFlLkZJTEVfTU9ERT8oYS5zaXplPW8uc2l6ZSxhLmNvbnRlbnRzPW8pOihhLnNpemU9NDA5NixhLmNvbnRlbnRzPXt9KSxlJiYoZS5jb250ZW50c1t0XT1hKSxhfSxub2RlX29wczp7Z2V0YXR0cjpmdW5jdGlvbihlKXtyZXR1cm57ZGV2OjEsaW5vOnZvaWQgMCxtb2RlOmUubW9kZSxubGluazoxLHVpZDowLGdpZDowLHJkZXY6dm9pZCAwLHNpemU6ZS5zaXplLGF0aW1lOm5ldyBEYXRlKGUudGltZXN0YW1wKSxtdGltZTpuZXcgRGF0ZShlLnRpbWVzdGFtcCksY3RpbWU6bmV3IERhdGUoZS50aW1lc3RhbXApLGJsa3NpemU6NDA5NixibG9ja3M6TWF0aC5jZWlsKGUuc2l6ZS80MDk2KX19LHNldGF0dHI6ZnVuY3Rpb24oZSx0KXt2b2lkIDAhPT10Lm1vZGUmJihlLm1vZGU9dC5tb2RlKSx2b2lkIDAhPT10LnRpbWVzdGFtcCYmKGUudGltZXN0YW1wPXQudGltZXN0YW1wKX0sbG9va3VwOmZ1bmN0aW9uKGUsdCl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKX0sbWtub2Q6ZnVuY3Rpb24oZSx0LHIsbil7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pfSxyZW5hbWU6ZnVuY3Rpb24oZSx0LHIpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKX0sdW5saW5rOmZ1bmN0aW9uKGUsdCl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pfSxybWRpcjpmdW5jdGlvbihlLHQpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKX0scmVhZGRpcjpmdW5jdGlvbihlKXt2YXIgdD1bIi4iLCIuLiJdO2Zvcih2YXIgciBpbiBlLmNvbnRlbnRzKWUuY29udGVudHMuaGFzT3duUHJvcGVydHkocikmJnQucHVzaChyKTtyZXR1cm4gdH0sc3ltbGluazpmdW5jdGlvbihlLHQscil7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pfSxyZWFkbGluazpmdW5jdGlvbihlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSl9fSxzdHJlYW1fb3BzOntyZWFkOmZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYobz49ZS5ub2RlLnNpemUpcmV0dXJuIDA7dmFyIGk9ZS5ub2RlLmNvbnRlbnRzLnNsaWNlKG8sbytuKSxhPUFlLnJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihpKTtyZXR1cm4gdC5zZXQobmV3IFVpbnQ4QXJyYXkoYSksciksaS5zaXplfSx3cml0ZTpmdW5jdGlvbihlLHQscixuLG8pe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTyl9LGxsc2VlazpmdW5jdGlvbihlLHQscil7dmFyIG49dDtpZigxPT09cj9uKz1lLnBvc2l0aW9uOjI9PT1yJiZUZS5pc0ZpbGUoZS5ub2RlLm1vZGUpJiYobis9ZS5ub2RlLnNpemUpLG48MCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO3JldHVybiBufX19O0wrPTE2LEwrPTE2O3ZhciBUZT17cm9vdDpudWxsLG1vdW50czpbXSxkZXZpY2VzOnt9LHN0cmVhbXM6W10sbmV4dElub2RlOjEsbmFtZVRhYmxlOm51bGwsY3VycmVudFBhdGg6Ii8iLGluaXRpYWxpemVkOiExLGlnbm9yZVBlcm1pc3Npb25zOiEwLHRyYWNraW5nRGVsZWdhdGU6e30sdHJhY2tpbmc6e29wZW5GbGFnczp7UkVBRDoxLFdSSVRFOjJ9fSxFcnJub0Vycm9yOm51bGwsZ2VuZXJpY0Vycm9yczp7fSxmaWxlc3lzdGVtczpudWxsLHN5bmNGU1JlcXVlc3RzOjAsaGFuZGxlRlNFcnJvcjpmdW5jdGlvbihlKXtpZighKGUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yKSl0aHJvdyBlKyIgOiAiK1AoKTtyZXR1cm4geWUoZS5lcnJubyl9LGxvb2t1cFBhdGg6ZnVuY3Rpb24oZSx0KXtpZih0PXR8fHt9LCEoZT1nZS5yZXNvbHZlKFRlLmN3ZCgpLGUpKSlyZXR1cm57cGF0aDoiIixub2RlOm51bGx9O3ZhciByPXtmb2xsb3dfbW91bnQ6ITAscmVjdXJzZV9jb3VudDowfTtmb3IodmFyIG4gaW4gcil2b2lkIDA9PT10W25dJiYodFtuXT1yW25dKTtpZih0LnJlY3Vyc2VfY291bnQ+OCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTE9PUCk7Zm9yKHZhciBvPWdlLm5vcm1hbGl6ZUFycmF5KGUuc3BsaXQoIi8iKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhMSksaT1UZS5yb290LGE9Ii8iLHM9MDtzPG8ubGVuZ3RoO3MrKyl7dmFyIHU9cz09PW8ubGVuZ3RoLTE7aWYodSYmdC5wYXJlbnQpYnJlYWs7aWYoaT1UZS5sb29rdXBOb2RlKGksb1tzXSksYT1nZS5qb2luMihhLG9bc10pLFRlLmlzTW91bnRwb2ludChpKSYmKCF1fHx1JiZ0LmZvbGxvd19tb3VudCkmJihpPWkubW91bnRlZC5yb290KSwhdXx8dC5mb2xsb3cpZm9yKHZhciBjPTA7VGUuaXNMaW5rKGkubW9kZSk7KXt2YXIgbD1UZS5yZWFkbGluayhhKTtpZihhPWdlLnJlc29sdmUoZ2UuZGlybmFtZShhKSxsKSxpPVRlLmxvb2t1cFBhdGgoYSx7cmVjdXJzZV9jb3VudDp0LnJlY3Vyc2VfY291bnR9KS5ub2RlLGMrKz40MCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTE9PUCl9fXJldHVybntwYXRoOmEsbm9kZTppfX0sZ2V0UGF0aDpmdW5jdGlvbihlKXtmb3IodmFyIHQ7Oyl7aWYoVGUuaXNSb290KGUpKXt2YXIgcj1lLm1vdW50Lm1vdW50cG9pbnQ7cmV0dXJuIHQ/Ii8iIT09cltyLmxlbmd0aC0xXT9yKyIvIit0OnIrdDpyfXQ9dD9lLm5hbWUrIi8iK3Q6ZS5uYW1lLGU9ZS5wYXJlbnR9fSxoYXNoTmFtZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj0wLG49MDtuPHQubGVuZ3RoO24rKylyPShyPDw1KS1yK3QuY2hhckNvZGVBdChuKXwwO3JldHVybihlK3I+Pj4wKSVUZS5uYW1lVGFibGUubGVuZ3RofSxoYXNoQWRkTm9kZTpmdW5jdGlvbihlKXt2YXIgdD1UZS5oYXNoTmFtZShlLnBhcmVudC5pZCxlLm5hbWUpO2UubmFtZV9uZXh0PVRlLm5hbWVUYWJsZVt0XSxUZS5uYW1lVGFibGVbdF09ZX0saGFzaFJlbW92ZU5vZGU6ZnVuY3Rpb24oZSl7dmFyIHQ9VGUuaGFzaE5hbWUoZS5wYXJlbnQuaWQsZS5uYW1lKTtpZihUZS5uYW1lVGFibGVbdF09PT1lKVRlLm5hbWVUYWJsZVt0XT1lLm5hbWVfbmV4dDtlbHNlIGZvcih2YXIgcj1UZS5uYW1lVGFibGVbdF07cjspe2lmKHIubmFtZV9uZXh0PT09ZSl7ci5uYW1lX25leHQ9ZS5uYW1lX25leHQ7YnJlYWt9cj1yLm5hbWVfbmV4dH19LGxvb2t1cE5vZGU6ZnVuY3Rpb24oZSx0KXt2YXIgcj1UZS5tYXlMb29rdXAoZSk7aWYocil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihyLGUpO2Zvcih2YXIgbj1UZS5oYXNoTmFtZShlLmlkLHQpLG89VGUubmFtZVRhYmxlW25dO287bz1vLm5hbWVfbmV4dCl7dmFyIGk9by5uYW1lO2lmKG8ucGFyZW50LmlkPT09ZS5pZCYmaT09PXQpcmV0dXJuIG99cmV0dXJuIFRlLmxvb2t1cChlLHQpfSxjcmVhdGVOb2RlOmZ1bmN0aW9uKGUsdCxyLG4pe2lmKCFUZS5GU05vZGUpe1RlLkZTTm9kZT1mdW5jdGlvbihlLHQscixuKXtlfHwoZT10aGlzKSx0aGlzLnBhcmVudD1lLHRoaXMubW91bnQ9ZS5tb3VudCx0aGlzLm1vdW50ZWQ9bnVsbCx0aGlzLmlkPVRlLm5leHRJbm9kZSsrLHRoaXMubmFtZT10LHRoaXMubW9kZT1yLHRoaXMubm9kZV9vcHM9e30sdGhpcy5zdHJlYW1fb3BzPXt9LHRoaXMucmRldj1ufSxUZS5GU05vZGUucHJvdG90eXBlPXt9O09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFRlLkZTTm9kZS5wcm90b3R5cGUse3JlYWQ6e2dldDpmdW5jdGlvbigpe3JldHVybiAzNjU9PSgzNjUmdGhpcy5tb2RlKX0sc2V0OmZ1bmN0aW9uKGUpe2U/dGhpcy5tb2RlfD0zNjU6dGhpcy5tb2RlJj0tMzY2fX0sd3JpdGU6e2dldDpmdW5jdGlvbigpe3JldHVybiAxNDY9PSgxNDYmdGhpcy5tb2RlKX0sc2V0OmZ1bmN0aW9uKGUpe2U/dGhpcy5tb2RlfD0xNDY6dGhpcy5tb2RlJj0tMTQ3fX0saXNGb2xkZXI6e2dldDpmdW5jdGlvbigpe3JldHVybiBUZS5pc0Rpcih0aGlzLm1vZGUpfX0saXNEZXZpY2U6e2dldDpmdW5jdGlvbigpe3JldHVybiBUZS5pc0NocmRldih0aGlzLm1vZGUpfX19KX12YXIgbz1uZXcgVGUuRlNOb2RlKGUsdCxyLG4pO3JldHVybiBUZS5oYXNoQWRkTm9kZShvKSxvfSxkZXN0cm95Tm9kZTpmdW5jdGlvbihlKXtUZS5oYXNoUmVtb3ZlTm9kZShlKX0saXNSb290OmZ1bmN0aW9uKGUpe3JldHVybiBlPT09ZS5wYXJlbnR9LGlzTW91bnRwb2ludDpmdW5jdGlvbihlKXtyZXR1cm4hIWUubW91bnRlZH0saXNGaWxlOmZ1bmN0aW9uKGUpe3JldHVybiAzMjc2OD09KDYxNDQwJmUpfSxpc0RpcjpmdW5jdGlvbihlKXtyZXR1cm4gMTYzODQ9PSg2MTQ0MCZlKX0saXNMaW5rOmZ1bmN0aW9uKGUpe3JldHVybiA0MDk2MD09KDYxNDQwJmUpfSxpc0NocmRldjpmdW5jdGlvbihlKXtyZXR1cm4gODE5Mj09KDYxNDQwJmUpfSxpc0Jsa2RldjpmdW5jdGlvbihlKXtyZXR1cm4gMjQ1NzY9PSg2MTQ0MCZlKX0saXNGSUZPOmZ1bmN0aW9uKGUpe3JldHVybiA0MDk2PT0oNjE0NDAmZSl9LGlzU29ja2V0OmZ1bmN0aW9uKGUpe3JldHVybiA0OTE1Mj09KDQ5MTUyJmUpfSxmbGFnTW9kZXM6e3I6MCxyczoxMDUyNjcyLCJyKyI6Mix3OjU3Nyx3eDo3MDUseHc6NzA1LCJ3KyI6NTc4LCJ3eCsiOjcwNiwieHcrIjo3MDYsYToxMDg5LGF4OjEyMTcseGE6MTIxNywiYSsiOjEwOTAsImF4KyI6MTIxOCwieGErIjoxMjE4fSxtb2RlU3RyaW5nVG9GbGFnczpmdW5jdGlvbihlKXt2YXIgdD1UZS5mbGFnTW9kZXNbZV07aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gZmlsZSBvcGVuIG1vZGU6ICIrZSk7cmV0dXJuIHR9LGZsYWdzVG9QZXJtaXNzaW9uU3RyaW5nOmZ1bmN0aW9uKGUpe3ZhciB0PVsiciIsInciLCJydyJdWzMmZV07cmV0dXJuIDUxMiZlJiYodCs9InciKSx0fSxub2RlUGVybWlzc2lvbnM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gVGUuaWdub3JlUGVybWlzc2lvbnN8fCgtMT09PXQuaW5kZXhPZigiciIpfHwyOTImZS5tb2RlKSYmKC0xPT09dC5pbmRleE9mKCJ3Iil8fDE0NiZlLm1vZGUpJiYoLTE9PT10LmluZGV4T2YoIngiKXx8NzMmZS5tb2RlKT8wOm1lLkVBQ0NFU30sbWF5TG9va3VwOmZ1bmN0aW9uKGUpe3ZhciB0PVRlLm5vZGVQZXJtaXNzaW9ucyhlLCJ4Iik7cmV0dXJuIHR8fChlLm5vZGVfb3BzLmxvb2t1cD8wOm1lLkVBQ0NFUyl9LG1heUNyZWF0ZTpmdW5jdGlvbihlLHQpe3RyeXtUZS5sb29rdXBOb2RlKGUsdCk7cmV0dXJuIG1lLkVFWElTVH1jYXRjaChlKXt9cmV0dXJuIFRlLm5vZGVQZXJtaXNzaW9ucyhlLCJ3eCIpfSxtYXlEZWxldGU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuO3RyeXtuPVRlLmxvb2t1cE5vZGUoZSx0KX1jYXRjaChlKXtyZXR1cm4gZS5lcnJub312YXIgbz1UZS5ub2RlUGVybWlzc2lvbnMoZSwid3giKTtpZihvKXJldHVybiBvO2lmKHIpe2lmKCFUZS5pc0RpcihuLm1vZGUpKXJldHVybiBtZS5FTk9URElSO2lmKFRlLmlzUm9vdChuKXx8VGUuZ2V0UGF0aChuKT09PVRlLmN3ZCgpKXJldHVybiBtZS5FQlVTWX1lbHNlIGlmKFRlLmlzRGlyKG4ubW9kZSkpcmV0dXJuIG1lLkVJU0RJUjtyZXR1cm4gMH0sbWF5T3BlbjpmdW5jdGlvbihlLHQpe3JldHVybiBlP1RlLmlzTGluayhlLm1vZGUpP21lLkVMT09QOlRlLmlzRGlyKGUubW9kZSkmJigiciIhPT1UZS5mbGFnc1RvUGVybWlzc2lvblN0cmluZyh0KXx8NTEyJnQpP21lLkVJU0RJUjpUZS5ub2RlUGVybWlzc2lvbnMoZSxUZS5mbGFnc1RvUGVybWlzc2lvblN0cmluZyh0KSk6bWUuRU5PRU5UfSxNQVhfT1BFTl9GRFM6NDA5NixuZXh0ZmQ6ZnVuY3Rpb24oZSx0KXtlPWV8fDAsdD10fHxUZS5NQVhfT1BFTl9GRFM7Zm9yKHZhciByPWU7cjw9dDtyKyspaWYoIVRlLnN0cmVhbXNbcl0pcmV0dXJuIHI7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU1GSUxFKX0sZ2V0U3RyZWFtOmZ1bmN0aW9uKGUpe3JldHVybiBUZS5zdHJlYW1zW2VdfSxjcmVhdGVTdHJlYW06ZnVuY3Rpb24oZSx0LHIpe1RlLkZTU3RyZWFtfHwoVGUuRlNTdHJlYW09ZnVuY3Rpb24oKXt9LFRlLkZTU3RyZWFtLnByb3RvdHlwZT17fSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhUZS5GU1N0cmVhbS5wcm90b3R5cGUse29iamVjdDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMubm9kZT1lfX0saXNSZWFkOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMSE9KDIwOTcxNTUmdGhpcy5mbGFncyl9fSxpc1dyaXRlOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMCE9KDIwOTcxNTUmdGhpcy5mbGFncyl9fSxpc0FwcGVuZDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDEwMjQmdGhpcy5mbGFnc319fSkpO3ZhciBuPW5ldyBUZS5GU1N0cmVhbTtmb3IodmFyIG8gaW4gZSluW29dPWVbb107ZT1uO3ZhciBpPVRlLm5leHRmZCh0LHIpO3JldHVybiBlLmZkPWksVGUuc3RyZWFtc1tpXT1lLGV9LGNsb3NlU3RyZWFtOmZ1bmN0aW9uKGUpe1RlLnN0cmVhbXNbZV09bnVsbH0sY2hyZGV2X3N0cmVhbV9vcHM6e29wZW46ZnVuY3Rpb24oZSl7dmFyIHQ9VGUuZ2V0RGV2aWNlKGUubm9kZS5yZGV2KTtlLnN0cmVhbV9vcHM9dC5zdHJlYW1fb3BzLGUuc3RyZWFtX29wcy5vcGVuJiZlLnN0cmVhbV9vcHMub3BlbihlKX0sbGxzZWVrOmZ1bmN0aW9uKCl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVNQSVBFKX19LG1ham9yOmZ1bmN0aW9uKGUpe3JldHVybiBlPj44fSxtaW5vcjpmdW5jdGlvbihlKXtyZXR1cm4gMjU1JmV9LG1ha2VkZXY6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZTw8OHx0fSxyZWdpc3RlckRldmljZTpmdW5jdGlvbihlLHQpe1RlLmRldmljZXNbZV09e3N0cmVhbV9vcHM6dH19LGdldERldmljZTpmdW5jdGlvbihlKXtyZXR1cm4gVGUuZGV2aWNlc1tlXX0sZ2V0TW91bnRzOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxyPVtlXTtyLmxlbmd0aDspe3ZhciBuPXIucG9wKCk7dC5wdXNoKG4pLHIucHVzaC5hcHBseShyLG4ubW91bnRzKX1yZXR1cm4gdH0sc3luY2ZzOmZ1bmN0aW9uKGUsdCl7ImZ1bmN0aW9uIj09dHlwZW9mIGUmJih0PWUsZT0hMSksVGUuc3luY0ZTUmVxdWVzdHMrKyxUZS5zeW5jRlNSZXF1ZXN0cz4xJiZjb25zb2xlLmxvZygid2FybmluZzogIitUZS5zeW5jRlNSZXF1ZXN0cysiIEZTLnN5bmNmcyBvcGVyYXRpb25zIGluIGZsaWdodCBhdCBvbmNlLCBwcm9iYWJseSBqdXN0IGRvaW5nIGV4dHJhIHdvcmsiKTt2YXIgcj1UZS5nZXRNb3VudHMoVGUucm9vdC5tb3VudCksbj0wO2Z1bmN0aW9uIG8oZSl7cmV0dXJuIHkoVGUuc3luY0ZTUmVxdWVzdHM+MCksVGUuc3luY0ZTUmVxdWVzdHMtLSx0KGUpfWZ1bmN0aW9uIGkoZSl7aWYoZSlyZXR1cm4gaS5lcnJvcmVkP3ZvaWQgMDooaS5lcnJvcmVkPSEwLG8oZSkpOysrbj49ci5sZW5ndGgmJm8obnVsbCl9ci5mb3JFYWNoKChmdW5jdGlvbih0KXtpZighdC50eXBlLnN5bmNmcylyZXR1cm4gaShudWxsKTt0LnR5cGUuc3luY2ZzKHQsZSxpKX0pKX0sbW91bnQ6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG89Ii8iPT09cixpPSFyO2lmKG8mJlRlLnJvb3QpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJVU1kpO2lmKCFvJiYhaSl7dmFyIGE9VGUubG9va3VwUGF0aChyLHtmb2xsb3dfbW91bnQ6ITF9KTtpZihyPWEucGF0aCxuPWEubm9kZSxUZS5pc01vdW50cG9pbnQobikpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJVU1kpO2lmKCFUZS5pc0RpcihuLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RESVIpfXZhciBzPXt0eXBlOmUsb3B0czp0LG1vdW50cG9pbnQ6cixtb3VudHM6W119LHU9ZS5tb3VudChzKTtyZXR1cm4gdS5tb3VudD1zLHMucm9vdD11LG8/VGUucm9vdD11Om4mJihuLm1vdW50ZWQ9cyxuLm1vdW50JiZuLm1vdW50Lm1vdW50cy5wdXNoKHMpKSx1fSx1bm1vdW50OmZ1bmN0aW9uKGUpe3ZhciB0PVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93X21vdW50OiExfSk7aWYoIVRlLmlzTW91bnRwb2ludCh0Lm5vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIHI9dC5ub2RlLG49ci5tb3VudGVkLG89VGUuZ2V0TW91bnRzKG4pO09iamVjdC5rZXlzKFRlLm5hbWVUYWJsZSkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVRlLm5hbWVUYWJsZVtlXTt0Oyl7dmFyIHI9dC5uYW1lX25leHQ7LTEhPT1vLmluZGV4T2YodC5tb3VudCkmJlRlLmRlc3Ryb3lOb2RlKHQpLHQ9cn19KSksci5tb3VudGVkPW51bGw7dmFyIGk9ci5tb3VudC5tb3VudHMuaW5kZXhPZihuKTt5KC0xIT09aSksci5tb3VudC5tb3VudHMuc3BsaWNlKGksMSl9LGxvb2t1cDpmdW5jdGlvbihlLHQpe3JldHVybiBlLm5vZGVfb3BzLmxvb2t1cChlLHQpfSxta25vZDpmdW5jdGlvbihlLHQscil7dmFyIG49VGUubG9va3VwUGF0aChlLHtwYXJlbnQ6ITB9KS5ub2RlLG89Z2UuYmFzZW5hbWUoZSk7aWYoIW98fCIuIj09PW98fCIuLiI9PT1vKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIGk9VGUubWF5Q3JlYXRlKG4sbyk7aWYoaSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihpKTtpZighbi5ub2RlX29wcy5ta25vZCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7cmV0dXJuIG4ubm9kZV9vcHMubWtub2QobixvLHQscil9LGNyZWF0ZTpmdW5jdGlvbihlLHQpe3JldHVybiB0PXZvaWQgMCE9PXQ/dDo0MzgsdCY9NDA5NSx0fD0zMjc2OCxUZS5ta25vZChlLHQsMCl9LG1rZGlyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ9dm9pZCAwIT09dD90OjUxMSx0Jj0xMDIzLHR8PTE2Mzg0LFRlLm1rbm9kKGUsdCwwKX0sbWtkaXJUcmVlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPWUuc3BsaXQoIi8iKSxuPSIiLG89MDtvPHIubGVuZ3RoOysrbylpZihyW29dKXtuKz0iLyIrcltvXTt0cnl7VGUubWtkaXIobix0KX1jYXRjaChlKXtpZihlLmVycm5vIT1tZS5FRVhJU1QpdGhyb3cgZX19fSxta2RldjpmdW5jdGlvbihlLHQscil7cmV0dXJuIHZvaWQgMD09PXImJihyPXQsdD00MzgpLHR8PTgxOTIsVGUubWtub2QoZSx0LHIpfSxzeW1saW5rOmZ1bmN0aW9uKGUsdCl7aWYoIWdlLnJlc29sdmUoZSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTt2YXIgcj1UZS5sb29rdXBQYXRoKHQse3BhcmVudDohMH0pLm5vZGU7aWYoIXIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTt2YXIgbj1nZS5iYXNlbmFtZSh0KSxvPVRlLm1heUNyZWF0ZShyLG4pO2lmKG8pdGhyb3cgbmV3IFRlLkVycm5vRXJyb3Iobyk7aWYoIXIubm9kZV9vcHMuc3ltbGluayl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7cmV0dXJuIHIubm9kZV9vcHMuc3ltbGluayhyLG4sZSl9LHJlbmFtZTpmdW5jdGlvbihlLHQpe3ZhciByLG4sbz1nZS5kaXJuYW1lKGUpLGk9Z2UuZGlybmFtZSh0KSxhPWdlLmJhc2VuYW1lKGUpLHM9Z2UuYmFzZW5hbWUodCk7dHJ5e3I9VGUubG9va3VwUGF0aChlLHtwYXJlbnQ6ITB9KS5ub2RlLG49VGUubG9va3VwUGF0aCh0LHtwYXJlbnQ6ITB9KS5ub2RlfWNhdGNoKGUpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCVVNZKX1pZighcnx8IW4pdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTtpZihyLm1vdW50IT09bi5tb3VudCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FWERFVik7dmFyIHUsYz1UZS5sb29rdXBOb2RlKHIsYSksbD1nZS5yZWxhdGl2ZShlLGkpO2lmKCIuIiE9PWwuY2hhckF0KDApKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7aWYoIi4iIT09KGw9Z2UucmVsYXRpdmUodCxvKSkuY2hhckF0KDApKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RFTVBUWSk7dHJ5e3U9VGUubG9va3VwTm9kZShuLHMpfWNhdGNoKGUpe31pZihjIT09dSl7dmFyIGY9VGUuaXNEaXIoYy5tb2RlKSxkPVRlLm1heURlbGV0ZShyLGEsZik7aWYoZCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihkKTtpZihkPXU/VGUubWF5RGVsZXRlKG4scyxmKTpUZS5tYXlDcmVhdGUobixzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihkKTtpZighci5ub2RlX29wcy5yZW5hbWUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pO2lmKFRlLmlzTW91bnRwb2ludChjKXx8dSYmVGUuaXNNb3VudHBvaW50KHUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCVVNZKTtpZihuIT09ciYmKGQ9VGUubm9kZVBlcm1pc3Npb25zKHIsInciKSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IoZCk7dHJ5e1RlLnRyYWNraW5nRGVsZWdhdGUud2lsbE1vdmVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLndpbGxNb3ZlUGF0aChlLHQpfWNhdGNoKHIpe2NvbnNvbGUubG9nKCJGUy50cmFja2luZ0RlbGVnYXRlWyd3aWxsTW92ZVBhdGgnXSgnIitlKyInLCAnIit0KyInKSB0aHJldyBhbiBleGNlcHRpb246ICIrci5tZXNzYWdlKX1UZS5oYXNoUmVtb3ZlTm9kZShjKTt0cnl7ci5ub2RlX29wcy5yZW5hbWUoYyxuLHMpfWNhdGNoKGUpe3Rocm93IGV9ZmluYWxseXtUZS5oYXNoQWRkTm9kZShjKX10cnl7VGUudHJhY2tpbmdEZWxlZ2F0ZS5vbk1vdmVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLm9uTW92ZVBhdGgoZSx0KX1jYXRjaChyKXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnb25Nb3ZlUGF0aCddKCciK2UrIicsICciK3QrIicpIHRocmV3IGFuIGV4Y2VwdGlvbjogIityLm1lc3NhZ2UpfX19LHJtZGlyOmZ1bmN0aW9uKGUpe3ZhciB0PVRlLmxvb2t1cFBhdGgoZSx7cGFyZW50OiEwfSkubm9kZSxyPWdlLmJhc2VuYW1lKGUpLG49VGUubG9va3VwTm9kZSh0LHIpLG89VGUubWF5RGVsZXRlKHQsciwhMCk7aWYobyl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihvKTtpZighdC5ub2RlX29wcy5ybWRpcil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7aWYoVGUuaXNNb3VudHBvaW50KG4pKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCVVNZKTt0cnl7VGUudHJhY2tpbmdEZWxlZ2F0ZS53aWxsRGVsZXRlUGF0aCYmVGUudHJhY2tpbmdEZWxlZ2F0ZS53aWxsRGVsZXRlUGF0aChlKX1jYXRjaCh0KXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnd2lsbERlbGV0ZVBhdGgnXSgnIitlKyInKSB0aHJldyBhbiBleGNlcHRpb246ICIrdC5tZXNzYWdlKX10Lm5vZGVfb3BzLnJtZGlyKHQsciksVGUuZGVzdHJveU5vZGUobik7dHJ5e1RlLnRyYWNraW5nRGVsZWdhdGUub25EZWxldGVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLm9uRGVsZXRlUGF0aChlKX1jYXRjaCh0KXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnb25EZWxldGVQYXRoJ10oJyIrZSsiJykgdGhyZXcgYW4gZXhjZXB0aW9uOiAiK3QubWVzc2FnZSl9fSxyZWFkZGlyOmZ1bmN0aW9uKGUpe3ZhciB0PVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiEwfSkubm9kZTtpZighdC5ub2RlX29wcy5yZWFkZGlyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RESVIpO3JldHVybiB0Lm5vZGVfb3BzLnJlYWRkaXIodCl9LHVubGluazpmdW5jdGlvbihlKXt2YXIgdD1UZS5sb29rdXBQYXRoKGUse3BhcmVudDohMH0pLm5vZGUscj1nZS5iYXNlbmFtZShlKSxuPVRlLmxvb2t1cE5vZGUodCxyKSxvPVRlLm1heURlbGV0ZSh0LHIsITEpO2lmKG8pdGhyb3cgbmV3IFRlLkVycm5vRXJyb3Iobyk7aWYoIXQubm9kZV9vcHMudW5saW5rKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKTtpZihUZS5pc01vdW50cG9pbnQobikpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJVU1kpO3RyeXtUZS50cmFja2luZ0RlbGVnYXRlLndpbGxEZWxldGVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLndpbGxEZWxldGVQYXRoKGUpfWNhdGNoKHQpe2NvbnNvbGUubG9nKCJGUy50cmFja2luZ0RlbGVnYXRlWyd3aWxsRGVsZXRlUGF0aCddKCciK2UrIicpIHRocmV3IGFuIGV4Y2VwdGlvbjogIit0Lm1lc3NhZ2UpfXQubm9kZV9vcHMudW5saW5rKHQsciksVGUuZGVzdHJveU5vZGUobik7dHJ5e1RlLnRyYWNraW5nRGVsZWdhdGUub25EZWxldGVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLm9uRGVsZXRlUGF0aChlKX1jYXRjaCh0KXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnb25EZWxldGVQYXRoJ10oJyIrZSsiJykgdGhyZXcgYW4gZXhjZXB0aW9uOiAiK3QubWVzc2FnZSl9fSxyZWFkbGluazpmdW5jdGlvbihlKXt2YXIgdD1UZS5sb29rdXBQYXRoKGUpLm5vZGU7aWYoIXQpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTtpZighdC5ub2RlX29wcy5yZWFkbGluayl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO3JldHVybiBnZS5yZXNvbHZlKFRlLmdldFBhdGgodC5wYXJlbnQpLHQubm9kZV9vcHMucmVhZGxpbmsodCkpfSxzdGF0OmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6IXR9KS5ub2RlO2lmKCFyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT0VOVCk7aWYoIXIubm9kZV9vcHMuZ2V0YXR0cil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7cmV0dXJuIHIubm9kZV9vcHMuZ2V0YXR0cihyKX0sbHN0YXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFRlLnN0YXQoZSwhMCl9LGNobW9kOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbjsic3RyaW5nIj09dHlwZW9mIGU/bj1UZS5sb29rdXBQYXRoKGUse2ZvbGxvdzohcn0pLm5vZGU6bj1lO2lmKCFuLm5vZGVfb3BzLnNldGF0dHIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pO24ubm9kZV9vcHMuc2V0YXR0cihuLHttb2RlOjQwOTUmdHwtNDA5NiZuLm1vZGUsdGltZXN0YW1wOkRhdGUubm93KCl9KX0sbGNobW9kOmZ1bmN0aW9uKGUsdCl7VGUuY2htb2QoZSx0LCEwKX0sZmNobW9kOmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUuZ2V0U3RyZWFtKGUpO2lmKCFyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtUZS5jaG1vZChyLm5vZGUsdCl9LGNob3duOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvOyJzdHJpbmciPT10eXBlb2YgZT9vPVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiFufSkubm9kZTpvPWU7aWYoIW8ubm9kZV9vcHMuc2V0YXR0cil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7by5ub2RlX29wcy5zZXRhdHRyKG8se3RpbWVzdGFtcDpEYXRlLm5vdygpfSl9LGxjaG93bjpmdW5jdGlvbihlLHQscil7VGUuY2hvd24oZSx0LHIsITApfSxmY2hvd246ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPVRlLmdldFN0cmVhbShlKTtpZighbil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7VGUuY2hvd24obi5ub2RlLHQscil9LHRydW5jYXRlOmZ1bmN0aW9uKGUsdCl7aWYodDwwKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIHI7InN0cmluZyI9PXR5cGVvZiBlP3I9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6ITB9KS5ub2RlOnI9ZTtpZighci5ub2RlX29wcy5zZXRhdHRyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKTtpZihUZS5pc0RpcihyLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJU0RJUik7aWYoIVRlLmlzRmlsZShyLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIG49VGUubm9kZVBlcm1pc3Npb25zKHIsInciKTtpZihuKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG4pO3Iubm9kZV9vcHMuc2V0YXR0cihyLHtzaXplOnQsdGltZXN0YW1wOkRhdGUubm93KCl9KX0sZnRydW5jYXRlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUuZ2V0U3RyZWFtKGUpO2lmKCFyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZigwPT0oMjA5NzE1NSZyLmZsYWdzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO1RlLnRydW5jYXRlKHIubm9kZSx0KX0sdXRpbWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiEwfSkubm9kZTtuLm5vZGVfb3BzLnNldGF0dHIobix7dGltZXN0YW1wOk1hdGgubWF4KHQscil9KX0sb3BlbjpmdW5jdGlvbihlLHQscixuLGkpe2lmKCIiPT09ZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9FTlQpO3ZhciBhO2lmKHI9dm9pZCAwPT09cj80Mzg6cixyPTY0Jih0PSJzdHJpbmciPT10eXBlb2YgdD9UZS5tb2RlU3RyaW5nVG9GbGFncyh0KTp0KT80MDk1JnJ8MzI3Njg6MCwib2JqZWN0Ij09dHlwZW9mIGUpYT1lO2Vsc2V7ZT1nZS5ub3JtYWxpemUoZSk7dHJ5e2E9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6ISgxMzEwNzImdCl9KS5ub2RlfWNhdGNoKGUpe319dmFyIHM9ITE7aWYoNjQmdClpZihhKXtpZigxMjgmdCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FRVhJU1QpfWVsc2UgYT1UZS5ta25vZChlLHIsMCkscz0hMDtpZighYSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9FTlQpO2lmKFRlLmlzQ2hyZGV2KGEubW9kZSkmJih0Jj0tNTEzKSw2NTUzNiZ0JiYhVGUuaXNEaXIoYS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9URElSKTtpZighcyl7dmFyIHU9VGUubWF5T3BlbihhLHQpO2lmKHUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IodSl9NTEyJnQmJlRlLnRydW5jYXRlKGEsMCksdCY9LTY0MTt2YXIgYz1UZS5jcmVhdGVTdHJlYW0oe25vZGU6YSxwYXRoOlRlLmdldFBhdGgoYSksZmxhZ3M6dCxzZWVrYWJsZTohMCxwb3NpdGlvbjowLHN0cmVhbV9vcHM6YS5zdHJlYW1fb3BzLHVuZ290dGVuOltdLGVycm9yOiExfSxuLGkpO2Muc3RyZWFtX29wcy5vcGVuJiZjLnN0cmVhbV9vcHMub3BlbihjKSwhby5sb2dSZWFkRmlsZXN8fDEmdHx8KFRlLnJlYWRGaWxlc3x8KFRlLnJlYWRGaWxlcz17fSksZSBpbiBUZS5yZWFkRmlsZXN8fChUZS5yZWFkRmlsZXNbZV09MSxvLnByaW50RXJyKCJyZWFkIGZpbGU6ICIrZSkpKTt0cnl7aWYoVGUudHJhY2tpbmdEZWxlZ2F0ZS5vbk9wZW5GaWxlKXt2YXIgbD0wOzEhPSgyMDk3MTU1JnQpJiYobHw9VGUudHJhY2tpbmcub3BlbkZsYWdzLlJFQUQpLDAhPSgyMDk3MTU1JnQpJiYobHw9VGUudHJhY2tpbmcub3BlbkZsYWdzLldSSVRFKSxUZS50cmFja2luZ0RlbGVnYXRlLm9uT3BlbkZpbGUoZSxsKX19Y2F0Y2godCl7Y29uc29sZS5sb2coIkZTLnRyYWNraW5nRGVsZWdhdGVbJ29uT3BlbkZpbGUnXSgnIitlKyInLCBmbGFncykgdGhyZXcgYW4gZXhjZXB0aW9uOiAiK3QubWVzc2FnZSl9cmV0dXJuIGN9LGNsb3NlOmZ1bmN0aW9uKGUpe2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtlLmdldGRlbnRzJiYoZS5nZXRkZW50cz1udWxsKTt0cnl7ZS5zdHJlYW1fb3BzLmNsb3NlJiZlLnN0cmVhbV9vcHMuY2xvc2UoZSl9Y2F0Y2goZSl7dGhyb3cgZX1maW5hbGx5e1RlLmNsb3NlU3RyZWFtKGUuZmQpfWUuZmQ9bnVsbH0saXNDbG9zZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PT1lLmZkfSxsbHNlZWs6ZnVuY3Rpb24oZSx0LHIpe2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZighZS5zZWVrYWJsZXx8IWUuc3RyZWFtX29wcy5sbHNlZWspdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVNQSVBFKTtyZXR1cm4gZS5wb3NpdGlvbj1lLnN0cmVhbV9vcHMubGxzZWVrKGUsdCxyKSxlLnVuZ290dGVuPVtdLGUucG9zaXRpb259LHJlYWQ6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZihuPDB8fG88MCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZigxPT0oMjA5NzE1NSZlLmZsYWdzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7aWYoVGUuaXNEaXIoZS5ub2RlLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJU0RJUik7aWYoIWUuc3RyZWFtX29wcy5yZWFkKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIGk9dm9pZCAwIT09bztpZihpKXtpZighZS5zZWVrYWJsZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FU1BJUEUpfWVsc2Ugbz1lLnBvc2l0aW9uO3ZhciBhPWUuc3RyZWFtX29wcy5yZWFkKGUsdCxyLG4sbyk7cmV0dXJuIGl8fChlLnBvc2l0aW9uKz1hKSxhfSx3cml0ZTpmdW5jdGlvbihlLHQscixuLG8saSl7aWYobjwwfHxvPDApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtpZihUZS5pc0Nsb3NlZChlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7aWYoMD09KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJBREYpO2lmKFRlLmlzRGlyKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSVNESVIpO2lmKCFlLnN0cmVhbV9vcHMud3JpdGUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTsxMDI0JmUuZmxhZ3MmJlRlLmxsc2VlayhlLDAsMik7dmFyIGE9dm9pZCAwIT09bztpZihhKXtpZighZS5zZWVrYWJsZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FU1BJUEUpfWVsc2Ugbz1lLnBvc2l0aW9uO3ZhciBzPWUuc3RyZWFtX29wcy53cml0ZShlLHQscixuLG8saSk7YXx8KGUucG9zaXRpb24rPXMpO3RyeXtlLnBhdGgmJlRlLnRyYWNraW5nRGVsZWdhdGUub25Xcml0ZVRvRmlsZSYmVGUudHJhY2tpbmdEZWxlZ2F0ZS5vbldyaXRlVG9GaWxlKGUucGF0aCl9Y2F0Y2goZSl7Y29uc29sZS5sb2coIkZTLnRyYWNraW5nRGVsZWdhdGVbJ29uV3JpdGVUb0ZpbGUnXSgnIitwYXRoKyInKSB0aHJldyBhbiBleGNlcHRpb246ICIrZS5tZXNzYWdlKX1yZXR1cm4gc30sYWxsb2NhdGU6ZnVuY3Rpb24oZSx0LHIpe2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZih0PDB8fHI8PTApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtpZigwPT0oMjA5NzE1NSZlLmZsYWdzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7aWYoIVRlLmlzRmlsZShlLm5vZGUubW9kZSkmJiFUZS5pc0RpcihlLm5vZGUubW9kZSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PREVWKTtpZighZS5zdHJlYW1fb3BzLmFsbG9jYXRlKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVPUE5PVFNVUFApO2Uuc3RyZWFtX29wcy5hbGxvY2F0ZShlLHQscil9LG1tYXA6ZnVuY3Rpb24oZSx0LHIsbixvLGksYSl7aWYoMT09KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUFDQ0VTKTtpZighZS5zdHJlYW1fb3BzLm1tYXApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PREVWKTtyZXR1cm4gZS5zdHJlYW1fb3BzLm1tYXAoZSx0LHIsbixvLGksYSl9LG1zeW5jOmZ1bmN0aW9uKGUsdCxyLG4sbyl7cmV0dXJuIGUmJmUuc3RyZWFtX29wcy5tc3luYz9lLnN0cmVhbV9vcHMubXN5bmMoZSx0LHIsbixvKTowfSxtdW5tYXA6ZnVuY3Rpb24oZSl7cmV0dXJuIDB9LGlvY3RsOmZ1bmN0aW9uKGUsdCxyKXtpZighZS5zdHJlYW1fb3BzLmlvY3RsKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RUWSk7cmV0dXJuIGUuc3RyZWFtX29wcy5pb2N0bChlLHQscil9LHJlYWRGaWxlOmZ1bmN0aW9uKGUsdCl7aWYoKHQ9dHx8e30pLmZsYWdzPXQuZmxhZ3N8fCJyIix0LmVuY29kaW5nPXQuZW5jb2Rpbmd8fCJiaW5hcnkiLCJ1dGY4IiE9PXQuZW5jb2RpbmcmJiJiaW5hcnkiIT09dC5lbmNvZGluZyl0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZW5jb2RpbmcgdHlwZSAiJyt0LmVuY29kaW5nKyciJyk7dmFyIHIsbj1UZS5vcGVuKGUsdC5mbGFncyksbz1UZS5zdGF0KGUpLnNpemUsaT1uZXcgVWludDhBcnJheShvKTtyZXR1cm4gVGUucmVhZChuLGksMCxvLDApLCJ1dGY4Ij09PXQuZW5jb2Rpbmc/cj1fKGksMCk6ImJpbmFyeSI9PT10LmVuY29kaW5nJiYocj1pKSxUZS5jbG9zZShuKSxyfSx3cml0ZUZpbGU6ZnVuY3Rpb24oZSx0LHIpeyhyPXJ8fHt9KS5mbGFncz1yLmZsYWdzfHwidyI7dmFyIG49VGUub3BlbihlLHIuZmxhZ3Msci5tb2RlKTtpZigic3RyaW5nIj09dHlwZW9mIHQpe3ZhciBvPW5ldyBVaW50OEFycmF5KFModCkrMSksaT1BKHQsbywwLG8ubGVuZ3RoKTtUZS53cml0ZShuLG8sMCxpLHZvaWQgMCxyLmNhbk93bil9ZWxzZXtpZighQXJyYXlCdWZmZXIuaXNWaWV3KHQpKXRocm93IG5ldyBFcnJvcigiVW5zdXBwb3J0ZWQgZGF0YSB0eXBlIik7VGUud3JpdGUobix0LDAsdC5ieXRlTGVuZ3RoLHZvaWQgMCxyLmNhbk93bil9VGUuY2xvc2Uobil9LGN3ZDpmdW5jdGlvbigpe3JldHVybiBUZS5jdXJyZW50UGF0aH0sY2hkaXI6ZnVuY3Rpb24oZSl7dmFyIHQ9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6ITB9KTtpZihudWxsPT09dC5ub2RlKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT0VOVCk7aWYoIVRlLmlzRGlyKHQubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9URElSKTt2YXIgcj1UZS5ub2RlUGVybWlzc2lvbnModC5ub2RlLCJ4Iik7aWYocil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihyKTtUZS5jdXJyZW50UGF0aD10LnBhdGh9LGNyZWF0ZURlZmF1bHREaXJlY3RvcmllczpmdW5jdGlvbigpe1RlLm1rZGlyKCIvdG1wIiksVGUubWtkaXIoIi9ob21lIiksVGUubWtkaXIoIi9ob21lL3dlYl91c2VyIil9LGNyZWF0ZURlZmF1bHREZXZpY2VzOmZ1bmN0aW9uKCl7dmFyIGU7aWYoVGUubWtkaXIoIi9kZXYiKSxUZS5yZWdpc3RlckRldmljZShUZS5tYWtlZGV2KDEsMykse3JlYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gMH0sd3JpdGU6ZnVuY3Rpb24oZSx0LHIsbixvKXtyZXR1cm4gbn19KSxUZS5ta2RldigiL2Rldi9udWxsIixUZS5tYWtlZGV2KDEsMykpLHZlLnJlZ2lzdGVyKFRlLm1ha2VkZXYoNSwwKSx2ZS5kZWZhdWx0X3R0eV9vcHMpLHZlLnJlZ2lzdGVyKFRlLm1ha2VkZXYoNiwwKSx2ZS5kZWZhdWx0X3R0eTFfb3BzKSxUZS5ta2RldigiL2Rldi90dHkiLFRlLm1ha2VkZXYoNSwwKSksVGUubWtkZXYoIi9kZXYvdHR5MSIsVGUubWFrZWRldig2LDApKSwidW5kZWZpbmVkIiE9dHlwZW9mIGNyeXB0byl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoMSk7ZT1mdW5jdGlvbigpe3JldHVybiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHQpLHRbMF19fWVsc2UgZT1sP2Z1bmN0aW9uKCl7cmV0dXJuIHJlcXVpcmUoImNyeXB0byIpLnJhbmRvbUJ5dGVzKDEpWzBdfTpmdW5jdGlvbigpe3JldHVybiAyNTYqTWF0aC5yYW5kb20oKXwwfTtUZS5jcmVhdGVEZXZpY2UoIi9kZXYiLCJyYW5kb20iLGUpLFRlLmNyZWF0ZURldmljZSgiL2RldiIsInVyYW5kb20iLGUpLFRlLm1rZGlyKCIvZGV2L3NobSIpLFRlLm1rZGlyKCIvZGV2L3NobS90bXAiKX0sY3JlYXRlU3BlY2lhbERpcmVjdG9yaWVzOmZ1bmN0aW9uKCl7VGUubWtkaXIoIi9wcm9jIiksVGUubWtkaXIoIi9wcm9jL3NlbGYiKSxUZS5ta2RpcigiL3Byb2Mvc2VsZi9mZCIpLFRlLm1vdW50KHttb3VudDpmdW5jdGlvbigpe3ZhciBlPVRlLmNyZWF0ZU5vZGUoIi9wcm9jL3NlbGYiLCJmZCIsMTY4OTUsNzMpO3JldHVybiBlLm5vZGVfb3BzPXtsb29rdXA6ZnVuY3Rpb24oZSx0KXt2YXIgcj0rdCxuPVRlLmdldFN0cmVhbShyKTtpZighbil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7dmFyIG89e3BhcmVudDpudWxsLG1vdW50Onttb3VudHBvaW50OiJmYWtlIn0sbm9kZV9vcHM6e3JlYWRsaW5rOmZ1bmN0aW9uKCl7cmV0dXJuIG4ucGF0aH19fTtyZXR1cm4gby5wYXJlbnQ9byxvfX0sZX19LHt9LCIvcHJvYy9zZWxmL2ZkIil9LGNyZWF0ZVN0YW5kYXJkU3RyZWFtczpmdW5jdGlvbigpe28uc3RkaW4/VGUuY3JlYXRlRGV2aWNlKCIvZGV2Iiwic3RkaW4iLG8uc3RkaW4pOlRlLnN5bWxpbmsoIi9kZXYvdHR5IiwiL2Rldi9zdGRpbiIpLG8uc3Rkb3V0P1RlLmNyZWF0ZURldmljZSgiL2RldiIsInN0ZG91dCIsbnVsbCxvLnN0ZG91dCk6VGUuc3ltbGluaygiL2Rldi90dHkiLCIvZGV2L3N0ZG91dCIpLG8uc3RkZXJyP1RlLmNyZWF0ZURldmljZSgiL2RldiIsInN0ZGVyciIsbnVsbCxvLnN0ZGVycik6VGUuc3ltbGluaygiL2Rldi90dHkxIiwiL2Rldi9zdGRlcnIiKTt2YXIgZT1UZS5vcGVuKCIvZGV2L3N0ZGluIiwiciIpO3koMD09PWUuZmQsImludmFsaWQgaGFuZGxlIGZvciBzdGRpbiAoIitlLmZkKyIpIik7dmFyIHQ9VGUub3BlbigiL2Rldi9zdGRvdXQiLCJ3Iik7eSgxPT09dC5mZCwiaW52YWxpZCBoYW5kbGUgZm9yIHN0ZG91dCAoIit0LmZkKyIpIik7dmFyIHI9VGUub3BlbigiL2Rldi9zdGRlcnIiLCJ3Iik7eSgyPT09ci5mZCwiaW52YWxpZCBoYW5kbGUgZm9yIHN0ZGVyciAoIityLmZkKyIpIil9LGVuc3VyZUVycm5vRXJyb3I6ZnVuY3Rpb24oKXtUZS5FcnJub0Vycm9yfHwoVGUuRXJybm9FcnJvcj1mdW5jdGlvbihlLHQpe3RoaXMubm9kZT10LHRoaXMuc2V0RXJybm89ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIHRoaXMuZXJybm89ZSxtZSlpZihtZVt0XT09PWUpe3RoaXMuY29kZT10O2JyZWFrfX0sdGhpcy5zZXRFcnJubyhlKSx0aGlzLm1lc3NhZ2U9RWVbZV0sdGhpcy5zdGFjayYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsInN0YWNrIix7dmFsdWU6KG5ldyBFcnJvcikuc3RhY2ssd3JpdGFibGU6ITB9KX0sVGUuRXJybm9FcnJvci5wcm90b3R5cGU9bmV3IEVycm9yLFRlLkVycm5vRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yPVRlLkVycm5vRXJyb3IsW21lLkVOT0VOVF0uZm9yRWFjaCgoZnVuY3Rpb24oZSl7VGUuZ2VuZXJpY0Vycm9yc1tlXT1uZXcgVGUuRXJybm9FcnJvcihlKSxUZS5nZW5lcmljRXJyb3JzW2VdLnN0YWNrPSI8Z2VuZXJpYyBlcnJvciwgbm8gc3RhY2s+In0pKSl9LHN0YXRpY0luaXQ6ZnVuY3Rpb24oKXtUZS5lbnN1cmVFcnJub0Vycm9yKCksVGUubmFtZVRhYmxlPW5ldyBBcnJheSg0MDk2KSxUZS5tb3VudCh3ZSx7fSwiLyIpLFRlLmNyZWF0ZURlZmF1bHREaXJlY3RvcmllcygpLFRlLmNyZWF0ZURlZmF1bHREZXZpY2VzKCksVGUuY3JlYXRlU3BlY2lhbERpcmVjdG9yaWVzKCksVGUuZmlsZXN5c3RlbXM9e01FTUZTOndlLElEQkZTOl9lLE5PREVGUzpiZSxXT1JLRVJGUzpBZX19LGluaXQ6ZnVuY3Rpb24oZSx0LHIpe3koIVRlLmluaXQuaW5pdGlhbGl6ZWQsIkZTLmluaXQgd2FzIHByZXZpb3VzbHkgY2FsbGVkLiBJZiB5b3Ugd2FudCB0byBpbml0aWFsaXplIGxhdGVyIHdpdGggY3VzdG9tIHBhcmFtZXRlcnMsIHJlbW92ZSBhbnkgZWFybGllciBjYWxscyAobm90ZSB0aGF0IG9uZSBpcyBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIHRoZSBnZW5lcmF0ZWQgY29kZSkiKSxUZS5pbml0LmluaXRpYWxpemVkPSEwLFRlLmVuc3VyZUVycm5vRXJyb3IoKSxvLnN0ZGluPWV8fG8uc3RkaW4sby5zdGRvdXQ9dHx8by5zdGRvdXQsby5zdGRlcnI9cnx8by5zdGRlcnIsVGUuY3JlYXRlU3RhbmRhcmRTdHJlYW1zKCl9LHF1aXQ6ZnVuY3Rpb24oKXtUZS5pbml0LmluaXRpYWxpemVkPSExO3ZhciBlPW8uX2ZmbHVzaDtlJiZlKDApO2Zvcih2YXIgdD0wO3Q8VGUuc3RyZWFtcy5sZW5ndGg7dCsrKXt2YXIgcj1UZS5zdHJlYW1zW3RdO3ImJlRlLmNsb3NlKHIpfX0sZ2V0TW9kZTpmdW5jdGlvbihlLHQpe3ZhciByPTA7cmV0dXJuIGUmJihyfD0zNjUpLHQmJihyfD0xNDYpLHJ9LGpvaW5QYXRoOmZ1bmN0aW9uKGUsdCl7dmFyIHI9Z2Uuam9pbi5hcHBseShudWxsLGUpO3JldHVybiB0JiYiLyI9PXJbMF0mJihyPXIuc3Vic3RyKDEpKSxyfSxhYnNvbHV0ZVBhdGg6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZ2UucmVzb2x2ZSh0LGUpfSxzdGFuZGFyZGl6ZVBhdGg6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlLm5vcm1hbGl6ZShlKX0sZmluZE9iamVjdDpmdW5jdGlvbihlLHQpe3ZhciByPVRlLmFuYWx5emVQYXRoKGUsdCk7cmV0dXJuIHIuZXhpc3RzP3Iub2JqZWN0Oih5ZShyLmVycm9yKSxudWxsKX0sYW5hbHl6ZVBhdGg6ZnVuY3Rpb24oZSx0KXt0cnl7ZT0obj1UZS5sb29rdXBQYXRoKGUse2ZvbGxvdzohdH0pKS5wYXRofWNhdGNoKGUpe312YXIgcj17aXNSb290OiExLGV4aXN0czohMSxlcnJvcjowLG5hbWU6bnVsbCxwYXRoOm51bGwsb2JqZWN0Om51bGwscGFyZW50RXhpc3RzOiExLHBhcmVudFBhdGg6bnVsbCxwYXJlbnRPYmplY3Q6bnVsbH07dHJ5e3ZhciBuPVRlLmxvb2t1cFBhdGgoZSx7cGFyZW50OiEwfSk7ci5wYXJlbnRFeGlzdHM9ITAsci5wYXJlbnRQYXRoPW4ucGF0aCxyLnBhcmVudE9iamVjdD1uLm5vZGUsci5uYW1lPWdlLmJhc2VuYW1lKGUpLG49VGUubG9va3VwUGF0aChlLHtmb2xsb3c6IXR9KSxyLmV4aXN0cz0hMCxyLnBhdGg9bi5wYXRoLHIub2JqZWN0PW4ubm9kZSxyLm5hbWU9bi5ub2RlLm5hbWUsci5pc1Jvb3Q9Ii8iPT09bi5wYXRofWNhdGNoKGUpe3IuZXJyb3I9ZS5lcnJub31yZXR1cm4gcn0sY3JlYXRlRm9sZGVyOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCksaT1UZS5nZXRNb2RlKHIsbik7cmV0dXJuIFRlLm1rZGlyKG8saSl9LGNyZWF0ZVBhdGg6ZnVuY3Rpb24oZSx0LHIsbil7ZT0ic3RyaW5nIj09dHlwZW9mIGU/ZTpUZS5nZXRQYXRoKGUpO2Zvcih2YXIgbz10LnNwbGl0KCIvIikucmV2ZXJzZSgpO28ubGVuZ3RoOyl7dmFyIGk9by5wb3AoKTtpZihpKXt2YXIgYT1nZS5qb2luMihlLGkpO3RyeXtUZS5ta2RpcihhKX1jYXRjaChlKXt9ZT1hfX1yZXR1cm4gYX0sY3JlYXRlRmlsZTpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCksYT1UZS5nZXRNb2RlKG4sbyk7cmV0dXJuIFRlLmNyZWF0ZShpLGEpfSxjcmVhdGVEYXRhRmlsZTpmdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGE9dD9nZS5qb2luMigic3RyaW5nIj09dHlwZW9mIGU/ZTpUZS5nZXRQYXRoKGUpLHQpOmUscz1UZS5nZXRNb2RlKG4sbyksdT1UZS5jcmVhdGUoYSxzKTtpZihyKXtpZigic3RyaW5nIj09dHlwZW9mIHIpe2Zvcih2YXIgYz1uZXcgQXJyYXkoci5sZW5ndGgpLGw9MCxmPXIubGVuZ3RoO2w8ZjsrK2wpY1tsXT1yLmNoYXJDb2RlQXQobCk7cj1jfVRlLmNobW9kKHUsMTQ2fHMpO3ZhciBkPVRlLm9wZW4odSwidyIpO1RlLndyaXRlKGQsciwwLHIubGVuZ3RoLDAsaSksVGUuY2xvc2UoZCksVGUuY2htb2QodSxzKX1yZXR1cm4gdX0sY3JlYXRlRGV2aWNlOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCksaT1UZS5nZXRNb2RlKCEhciwhIW4pO1RlLmNyZWF0ZURldmljZS5tYWpvcnx8KFRlLmNyZWF0ZURldmljZS5tYWpvcj02NCk7dmFyIGE9VGUubWFrZWRldihUZS5jcmVhdGVEZXZpY2UubWFqb3IrKywwKTtyZXR1cm4gVGUucmVnaXN0ZXJEZXZpY2UoYSx7b3BlbjpmdW5jdGlvbihlKXtlLnNlZWthYmxlPSExfSxjbG9zZTpmdW5jdGlvbihlKXtuJiZuLmJ1ZmZlciYmbi5idWZmZXIubGVuZ3RoJiZuKDEwKX0scmVhZDpmdW5jdGlvbihlLHQsbixvLGkpe2Zvcih2YXIgYT0wLHM9MDtzPG87cysrKXt2YXIgdTt0cnl7dT1yKCl9Y2F0Y2goZSl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlPKX1pZih2b2lkIDA9PT11JiYwPT09YSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQUdBSU4pO2lmKG51bGw9PXUpYnJlYWs7YSsrLHRbbitzXT11fXJldHVybiBhJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxhfSx3cml0ZTpmdW5jdGlvbihlLHQscixvLGkpe2Zvcih2YXIgYT0wO2E8bzthKyspdHJ5e24odFtyK2FdKX1jYXRjaChlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU8pfXJldHVybiBvJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxhfX0pLFRlLm1rZGV2KG8saSxhKX0sY3JlYXRlTGluazpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCk7cmV0dXJuIFRlLnN5bWxpbmsocixpKX0sZm9yY2VMb2FkRmlsZTpmdW5jdGlvbihlKXtpZihlLmlzRGV2aWNlfHxlLmlzRm9sZGVyfHxlLmxpbmt8fGUuY29udGVudHMpcmV0dXJuITA7dmFyIHQ9ITA7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBYTUxIdHRwUmVxdWVzdCl0aHJvdyBuZXcgRXJyb3IoIkxhenkgbG9hZGluZyBzaG91bGQgaGF2ZSBiZWVuIHBlcmZvcm1lZCAoY29udGVudHMgc2V0KSBpbiBjcmVhdGVMYXp5RmlsZSwgYnV0IGl0IHdhcyBub3QuIExhenkgbG9hZGluZyBvbmx5IHdvcmtzIGluIHdlYiB3b3JrZXJzLiBVc2UgLS1lbWJlZC1maWxlIG9yIC0tcHJlbG9hZC1maWxlIGluIGVtY2Mgb24gdGhlIG1haW4gdGhyZWFkLiIpO2lmKCFvLnJlYWQpdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgbG9hZCB3aXRob3V0IHJlYWQoKSBvciBYTUxIdHRwUmVxdWVzdC4iKTt0cnl7ZS5jb250ZW50cz0kdChvLnJlYWQoZS51cmwpLCEwKSxlLnVzZWRCeXRlcz1lLmNvbnRlbnRzLmxlbmd0aH1jYXRjaChlKXt0PSExfXJldHVybiB0fHx5ZShtZS5FSU8pLHR9LGNyZWF0ZUxhenlGaWxlOmZ1bmN0aW9uKGUsdCxyLG4sbyl7ZnVuY3Rpb24gaSgpe3RoaXMubGVuZ3RoS25vd249ITEsdGhpcy5jaHVua3M9W119aWYoaS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGUpe2lmKCEoZT50aGlzLmxlbmd0aC0xfHxlPDApKXt2YXIgdD1lJXRoaXMuY2h1bmtTaXplLHI9ZS90aGlzLmNodW5rU2l6ZXwwO3JldHVybiB0aGlzLmdldHRlcihyKVt0XX19LGkucHJvdG90eXBlLnNldERhdGFHZXR0ZXI9ZnVuY3Rpb24oZSl7dGhpcy5nZXR0ZXI9ZX0saS5wcm90b3R5cGUuY2FjaGVMZW5ndGg9ZnVuY3Rpb24oKXt2YXIgZT1uZXcgWE1MSHR0cFJlcXVlc3Q7aWYoZS5vcGVuKCJIRUFEIixyLCExKSxlLnNlbmQobnVsbCksIShlLnN0YXR1cz49MjAwJiZlLnN0YXR1czwzMDB8fDMwND09PWUuc3RhdHVzKSl0aHJvdyBuZXcgRXJyb3IoIkNvdWxkbid0IGxvYWQgIityKyIuIFN0YXR1czogIitlLnN0YXR1cyk7dmFyIHQsbj1OdW1iZXIoZS5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1sZW5ndGgiKSksbz0odD1lLmdldFJlc3BvbnNlSGVhZGVyKCJBY2NlcHQtUmFuZ2VzIikpJiYiYnl0ZXMiPT09dCxpPSh0PWUuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtRW5jb2RpbmciKSkmJiJnemlwIj09PXQsYT0xMDQ4NTc2O298fChhPW4pO3ZhciBzPXRoaXM7cy5zZXREYXRhR2V0dGVyKChmdW5jdGlvbihlKXt2YXIgdD1lKmEsbz0oZSsxKSphLTE7aWYobz1NYXRoLm1pbihvLG4tMSksdm9pZCAwPT09cy5jaHVua3NbZV0mJihzLmNodW5rc1tlXT1mdW5jdGlvbihlLHQpe2lmKGU+dCl0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgcmFuZ2UgKCIrZSsiLCAiK3QrIikgb3Igbm8gYnl0ZXMgcmVxdWVzdGVkISIpO2lmKHQ+bi0xKXRocm93IG5ldyBFcnJvcigib25seSAiK24rIiBieXRlcyBhdmFpbGFibGUhIHByb2dyYW1tZXIgZXJyb3IhIik7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O2lmKG8ub3BlbigiR0VUIixyLCExKSxuIT09YSYmby5zZXRSZXF1ZXN0SGVhZGVyKCJSYW5nZSIsImJ5dGVzPSIrZSsiLSIrdCksInVuZGVmaW5lZCIhPXR5cGVvZiBVaW50OEFycmF5JiYoby5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIiksby5vdmVycmlkZU1pbWVUeXBlJiZvLm92ZXJyaWRlTWltZVR5cGUoInRleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWQiKSxvLnNlbmQobnVsbCksIShvLnN0YXR1cz49MjAwJiZvLnN0YXR1czwzMDB8fDMwND09PW8uc3RhdHVzKSl0aHJvdyBuZXcgRXJyb3IoIkNvdWxkbid0IGxvYWQgIityKyIuIFN0YXR1czogIitvLnN0YXR1cyk7cmV0dXJuIHZvaWQgMCE9PW8ucmVzcG9uc2U/bmV3IFVpbnQ4QXJyYXkoby5yZXNwb25zZXx8W10pOiR0KG8ucmVzcG9uc2VUZXh0fHwiIiwhMCl9KHQsbykpLHZvaWQgMD09PXMuY2h1bmtzW2VdKXRocm93IG5ldyBFcnJvcigiZG9YSFIgZmFpbGVkISIpO3JldHVybiBzLmNodW5rc1tlXX0pKSwhaSYmbnx8KGE9bj0xLG49dGhpcy5nZXR0ZXIoMCkubGVuZ3RoLGE9bixjb25zb2xlLmxvZygiTGF6eUZpbGVzIG9uIGd6aXAgZm9yY2VzIGRvd25sb2FkIG9mIHRoZSB3aG9sZSBmaWxlIHdoZW4gbGVuZ3RoIGlzIGFjY2Vzc2VkIikpLHRoaXMuX2xlbmd0aD1uLHRoaXMuX2NodW5rU2l6ZT1hLHRoaXMubGVuZ3RoS25vd249ITB9LCJ1bmRlZmluZWQiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3Qpe2lmKCFjKXRocm93IkNhbm5vdCBkbyBzeW5jaHJvbm91cyBiaW5hcnkgWEhScyBvdXRzaWRlIHdlYndvcmtlcnMgaW4gbW9kZXJuIGJyb3dzZXJzLiBVc2UgLS1lbWJlZC1maWxlIG9yIC0tcHJlbG9hZC1maWxlIGluIGVtY2MiO3ZhciBhPW5ldyBpO09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGEse2xlbmd0aDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RoS25vd258fHRoaXMuY2FjaGVMZW5ndGgoKSx0aGlzLl9sZW5ndGh9fSxjaHVua1NpemU6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aEtub3dufHx0aGlzLmNhY2hlTGVuZ3RoKCksdGhpcy5fY2h1bmtTaXplfX19KTt2YXIgcz17aXNEZXZpY2U6ITEsY29udGVudHM6YX19ZWxzZSBzPXtpc0RldmljZTohMSx1cmw6cn07dmFyIHU9VGUuY3JlYXRlRmlsZShlLHQscyxuLG8pO3MuY29udGVudHM/dS5jb250ZW50cz1zLmNvbnRlbnRzOnMudXJsJiYodS5jb250ZW50cz1udWxsLHUudXJsPXMudXJsKSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyh1LHt1c2VkQnl0ZXM6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRlbnRzLmxlbmd0aH19fSk7dmFyIGw9e307cmV0dXJuIE9iamVjdC5rZXlzKHUuc3RyZWFtX29wcykuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9dS5zdHJlYW1fb3BzW2VdO2xbZV09ZnVuY3Rpb24oKXtpZighVGUuZm9yY2VMb2FkRmlsZSh1KSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU8pO3JldHVybiB0LmFwcGx5KG51bGwsYXJndW1lbnRzKX19KSksbC5yZWFkPWZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYoIVRlLmZvcmNlTG9hZEZpbGUodSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlPKTt2YXIgaT1lLm5vZGUuY29udGVudHM7aWYobz49aS5sZW5ndGgpcmV0dXJuIDA7dmFyIGE9TWF0aC5taW4oaS5sZW5ndGgtbyxuKTtpZih5KGE+PTApLGkuc2xpY2UpZm9yKHZhciBzPTA7czxhO3MrKyl0W3Irc109aVtvK3NdO2Vsc2UgZm9yKHM9MDtzPGE7cysrKXRbcitzXT1pLmdldChvK3MpO3JldHVybiBhfSx1LnN0cmVhbV9vcHM9bCx1fSxjcmVhdGVQcmVsb2FkZWRGaWxlOmZ1bmN0aW9uKGUsdCxyLG4saSxhLHMsdSxjLGwpe0Jyb3dzZXIuaW5pdCgpO3ZhciBmPXQ/Z2UucmVzb2x2ZShnZS5qb2luMihlLHQpKTplO2Z1bmN0aW9uIGQocil7ZnVuY3Rpb24gZChyKXtsJiZsKCksdXx8VGUuY3JlYXRlRGF0YUZpbGUoZSx0LHIsbixpLGMpLGEmJmEoKSxsZSgpfXZhciBoPSExO28ucHJlbG9hZFBsdWdpbnMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aHx8ZS5jYW5IYW5kbGUoZikmJihlLmhhbmRsZShyLGYsZCwoZnVuY3Rpb24oKXtzJiZzKCksbGUoKX0pKSxoPSEwKX0pKSxofHxkKHIpfWNlKCksInN0cmluZyI9PXR5cGVvZiByP0Jyb3dzZXIuYXN5bmNMb2FkKHIsKGZ1bmN0aW9uKGUpe2QoZSl9KSxzKTpkKHIpfSxpbmRleGVkREI6ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LmluZGV4ZWREQnx8d2luZG93Lm1vekluZGV4ZWREQnx8d2luZG93LndlYmtpdEluZGV4ZWREQnx8d2luZG93Lm1zSW5kZXhlZERCfSxEQl9OQU1FOmZ1bmN0aW9uKCl7cmV0dXJuIkVNX0ZTXyIrd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lfSxEQl9WRVJTSU9OOjIwLERCX1NUT1JFX05BTUU6IkZJTEVfREFUQSIsc2F2ZUZpbGVzVG9EQjpmdW5jdGlvbihlLHQscil7dD10fHxmdW5jdGlvbigpe30scj1yfHxmdW5jdGlvbigpe307dmFyIG49VGUuaW5kZXhlZERCKCk7dHJ5e3ZhciBvPW4ub3BlbihUZS5EQl9OQU1FKCksVGUuREJfVkVSU0lPTil9Y2F0Y2goZSl7cmV0dXJuIHIoZSl9by5vbnVwZ3JhZGVuZWVkZWQ9ZnVuY3Rpb24oKXtjb25zb2xlLmxvZygiY3JlYXRpbmcgZGIiKSxvLnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZShUZS5EQl9TVE9SRV9OQU1FKX0sby5vbnN1Y2Nlc3M9ZnVuY3Rpb24oKXt2YXIgbj1vLnJlc3VsdC50cmFuc2FjdGlvbihbVGUuREJfU1RPUkVfTkFNRV0sInJlYWR3cml0ZSIpLGk9bi5vYmplY3RTdG9yZShUZS5EQl9TVE9SRV9OQU1FKSxhPTAscz0wLHU9ZS5sZW5ndGg7ZnVuY3Rpb24gYygpezA9PXM/dCgpOnIoKX1lLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWkucHV0KFRlLmFuYWx5emVQYXRoKGUpLm9iamVjdC5jb250ZW50cyxlKTt0Lm9uc3VjY2Vzcz1mdW5jdGlvbigpeysrYStzPT11JiZjKCl9LHQub25lcnJvcj1mdW5jdGlvbigpe3MrKyxhK3M9PXUmJmMoKX19KSksbi5vbmVycm9yPXJ9LG8ub25lcnJvcj1yfSxsb2FkRmlsZXNGcm9tREI6ZnVuY3Rpb24oZSx0LHIpe3Q9dHx8ZnVuY3Rpb24oKXt9LHI9cnx8ZnVuY3Rpb24oKXt9O3ZhciBuPVRlLmluZGV4ZWREQigpO3RyeXt2YXIgbz1uLm9wZW4oVGUuREJfTkFNRSgpLFRlLkRCX1ZFUlNJT04pfWNhdGNoKGUpe3JldHVybiByKGUpfW8ub251cGdyYWRlbmVlZGVkPXIsby5vbnN1Y2Nlc3M9ZnVuY3Rpb24oKXt2YXIgbj1vLnJlc3VsdDt0cnl7dmFyIGk9bi50cmFuc2FjdGlvbihbVGUuREJfU1RPUkVfTkFNRV0sInJlYWRvbmx5Iil9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgcihlKX12YXIgYT1pLm9iamVjdFN0b3JlKFRlLkRCX1NUT1JFX05BTUUpLHM9MCx1PTAsYz1lLmxlbmd0aDtmdW5jdGlvbiBsKCl7MD09dT90KCk6cigpfWUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9YS5nZXQoZSk7dC5vbnN1Y2Nlc3M9ZnVuY3Rpb24oKXtUZS5hbmFseXplUGF0aChlKS5leGlzdHMmJlRlLnVubGluayhlKSxUZS5jcmVhdGVEYXRhRmlsZShnZS5kaXJuYW1lKGUpLGdlLmJhc2VuYW1lKGUpLHQucmVzdWx0LCEwLCEwLCEwKSwrK3MrdT09YyYmbCgpfSx0Lm9uZXJyb3I9ZnVuY3Rpb24oKXt1Kysscyt1PT1jJiZsKCl9fSkpLGkub25lcnJvcj1yfSxvLm9uZXJyb3I9cn19LFNlPXtERUZBVUxUX1BPTExNQVNLOjUsbWFwcGluZ3M6e30sdW1hc2s6NTExLGNhbGN1bGF0ZUF0OmZ1bmN0aW9uKGUsdCl7aWYoIi8iIT09dFswXSl7dmFyIHI7aWYoLTEwMD09PWUpcj1UZS5jd2QoKTtlbHNle3ZhciBuPVRlLmdldFN0cmVhbShlKTtpZighbil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7cj1uLnBhdGh9dD1nZS5qb2luMihyLHQpfXJldHVybiB0fSxkb1N0YXQ6ZnVuY3Rpb24oZSx0LHIpe3RyeXt2YXIgbj1lKHQpfWNhdGNoKGUpe2lmKGUmJmUubm9kZSYmZ2Uubm9ybWFsaXplKHQpIT09Z2Uubm9ybWFsaXplKFRlLmdldFBhdGgoZS5ub2RlKSkpcmV0dXJuLW1lLkVOT1RESVI7dGhyb3cgZX1yZXR1cm4gRltyPj4yXT1uLmRldixGW3IrND4+Ml09MCxGW3IrOD4+Ml09bi5pbm8sRltyKzEyPj4yXT1uLm1vZGUsRltyKzE2Pj4yXT1uLm5saW5rLEZbcisyMD4+Ml09bi51aWQsRltyKzI0Pj4yXT1uLmdpZCxGW3IrMjg+PjJdPW4ucmRldixGW3IrMzI+PjJdPTAsRltyKzM2Pj4yXT1uLnNpemUsRltyKzQwPj4yXT00MDk2LEZbcis0ND4+Ml09bi5ibG9ja3MsRltyKzQ4Pj4yXT1uLmF0aW1lLmdldFRpbWUoKS8xZTN8MCxGW3IrNTI+PjJdPTAsRltyKzU2Pj4yXT1uLm10aW1lLmdldFRpbWUoKS8xZTN8MCxGW3IrNjA+PjJdPTAsRltyKzY0Pj4yXT1uLmN0aW1lLmdldFRpbWUoKS8xZTN8MCxGW3IrNjg+PjJdPTAsRltyKzcyPj4yXT1uLmlubywwfSxkb01zeW5jOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPW5ldyBVaW50OEFycmF5KE8uc3ViYXJyYXkoZSxlK3IpKTtUZS5tc3luYyh0LG8sMCxyLG4pfSxkb01rZGlyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIi8iPT09KGU9Z2Uubm9ybWFsaXplKGUpKVtlLmxlbmd0aC0xXSYmKGU9ZS5zdWJzdHIoMCxlLmxlbmd0aC0xKSksVGUubWtkaXIoZSx0LDApLDB9LGRvTWtub2Q6ZnVuY3Rpb24oZSx0LHIpe3N3aXRjaCg2MTQ0MCZ0KXtjYXNlIDMyNzY4OmNhc2UgODE5MjpjYXNlIDI0NTc2OmNhc2UgNDA5NjpjYXNlIDQ5MTUyOmJyZWFrO2RlZmF1bHQ6cmV0dXJuLW1lLkVJTlZBTH1yZXR1cm4gVGUubWtub2QoZSx0LHIpLDB9LGRvUmVhZGxpbms6ZnVuY3Rpb24oZSx0LHIpe2lmKHI8PTApcmV0dXJuLW1lLkVJTlZBTDt2YXIgbj1UZS5yZWFkbGluayhlKSxvPU1hdGgubWluKHIsUyhuKSksaT1SW3Qrb107cmV0dXJuIFQobix0LHIrMSksUlt0K29dPWksb30sZG9BY2Nlc3M6ZnVuY3Rpb24oZSx0KXtpZigtOCZ0KXJldHVybi1tZS5FSU5WQUw7dmFyIHI7cj1UZS5sb29rdXBQYXRoKGUse2ZvbGxvdzohMH0pLm5vZGU7dmFyIG49IiI7cmV0dXJuIDQmdCYmKG4rPSJyIiksMiZ0JiYobis9InciKSwxJnQmJihuKz0ieCIpLG4mJlRlLm5vZGVQZXJtaXNzaW9ucyhyLG4pPy1tZS5FQUNDRVM6MH0sZG9EdXA6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPVRlLmdldFN0cmVhbShyKTtyZXR1cm4gbiYmVGUuY2xvc2UobiksVGUub3BlbihlLHQsMCxyLHIpLmZkfSxkb1JlYWR2OmZ1bmN0aW9uKGUsdCxyLG4pe2Zvcih2YXIgbz0wLGk9MDtpPHI7aSsrKXt2YXIgYT1GW3QrOCppPj4yXSxzPUZbdCsoOCppKzQpPj4yXSx1PVRlLnJlYWQoZSxSLGEscyxuKTtpZih1PDApcmV0dXJuLTE7aWYobys9dSx1PHMpYnJlYWt9cmV0dXJuIG99LGRvV3JpdGV2OmZ1bmN0aW9uKGUsdCxyLG4pe2Zvcih2YXIgbz0wLGk9MDtpPHI7aSsrKXt2YXIgYT1GW3QrOCppPj4yXSxzPUZbdCsoOCppKzQpPj4yXSx1PVRlLndyaXRlKGUsUixhLHMsbik7aWYodTwwKXJldHVybi0xO28rPXV9cmV0dXJuIG99LHZhcmFyZ3M6MCxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFNlLnZhcmFyZ3MrPTQsRltTZS52YXJhcmdzLTQ+PjJdfSxnZXRTdHI6ZnVuY3Rpb24oKXtyZXR1cm4gdihTZS5nZXQoKSl9LGdldFN0cmVhbUZyb21GRDpmdW5jdGlvbigpe3ZhciBlPVRlLmdldFN0cmVhbShTZS5nZXQoKSk7aWYoIWUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJBREYpO3JldHVybiBlfSxnZXRTb2NrZXRGcm9tRkQ6ZnVuY3Rpb24oKXt2YXIgZT1TT0NLRlMuZ2V0U29ja2V0KFNlLmdldCgpKTtpZighZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7cmV0dXJuIGV9LGdldFNvY2tldEFkZHJlc3M6ZnVuY3Rpb24oZSl7dmFyIHQ9U2UuZ2V0KCkscj1TZS5nZXQoKTtpZihlJiYwPT09dClyZXR1cm4gbnVsbDt2YXIgbj1fX3JlYWRfc29ja2FkZHIodCxyKTtpZihuLmVycm5vKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG4uZXJybm8pO3JldHVybiBuLmFkZHI9RE5TLmxvb2t1cF9hZGRyKG4uYWRkcil8fG4uYWRkcixufSxnZXQ2NDpmdW5jdGlvbigpe3ZhciBlPVNlLmdldCgpLHQ9U2UuZ2V0KCk7cmV0dXJuIHkoZT49MD8wPT09dDotMT09PXQpLGV9LGdldFplcm86ZnVuY3Rpb24oKXt5KDA9PT1TZS5nZXQoKSl9fTt2YXIga2U9NDI7dmFyIFBlPXt9O2Z1bmN0aW9uIERlKGUpe2Zvcig7ZS5sZW5ndGg7KXt2YXIgdD1lLnBvcCgpO2UucG9wKCkodCl9fWZ1bmN0aW9uIFJlKGUpe3JldHVybiB0aGlzLmZyb21XaXJlVHlwZShNW2U+PjJdKX12YXIgT2U9e30sQ2U9e30sTmU9e307ZnVuY3Rpb24gRmUoZSl7aWYodm9pZCAwPT09ZSlyZXR1cm4iX3Vua25vd24iO3ZhciB0PShlPWUucmVwbGFjZSgvW15hLXpBLVowLTlfXS9nLCIkIikpLmNoYXJDb2RlQXQoMCk7cmV0dXJuIHQ+PTQ4JiZ0PD01Nz8iXyIrZTplfWZ1bmN0aW9uIE1lKGUsdCl7cmV0dXJuIGU9RmUoZSksbmV3IEZ1bmN0aW9uKCJib2R5IiwicmV0dXJuIGZ1bmN0aW9uICIrZSsnKCkge1xuICAgICJ1c2Ugc3RyaWN0IjsgICAgcmV0dXJuIGJvZHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG4nKSh0KX1mdW5jdGlvbiBJZShlLHQpe3ZhciByPU1lKHQsKGZ1bmN0aW9uKGUpe3RoaXMubmFtZT10LHRoaXMubWVzc2FnZT1lO3ZhciByPW5ldyBFcnJvcihlKS5zdGFjazt2b2lkIDAhPT1yJiYodGhpcy5zdGFjaz10aGlzLnRvU3RyaW5nKCkrIlxuIityLnJlcGxhY2UoL15FcnJvcig6W15cbl0qKT9cbi8sIiIpKX0pKTtyZXR1cm4gci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlLnByb3RvdHlwZSksci5wcm90b3R5cGUuY29uc3RydWN0b3I9cixyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT10aGlzLm1lc3NhZ2U/dGhpcy5uYW1lOnRoaXMubmFtZSsiOiAiK3RoaXMubWVzc2FnZX0scn12YXIgQmU9dm9pZCAwO2Z1bmN0aW9uIExlKGUpe3Rocm93IG5ldyBCZShlKX1mdW5jdGlvbiB4ZShlLHQscil7ZnVuY3Rpb24gbih0KXt2YXIgbj1yKHQpO24ubGVuZ3RoIT09ZS5sZW5ndGgmJkxlKCJNaXNtYXRjaGVkIHR5cGUgY29udmVydGVyIGNvdW50Iik7Zm9yKHZhciBvPTA7bzxlLmxlbmd0aDsrK28pWWUoZVtvXSxuW29dKX1lLmZvckVhY2goKGZ1bmN0aW9uKGUpe05lW2VdPXR9KSk7dmFyIG89bmV3IEFycmF5KHQubGVuZ3RoKSxpPVtdLGE9MDt0LmZvckVhY2goKGZ1bmN0aW9uKGUsdCl7Q2UuaGFzT3duUHJvcGVydHkoZSk/b1t0XT1DZVtlXTooaS5wdXNoKGUpLE9lLmhhc093blByb3BlcnR5KGUpfHwoT2VbZV09W10pLE9lW2VdLnB1c2goKGZ1bmN0aW9uKCl7b1t0XT1DZVtlXSwrK2E9PT1pLmxlbmd0aCYmbihvKX0pKSl9KSksMD09PWkubGVuZ3RoJiZuKG8pfWZ1bmN0aW9uIGplKGUpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIDA7Y2FzZSAyOnJldHVybiAxO2Nhc2UgNDpyZXR1cm4gMjtjYXNlIDg6cmV0dXJuIDM7ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIHR5cGUgc2l6ZTogIitlKX19dmFyIFVlPXZvaWQgMDtmdW5jdGlvbiB6ZShlKXtmb3IodmFyIHQ9IiIscj1lO09bcl07KXQrPVVlW09bcisrXV07cmV0dXJuIHR9dmFyICRlPXZvaWQgMDtmdW5jdGlvbiBXZShlKXt0aHJvdyBuZXcgJGUoZSl9ZnVuY3Rpb24gWWUoZSx0LHIpe2lmKHI9cnx8e30sISgiYXJnUGFja0FkdmFuY2UiaW4gdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigicmVnaXN0ZXJUeXBlIHJlZ2lzdGVyZWRJbnN0YW5jZSByZXF1aXJlcyBhcmdQYWNrQWR2YW5jZSIpO3ZhciBuPXQubmFtZTtpZihlfHxXZSgndHlwZSAiJytuKyciIG11c3QgaGF2ZSBhIHBvc2l0aXZlIGludGVnZXIgdHlwZWlkIHBvaW50ZXInKSxDZS5oYXNPd25Qcm9wZXJ0eShlKSl7aWYoci5pZ25vcmVEdXBsaWNhdGVSZWdpc3RyYXRpb25zKXJldHVybjtXZSgiQ2Fubm90IHJlZ2lzdGVyIHR5cGUgJyIrbisiJyB0d2ljZSIpfWlmKENlW2VdPXQsZGVsZXRlIE5lW2VdLE9lLmhhc093blByb3BlcnR5KGUpKXt2YXIgbz1PZVtlXTtkZWxldGUgT2VbZV0sby5mb3JFYWNoKChmdW5jdGlvbihlKXtlKCl9KSl9fWZ1bmN0aW9uIFZlKGUpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGV0KSlyZXR1cm4hMTtpZighKGUgaW5zdGFuY2VvZiBldCkpcmV0dXJuITE7Zm9yKHZhciB0PXRoaXMuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3Mscj10aGlzLiQkLnB0cixuPWUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3Msbz1lLiQkLnB0cjt0LmJhc2VDbGFzczspcj10LnVwY2FzdChyKSx0PXQuYmFzZUNsYXNzO2Zvcig7bi5iYXNlQ2xhc3M7KW89bi51cGNhc3Qobyksbj1uLmJhc2VDbGFzcztyZXR1cm4gdD09PW4mJnI9PT1vfWZ1bmN0aW9uIEhlKGUpe1dlKGUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3MubmFtZSsiIGluc3RhbmNlIGFscmVhZHkgZGVsZXRlZCIpfWZ1bmN0aW9uIEdlKCl7aWYodGhpcy4kJC5wdHJ8fEhlKHRoaXMpLHRoaXMuJCQucHJlc2VydmVQb2ludGVyT25EZWxldGUpcmV0dXJuIHRoaXMuJCQuY291bnQudmFsdWUrPTEsdGhpczt2YXIgZSx0PU9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLHskJDp7dmFsdWU6KGU9dGhpcy4kJCx7Y291bnQ6ZS5jb3VudCxkZWxldGVTY2hlZHVsZWQ6ZS5kZWxldGVTY2hlZHVsZWQscHJlc2VydmVQb2ludGVyT25EZWxldGU6ZS5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSxwdHI6ZS5wdHIscHRyVHlwZTplLnB0clR5cGUsc21hcnRQdHI6ZS5zbWFydFB0cixzbWFydFB0clR5cGU6ZS5zbWFydFB0clR5cGV9KX19KTtyZXR1cm4gdC4kJC5jb3VudC52YWx1ZSs9MSx0LiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSx0fWZ1bmN0aW9uIHFlKCl7dmFyIGU7dGhpcy4kJC5wdHJ8fEhlKHRoaXMpLHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkJiYhdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSYmV2UoIk9iamVjdCBhbHJlYWR5IHNjaGVkdWxlZCBmb3IgZGVsZXRpb24iKSx0aGlzLiQkLmNvdW50LnZhbHVlLT0xLDA9PT10aGlzLiQkLmNvdW50LnZhbHVlJiYoKGU9dGhpcy4kJCkuc21hcnRQdHI/ZS5zbWFydFB0clR5cGUucmF3RGVzdHJ1Y3RvcihlLnNtYXJ0UHRyKTplLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzLnJhd0Rlc3RydWN0b3IoZS5wdHIpKSx0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlfHwodGhpcy4kJC5zbWFydFB0cj12b2lkIDAsdGhpcy4kJC5wdHI9dm9pZCAwKX1mdW5jdGlvbiBYZSgpe3JldHVybiF0aGlzLiQkLnB0cn12YXIgS2U9dm9pZCAwLEplPVtdO2Z1bmN0aW9uIFplKCl7Zm9yKDtKZS5sZW5ndGg7KXt2YXIgZT1KZS5wb3AoKTtlLiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSxlLmRlbGV0ZSgpfX1mdW5jdGlvbiBRZSgpe3JldHVybiB0aGlzLiQkLnB0cnx8SGUodGhpcyksdGhpcy4kJC5kZWxldGVTY2hlZHVsZWQmJiF0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlJiZXZSgiT2JqZWN0IGFscmVhZHkgc2NoZWR1bGVkIGZvciBkZWxldGlvbiIpLEplLnB1c2godGhpcyksMT09PUplLmxlbmd0aCYmS2UmJktlKFplKSx0aGlzLiQkLmRlbGV0ZVNjaGVkdWxlZD0hMCx0aGlzfWZ1bmN0aW9uIGV0KCl7fXZhciB0dD17fTtmdW5jdGlvbiBydChlLHQscil7aWYodm9pZCAwPT09ZVt0XS5vdmVybG9hZFRhYmxlKXt2YXIgbj1lW3RdO2VbdF09ZnVuY3Rpb24oKXtyZXR1cm4gZVt0XS5vdmVybG9hZFRhYmxlLmhhc093blByb3BlcnR5KGFyZ3VtZW50cy5sZW5ndGgpfHxXZSgiRnVuY3Rpb24gJyIrcisiJyBjYWxsZWQgd2l0aCBhbiBpbnZhbGlkIG51bWJlciBvZiBhcmd1bWVudHMgKCIrYXJndW1lbnRzLmxlbmd0aCsiKSAtIGV4cGVjdHMgb25lIG9mICgiK2VbdF0ub3ZlcmxvYWRUYWJsZSsiKSEiKSxlW3RdLm92ZXJsb2FkVGFibGVbYXJndW1lbnRzLmxlbmd0aF0uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlW3RdLm92ZXJsb2FkVGFibGU9W10sZVt0XS5vdmVybG9hZFRhYmxlW24uYXJnQ291bnRdPW59fWZ1bmN0aW9uIG50KGUsdCxyLG4sbyxpLGEscyl7dGhpcy5uYW1lPWUsdGhpcy5jb25zdHJ1Y3Rvcj10LHRoaXMuaW5zdGFuY2VQcm90b3R5cGU9cix0aGlzLnJhd0Rlc3RydWN0b3I9bix0aGlzLmJhc2VDbGFzcz1vLHRoaXMuZ2V0QWN0dWFsVHlwZT1pLHRoaXMudXBjYXN0PWEsdGhpcy5kb3duY2FzdD1zLHRoaXMucHVyZVZpcnR1YWxGdW5jdGlvbnM9W119ZnVuY3Rpb24gb3QoZSx0LHIpe2Zvcig7dCE9PXI7KXQudXBjYXN0fHxXZSgiRXhwZWN0ZWQgbnVsbCBvciBpbnN0YW5jZSBvZiAiK3IubmFtZSsiLCBnb3QgYW4gaW5zdGFuY2Ugb2YgIit0Lm5hbWUpLGU9dC51cGNhc3QoZSksdD10LmJhc2VDbGFzcztyZXR1cm4gZX1mdW5jdGlvbiBpdChlLHQpe2lmKG51bGw9PT10KXJldHVybiB0aGlzLmlzUmVmZXJlbmNlJiZXZSgibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSksMDt0LiQkfHxXZSgnQ2Fubm90IHBhc3MgIicrT3QodCkrJyIgYXMgYSAnK3RoaXMubmFtZSksdC4kJC5wdHJ8fFdlKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSk7dmFyIHI9dC4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcztyZXR1cm4gb3QodC4kJC5wdHIscix0aGlzLnJlZ2lzdGVyZWRDbGFzcyl9ZnVuY3Rpb24gYXQoZSx0KXt2YXIgcjtpZihudWxsPT09dClyZXR1cm4gdGhpcy5pc1JlZmVyZW5jZSYmV2UoIm51bGwgaXMgbm90IGEgdmFsaWQgIit0aGlzLm5hbWUpLHRoaXMuaXNTbWFydFBvaW50ZXI/KHI9dGhpcy5yYXdDb25zdHJ1Y3RvcigpLG51bGwhPT1lJiZlLnB1c2godGhpcy5yYXdEZXN0cnVjdG9yLHIpLHIpOjA7dC4kJHx8V2UoJ0Nhbm5vdCBwYXNzICInK090KHQpKyciIGFzIGEgJyt0aGlzLm5hbWUpLHQuJCQucHRyfHxXZSgiQ2Fubm90IHBhc3MgZGVsZXRlZCBvYmplY3QgYXMgYSBwb2ludGVyIG9mIHR5cGUgIit0aGlzLm5hbWUpLCF0aGlzLmlzQ29uc3QmJnQuJCQucHRyVHlwZS5pc0NvbnN0JiZXZSgiQ2Fubm90IGNvbnZlcnQgYXJndW1lbnQgb2YgdHlwZSAiKyh0LiQkLnNtYXJ0UHRyVHlwZT90LiQkLnNtYXJ0UHRyVHlwZS5uYW1lOnQuJCQucHRyVHlwZS5uYW1lKSsiIHRvIHBhcmFtZXRlciB0eXBlICIrdGhpcy5uYW1lKTt2YXIgbj10LiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzO2lmKHI9b3QodC4kJC5wdHIsbix0aGlzLnJlZ2lzdGVyZWRDbGFzcyksdGhpcy5pc1NtYXJ0UG9pbnRlcilzd2l0Y2godm9pZCAwPT09dC4kJC5zbWFydFB0ciYmV2UoIlBhc3NpbmcgcmF3IHBvaW50ZXIgdG8gc21hcnQgcG9pbnRlciBpcyBpbGxlZ2FsIiksdGhpcy5zaGFyaW5nUG9saWN5KXtjYXNlIDA6dC4kJC5zbWFydFB0clR5cGU9PT10aGlzP3I9dC4kJC5zbWFydFB0cjpXZSgiQ2Fubm90IGNvbnZlcnQgYXJndW1lbnQgb2YgdHlwZSAiKyh0LiQkLnNtYXJ0UHRyVHlwZT90LiQkLnNtYXJ0UHRyVHlwZS5uYW1lOnQuJCQucHRyVHlwZS5uYW1lKSsiIHRvIHBhcmFtZXRlciB0eXBlICIrdGhpcy5uYW1lKTticmVhaztjYXNlIDE6cj10LiQkLnNtYXJ0UHRyO2JyZWFrO2Nhc2UgMjppZih0LiQkLnNtYXJ0UHRyVHlwZT09PXRoaXMpcj10LiQkLnNtYXJ0UHRyO2Vsc2V7dmFyIG89dC5jbG9uZSgpO3I9dGhpcy5yYXdTaGFyZShyLFJ0KChmdW5jdGlvbigpe28uZGVsZXRlKCl9KSkpLG51bGwhPT1lJiZlLnB1c2godGhpcy5yYXdEZXN0cnVjdG9yLHIpfWJyZWFrO2RlZmF1bHQ6V2UoIlVuc3VwcG9ydGluZyBzaGFyaW5nIHBvbGljeSIpfXJldHVybiByfWZ1bmN0aW9uIHN0KGUsdCl7aWYobnVsbD09PXQpcmV0dXJuIHRoaXMuaXNSZWZlcmVuY2UmJldlKCJudWxsIGlzIG5vdCBhIHZhbGlkICIrdGhpcy5uYW1lKSwwO3QuJCR8fFdlKCdDYW5ub3QgcGFzcyAiJytPdCh0KSsnIiBhcyBhICcrdGhpcy5uYW1lKSx0LiQkLnB0cnx8V2UoIkNhbm5vdCBwYXNzIGRlbGV0ZWQgb2JqZWN0IGFzIGEgcG9pbnRlciBvZiB0eXBlICIrdGhpcy5uYW1lKSx0LiQkLnB0clR5cGUuaXNDb25zdCYmV2UoIkNhbm5vdCBjb252ZXJ0IGFyZ3VtZW50IG9mIHR5cGUgIit0LiQkLnB0clR5cGUubmFtZSsiIHRvIHBhcmFtZXRlciB0eXBlICIrdGhpcy5uYW1lKTt2YXIgcj10LiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzO3JldHVybiBvdCh0LiQkLnB0cixyLHRoaXMucmVnaXN0ZXJlZENsYXNzKX1mdW5jdGlvbiB1dChlKXtyZXR1cm4gdGhpcy5yYXdHZXRQb2ludGVlJiYoZT10aGlzLnJhd0dldFBvaW50ZWUoZSkpLGV9ZnVuY3Rpb24gY3QoZSl7dGhpcy5yYXdEZXN0cnVjdG9yJiZ0aGlzLnJhd0Rlc3RydWN0b3IoZSl9ZnVuY3Rpb24gbHQoZSl7bnVsbCE9PWUmJmUuZGVsZXRlKCl9ZnVuY3Rpb24gZnQoKXtyZXR1cm4gT2JqZWN0LmtleXMocHQpLmxlbmd0aH1mdW5jdGlvbiBkdCgpe3ZhciBlPVtdO2Zvcih2YXIgdCBpbiBwdClwdC5oYXNPd25Qcm9wZXJ0eSh0KSYmZS5wdXNoKHB0W3RdKTtyZXR1cm4gZX1mdW5jdGlvbiBodChlKXtLZT1lLEplLmxlbmd0aCYmS2UmJktlKFplKX12YXIgcHQ9e307ZnVuY3Rpb24gbXQoZSx0KXtyZXR1cm4gdD1mdW5jdGlvbihlLHQpe2Zvcih2b2lkIDA9PT10JiZXZSgicHRyIHNob3VsZCBub3QgYmUgdW5kZWZpbmVkIik7ZS5iYXNlQ2xhc3M7KXQ9ZS51cGNhc3QodCksZT1lLmJhc2VDbGFzcztyZXR1cm4gdH0oZSx0KSxwdFt0XX1mdW5jdGlvbiB5dChlLHQpe3JldHVybiB0LnB0clR5cGUmJnQucHRyfHxMZSgibWFrZUNsYXNzSGFuZGxlIHJlcXVpcmVzIHB0ciBhbmQgcHRyVHlwZSIpLCEhdC5zbWFydFB0clR5cGUhPT0hIXQuc21hcnRQdHImJkxlKCJCb3RoIHNtYXJ0UHRyVHlwZSBhbmQgc21hcnRQdHIgbXVzdCBiZSBzcGVjaWZpZWQiKSx0LmNvdW50PXt2YWx1ZToxfSxPYmplY3QuY3JlYXRlKGUseyQkOnt2YWx1ZTp0fX0pfWZ1bmN0aW9uIEV0KGUpe3ZhciB0PXRoaXMuZ2V0UG9pbnRlZShlKTtpZighdClyZXR1cm4gdGhpcy5kZXN0cnVjdG9yKGUpLG51bGw7dmFyIHI9bXQodGhpcy5yZWdpc3RlcmVkQ2xhc3MsdCk7aWYodm9pZCAwIT09cil7aWYoMD09PXIuJCQuY291bnQudmFsdWUpcmV0dXJuIHIuJCQucHRyPXQsci4kJC5zbWFydFB0cj1lLHIuY2xvbmUoKTt2YXIgbj1yLmNsb25lKCk7cmV0dXJuIHRoaXMuZGVzdHJ1Y3RvcihlKSxufWZ1bmN0aW9uIG8oKXtyZXR1cm4gdGhpcy5pc1NtYXJ0UG9pbnRlcj95dCh0aGlzLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0aGlzLnBvaW50ZWVUeXBlLHB0cjp0LHNtYXJ0UHRyVHlwZTp0aGlzLHNtYXJ0UHRyOmV9KTp5dCh0aGlzLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0aGlzLHB0cjplfSl9dmFyIGksYT10aGlzLnJlZ2lzdGVyZWRDbGFzcy5nZXRBY3R1YWxUeXBlKHQpLHM9dHRbYV07aWYoIXMpcmV0dXJuIG8uY2FsbCh0aGlzKTtpPXRoaXMuaXNDb25zdD9zLmNvbnN0UG9pbnRlclR5cGU6cy5wb2ludGVyVHlwZTt2YXIgdT1mdW5jdGlvbiBlKHQscixuKXtpZihyPT09bilyZXR1cm4gdDtpZih2b2lkIDA9PT1uLmJhc2VDbGFzcylyZXR1cm4gbnVsbDt2YXIgbz1lKHQscixuLmJhc2VDbGFzcyk7cmV0dXJuIG51bGw9PT1vP251bGw6bi5kb3duY2FzdChvKX0odCx0aGlzLnJlZ2lzdGVyZWRDbGFzcyxpLnJlZ2lzdGVyZWRDbGFzcyk7cmV0dXJuIG51bGw9PT11P28uY2FsbCh0aGlzKTp0aGlzLmlzU21hcnRQb2ludGVyP3l0KGkucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHtwdHJUeXBlOmkscHRyOnUsc21hcnRQdHJUeXBlOnRoaXMsc21hcnRQdHI6ZX0pOnl0KGkucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHtwdHJUeXBlOmkscHRyOnV9KX1mdW5jdGlvbiBndChlLHQscixuLG8saSxhLHMsdSxjLGwpe3RoaXMubmFtZT1lLHRoaXMucmVnaXN0ZXJlZENsYXNzPXQsdGhpcy5pc1JlZmVyZW5jZT1yLHRoaXMuaXNDb25zdD1uLHRoaXMuaXNTbWFydFBvaW50ZXI9byx0aGlzLnBvaW50ZWVUeXBlPWksdGhpcy5zaGFyaW5nUG9saWN5PWEsdGhpcy5yYXdHZXRQb2ludGVlPXMsdGhpcy5yYXdDb25zdHJ1Y3Rvcj11LHRoaXMucmF3U2hhcmU9Yyx0aGlzLnJhd0Rlc3RydWN0b3I9bCxvfHx2b2lkIDAhPT10LmJhc2VDbGFzcz90aGlzLnRvV2lyZVR5cGU9YXQ6bj8odGhpcy50b1dpcmVUeXBlPWl0LHRoaXMuZGVzdHJ1Y3RvckZ1bmN0aW9uPW51bGwpOih0aGlzLnRvV2lyZVR5cGU9c3QsdGhpcy5kZXN0cnVjdG9yRnVuY3Rpb249bnVsbCl9ZnVuY3Rpb24gdnQoZSx0KXt2YXIgcjtpZihlPXplKGUpLHZvaWQgMCE9PW9bIkZVTkNUSU9OX1RBQkxFXyIrZV0pcj1vWyJGVU5DVElPTl9UQUJMRV8iK2VdW3RdO2Vsc2UgaWYoInVuZGVmaW5lZCIhPXR5cGVvZiBGVU5DVElPTl9UQUJMRSlyPUZVTkNUSU9OX1RBQkxFW3RdO2Vsc2V7dmFyIG49by5hc21bImR5bkNhbGxfIitlXTt2b2lkIDA9PT1uJiZ2b2lkIDA9PT0obj1vLmFzbVsiZHluQ2FsbF8iK2UucmVwbGFjZSgvZi9nLCJkIildKSYmV2UoIk5vIGR5bkNhbGwgaW52b2tlciBmb3Igc2lnbmF0dXJlOiAiK2UpLHI9ZnVuY3Rpb24ocil7Zm9yKHZhciBuPVtdLG89MTtvPGUubGVuZ3RoOysrbyluLnB1c2goImEiK28pO3ZhciBpPSJyZXR1cm4gZnVuY3Rpb24gIisoImR5bkNhbGxfIitlKyJfIit0KSsiKCIrbi5qb2luKCIsICIpKyIpIHtcbiI7cmV0dXJuIGkrPSIgICAgcmV0dXJuIGR5bkNhbGwocmF3RnVuY3Rpb24iKyhuLmxlbmd0aD8iLCAiOiIiKStuLmpvaW4oIiwgIikrIik7XG4iLGkrPSJ9O1xuIixuZXcgRnVuY3Rpb24oImR5bkNhbGwiLCJyYXdGdW5jdGlvbiIsaSkocix0KX0obil9cmV0dXJuImZ1bmN0aW9uIiE9dHlwZW9mIHImJldlKCJ1bmtub3duIGZ1bmN0aW9uIHBvaW50ZXIgd2l0aCBzaWduYXR1cmUgIitlKyI6ICIrdCkscn12YXIgd3Q9dm9pZCAwO2Z1bmN0aW9uIF90KGUpe3ZhciB0PXF0KGUpLHI9emUodCk7cmV0dXJuIEt0KHQpLHJ9ZnVuY3Rpb24gYnQoZSx0KXt2YXIgcj1bXSxuPXt9O3Rocm93IHQuZm9yRWFjaCgoZnVuY3Rpb24gZSh0KXtuW3RdfHxDZVt0XXx8KE5lW3RdP05lW3RdLmZvckVhY2goZSk6KHIucHVzaCh0KSxuW3RdPSEwKSl9KSksbmV3IHd0KGUrIjogIityLm1hcChfdCkuam9pbihbIiwgIl0pKX1mdW5jdGlvbiBBdChlLHQpe2Zvcih2YXIgcj1bXSxuPTA7bjxlO24rKylyLnB1c2goRlsodD4+Mikrbl0pO3JldHVybiByfWZ1bmN0aW9uIFR0KGUsdCxyLG4sbyl7dmFyIGk9dC5sZW5ndGg7aTwyJiZXZSgiYXJnVHlwZXMgYXJyYXkgc2l6ZSBtaXNtYXRjaCEgTXVzdCBhdCBsZWFzdCBnZXQgcmV0dXJuIHZhbHVlIGFuZCAndGhpcycgdHlwZXMhIik7Zm9yKHZhciBhPW51bGwhPT10WzFdJiZudWxsIT09cixzPSExLHU9MTt1PHQubGVuZ3RoOysrdSlpZihudWxsIT09dFt1XSYmdm9pZCAwPT09dFt1XS5kZXN0cnVjdG9yRnVuY3Rpb24pe3M9ITA7YnJlYWt9dmFyIGM9InZvaWQiIT09dFswXS5uYW1lLGw9IiIsZj0iIjtmb3IodT0wO3U8aS0yOysrdSlsKz0oMCE9PXU/IiwgIjoiIikrImFyZyIrdSxmKz0oMCE9PXU/IiwgIjoiIikrImFyZyIrdSsiV2lyZWQiO3ZhciBkPSJyZXR1cm4gZnVuY3Rpb24gIitGZShlKSsiKCIrbCsiKSB7XG5pZiAoYXJndW1lbnRzLmxlbmd0aCAhPT0gIisoaS0yKSsiKSB7XG50aHJvd0JpbmRpbmdFcnJvcignZnVuY3Rpb24gIitlKyIgY2FsbGVkIHdpdGggJyArIGFyZ3VtZW50cy5sZW5ndGggKyAnIGFyZ3VtZW50cywgZXhwZWN0ZWQgIisoaS0yKSsiIGFyZ3MhJyk7XG59XG4iO3MmJihkKz0idmFyIGRlc3RydWN0b3JzID0gW107XG4iKTt2YXIgaD1zPyJkZXN0cnVjdG9ycyI6Im51bGwiLHA9WyJ0aHJvd0JpbmRpbmdFcnJvciIsImludm9rZXIiLCJmbiIsInJ1bkRlc3RydWN0b3JzIiwicmV0VHlwZSIsImNsYXNzUGFyYW0iXSxtPVtXZSxuLG8sRGUsdFswXSx0WzFdXTthJiYoZCs9InZhciB0aGlzV2lyZWQgPSBjbGFzc1BhcmFtLnRvV2lyZVR5cGUoIitoKyIsIHRoaXMpO1xuIik7Zm9yKHU9MDt1PGktMjsrK3UpZCs9InZhciBhcmciK3UrIldpcmVkID0gYXJnVHlwZSIrdSsiLnRvV2lyZVR5cGUoIitoKyIsIGFyZyIrdSsiKTsgLy8gIit0W3UrMl0ubmFtZSsiXG4iLHAucHVzaCgiYXJnVHlwZSIrdSksbS5wdXNoKHRbdSsyXSk7aWYoYSYmKGY9InRoaXNXaXJlZCIrKGYubGVuZ3RoPjA/IiwgIjoiIikrZiksZCs9KGM/InZhciBydiA9ICI6IiIpKyJpbnZva2VyKGZuIisoZi5sZW5ndGg+MD8iLCAiOiIiKStmKyIpO1xuIixzKWQrPSJydW5EZXN0cnVjdG9ycyhkZXN0cnVjdG9ycyk7XG4iO2Vsc2UgZm9yKHU9YT8xOjI7dTx0Lmxlbmd0aDsrK3Upe3ZhciB5PTE9PT11PyJ0aGlzV2lyZWQiOiJhcmciKyh1LTIpKyJXaXJlZCI7bnVsbCE9PXRbdV0uZGVzdHJ1Y3RvckZ1bmN0aW9uJiYoZCs9eSsiX2R0b3IoIit5KyIpOyAvLyAiK3RbdV0ubmFtZSsiXG4iLHAucHVzaCh5KyJfZHRvciIpLG0ucHVzaCh0W3VdLmRlc3RydWN0b3JGdW5jdGlvbikpfXJldHVybiBjJiYoZCs9InZhciByZXQgPSByZXRUeXBlLmZyb21XaXJlVHlwZShydik7XG5yZXR1cm4gcmV0O1xuIiksZCs9In1cbiIscC5wdXNoKGQpLGZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgRnVuY3Rpb24pKXRocm93IG5ldyBUeXBlRXJyb3IoIm5ld18gY2FsbGVkIHdpdGggY29uc3RydWN0b3IgdHlwZSAiK3R5cGVvZiBlKyIgd2hpY2ggaXMgbm90IGEgZnVuY3Rpb24iKTt2YXIgcj1NZShlLm5hbWV8fCJ1bmtub3duRnVuY3Rpb25OYW1lIiwoZnVuY3Rpb24oKXt9KSk7ci5wcm90b3R5cGU9ZS5wcm90b3R5cGU7dmFyIG49bmV3IHIsbz1lLmFwcGx5KG4sdCk7cmV0dXJuIG8gaW5zdGFuY2VvZiBPYmplY3Q/bzpufShGdW5jdGlvbixwKS5hcHBseShudWxsLG0pfXZhciBTdD1bXSxrdD1be30se3ZhbHVlOnZvaWQgMH0se3ZhbHVlOm51bGx9LHt2YWx1ZTohMH0se3ZhbHVlOiExfV07ZnVuY3Rpb24gUHQoKXtmb3IodmFyIGU9MCx0PTU7dDxrdC5sZW5ndGg7Kyt0KXZvaWQgMCE9PWt0W3RdJiYrK2U7cmV0dXJuIGV9ZnVuY3Rpb24gRHQoKXtmb3IodmFyIGU9NTtlPGt0Lmxlbmd0aDsrK2UpaWYodm9pZCAwIT09a3RbZV0pcmV0dXJuIGt0W2VdO3JldHVybiBudWxsfWZ1bmN0aW9uIFJ0KGUpe3N3aXRjaChlKXtjYXNlIHZvaWQgMDpyZXR1cm4gMTtjYXNlIG51bGw6cmV0dXJuIDI7Y2FzZSEwOnJldHVybiAzO2Nhc2UhMTpyZXR1cm4gNDtkZWZhdWx0OnZhciB0PVN0Lmxlbmd0aD9TdC5wb3AoKTprdC5sZW5ndGg7cmV0dXJuIGt0W3RdPXtyZWZjb3VudDoxLHZhbHVlOmV9LHR9fWZ1bmN0aW9uIE90KGUpe2lmKG51bGw9PT1lKXJldHVybiJudWxsIjt2YXIgdD10eXBlb2YgZTtyZXR1cm4ib2JqZWN0Ij09PXR8fCJhcnJheSI9PT10fHwiZnVuY3Rpb24iPT09dD9lLnRvU3RyaW5nKCk6IiIrZX1mdW5jdGlvbiBDdChlLHQpe3N3aXRjaCh0KXtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmZyb21XaXJlVHlwZShJW2U+PjJdKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUoQltlPj4zXSl9O2RlZmF1bHQ6dGhyb3cgbmV3IFR5cGVFcnJvcigiVW5rbm93biBmbG9hdCB0eXBlOiAiK2UpfX1mdW5jdGlvbiBOdChlLHQscil7c3dpdGNoKHQpe2Nhc2UgMDpyZXR1cm4gcj9mdW5jdGlvbihlKXtyZXR1cm4gUltlXX06ZnVuY3Rpb24oZSl7cmV0dXJuIE9bZV19O2Nhc2UgMTpyZXR1cm4gcj9mdW5jdGlvbihlKXtyZXR1cm4gQ1tlPj4xXX06ZnVuY3Rpb24oZSl7cmV0dXJuIE5bZT4+MV19O2Nhc2UgMjpyZXR1cm4gcj9mdW5jdGlvbihlKXtyZXR1cm4gRltlPj4yXX06ZnVuY3Rpb24oZSl7cmV0dXJuIE1bZT4+Ml19O2RlZmF1bHQ6dGhyb3cgbmV3IFR5cGVFcnJvcigiVW5rbm93biBpbnRlZ2VyIHR5cGU6ICIrZSl9fXZhciBGdD1MKz0xNjt2YXIgTXQ9e307dmFyIEl0PUwrPTE2O0wrPTQ4O2coJHQoIkdNVCIpLCJpOCIsMik7dmFyIEJ0PUwsTHQ9TCs9MTYseHQ9TCs9MTY7ZnVuY3Rpb24ganQoKXtpZighanQuY2FsbGVkKXtqdC5jYWxsZWQ9ITAsRlt4dD4+Ml09NjAqKG5ldyBEYXRlKS5nZXRUaW1lem9uZU9mZnNldCgpO3ZhciBlPW5ldyBEYXRlKDJlMywwLDEpLHQ9bmV3IERhdGUoMmUzLDYsMSk7RltMdD4+Ml09TnVtYmVyKGUuZ2V0VGltZXpvbmVPZmZzZXQoKSE9dC5nZXRUaW1lem9uZU9mZnNldCgpKTt2YXIgcj1hKGUpLG49YSh0KSxvPWcoJHQociksImk4IiwwKSxpPWcoJHQobiksImk4IiwwKTt0LmdldFRpbWV6b25lT2Zmc2V0KCk8ZS5nZXRUaW1lem9uZU9mZnNldCgpPyhGW0J0Pj4yXT1vLEZbQnQrND4+Ml09aSk6KEZbQnQ+PjJdPWksRltCdCs0Pj4yXT1vKX1mdW5jdGlvbiBhKGUpe3ZhciB0PWUudG9UaW1lU3RyaW5nKCkubWF0Y2goL1woKFtBLVphLXogXSspXCkkLyk7cmV0dXJuIHQ/dFsxXToiR01UIn19TCs9MTY7dmFyIFV0PXt9O3ZhciB6dD0xO2Z1bmN0aW9uICR0KGUsdCxyKXt2YXIgbj1yPjA/cjpTKGUpKzEsbz1uZXcgQXJyYXkobiksaT1BKGUsbywwLG8ubGVuZ3RoKTtyZXR1cm4gdCYmKG8ubGVuZ3RoPWkpLG99VGUuc3RhdGljSW5pdCgpLEoudW5zaGlmdCgoZnVuY3Rpb24oKXtvLm5vRlNJbml0fHxUZS5pbml0LmluaXRpYWxpemVkfHxUZS5pbml0KCl9KSksWi5wdXNoKChmdW5jdGlvbigpe1RlLmlnbm9yZVBlcm1pc3Npb25zPSExfSkpLFEucHVzaCgoZnVuY3Rpb24oKXtUZS5xdWl0KCl9KSksSi51bnNoaWZ0KChmdW5jdGlvbigpe3ZlLmluaXQoKX0pKSxRLnB1c2goKGZ1bmN0aW9uKCl7dmUuc2h1dGRvd24oKX0pKSxCZT1vLkludGVybmFsRXJyb3I9SWUoRXJyb3IsIkludGVybmFsRXJyb3IiKSxmdW5jdGlvbigpe2Zvcih2YXIgZT1uZXcgQXJyYXkoMjU2KSx0PTA7dDwyNTY7Kyt0KWVbdF09U3RyaW5nLmZyb21DaGFyQ29kZSh0KTtVZT1lfSgpLCRlPW8uQmluZGluZ0Vycm9yPUllKEVycm9yLCJCaW5kaW5nRXJyb3IiKSxldC5wcm90b3R5cGUuaXNBbGlhc09mPVZlLGV0LnByb3RvdHlwZS5jbG9uZT1HZSxldC5wcm90b3R5cGUuZGVsZXRlPXFlLGV0LnByb3RvdHlwZS5pc0RlbGV0ZWQ9WGUsZXQucHJvdG90eXBlLmRlbGV0ZUxhdGVyPVFlLGd0LnByb3RvdHlwZS5nZXRQb2ludGVlPXV0LGd0LnByb3RvdHlwZS5kZXN0cnVjdG9yPWN0LGd0LnByb3RvdHlwZS5hcmdQYWNrQWR2YW5jZT04LGd0LnByb3RvdHlwZS5yZWFkVmFsdWVGcm9tUG9pbnRlcj1SZSxndC5wcm90b3R5cGUuZGVsZXRlT2JqZWN0PWx0LGd0LnByb3RvdHlwZS5mcm9tV2lyZVR5cGU9RXQsby5nZXRJbmhlcml0ZWRJbnN0YW5jZUNvdW50PWZ0LG8uZ2V0TGl2ZUluaGVyaXRlZEluc3RhbmNlcz1kdCxvLmZsdXNoUGVuZGluZ0RlbGV0ZXM9WmUsby5zZXREZWxheUZ1bmN0aW9uPWh0LHd0PW8uVW5ib3VuZFR5cGVFcnJvcj1JZShFcnJvciwiVW5ib3VuZFR5cGVFcnJvciIpLG8uY291bnRfZW12YWxfaGFuZGxlcz1QdCxvLmdldF9maXJzdF9lbXZhbD1EdCxmdW5jdGlvbiBlKHQpe3ZhciByLG47ZS5jYWxsZWQ/KG49RltGdD4+Ml0scj1GW24+PjJdKTooZS5jYWxsZWQ9ITAsTXQuVVNFUj1NdC5MT0dOQU1FPSJ3ZWJfdXNlciIsTXQuUEFUSD0iLyIsTXQuUFdEPSIvIixNdC5IT01FPSIvaG9tZS93ZWJfdXNlciIsTXQuTEFORz0iQy5VVEYtOCIsTXQuXz1vLnRoaXNQcm9ncmFtLHI9ZigxMDI0KSxuPWYoMjU2KSxGW24+PjJdPXIsRltGdD4+Ml09bik7dmFyIGk9W10sYT0wO2Zvcih2YXIgcyBpbiB0KWlmKCJzdHJpbmciPT10eXBlb2YgdFtzXSl7dmFyIHU9cysiPSIrdFtzXTtpLnB1c2godSksYSs9dS5sZW5ndGh9aWYoYT4xMDI0KXRocm93IG5ldyBFcnJvcigiRW52aXJvbm1lbnQgc2l6ZSBleGNlZWRlZCBUT1RBTF9FTlZfU0laRSEiKTtmb3IodmFyIGM9MDtjPGkubGVuZ3RoO2MrKyl7cmUodT1pW2NdLHIpLEZbbis0KmM+PjJdPXIscis9dS5sZW5ndGgrMX1GW24rNCppLmxlbmd0aD4+Ml09MH0oTXQpLCQ9Zig0KSxqPVU9aChMKSx6PWgoaitHKSxGWyQ+PjJdPXoseD0hMCxvLndhc21UYWJsZVNpemU9MzE2LG8ud2FzbU1heFRhYmxlU2l6ZT0zMTYsby5hc21HbG9iYWxBcmc9e30sby5hc21MaWJyYXJ5QXJnPXthYm9ydDpycixlbmxhcmdlTWVtb3J5OkgsZ2V0VG90YWxNZW1vcnk6ZnVuY3Rpb24oKXtyZXR1cm4gcX0sYWJvcnRPbkNhbm5vdEdyb3dNZW1vcnk6ZnVuY3Rpb24oKXtycigiQ2Fubm90IGVubGFyZ2UgbWVtb3J5IGFycmF5cy4gRWl0aGVyICgxKSBjb21waWxlIHdpdGggIC1zIFRPVEFMX01FTU9SWT1YICB3aXRoIFggaGlnaGVyIHRoYW4gdGhlIGN1cnJlbnQgdmFsdWUgIitxKyIsICgyKSBjb21waWxlIHdpdGggIC1zIEFMTE9XX01FTU9SWV9HUk9XVEg9MSAgd2hpY2ggYWxsb3dzIGluY3JlYXNpbmcgdGhlIHNpemUgYXQgcnVudGltZSwgb3IgKDMpIGlmIHlvdSB3YW50IG1hbGxvYyB0byByZXR1cm4gTlVMTCAoMCkgaW5zdGVhZCBvZiB0aGlzIGFib3J0LCBjb21waWxlIHdpdGggIC1zIEFCT1JUSU5HX01BTExPQz0wICIpfSxpbnZva2VfaTpmdW5jdGlvbihlKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9pKGUpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9paTpmdW5jdGlvbihlLHQpe3RyeXtyZXR1cm4gby5keW5DYWxsX2lpKGUsdCl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX2lpaTpmdW5jdGlvbihlLHQscil7dHJ5e3JldHVybiBvLmR5bkNhbGxfaWlpKGUsdCxyKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfaWlpaTpmdW5jdGlvbihlLHQscixuKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9paWlpKGUsdCxyLG4pfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9paWlpaTpmdW5jdGlvbihlLHQscixuLGkpe3RyeXtyZXR1cm4gby5keW5DYWxsX2lpaWlpKGUsdCxyLG4saSl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX2lpaWlpaWk6ZnVuY3Rpb24oZSx0LHIsbixpLGEscyl7dHJ5e3JldHVybiBvLmR5bkNhbGxfaWlpaWlpaShlLHQscixuLGksYSxzKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfaWlpaWlpaWlpaTpmdW5jdGlvbihlLHQscixuLGksYSxzLHUsYyxsKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9paWlpaWlpaWlpKGUsdCxyLG4saSxhLHMsdSxjLGwpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9paWlpaWlqaWk6ZnVuY3Rpb24oZSx0LHIsbixpLGEscyx1LGMsbCl7dHJ5e3JldHVybiBvLmR5bkNhbGxfaWlpaWlpamlpKGUsdCxyLG4saSxhLHMsdSxjLGwpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9pamo6ZnVuY3Rpb24oZSx0LHIsbixpKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9pamooZSx0LHIsbixpKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2Vfamk6ZnVuY3Rpb24oZSx0KXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9qaShlLHQpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92OmZ1bmN0aW9uKGUpe3RyeXtvLmR5bkNhbGxfdihlKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2Vfdmk6ZnVuY3Rpb24oZSx0KXt0cnl7by5keW5DYWxsX3ZpKGUsdCl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3ZpaTpmdW5jdGlvbihlLHQscil7dHJ5e28uZHluQ2FsbF92aWkoZSx0LHIpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92aWlpOmZ1bmN0aW9uKGUsdCxyLG4pe3RyeXtvLmR5bkNhbGxfdmlpaShlLHQscixuKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfdmlpaWk6ZnVuY3Rpb24oZSx0LHIsbixpKXt0cnl7by5keW5DYWxsX3ZpaWlpKGUsdCxyLG4saSl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3ZpaWlpaTpmdW5jdGlvbihlLHQscixuLGksYSl7dHJ5e28uZHluQ2FsbF92aWlpaWkoZSx0LHIsbixpLGEpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92aWlpaWlpOmZ1bmN0aW9uKGUsdCxyLG4saSxhLHMpe3RyeXtvLmR5bkNhbGxfdmlpaWlpaShlLHQscixuLGksYSxzKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfdmlpaWlpaWlpaTpmdW5jdGlvbihlLHQscixuLGksYSxzLHUsYyxsKXt0cnl7by5keW5DYWxsX3ZpaWlpaWlpaWkoZSx0LHIsbixpLGEscyx1LGMsbCl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3ZpaWlpaWlpaWlpOmZ1bmN0aW9uKGUsdCxyLG4saSxhLHMsdSxjLGwsZil7dHJ5e28uZHluQ2FsbF92aWlpaWlpaWlpaShlLHQscixuLGksYSxzLHUsYyxsLGYpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92aWo6ZnVuY3Rpb24oZSx0LHIsbil7dHJ5e28uZHluQ2FsbF92aWooZSx0LHIsbil9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3Zpamk6ZnVuY3Rpb24oZSx0LHIsbixpKXt0cnl7by5keW5DYWxsX3ZpamkoZSx0LHIsbixpKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxfX19jeGFfYWxsb2NhdGVfZXhjZXB0aW9uOmZ1bmN0aW9uKGUpe3JldHVybiBKdChlKX0sX19fY3hhX2JlZ2luX2NhdGNoOmZ1bmN0aW9uKGUpe3ZhciB0PWRlLmluZm9zW2VdO3JldHVybiB0JiYhdC5jYXVnaHQmJih0LmNhdWdodD0hMCksdCYmKHQucmV0aHJvd249ITEpLGRlLmNhdWdodC5wdXNoKGUpLGRlLmFkZFJlZihkZS5kZUFkanVzdChlKSksZX0sX19fY3hhX2VuZF9jYXRjaDpmdW5jdGlvbigpe28uc2V0VGhyZXcoMCk7dmFyIGU9ZGUuY2F1Z2h0LnBvcCgpO2UmJihkZS5kZWNSZWYoZGUuZGVBZGp1c3QoZSkpLGRlLmxhc3Q9MCl9LF9fX2N4YV9maW5kX21hdGNoaW5nX2NhdGNoXzI6ZnVuY3Rpb24oKXtyZXR1cm4gcGUuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfX19jeGFfZmluZF9tYXRjaGluZ19jYXRjaF8zOmZ1bmN0aW9uKCl7cmV0dXJuIHBlLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX19fY3hhX2ZpbmRfbWF0Y2hpbmdfY2F0Y2hfNDpmdW5jdGlvbigpe3JldHVybiBwZS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9fX2N4YV9mcmVlX2V4Y2VwdGlvbjpoZSxfX19jeGFfdGhyb3c6ZnVuY3Rpb24oZSx0LHIpe3Rocm93IGRlLmluZm9zW2VdPXtwdHI6ZSxhZGp1c3RlZDplLHR5cGU6dCxkZXN0cnVjdG9yOnIscmVmY291bnQ6MCxjYXVnaHQ6ITEscmV0aHJvd246ITF9LGRlLmxhc3Q9ZSxlfSxfX19sb2NrOmZ1bmN0aW9uKCl7fSxfX19tYXBfZmlsZTpmdW5jdGlvbihlLHQpe3JldHVybiB5ZShtZS5FUEVSTSksLTF9LF9fX3Jlc3VtZUV4Y2VwdGlvbjpmdW5jdGlvbihlKXt0aHJvdyBkZS5sYXN0fHwoZGUubGFzdD1lKSxlfSxfX19zZXRFcnJObzp5ZSxfX19zeXNjYWxsMTQwOmZ1bmN0aW9uKGUsdCl7U2UudmFyYXJncz10O3RyeXt2YXIgcj1TZS5nZXRTdHJlYW1Gcm9tRkQoKSxuPShTZS5nZXQoKSxTZS5nZXQoKSksbz1TZS5nZXQoKSxpPVNlLmdldCgpLGE9bjtyZXR1cm4gVGUubGxzZWVrKHIsYSxpKSxGW28+PjJdPXIucG9zaXRpb24sci5nZXRkZW50cyYmMD09PWEmJjA9PT1pJiYoci5nZXRkZW50cz1udWxsKSwwfWNhdGNoKGUpe3JldHVybiB2b2lkIDAhPT1UZSYmZSBpbnN0YW5jZW9mIFRlLkVycm5vRXJyb3J8fHJyKGUpLC1lLmVycm5vfX0sX19fc3lzY2FsbDE0NTpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0U3RyZWFtRnJvbUZEKCksbj1TZS5nZXQoKSxvPVNlLmdldCgpO3JldHVybiBTZS5kb1JlYWR2KHIsbixvKX1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGwxNDY6ZnVuY3Rpb24oZSx0KXtTZS52YXJhcmdzPXQ7dHJ5e3ZhciByPVNlLmdldFN0cmVhbUZyb21GRCgpLG49U2UuZ2V0KCksbz1TZS5nZXQoKTtyZXR1cm4gU2UuZG9Xcml0ZXYocixuLG8pfWNhdGNoKGUpe3JldHVybiB2b2lkIDAhPT1UZSYmZSBpbnN0YW5jZW9mIFRlLkVycm5vRXJyb3J8fHJyKGUpLC1lLmVycm5vfX0sX19fc3lzY2FsbDE4MzpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0KCksbj1TZS5nZXQoKTtpZigwPT09bilyZXR1cm4tbWUuRUlOVkFMO3ZhciBvPVRlLmN3ZCgpO3JldHVybiBuPFMobykrMT8tbWUuRVJBTkdFOihUKG8scixuKSxyKX1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGwxOTg6ZnVuY3Rpb24oZSx0KXtTZS52YXJhcmdzPXQ7dHJ5e3ZhciByPVNlLmdldFN0cigpLG49U2UuZ2V0KCksbz1TZS5nZXQoKTtyZXR1cm4gVGUuY2hvd24ocixuLG8pLDB9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgMCE9PVRlJiZlIGluc3RhbmNlb2YgVGUuRXJybm9FcnJvcnx8cnIoZSksLWUuZXJybm99fSxfX19zeXNjYWxsMjA6ZnVuY3Rpb24oZSx0KXtTZS52YXJhcmdzPXQ7dHJ5e3JldHVybiBrZX1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGw2OmZ1bmN0aW9uKGUsdCl7U2UudmFyYXJncz10O3RyeXt2YXIgcj1TZS5nZXRTdHJlYW1Gcm9tRkQoKTtyZXR1cm4gVGUuY2xvc2UociksMH1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGw2MDpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0KCksbj1TZS51bWFzaztyZXR1cm4gU2UudW1hc2s9cixufWNhdGNoKGUpe3JldHVybiB2b2lkIDAhPT1UZSYmZSBpbnN0YW5jZW9mIFRlLkVycm5vRXJyb3J8fHJyKGUpLC1lLmVycm5vfX0sX19fc3lzY2FsbDgzOmZ1bmN0aW9uKGUsdCl7U2UudmFyYXJncz10O3RyeXt2YXIgcj1TZS5nZXRTdHIoKSxuPVNlLmdldFN0cigpO3JldHVybiBUZS5zeW1saW5rKHIsbiksMH1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGw5MTpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0KCksbj1TZS5nZXQoKSxvPVNlLm1hcHBpbmdzW3JdO2lmKCFvKXJldHVybiAwO2lmKG49PT1vLmxlbil7dmFyIGk9VGUuZ2V0U3RyZWFtKG8uZmQpO1NlLmRvTXN5bmMocixpLG4sby5mbGFncyksVGUubXVubWFwKGkpLFNlLm1hcHBpbmdzW3JdPW51bGwsby5hbGxvY2F0ZWQmJkt0KG8ubWFsbG9jKX1yZXR1cm4gMH1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3VubG9jazpmdW5jdGlvbigpe30sX19lbWJpbmRfZmluYWxpemVfdmFsdWVfb2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0PVBlW2VdO2RlbGV0ZSBQZVtlXTt2YXIgcj10LnJhd0NvbnN0cnVjdG9yLG49dC5yYXdEZXN0cnVjdG9yLG89dC5maWVsZHM7eGUoW2VdLG8ubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXR0ZXJSZXR1cm5UeXBlfSkpLmNvbmNhdChvLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2V0dGVyQXJndW1lbnRUeXBlfSkpKSwoZnVuY3Rpb24oZSl7dmFyIGk9e307cmV0dXJuIG8uZm9yRWFjaCgoZnVuY3Rpb24odCxyKXt2YXIgbj10LmZpZWxkTmFtZSxhPWVbcl0scz10LmdldHRlcix1PXQuZ2V0dGVyQ29udGV4dCxjPWVbcitvLmxlbmd0aF0sbD10LnNldHRlcixmPXQuc2V0dGVyQ29udGV4dDtpW25dPXtyZWFkOmZ1bmN0aW9uKGUpe3JldHVybiBhLmZyb21XaXJlVHlwZShzKHUsZSkpfSx3cml0ZTpmdW5jdGlvbihlLHQpe3ZhciByPVtdO2woZixlLGMudG9XaXJlVHlwZShyLHQpKSxEZShyKX19fSkpLFt7bmFtZTp0Lm5hbWUsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKGUpe3ZhciB0PXt9O2Zvcih2YXIgciBpbiBpKXRbcl09aVtyXS5yZWFkKGUpO3JldHVybiBuKGUpLHR9LHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG8gaW4gaSlpZighKG8gaW4gdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiTWlzc2luZyBmaWVsZCIpO3ZhciBhPXIoKTtmb3IobyBpbiBpKWlbb10ud3JpdGUoYSx0W29dKTtyZXR1cm4gbnVsbCE9PWUmJmUucHVzaChuLGEpLGF9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6UmUsZGVzdHJ1Y3RvckZ1bmN0aW9uOm59XX0pKX0sX19lbWJpbmRfcmVnaXN0ZXJfYm9vbDpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWplKHIpO1llKGUse25hbWU6dD16ZSh0KSxmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7cmV0dXJuISFlfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/bjpvfSxhcmdQYWNrQWR2YW5jZTo4LHJlYWRWYWx1ZUZyb21Qb2ludGVyOmZ1bmN0aW9uKGUpe3ZhciBuO2lmKDE9PT1yKW49UjtlbHNlIGlmKDI9PT1yKW49QztlbHNle2lmKDQhPT1yKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gYm9vbGVhbiB0eXBlIHNpemU6ICIrdCk7bj1GfXJldHVybiB0aGlzLmZyb21XaXJlVHlwZShuW2U+PmldKX0sZGVzdHJ1Y3RvckZ1bmN0aW9uOm51bGx9KX0sX19lbWJpbmRfcmVnaXN0ZXJfY2xhc3M6ZnVuY3Rpb24oZSx0LHIsbixpLGEscyx1LGMsbCxmLGQsaCl7Zj16ZShmKSxhPXZ0KGksYSksdSYmKHU9dnQocyx1KSksbCYmKGw9dnQoYyxsKSksaD12dChkLGgpO3ZhciBwPUZlKGYpOyFmdW5jdGlvbihlLHQscil7by5oYXNPd25Qcm9wZXJ0eShlKT8oKHZvaWQgMD09PXJ8fHZvaWQgMCE9PW9bZV0ub3ZlcmxvYWRUYWJsZSYmdm9pZCAwIT09b1tlXS5vdmVybG9hZFRhYmxlW3JdKSYmV2UoIkNhbm5vdCByZWdpc3RlciBwdWJsaWMgbmFtZSAnIitlKyInIHR3aWNlIikscnQobyxlLGUpLG8uaGFzT3duUHJvcGVydHkocikmJldlKCJDYW5ub3QgcmVnaXN0ZXIgbXVsdGlwbGUgb3ZlcmxvYWRzIG9mIGEgZnVuY3Rpb24gd2l0aCB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzICgiK3IrIikhIiksb1tlXS5vdmVybG9hZFRhYmxlW3JdPXQpOihvW2VdPXQsdm9pZCAwIT09ciYmKG9bZV0ubnVtQXJndW1lbnRzPXIpKX0ocCwoZnVuY3Rpb24oKXtidCgiQ2Fubm90IGNvbnN0cnVjdCAiK2YrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIsW25dKX0pKSx4ZShbZSx0LHJdLG4/W25dOltdLChmdW5jdGlvbih0KXt2YXIgcixpO3Q9dFswXSxpPW4/KHI9dC5yZWdpc3RlcmVkQ2xhc3MpLmluc3RhbmNlUHJvdG90eXBlOmV0LnByb3RvdHlwZTt2YXIgcz1NZShwLChmdW5jdGlvbigpe2lmKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSE9PWMpdGhyb3cgbmV3ICRlKCJVc2UgJ25ldycgdG8gY29uc3RydWN0ICIrZik7aWYodm9pZCAwPT09ZC5jb25zdHJ1Y3Rvcl9ib2R5KXRocm93IG5ldyAkZShmKyIgaGFzIG5vIGFjY2Vzc2libGUgY29uc3RydWN0b3IiKTt2YXIgZT1kLmNvbnN0cnVjdG9yX2JvZHlbYXJndW1lbnRzLmxlbmd0aF07aWYodm9pZCAwPT09ZSl0aHJvdyBuZXcgJGUoIlRyaWVkIHRvIGludm9rZSBjdG9yIG9mICIrZisiIHdpdGggaW52YWxpZCBudW1iZXIgb2YgcGFyYW1ldGVycyAoIithcmd1bWVudHMubGVuZ3RoKyIpIC0gZXhwZWN0ZWQgKCIrT2JqZWN0LmtleXMoZC5jb25zdHJ1Y3Rvcl9ib2R5KS50b1N0cmluZygpKyIpIHBhcmFtZXRlcnMgaW5zdGVhZCEiKTtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KSksYz1PYmplY3QuY3JlYXRlKGkse2NvbnN0cnVjdG9yOnt2YWx1ZTpzfX0pO3MucHJvdG90eXBlPWM7dmFyIGQ9bmV3IG50KGYscyxjLGgscixhLHUsbCksbT1uZXcgZ3QoZixkLCEwLCExLCExKSx5PW5ldyBndChmKyIqIixkLCExLCExLCExKSxFPW5ldyBndChmKyIgY29uc3QqIixkLCExLCEwLCExKTtyZXR1cm4gdHRbZV09e3BvaW50ZXJUeXBlOnksY29uc3RQb2ludGVyVHlwZTpFfSxmdW5jdGlvbihlLHQscil7by5oYXNPd25Qcm9wZXJ0eShlKXx8TGUoIlJlcGxhY2luZyBub25leGlzdGFudCBwdWJsaWMgc3ltYm9sIiksdm9pZCAwIT09b1tlXS5vdmVybG9hZFRhYmxlJiZ2b2lkIDAhPT1yP29bZV0ub3ZlcmxvYWRUYWJsZVtyXT10OihvW2VdPXQsb1tlXS5hcmdDb3VudD1yKX0ocCxzKSxbbSx5LEVdfSkpfSxfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19jb25zdHJ1Y3RvcjpmdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGE9QXQodCxyKTtvPXZ0KG4sbykseGUoW10sW2VdLChmdW5jdGlvbihlKXt2YXIgcj0iY29uc3RydWN0b3IgIisoZT1lWzBdKS5uYW1lO2lmKHZvaWQgMD09PWUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHkmJihlLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5PVtdKSx2b2lkIDAhPT1lLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5W3QtMV0pdGhyb3cgbmV3ICRlKCJDYW5ub3QgcmVnaXN0ZXIgbXVsdGlwbGUgY29uc3RydWN0b3JzIHdpdGggaWRlbnRpY2FsIG51bWJlciBvZiBwYXJhbWV0ZXJzICgiKyh0LTEpKyIpIGZvciBjbGFzcyAnIitlLm5hbWUrIichIE92ZXJsb2FkIHJlc29sdXRpb24gaXMgY3VycmVudGx5IG9ubHkgcGVyZm9ybWVkIHVzaW5nIHRoZSBwYXJhbWV0ZXIgY291bnQsIG5vdCBhY3R1YWwgdHlwZSBpbmZvISIpO3JldHVybiBlLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5W3QtMV09ZnVuY3Rpb24oKXtidCgiQ2Fubm90IGNvbnN0cnVjdCAiK2UubmFtZSsiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIixhKX0seGUoW10sYSwoZnVuY3Rpb24obil7cmV0dXJuIGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHlbdC0xXT1mdW5jdGlvbigpe2FyZ3VtZW50cy5sZW5ndGghPT10LTEmJldlKHIrIiBjYWxsZWQgd2l0aCAiK2FyZ3VtZW50cy5sZW5ndGgrIiBhcmd1bWVudHMsIGV4cGVjdGVkICIrKHQtMSkpO3ZhciBlPVtdLGE9bmV3IEFycmF5KHQpO2FbMF09aTtmb3IodmFyIHM9MTtzPHQ7KytzKWFbc109bltzXS50b1dpcmVUeXBlKGUsYXJndW1lbnRzW3MtMV0pO3ZhciB1PW8uYXBwbHkobnVsbCxhKTtyZXR1cm4gRGUoZSksblswXS5mcm9tV2lyZVR5cGUodSl9LFtdfSkpLFtdfSkpfSxfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19mdW5jdGlvbjpmdW5jdGlvbihlLHQscixuLG8saSxhLHMpe3ZhciB1PUF0KHIsbik7dD16ZSh0KSxpPXZ0KG8saSkseGUoW10sW2VdLChmdW5jdGlvbihlKXt2YXIgbj0oZT1lWzBdKS5uYW1lKyIuIit0O2Z1bmN0aW9uIG8oKXtidCgiQ2Fubm90IGNhbGwgIituKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLHUpfXMmJmUucmVnaXN0ZXJlZENsYXNzLnB1cmVWaXJ0dWFsRnVuY3Rpb25zLnB1c2godCk7dmFyIGM9ZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUsbD1jW3RdO3JldHVybiB2b2lkIDA9PT1sfHx2b2lkIDA9PT1sLm92ZXJsb2FkVGFibGUmJmwuY2xhc3NOYW1lIT09ZS5uYW1lJiZsLmFyZ0NvdW50PT09ci0yPyhvLmFyZ0NvdW50PXItMixvLmNsYXNzTmFtZT1lLm5hbWUsY1t0XT1vKToocnQoYyx0LG4pLGNbdF0ub3ZlcmxvYWRUYWJsZVtyLTJdPW8pLHhlKFtdLHUsKGZ1bmN0aW9uKG8pe3ZhciBzPVR0KG4sbyxlLGksYSk7cmV0dXJuIHZvaWQgMD09PWNbdF0ub3ZlcmxvYWRUYWJsZT8ocy5hcmdDb3VudD1yLTIsY1t0XT1zKTpjW3RdLm92ZXJsb2FkVGFibGVbci0yXT1zLFtdfSkpLFtdfSkpfSxfX2VtYmluZF9yZWdpc3Rlcl9lbXZhbDpmdW5jdGlvbihlLHQpe1llKGUse25hbWU6dD16ZSh0KSxmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7dmFyIHQ9a3RbZV0udmFsdWU7cmV0dXJuIGZ1bmN0aW9uKGUpe2U+NCYmMD09LS1rdFtlXS5yZWZjb3VudCYmKGt0W2VdPXZvaWQgMCxTdC5wdXNoKGUpKX0oZSksdH0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe3JldHVybiBSdCh0KX0sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpSZSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9mbG9hdDpmdW5jdGlvbihlLHQscil7dmFyIG49amUocik7WWUoZSx7bmFtZTp0PXplKHQpLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gZX0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgdCYmImJvb2xlYW4iIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCAiJytPdCh0KSsnIiB0byAnK3RoaXMubmFtZSk7cmV0dXJuIHR9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6Q3QodCxuKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9pbnRlZ2VyOmZ1bmN0aW9uKGUsdCxyLG4sbyl7dD16ZSh0KSwtMT09PW8mJihvPTQyOTQ5NjcyOTUpO3ZhciBpPWplKHIpLGE9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9O2lmKDA9PT1uKXt2YXIgcz0zMi04KnI7YT1mdW5jdGlvbihlKXtyZXR1cm4gZTw8cz4+PnN9fXZhciB1PS0xIT10LmluZGV4T2YoInVuc2lnbmVkIik7WWUoZSx7bmFtZTp0LGZyb21XaXJlVHlwZTphLHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSxyKXtpZigibnVtYmVyIiE9dHlwZW9mIHImJiJib29sZWFuIiE9dHlwZW9mIHIpdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgIicrT3QocikrJyIgdG8gJyt0aGlzLm5hbWUpO2lmKHI8bnx8cj5vKXRocm93IG5ldyBUeXBlRXJyb3IoJ1Bhc3NpbmcgYSBudW1iZXIgIicrT3QocikrJyIgZnJvbSBKUyBzaWRlIHRvIEMvQysrIHNpZGUgdG8gYW4gYXJndW1lbnQgb2YgdHlwZSAiJyt0KyciLCB3aGljaCBpcyBvdXRzaWRlIHRoZSB2YWxpZCByYW5nZSBbJytuKyIsICIrbysiXSEiKTtyZXR1cm4gdT9yPj4+MDowfHJ9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6TnQodCxpLDAhPT1uKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9tZW1vcnlfdmlldzpmdW5jdGlvbihlLHQscil7dmFyIG49W0ludDhBcnJheSxVaW50OEFycmF5LEludDE2QXJyYXksVWludDE2QXJyYXksSW50MzJBcnJheSxVaW50MzJBcnJheSxGbG9hdDMyQXJyYXksRmxvYXQ2NEFycmF5XVt0XTtmdW5jdGlvbiBvKGUpe3ZhciB0PU0scj10W2U+Pj0yXSxvPXRbZSsxXTtyZXR1cm4gbmV3IG4odC5idWZmZXIsbyxyKX1ZZShlLHtuYW1lOnI9emUociksZnJvbVdpcmVUeXBlOm8sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpvfSx7aWdub3JlRHVwbGljYXRlUmVnaXN0cmF0aW9uczohMH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9zdGRfc3RyaW5nOmZ1bmN0aW9uKGUsdCl7WWUoZSx7bmFtZTp0PXplKHQpLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9TVtlPj4yXSxyPW5ldyBBcnJheSh0KSxuPTA7bjx0OysrbilyW25dPVN0cmluZy5mcm9tQ2hhckNvZGUoT1tlKzQrbl0pO3JldHVybiBLdChlKSxyLmpvaW4oIiIpfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gcihlLHQpe3JldHVybiBlW3RdfXZhciBuO3QgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmKHQ9bmV3IFVpbnQ4QXJyYXkodCkpLHQgaW5zdGFuY2VvZiBVaW50OEFycmF5fHx0IGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQ4QXJyYXk/bj1yOiJzdHJpbmciPT10eXBlb2YgdD9uPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuY2hhckNvZGVBdCh0KX06V2UoIkNhbm5vdCBwYXNzIG5vbi1zdHJpbmcgdG8gc3RkOjpzdHJpbmciKTt2YXIgbz10Lmxlbmd0aCxpPUp0KDQrbyk7TVtpPj4yXT1vO2Zvcih2YXIgYT0wO2E8bzsrK2Epe3ZhciBzPW4odCxhKTtzPjI1NSYmKEt0KGkpLFdlKCJTdHJpbmcgaGFzIFVURi0xNiBjb2RlIHVuaXRzIHRoYXQgZG8gbm90IGZpdCBpbiA4IGJpdHMiKSksT1tpKzQrYV09c31yZXR1cm4gbnVsbCE9PWUmJmUucHVzaChLdCxpKSxpfSxhcmdQYWNrQWR2YW5jZTo4LHJlYWRWYWx1ZUZyb21Qb2ludGVyOlJlLGRlc3RydWN0b3JGdW5jdGlvbjpmdW5jdGlvbihlKXtLdChlKX19KX0sX19lbWJpbmRfcmVnaXN0ZXJfc3RkX3dzdHJpbmc6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG87cj16ZShyKSwyPT09dD8obj1mdW5jdGlvbigpe3JldHVybiBOfSxvPTEpOjQ9PT10JiYobj1mdW5jdGlvbigpe3JldHVybiBNfSxvPTIpLFllKGUse25hbWU6cixmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PW4oKSxyPU1bZT4+Ml0saT1uZXcgQXJyYXkociksYT1lKzQ+Pm8scz0wO3M8cjsrK3MpaVtzXT1TdHJpbmcuZnJvbUNoYXJDb2RlKHRbYStzXSk7cmV0dXJuIEt0KGUpLGkuam9pbigiIil9LHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSxyKXt2YXIgaT1uKCksYT1yLmxlbmd0aCxzPUp0KDQrYSp0KTtNW3M+PjJdPWE7Zm9yKHZhciB1PXMrND4+byxjPTA7YzxhOysrYylpW3UrY109ci5jaGFyQ29kZUF0KGMpO3JldHVybiBudWxsIT09ZSYmZS5wdXNoKEt0LHMpLHN9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6UmUsZGVzdHJ1Y3RvckZ1bmN0aW9uOmZ1bmN0aW9uKGUpe0t0KGUpfX0pfSxfX2VtYmluZF9yZWdpc3Rlcl92YWx1ZV9vYmplY3Q6ZnVuY3Rpb24oZSx0LHIsbixvLGkpe1BlW2VdPXtuYW1lOnplKHQpLHJhd0NvbnN0cnVjdG9yOnZ0KHIsbikscmF3RGVzdHJ1Y3Rvcjp2dChvLGkpLGZpZWxkczpbXX19LF9fZW1iaW5kX3JlZ2lzdGVyX3ZhbHVlX29iamVjdF9maWVsZDpmdW5jdGlvbihlLHQscixuLG8saSxhLHMsdSxjKXtQZVtlXS5maWVsZHMucHVzaCh7ZmllbGROYW1lOnplKHQpLGdldHRlclJldHVyblR5cGU6cixnZXR0ZXI6dnQobixvKSxnZXR0ZXJDb250ZXh0Omksc2V0dGVyQXJndW1lbnRUeXBlOmEsc2V0dGVyOnZ0KHMsdSksc2V0dGVyQ29udGV4dDpjfSl9LF9fZW1iaW5kX3JlZ2lzdGVyX3ZvaWQ6ZnVuY3Rpb24oZSx0KXtZZShlLHtpc1ZvaWQ6ITAsbmFtZTp0PXplKHQpLGFyZ1BhY2tBZHZhbmNlOjAsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKCl7fSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7fX0pfSxfYWJvcnQ6ZnVuY3Rpb24oKXtvLmFib3J0KCl9LF9lbXNjcmlwdGVuX21lbWNweV9iaWc6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBPLnNldChPLnN1YmFycmF5KHQsdCtyKSxlKSxlfSxfZ2V0ZW52OmZ1bmN0aW9uIGUodCl7cmV0dXJuIDA9PT10PzA6KHQ9dih0KSxNdC5oYXNPd25Qcm9wZXJ0eSh0KT8oZS5yZXQmJkt0KGUucmV0KSxlLnJldD0ocj1NdFt0XSxuPVMocikrMSwobz1KdChuKSkmJkEocixSLG8sbiksbykpOjApO3ZhciByLG4sb30sX2dldGdybmFtOmZ1bmN0aW9uKCl7by5wcmludEVycigibWlzc2luZyBmdW5jdGlvbjogZ2V0Z3JuYW0iKSxycigtMSl9LF9nZXRwd25hbTpmdW5jdGlvbigpe3Rocm93ImdldHB3bmFtOiBUT0RPIn0sX2pzQ2xvc2U6ZnVuY3Rpb24oKXtyZXR1cm4gYS5jbG9zZS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9qc0NyZWF0ZTpmdW5jdGlvbihlKXtyZXR1cm4gYS5jcmVhdGUuY2FsbChudWxsLGsoZSkpfSxfanNPcGVuOmZ1bmN0aW9uKGUpe3JldHVybiBhLm9wZW4uY2FsbChudWxsLGsoZSkpfSxfanNSZWFkOmZ1bmN0aW9uKCl7cmV0dXJuIGEucmVhZC5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9qc1NlZWs6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBhLnNlZWsuY2FsbChudWxsLGUsdCxiKHIpKX0sX2pzVGVsbDpmdW5jdGlvbigpe3JldHVybiBhLnRlbGwuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfanNXcml0ZTpmdW5jdGlvbigpe3JldHVybiBhLndyaXRlLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX2xsdm1fZWhfdHlwZWlkX2ZvcjpmdW5jdGlvbihlKXtyZXR1cm4gZX0sX2xvY2FsdGltZTpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oZSx0KXtqdCgpO3ZhciByPW5ldyBEYXRlKDFlMypGW2U+PjJdKTtGW3Q+PjJdPXIuZ2V0U2Vjb25kcygpLEZbdCs0Pj4yXT1yLmdldE1pbnV0ZXMoKSxGW3QrOD4+Ml09ci5nZXRIb3VycygpLEZbdCsxMj4+Ml09ci5nZXREYXRlKCksRlt0KzE2Pj4yXT1yLmdldE1vbnRoKCksRlt0KzIwPj4yXT1yLmdldEZ1bGxZZWFyKCktMTkwMCxGW3QrMjQ+PjJdPXIuZ2V0RGF5KCk7dmFyIG49bmV3IERhdGUoci5nZXRGdWxsWWVhcigpLDAsMSksbz0oci5nZXRUaW1lKCktbi5nZXRUaW1lKCkpLzg2NGU1fDA7Rlt0KzI4Pj4yXT1vLEZbdCszNj4+Ml09LTYwKnIuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgaT1uZXcgRGF0ZSgyZTMsNiwxKS5nZXRUaW1lem9uZU9mZnNldCgpLGE9bi5nZXRUaW1lem9uZU9mZnNldCgpLHM9MHwoaSE9YSYmci5nZXRUaW1lem9uZU9mZnNldCgpPT1NYXRoLm1pbihhLGkpKTtGW3QrMzI+PjJdPXM7dmFyIHU9RltCdCsocz80OjApPj4yXTtyZXR1cm4gRlt0KzQwPj4yXT11LHR9KGUsSXQpfSxfbWt0aW1lOmZ1bmN0aW9uKGUpe2p0KCk7dmFyIHQ9bmV3IERhdGUoRltlKzIwPj4yXSsxOTAwLEZbZSsxNj4+Ml0sRltlKzEyPj4yXSxGW2UrOD4+Ml0sRltlKzQ+PjJdLEZbZT4+Ml0sMCkscj1GW2UrMzI+PjJdLG49dC5nZXRUaW1lem9uZU9mZnNldCgpLG89bmV3IERhdGUodC5nZXRGdWxsWWVhcigpLDAsMSksaT1uZXcgRGF0ZSgyZTMsNiwxKS5nZXRUaW1lem9uZU9mZnNldCgpLGE9by5nZXRUaW1lem9uZU9mZnNldCgpLHM9TWF0aC5taW4oYSxpKTtpZihyPDApRltlKzMyPj4yXT1OdW1iZXIoaSE9YSYmcz09bik7ZWxzZSBpZihyPjAhPShzPT1uKSl7dmFyIHU9TWF0aC5tYXgoYSxpKSxjPXI+MD9zOnU7dC5zZXRUaW1lKHQuZ2V0VGltZSgpKzZlNCooYy1uKSl9RltlKzI0Pj4yXT10LmdldERheSgpO3ZhciBsPSh0LmdldFRpbWUoKS1vLmdldFRpbWUoKSkvODY0ZTV8MDtyZXR1cm4gRltlKzI4Pj4yXT1sLHQuZ2V0VGltZSgpLzFlM3wwfSxfcHRocmVhZF9nZXRzcGVjaWZpYzpmdW5jdGlvbihlKXtyZXR1cm4gVXRbZV18fDB9LF9wdGhyZWFkX2tleV9jcmVhdGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gMD09ZT9tZS5FSU5WQUw6KEZbZT4+Ml09enQsVXRbenRdPTAsenQrKywwKX0sX3B0aHJlYWRfb25jZTpmdW5jdGlvbiBlKHQscil7ZS5zZWVufHwoZS5zZWVuPXt9KSx0IGluIGUuc2Vlbnx8KG8uZHluQ2FsbF92KHIpLGUuc2Vlblt0XT0xKX0sX3B0aHJlYWRfc2V0c3BlY2lmaWM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSBpbiBVdD8oVXRbZV09dCwwKTptZS5FSU5WQUx9LF90aW1lOmZ1bmN0aW9uKGUpe3ZhciB0PURhdGUubm93KCkvMWUzfDA7cmV0dXJuIGUmJihGW2U+PjJdPXQpLHR9LERZTkFNSUNUT1BfUFRSOiQsU1RBQ0tUT1A6VX07dmFyIFd0PW8uYXNtKG8uYXNtR2xvYmFsQXJnLG8uYXNtTGlicmFyeUFyZyxEKTtvLmFzbT1XdDt2YXIgWXQ9by5fX0dMT0JBTF9fc3ViX0lfYmluZF9jcHA9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uX19HTE9CQUxfX3N1Yl9JX2JpbmRfY3BwLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnQ9by5fX0dMT0JBTF9fc3ViX0lfYnJpZGdlX2NwcD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fX0dMT0JBTF9fc3ViX0lfYnJpZGdlX2NwcC5hcHBseShudWxsLGFyZ3VtZW50cyl9LEh0PW8uX19HTE9CQUxfX3N1Yl9JX2NyY19jcHA9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uX19HTE9CQUxfX3N1Yl9JX2NyY19jcHAuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHdD1vLl9fR0xPQkFMX19zdWJfSV9nbG9iYWxfY3BwPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9fR0xPQkFMX19zdWJfSV9nbG9iYWxfY3BwLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scXQ9KG8uX19fY3hhX2Nhbl9jYXRjaD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fX19jeGFfY2FuX2NhdGNoLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5fX19jeGFfaXNfcG9pbnRlcl90eXBlPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9fX2N4YV9pc19wb2ludGVyX3R5cGUuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLl9fX2Vycm5vX2xvY2F0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9fX2Vycm5vX2xvY2F0aW9uLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5fX19nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fX19nZXRUeXBlTmFtZS5hcHBseShudWxsLGFyZ3VtZW50cyl9KSxYdD1vLl9lbXNjcmlwdGVuX3JlcGxhY2VfbWVtb3J5PWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9lbXNjcmlwdGVuX3JlcGxhY2VfbWVtb3J5LmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS3Q9by5fZnJlZT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fZnJlZS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEp0PW8uX21hbGxvYz1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fbWFsbG9jLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnQ9by5zZXRUZW1wUmV0MD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5zZXRUZW1wUmV0MC5hcHBseShudWxsLGFyZ3VtZW50cyl9LFF0PShvLnNldFRocmV3PWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLnNldFRocmV3LmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5zdGFja0FsbG9jPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLnN0YWNrQWxsb2MuYXBwbHkobnVsbCxhcmd1bWVudHMpfSk7by5keW5DYWxsX2RpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2RpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9pPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5keW5DYWxsX2lpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpaWlpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5keW5DYWxsX2lpaWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaWlpPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWlpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaWlpaWlpPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWlpaWlpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaWlqaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF9paWlpaWlqaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfaWpqPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWpqLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5keW5DYWxsX2ppPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfamkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdj1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3YuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF92aWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpZD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWQuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF92aWlpaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWlpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWlpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWlpaWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWlpaWlpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWlpaWlpaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWlpaWlpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF92aWo9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWouYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlqaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpamkuYXBwbHkobnVsbCxhcmd1bWVudHMpfTtmdW5jdGlvbiBlcihlKXt0aGlzLm5hbWU9IkV4aXRTdGF0dXMiLHRoaXMubWVzc2FnZT0iUHJvZ3JhbSB0ZXJtaW5hdGVkIHdpdGggZXhpdCgiK2UrIikiLHRoaXMuc3RhdHVzPWV9ZnVuY3Rpb24gdHIoZSl7ZnVuY3Rpb24gdCgpe28uY2FsbGVkUnVufHwoby5jYWxsZWRSdW49ITAsbXx8KHRlfHwodGU9ITAsWChKKSksWChaKSxvLm9uUnVudGltZUluaXRpYWxpemVkJiZvLm9uUnVudGltZUluaXRpYWxpemVkKCksZnVuY3Rpb24oKXtpZihvLnBvc3RSdW4pZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBvLnBvc3RSdW4mJihvLnBvc3RSdW49W28ucG9zdFJ1bl0pO28ucG9zdFJ1bi5sZW5ndGg7KWU9by5wb3N0UnVuLnNoaWZ0KCksZWUudW5zaGlmdChlKTt2YXIgZTtYKGVlKX0oKSkpfXNlPjB8fCghZnVuY3Rpb24oKXtpZihvLnByZVJ1bilmb3IoImZ1bmN0aW9uIj09dHlwZW9mIG8ucHJlUnVuJiYoby5wcmVSdW49W28ucHJlUnVuXSk7by5wcmVSdW4ubGVuZ3RoOyllPW8ucHJlUnVuLnNoaWZ0KCksSy51bnNoaWZ0KGUpO3ZhciBlO1goSyl9KCksc2U+MHx8by5jYWxsZWRSdW58fChvLnNldFN0YXR1cz8oby5zZXRTdGF0dXMoIlJ1bm5pbmcuLi4iKSxzZXRUaW1lb3V0KChmdW5jdGlvbigpe3NldFRpbWVvdXQoKGZ1bmN0aW9uKCl7by5zZXRTdGF0dXMoIiIpfSksMSksdCgpfSksMSkpOnQoKSkpfWZ1bmN0aW9uIHJyKGUpe3Rocm93IG8ub25BYm9ydCYmby5vbkFib3J0KGUpLHZvaWQgMCE9PWU/KG8ucHJpbnQoZSksby5wcmludEVycihlKSxlPUpTT04uc3RyaW5naWZ5KGUpKTplPSIiLG09ITAsImFib3J0KCIrZSsiKS4gQnVpbGQgd2l0aCAtcyBBU1NFUlRJT05TPTEgZm9yIG1vcmUgaW5mby4ifWlmKG8uYXNtPVd0LGVyLnByb3RvdHlwZT1uZXcgRXJyb3IsZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yPWVyLHVlPWZ1bmN0aW9uIGUoKXtvLmNhbGxlZFJ1bnx8dHIoKSxvLmNhbGxlZFJ1bnx8KHVlPWUpfSxvLnJ1bj10cixvLmV4aXQ9ZnVuY3Rpb24oZSx0KXt0JiZvLm5vRXhpdFJ1bnRpbWUmJjA9PT1lfHwoby5ub0V4aXRSdW50aW1lfHwobT0hMCxVPXZvaWQgMCxYKFEpLG8ub25FeGl0JiZvLm9uRXhpdChlKSksbCYmcHJvY2Vzcy5leGl0KGUpLG8ucXVpdChlLG5ldyBlcihlKSkpfSxvLmFib3J0PXJyLG8ucHJlSW5pdClmb3IoImZ1bmN0aW9uIj09dHlwZW9mIG8ucHJlSW5pdCYmKG8ucHJlSW5pdD1bby5wcmVJbml0XSk7by5wcmVJbml0Lmxlbmd0aD4wOylvLnByZUluaXQucG9wKCkoKTtyZXR1cm4gby5ub0V4aXRSdW50aW1lPSEwLHRyKCksdH07ZnVuY3Rpb24gaSh7cmVzb3VyY2VJZDplLHVybDp0fSl7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihlLG8pe2lmKCFyKXRocm93IG5ldyBFcnJvcigidW5wYWNrQnJpZGdlIG5vdCBkZXRlY3RlZCIpO2lmKCFuKXRocm93IG5ldyBFcnJvcigidW5wYWNrIG5vdCBkZXRlY3RlZCIpOyhmdW5jdGlvbihlKXtyZXR1cm4gZmV0Y2gobmV3IFJlcXVlc3QoZSkpLnRoZW4oZT0+e2lmKGUub2spcmV0dXJuIGUuYXJyYXlCdWZmZXIoKTt0aHJvdyBuZXcgRXJyb3IoIjQwNCBFcnJvcjogRmlsZSBub3QgZm91bmQuIil9KS50aGVuKGU9PnIuY3JlYXRlRXh0cmFjdG9yRnJvbURhdGEoZSkpfSkodCkudGhlbih0PT57ZSh0LmV4dHJhY3RBbGwoKSl9LGU9PntvKGUpfSl9KSl9ZnVuY3Rpb24gYShlLHQpe2NvbnN0W3Isbl09dDtpZigiRkFJTCI9PXIuc3RhdGUpe2NvbnN0IHQ9e3R5cGU6IkVSUk9SIixyZWFzb246ci5yZWFzb24sbXNnOnIubXNnLHJlc291cmNlSWQ6ZS5kYXRhLnJlc291cmNlSWQsdXJsOmUuZGF0YS51cmx9O3JldHVybiB2b2lkIHNlbGYucG9zdE1lc3NhZ2UodCl9Y29uc3Qgbz17dHlwZToiRklOSVNIRUQiLHJlc291cmNlSWQ6ZS5kYXRhLnJlc291cmNlSWQsZW50cmllczp7fX0saT1bXTtpZihuJiZuLmZpbGVzKWZvcihjb25zdCBlIG9mIG4uZmlsZXMpby5lbnRyaWVzW2UuZmlsZUhlYWRlci5uYW1lXT1lLmV4dHJhY3RbMV0saS5wdXNoKGUuZXh0cmFjdFsxXS5idWZmZXIpO3NlbGYucG9zdE1lc3NhZ2UobyxpKX1vbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7aWYoImluaXQiPT1lLmRhdGEudHlwZSluPW8oZS5kYXRhLndhc21VcmwpLG4ub25SdW50aW1lSW5pdGlhbGl6ZWQ9KCk9PnBvc3RNZXNzYWdlKHt0eXBlOiJXQVNNX0xPQURFRCJ9KTtlbHNlIGlmKCJmZXRjaCI9PWUuZGF0YS50eXBlKWkoZS5kYXRhKS50aGVuKHQ9PnthKGUsdCl9LHQ9Pntjb25zdCByPXt0eXBlOiJFUlJPUiIscmVzb3VyY2VJZDplLmRhdGEucmVzb3VyY2VJZCx1cmw6ZS5kYXRhLnVybH07c2VsZi5wb3N0TWVzc2FnZShyKX0pO2Vsc2UgaWYoInVucGFjayI9PWUuZGF0YS50eXBlKXtjb25zdHtidWZmZXI6dH09ZS5kYXRhO2lmKCFyKXRocm93IG5ldyBFcnJvcigidW5wYWNrQnJpZGdlIG5vdCBkZXRlY3RlZCIpO2lmKCFuKXRocm93IG5ldyBFcnJvcigidW5wYWNrIG5vdCBkZXRlY3RlZCIpO2NvbnN0IG89ci5jcmVhdGVFeHRyYWN0b3JGcm9tRGF0YSh0KS5leHRyYWN0QWxsKCk7YShlLG8pfX07Cgo=",null,!1);function me(t){return t&&"object"==typeof t&&!Array.isArray(t)}function ue(t,...e){if(!e.length)return t;const i=e.shift();if(me(t)&&me(i))for(const n in i)me(i[n])?(t[n]||Object.assign(t,{[n]:{}}),ue(t[n],i[n])):Object.assign(t,{[n]:i[n]});return ue(t,...e)}const be=new class extends Y{constructor(){let t;super(),this.__totalWork=0,this.__totalWorkByCategory={},this.__doneWork=0,this.__doneWorkByCategory={},this.__resourceRegisterCallbacks={},this.__callbacks={},this.__resources={},this.__resourcesTreeEntities={},this.__resourcesTree={children:{}},this.__workers=[],this.__nextWorker=0;const e=document.getElementsByTagName("script");for(let i=0;i<e.length;i++){const n=e[i];if(n.src.includes("zea-engine")){const e=n.src.split("/");e.pop(),e.pop(),t=e.join("/");break}}t||(t="https://unpkg.com/@zeainc/zea-engine@0.1.3"),this.wasmUrl=t+"/public-resources/unpack.wasm",this.addResourceURL("ZeaEngine/Vive.vla",t+"/public-resources/Vive.vla"),this.addResourceURL("ZeaEngine/Oculus.vla",t+"/public-resources/Oculus.vla")}getRootFolder(){return this.__resourcesTree}registerResourceCallback(t,e){this.__resourceRegisterCallbacks[t]=e;for(const i in this.__resources){const n=this.__resources[i];n.name.includes(t)&&e(n)}}__applyCallbacks(t){const e=t=>{for(const e in this.__resourceRegisterCallbacks)t.name.includes(e)&&this.__resourceRegisterCallbacks[e](t)};for(const i in t){const n=t[i];n.url&&e(n)}}__buildTree(t){const e=i=>{if(this.__resourcesTreeEntities[i])return;const n=t[i];n.id=i,"folder"!==n.type&&"dependency"!==n.type||(n.children={}),n.parent&&(this.__resourcesTreeEntities[n.parent]||e(n.parent)),(n.parent?this.__resourcesTreeEntities[n.parent]:this.__resourcesTree).children[n.name]=n,this.__resourcesTreeEntities[i]=n};for(const i in t)e(i)}setResources(t){this.__resources=Object.assign(this.__resources,t),this.__buildTree(t),this.__applyCallbacks(t)}addResourceURL(t,e){const i=t.split("/"),n=i.pop();if(!e){let n=window.location.href.split("#")[0];n=n.split("?")[0],(n.endsWith(".html")||n.endsWith(".html"))&&(n=n.substring(0,n.lastIndexOf("/"))+"/");const s=n;if("."==i[0])i.shift();else if(".."==i[0]){item=item.substring(3);const t=s.split("/");t.pop(),t.pop(),s=t.join("/")+"/"}e=s+t}let s;const o={};for(const l of i){const t=m$2(l);t in this.__resources||(this.__resources[t]={name:l,type:"folder",parent:s},o[t]=this.__resources[t]),s=t}const r=m$2(n),a={name:n,url:e,parent:s,id:r};this.__resources[r]=a,o[r]=a,this.__buildTree(o),this.__applyCallbacks(o)}updateFile(t){const e=!(t.id in this.__resources);if(this.__resources[t.id]=t,e){console.log("New file added");const e={};e[t.id]=t,this.__buildTree(e)}this.emit("fileUpdated",{fileId:t.id})}freeData(t){}__getWorker(){return this.__nextWorker=(this.__nextWorker+1)%3,null==this.__workers[this.__nextWorker]&&(this.__workers[this.__nextWorker]=(()=>new Promise(t=>{const e=new ce;e.postMessage({type:"init",wasmUrl:this.wasmUrl}),e.onmessage=i=>{if("WASM_LOADED"===i.data.type)t(e);else if("FINISHED"===i.data.type)this.addWorkDone(i.data.resourceId,1),this.__onFinishedReceiveFileData(i.data);else if("ERROR"===i.data.type){const t=i.data,e=this.__resources[t.resourceId];console.error("Unable to load Resource:",e?e.name:t.resourceId," With url:",t.url)}}}))()),this.__workers[this.__nextWorker]}__terminateWorkers(){for(const t of this.__workers)t.terminate();this.__workers=[]}getFilepath(t){let e=this.__resources[t];const i=[e.name];for(;e.parent;)e=this.__resources[e.parent],i.splice(0,0,e.name);return i.join("/")}resourceAvailable(t){return t.indexOf(".")>0?(console.warn("Deprecation warning for resourceAvailable. Value should be a file id, not a path."),null!=this.resolveFilepath(t)):t in this.__resources}getFile(t){return this.__resources[t]}resolveFilePathToId(t){if(!t)return void console.warn("Invalid file path:",t);const e=this.resolveFilepath(t);return e?e.id:void 0}resolveFilepath(t){const e=t.split("/");"."!=e[0]&&""!=e[0]||e.shift();let i=this.__resourcesTree;for(const n of e){if(!(n in i.children))return console.warn("Unable to resolve key:"+n+" of path:"+t),null;i=i.children[n]}return i}resolveFile(t){return console.warn("Deprecation warning for resolveFile. Use resolveFilepath."),this.resolveFilepath(t)}resolveURL(t){console.warn("Deprecation warning for resolveURL. Use resolveFilepath.");const e=this.resolveFilepath(t);if(e)return e.url}addWork(t,e){this.__totalWork+=e,this.emit("progressIncremented",{percent:this.__doneWork/this.__totalWork*100})}addWorkDone(t,e){if(this.__doneWork+=e,this.emit("progressIncremented",{percent:this.__doneWork/this.__totalWork*100}),this.__doneWork>this.__totalWork)throw new Error("Mismatch between work loaded and work done.");this.__doneWork==this.__totalWork&&this.emit("allResourcesLoaded",{})}loadResource(t,e,i=!0){const n=this.getFile(t);if(!n)throw new Error("Invalid resource Id:'"+t+"' not found in Resources:"+JSON.stringify(this.__resources,null,2));this.loadUrl(t,n.url,e,i)}loadURL(t,e,i,n=!0){return console.warn("Please call loadUrl instead,"),this.loadUrl(t,e,i,n)}loadUrl(t,e,i,n=!0){n&&this.addWork(t,3),t in this.__callbacks||(this.__callbacks[t]=[]),this.__callbacks[t].push(i),fetch(e).then(t=>function(t){if(!t.ok)throw new Error(`HTTP ${t.status} - ${t.statusText}`);return t}(t)&&t.arrayBuffer()).then(e=>{this.__getWorker().then(i=>{i.postMessage({type:"unpack",resourceId:t,buffer:e})})})}unpackBuffer(t,e,i,n=!0){return new Promise(s=>{n&&this.addWork(t,3),t in this.__callbacks||(this.__callbacks[t]=[]),i&&this.__callbacks[t].push(i),this.__callbacks[t].push(t=>{s(t)}),this.__getWorker().then(i=>{i.postMessage({type:"unpack",resourceId:t,buffer:e},[e])})})}__onFinishedReceiveFileData(t){const e=t.resourceId;this.addWorkDone(e,1);const i=this.__callbacks[e];if(i){for(const e of i)e(t.entries);delete this.__callbacks[e]}this.emit("loaded",{resourceId:e}),this.addWorkDone(e,1)}suspend(){this.__terminateWorkers()}traverse(t){const e=t=>{for(const e in t.children)i(t.children[e])},i=i=>{if(0==t(i))return!1;i.children&&e(i)};e(this.__resourcesTree)}};class pe{constructor(t){if(t){const e=t.split("-"),i=e[0].split(".");this.major=parseInt(i[0]),this.minor=parseInt(i[1]),this.patch=parseInt(i[2]),2==e.length&&(this.branch=e[1])}else this.major=0,this.minor=0,this.patch=0}compare(t){const e=[this.major,this.minor,this.patch];for(let i=0;i<3;i++)if(e[i]!==t[i])return e[i]-t[i];return 0}equals(t){return!(this.patch==t[2]&&this.minor==t[1]&&this.major==t[0])}lessThan(t){return!(this.major>=t[0]||this.minor>=t[1]||this.patch>=t[2])}greaterThan(t){return this.major>t[0]||this.minor>t[1]||this.patch>t[2]}greaterOrEqualThan(t){return!(this.major<t[0]||!(this.major>t[0])&&(this.minor<t[1]||!(this.minor>t[1])&&this.patch<t[2]))}}class ge{constructor(t,e=0,i=!0){this.__data=t,this.__byteOffset=e,this.__dataView=new DataView(this.__data),this.__isMobileDevice=i,this.utf8decoder=new TextDecoder}get isMobileDevice(){return this.__isMobileDevice}get data(){return this.__data}get byteLength(){return this.__dataView.byteLength}get remainingByteLength(){return this.__dataView.byteLength-this.__byteOffset}pos(){return this.__byteOffset}seek(t){this.__byteOffset=t}advance(t){this.__byteOffset+=t}loadUInt8(){const t=this.__dataView.getUint8(this.__byteOffset);return this.__byteOffset+=1,t}loadUInt16(){const t=this.__dataView.getUint16(this.__byteOffset,!0);return this.__byteOffset+=2,t}loadUInt32(){const t=this.__dataView.getUint32(this.__byteOffset,!0);return this.__byteOffset+=4,t}loadSInt32(){const t=this.__dataView.getInt32(this.__byteOffset,!0);return this.__byteOffset+=4,t}loadFloat16(){const t=this.loadUInt16();return Math.decode16BitFloat(t)}loadUFloat16(){const t=this.loadFloat16();return t<0?2048-t:t}loadFloat16From2xUInt8(){const t=this.__dataView.getFloat16(this.__byteOffset,!0);return this.__byteOffset+=2,t}loadUInt32From2xUFloat16(){return this.loadUFloat16()+4096*this.loadUFloat16()}loadSInt32From2xFloat16(){return this.loadFloat16()+2048*this.loadFloat16()}loadFloat32(){const t=this.__dataView.getFloat32(this.__byteOffset,!0);return this.__byteOffset+=4,t}loadUInt8Array(t,e=!1){null==t&&(t=this.loadUInt32());const i=new Uint8Array(this.__data,this.__byteOffset,t);return this.__byteOffset+=t,i}loadUInt16Array(t,e=!1){if(null==t&&(t=this.loadUInt32()),0==t)return new Uint16Array;let i;if(this.readPadd(2),this.__isMobileDevice){i=new Uint16Array(t);for(let e=0;e<t;e++)i[e]=this.__dataView.getUint16(this.__byteOffset,!0),this.__byteOffset+=2}else i=new Uint16Array(this.__data,this.__byteOffset,t),this.__byteOffset+=2*t;return i}loadUInt32Array(t,e=!1){if(null==t&&(t=this.loadUInt32()),0==t)return new Uint32Array;let i;if(this.readPadd(4),this.__isMobileDevice){i=new Uint32Array(t);for(let e=0;e<t;e++)i[e]=this.__dataView.getUint32(this.__byteOffset,!0),this.__byteOffset+=4}else i=new Uint32Array(this.__data,this.__byteOffset,t),this.__byteOffset+=4*t;return i}loadFloat32Array(t,e=!1){if(null==t&&(t=this.loadUInt32()),0==t)return new Float32Array;let i;if(this.readPadd(4),this.__isMobileDevice){i=new Float32Array(t);for(let e=0;e<t;e++)i[e]=this.__dataView.getFloat32(this.__byteOffset,!0),this.__byteOffset+=4}else i=new Float32Array(this.__data,this.__byteOffset,t),this.__byteOffset+=4*t;return i}loadStr(){const t=this.loadUInt32(),e=new Uint8Array(this.__data,this.__byteOffset,t);return this.__byteOffset+=t,this.utf8decoder.decode(e)}loadStrArray(){const t=this.loadUInt32(),e=[];for(let i=0;i<t;i++)e[i]=this.loadStr();return e}loadSInt32Vec2(){const t=this.loadSInt32(),e=this.loadSInt32();return new _(t,e)}loadUInt32Vec2(){const t=this.loadUInt32(),e=this.loadUInt32();return new _(t,e)}loadFloat16Vec2(){const t=this.loadFloat16(),e=this.loadFloat16();return new _(t,e)}loadFloat32Vec2(){const t=this.loadFloat32(),e=this.loadFloat32();return new _(t,e)}loadFloat16Vec3(){const t=this.loadFloat16(),e=this.loadFloat16(),i=this.loadFloat16();return new Z(t,e,i)}loadFloat32Vec3(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32();return new Z(t,e,i)}loadFloat16Quat(){const t=this.loadFloat16(),e=this.loadFloat16(),i=this.loadFloat16(),n=this.loadFloat16();return new x(t,e,i,n)}loadFloat32Quat(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32(),n=this.loadFloat32();return new x(t,e,i,n)}loadRGBFloat32Color(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32();return new y$2(t,e,i)}loadRGBAFloat32Color(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32(),n=this.loadFloat32();return new y$2(t,e,i,n)}loadRGBUInt8Color(){const t=this.loadUInt8(),e=this.loadUInt8(),i=this.loadUInt8();return new y$2(t/255,e/255,i/255)}loadRGBAUInt8Color(){const t=this.loadUInt8(),e=this.loadUInt8(),i=this.loadUInt8(),n=this.loadUInt8();return new y$2(t/255,e/255,i/255,n/255)}loadBox2(){return new L(this.loadFloat32Vec2(),this.loadFloat32Vec2())}loadBox3(){return new v(this.loadFloat32Vec3(),this.loadFloat32Vec3())}readPadd(t){const e=this.__byteOffset%t;0!=e&&(this.__byteOffset+=t-e)}}class _e{constructor(t=0){this.__data=new ArrayBuffer(t),this.__byteOffset=0,this.__reserved=t,this.__dataView=new DataView(this.__data)}pos(){return this.__byteOffset}seek(t){this.__byteOffset=t}seekEnd(){this.__byteOffset=this.__reserved}getBuffer(){return this.__data.byteLength==this.__byteOffset?this.__data:new Uint8Array(this.__data).slice(0,this.__byteOffset).buffer}__grow(){const t=2*(this.__reserved>0?this.__reserved:1),e=new ArrayBuffer(t),i=new Uint8Array(e),n=new Uint8Array(this.__data);i.set(n),this.__data=e,this.__dataView=new DataView(this.__data),this.__reserved=t}__reserve(t){this.__byteOffset+t>this.__reserved&&this.__grow()}__offset(t){this.__byteOffset+=t,this.__byteOffset>this.__reserved&&this.__grow()}writeUInt8(t){this.__reserve(1),this.__dataView.setUint8(this.__byteOffset,t),this.__offset(1)}writeUInt16(t){this.__reserve(2),this.__dataView.setUint16(this.__byteOffset,t,!0),this.__offset(2)}writeUInt32(t){this.__reserve(4),this.__dataView.setUint32(this.__byteOffset,t,!0),this.__offset(4)}writeSInt32(t){this.__reserve(4),this.__dataView.setInt32(this.__byteOffset,t,!0),this.__offset(4)}writeFloat16(t){const e=Math.encode16BitFloat(t);this.writeUInt16(e)}writeFloat32(t){this.__reserve(4),this.__dataView.setFloat32(this.__byteOffset,t,!0),this.__offset(4)}writeUInt8Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeUInt8(t[n])}writeUInt16Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(2*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeUInt16(t[n])}writeUInt32Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(4*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeUInt32(t[n])}writeFloat32Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(4*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeFloat32(t[n])}writeStr(t,e=!0){const i=value.length;this.__reserve(4*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeFloat32(value.charCodeAt(n))}writeSInt32Vec2(t){this.writeSInt32(t.x),this.writeSInt32(t.y)}writeUInt32Vec2(t){this.writeUInt32(t.x),this.writeUInt32(t.y)}writeFloat16Vec2(t){this.writeFloat16(t.x),this.writeFloat16(t.y)}writeFloat32Vec2(t){this.writeFloat32(t.x),this.writeFloat32(t.y)}writeFloat16Vec3(t){this.writeFloat16(t.x),this.writeFloat16(t.y),this.writeFloat16(t.z)}writeFloat32Vec3(t){this.writeFloat32(t.x),this.writeFloat32(t.y),this.writeFloat32(t.z)}writeFloat16Quat(t){this.writeFloat16(t.x),this.writeFloat16(t.y),this.writeFloat16(t.z),this.writeFloat16(t.w)}writeFloat32Quat(t){this.writeFloat32(t.x),this.writeFloat32(t.y),this.writeFloat32(t.z),this.writeFloat32(t.w)}writeRGBFloat32Color(t){this.writeFloat32(t.r),this.writeFloat32(t.g),this.writeFloat32(t.b)}writeRGBAFloat32Color(t){this.writeFloat32(t.r),this.writeFloat32(t.g),this.writeFloat32(t.b),this.writeFloat32(t.a)}writeRGBUInt8Color(t){this.writeUInt8(t.r),this.writeUInt8(t.g),this.writeUInt8(t.b)}writeRGBAUInt8Color(t){this.writeUInt8(t.r),this.writeUInt8(t.g),this.writeUInt8(t.b),this.writeUInt8(t.a)}writeBox2(t){this.writeFloat32Vec2(t.p0),this.writeFloat32Vec2(t.p1)}writeBox3(t){this.writeFloat32Vec3(t.p0),this.writeFloat32Vec3(t.p1)}writePadd(t){const e=t-this.__byteOffset;this.__reserve(e),this.__offset(e)}writeAlignment(t){const e=this.__byteOffset%t;0!=e&&(this.__reserve(t-e),this.__offset(t-e))}}class Ze extends Q{constructor(t,e=0,i,n){super(t,e,"Number"),i&&!Array.isArray(i)&&console.error("Range value must be an array of 2 numbers."),this.__range=i,this.__step=n}setValue(t,e){e==E.USER_SETVALUE&&(this.__range&&(t=Math.clamp(t,this.__range[0],this.__range[1])),this.__step&&(t=Math.round(t/this.__step)*this.__step)),super.setValue(t,e)}getValue(t){return super.getValue(t)}getRange(){return this.__range}setRange(t){return this.__range=t,this}getStep(){return this.__step}setStep(t){return this.__step=t,this}toJSON(t,e){const i=super.toJSON(t,e);return this.__range&&(i.range=this.__range),this.__step&&(i.step=this.__step),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.range&&(this.__range=t.range),t.step&&(this.__step=t.step)}readBinary(t,e){const i=t.loadFloat32();this.setValue(i,E.DATA_LOAD)}clone(t){const e=new Ze(this.__name,this.__value);return e.__range=this.__range,e.__step=this.__step,e}}J.registerClass("NumberParameter",Ze),J.registerClass("Property_SInt32",Ze),J.registerClass("Property_UInt32",Ze),J.registerClass("Property_Float32",Ze);class Ge extends Ze{constructor(t,e,i){super(t,e,[0,i.length],1),this.choices=i}getChoices(){return this.choices}setValue(t,e){super.setValue("string"==typeof t?this.choices.indexOf(t):t,e)}}class Xe extends Q{constructor(t,e){super(t,e,"Boolean")}clone(t){return new Xe(this.__name,this.__value)}}J.registerClass("BooleanParameter",Xe);class ye extends Q{constructor(t,e,i){super(t,e||new _,"Vec2"),this.__range=i}getRange(){return this.__range}__setRange(t){this.__range=t,this.emit("rangeChanged",{range:t})}clone(t){return new ye(this.__name,this.__value.clone())}}class fe extends Q{constructor(t,e,i){super(t,e||new Z,"Vec3")}clone(t){return new fe(this.__name,this.__value.clone())}}class Ve extends Q{constructor(t,e){super(t,e||new G,"Vec4")}clone(t){return new Ve(this.__name,this.__value.clone())}}class Ie extends Q{constructor(t,e){super(t,e||new y$2,"Color")}readBinary(t,e){const i=t.loadRGBAFloat32Color();i.applyGamma(2.2),this.setValue(i,E.DATA_LOAD)}clone(t){return new Ie(this.__name,this.__value.clone())}}J.registerClass("ColorParameter",Ie);class xe extends Q{constructor(t,e){super(t,e||new V,"Mat3")}clone(t){return new xe(this.__name,this.__value.clone())}}class Re extends Q{constructor(t,e){super(t,e||new I,"Mat4")}clone(t){return new Re(this.__name,this.__value.clone())}}class Se extends Q{constructor(t,e){super(t,e||new S,"Xfo")}clone(t){return new Se(this.__name,this.__value.clone())}}class Le extends Q{constructor(t,e){super(t,e,"BaseImage")}toJSON(t,e){const i=super.toJSON(t,e);return this.__value&&(i.imageType=J.getClassName(this.__value)),i}fromJSON(t,e,i){return t.imageType&&(this.__value=J.constructClass(t.imageType)),super.fromJSON(t,e,i)}clone(t){return new Le(this.__name,this.__value)}}class We extends Q{constructor(t,e=""){super(t,e,"String"),this.multiLine=!1}setMultiLine(t){this.multiLine=t}getMultiLine(){return this.multiLine}readBinary(t,e){const i=t.loadStr();this.setValue(i,E.DATA_LOAD)}clone(t){return new We(this.__name,this.__value)}}J.registerClass("StringParameter",We),J.registerClass("Property_String",We);class ve extends We{constructor(t,e=""){super(t,e,"String"),this.lang="js"}setLanguage(t){this.lang=t}getLanguage(){return this.lang}clone(t){return new ve(this.__name,this.__value)}}J.registerClass("CodeParameter",ve);class Te extends Q{constructor(t,e){super(t,"","FilePath"),e&&this.setSupportedExts(e)}setSupportedExts(t){this.__reextensions=new RegExp("\\.("+t+")$","i")}getFilepath(){return this.__file?be.getFilepath(this.__file.id):""}setFilepath(t,e){const i=be.resolveFilePathToId(t);i?this.setValue(i,e):console.warn("Resource unavailable:"+t)}getFilename(){if(this.__file)return this.__file.name}getExt(){const t=this.getFilename(),e=t.lastIndexOf(".");if(-1!=e)return t.substring(e).toLowerCase()}getStem(){const t=this.getFilename();if(t){const e=t.split(".");return 2==e.length?e[0]:t}}getFileFolder(){if(this.__file)return this.__file.parent?be.getFile(this.__file.parent):be.getRootFolder()}getFileFolderPath(){const t=this.getFilepath();if(t)return t.substring(0,t.lastIndexOf("/"))+"/"}getFile(){return this.__file}getFileDesc(){return this.__file}setUrl(t,e,i=E.USER_SETVALUE){const n=t.split("/");e||(e=n[n.length-1]),this.__value=e,this.__file={id:t,name:e,url:t},i!=E.USER_SETVALUE&&i!=E.REMOTEUSER_SETVALUE||(this.__flags|=H.USER_EDITED),this.emit("valueChanged",{mode:i})}getUrl(){return this.__file?this.__file.url:void 0}setDirty(t){throw new Error("Cannot drive a filepath param from an oporator")}setValue(t,e=E.USER_SETVALUE){if(null==t)throw new Error("Invalid value for setValue.");if(t.indexOf(".")>0)return console.warn("Deprecation warning for setValue. setValue should now only take a file id, not a path."),this.setFilepath(t,e);if(t==this.__value)return;const i=t;if(!be.resourceAvailable(i))return void console.warn("Resource unavailable:"+i);const n=be.getFile(i);if(this.__reextensions&&!this.__reextensions.test(n.name))return console.warn("Unsupported file type:"+n.name),!1;this.__value=t,this.__file=n,be.addListener("fileUpdated",t=>{t.fileId==this.__value&&(this.__file=be.getFile(this.__value),this.emit("fileUpdated",t))}),e==E.USER_SETVALUE&&(this.__flags|=H.USER_EDITED),this.emit("valueChanged",{mode:e})}toJSON(t,e){if(0==(this.__flags&H.USER_EDITED))return;const i={};return this.__file&&(i.value=this.__file.id,i.filepath=be.getFilepath(this.__file.id)),i}fromJSON(t,e,i){if(t.value){if(t.value.indexOf(".")>0)return void this.setFilepath(t.value,E.DATA_LOAD);if(be.resourceAvailable(t.value))return this.setValue(t.value,E.DATA_LOAD),void(this.__flags|=H.USER_EDITED)}if(t.filepath){const e=be.resolveFilePathToId(t.filepath);if(e)return void this.setValue(e,E.DATA_LOAD);console.warn("Resource unavailable:"+t.filepath)}}clone(t){const e=new Te(this.__name);return e.__file=this.__file,e}destroy(){super.destroy()}}class Fe extends Q{constructor(t,e){super(t,[]),this.__dataType=e}__filter(t){return!0}getCount(){return this.__value.length}getElement(t){return this.__value[t]}setElement(t,e){this.__value[t]=e,this.emit("valueChanged",{mode:E.USER_SETVALUE})}addElement(t){if(null==t)t=new this.__dataType;else if(!this.__filter(t))return;return this.__value.push(t),this.__flags|=H.USER_EDITED,this.emit("elementAdded",{elem:t,index:this.__value.length-1}),this.emit("valueChanged",{mode:E.USER_SETVALUE}),t}removeElement(t){const e=this.__value[t];this.__value.splice(t,1),this.__flags|=H.USER_EDITED,this.emit("elementRemoved",{elem:e,index:t}),this.emit("valueChanged",{mode:E.USER_SETVALUE})}insertElement(t,e){this.__filter(e)&&(this.__value.splice(t,0,e),this.__flags|=H.USER_EDITED,this.emit("elementAdded",{elem:e,index:t}),this.emit("valueChanged",{mode:E.USER_SETVALUE}))}toJSON(t,e){if(0==(this.__flags&H.USER_EDITED))return;const i=[];for(const n of this.__value)i.push("string"==typeof this.__dataType?n:n.toJSON(t,e));return{items:i}}fromJSON(t,e,i){if(null!=t.items){this.__flags|=H.USER_EDITED,this.__value=[];for(let i=0;i<t.items.length;i++){let n;"string"==typeof this.__dataType?n=t.items[i]:(n=new this.__dataType,n.fromJSON(t.items[i],e)),this.__value.push(n),this.emit("elementAdded",{elem:n,index:this.__value.length-1})}this.emit("valueChanged",{mode:E.DATA_LOAD})}else console.warn("Invalid Parameter JSON")}clone(t){const e=this.__value.slice(0),i=new Fe(this.__name,this.__dataType);return i.setValue(e),i}destroy(){for(let t=0;t<this.__value.length;t++)this.__value[t]instanceof Q&&this.__value[t].destroy(),this.removeElement(t)}}class Me extends Q{constructor(t){super(t,{},"Struct"),this.__members=[]}_addMember(t){return this.__value[t.getName()]=t.getValue(),t.addListener("valueChanged",()=>{this.__value[t.getName()]=t.getValue()}),this.__members.push(t),this.__flags|=H.USER_EDITED,this.emit("valueChanged",{}),t}getParameter(t){for(const e of this.__members)if(e.getName()==t)return e}getMember(t){return this.getParameter(t)}getMemberNames(){const t=[];for(let e=0;e<this.__members.length;e++){const i=this.__members[e];null!=i&&(t[e]=i.getName())}return t}toJSON(t,e){if(0==(this.__flags&H.USER_EDITED))return;const i=[];for(const n of this.__members)i.push(n.toJSON(t,e));return{members:i}}fromJSON(t,e,i){if(null!=t.members){this.__flags|=H.USER_EDITED;for(let i=0;i<t.members.length;i++)t.members[i]&&this.__members[i].fromJSON(t.members[i],e)}else console.warn("Invalid Parameter JSON")}destroy(){super.destroy();for(const t of this.__members)t.destroy()}}class Ye extends Q{constructor(t,e){super(t,void 0,"TreeItem"),this.__filterFn=e,this.__emittreeItemGlobalXfoChanged=this.__emittreeItemGlobalXfoChanged.bind(this)}__emittreeItemGlobalXfoChanged(t){this.emit("treeItemGlobalXfoChanged",t)}setOwner(t){this.__owner=t}getOwner(){return this.__owner}setFilterFn(){this.__filterFn=filterFn}getFilterFn(){return this.__filterFn}setValue(t,e=E.USER_SETVALUE){if(this.__filterFn&&!this.__filterFn(t))return!1;this.__value!==t&&(this.__value&&this.__value.removeListener("globalXfoChanged",this.__emittreeItemGlobalXfoChanged),this.__value=t,this.__value&&this.__value.addListener("globalXfoChanged",this.__emittreeItemGlobalXfoChanged),e!=E.USER_SETVALUE&&e!=E.REMOTEUSER_SETVALUE||(this.__flags|=H.USER_EDITED),this.emit("valueChanged",{mode:e}))}toJSON(t,e){if(0!=(this.__flags&H.USER_EDITED))return{value:t.makeRelative(this.__value.getPath())}}fromJSON(t,e,i){null!=t.value?(e.resolvePath(t.value,t=>{this.setValue(t)},()=>{console.warn("Unable to resolve tree item parameter value:"+pj.paramPath)}),this.__flags|=H.USER_EDITED):console.warn("Invalid Parameter JSON")}clone(t){return new Ye(this.__name,this.__filterFn)}destroy(){this.__value&&this.__value.removeListener("globalXfoChanged",this.__emittreeItemGlobalXfoChanged)}}class Ce extends Q{constructor(t,e){super(t,void 0,"BaseItem"),this.__items=new Set,this.__filterFn=e}setFilterFn(t){this.__filterFn=t}getFilterFn(){return this.__filterFn}getItem(t){return Array.from(this.__items)[t]}addItem(t,e=!0){if(this.__filterFn&&!this.__filterFn(t))return console.warn("ItemSet __filterFn rejecting item:",t.getPath()),!1;this.__items.add(t);const i=Array.from(this.__items).indexOf(t);return this.emit("itemAdded",{item:t,index:i}),e&&this.emit("valueChanged",{}),i}addItems(t,e=!0){t.forEach(t=>this.addItem(t,!1)),e&&this.emit("valueChanged",{})}removeItem(t,e=!0){const i=Array.from(this.__items)[t];return this.__items.delete(i),this.emit("itemRemoved",{item:i,index:t}),e&&this.emit("valueChanged",{}),i}setItems(t,e=!0){for(let i=this.__items.length-1;i>=0;i--){const e=this.__items[i];t.has(e)||this.removeItem(e,!1)}for(const i of t)this.__items.has(i)||this.addItem(i,!1);e&&this.emit("valueChanged",{})}clearItems(t=!0){this.__items.clear(),t&&this.emit("valueChanged",{})}getNumItems(){return Array.from(this.__items).length}getValue(){return this.__items}toJSON(t,e){return{}}fromJSON(t,e,i){}clone(t){return new Ce(this.__name,this.__filterFn)}}class Ne extends Q{constructor(t,e){super(t,void 0,e.getDataType()),this.setSourceParameter(e)}setSourceParameter(t){this.sourceParameter=t,this.sourceParameter.addListener("valueChanged",this.__proxyValueChanged.bind(this))}__proxyValueChanged(t){this.emit("valueChanged",{mode:t})}getDataType(){return this.sourceParameter.getDataType()}setValue(t,e){}getValue(t){return this.sourceParameter.getValue(t)}toJSON(t,e){const i=super.toJSON(t,e);return this.sourceParameter&&(i.sourceParameter=this.sourceParameter.getPath()),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.sourceParameter&&e.resolvePath(t.sourceParameter,t=>{this.setSourceParameter(t)},()=>{console.warn("Error loading Proxy Param: '"+this.getName()+"'. Unable to connect to:"+t.sourceParameter)}),t.range&&(this.sourceParameter=t.range),t.step&&(this.__step=t.step)}clone(t,e){const i=new Ne(this.__name,this.__value);return this.sourceParameter&&this.connectToClonedSourceParam(e),i}connectToClonedSourceParam(t){t.resolveClonedItem(this.sourceParameter,t=>{clonedParam.setSourceParameter(t)},()=>{console.warn("Error cloning Proxy Param: '"+this.getName()+"'. Unable to connect to:"+j.sourceParameter)})}}J.registerClass("ProxyParameter",Ne);class Ke extends Q{constructor(t,e){super(t,void 0,"Geometry"),this.setValue(e),this.__emitboundingBoxDirtied=this.__emitboundingBoxDirtied.bind(this)}__emitboundingBoxDirtied(t){this.emit("boundingBoxChanged",t)}setValue(t,e=E.USER_SETVALUE){this.__value!==t&&(this.__value&&this.__value.removeListener("boundingBoxChanged",this.__emitboundingBoxDirtied),this.__value=t,this.__value&&this.__value.addListener("boundingBoxChanged",this.__emitboundingBoxDirtied),e!=E.USER_SETVALUE&&e!=E.REMOTEUSER_SETVALUE||(this.__flags|=H.USER_EDITED),e!=E.OPERATOR_SETVALUE&&this.emit("valueChanged",{mode:e}))}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){return super.fromJSON(t,e,i)}clone(t){return new Ke(this.__name,this.__value)}destroy(){this.__value&&this.__value.removeListener("boundingBoxChanged",this.__emitboundingBoxDirtied)}}class we extends te{constructor(t){super(t),this.width=0,this.height=0,this.format="RGB",this.type="UNSIGNED_BYTE",this.addParameter(new Xe("AlphaFromLuminance",!1)),this.addParameter(new Xe("Invert",!1)),this.addParameter(new Xe("FlipY",!1)),this.on("parameterValueChanged",()=>{this.emit("updated")}),this.loaded=!1}isLoaded(){return!0}getMapping(){return this.__mapping}setMapping(t){this.__mapping=t}isStream(){return!1}isStreamAtlas(){return this.__streamAtlas}getParams(){return{type:this.type,format:this.format,width:this.width,height:this.height,flipY:this.getParameter("FlipY").getValue(),invert:this.getParameter("Invert").getValue(),alphaFromLuminance:this.getParameter("AlphaFromLuminance").getValue()}}}class ze extends Ze{constructor(t,e,i){super(t,e,i)}getImage(){return this.__image}setImage(t,e=0){const i=()=>{this.emit("textureDisconnected",{})};t?(null!=this.__image&&this.__image!==t&&i(),this.__image=t,this.emit("textureConnected",{}),this.emit("valueChanged",{mode:e})):null!=this.__image&&(i(),this.__image=void 0,this.emit("textureDisconnected",{}))}setValue(t){t instanceof we?this.setImage(t):(null!=this.__image&&this.setImage(void 0),super.setValue(t))}readBinary(t,e){super.readBinary(t,e);const i=t.loadStr();""!=i&&(console.log("Load Texture"),this.setImage(e.materialLibrary.getImage(i)))}clone(t){return new ze(this.__name,this.__value.clone())}}J.registerClass("MaterialFloatParam",ze);class Ue extends Ie{constructor(t,e){super(t,e),this.__imageUpdated=this.__imageUpdated.bind(this)}getImage(){return this.__image}__imageUpdated(){this.emit("valueChanged",{})}setImage(t,e=0){const i=()=>{this.__image.removeListener("loaded",this.__imageUpdated),this.__image.removeListener("updated",this.__imageUpdated),this.__image=null,this.emit("textureDisconnected",{})};t?(null!=this.__image&&this.__image!==t&&i(),this.__image=t,this.__image.addListener("updated",this.__imageUpdated),this.emit("textureConnected",{}),this.emit("valueChanged",{mode:e})):null!=this.__image&&(i(),this.__image=void 0,this.emit("textureDisconnected",{}))}setValue(t){t instanceof we?this.setImage(t):(null!=this.__image&&this.setImage(void 0),super.setValue(t))}readBinary(t,e){super.readBinary(t,e);const i=t.loadStr();""!=i&&this.setImage(e.materialLibrary.getImage(i))}clone(t){return new Ue(this.__name,this.__value.clone())}}J.registerClass("MaterialColorParam",Ue);const Je=(t,e,i,n)=>"boolean"==typeof e||!1===e||!0===e?new Q(t,e,"Boolean"):"string"==typeof e?new Q(t,e,"String"):Number.isNumeric(e)?n?new ze(t,e,i):new Ze(t,e,i):e instanceof _?new ye(t,e):e instanceof Z?new fe(t,e):e instanceof y$2?n?new Ue(t,e):new Ie(t,e):new Q(t,e);class Pe extends te{constructor(t,e){super(t),this.visibleInGeomDataBuffer=!0,e&&this.setShaderName(e)}getShaderName(){return this.__shaderName}setShaderName(t){if(this.__shaderName==t)return;const e=J.getClass(t);if(!e)throw new Error("Error setting Shader. Shader not found:"+t);const i=e.getParamDeclarations(),n={};for(const s of i){let t=this.getParameter(s.name);t||(t=this.addParameter(Je(s.name,s.defaultValue,s.range,0!=s.texturable))),n[s.name]=!0}for(const s of this.__params)n[s.getName()]||this.removeParameter(s.getName());this.__shaderName=t,this.emit("shaderNameChanged",{shaderName:t})}removeAllTextures(){for(const t of this.__params)t.getImage&&t.getImage()&&t.setImage(void 0)}getParamTextures(){const t={};for(const e of this.__params)e.getImage&&e.getImage()&&(t[e.getName()]=e.getImage());return t}__makeParameterTexturable(t){makeParameterTexturable(t)}isTransparent(){const t=this.getParameter("Opacity");if(t&&(t.getValue()<.99||t.getImage()))return!0;const e=this.getParameter("BaseColor");return!(!e||!e.getImage()||"RGBA"!=e.getImage().format)}getShaderClass(){return J.getClass(this.getShaderName())}modifyParams(t,e){e&&this.setShaderName(e);for(const i in t){const e=this.getParameter(i);e&&(t[i]instanceof Q?this.replaceParameter(t[i]):e.setValue(t[i]))}}toJSON(t,e=0){return super.toJSON(t,e)}fromJSON(t,e={},i=0){t.shader?(this.setShaderName(t.shader),super.fromJSON(t,e,i)):console.warn("Invalid Material JSON")}readBinary(t,e){let i=t.loadStr();if("StandardMaterial"==i&&(i="StandardSurfaceShader"),"TransparentMaterial"==i&&(i="TransparentSurfaceShader"),this.setShaderName(i),e.versions["zea-engine"].lessThan([0,0,3])){this.setName(t.loadStr());const i=t.loadUInt32();for(let s=0;s<i;s++){const i=(n=t.loadStr()).charAt(0).toUpperCase()+n.slice(1);let s;"MaterialColorParam"==t.loadStr()?(s=t.loadRGBAFloat32Color(),s.applyGamma(2.2)):s=t.loadFloat32();const o=t.loadStr();let r=this.getParameter(i);r?r.setValue(s):r=this.addParameter(Je(i,s)),""!=o&&r.setImage&&(e.materialLibrary.hasImage(o)?r.setImage(e.materialLibrary.getImage(o)):console.warn("Missing Texture:"+o))}}else super.readBinary(t,e);var n}clone(t){const e=new Pe;return e.copyFrom(this,t),e}copyFrom(t,e){super.copyFrom(t,e),this.setShaderName(t.getShaderName());for(const i of t.getParameters()){const e=t.getParameter(i.getName());i.getImage||this.__makeParameterTexturable(e)}}destroy(){this.removeAllTextures(),super.destroy()}}class Ee extends we{constructor(t){super(),null==t&&(t=this.constructor.name),this.__name=t,this.format="RGBA",this.type="UNSIGNED_BYTE",this.__loaded=!1,this.width=1,this.height=1}isLoaded(){return this.__loaded}getName(){return this.__name}isStream(){return!1}setData(t,e,i){this.width=t,this.height=e,this.__data=i,this.__loaded?this.emit("updated",{}):(this.__loaded=!0,this.emit("loaded",{}))}getParams(){const t=super.getParams();return t.data=this.__data,t}}function He(t){this.data=t,this.pos=0}function ke(t){this.stream=new He(t),this.output={}}J.registerClass("DataImage2D",Ee),J.registerClass("DataImage",Ee),He.prototype.readByte=function(){return this.data[this.pos++]},He.prototype.peekByte=function(){return this.data[this.pos]},He.prototype.readBytes=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.readByte();return e},He.prototype.peekBytes=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.data[this.pos+i];return e},He.prototype.readString=function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},He.prototype.readBitArray=function(){for(var t=[],e=this.readByte(),i=7;i>=0;i--)t.push(!!(e&1<<i));return t},He.prototype.readUnsigned=function(t){var e=this.readBytes(2);return t?(e[1]<<8)+e[0]:(e[0]<<8)+e[1]},ke.prototype.parse=function(t){return this.parseParts(this.output,t),this.output},ke.prototype.parseParts=function(t,e){for(var i=0;i<e.length;i++)this.parsePart(t,e[i])},ke.prototype.parsePart=function(t,e){var i,n=e.label;if(!e.requires||e.requires(this.stream,this.output,t))if(e.loop){for(var s=[];e.loop(this.stream);){var o={};this.parseParts(o,e.parts),s.push(o)}t[n]=s}else e.parts?(this.parseParts(i={},e.parts),t[n]=i):e.parser?(i=e.parser(this.stream,this.output,t),e.skip||(t[n]=i)):e.bits&&(t[n]=this.parseBits(e.bits))},ke.prototype.parseBits=function(t){var e={},i=this.stream.readBitArray();for(var n in t){var s=t[n];e[n]=s.length?i.slice(s.index,s.index+s.length).reduce((function(t,e){return 2*t+e}),0):i[s.index]}return e};var Be=function(){return function(t){return t.readByte()}},De=function(t){return function(e){return e.readBytes(t)}},Oe=function(t){return function(e){return e.readString(t)}},Qe=function(t){return function(e){return e.readUnsigned(t)}},Ae=function(t,e){return function(i,n,s){for(var o=e(i,n,s),r=new Array(o),a=0;a<o;a++)r[a]=i.readBytes(t);return r}},je={label:"blocks",parser:function(t){for(var e=[],i=t.readByte();0!==i;i=t.readByte())e=e.concat(t.readBytes(i));return e}},qe={label:"gce",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&249===e[1]},parts:[{label:"codes",parser:De(2),skip:!0},{label:"byteSize",parser:Be()},{label:"extras",bits:{future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}}},{label:"delay",parser:Qe(!0)},{label:"transparentColorIndex",parser:Be()},{label:"terminator",parser:Be(),skip:!0}]},$e={label:"image",requires:function(t){return 44===t.peekByte()},parts:[{label:"code",parser:Be(),skip:!0},{label:"descriptor",parts:[{label:"left",parser:Qe(!0)},{label:"top",parser:Qe(!0)},{label:"width",parser:Qe(!0)},{label:"height",parser:Qe(!0)},{label:"lct",bits:{exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}}}]},{label:"lct",requires:function(t,e,i){return i.descriptor.lct.exists},parser:Ae(3,(function(t,e,i){return Math.pow(2,i.descriptor.lct.size+1)}))},{label:"data",parts:[{label:"minCodeSize",parser:Be()},je]}]},et={label:"text",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&1===e[1]},parts:[{label:"codes",parser:De(2),skip:!0},{label:"blockSize",parser:Be()},{label:"preData",parser:function(t,e,i){return t.readBytes(i.text.blockSize)}},je]},tt={label:"frames",parts:[qe,{label:"application",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&255===e[1]},parts:[{label:"codes",parser:De(2),skip:!0},{label:"blockSize",parser:Be()},{label:"id",parser:function(t,e,i){return t.readString(i.blockSize)}},je]},{label:"comment",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&254===e[1]},parts:[{label:"codes",parser:De(2),skip:!0},je]},$e,et],loop:function(t){var e=t.peekByte();return 33===e||44===e}},it=[{label:"header",parts:[{label:"signature",parser:Oe(3)},{label:"version",parser:Oe(3)}]},{label:"lsd",parts:[{label:"width",parser:Qe(!0)},{label:"height",parser:Qe(!0)},{label:"gct",bits:{exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}}},{label:"backgroundColorIndex",parser:Be()},{label:"pixelAspectRatio",parser:Be()}]},{label:"gct",requires:function(t,e){return e.lsd.gct.exists},parser:Ae(3,(function(t,e){return Math.pow(2,e.lsd.gct.size+1)}))},tt];function st(t){var e=new ke(new Uint8Array(t));this.raw=e.parse(it),this.raw.hasImages=!1;for(var i=0;i<this.raw.frames.length;i++)if(this.raw.frames[i].image){this.raw.hasImages=!0;break}}st.prototype.decompressFrame=function(t,e){if(t>=this.raw.frames.length)return null;var i=this.raw.frames[t];if(i.image){var n=function(t,e,i){var n,s,o,r,a,l,c,h,d,u,m,p,b,f,g,y,v=i,Z=new Array(i),x=new Array(4096),G=new Array(4096),X=new Array(4097);for(a=1+(s=1<<(p=t)),n=s+2,c=-1,o=(1<<(r=p+1))-1,d=0;d<s;d++)x[d]=0,G[d]=d;for(m=h=b=f=y=g=0,u=0;u<v;){if(0===f){if(h<r){m+=e[g]<<h,h+=8,g++;continue}if(d=m&o,m>>=r,h-=r,d>n||d==a)break;if(d==s){o=(1<<(r=p+1))-1,n=s+2,c=-1;continue}if(-1==c){X[f++]=G[d],c=d,b=d;continue}for(l=d,d==n&&(X[f++]=b,d=c);d>s;)X[f++]=G[d],d=x[d];X[f++]=b=255&G[d],n<4096&&(x[n]=c,G[n]=b,0==(++n&o)&&n<4096&&(r++,o+=n)),c=l}f--,Z[y++]=X[f],u++}for(u=y;u<v;u++)Z[u]=0;return Z}(i.image.data.minCodeSize,i.image.data.blocks,i.image.descriptor.width*i.image.descriptor.height);i.image.descriptor.lct.interlaced&&(n=function(t,e){for(var i=new Array(t.length),n=t.length/e,s=function(n,s){var o=t.slice(s*e,(s+1)*e);i.splice.apply(i,[n*e,e].concat(o))},o=[0,4,2,1],r=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=o[l];c<n;c+=r[l])s(c,a),a++;return i}(n,i.image.descriptor.width));var s={pixels:n,dims:{top:i.image.descriptor.top,left:i.image.descriptor.left,width:i.image.descriptor.width,height:i.image.descriptor.height}};return s.colorTable=i.image.descriptor.lct&&i.image.descriptor.lct.exists?i.image.lct:this.raw.gct,i.gce&&(s.delay=10*(i.gce.delay||10),s.disposalType=i.gce.extras.disposal,i.gce.extras.transparentColorGiven&&(s.transparentIndex=i.gce.transparentColorIndex)),e&&(s.patch=function(t){for(var e=t.pixels.length,i=new Uint8ClampedArray(4*e),n=0;n<e;n++){var s=4*n,o=t.pixels[n],r=t.colorTable[o];i[s]=r[0],i[s+1]=r[1],i[s+2]=r[2],i[s+3]=o!==t.transparentIndex?255:0}return i}(s)),s}return null},st.prototype.decompressFrames=function(t){for(var e=[],i=0;i<this.raw.frames.length;i++)this.raw.frames[i].image&&e.push(this.decompressFrame(i,t));return e};const nt={},lt={},rt=-1!==navigator.userAgent.indexOf("Chrome");class dt extends we{constructor(t,e="",i={}){e.constructor==Object&&(i=e),null!=t&&-1!=t.lastIndexOf(".")&&(console.warn("Deprecated signature. Please provide a name and filepath to the image constructor"),t=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("."))),super(t,i),this.__loaded=!1;const n=this.addParameter(new Te("FilePath"));n.addListener("valueChanged",()=>{if(this.loaded=!1,""==this.getName()){const t=n.getStem(),e=t.substring(t.length-1);isNaN(e)?this.setName(t):this.setName(t.substring(0,t.length-1))}const t=n.getFileDesc();t&&this.__loadData(t)}),e&&""!=e&&n.setFilepath(e)}static __imageDataLibrary(){return nt}static registerLoader(t,e){lt[t]=e}static constructLoader(t,e){for(const i of lt)if(new RegExp("\\.("+i+")$","i").test(t.name)){const n=new lt[i](e);if(n)return n.getParameter("FilePath").setValue(t.id),n}}__loadData(t){const e=this.getParameter("FilePath").getExt();if(".jpg"==e||".png"==e||".webp"==e)this.__loadLDRImage(t,e);else if(".mp4"==e||".ogg"==e)this.__loadLDRVideo(t);else if(".vlh"==e)this.__loadVLH(t);else if(".gif"==e)this.__loadGIF(t);else{if(".svg"!=e)throw new Error("Unsupported file type. Check the ext:"+t);console.warn("SVG Image not yet supported")}}__loadLDRImage(e,i){let n;".jpg"==i?this.format="RGB":".png"==i&&(this.format="RGBA"),this.type="UNSIGNED_BYTE";const s=()=>{this.getDOMElement=()=>n,this.width=n.width,this.height=n.height,this.__data=n,this.__loaded=!0,this.emit("loaded",{})};if(e.id in nt)n=nt[e.id],n.complete?s():n.addListener("load",s);else{be.addWork(e.id,1);const i=this.addParameter(new Ze("PreferredSize",-1));let o=e.url;if(e.assets&&Object.keys(e.assets).length>0){const n={maxSize:t.gpuDesc.maxTextureSize},s=i.getValue();-1==s?e.assets.reduce&&(n.prefSize=e.assets.reduce.w):n.prefSize=s;const r=function(t,e){if(e=e.filter(t=>null!==t),rt){const t=e.filter(t=>"webp"===t.format);t.length>1&&(e=t)}else e=e.filter(t=>"webp"!==t.format);if(t.maxSize&&(e=e.filter(e=>e.w<=t.maxSize)),t.filter){const i=e.filter(e=>-1!==e.url.indexOf(t.filter));i.length>1&&(e=i)}if(t.prefSize&&(e=e.map(e=>Object.assign({score:Math.abs(t.prefSize-e.w)},e))).sort((t,e)=>t.score>e.score?1:t.score<e.score?-1:0),e.length>0)return e[0]}(n,Object.values(e.assets));r&&(console.log("Selected image:"+e.name+" format:"+r.format+" :"+r.w+"x"+r.h+" url:"+r.url),o=r.url)}else console.warn("Images not processed for this file:"+e.name);n=new Image,n.crossOrigin="anonymous",n.src=o,n.addListener("load",s),n.addListener("load",()=>{be.addWorkDone(e.id,1)}),nt[e.id]=n}}__removeVideoParams(){this.getParameterIndex("spatializeAudio")&&(this.removeParameter(this.getParameterIndex("Loop")),this.removeParameter(this.getParameterIndex("spatializeAudio")),this.removeParameter(this.getParameterIndex("Gain")),this.removeParameter(this.getParameterIndex("refDistance")),this.removeParameter(this.getParameterIndex("maxDistance")),this.removeParameter(this.getParameterIndex("rolloffFactor")),this.removeParameter(this.getParameterIndex("coneInnerAngle")),this.removeParameter(this.getParameterIndex("coneOuterAngle")),this.removeParameter(this.getParameterIndex("coneOuterGain")))}__loadLDRVideo(t){this.format="RGB",this.type="UNSIGNED_BYTE",be.addWork(t.id,1);const e=this.addParameter(new Xe("Mute",!0)),i=this.addParameter(new Xe("Loop",!0)),n=document.createElement("video");n.style.display="none",n.preload="auto",n.crossOrigin="anonymous",this.getAudioSource=()=>n,document.body.appendChild(n),n.addListener("loadedmetadata",()=>{n.muted=e.getValue(),e.addListener("valueChanged",()=>{n.muted=e.getValue()}),n.loop=i.getValue(),i.addListener("valueChanged",()=>{n.loop=i.getValue()}),this.width=n.videoHeight,this.height=n.videoWidth,this.__data=n,this.__loaded=!0,be.addWorkDone(t.id,1),this.emit("loaded",{}),n.play().then(()=>{let t=0;const e=()=>{if(n.paused||n.ended)return;const i=Math.floor(29.97*n.currentTime);t!=i&&(this.emit("updated",{}),t=i),setTimeout(e,20)};e()},t=>{console.log("Autoplay was prevented.",t,t.message)})},!1),n.src=t.url}__loadVLH(t){this.type="FLOAT";let e=new y$2(1,1,1,1);this.setHDRTint=t=>{e=t},this.getHDRTint=()=>e,be.loadUrl(t.id,t.url,t=>{let e,i;for(const o in t)o.endsWith(".jpg")?e=t[o]:o.endsWith(".bin")&&(i=t[o]);const n=new Blob([e.buffer]),s=new Image;s.onload=()=>{this.width=s.width,this.height=s.height,this.__data={ldr:s,cdm:i},this.__loaded?this.emit("updated",{}):(this.__loaded=!0,this.emit("loaded",{}))},s.src=URL.createObjectURL(n)})}__loadGIF(t){let e,i,n;this.format="RGBA",this.type="UNSIGNED_BYTE",this.__streamAtlas=!0,this.addParameter(new Ve("StreamAtlasDesc",new G)),this.addParameter(new Ze("StreamAtlasIndex",0)),this.getParameter("StreamAtlasIndex").setRange([0,1]),this.getFrameDelay=()=>20,this.play=()=>{n.then(()=>{e=!0,i&&i()})},this.stop=()=>{e=!1},t.id in nt?n=nt[t.id]:(n=new Promise((e,i)=>{if(be.addWork(t.id,1),t.assets&&t.assets.atlas){const i=new Image;return i.crossOrigin="anonymous",i.src=t.assets.atlas.url,void i.addListener("load",()=>{e({width:t.assets.atlas.width,height:t.assets.atlas.height,atlasSize:t.assets.atlas.atlasSize,frameDelays:t.assets.atlas.frameDelays,frameRange:[0,t.assets.atlas.frameDelays.length],imageData:i}),be.addWorkDone(t.id,1)})}re$1(t.url,i=>{console.warn("Unpacking Gif client side:"+t.name);const n=performance.now(),s=new st(i).decompressFrames(!0),o=Math.sqrt(s.length),r=[o,o];Math.fract(o)>0&&(r[0]=Math.floor(r[0]+1),r[1]=Math.fract(o)>.5?Math.floor(r[1]+1):Math.floor(r[1]));const a=s[0].dims.width,l=s[0].dims.height,c=document.createElement("canvas"),h=c.getContext("2d"),d=document.createElement("canvas"),u=d.getContext("2d");d.width=a,d.height=l;const m=document.createElement("canvas"),p=m.getContext("2d");let b;m.width=r[0]*a,m.height=r[1]*l;const f=[],g=(t,e)=>{const i=t.dims;f.push(t.delay/10),b&&i.width==b.width&&i.height==b.height||(c.width=i.width,c.height=i.height,b=h.createImageData(i.width,i.height)),b.data.set(t.patch),h.putImageData(b,0,0),2==t.disposalType&&u.clearRect(0,0,d.width,d.height),u.drawImage(c,i.left,i.top),p.drawImage(d,e%r[0]*a,Math.floor(e/r[0])*l)};for(let t=0;t<s.length;t++)g(s[t],t);be.addWorkDone(t.id,1);const y=p.getImageData(0,0,m.width,m.height),v=performance.now()-n;console.log(`Decode GIF '${t.name}' time:`+v),e({width:m.width,height:m.height,atlasSize:r,frameRange:[0,s.length],frameDelays:f,imageData:y})},e=>{console.warn("Unable to Load URL:"+e+":"+t.url),i()})}),nt[t.id]=n),n.then(t=>{this.width=t.width,this.height=t.height,this.getParameter("StreamAtlasDesc").setValue(new G(t.atlasSize[0],t.atlasSize[1],0,0)),this.getParameter("StreamAtlasIndex").setRange(t.frameRange),this.__data=t.imageData,this.getFrameDelay=e=>10*t.frameDelays[e];const n=this.getParameter("StreamAtlasIndex"),s=n.getRange()[1];let o=0;i=()=>{n.setValue(o),e&&setTimeout(i,this.getFrameDelay(o)),o=(o+1)%s},e&&i(),this.__loaded=!0,this.emit("loaded",{})})}getFilepath(){return this.getParameter("FilePath").getValue()}isStream(){return!1}isLoaded(){return this.__loaded}getParams(){const t=super.getParams();return this.__loaded&&(t.data=this.__data),t}toJSON(t,e){}fromJSON(t,e,i){}readBinary(t,e){this.setName(t.loadStr());let i=t.loadStr();if("string"==typeof i&&""!=i){if(e.lod>=0){const t=i.lastIndexOf(".");if(-1!=t){const n=i.substring(0,t)+e.lod+i.substring(t);be.resolveFilepath(n)&&(i=n)}}this.getParameter("FilePath").setFilepath(i)}}}class ot extends dt{constructor(t,e={}){console.warn("FileImage2D is becoming deprecated in favor of simple FileImage"),super(t,e)}}J.registerClass("FileImage2D",dt),J.registerClass("FileImage",dt);const ht=-1!==navigator.userAgent.indexOf("Chrome");class ct extends dt{constructor(t,e,i){super(t,e,i),this.type="UNSIGNED_BYTE",this.addParameter(new Ze("PreferredSize",-1)),this.__crossOrigin="anonymous"}setCrossOrigin(t){this.__crossOrigin=t}__loadData(e){".png"==this.getParameter("FilePath").getExt()&&(this.format="RGBA");let i=e.url;if(e.assets&&Object.keys(e.assets).length>0){const n={maxSize:t.gpuDesc.maxTextureSize},s=this.getParameter("PreferredSize").getValue();-1==s?e.assets.reduce&&(n.prefSize=e.assets.reduce.w):n.prefSize=s;const o=function(t,e){if(e=e.filter(t=>null!==t),ht){const t=e.filter(t=>"webp"===t.format);t.length>1&&(e=t)}else e=e.filter(t=>"webp"!==t.format);if(t.maxSize&&(e=e.filter(e=>e.w<=t.maxSize)),t.filter){const i=e.filter(e=>-1!==e.url.indexOf(t.filter));i.length>1&&(e=i)}if(t.prefSize&&(e=e.map(e=>Object.assign({score:Math.abs(t.prefSize-e.w)},e))).sort((t,e)=>t.score>e.score?1:t.score<e.score?-1:0),e.length>0)return e[0]}(n,Object.values(e.assets));o&&(console.log("Selected image:"+e.name+" format:"+o.format+" :"+o.w+"x"+o.h+" url:"+o.url),i=o.url)}else console.warn("Images not processed for this file:"+e.name);this.setImageURL(i,"RGB")}setImageURL(t,e="RGB"){if(!e){const i=t.lastIndexOf(".");-1!=i&&".png"==t.substring(i).toLowerCase()&&(e="RGBA")}let i;this.format=e,this.__loaded=!1;const n=()=>{this.getDOMElement=()=>i,this.width=i.width,this.height=i.height,this.__data=i,this.__loaded=!0,this.emit("loaded",{})},s=dt.__imageDataLibrary();t in s?(i=s[t],i.complete?n():i.addListener("load",n)):(i=new Image,i.crossOrigin=this.__crossOrigin,i.src=t,i.addListener("load",n),s[t]=i)}}dt.registerLoader("jpg|jpeg|png",ct),J.registerClass("LDRImage",ct);class mt extends dt{constructor(t,e,i){super(t,e,i),this.format="RGB",this.type="UNSIGNED_BYTE",this.addParameter(new Xe("Mute",!1)),this.addParameter(new Xe("Loop",!0)),this.addParameter(new Ze("Gain",2)).setRange([0,5]),this.addParameter(new Xe("SpatializeAudio",!0)),this.addParameter(new Ze("refDistance",2)),this.addParameter(new Ze("maxDistance",1e4)),this.addParameter(new Ze("rolloffFactor",1)),this.addParameter(new Ze("coneInnerAngle",360)),this.addParameter(new Ze("coneOuterAngle",0)),this.addParameter(new Ze("coneOuterGain",1))}__loadData(t){be.addWork(t.id,1);const e=document.createElement("video");e.style.display="none",e.preload="auto",e.crossOrigin="anonymous",this.getAudioSource=()=>e,document.body.appendChild(e),e.addListener("loadedmetadata",()=>{const i=this.getParameter("Mute");e.muted=i.getValue(),i.addListener("valueChanged",()=>{e.muted=i.getValue()});const n=this.getParameter("Loop");e.loop=n.getValue(),n.addListener("valueChanged",()=>{e.loop=n.getValue()}),this.width=e.videoHeight,this.height=e.videoWidth,this.__data=e,this.__loaded=!0,be.addWorkDone(t.id,1),this.emit("loaded",{});let s=0;const o=()=>{if(e.paused||e.ended)return;const t=Math.floor(29.97*e.currentTime);s!=t&&(this.emit("updated",{}),s=t),setTimeout(o,20)};o()},!1),e.src=t.url;const i=e.play();void 0!==i&&i.then(()=>{console.log("Autoplay started!")}).catch(()=>{console.log("Autoplay was prevented.")})}}dt.registerLoader("mp4|ogg",mt),J.registerClass("LDRVideo",mt);class ut extends dt{constructor(t,e="",i={}){super(t,e,i),this.format="RGBA",this.type="UNSIGNED_BYTE",this.__streamAtlas=!0,this.getParameter("FilePath").setSupportedExts("gif"),this.addParameter(new Ve("StreamAtlasDesc")),this.addParameter(new Ze("StreamAtlasIndex",0));const n=this.getParameter("StreamAtlasIndex");let s;n.setRange([0,1]);let o=0;const r=t=>{n.setValue(o),s&&setTimeout(()=>r(t),this.getFrameDelay(o)),o=(o+1)%t};this.play=()=>{this.__resourcePromise.then(()=>{s=!0;const t=n.getRange()[1];r(t)})},this.stop=()=>{s=!1}}getFrameDelay(t){return 10*this.__unpackedData.frameDelays[t]}__loadData(t){const e=dt.__imageDataLibrary();t.id in e?this.__resourcePromise=e[t.id]:(this.__resourcePromise=new Promise((e,i)=>{if(be.addWork(t.id,1),t.assets&&t.assets.atlas){const i=new Image;return i.crossOrigin="anonymous",i.src=t.assets.atlas.url,void i.addListener("load",()=>{e({width:t.assets.atlas.width,height:t.assets.atlas.height,atlasSize:t.assets.atlas.atlasSize,frameDelays:t.assets.atlas.frameDelays,frameRange:[0,t.assets.atlas.frameDelays.length],imageData:i}),be.addWorkDone(t.id,1)})}re$1(t.url,i=>{console.warn("Unpacking Gif client side:"+t.name);const n=performance.now(),s=new st(i).decompressFrames(!0),o=Math.sqrt(s.length),r=[o,o];Math.fract(o)>0&&(r[0]=Math.floor(r[0]+1),r[1]=Math.fract(o)>.5?Math.floor(r[1]+1):Math.floor(r[1]));const a=s[0].dims.width,l=s[0].dims.height,c=document.createElement("canvas"),h=c.getContext("2d"),d=document.createElement("canvas"),u=d.getContext("2d");d.width=a,d.height=l;const m=document.createElement("canvas"),p=m.getContext("2d");let b;m.width=r[0]*a,m.height=r[1]*l;const f=[],g=(t,e)=>{const i=t.dims;f.push(t.delay/10),b&&i.width==b.width&&i.height==b.height||(c.width=i.width,c.height=i.height,b=h.createImageData(i.width,i.height)),b.data.set(t.patch),h.putImageData(b,0,0),2==t.disposalType&&u.clearRect(0,0,d.width,d.height),u.drawImage(c,i.left,i.top),p.drawImage(d,e%r[0]*a,Math.floor(e/r[0])*l)};for(let t=0;t<s.length;t++)g(s[t],t);be.addWorkDone(t.id,1);const y=p.getImageData(0,0,m.width,m.height),v=performance.now()-n;console.log(`Decode GIF '${t.name}' time:`+v),e({width:m.width,height:m.height,atlasSize:r,frameRange:[0,s.length],frameDelays:f,imageData:y})},e=>{console.warn("Unable to Load URL:"+e+":"+t.url),i()})}),e[t.id]=this.__resourcePromise),this.__resourcePromise.then(t=>{this.width=t.width,this.height=t.height,this.getParameter("StreamAtlasDesc").setValue(new G(t.atlasSize[0],t.atlasSize[1],0,0)),this.getParameter("StreamAtlasIndex").setRange(t.frameRange),this.__unpackedData=t,this.__data=t.imageData,this.__loaded=!0,this.emit("loaded",{})})}}dt.registerLoader("gif",ut),J.registerClass("GIFImage",ut);class bt extends we{constructor(t,e={}){let i;null!=t&&-1!=t.lastIndexOf(".")&&(i=t,t=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("."))),super(t,e),this.__loaded=!1,this.__exposure=1,this.__ambientLightFactor=0,this.__hdrtint=new y$2(1,1,1,1),this.__stream="stream"in e&&e.stream,this.type="FLOAT";const n=this.addParameter(new Te("FilePath"));n.addListener("valueChanged",()=>{if(this.loaded=!1,""==this.getName()){const t=n.getStem(),e=t.substring(t.length-1);isNaN(e)?this.setName(t):this.setName(t.substring(0,t.length-1))}const t=n.getValue(),e=n.getFile();this.__loadVLH(t,e)}),i&&this.getParameter("FilePath").setFilepath(i)}getDOMElement(){return this.__domElement}getResourcePath(){return this.getParameter("FilePath").getValue()}__decodeData(t){const e=t.cdm,i=new Blob([t.ldr.buffer]),n=new Image;n.onload=()=>{this.width=n.width,this.height=n.height,this.__data={ldr:n,cdm:e},this.__loaded?this.emit("updated",{}):(this.__loaded=!0,this.emit("loaded",{}))},n.src=URL.createObjectURL(i)}__loadVLH(t,e){this.type="FLOAT",be.loadUrl(t,e.url,t=>{if(!t.ldr||!t.cdm)for(const e in t)e.endsWith(".jpg")?(t.ldr=t[e],delete t[e]):e.endsWith(".bin")&&(t.cdm=t[e],delete t[e]);this.__decodeData(t)})}isStream(){return!1}isLoaded(){return this.__loaded}getParams(){const t=super.getParams();return this.__loaded&&(t.data=this.__data,t.exposure=this.__exposure),t}setHDRTint(t){this.__hdrtint=t}getHDRTint(){return this.__hdrtint}toJSON(t,e){}fromJSON(t,e,i){}readBinary(t,e){this.setName(t.loadStr());const i=t.loadStr();if("string"==typeof i&&""!=i){if(e.lod>=0){const t=i.lastIndexOf(".");if(-1!=t){const n=i.substring(0,t)+e.lod+i.substring(t);be.resourceAvailable(n)&&(i=n)}}this.getParameter("FilePath").setValue(i)}}}J.registerClass("VLHImage",bt);const pt=1,gt=2,_t=(t,e)=>e<t?0:1;function Zt(t){return t.dot(new _(1,1))}function Gt(t){return new _(Math.abs(t.x),Math.abs(t.y))}function Xt(t,e){return new _(Math.max(t.x,e),Math.max(t.y,e))}function yt(t){const e=function(t){return new Z(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))}(t),i=function(t){return new Z(2*_t(0,t.x)-1,2*_t(0,t.y)-1,2*_t(0,t.z)-1)}(t),n=new _(e.x,e.y);let s=Xt(n,1e-20);const o=Math.atan2(s.x,s.y)/Math.HALF_PI;s=Xt(new _(e.z,n.length()),1e-20);const r=Math.atan2(s.y,s.x)/Math.HALF_PI;let a=new _(i.x*o,i.y*(1-o));if(a.scaleInPlace(r),t.z<0){const t=new _(a.y,a.x),e=new _(i.x,i.y);a=e.subtract(Gt(t).multiply(e))}return a.scale(.5).add(new _(.5,.5))}function ft(t){const e=function(t){return new _(2*_t(0,t.x)-1,2*_t(0,t.y)-1)}(t=t.scale(2).subtract(new _(1,1))),i=Zt(Gt(t)),n=i*Math.PI*.5;if(n<=0)return new Z(0,0,1);if(Math.abs(n-Math.PI)<1e-6)return new Z(0,0,-1);i>1&&(t=Gt(_(t.y,t.x)).negate().add(new _(1,1)).multiply(e),i=Zt(Gt(t)));const s=Math.abs(t.x)/i*Math.HALF_PI,o=Math.sin(s),r=Math.cos(s),a=Math.sin(n),l=Math.cos(n);return new Z(o*e.x*a,r*e.y*a,l)}class Vt extends bt{constructor(t,e={}){super(t,e),this.mapping=gt}__decodeData(t){super.__decodeData(t);const e=t.samples;e&&(this.__sampleSets=window.TextDecoder?JSON.parse(new TextDecoder("utf-8").decode(e)):JSON.parse(K(e)),this.__sampleSets.luminanceThumbnail&&(this.__thumbSize=Math.sqrt(this.__sampleSets.luminanceThumbnail.length)))}getSampleSets(){return this.__sampleSets}uvToDir(t){switch(this.mapping){case pt:return function(t){const e=Math.PI*(2*t-1),i=void 0*Math.PI;return new Z(sin(i)*sin(e),-sin(i)*cos(e),cos(i))}(t);case gt:return ft(t)}}dirToUv(t){switch(this.mapping){case pt:return function(t){const e=Math.acos(t.z),i=Math.atan2(t.x,-t.y);return new _((1+i/Math.PI)/2,e/Math.PI)}(t);case gt:return yt(t)}}uvToLuminance(t){const e=Math.floor(t.y*this.__thumbSize)*this.__thumbSize+Math.floor(t.x*this.__thumbSize);return this.__sampleSets.luminanceThumbnail[e]}dirToLuminance(t){return this.uvToLuminance(this.dirToUv(t))}}J.registerClass("EnvMap",Vt);const It=new class extends Y{constructor(){super(),this.__labelLibraries={};const t=function(){const t=window.navigator,e=["language","browserLanguage","systemLanguage","userLanguage"];let i,n;if(Array.isArray(t.languages))for(i=0;i<t.languages.length;i++)if(n=t.languages[i],n&&n.length)return n;for(i=0;i<e.length;i++)if(n=t[e[i]],n&&n.length)return n;return null}();t.startsWith("en")?this.__language="En":t.startsWith("es")?this.__language="Es":t.startsWith("fr")?this.__language="Fr":(t.startsWith("gb")||t.startsWith("de"))&&(this.__language="Gb"),this.__foundLabelLibraries={},be.registerResourceCallback(".labels",t=>{const e=t.name.split(".")[0];this.__foundLabelLibraries[e]=t,se(t.url,t=>{this.__labelLibraries[e]=JSON.parse(t),this.emit("labelLibraryLoaded",{library:e})})}),window.XLSX&&be.registerResourceCallback(".xlsx",t=>{const e=t.name.split(".")[0];this.__foundLabelLibraries[e]=t,re$1(t.url,t=>{const i=new Uint8Array(t),n=XLSX.read(i,{type:"array"}),s={};n.SheetNames.forEach((function(t){XLSX.utils.sheet_to_row_object_array(n.Sheets[t]).forEach((function(t){const e=t.Identifier;delete t.Identifier,s[e]=t}))})),this.__labelLibraries[e]=s,this.emit("labelLibraryLoaded",{library:e})})})}loadLibrary(t,e){this.__foundLabelLibraries[t]=!0,this.__labelLibraries[t]=e,this.labelLibraryLoaded.emit(t)}isLibraryFound(t){return t in this.__foundLabelLibraries}isLibraryLoaded(t){return t in this.__labelLibraries}getLabelText(t,e){const i=this.__labelLibraries[t];if(!i)throw new Error("LabelLibrary: '"+t+"' not found in LabelManager. Found: ["+Object.keys(this.__labelLibraries)+"]");const n=i[e];if(!n)throw new Error("Label: '"+e+"' not found in LabelLibrary: '"+t+"'. Found: ["+Object.keys(i)+"]");const s=n[this.__language];if(!s){if(n.En)return n.En;throw new Error("labelText: '"+language+"' not found in Label. Found: ["+Object.keys(n)+"]")}return s}setLabelText(t,e,i){let n=this.__labelLibraries[t];n||(n={},this.__labelLibraries[t]=n);let s=n[e];s||(s={},n[e]=s),s[this.__language]=i}setLanguage(t){this.__language=t}};class xt extends Ee{constructor(t,e){super(t),this.__canvasElem=document.createElement("canvas");const i=this.addParameter(new We("Library"));this.addParameter(new We("Text","")),this.addParameter(new Ie("FontColor",new y$2(0,0,0))),this.addParameter(new Ze("Margin",11)),this.addParameter(new Ze("BorderWidth",2)),this.addParameter(new Ze("BorderRadius",11)),this.addParameter(new Xe("Outline",!1)),this.addParameter(new Xe("OutlineColor",new y$2(0,0,0))),this.addParameter(new Xe("Background",!0)),this.addParameter(new Ie("BackgroundColor",new y$2("#FBC02D"))),this.addParameter(new Xe("FillBackground",!0)),this.addParameter(new Xe("StrokeBackgroundOutline",!0)),this.addParameter(new Ze("FontSize",22)),this.addParameter(new We("Font","Helvetica")),this.addListener("nameChanged",()=>{this.loadLabelData()}),e&&i.setValue(e),this.__requestedRerender=!1,this.__needsRender=!1,this.loadLabelData()}__parameterValueChanged(t){super.__parameterValueChanged(t),this.__requestedRerender||(this.__requestedRerender=!0,this.loadLabelData())}loadLabelData(){Promise.all([(()=>new Promise(t=>{const e=this.getParameter("Library").getValue();if(""==e)return void t();if(!It.isLibraryFound(e))return console.warn("Label Libary not found:",e),void t();const i=()=>{try{const t=this.getName(),i=It.getLabelText(e,t);this.getParameter("Text").setValue(i)}catch(t){console.warn(t)}t()};It.isLibraryLoaded(e)?i():It.addListener("labelLibraryLoaded",t=>{t.library==e&&i()})}))(),(()=>new Promise(t=>{if(null!=document.fonts){const e=this.getParameter("Font").getValue(),i=this.getParameter("FontSize").getValue();document.fonts.load(i+'px "'+e+'"').then(()=>{t()})}else t()}))()]).then(()=>{this.__requestedRerender=!1,this.__needsRender=!0,this.__loaded?this.emit("updated",{}):(this.__loaded=!0,this.emit("loaded",{}))})}renderLabelToImage(){const t=this.__canvasElem.getContext("2d",{alpha:!0});let e=this.getParameter("Text").getValue();""==e&&(e=this.getName());const i=this.getParameter("Font").getValue(),n=this.getParameter("FontColor").getValue(),s=this.getParameter("FontSize").getValue(),o=this.getParameter("Margin").getValue(),r=this.getParameter("BorderWidth").getValue(),a=this.getParameter("BorderRadius").getValue(),l=this.getParameter("Outline").getValue(),c=this.getParameter("OutlineColor").getValue(),h=this.getParameter("Background").getValue(),d=this.getParameter("BackgroundColor").getValue(),u=this.getParameter("FillBackground").getValue(),m=this.getParameter("StrokeBackgroundOutline").getValue(),p=o+r,b=e.split("\n");t.font=s+'px "'+i+'"';let f=0;b.forEach(e=>{f=Math.max(t.measureText(e).width,f)});const g=s;this.width=Math.ceil(f+2*p),this.height=Math.ceil(g*b.length+2*p),t.canvas.width=this.width,t.canvas.height=this.height,this.__canvasElem.width=this.width,this.__canvasElem.height=this.height,t.fillStyle="rgba(0, 0, 0, 0.0)",t.fillRect(0,0,this.width,this.height),h&&(t.fillStyle=d.toHex(),t.strokeStyle=c.toHex(),function(t,e,i,n,s,o,r,a,l){if(void 0===a&&(a=!0),void 0===o&&(o=5),"number"==typeof o)o={tl:o,tr:o,br:o,bl:o};else{const t={tl:0,tr:0,br:0,bl:0};for(const e in t)o[e]=o[e]||t[e]}t.beginPath(),t.moveTo(e+o.tl,i),t.lineTo(e+n-o.tr,i),t.quadraticCurveTo(e+n,i,e+n,i+o.tr),t.lineTo(e+n,i+s-o.br),t.quadraticCurveTo(e+n,i+s,e+n-o.br,i+s),t.lineTo(e+o.bl,i+s),t.quadraticCurveTo(e,i+s,e,i+s-o.bl),t.lineTo(e,i+o.tl),t.quadraticCurveTo(e,i,e+o.tl,i),t.closePath(),r&&t.fill(),a&&(t.lineWidth=l,t.stroke())}(t,r,r,this.width-2*r,this.height-2*r,a,u,m,r)),t.font=s+'px "'+i+'"',t.textAlign="left",t.fillStyle=n.toHex(),t.textBaseline="hanging",b.forEach((e,i)=>{t.fillText(e,p,p+i*g)}),l&&(t.strokeStyle=c.toHex(),t.lineWidth=1.5,t.strokeText(e,p,p)),this.__data=t.getImageData(0,0,this.width,this.height),this.__needsRender=!1,this.emit("labelRendered",{width:this.width,height:this.height,data:this.__data})}getParams(){return this.__needsRender&&this.renderLabelToImage(),super.getParams()}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__getLabelText()}}J.registerClass("Label",xt);class Rt extends we{constructor(){super(),this.__loaded=!1}connectWebcam(t,e,i=!1){const n={width:t,height:e,frameRate:{ideal:60,max:60}};n.facingMode=i?{exact:"environment"}:{facingMode:"user"};const s=document.createElement("video");s.style.display="none",s.preload="auto",s.crossOrigin="anonymous",document.body.appendChild(s),navigator.mediaDevices.getUserMedia({audio:!1,video:n}).then(t=>{s.srcObject=t,s.onloadedmetadata=()=>{s.play(),this.width=s.videoWidth,this.height=s.videoHeight,console.log("Webcam:["+this.width+", "+this.height+"]"),this.__data=s,this.__loaded=!0,this.emit("loaded",{});let t=0;const e=()=>{if(s.paused||s.ended)return;const i=Math.floor(60*s.currentTime);t!=i&&(this.emit("updated",{}),t=i),setTimeout(e,20)};e()}}).catch((function(){}))}setVideoStream(t){this.__loaded=!1,this.width=t.videoWidth,this.height=t.videoHeight,this.start(),this.__data=t,this.__loaded=!0,this.emit("loaded",{})}stop(){clearInterval(this.__intervalId)}start(){this.__intervalId=setInterval(()=>{this.emit("updated",{})},20)}isLoaded(){return this.__loaded}getParams(){return{type:this.type,format:this.format,width:this.width,height:this.height,data:this.__data,flipY:this.getParameter("FlipY").getValue()}}}J.registerClass("VideoStreamImage2D",Rt);class St extends Y{constructor(e="MaterialLibrary"){super(),this.__name=e,this.lod=0,t.isMobileDevice&&(this.lod=1),this.clear()}clear(){this.__images={},this.__materials={Default:new Pe("Default","SimpleSurfaceShader")}}getPath(){return[this.__name]}getNumMaterials(){return Object.keys(this.__materials).length}getMaterials(){return Object.values(this.__materials)}getMaterialNames(){const t=[];for(const e in this.__materials)t.push(e);return t}hasMaterial(t){return t in this.__materials}addMaterial(t){t.setOwner(this),this.__materials[t.getName()]=t}getMaterial(t,e=!0){const i=this.__materials[t];if(!i&&e)throw new Error("Material:"+t+" not found in library:"+this.getMaterialNames());return i}hasImage(t){return t in this.__images}addImage(t){t.setOwner(this),this.__images[t.getName()]=t}getImage(t,e=!0){const i=this.__images[t];if(!i&&e)throw new Error("Image:"+t+" not found in library:"+this.getImageNames());return i}getImageNames(){const t=[];for(const e in this.__images)t.push(e);return t}load(t){const e=new XMLHttpRequest;e.open("GET",t,!0),e.ontimeout=()=>{throw new Error("The request for "+t+" timed out.")},e.onload=()=>{4===e.readyState&&(200===e.status?this.fromJSON(JSON.parse(e.responseText)):console.warn(e.statusText))},e.send(null)}toJSON(t={},e=0){return{numMaterials:this.geoms.length()}}fromJSON(t,e={},i=0){e.lod=this.lod;for(const n in t.textures)new dt(n).fromJSON(t.textures[n]),this.__images[n]=texture;for(const n in t.materials){const e=new Pe(n);e.fromJSON(t.materials[n]),this.addMaterial(e)}}readBinary(t,e={}){this.name=t.loadStr(),e.lod=this.lod,e.materialLibrary=this;const i=t.loadUInt32();for(let s=0;s<i;s++){const i=t.loadStr(),n=J.constructClass(i,void 0);n.readBinary(t,e),this.__images[n.getName()]=n}const n=t.loadUInt32();if(n>0){const i=t.loadUInt32Array(n);for(let s=0;s<n;s++){const n=new Pe("");t.seek(i[s]),n.readBinary(t,e,this.__images),this.addMaterial(n)}}this.emit("loaded",{})}toString(){return JSON.stringify(this.toJSON(),null,2)}}const Lt=new class extends Y{constructor(){super(),this.__materialLibraries={},be.registerResourceCallback(".matlib",t=>{se(t.url,e=>{const i=t.name.split(".")[0],n=JSON.parse(e),s=new St(i);s.fromJSON(n),this.__materialLibraries[i]=s,this.emit("materialLibraryLoaded",{matlib:s})})})}getMaterialLibraryNames(){const t=[];for(const e in this.__materialLibraries)t.push(e);return t}hasMaterialLibrary(t){return t in this.__materialLibraries}getMaterialLibrary(t){const e=this.__materialLibraries[t];return e||console.warn("MaterialLibrary:"+t+" not found in MaterialLibraryManager. Found: ["+this.getMaterialLibraryNames()+"]"),e}resolveMaterialFromPath(t){const e=this.getMaterialLibrary(t[0]);if(e)return e.getMaterial(t[1])}};class Wt extends Q{constructor(t,e){super(t,e,"Material"),this.__valueParameterValueChanged=this.__valueParameterValueChanged.bind(this)}__valueParameterValueChanged(t){this.emit("valueParameterValueChanged",t)}setValue(t,e=E.USER_SETVALUE){this.__value!==t&&(this.__value&&this.__value.removeListener("parameterValueChanged",this.__valueParameterValueChanged),this.__value=t,this.__value&&this.__value.addListener("parameterValueChanged",this.__valueParameterValueChanged),e!=E.USER_SETVALUE&&e!=E.REMOTEUSER_SETVALUE||(this.__flags|=H.USER_EDITED),e!=E.OPERATOR_SETVALUE&&this.emit("valueChanged",{mode:e}))}toJSON(t,e){if(0!=(this.__flags&H.USER_EDITED))return{value:this.__value.getPath()}}fromJSON(t,e,i){if(null==t.value)return void console.warn("Invalid Parameter JSON");const n=Lt.resolveMaterialFromPath(t.value);n&&this.setValue(n),this.__flags|=H.USER_EDITED}clone(t){return new Wt(this.__name,this.__value)}destroy(){this.__value&&this.__value.removeListener("parameterValueChanged",this.__valueParameterValueChanged)}}class vt{constructor(t,e,i){if(this.__dataType=t,this.normalized=!1,null!=t.numElements)this.__dimension=this.__dataType.numElements();else switch(t){case 6:case 4:case 5:this.__dimension=1;break;default:throw new Error("Invalid data type for attribute:"+t)}var n;this.__defaultElementValue=null!=i?i:Number.MAX_VALUE,(n=e)&&void 0!==n.byteLength?this.__data=e:(this.__data=new Float32Array(e*this.__dimension),this.initRange(0))}resize(t){const e=this.__data.length,i=t*this.__dimension,n=new Float32Array(i);for(let s=0;s<Math.min(this.__data.length,i);s++)n[s]=this.__data[s];this.__data.length<i&&(this.__data=n),this.initRange(e)}initRange(t){for(let e=t;e<this.__data.length;e++)this.__data[e]=this.__defaultElementValue}getCount(){return this.__data.length/this.__dimension}get length(){return this.__data.length/this.__dimension}get dataType(){return this.__dataType}get data(){return this.__data}set data(t){this.__data=t}get numElements(){return this.__dimension}getFloat32Value(t){return this.__data[t]}setFloat32Value(t,e){this.__data[t]=e}getValueRef(t){const e=this.__dimension;if(t>=this.__data.length/e)throw new Error("Invalid vertex index:"+t+". Num Vertices:"+this.__data.length/3);return this.__dataType.createFromFloat32Buffer(this.__data.buffer,t*e)}setValue(t,e){const i=this.__dimension;if(t>=this.__data.length/i)throw new Error("Invalid vertex index:"+t+". Num Vertices:"+this.__data.length/3);this.__dataType.createFromFloat32Buffer(this.__data.buffer,t*i).setFromOther(e)}toJSON(t,e){return{data:Array.from(this.__data),dataType:g.getTypeName(this.__dataType),defaultValue:this.__defaultElementValue,length:this.__data.length/this.__dimension}}fromJSON(t){this.__data=Float32Array.from(t.data)}toString(){return JSON.stringify(this.toJSON(),null,2)}}class Ft extends q{constructor(){super(),this.__boundingBox=new v,this.__boundingBoxDirty=!0,this.__vertexAttributes=new Map,this.__metaData=new Map,this.addVertexAttribute("positions",Z,0)}setDebugName(t){this.__name=t}addVertexAttribute(t,e,i){let n;var s;return n=(s=i)&&void 0!==s.byteLength?new vt(e,i):new vt(e,null!=this.vertices?this.vertices.length:0,i),this.__vertexAttributes.set(t,n),n}hasVertexAttribute(t){return this.__vertexAttributes.has(t)}getVertexAttribute(t){return this.__vertexAttributes.get(t)}getVertexAttributes(t){const e={};for(const[i,n]of this.__vertexAttributes.entries())e[i]=n;return e}get vertices(){return this.__vertexAttributes.get("positions")}numVertices(){return this.vertices.length}getNumVertices(){return this.vertices.length}setNumVertices(t){this.__vertexAttributes.forEach(e=>e.resize(t))}getVertex(t){return Z.createFromFloat32Buffer(this.vertices.data.buffer,3*t)}setVertex(t,e){return Z.createFromFloat32Buffer(this.vertices.data.buffer,3*t).setFromOther(e)}moveVertices(t){const e=this.vertices;for(let i=0;i<e.length;i++)e.getValueRef(i).addInPlace(t);this.setBoundingBoxDirty()}transformVertices(t){const e=this.vertices;for(let i=0;i<e.length;i++){const n=e.getValueRef(i),s=t.transformVec3(n);n.set(s.x,s.y,s.z)}this.setBoundingBoxDirty()}get boundingBox(){return this.__boundingBoxDirty&&this.updateBoundingBox(),this.__boundingBox}setBoundingBoxDirty(){this.__boundingBoxDirty=!0,this.emit("boundingBoxChanged",{})}updateBoundingBox(){const t=this.vertices,e=new v,i=t.length;for(let n=0;n<i;n++)e.addPoint(t.getValueRef(n));this.__boundingBox=e,this.__boundingBoxDirty=!1}getMetadata(t){return this.__metaData.get(t)}hasMetadata(t){return this.__metaData.has(t)}setMetadata(t,e){this.__metaData.set(t,e)}deleteMetadata(t){this.__metaData.delete(t)}genBuffers(t){const e={};for(const[i,n]of this.__vertexAttributes)e[i]={values:n.data,count:n.size,dataType:n.dataType,normalized:n.normalized};return{numVertices:this.numVertices(),attrBuffers:e}}freeBuffers(){}loadBaseGeomBinary(t){this.name=t.loadStr();const e=t.loadUInt8();this.debugColor=t.loadRGBFloat32Color();const i=t.loadUInt32();this.__boundingBox.set(t.loadFloat32Vec3(),t.loadFloat32Vec3()),this.setNumVertices(i);const n=this.vertices;let s,o;2&e&&(s=this.getVertexAttribute("normals"),s||(s=this.addVertexAttribute("normals",Z,0))),4&e&&(o=this.getVertexAttribute("texCoords"),o||(o=this.addVertexAttribute("texCoords",_,0)));const r=(t,e,i,s)=>{for(let o=t[0];o<t[1];o++){const t=new Z(s[3*o+0]/255,s[3*o+1]/255,s[3*o+2]/255);t.multiplyInPlace(i),t.addInPlace(e),n.setValue(o,t)}},a=(t,e,i,n)=>{i.isNull()&&i.set(1,1,1);for(let o=t[0];o<t[1];o++){const t=new Z(n[3*o+0]/255,n[3*o+1]/255,n[3*o+2]/255);t.multiplyInPlace(i),t.addInPlace(e),t.normalizeInPlace(),s.setValue(o,t)}},l=(t,e,i,n)=>{for(let s=t[0];s<t[1];s++){const t=new _(n[2*s+0]/255,n[2*s+1]/255);t.multiplyInPlace(i),t.addInPlace(e),o.setValue(s,t)}},c=t.loadUInt32();if(1==c){{const e=this.__boundingBox,n=t.loadUInt8Array(3*i);r([0,i],e.p0,e.diagonal(),n)}if(s){const e=new v(t.loadFloat32Vec3(),t.loadFloat32Vec3()),n=t.loadUInt8Array(3*i);a([0,i],e.p0,e.diagonal(),n),s.loadSplitValues(t)}if(o){const e=new L(t.loadFloat32Vec2(),t.loadFloat32Vec2()),n=t.loadUInt8Array(2*i);l([0,i],e.p0,e.diagonal(),n),o.loadSplitValues(t)}}else{const e=[];let n=0;for(let i=0;i<c;i++){const i=t.loadUInt32(),r={range:[n,n+i],bbox:new v(t.loadFloat32Vec3(),t.loadFloat32Vec3())};s&&(r.normalsRange=new v(t.loadFloat32Vec3(),t.loadFloat32Vec3())),o&&(r.texCoordsRange=new L(t.loadFloat32Vec2(),t.loadFloat32Vec2())),e.push(r),n+=i}const h=t.loadUInt8Array(3*i);let d,u;s&&(d=t.loadUInt8Array(3*i)),o&&(u=t.loadUInt8Array(2*i));for(let t=0;t<c;t++){{const i=e[t].bbox;r(e[t].range,i.p0,i.diagonal(),h)}if(s){const i=e[t].normalsRange;a(e[t].range,i.p0,i.diagonal(),d)}if(o){const i=e[t].texCoordsRange;l(e[t].range,i.p0,i.diagonal(),u)}}s&&s.loadSplitValues(t),o&&o.loadSplitValues(t)}}toJSON(t,e){let i=super.toJSON(t,e);if(i||(i={}),i.type=J.getClassName(this),!(1024&e)){const n={};for(const[i,s]of this.__vertexAttributes.entries())n[i]=s.toJSON(t,e);i.vertexAttributes=n}return i}fromJSON(t,e,i){super.fromJSON(t,e,i);for(const n in t.vertexAttributes){let e=this.__vertexAttributes.get(n);const i=t.vertexAttributes[n];if(!e){const t=g.getType(i.dataType);e=new VertexAttribute(this,t,0,i.defaultScalarValue),this.__vertexAttributes.set(n,e)}e.fromJSON(i)}}toString(){return JSON.stringify(this.toJSON(),null,2)}}class Mt extends vt{constructor(t,e,i,n){super(e,i,n),this.__geom=t,this.__splits={},this.__splitValues=[]}getFaceVertexValueRef(t,e){const i=this.__geom.getFaceVertexIndex(t,e);return i in this.__splits&&t in this.__splits[i]?this.__splitValues[this.__splits[i][t]]:this.getValueRef(i)}setFaceVertexValue(t,e,i){const n=this.__geom.getFaceVertexIndex(t,e);this.setFaceVertexValue_ByVertexIndex(t,n,i)}setFaceVertexValue_ByVertexIndex(t,e,i){const n=this.getValueRef(e);if(n.isValid())if(n.approxEqual(i));else{if(e in this.__splits){const n=this.__splits[e];for(const e in n){const s=n[e];if(this.__splitValues[s].approxEqual(i))return void(n[t]=s)}if(t in this.__splits[e])return void this.__splitValues[this.__splits[e][t]].setFromOther(i)}else this.__splits[e]={};this.__splits[e][t]=this.__splitValues.length,this.__splitValues.push(i)}else n.setFromOther(i)}setSplitVertexValue(t,e,i){if(t in this.__splits||(this.__splits[t]={}),e in this.__splits[t]){if(this.__splitValues[this.__splits[t][e]].approxEqual(i))return;console.warn("Face Vertex Already Split with different value")}this.__splits[t][e]=this.__splitValues.length,this.__splitValues.push(i)}setSplitVertexValues(t,e,i){t in this.__splits||(this.__splits[t]={});const n=this.__splitValues.length;this.__splitValues.push(i);for(const s of e)this.__splits[t][s]=n}getSplits(){return this.__splits}getSplitCount(){let t=0;for(const e in this.__splits)t+=Object.keys(this.__splits[e]).length;return t}generateSplitValues(t,e){if(0==e)return this.__data;const i=this.length,n=this.length+e,s=this.__dataType.numElements?this.__dataType.numElements():1,o=new Float32Array(n*s);for(let r=0;r<this.__data.length;r++)o[r]=this.__data[r];for(const r in t){const e=t[r];for(const t in e){const n=i+e[t];if(r in this.__splits&&t in this.__splits[r]){const e=this.__splits[r][t];6==this.__dataType?o[n*s]=this.__splitValues[e]:this.__dataType.createFromFloat32Buffer(o.buffer,n*s).setFromOther(this.__splitValues[e])}else{const t=parseInt(r);for(let e=0;e<s;e++)t*s+e>this.__data.length&&console.log("Error remapping src:"+t*s+e),n*s+e>o.length&&console.log("Error remapping tgt:"+n*s+e),o[n*s+e]=this.__data[t*s+e]}}}return o}toJSON(t,e){const i=super.toJSON(t,e);return i.splits=this.__splits,i.splitValues=this.__splitValues,i}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__splits=t.splits,this.__splitValues=[];for(const n of t.splitValues)this.__splitValues.push(this.__dataType.createFromJSON(n))}loadSplitValues(t){const e=t.loadUInt32Array();if(0==e.length)return;let i=0,n=0;for(;;){const t=e[i++],s=e[i++],o={};for(let r=0;r<s;r++){const t=e[i++],s=e[i++];o[t]=s,s>=n&&(n=s+1)}if(this.__splits[t]=o,i>=e.length)break}const s=this.__numFloat32Elements,o=t.loadFloat32Array(n*s);this.__splitValues=[];for(let r=0;r<n;r++){const t=this.__dataType.createFromFloat32Array(o.slice(r*s,r*s+s));this.__splitValues.push(t)}}}class Yt extends Ft{constructor(){super()}loadBin(t){this.name=t.loadStr();const e=t.loadUInt32();this.__boundingBox.set(t.loadFloat32Vec3(),t.loadFloat32Vec3()),this.setNumVertices(e);const i=this.vertices;if(e<256){const n=this.__boundingBox.toMat4(),s=t.loadUInt8Array(3*e);for(let t=0;t<e;t++){const e=new Vec3(s[3*t+0]/255,s[3*t+1]/255,s[3*t+2]/255);i.setValue(t,n.transformVec3(e))}}else{const n=t.loadUInt32(),s=[];for(let e=0;e<n;e++){const e=t.loadUInt32Vec2(),i=t.loadFloat32Vec3(),n=t.loadFloat32Vec3();s.push({range:e,bbox:new Box3(i,n)})}const o=t.loadUInt8Array(3*e);for(let t=0;t<n;t++){const e=s[t].bbox.toMat4();for(let n=s[t].range.x;n<s[t].range.y;n++){const t=new Vec3(o[3*n+0]/255,o[3*n+1]/255,o[3*n+2]/255);i.setValue(n,e.transformVec3(t))}}}}readBinary(t,e){super.loadBaseGeomBinary(t),this.emit("geomDataChanged",{})}}class Ct extends Ft{constructor(){super(),this.__indices=new Uint32Array,this.__segmentAttributes=new Map,this.lineThickness=0}getIndices(){return this.__indices}getNumSegments(){return this.__indices.length/2}setNumSegments(t){const e=new Uint32Array(2*t);this.__indices=e}setSegment(t,e,i){if(t>=this.__indices.length/2)throw new Error("Invalid line index:"+t+". Num Segments:"+this.__indices.length/2);this.__indices[2*t+0]=e,this.__indices[2*t+1]=i}getSegmentVertexIndex(t,e){if(t<this.numLines)return this.__indices[2*t+e]}addSegmentAttribute(t,e,i){const n=new Attribute(e,null!=i?i:this.polygonCount);return this.__segmentAttributes.set(t,n),n}hasSegmentAttribute(t){return this.__segmentAttributes.has(t)}getSegmentAttribute(t){return this.__segmentAttributes.get(t)}genBuffers(){const t=super.genBuffers();let e;return t.numVertices<Math.pow(2,8)?(e=new Uint8Array(this.__indices.length),this.__indices.forEach((t,i)=>{e[i]=t})):t.numVertices<Math.pow(2,16)?(e=new Uint16Array(this.__indices.length),this.__indices.forEach((t,i)=>{e[i]=t})):e=this.__indices,t.indices=e,t}readBinary(t,e){super.loadBaseGeomBinary(t),this.setNumSegments(t.loadUInt32());const i=t.loadUInt8();1==i?this.__indices=t.loadUInt8Array():2==i?this.__indices=t.loadUInt16Array():4==i&&(this.__indices=t.loadUInt32Array()),this.geomDataChanged.emit()}toJSON(t,e){const i=super.toJSON(t,e);return 1024&e||(i.indices=Array.from(this.__indices)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__indices=Uint32Array.from(t.indices)}}class Nt extends Ft{constructor(){super(),this.init()}init(){this.__faceCounts=[],this.__faceVertexCounts=new Uint8Array,this.__faceOffsets=new Uint32Array,this.__faceVertexIndices=new Uint32Array,this.__numPopulatedFaceVertexIndices=0,this.__faceAttributes=new Map,this.__edgeAttributes=new Map,this.__logTopologyWarnings=!1,this.edgeVerts=void 0,this.vertexEdges=void 0,this.numEdges=0,this.edgeFlags=new Uint32Array,this.edgeAngles=new Float32Array}getFaceVertexIndices(){return this.__faceVertexIndices}getFaceCounts(){return this.__faceCounts}clear(){this.__faceVertexIndices=void 0,this.__faceCounts=[],this.__numPopulatedFaceVertexIndices=0}setFaceCounts(t){if(this.__numPopulatedFaceVertexIndices)throw new Error("Cannot set face counts on a mesh that is already populated. Please call 'clear' before re-building the mesh.");this.__faceCounts=t;let e=0,i=0,n=3;for(const s of this.__faceCounts)e+=s,i+=s*n,n++;this.__faceVertexCounts=new Uint8Array(e),this.__faceOffsets=new Uint32Array(e),this.__faceVertexIndices=new Uint32Array(i);for(const s of this.__faceAttributes)s.resize(e)}setFaceVertexIndices(t){const e=Array.prototype.slice.call(arguments,1),i=this.__numPopulatedFaceVertexIndices;for(let n=0;n<e.length;n++)this.__faceVertexIndices[i+n]=e[n];this.__faceVertexCounts[t]=e.length-3,this.__faceOffsets[t]=i,this.__numPopulatedFaceVertexIndices+=e.length}getFaceVertexIndices(t){const e=[],i=this.__faceOffsets[t],n=this.__faceVertexCounts[t]+3;for(let s=0;s<n;s++)e.push(this.__faceVertexIndices[i+s]);return e}getFaceVertexIndex(t,e){return this.__faceVertexIndices[this.__faceOffsets[t]+e]}getNumFaces(){return this.__faceVertexCounts.length}addVertexAttribute(t,e,i){const n=new Mt(this,e,null!=this.vertices?this.vertices.length:0,i);return this.__vertexAttributes.set(t,n),n}addFaceAttribute(t,e,i){const n=new vt(e,null!=i?i:this.getNumFaces());return this.__faceAttributes.set(t,n),n}hasFaceAttribute(t){return this.__faceAttributes.has(t)}getFaceAttribute(t){return this.__faceAttributes.get(t)}addEdgeAttribute(t,e,i){const n=new vt(e,null!=i?i:this.getNumEdges());return this.__edgeAttributes.set(t,n),n}hasEdgeAttribute(t){return this.__edgeAttributes.has(t)}getEdgeAttribute(t){return this.__edgeAttributes.get(t)}genTopologyInfo(){const t={};this.vertexEdges=[],this.edgeFaces=[],this.edgeVerts=[],this.faceEdges=[],this.numEdges=0;const e=(e,i)=>{let n=e,s=i;if(s<n){const t=n;n=s,s=t}const o=n+">"+s;if(o in t)return t[o];const r=this.vertices.getValueRef(n),a=this.vertices.getValueRef(s).subtract(r),l={edgeIndex:this.edgeFaces.length/2,edgeVec:a};return t[o]=l,this.edgeFaces.push(-1),this.edgeFaces.push(-1),this.edgeVerts.push(n),this.edgeVerts.push(s),this.numEdges++,l},i=(t,i,n)=>{const s=e(t,i).edgeIndex;if(i<t){const t=2*s+0;this.__logTopologyWarnings&&-1!=this.edgeFaces[t]&&console.warn("Edge poly 0 already set. Mesh is non-manifold."),this.edgeFaces[t]=n}else{const t=2*s+1;this.__logTopologyWarnings&&-1!=this.edgeFaces[t]&&console.warn("Edge poly 1 already set. Mesh is non-manifold."),this.edgeFaces[t]=n}n in this.faceEdges||(this.faceEdges[n]=[]),this.faceEdges[n].push(s),null==this.vertexEdges[t]&&(this.vertexEdges[t]=new Set),null==this.vertexEdges[i]&&(this.vertexEdges[i]=new Set),this.vertexEdges[t].add(s),this.vertexEdges[i].add(s)},n=this.getNumFaces();for(let s=0;s<n;s++){const t=this.getFaceVertexIndices(s);for(let e=0;e<t.length;e++)i(t[e],t[(e+1)%t.length],s)}}computeFaceNormals(){const t=this.vertices,e=this.addFaceAttribute("normals",Z),i=this.getNumFaces();for(let n=0;n<i;n++){const i=this.getFaceVertexIndices(n),s=t.getValueRef(i[0]);let o=t.getValueRef(i[1]);const r=new Z;for(let e=2;e<i.length;e++){const n=t.getValueRef(i[e]),a=o.subtract(s),l=n.subtract(s);r.addInPlace(a.cross(l).normalize()),o=n}r.lengthSquared(),e.setValue(n,r.normalize())}}generateEdgeFlags(){null==this.vertexEdges&&this.genTopologyInfo(),this.hasFaceAttribute("normals")||this.computeFaceNormals();const t=this.vertices,e=this.getFaceAttribute("normals");this.edgeVecs=[],this.edgeAngles=new Float32Array(this.numEdges);for(let i=0;i<this.edgeFaces.length;i+=2){const n=this.edgeVerts[i],s=t.getValueRef(this.edgeVerts[i+1]).subtract(t.getValueRef(n));s.normalizeInPlace(),this.edgeVecs.push(s);const o=this.edgeFaces[i],r=this.edgeFaces[i+1];if(-1==o||-1==r){this.edgeAngles[i/2]=2*Math.PI;continue}const a=e.getValueRef(o),l=e.getValueRef(r);this.edgeAngles[i/2]=a.angleTo(l)}}computeVertexNormals(t=1){this.generateEdgeFlags();const e=this.getFaceAttribute("normals"),i=this.addVertexAttribute("normals",Z),n=e.data.buffer,s=t=>new Z(n,12*t),o=i.data,r=(t,e)=>{o[3*t+0]=e.x,o[3*t+1]=e.y,o[3*t+2]=e.z},a=(t,e)=>{let i,n;const s=this.faceEdges[t];for(const o of s)(this.edgeVerts[2*o]==e||this.edgeVerts[2*o+1]==e)&&(i?n=this.edgeVecs[o]:i=this.edgeVecs[o]);return[i,n]};for(let l=0;l<this.vertexEdges.length;l++){if(null==this.vertexEdges[l])continue;const e=this.vertexEdges[l],n=[],o=t=>{let e=!1;for(const i of n)if(e=-1!=i.indexOf(t),e)break;e||n.push([t])};for(const i of e){const e=this.edgeFaces[2*i],s=this.edgeFaces[2*i+1];if(-1!=e&&-1==s&&this.edgeAngles[i]<t){let t=-1,i=-1;for(let o=0;o<n.length;o++)-1==t&&-1!=n[o].indexOf(e)&&(t=o),-1==i&&-1!=n[o].indexOf(s)&&(i=o);-1==t&&-1==i?n.push([e,s]):-1!=t&&-1!=i?t!=i&&(n[t]=n[t].concat(n[i]),n.splice(i,1)):(-1==t&&n[i].push(e),-1==i&&n[t].push(s))}else-1!=e&&o(e),-1!=s&&o(s)}n.sort((t,e)=>t.length<e.length?1:t.length>e.length?-1:0);let c=!0;for(const t of n){const e=new Z;for(const i of t){const t=a(i,l),n=t[0].angleTo(t[1]);e.addInPlace(s(i).scale(n))}e.normalizeInPlace(),c?(r(l,e),c=!1):i.setSplitVertexValues(l,t,e)}}return i}computeNumTriangles(){let t=3,e=0;for(const i of this.__faceCounts)e+=i*(t-2),t++;return e}generateTriangulatedIndices(t,e,i){const n=this.computeNumTriangles();let s;s=t<Math.pow(2,8)?new Uint8Array(3*n):t<Math.pow(2,16)?new Uint16Array(3*n):new Uint32Array(3*n);let o=0;const r=function(t,n){t in i&&n in i[t]&&(t=e+i[t][n]),s[o]=t,o++},a=this.getNumFaces();for(let l=0;l<a;l++){const t=this.getFaceVertexIndices(l);for(let e=0;e<t.length;e++)e>=3&&(r(t[0],l),r(t[e-1],l)),r(t[e],l)}return s}computeHardEdgesIndices(t=1){const e=[],i=t=>{e.push(this.edgeVerts[t]),e.push(this.edgeVerts[t+1])};for(let n=0;n<this.edgeFlags.length;n+=2)this.edgeAngles[n/2]>t&&i(n);return e}getWireframeIndices(){return indices}genBuffers(t){const e={};let i=0;for(const[,l]of this.__vertexAttributes){const t=l.getSplits();for(const n in t){n in e||(e[n]={});const s=t[n];for(const t in s){const s=parseInt(t);s in e[n]||(e[n][s]=i,i++)}}}const n=this.vertices.length,s=n+i;let o;t&&0==t.includeIndices||(o=this.generateTriangulatedIndices(s,n,e));const r={};for(const[l,c]of this.__vertexAttributes){let t;t=0==i?c.data:c.generateSplitValues(e,i);const n=c.numElements;r[l]={values:t,count:t.length/n,dimension:n,normalized:"normals"==l,dataType:c.dataType}}const a={numVertices:this.numVertices(),numRenderVerts:s,indices:o,attrBuffers:r};if(t&&t.includeVertexNeighbors){null==this.vertexEdges&&this.genTopologyInfo();let t=0;for(let o=0;o<this.vertexEdges.length;o++)this.vertexEdges[o]&&(t+=this.vertexEdges[o].size);const e=new Uint32Array(2*this.vertexEdges.length+t),i=t=>{for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<e;n++){const s=t[n];if(-1!=i[0]&&i[0]==s[1]){e!=n+1&&(t.splice(e,1),t.splice(n+1,0,i));break}if(-1!=i[1]&&i[1]==s[0]){t.splice(e,1),t.splice(n,0,i);break}}}},n=t=>{if(!(-1!=t[0][0]&&-1!=t[t.length-1][1]||-1==t[0][0]&&-1==t[t.length-1][1]))throw new Error("If fan starts with -1, it must also end with -1");for(let e=0;e<t.length;e++){const i=t[e];if((-1==i[0]||-1==i[1])&&0!=e&&e!=t.length-1)throw new Error("-1 only allowed at the beginning and end of a fan.");if(-1!=i[0]){let n=e-1;if(n<0&&(n+=t.length),i[0]!=t[n][1])throw new Error("Faces are not sequential")}if(-1!=i[1]&&i[1]!=t[(e+1)%t.length][0])throw new Error("Faces are not sequential")}};let s=2*this.vertexEdges.length;for(let o=0;o<this.vertexEdges.length;o++){if(null==this.vertexEdges[o])continue;const t=this.vertexEdges[o],r=[];for(const e of t){const t=this.edgeVerts[2*e],i=this.edgeVerts[2*e+1];let n,s=this.edgeFaces[2*e],a=this.edgeFaces[2*e+1];if(t==o)n=i;else{if(i!=o)throw new Error("Invalid topology");{n=t;const e=s;s=a,a=e}}r.push([s,a,n])}i(r),n(r);let a=0;(-1!=r[0][0]||-1!=r[r.length-1][1])&&(a+=1),e[2*o]=s,e[2*o+1]=t.size+(a<<8);for(const i of r)e[s]=i[2],s++}a.vertexNeighbors=e}return a}freeBuffers(){super.freeBuffers(),this.init()}readBinary(t,e){super.loadBaseGeomBinary(t),this.setFaceCounts(t.loadUInt32Array()),this.__faceVertexCounts=t.loadUInt8Array(this.__faceVertexCounts.length);const i=t.loadSInt32Vec2(),n=t.loadUInt8();let s;1==n?s=t.loadUInt8Array():2==n?s=t.loadUInt16Array():4==n&&(s=t.loadUInt32Array());const o=this.getNumFaces();let r=0,a=0;for(let c=0;c<o;c++){const t=this.__faceVertexCounts[c]+3;this.__faceOffsets[c]=r;for(let e=0;e<t;e++){const t=r+e,n=s[t]+i.x;if(0==c)this.__faceVertexIndices[t]=n;else{let i=this.__faceOffsets[c-1];i+=e<a?e:a-1,this.__faceVertexIndices[t]=this.__faceVertexIndices[i]+n}}r+=t,a=t}this.__numPopulatedFaceVertexIndices=r;const l=t.loadUInt32();if(l>0){const e=this.vertices,i=this.addVertexAttribute("lightmapCoords",_);for(let n=0;n<l;n++){const n=new S(t.loadFloat32Vec3(),t.loadFloat32Quat()),s=t.loadFloat32(),o=t.loadFloat32Vec2(),r=t.loadSInt32Vec2(),a=t.loadUInt8();let l;l=1==a?t.loadUInt8Array():2==a?t.loadUInt16Array():t.loadUInt32Array();let c=0;for(const t of l){let a=t+r.x;a+=c,c=a;const l=this.getFaceVertexIndices(a);for(const t of l){const r=e.getValueRef(t),l=n.transformVec3(r),c=new _(l.x,l.z);c.scaleInPlace(s),c.addInPlace(o),i.setFaceVertexValue_ByVertexIndex(a,t,c)}}}}this.hasVertexAttribute("normals")||this.computeVertexNormals(),this.emit("geomDataChanged",{})}toJSON(t,e){const i=super.toJSON(t,e);return 1024&e||(i.faceCounts=Array.from(this.__faceCounts),i.faceVertexIndices=Array.from(this.__faceVertexIndices)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.faceCounts&&(this.__faceCounts=Uint32Array.from(t.faceCounts)),t.faceVertexIndices&&(this.__faceVertexIndices=Uint32Array.from(t.faceVertexIndices))}}class Kt extends U{constructor(t){if(super(),this.name=t.name,this.__buffers=t.geomBuffers,this.__buffers.attrBuffers)for(const e in this.__buffers.attrBuffers){const t=this.__buffers.attrBuffers[e],i=g.getType(t.dataType);t.dataType=i}this.boundingBox=new v,this.boundingBox.p0.__data=t.bbox.p0.__data,this.boundingBox.p1.__data=t.bbox.p1.__data,this.__metaData=new Map}genBuffers(){return this.__buffers}freeBuffers(){if(this.__buffers.indices&&delete this.__buffers.indices,this.__buffers.attrBuffers){for(const t in this.__buffers.attrBuffers)delete this.__buffers.attrBuffers[t];delete this.__buffers.attrBuffers}}getMetadata(t){return this.__metaData.get(t)}hasMetadata(t){return this.__metaData.has(t)}setMetadata(t,e){this.__metaData.set(t,e)}}class wt extends Kt{constructor(t){super(t)}}class zt extends Kt{constructor(t){super(t)}}class Ut extends Kt{constructor(t){super(t)}}class Jt extends Yt{constructor(t=1,e=1,i=1,n=1,s=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__x=t,this.__y=e,this.__xDivisions=i,this.__yDivisions=n,s&&this.addVertexAttribute("texCoords",_),this.__rebuild()}get x(){return console.warn("getter is deprectated. Please use 'getX'"),this.getX()}set x(t){console.warn("getter is deprectated. Please use 'setX'"),this.setX(t)}get y(){return console.warn("getter is deprectated. Please use 'getY'"),this.getY()}set y(t){console.warn("getter is deprectated. Please use 'setY'"),this.setY(t)}getX(){return this.__x}setX(t){this.__x=t,this.__resize()}getY(){return this.__y}setY(t){this.__y=t,this.__resize()}setSize(t,e){this.__x=t,this.__y=e,this.__resize()}__rebuild(){this.setNumVertices(this.__xDivisions*this.__yDivisions);const t=this.getVertexAttribute("texCoords");if(t)for(let e=0;e<this.__yDivisions;e++){const i=e/(this.__yDivisions-1);for(let n=0;n<this.__xDivisions;n++){const s=n/(this.__xDivisions-1);t.getValueRef(e*this.__xDivisions+n).set(s,i)}}this.__resize()}__resize(){for(let t=0;t<this.__yDivisions;t++){const e=(t/(this.__yDivisions-1)-.5)*this.__y;for(let i=0;i<this.__xDivisions;i++){const n=(i/(this.__xDivisions-1)-.5)*this.__x;this.getVertex(t*this.__xDivisions+i).set(n,e,0)}}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t.xDivisions=this.__xDivisions,t.yDivisions=this.__yDivisions,t}}class Pt extends Ct{constructor(t=1,e=1){if(super(),isNaN(t)||isNaN(e))throw new Error("Invalid geom args");this.__x=this.addParameter(new Ze("x",t)),this.__x.addListener("valueChanged",this.__resize.bind(this)),this.__y=this.addParameter(new Ze("y",e)),this.__y.addListener("valueChanged",this.__resize.bind(this)),this.__rebuild()}get x(){return this.__x.getValue()}set x(t){this.__x.setValue(t)}get y(){return this.__y.getValue()}set y(t){this.__y.setValue(t)}setSize(t,e){this.__x.setValue(t,-1),this.__y.setValue(e,-1),this.__resize()}__rebuild(){this.setNumVertices(4),this.setNumSegments(4),this.setSegment(0,0,1),this.setSegment(1,1,2),this.setSegment(2,2,3),this.setSegment(3,3,0),this.__resize(-1),this.emit("geomDataTopologyChanged",{})}__resize(t){const e=this.__x.getValue(),i=this.__y.getValue();this.getVertex(0).set(-.5*e,-.5*i,0),this.getVertex(1).set(.5*e,-.5*i,0),this.getVertex(2).set(.5*e,.5*i,0),this.getVertex(3).set(-.5*e,.5*i,0),this.setBoundingBoxDirty(),-1!=t&&this.emit("geomDataChanged",{})}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t}}J.registerClass("Rect",Pt);class Et extends Ct{constructor(t=1,e=32,i=2*Math.PI){if(super(),isNaN(t)||isNaN(e))throw new Error("Invalid geom args");this.__radius=this.addParameter(new Ze("Radius",t)),this.__angle=this.addParameter(new Ze("Angle",i)),this.__numSegments=this.addParameter(new Ze("NumSegments",e>=3?e:3,[3,200],1));const n=()=>{this.__rebuild()};this.__radius.addListener("valueChanged",()=>{this.__resize()}),this.__angle.addListener("valueChanged",n),this.__numSegments.addListener("valueChanged",n),this.__rebuild()}__rebuild(){const t=this.__numSegments.getValue();this.setNumVertices(t);const e=this.__angle.getValue()<2*Math.PI;this.setNumSegments(e?t-1:t);for(let i=0;i<(e?t-1:t);i++)this.setSegment(i,i,(i+1)%t);this.__resize(-1),this.emit("geomDataTopologyChanged",{})}__resize(t){const e=this.__radius.getValue(),i=this.__numSegments.getValue(),n=this.__angle.getValue()/i;for(let s=0;s<i;s++)this.getVertex(s).set(Math.cos(n*s)*e,Math.sin(n*s)*e,0);this.setBoundingBoxDirty(),-1!=t&&this.emit("geomDataChanged",{})}}J.registerClass("Circle",Et);class Ht extends Ct{constructor(t=1){if(super(),isNaN(t))throw new Error("Invalid geom args");this.__sizeParam=this.addParameter(new Ze("size",t)),this.__rebuild(),this.__sizeParam.addListener("valueChanged",()=>{this.__resize()})}get size(){return this.__size}set size(t){this.__size=t,this.__resize()}__rebuild(){this.setNumVertices(6),this.setNumSegments(3),this.setSegment(0,0,1),this.setSegment(1,2,3),this.setSegment(2,4,5),this.__resize()}__resize(){const t=this.__sizeParam.getValue();this.getVertex(0).set(-.5*t,0,0),this.getVertex(1).set(.5*t,0,0),this.getVertex(2).set(0,.5*t,0),this.getVertex(3).set(0,-.5*t,0),this.getVertex(4).set(0,0,.5*t),this.getVertex(5).set(0,0,-.5*t),this.setBoundingBoxDirty()}}J.registerClass("Cross",Ht);class kt extends Ct{constructor(t=1,e=1,i=1,n=!1){super(),this.__x=this.addParameter(new Ze("x",t)),this.__y=this.addParameter(new Ze("y",e)),this.__z=this.addParameter(new Ze("z",i)),this.__baseZAtZero=this.addParameter(new Ze("BaseZAtZero",n)),this.__rebuild();const s=()=>{this.__resize()};this.__x.addListener("valueChanged",s),this.__y.addListener("valueChanged",s),this.__z.addListener("valueChanged",s),this.__baseZAtZero.addListener("valueChanged",()=>{this.__rebuild()})}__rebuild(){this.setNumVertices(8),this.setNumSegments(12),this.setSegment(0,0,1),this.setSegment(1,1,2),this.setSegment(2,2,3),this.setSegment(3,3,0),this.setSegment(4,4,5),this.setSegment(5,5,6),this.setSegment(6,6,7),this.setSegment(7,7,4),this.setSegment(8,0,4),this.setSegment(9,1,5),this.setSegment(10,2,6),this.setSegment(11,3,7),this.__resize(-1),this.emit("geomDataTopologyChanged",{})}__resize(t){const e=this.__x.getValue(),i=this.__y.getValue(),n=this.__z.getValue(),s=this.__baseZAtZero.getValue();let o=.5;s&&(o=1),this.getVertex(0).set(.5*e,-.5*i,o*n),this.getVertex(1).set(.5*e,.5*i,o*n),this.getVertex(2).set(-.5*e,.5*i,o*n),this.getVertex(3).set(-.5*e,-.5*i,o*n),o=-.5,s&&(o=0),this.getVertex(4).set(.5*e,-.5*i,o*n),this.getVertex(5).set(.5*e,.5*i,o*n),this.getVertex(6).set(-.5*e,.5*i,o*n),this.getVertex(7).set(-.5*e,-.5*i,o*n),this.setBoundingBoxDirty(),-1!=t&&this.emit("geomDataChanged",{})}toJSON(){const t=super.toJSON();return t.size=this.__size,t}}J.registerClass("LinesCuboid",kt);class Bt extends Ct{constructor(t=1,e=1,i=10,n=10,s=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__xParam=this.addParameter(new Ze("x",t)),this.__yParam=this.addParameter(new Ze("y",e)),this.__xDivisionsParam=this.addParameter(new Ze("xDivisions",i)),this.__yDivisionsParam=this.addParameter(new Ze("yDivisions",n)),this.__skipCenterLinesParam=this.addParameter(new Xe("skipCenterLines",s)),this.__rebuild()}get sizeX(){return this.__x}set sizeX(t){this.__x=t,this.__resize()}get sizeY(){return this.__y}set sizeY(t){this.__y=t,this.__resize()}get divisionsX(){return this.__xDivisions}set divisionsX(t){this.__xDivisions=t,this.__rebuild()}get divisionsY(){return this.__yDivisions}set divisionsY(t){this.__yDivisions=t,this.__rebuild()}setSize(t,e){this.__x=t,this.__y=e,this.__resize()}__rebuild(){const t=this.__xDivisionsParam.getValue(),e=this.__yDivisionsParam.getValue(),i=this.__skipCenterLinesParam.getValue()&&t%2==0&&e%2==0;this.setNumVertices(2*(t+e+2-(i?1:0))),this.setNumSegments(t+e+2-(i?1:0));let n=0;for(let s=0;s<=t;s++)i&&s==t/2||(this.setSegment(n,2*n,2*n+1),n++);for(let s=0;s<=e;s++)i&&s==t/2||(this.setSegment(n,2*n,2*n+1),n++);this.__resize()}__resize(){const t=this.__xDivisionsParam.getValue(),e=this.__yDivisionsParam.getValue(),i=this.__xParam.getValue(),n=this.__yParam.getValue(),s=this.__skipCenterLinesParam.getValue()&&t%2==0&&e%2==0;let o=0;for(let r=0;r<=t;r++){if(s&&r==t/2)continue;const e=2*o+1,a=(r/t-.5)*i;this.getVertex(2*o).set(a,-.5*n,0),this.getVertex(e).set(a,.5*n,0),o++}for(let r=0;r<=e;r++){if(s&&r==t/2)continue;const a=2*o+1,l=(r/e-.5)*n;this.getVertex(2*o).set(-.5*i,l,0),this.getVertex(a).set(.5*i,l,0),o++}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.z=this.__y,t.xDivisions=this.__xDivisions,t.yDivisions=this.__yDivisions,t}}J.registerClass("Grid",Bt);class Dt extends Nt{constructor(t=.5,e=1,i=32,n=!0){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze("radius",t)),this.__heightParam=this.addParameter(new Ze("height",e)),this.__detailParam=this.addParameter(new Ze("detail",i>=3?i:3,[3,200],1)),this.__capParam=this.addParameter(new Xe("cap",n)),this.addVertexAttribute("texCoords",_),this.addVertexAttribute("normals",Z),this.__rebuild();const s=()=>{this.__resize()},o=()=>{this.__rebuild()};this.__radiusParam.addListener("valueChanged",s),this.__heightParam.addListener("valueChanged",s),this.__detailParam.addListener("valueChanged",o),this.__capParam.addListener("valueChanged",o)}get radius(){return this.__radiusParam.getValue()}set radius(t){this.__radiusParam.setValue(t),this.__resize()}get height(){return this.__heightParam.getValue()}set height(t){this.__heightParam.setValue(t),this.__resize()}get detail(){return this.__detailParam.getValue()}set detail(t){this.__detailParam.setValue(t),this.__rebuild()}get cap(){return this.__capParam.getValue()}set cap(t){this.__capParam.setValue(t),this.__rebuild()}__rebuild(){this.clear();const t=this.__detailParam.getValue(),e=this.__radiusParam.getValue(),i=this.__heightParam.getValue(),n=this.__capParam.getValue();let s=t+1;n&&(s+=1),this.setNumVertices(s);const o=t,r=t+1;this.getVertex(o).set(0,0,i);for(let u=0;u<t;u++){const i=u/t*2*Math.PI;this.getVertex(u).set(e*Math.cos(i),e*Math.sin(i),0)}n&&this.getVertex(r).set(0,0,0),this.setFaceCounts([t+(n?t:0)]);for(let u=0;u<t;u++)this.setFaceVertexIndices(u,(u+1)%t,u,o);if(n)for(let u=0;u<t;u++)this.setFaceVertexIndices(t+u,u,(u+1)%t,r);const a=this.getVertexAttribute("normals");let l;const c=i;Math.abs(i)<1e-12&&(l=i<0?-1e-12:1e-12),l=e/c;let h=0;for(let u=0;u<t;u++){const e=(u+1)/t*2*Math.PI,i=u/t*2*Math.PI,n=.5*(e+i);a.setFaceVertexValue(h,0,new Z(Math.cos(e),l,Math.sin(e)).normalize()),a.setFaceVertexValue(h,1,new Z(Math.cos(i),l,Math.sin(i)).normalize()),a.setFaceVertexValue(h,2,new Z(Math.cos(n),l,Math.sin(n)).normalize()),h++}if(n){const e=new Z(0,-1,0);for(let i=0;i<t;i++)a.setFaceVertexValue(h,0,e),a.setFaceVertexValue(h,1,e),a.setFaceVertexValue(h,2,e),h++}const d=this.getVertexAttribute("texCoords");h=0;for(let u=0;u<t;u++)d.setFaceVertexValue(h,0,new _((u+1)/t,0)),d.setFaceVertexValue(h,1,new _(u/t,0)),d.setFaceVertexValue(h,2,new _((u+.5)/t,1));if(n)for(let u=0;u<t;u++)d.setFaceVertexValue(h,0,new _(u/t,0)),d.setFaceVertexValue(h,1,new _((u+1)/t,0)),d.setFaceVertexValue(h,2,new _((u+.5)/t,1)),h++;this.setBoundingBoxDirty()}__resize(){const t=this.__detailParam.getValue(),e=this.__radiusParam.getValue(),i=this.__heightParam.getValue(),n=(this.__capParam.getValue(),t),s=t+1;this.getVertex(n).set(0,0,i);for(let o=0;o<t;o++){const i=o/t*2*Math.PI;this.getVertex(o).set(e*Math.cos(i),e*Math.sin(i),0)}this.__cap&&this.getVertex(s).set(0,0,0),this.setBoundingBoxDirty()}}J.registerClass("Cone",Dt);class Ot extends Nt{constructor(t=1,e=1,i=1,n=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__xParam=this.addParameter(new Ze("x",t)),this.__yParam=this.addParameter(new Ze("y",e)),this.__zParam=this.addParameter(new Ze("z",i)),this.__baseZAtZeroParam=this.addParameter(new Xe("baseZAtZero",n)),this.setFaceCounts([0,6]),this.setFaceVertexIndices(0,0,1,2,3),this.setFaceVertexIndices(1,7,6,5,4),this.setFaceVertexIndices(2,1,0,4,5),this.setFaceVertexIndices(3,3,2,6,7),this.setFaceVertexIndices(4,0,3,7,4),this.setFaceVertexIndices(5,2,1,5,6),this.setNumVertices(8),this.addVertexAttribute("texCoords",_),this.addVertexAttribute("normals",Z),this.__rebuild();const s=()=>{this.__resize()};this.__xParam.addListener("valueChanged",s),this.__yParam.addListener("valueChanged",s),this.__zParam.addListener("valueChanged",s),this.__baseZAtZeroParam.addListener("valueChanged",s)}setSize(t,e,i){this.__xParam.setValue(t),this.__yParam.setValue(e),this.__zParam.setValue(i)}setBaseSize(t,e){this.__xParam.setValue(t),this.__yParam.setValue(e)}__rebuild(){const t=this.getVertexAttribute("normals");for(let i=0;i<6;i++){let e;switch(i){case 0:e=new Z(0,0,1);break;case 1:e=new Z(0,0,-1);break;case 2:e=new Z(1,0,0);break;case 3:e=new Z(-1,0,0);break;case 4:e=new Z(0,1,0);break;case 5:e=new Z(0,-1,0)}t.setFaceVertexValue(i,0,e),t.setFaceVertexValue(i,1,e),t.setFaceVertexValue(i,2,e),t.setFaceVertexValue(i,3,e)}const e=this.getVertexAttribute("texCoords");for(let i=0;i<6;i++)e.setFaceVertexValue(i,0,new _(0,0)),e.setFaceVertexValue(i,1,new _(1,0)),e.setFaceVertexValue(i,2,new _(1,1)),e.setFaceVertexValue(i,3,new _(0,1));this.__resize()}__resize(t){const e=this.__xParam.getValue(),i=this.__yParam.getValue(),n=this.__zParam.getValue(),s=this.__baseZAtZeroParam.getValue();let o=.5;s&&(o=1),this.getVertex(0).set(.5*e,-.5*i,o*n),this.getVertex(1).set(.5*e,.5*i,o*n),this.getVertex(2).set(-.5*e,.5*i,o*n),this.getVertex(3).set(-.5*e,-.5*i,o*n),o=-.5,s&&(o=0),this.getVertex(4).set(.5*e,-.5*i,o*n),this.getVertex(5).set(.5*e,.5*i,o*n),this.getVertex(6).set(-.5*e,.5*i,o*n),this.getVertex(7).set(-.5*e,-.5*i,o*n),this.setBoundingBoxDirty(),this.emit("geomDataChanged",{})}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t.z=this.__z,t}}J.registerClass("Cuboid",Ot);class Qt extends Nt{constructor(t=.5,e=1,i=32,n=2,s=!0,o=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze("radius",t)),this.__heightParam=this.addParameter(new Ze("height",e)),this.__sidesParam=this.addParameter(new Ze("sides",i>=3?i:3,[3,200],1)),this.__loopsParam=this.addParameter(new Ze("loops",n>=2?n:2,[1,200],1)),this.__capsParam=this.addParameter(new Xe("caps",s)),this.__baseZAtZeroParam=this.addParameter(new Xe("baseZAtZero",o)),this.addVertexAttribute("texCoords",_),this.addVertexAttribute("normals",Z),this.__rebuild();const r=()=>{this.__resize()},a=()=>{this.__rebuild()};this.__radiusParam.addListener("valueChanged",r),this.__heightParam.addListener("valueChanged",r),this.__sidesParam.addListener("valueChanged",a),this.__loopsParam.addListener("valueChanged",a),this.__capsParam.addListener("valueChanged",a),this.__baseZAtZeroParam.addListener("valueChanged",r)}__rebuild(){this.clear();const t=this.__sidesParam.getValue(),e=this.__loopsParam.getValue(),i=this.__capsParam.getValue();let n=t*e;i&&(n+=2),this.setNumVertices(n),this.setFaceCounts(i?[2*t,t]:[0,t]);let s=0;for(let a=0;a<e-1;a++)for(let e=0;e<t;e++)this.setFaceVertexIndices(s++,t*a+(e+1)%t,t*a+e,t*(a+1)+e,t*(a+1)+(e+1)%t);if(i){for(let e=0;e<t;e++)this.setFaceVertexIndices(s++,n-1,e,(e+1)%t);for(let i=0;i<t;i++)this.setFaceVertexIndices(s++,t*(e-1)+i,n-2,t*(e-1)+(i+1)%t)}const o=this.getVertexAttribute("normals");s=0;for(let a=0;a<e-1;a++)for(let e=0;e<t;e++){let i=e/t*2*Math.PI;const n=new Z(Math.sin(i),Math.cos(i),0);o.setFaceVertexValue(s,0,n),o.setFaceVertexValue(s,1,n),i=(e+1)/t*2*Math.PI;const r=new Z(Math.sin(i),Math.cos(i),0);o.setFaceVertexValue(s,2,r),o.setFaceVertexValue(s,3,r),s++}if(i){const e=new Z(0,0,-1);for(let i=0;i<t;i++)o.setFaceVertexValue(s,0,e),o.setFaceVertexValue(s,1,e),o.setFaceVertexValue(s,2,e),s++;e.set(0,0,1);for(let i=0;i<t;i++)o.setFaceVertexValue(s,0,e),o.setFaceVertexValue(s,1,e),o.setFaceVertexValue(s,2,e),s++}const r=this.getVertexAttribute("texCoords");s=0;for(let a=0;a<t;a++)r.setFaceVertexValue(s,0,new _((a+1)/t,0)),r.setFaceVertexValue(s,2,new _((a+1)/t,1)),r.setFaceVertexValue(s,1,new _(a/t,0)),r.setFaceVertexValue(s,3,new _(a/t,1)),s++;if(i){for(let e=0;e<t;e++)r.setFaceVertexValue(s,0,new _(e/t,0)),r.setFaceVertexValue(s,1,new _((e+1)/t,0)),r.setFaceVertexValue(s,2,new _((e+.5)/t,1)),s++;for(let e=0;e<t;e++)r.setFaceVertexValue(s,0,new _(e/t,0)),r.setFaceVertexValue(s,1,new _((e+1)/t,0)),r.setFaceVertexValue(s,2,new _((e+.5)/t,1)),s++}this.emit("geomDataTopologyChanged",{}),this.__resize()}__resize(){const t=this.__sidesParam.getValue(),e=this.__loopsParam.getValue(),i=this.__radiusParam.getValue(),n=this.__heightParam.getValue(),s=this.__capsParam.getValue(),o=this.__baseZAtZeroParam.getValue();let r=t*e;s&&(r+=2);let a=0,l=.5;o&&(l=0);for(let c=0;c<e;c++){const s=c/(e-1)*n-n*l;for(let e=0;e<t;e++){const n=e/t*2*Math.PI;this.getVertex(a).set(Math.sin(n)*i,Math.cos(n)*i,s),a++}}s&&(this.getVertex(r-1).set(0,0,n*(o?0:-.5)),this.getVertex(r-2).set(0,0,n*(o?1:.5))),this.setBoundingBoxDirty(),this.emit("geomDataChanged",{})}}J.registerClass("Cylinder",Qt);class At extends Nt{constructor(t=.5,e=32){if(super(),isNaN(t)||isNaN(e))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze("radius",t)),this.__sidesParam=this.addParameter(new Ze("sides",e>=3?e:3,[3,200],1)),this.addVertexAttribute("texCoords",_),this.addVertexAttribute("normals",Z),this.__rebuild()}get radius(){return this.__radius}set radius(t){this.__radius=t,this.__resize()}set sides(t){this.__sides=t>=3?t:3,this.__rebuild()}__rebuild(){const t=this.__sidesParam.getValue();this.setNumVertices(t+1),this.setFaceCounts([t]),this.getVertex(0).set(0,0,0);for(let s=0;s<t;s++)this.setFaceVertexIndices(s,0,s%t+1,(s+1)%t+1);const e=this.getVertexAttribute("normals"),i=new Z(0,0,1);e.setValue(0,i);for(let s=0;s<t;s++)e.setValue(s+1,i);const n=this.getVertexAttribute("texCoords");n.getValueRef(0).set(.5,.5);for(let s=0;s<t;s++){const e=s/t*2*Math.PI;n.getValueRef(s+1).set(.5*Math.sin(e)+.5,.5*Math.cos(e)+.5)}this.setBoundingBoxDirty(),this.__resize()}__resize(){const t=this.__sidesParam.getValue(),e=this.__radiusParam.getValue();for(let i=0;i<t;i++){const n=i/t*2*Math.PI;this.getVertex(i+1).set(Math.sin(n)*e,Math.cos(n)*e,0)}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.radius=this.__radius,t}}J.registerClass("Disc",At);class jt extends Nt{constructor(t=1,e=1,i=1,n=1,s=!0,o=!0){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__sizeXParam=this.addParameter(new Ze("SizeX",t)),this.__sizeYParam=this.addParameter(new Ze("SizeY",e)),this.__detailXParam=this.addParameter(new Ze("DetailX",i)),this.__detailYParam=this.addParameter(new Ze("DetailY",n)),s&&this.addVertexAttribute("normals",Z),o&&this.addVertexAttribute("texCoords",_),this.__rebuild();const r=()=>{this.__resize()},a=()=>{this.__rebuild()};this.__sizeXParam.addListener("valueChanged",r),this.__sizeYParam.addListener("valueChanged",r),this.__detailXParam.addListener("valueChanged",a),this.__detailYParam.addListener("valueChanged",a)}__rebuild(){const t=this.__detailXParam.getValue(),e=this.__detailYParam.getValue();this.setNumVertices((t+1)*(e+1)),this.setFaceCounts([0,t*e]);let i=0;for(let r=0;r<e;r++)for(let e=0;e<t;e++)this.setFaceVertexIndices(i,(t+1)*(r+1)+e,(t+1)*(r+1)+(e+1),(t+1)*r+(e+1),(t+1)*r+e),i+=1;let n=0;const s=this.getVertexAttribute("normals");if(s)for(let r=0;r<=e;r++)for(let e=0;e<=t;e++)s.getValueRef(n).set(0,0,1),n++;n=0;const o=this.getVertexAttribute("texCoords");if(o)for(let r=0;r<=e;r++){const i=r/e;for(let e=0;e<=t;e++){const s=e/t;o.getValueRef(n).set(s,i),n++}}this.__resize(!1),this.emit("geomDataTopologyChanged",{})}__resize(t=!0){const e=this.__sizeXParam.getValue(),i=this.__sizeYParam.getValue(),n=this.__detailXParam.getValue(),s=this.__detailYParam.getValue();let o=0;for(let r=0;r<=s;r++){const t=(r/s-.5)*i;for(let i=0;i<=n;i++){const s=(i/n-.5)*e;this.getVertex(o).set(s,t,0),o++}}this.setBoundingBoxDirty(),t&&this.emit("geomDataChanged",{})}}class qt extends Nt{constructor(t=1,e=12,i=12){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze("radius",t)),this.__sidesParam=this.addParameter(new Ze("sides",e>=3?e:3,[3,200],1)),this.__loopsParam=this.addParameter(new Ze("loops",i>=3?i:3,[3,200],1)),this.addVertexAttribute("texCoords",_),this.addVertexAttribute("normals",Z),this.__rebuild();const n=()=>{this.__rebuild()};this.__radiusParam.addListener("valueChanged",()=>{this.__resize()}),this.__sidesParam.addListener("valueChanged",n),this.__loopsParam.addListener("valueChanged",n)}__rebuild(){const t=this.__radiusParam.getValue(),e=this.__sidesParam.getValue(),i=this.__loopsParam.getValue(),n=2+e*i,s=2*e,o=e*i;this.setNumVertices(n),this.setFaceCounts([s,o]);const r=this.getVertexAttribute("normals"),a=new Z(0,0,1);let l=0;this.getVertex(l).set(0,0,t),r.getValueRef(l).set(0,0,1),l++;for(let d=0;d<i;d++){const n=(d+1)/(i+1)*Math.PI;for(let i=0;i<e;i++){const s=i/e*2*Math.PI;a.set(Math.sin(n)*Math.cos(s),Math.sin(n)*Math.sin(s),Math.cos(n)),this.getVertex(l).setFromOther(a.scale(t)),r.getValueRef(l).setFromOther(a),l++}}this.getVertex(l).set(0,0,-t),r.getValueRef(l).set(0,0,-1),l++;const c=this.getVertexAttribute("texCoords");let h=0;for(let d=0;d<e;d++){this.setFaceVertexIndices(h,0,(d+1)%e+1,d+1);const t=new _(.5,0),n=new _(1-(d+1)/e,0),s=new _(1-d/e,1/(i+1));c.setFaceVertexValue(h,0,t),c.setFaceVertexValue(h,1,n),c.setFaceVertexValue(h,2,s),h++}for(let d=0;d<e;d++){this.setFaceVertexIndices(h,n-1,e*(i-1)+d+1,e*(i-1)+(d+1)%e+1);const t=new _(1-d/e,i/(i+1)),s=new _(1-(d+1)/e,i/(i+1)),o=new _(.5,1);c.setFaceVertexValue(h,0,t),c.setFaceVertexValue(h,1,s),c.setFaceVertexValue(h,2,o),h++}for(let d=0;d<i-1;d++)for(let t=0;t<e;t++)this.setFaceVertexIndices(h,e*d+t+1,e*d+(t+1)%e+1,e*(d+1)+(t+1)%e+1,e*(d+1)+t+1),c.setFaceVertexValue(h,0,new _(d/i,t/i)),c.setFaceVertexValue(h,1,new _(d/i,(t+1)/i)),c.setFaceVertexValue(h,2,new _((d+1)/i,(t+1)/i)),c.setFaceVertexValue(h,3,new _((d+1)/i,t/i)),h++;this.setBoundingBoxDirty(),this.emit("geomDataTopologyChanged",{})}__resize(){const t=this.__radiusParam.getValue(),e=this.__sidesParam.getValue(),i=this.__loopsParam.getValue();let n=0;const s=new Z(0,0,1);this.getVertex(n).set(0,0,t),n++;for(let o=0;o<i;o++){const r=(o+1)/(i+1)*Math.PI;for(let i=0;i<e;i++){const o=i/e*2*Math.PI;s.set(Math.sin(r)*Math.cos(o),Math.sin(r)*Math.sin(o),Math.cos(r)),this.getVertex(n).setFromOther(s.scale(t)),n++}}this.getVertex(n).set(0,0,-t),n++,this.setBoundingBoxDirty(),this.emit("geomDataChanged",{})}}J.registerClass("Sphere",qt);class $t extends Nt{constructor(t=.5,e=1,i=32){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__innerRadius=t,this.__outerRadius=e,this.__detail=i>=3?i:3,this.addVertexAttribute("texCoords",_),this.addVertexAttribute("normals",Z),this.__rebuild()}get innerRadius(){return this.__innerRadius}set innerRadius(t){this.__innerRadius=t,this.__resize()}get outerRadius(){return this.__outerRadius}set outerRadius(t){this.__outerRadius=t,this.__resize()}get detail(){return this.__detail}set detail(t){this.__detail=t>=3?t:3,this.__rebuild()}__rebuild(){const t=this.__detail,e=2*this.__detail;this.setNumVertices(t*e),this.setFaceCounts([0,t*e]);const i=this.getVertexAttribute("normals");let n=0;for(let r=0;r<e;r++){const s=r/e*2*Math.PI,o=Math.cos(s),a=Math.sin(s);for(let e=0;e<t;e++){const s=e/t*2*Math.PI,r=Math.sin(s),l=Math.cos(s),c=this.__outerRadius+l*this.__innerRadius;this.getVertex(n).set(o*c,a*c,this.__innerRadius*r),i.getValueRef(n).set(o*l,a*l,r),n++}}const s=this.getVertexAttribute("texCoords");let o=0;for(let r=0;r<e;r++)for(let i=0;i<t;i++){const n=(r+1)%e,a=(i+1)%t;this.setFaceVertexIndices(o,t*r+i,t*r+a,t*n+a,t*n+i),s.setFaceVertexValue(o,0,new _(r/e,i/e)),s.setFaceVertexValue(o,1,new _(r/e,(i+1)/e)),s.setFaceVertexValue(o,2,new _((r+1)/e,(i+1)/e)),s.setFaceVertexValue(o,3,new _((r+1)/e,i/e)),o++}this.setBoundingBoxDirty()}__resize(){const t=this.__detail,e=2*this.__detail;for(let i=0;i<e;i++){const n=i/e*2*Math.PI,s=Math.cos(n),o=Math.sin(n);for(let e=0;e<t;e++){const i=e/t*2*Math.PI,n=Math.sin(i),r=Math.cos(i),a=this.__outerRadius+r*this.__innerRadius;this.getVertex(0).set(s*a,o*a,this.__innerRadius*n),index++}}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t.z=this.__z,t}}const ea={SAVE_FLAG_SKIP_CHILDREN:1},ta={LOAD_FLAG_LOADING_BIN_TREE_VALUES:16},aa={CLONE_FLAG_INSTANCED_TREE:1};let ia=new y$2("#03E3AC");ia.a=.1;let sa=ia.lerp(new y$2("white"),.5);sa.a=.1;class na extends te{constructor(t){super(t),this.__visibleCounter=1,this.__visible=!0,this.__highlightMapping={},this.__highlights=[],this.__childItems=[],this.__childItemsSignalIds=[],this.__childItemsMapping={},this.__visibleParam=this.addParameter(new Xe("Visible",!0)),this.__localXfoParam=this.addParameter(new Se("LocalXfo",new S)),this.__globalXfoParam=this.addParameter(new Se("GlobalXfo",new S)),this.__boundingBoxParam=this.addParameter(new Q("BoundingBox",new v)),this._cleanGlobalXfo=this._cleanGlobalXfo.bind(this),this._setGlobalXfoDirty=this._setGlobalXfoDirty.bind(this),this._setBoundingBoxDirty=this._setBoundingBoxDirty.bind(this),this._cleanBoundingBox=this._cleanBoundingBox.bind(this),this.__localXfoParam.on("valueChanged",this._setGlobalXfoDirty);const e=()=>{const t=this.__globalXfoParam.getValue();return void 0!==this.__ownerItem?this.__ownerItem.getGlobalXfo().inverse().multiply(t):t};this.__globalXfoParam.on("valueChanged",t=>{t.mode!=E.OPERATOR_DIRTIED&&this.__localXfoParam.setDirty(e),this._setBoundingBoxDirty(),this.emit("globalXfoChanged",t)}),this.__visibleParam.on("valueChanged",()=>{this.__visibleCounter+=this.__visibleParam.getValue()?1:-1,this.__updateVisiblity()}),this.on("selectedChanged",()=>{this.__selected?this.addHighlight("selected",ia,!0):this.removeHighlight("selected",!0)})}static get SaveFlags(){return ea}static get LoadFlags(){return ta}static get CloneFlags(){return aa}static getSelectionOutlineColor(){return ia}static setSelectionOutlineColor(t){ia=t}static getBranchSelectionOutlineColor(){return sa}static setBranchSelectionOutlineColor(t){sa=t}_childFlagsChanged(t){0!=(t&H.USER_EDITED)&&this.setFlag($.USER_EDITED)}setFlag(t){super.setFlag(t),this.__ownerItem&&this.__ownerItem._childFlagsChanged(t)}setOwner(t){if(this.__ownerItem){this.__ownerItem.removeListener("globalXfoChanged",this._setGlobalXfoDirty),this.__ownerItem.getVisible()||this.__visibleCounter++;const t=this.__ownerItem.getChildIndex(this);t>=0&&this.__ownerItem.__unbindChild(t,this)}super.setOwner(t),this._setGlobalXfoDirty(),this.__ownerItem&&(this.setSelectable(this.__ownerItem.getSelectable(),!0),this.__ownerItem.getVisible()||this.__visibleCounter--,this.__ownerItem.addListener("globalXfoChanged",this._setGlobalXfoDirty)),this.__updateVisiblity()}__updatePath(){super.__updatePath();for(const t of this.__childItems)t&&t.__updatePath()}getParentItem(){return this.getOwner()}setParentItem(t){this.setOwner(t)}getLocalXfo(){return this.__localXfoParam.getValue()}setLocalXfo(t,e){this.__localXfoParam.setValue(t,e)}getGlobalXfo(t){return this.__globalXfoParam.getValue(t)}setGlobalXfo(t,e){const i=this.getOwner();if(i){const n=i.getGlobalXfo().inverse().multiply(t);this.__localXfoParam.setValue(n,e)}else this.__globalXfoParam.setValue(t,e)}_cleanGlobalXfo(t){const e=this.getParentItem(),i=this.__localXfoParam.getValue();return void 0!==e?e.getGlobalXfo().multiply(i):i}_setGlobalXfoDirty(){this.__globalXfoParam.setDirty(this._cleanGlobalXfo)}getVisible(){return this.__visibleCounter>0}setVisible(t){this.__visibleParam.setValue(t)}propagateVisiblity(t){this.__visibleCounter+=t,this.__updateVisiblity()}__updateVisiblity(){const t=this.__visibleCounter>0;if(t!=this.__visible){this.__visible=t;for(const t of this.__childItems)t instanceof na&&t.propagateVisiblity(this.__visible?1:-1);return this.emit("visibilityChanged",{visible:t}),!0}return!1}addHighlight(t,e,i=!1){if(t in this.__highlightMapping){const e=this.__highlights.indexOf(t);this.__highlights.splice(e,1)}this.__highlights.push(t),this.__highlightMapping[t]=e,this.emit("highlightChanged",{name:t,color:e}),i&&this.__childItems.forEach(n=>{n instanceof na&&n.addHighlight(t,e,i)})}removeHighlight(t,e=!1){if(t in this.__highlightMapping){const e=this.__highlights.indexOf(t);this.__highlights.splice(e,1),delete this.__highlightMapping[t],this.emit("highlightChanged",{})}e&&this.__childItems.forEach(i=>{i instanceof na&&i.removeHighlight(t,e)})}getHighlight(){if(this.__highlights.length>0)return this.__highlightMapping[this.__highlights[this.__highlights.length-1]]}isHighlighted(){return this.__highlights.length>0}get boundingBox(){return console.warn("getter is deprectated. Please use 'getBoundingBox'"),this.getBoundingBox()}getBoundingBox(){return this.__boundingBoxParam.getValue()}_cleanBoundingBox(t){return t.reset(),this.__childItems.forEach(e=>{e instanceof na&&e.getVisible()&&!e.testFlag($.IGNORE_BBOX)&&t.addBox3(e.getBoundingBox())}),t}_childBBoxChanged(){this._setBoundingBoxDirty()}_setBoundingBoxDirty(){this.__boundingBoxParam&&this.__boundingBoxParam.setDirty(this._cleanBoundingBox)}getChildren(){return this.__childItems}numChildren(){return console.warn("Deprecated method. Please use getNumChildren"),this.__childItems.length}getNumChildren(){return this.__childItems.length}generateUniqueName(t){if(!(t in this.__childItemsMapping))return t;let e=1;t.length>4&&!Number.isNaN(parseInt(t.substring(t.length-4)))?e=parseInt(t.substr(t.length-4)):t.length>3&&!Number.isNaN(parseInt(t.substring(t.length-3)))?e=parseInt(t.substr(t.length-3)):t.length>2&&!Number.isNaN(parseInt(t.substring(t.length-2)))&&(e=parseInt(t.substr(t.length-2)));const i=[];for(const s of this.__childItems)s&&i.push(s.getName());let n=t;for(;;){let s=""+e;for(;s.length<2;)s="0"+s;if(n=t+s,-1==i.indexOf(n))break;e++}return n}__updateMapping(t){for(let e=t;e<this.__childItems.length;e++)this.__childItemsMapping[this.__childItems[e].getName()]=e}insertChild(t,e,i=!1,n=!0){if(t.getName()in this.__childItemsMapping){if(!n)throw new Error("Item '"+t.getName()+"' is already a child of :"+this.getPath());t.setName(this.generateUniqueName(t.getName()))}if(!(t instanceof te))throw new Error("Object is is not a tree item :"+t.constructor.name);const s={};let o;return s.nameChangedId=t.addListener("nameChanged",t=>{const e=this.__childItemsMapping[t.oldName];delete this.__childItemsMapping[t.oldName],this.__childItemsMapping[t.newName]=e}),t instanceof na&&(i&&(o=this.getGlobalXfo().inverse().multiply(t.getGlobalXfo())),s.bboxChangedId=t.addListener("boundingChanged",()=>{this._setBoundingBoxDirty()}),s.visChangedId=t.addListener("visibilityChanged",this._setBoundingBoxDirty)),this.__childItems.splice(e,0,t),this.__childItemsSignalIds.splice(e,0,s),this.__childItemsMapping[t.getName()]=e,this.__updateMapping(e),t.setOwner(this),t instanceof na&&(i&&t.setLocalXfo(o),this._setBoundingBoxDirty()),t.testFlag($.USER_EDITED)&&this.setFlag($.USER_EDITED),this.emit("childAdded",{childItem:t,index:e}),t}addChild(t,e=!0,i=!0){const n=this.__childItems.length;return this.insertChild(t,n,e,i),n}getChild(t){return this.__childItems[t]}getChildByName(t){const e=this.__childItemsMapping[t];return null!=e?this.__childItems[e]:null}getChildNames(){const t=[];for(let e=0;e<this.__childItems.length;e++){const i=this.__childItems[e];null!=i&&(t[e]=i.getName())}return t}__unbindChild(t,e){const i=this.__childItemsSignalIds[t];e.removeListenerById("nameChanged",i.nameChangedId),e instanceof na&&(e.removeListenerById("boundingChanged",i.bboxChangedId),e.removeListenerById("visibilityChanged",i.visChangedId)),this.__childItems.splice(t,1),this.__childItemsSignalIds.splice(t,1),delete this.__childItemsMapping[e.getName()],this.__updateMapping(t),e instanceof na&&this._setBoundingBoxDirty(),this.emit("childRemoved",{childItem:e,index:t})}removeChild(t){const e=this.__childItems[t];e&&(this.__unbindChild(t,e),e.setOwner(void 0))}removeChildByName(t){const e=this.__childItemsMapping[t];return null!=e?this.removeChild(e):null}removeChildByHandle(t){console.warn("Deprecated method. Please use removeChild");const e=this.__childItems.indexOf(t);if(-1==e)throw new Error("Error in removeChildByHandle. Child not found:"+t.getName());this.removeChild(e)}removeAllChildren(){let t=this.__childItems.length;for(;t--;)this.removeChild(t);this._setBoundingBoxDirty()}getChildIndex(t){return this.__childItems.indexOf(t)}indexOfChild(t){return console.warn("Deprecated method. Please use getChildIndex"),this.getChildIndex(t)}resolvePath(t,e=0){if("string"==typeof t&&(t=t.split("/")),0==e)if("."==t[0]||t[0]==this.__name)e++;else if(".."==t[0])return this.__ownerItem.resolvePath(t,e+1);if(e==t.length)return this;const i=this.getChildByName(t[e]);return null==i?this.getParameter(t[e])||null:i.resolvePath(t,e+1)}traverse(t,e=!0){const i=(t,e)=>{const i=t.getChildren();for(const s of i)s&&n(s,e+1)},n=(e,n)=>{if(0==t(e,n))return!1;e instanceof na&&i(e,n)};e?n(this,1):i(this,0)}onMouseDown(t){this.emit("mouseDown",t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseDown(t)}onMouseUp(t){this.emit("mouseUp",t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseUp(t)}onMouseMove(t){this.emit("mouseMove",t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseMove(t)}onMouseEnter(t){this.emit("mouseEnter",t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseEnter(t)}onMouseLeave(t){this.emit("mouseLeave",t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseLeave(t)}onWheel(t){t.propagating&&this.__ownerItem&&this.__ownerItem.onWheel(t)}toJSON(t,e){if(!this.testFlag($.USER_EDITED))return;const i=super.toJSON(t,e);if(!(e&ea.SAVE_FLAG_SKIP_CHILDREN)){const n={};for(const i of this.__childItems)if(i){const s=i.toJSON(t,e);s&&(n[i.getName()]=s)}Object.keys(n).length>0&&(i?i.children=n:i={name:this.__name,children:n})}return i}fromJSON(t,e,i){if(super.fromJSON(t,e,i),e.numTreeItems++,this.setFlag($.USER_EDITED),null!=t.children){const n=t.children;if(Array.isArray(n))for(const t of n){let n=this.getChildByName(t.name);n?n.fromJSON(t,e,i):t.type&&(n=J.constructClass(t.type),n&&(n.fromJSON(t,e,i),this.addChild(n,!1,!1)))}else for(const t in n){const s=n[t];let o=this.getChildByName(t);o?o.fromJSON(s,e,i):s.type&&(o=J.constructClass(s.type),o&&(o.fromJSON(s,e,i),this.addChild(o,!1,!1)))}}}readBinary(t,e){super.readBinary(t,e),e.numTreeItems++;const i=t.loadUInt8();if(4&i){const e=new S;e.tr=t.loadFloat32Vec3(),e.ori=t.loadFloat32Quat(),e.sc.set(t.loadFloat32()),this.__localXfoParam.setValue(e,E.DATA_LOAD)}8&i&&this.__boundingBoxParam.setValue(new v(t.loadFloat32Vec3(),t.loadFloat32Vec3()),E.DATA_LOAD);const n=t.loadUInt32();if(n>0){const i=t.loadUInt32Array(n);for(let s=0;s<n;s++)try{t.seek(i[s]);let n=t.loadStr();if(n.startsWith("N")&&n.endsWith("E")){const t=n.indexOf("podium");-1!=t&&(n=parseInt(n[t+7])?n.substring(t+8,n.length-1):n.substring(t+7,n.length-1)),-1!=n.indexOf("livenurbs")&&(n=n.substring(n.indexOf("CAD"),n.length-1))}const o=J.constructClass(n);if(!o){const e=t.loadStr();console.warn("Unable to construct child:"+e+" of type:"+n);continue}t.seek(i[s]),o.readBinary(t,e),o.setFlag($.BIN_NODE),this.addChild(o,!1,!1)}catch(t){console.warn("Error loading tree item: ",t)}}}clone(t){const e=new na;return e.copyFrom(this,t),e}copyFrom(t,e){super.copyFrom(t,e),t.getChildren().forEach(t=>{t&&this.addChild(t.clone(e),!1,!1)})}destroy(){this.removeAllChildren(),super.destroy()}}J.registerClass("TreeItem",na);class la extends na{constructor(t){super(t)}setSrcTree(t,e){if(this.__srcTree=t,0==this.__srcTree.getNumChildren()){const t=this.__srcTree.clone(e);t.setLocalXfo(new S,E.DATA_LOAD),this.addChild(t,!1)}else this.__srcTree.getChildren().forEach(t=>{const i=t.clone(e);this.addChild(i,!1)})}getSrcTree(){return this.__srcTree}readBinary(t,e={}){super.readBinary(t,e);const i=t.loadStrArray();e.resolvePath(i,t=>{this.setSrcTree(t,e)})}toJSON(t={},e=0){return super.toJSON(t,e)}fromJSON(t,e={},i=0,n){}}J.registerClass("InstanceItem",la);class ra extends na{constructor(t){super(t),this.__loaded=!1;const e=this.addParameter(new Te("FilePath"));let i,n;const s=()=>{i=window.ZeaAudioaudioCtx.createBufferSource(),i.buffer=n,i.loop=l.getValue(),i.muted=a.getValue(),i.start(0),this.emit("audioSourceCreated",{audioSource:i})};e.addListener("valueChanged",()=>{const t=new XMLHttpRequest;t.open("GET",e.getURL(),!0),t.responseType="arraybuffer",t.onload=()=>{window.ZeaAudioaudioCtx.decodeAudioData(t.response,t=>{n=t,this.__loaded=!0,this.emit("loaded",{}),o.getValue()&&s()},t=>{console.log("Error with decoding audio data"+t.err)})},t.send()});const o=this.addParameter(new Xe("Autoplay",!1)),r=this.addParameter(new Ze("PlayState",0));r.addListener("valueChanged",()=>{if(mode.mode!=E.CUSTOM)switch(r.getValue()){case 0:this.__loaded&&i&&(i.stop(0),i=void 0);break;case 1:this.__loaded&&s()}}),this.isPlaying=()=>0!=r.getValue(),this.play=()=>{r.setValue(1,E.CUSTOM)},this.stop=()=>{r.setValue(0,E.CUSTOM)},this.pause=()=>{r.setValue(0,E.CUSTOM)},this.getAudioSource=()=>i;const a=this.addParameter(new Xe("Mute",!1));this.addParameter(new Ze("Gain",1)).setRange([0,5]);const l=this.addParameter(new Xe("Loop",!1));this.addParameter(new Xe("SpatializeAudio",!0)),this.addParameter(new Ze("refDistance",2)),this.addParameter(new Ze("maxDistance",1e4)),this.addParameter(new Ze("rolloffFactor",1)),this.addParameter(new Ze("coneInnerAngle",360)),this.addParameter(new Ze("coneOuterAngle",0)),this.addParameter(new Ze("coneOuterGain",1)),a.addListener("valueChanged",()=>{i&&(i.muted=a.getValue())}),l.addListener("valueChanged",()=>{i&&(i.loop=l.getValue())}),this.mute=t=>{a.setValue(t,E.CUSTOM)},this.loaded=!1}isLoaded(){return this.__loaded}setAudioStream(){this.__loaded=!0,this.emit("loaded",{}),this.emit("audioSourceCreated",{audioSource})}}class da extends ra{constructor(t){}}class oa extends na{constructor(t){super(t),this.overlay=!1,this.__cutAway=!1,this.__cutAwayVector=!1,this.__cutAwayDist=!1,this.__layers=[]}setOverlay(t){this.overlay=t}isOverlay(){return this.overlay}addLayer(t){this.__layers.push(t)}getLayers(){return this.__layers}isCutawayEnabled(){return this.__cutAway}setCutawayEnabled(t){this.__cutAway=t,this.emit("cutAwayChanged",{})}getCutVector(){return this.__cutAwayVector}setCutVector(t){this.__cutAwayVector=t,this.emit("cutAwayChanged",{})}getCutDist(){return this.__cutAwayDist}setCutDist(t){this.__cutAwayDist=t,this.emit("cutAwayChanged",{})}readBinary(t,e){if(super.readBinary(t,e),e.versions["zea-engine"].greaterOrEqualThan([0,0,4])){const i=t.loadStr();let n=e.assetItem.getMaterialLibrary().getMaterial(i,!1);if(n||(n=new Pe(i,"SimpleSurfaceShader"),n.getParameter("BaseColor").setValue(y$2.random(.25),E.DATA_LOAD),e.assetItem.getMaterialLibrary().addMaterial(n)),this.setMaterial(n,E.DATA_LOAD),this.__layers=t.loadStrArray(),this.__layers.length>0)for(const t of this.__layers)e.addGeomToLayer(this,t)}}}class ha extends oa{constructor(t,e,i){super(t),this.__geomParam=this.insertParameter(new Ke("Geometry"),0),this._setBoundingBoxDirty=this._setBoundingBoxDirty.bind(this),this.__geomParam.addListener("valueChanged",this._setBoundingBoxDirty),this.__geomParam.addListener("boundingBoxChanged",this._setBoundingBoxDirty),this.__materialParam=this.insertParameter(new Wt("Material"),1),this.__paramMapping.material=this.getParameterIndex(this.__materialParam),this.__lightmapCoordOffset=new _,this.__geomOffsetXfoParam=this.addParameter(new Se("GeomOffsetXfo")),this.__geomMatParam=this.addParameter(new Re("GeomMat")),this.__cleanGeomMat=this.__cleanGeomMat.bind(this),this.__globalXfoParam.addListener("valueChanged",()=>{this.__geomMatParam.setDirty(this.__cleanGeomMat)}),this.__geomOffsetXfoParam.addListener("valueChanged",()=>{this.__geomMatParam.setDirty(this.__cleanGeomMat)}),this.__geomMatParam.addListener("valueChanged",t=>{this.emit("geomXfoChanged",t)}),this.__materialParam.addListener("valueChanged",t=>{this.emit("materialAssigned",t)}),this.__geomParam.addListener("valueChanged",t=>{this.emit("geomAssigned",t)}),e&&this.setGeometry(e,E.DATA_LOAD),i&&this.setMaterial(i,E.DATA_LOAD)}__cleanGeomMat(){const t=this.__globalXfoParam.getValue().toMat4(),e=this.__geomOffsetXfoParam.getValue().toMat4();return t.multiply(e)}getGeometry(){return this.__geomParam.getValue()}setGeometry(t,e){this.__geomParam.setValue(t,e)}getGeom(){return console.warn("getGeom is deprectated. Please use 'getGeometry'"),this.getGeometry()}setGeom(t){return console.warn("setGeom is deprectated. Please use 'setGeometry'"),this.setGeometry(t)}getMaterial(){return this.__materialParam.getValue()}setMaterial(t,e){this.__materialParam.setValue(t,e)}_cleanBoundingBox(t){t=super._cleanBoundingBox(t);const e=this.getGeometry();return e&&t.addBox3(e.boundingBox,this.getGeomMat4()),t}getGeomOffsetXfo(){return this.__geomOffsetXfoParam.getValue()}setGeomOffsetXfo(t){this.__geomOffsetXfoParam.setValue(t)}getGeomMat4(){return this.__geomMatParam.getValue()}getLightmapName(){return this.__lightmapName}getLightmapCoordsOffset(){return this.__lightmapCoordOffset}applyAssetLightmapSettings(t,e){this.__lightmap=t,this.__lightmapCoordOffset.addInPlace(e)}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e){super.fromJSON(t,e),e.numGeomItems++}readBinary(t,e){super.readBinary(t,e),e.numGeomItems++,this.__lightmapName=e.assetItem.getName();const i=t.loadUInt8(),n=t.loadUInt32(),s=e.assetItem.getGeometryLibrary(),o=s.getGeom(n);if(o)this.setGeometry(o,E.DATA_LOAD);else{this.geomIndex=n;const t=t=>{const{range:i}=t;if(n>=i[0]&&n<i[1]){const t=s.getGeom(n);t?this.setGeometry(t,E.DATA_LOAD):console.warn("Geom not loaded:",this.getName()),s.removeListenerById("rangeLoaded",e)}},e=s.addListener("rangeLoaded",t)}if(4&i&&this.__geomOffsetXfoParam.setValue(new S(t.loadFloat32Vec3(),t.loadFloat32Quat(),t.loadFloat32Vec3())),e.versions["zea-engine"].lessThan([0,0,4]))if(8&i){const i=e.assetItem.getMaterialLibrary(),n=t.loadStr();let s=i.getMaterial(n);s||(console.warn("Geom :'"+this.name+"' Material not found:"+n),s=i.getMaterial("Default")),this.setMaterial(s,E.DATA_LOAD)}else this.setMaterial(e.assetItem.getMaterialLibrary().getMaterial("Default"),E.DATA_LOAD);this.__lightmapCoordOffset=t.loadFloat32Vec2()}toString(){return JSON.stringify(this.toJSON(),null,2)}clone(t){const e=new ha;return e.copyFrom(this,t),e}copyFrom(t,e){if(super.copyFrom(t,e),this.__lightmapCoordOffset=t.__lightmapCoordOffset,!t.getGeometry()&&-1!=t.geomIndex){const i=e.assetItem.getGeometryLibrary(),n=t.geomIndex,s=t=>{const{range:e}=t;if(n>=e[0]&&n<e[1]){const t=i.getGeom(n);t?this.setGeometry(t,E.DATA_LOAD):console.warn("Geom not loaded:",this.getName()),i.removeListenerById("rangeLoaded",o)}},o=i.addListener("rangeLoaded",s)}this.__geomMatParam.setDirty(this.__cleanGeomMat)}destroy(){super.destroy()}}J.registerClass("GeomItem",ha);const ca={manual:0,first:1,average:2,globalOri:3};class ma extends na{constructor(t){super(t),this.setFlag($.USER_EDITED),this.groupXfoDirty=!1,this.calculatingGroupXfo=!1,this.dirty=!1,this.invGroupXfo=void 0,this.__initialXfos=[],this.__signalIndices=[],this.__itemsParam=this.addParameter(new Ce("Items",t=>t instanceof na)),this.__itemsParam.addListener("itemAdded",t=>{this.__bindItem(t.item,t.index)}),this.__itemsParam.addListener("itemRemoved",t=>{this.__unbindItem(t.item,t.index)}),this.__itemsParam.addListener("valueChanged",()=>{this.calcGroupXfo(),this._setBoundingBoxDirty()}),this.__initialXfoModeParam=this.addParameter(new Ge("InitialXfoMode",ca.average,["manual","first","average","global"])),this.__initialXfoModeParam.addListener("valueChanged",()=>{this.calcGroupXfo()}),this.__highlightedParam=this.addParameter(new Xe("Highlighted",!1)),this.__highlightedParam.addListener("valueChanged",()=>{this.__updateHighlight()}),this.__updateHighlight=this.__updateHighlight.bind(this),this.addParameter(new Ie("HighlightColor",new y$2(.5,.5,1))).addListener("valueChanged",this.__updateHighlight),this.addParameter(new Ze("HighlightFill",0,[0,1])).addListener("valueChanged",this.__updateHighlight),this.__materialParam=this.addParameter(new Wt("Material")),this.__materialParam.addListener("valueChanged",()=>{this.__updateMaterial()}),this.__updateCutaway=this.__updateCutaway.bind(this),this.addParameter(new Xe("CutAwayEnabled",!1)).addListener("valueChanged",this.__updateCutaway),this.addParameter(new fe("CutPlaneNormal",new Z(1,0,0))).addListener("valueChanged",this.__updateCutaway),this.addParameter(new Ze("CutPlaneDist",0)).addListener("valueChanged",this.__updateCutaway),this.__globalXfoParam.addListener("valueChanged",()=>{this.calculatingGroupXfo||this.groupXfoDirty||this._propagateDirtyXfoToItems()})}static get INITIAL_XFO_MODES(){return ca}__updateVisiblity(){if(super.__updateVisiblity()){const t=this.getVisible();return Array.from(this.__itemsParam.getValue()).forEach(e=>{e instanceof na&&e.propagateVisiblity(t?1:-1)}),!0}return!1}__updateHighlight(){let t,e=!1;(this.getParameter("Highlighted").getValue()||this.isSelected())&&(e=!0,t=this.getParameter("HighlightColor").getValue(),t.a=this.getParameter("HighlightFill").getValue());const i="groupItemHighlight"+this.getId();Array.from(this.__itemsParam.getValue()).forEach(n=>{n instanceof na&&(e?n.addHighlight(i,t,!0):n.removeHighlight(i,!0))})}setSelected(t){super.setSelected(t),this.__updateHighlight()}_setGlobalXfoDirty(){super._setGlobalXfoDirty()}calcGroupXfo(){const t=Array.from(this.__itemsParam.getValue());if(0==t.length)return new S;this.calculatingGroupXfo=!0;const e=this.__initialXfoModeParam.getValue();let i;if(e==ca.manual)return this.invGroupXfo=this.getGlobalXfo().inverse(),this.calculatingGroupXfo=!1,void(this.groupXfoDirty=!1);if(e==ca.first)i=this.__initialXfos[0];else if(e==ca.average){i=new S,i.ori.set(0,0,0,0);let e=0;t.forEach((t,n)=>{t instanceof na&&(i.tr.addInPlace(this.__initialXfos[n].tr),i.ori.addInPlace(this.__initialXfos[n].ori),e++)}),i.tr.scaleInPlace(1/e),i.ori.normalizeInPlace()}else{if(e!=ca.globalOri)throw new Error("Invalid mode.");{i=new S;let e=0;t.forEach((t,n)=>{t instanceof na&&(i.tr.addInPlace(this.__initialXfos[n].tr),e++)}),i.tr.scaleInPlace(1/e)}}this.setGlobalXfo(i,E.GENERATED_VALUE);const n=this.getGlobalXfo();this.invGroupXfo=n.inverse(),this.calculatingGroupXfo=!1,this.groupXfoDirty=!1}_propagateDirtyXfoToItems(){if(this.groupXfoDirty||this.calculatingGroupXfo)return;const t=Array.from(this.__itemsParam.getValue());if(!this.calculatingGroupXfo&&t.length>0&&this.invGroupXfo&&!this.dirty){let e;this.dirty=!0,this.propagatingXfoToItems=!0;const i=(t,i)=>{const n=t.getParameter("GlobalXfo");n.setDirty(()=>{if(!e){const t=this.__globalXfoParam.getValue();e=t.multiply(this.invGroupXfo),this.dirty=!1}const t=e.multiply(i);n.setClean(t)})};t.forEach((t,e)=>{t instanceof na&&i(t,this.__initialXfos[e])}),this.propagatingXfoToItems=!1}}__updateMaterial(){const t=this.getParameter("Material").getValue();Array.from(this.__itemsParam.getValue()).forEach(e=>{e.traverse(e=>{if(e instanceof na&&e.hasParameter("Material")){const i=e.getParameter("Material");if(t){const e=i.getValue();e!=t&&(i.__backupMaterial=e,i.setValue(t,E.GENERATED_VALUE))}else i.__backupMaterial&&i.setValue(i.__backupMaterial,E.GENERATED_VALUE)}},!1)})}__updateCutaway(){const t=this.getParameter("CutAwayEnabled").getValue(),e=this.getParameter("CutPlaneNormal").getValue(),i=this.getParameter("CutPlaneDist").getValue();Array.from(this.__itemsParam.getValue()).forEach(n=>{n.traverse(n=>{n instanceof oa&&(n.setCutawayEnabled(t),n.setCutVector(e),n.setCutDist(i))},!0)})}setPaths(t){this.clearItems(!1);const e=this.getOwner();if(null==e)return void console.warn("Group does not have an owner and so cannot resolve paths:",this.getName());const i=[];t.forEach(t=>{const n=e.resolvePath(t);n?i.push(n):console.warn("Path does not resolve to an Item:",t," group:",this.getName())}),this.setItems(i)}resolveItems(t){this.setPaths(t)}__bindItem(t,e){if(!(t instanceof na))return;const i={};i.mouseDownIndex=t.addListener("mouseDown",t=>{this.onMouseDown(t)}),i.mouseUpIndex=t.addListener("mouseUp",t=>{this.onMouseUp(t)}),i.mouseMoveIndex=t.addListener("mouseMove",t=>{this.onMouseMove(t)}),i.mouseEnterIndex=t.addListener("mouseEnter",t=>{this.onMouseEnter(t)}),i.mouseLeaveIndex=t.addListener("mouseLeave",t=>{this.onMouseLeave(t)});const n=this.getParameter("Material").getValue();if(n&&t.traverse(t=>{if(t instanceof na&&t.hasParameter("Material")){const e=t.getParameter("Material");if(n){const t=e.getValue();t!=n&&(e.__backupMaterial=t,e.setValue(n,E.GENERATED_VALUE))}}},!0),t instanceof na&&this.getParameter("Highlighted").getValue()){const e=this.getParameter("HighlightColor").getValue();e.a=this.getParameter("HighlightFill").getValue(),t.addHighlight("groupItemHighlight"+this.getId(),e,!0)}const s=this.getParameter("CutAwayEnabled").getValue();if(s){const e=this.getParameter("CutPlaneNormal").getValue(),i=this.getParameter("CutPlaneDist").getValue();t.traverse(t=>{t instanceof oa&&(t.setCutawayEnabled(s),t.setCutVector(e),t.setCutDist(i))},!0)}this.getVisible()||t.propagateVisiblity(-1);const o=()=>{const t=this.__initialXfoModeParam.getValue();t==ca.first&&0==e?this.calcGroupXfo():t!=ca.average&&t!=ca.globalOri||this.calcGroupXfo()};i.globalXfoChangedIndex=t.addListener("globalXfoChanged",()=>{this.propagatingXfoToItems||(this.__initialXfos[e]=t.getGlobalXfo(),this.groupXfoDirty=!0,o())}),this.__initialXfos[e]=t.getGlobalXfo(),i.bboxChangedIndex=t.addListener("boundingChanged",this._setBoundingBoxDirty),this.__signalIndices[e]=i,o()}__unbindItem(t,e){if(!(t instanceof na))return;t.removeHighlight("branchselected"+this.getId(),!0),this.getParameter("Highlighted").getValue()&&t.removeHighlight("groupItemHighlight"+this.getId(),!0),this.getVisible()||t.propagateVisiblity(1),t.traverse(t=>{t instanceof oa&&t.setCutawayEnabled(!1)},!0);const i=this.__signalIndices[e];t.removeListenerById("mouseDown",i.mouseDownIndex),t.removeListenerById("mouseUp",i.mouseUpIndex),t.removeListenerById("mouseMove",i.mouseMoveIndex),t.removeListenerById("mouseEnter",i.mouseEnterIndex),t.removeListenerById("mouseLeave",i.mouseLeaveIndex),t.removeListenerById("globalXfoChanged",i.globalXfoChangedIndex),t.removeListenerById("boundingChanged",i.bboxChangedIndex),this.__signalIndices.splice(e,1),this.__initialXfos.splice(e,1)}addItem(t,e=!0){t?this.__itemsParam.addItem(t,e):console.warn("Error adding item to group. Item is null")}removeItem(t,e=!0){this.__itemsParam.removeItem(t,e)}clearItems(t=!0){const e=Array.from(this.__itemsParam.getValue());for(let i=e.length-1;i>=0;i--)this.__unbindItem(e[i],i);this.__signalIndices=[],this.__initialXfos=[],this.__itemsParam.clearItems(t)}getItems(){return this.__itemsParam.getValue()}setItems(t){this.clearItems(!1),this.__itemsParam.setItems(t)}_cleanBoundingBox(t){const e=super._cleanBoundingBox(t);return Array.from(this.__itemsParam.getValue()).forEach(t=>{t instanceof na&&t.getVisible()&&!t.testFlag($.IGNORE_BBOX)&&e.addBox3(t.getBoundingBox())}),e}onMouseDown(t){super.onMouseDown(t)}onMouseUp(t){super.onMouseUp(t)}onMouseMove(t){super.onMouseMove(t)}toJSON(t,e){const i=super.toJSON(t,e),n=Array.from(this.__itemsParam.getValue()),s=[];return n.forEach(e=>{const i=e.getPath();s.push(t?t.makeRelative(i):i)}),i.treeItems=s,i}fromJSON(t,e,i){if(super.fromJSON(t,e,i),this.setFlag($.USER_EDITED),!t.treeItems)return void console.warn("Invalid Parameter JSON");let n=t.treeItems.length;const s=t=>{e.resolvePath(t,t=>{this.addItem(t),n--,0==n&&(this.calculatingGroupXfo=!0,this.calcGroupXfo(),this.calculatingGroupXfo=!1)},()=>{console.warn("Group: '"+this.getName()+"'. Unable to load item:"+t)})};for(const o of t.treeItems)s(o)}clone(t){const e=new ma;return e.copyFrom(this,t),e}copyFrom(t,e){super.copyFrom(t,e)}destroy(){super.destroy()}}J.registerClass("Group",ma);var ua=he("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpjb25zdCB0PU1hdGguUEkvMTgwO01hdGguSEFMRl9QST0uNSpNYXRoLlBJLE1hdGguVFdPX1BJPTIqTWF0aC5QSTtNYXRoLnJhZFRvRGVnPWZ1bmN0aW9uKGUpe3JldHVybiBlL3R9LE1hdGguZGVnVG9SYWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUqdH0sTnVtYmVyLmlzTnVtZXJpYz10PT4haXNOYU4ocGFyc2VGbG9hdCh0KSkmJmlzRmluaXRlKHQpLFN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnJlcGxhY2UobmV3IFJlZ0V4cCh0LCJnIiksZSl9O2Z1bmN0aW9uIGUodCxlPTAscz01KXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkodCwoZnVuY3Rpb24odCxlKXtyZXR1cm4gZSYmZS50b0ZpeGVkP051bWJlcihlLnRvRml4ZWQocykpOmV9KSxlKX1TdHJpbmcucHJvdG90eXBlLmhhc2g9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCl7bGV0IGUscyxhLGk9MDtpZigwPT09dC5sZW5ndGgpcmV0dXJuIGk7Zm9yKGU9MCxhPXQubGVuZ3RoO2U8YTtlKyspcz10LmNoYXJDb2RlQXQoZSksaT0oaTw8NSktaStzLGl8PTA7cmV0dXJuIE1hdGguYWJzKGkpfSh0aGlzKX0sU3RyaW5nLnByb3RvdHlwZS50cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzK3xccyskL2csIiIpfSxTdHJpbmcucHJvdG90eXBlLmx0cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzKy8sIiIpfSxTdHJpbmcucHJvdG90eXBlLnJ0cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXHMrJC8sIiIpfSxTdHJpbmcucHJvdG90eXBlLmxwYWQ9ZnVuY3Rpb24odCxlKXtsZXQgcz10aGlzO2Zvcig7cy5sZW5ndGg8ZTspcz10K3M7cmV0dXJuIHN9LFN0cmluZy5wcm90b3R5cGUucnBhZD1mdW5jdGlvbih0LGUpe2xldCBzPXRoaXM7Zm9yKDtzLmxlbmd0aDxlOylzKz10O3JldHVybiBzfSxNYXRoLnJhbmRvbUludD1mdW5jdGlvbih0LGUpe3JldHVybiB0PU1hdGguY2VpbCh0KSxlPU1hdGguZmxvb3IoZSksTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihlLXQpKSt0fSxNYXRoLmxlcnA9KHQsZSxzKT0+dCtzKihlLXQpLE1hdGguY2xhbXA9ZnVuY3Rpb24odCxlLHMpe3JldHVybiBNYXRoLm1pbihNYXRoLm1heCh0LGUpLHMpfSxNYXRoLm5lYXJlc3RQb3cyPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnBvdygyLE1hdGgucm91bmQoTWF0aC5sb2codCkvTWF0aC5sb2coMikpKX0sTWF0aC5uZWFyZXN0UG93MTA9ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGgucG93KDEwLE1hdGgucm91bmQoTWF0aC5sb2cxMCh0KS9NYXRoLmxvZzEwKDEwKSkpfSxNYXRoLm5leHRQb3cyPWZ1bmN0aW9uKHQpe2xldCBlPTA7Zm9yKDt0PjA7KWUrKyx0Pj49MTtyZXR1cm4gMTw8ZX0sTWF0aC5mcmFjdD1mdW5jdGlvbih0KXtyZXR1cm4gMD09dD8wOnQ8MD90Pi0xPy10Oi10JU1hdGguZmxvb3IoLXQpOnQ8MT90OnQlTWF0aC5mbG9vcih0KX0sTWF0aC5yZW1hcD1mdW5jdGlvbih0LGUscyxhLGkpe3JldHVybiBhKyh0LWUpLyhzLWUpKihpLWEpfSxNYXRoLmNvbnZlcnRGbG9hdDMyQXJyYXlUb1VJbnQxNkFycmF5PWZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IFVpbnQxNkFycmF5KHQubGVuZ3RoKSxzPW5ldyBJbnQzMkFycmF5KHQuYnVmZmVyKSxhPXQ9PntsZXQgZT10Pj4xNiYzMjc2OCxzPXQ+PjEyJjIwNDc7Y29uc3QgYT10Pj4yMyYyNTU7cmV0dXJuIGE8MTAzP2U6YT4xNDI/KGV8PTMxNzQ0LGV8PSgyNTU9PWE/MDoxKSYmODM4ODYwNyZ0LGUpOmE8MTEzPyhzfD0yMDQ4LGV8PShzPj4xMTQtYSkrKHM+PjExMy1hJjEpLGUpOihlfD1hLTExMjw8MTB8cz4+MSxlKz0xJnMsZSl9O2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7aSsrKWVbaV09YShzW2ldKTtyZXR1cm4gZX0sTWF0aC5kZWNvZGUxNkJpdEZsb2F0RnJvbTJ4VUludDg9dD0+e2NvbnN0IGU9dFswXSxzPSgxMjAmZSk+PjM7bGV0IGE9MD09cz8wOjIwNDg7Y29uc3QgaT1hKygoNyZlKTw8OCkrdFsxXTthPTA9PXM/MTowO3JldHVybigxMjgmZT8xOi0xKSppKk1hdGgucG93KDIscythLTE2KX0sTWF0aC5lbmNvZGUxNkJpdEZsb2F0SW50bzJ4VUludDg9dD0+e2N8fChjPW5ldyBVaW50OEFycmF5KDIpKTtjb25zdCBlPXQ+PTA/MTI4OjA7dD1NYXRoLmFicyh0KTtsZXQgcyxhPTE1LGk9MTAyNDtmb3IobGV0IGU9MTU7ZT4wO2UtLSl0PGkmJihpLz0yLGEtLSk7cz0wPT1hP3QvaS8yOih0LWkpL2k7Y29uc3Qgcj1NYXRoLnJvdW5kKDIwNDgqcyksbj1yLzI1NixoPXItMjU2Km47cmV0dXJuIGNbMF09ZSs4KmErbixjWzFdPWgsdD49MjA0OCYmKGNbMF09MjU1KSxjfSxNYXRoLmVuY29kZTE2Qml0RmxvYXQ9dD0+e2NvbnN0IGU9bmV3IEZsb2F0MzJBcnJheSgxKTtlWzBdPXQ7cmV0dXJuKHQ9PntsZXQgZT10Pj4xNiYzMjc2OCxzPXQ+PjEyJjIwNDc7Y29uc3QgYT10Pj4yMyYyNTU7cmV0dXJuIGE8MTAzP2U6YT4xNDI/KGV8PTMxNzQ0LGV8PSgyNTU9PWE/MDoxKSYmODM4ODYwNyZ0LGUpOmE8MTEzPyhzfD0yMDQ4LGV8PShzPj4xMTQtYSkrKHM+PjExMy1hJjEpLGUpOihlfD1hLTExMjw8MTB8cz4+MSxlKz0xJnMsZSl9KShuZXcgSW50MzJBcnJheShlLmJ1ZmZlcilbMF0pfSxNYXRoLmRlY29kZTE2Qml0RmxvYXQ9dD0+e2NvbnN0IGU9KDMyNzY4JnQpPj4xNSxzPSgzMTc0NCZ0KT4+MTAsYT0xMDIzJnQ7cmV0dXJuIDA9PXM/KGU/LTE6MSkqTWF0aC5wb3coMiwtMTQpKihhL01hdGgucG93KDIsMTApKTozMT09cz9hP05hTjoxLzAqKGU/LTE6MSk6KGU/LTE6MSkqTWF0aC5wb3coMixzLTE1KSooMSthL01hdGgucG93KDIsMTApKX0sTWF0aC5zbW9vdGhTdGVwPSh0LGUscyk9Pntjb25zdCBhPU1hdGguY2xhbXAoKHMtdCkvKGUtdCksMCwxKTtyZXR1cm4gYSphKigzLTIqYSl9LE1hdGgubGluU3RlcD0odCxlLHMpPT5NYXRoLmNsYW1wKChzLXQpLyhlLXQpLDAsMSk7Y2xhc3Mgc3tpc1ZhbGlkKCl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fX2RhdGEpaWYodD09MS8wfHxpc05hTih0KSlyZXR1cm4hMTtyZXR1cm4hMH1zdGF0aWMgY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodCxlKXt0aHJvdyBuZXcgRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQgZm9yIHRoaXMgdHlwZToiK3RoaXMuY29uc3RydWN0b3IubmFtZSl9c3RhdGljIG51bUVsZW1lbnRzKCl7dGhyb3cgbmV3IEVycm9yKCJOb3QgeWV0IGltcGxlbWVudGVkIGZvciB0aGlzIHR5cGU6Iit0aGlzLmNvbnN0cnVjdG9yLm5hbWUpfWFzQXJyYXkoKXtyZXR1cm4gdGhpcy5fX2RhdGF9dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX10b0pTT04oKXt0aHJvdyBuZXcgRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQgZm9yIHRoaXMgdHlwZToiK3RoaXMuY29uc3RydWN0b3IubmFtZSl9fWNvbnN0IGE9bmV3IGNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5fX3R5cGVzPXt9LHRoaXMuX19uYW1lcz17fSx0aGlzLnJlZ2lzdGVyVHlwZSgiU0ludDMyIiw1KSx0aGlzLnJlZ2lzdGVyVHlwZSgiVUludDMyIiw0KSx0aGlzLnJlZ2lzdGVyVHlwZSgiRmxvYXQzMiIsNil9cmVnaXN0ZXJUeXBlKHQsZSl7dGhpcy5fX3R5cGVzW3RdPWUsZS5uYW1lP3RoaXMuX19uYW1lc1tlLm5hbWVdPXQ6dGhpcy5fX25hbWVzW2VdPXR9Z2V0VHlwZSh0KXtyZXR1cm4gdGhpcy5fX3R5cGVzW3RdfWdldFR5cGVOYW1lKHQpe2lmKHRoaXMuX19uYW1lc1t0XSlyZXR1cm4gdGhpcy5fX25hbWVzW3RdO2lmKHRoaXMuX19uYW1lc1t0Lm5hbWVdKXJldHVybiB0aGlzLl9fbmFtZXNbdC5uYW1lXTt0aHJvdyB0fX07Y2xhc3MgaSBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0wLGU9MCl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHx0IGluc3RhbmNlb2YgVWludDMyQXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQzMkFycmF5KXRoaXMuX19kYXRhPXQ7ZWxzZSBpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsMil9ZWxzZSBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHQ/KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMiksdGhpcy5mcm9tSlNPTih0KSk6KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMiksdGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lKX1nZXQgeCgpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgeCh0KXt0aGlzLl9fZGF0YVswXT10fWdldCB5KCl7cmV0dXJuIHRoaXMuX19kYXRhWzFdfXNldCB5KHQpe3RoaXMuX19kYXRhWzFdPXR9c2V0KHQsZSl7dGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lfXNldEZyb21PdGhlcih0KXt0aGlzLng9dC54LHRoaXMueT10Lnl9ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueX1ub3RFcXVhbHModCl7cmV0dXJuIHRoaXMueCE9dC54JiZ0aGlzLnkhPXQueX1hcHByb3hFcXVhbCh0LGU9TnVtYmVyLkVQU0lMT04pe3JldHVybiBNYXRoLmFicyh0aGlzLngtdC54KTxlJiZNYXRoLmFicyh0aGlzLnktdC55KTxlfWFkZCh0KXtyZXR1cm4gbmV3IGkodGhpcy54K3QueCx0aGlzLnkrdC55KX1hZGRJblBsYWNlKHQpe3RoaXMueCs9dC54LHRoaXMueSs9dC55fXN1YnRyYWN0KHQpe3JldHVybiBuZXcgaSh0aGlzLngtdC54LHRoaXMueS10LnkpfXN1YnRyYWN0SW5QbGFjZSh0KXtyZXR1cm4gdGhpcy54LT10LngsdGhpcy55LT10LnksdGhpc31zY2FsZSh0KXtyZXR1cm4gbmV3IGkodGhpcy54KnQsdGhpcy55KnQpfXNjYWxlSW5QbGFjZSh0KXt0aGlzLngqPXQsdGhpcy55Kj10fWludmVydCgpe3JldHVybiBuZXcgaSgxL3RoaXMueCwxL3RoaXMueSl9aW52ZXJ0SW5QbGFjZSgpe3JldHVybiB0aGlzLng9MS90aGlzLngsdGhpcy55PTEvdGhpcy55LHRoaXN9bXVsdGlwbHkodCl7cmV0dXJuIG5ldyBpKHRoaXMueCp0LngsdGhpcy55KnQueSl9bXVsdGlwbHlJblBsYWNlKHQpe3RoaXMueCo9dC54LHRoaXMueSo9dC55fWxlbmd0aFNxdWFyZWQoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV07cmV0dXJuIHQqdCtlKmV9bGVuZ3RoKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLmxlbmd0aFNxdWFyZWQoKSl9ZGlzdGFuY2VUbyh0KXtjb25zdCBlPXRoaXMuX19kYXRhWzBdLXQueCxzPXRoaXMuX19kYXRhWzFdLXQueTtyZXR1cm4gTWF0aC5zcXJ0KGUqZStzKnMpfW5vcm1hbGl6ZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXTtsZXQgcz10KnQrZSplO3JldHVybiBzPE51bWJlci5FUFNJTE9OP25ldyBpOihzPTEvTWF0aC5zcXJ0KHMpLG5ldyBpKHQqcyxlKnMpKX1ub3JtYWxpemVJblBsYWNlKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdO2xldCBzPXQqdCtlKmU7czxOdW1iZXIuRVBTSUxPTnx8KHM9MS9NYXRoLnNxcnQocyksdGhpcy5zZXQodCpzLGUqcykpfWRvdCh0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55fWNyb3NzKHQpe3JldHVybiB0aGlzLngqdC55LXRoaXMueSp0Lnh9YW5nbGVUbyh0KXtjb25zdCBlPXRoaXMubm9ybWFsaXplKCkuZG90KHQubm9ybWFsaXplKCkpO3JldHVybiBlPjE/MDplPC0xP01hdGguUEk6TWF0aC5hY29zKGUpfXNpZ25lZEFuZ2xlVG8odCl7Y29uc3QgZT10aGlzLmFuZ2xlVG8odCk7cmV0dXJuIHRoaXMuY3Jvc3ModCk8MD8tZTplfXJvdGF0ZSh0KXtjb25zdCBlPU1hdGguY29zKHQpLHM9TWF0aC5zaW4odCk7cmV0dXJuIG5ldyBpKHRoaXMueCplLXRoaXMueSpzLHRoaXMueCpzK3RoaXMueSplKX1sZXJwKHQsZSl7Y29uc3Qgcz10aGlzLngsYT10aGlzLnk7cmV0dXJuIG5ldyBpKHMrZSoodC54LXMpLGErZSoodC55LWEpKX1zZXRSYW5kb21EaXIodD0xKXtjb25zdCBlPTIqTWF0aC5yYW5kb20oKSpNYXRoLlBJO3JldHVybiB0aGlzLl9fZGF0YVswXT1NYXRoLmNvcyhlKSp6U2NhbGUsdGhpcy5fX2RhdGFbMV09TWF0aC5zaW4oZSkqelNjYWxlLHRoaXN9c2V0UmFuZG9tKHQ9MSl7cmV0dXJuIHRoaXMuX19kYXRhWzBdPU1hdGgucmFuZG9tKCkqdCx0aGlzLl9fZGF0YVsxXT1NYXRoLnJhbmRvbSgpKnQsdGhpc31jbG9uZSgpe3JldHVybiBuZXcgaSh0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSl9YXNBcnJheSgpe3JldHVybiB0aGlzLl9fZGF0YX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgaSguLi50KX1zdGF0aWMgY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodCxlPTApe3JldHVybiBuZXcgaSh0LDQqZSl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQXJyYXkodCl7cmV0dXJuIG5ldyBpKHQpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiAyfXRvSlNPTigpe3JldHVybnt4OnRoaXMueCx5OnRoaXMueX19ZnJvbUpTT04odCl7dGhpcy54PXQueCx0aGlzLnk9dC55fX1hLnJlZ2lzdGVyVHlwZSgiVmVjMiIsaSk7Y2xhc3MgciBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0wLGU9MCxzPTApe2lmKHN1cGVyKCksdCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheXx8dCBpbnN0YW5jZW9mIFVpbnQzMkFycmF5KXRoaXMuX19kYXRhPXQ7ZWxzZSBpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsMyl9ZWxzZSBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHQ/KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMyksdGhpcy5mcm9tSlNPTih0KSk6KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMyksdGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lLHRoaXMuX19kYXRhWzJdPXMpfWdldCB4KCl7cmV0dXJuIHRoaXMuX19kYXRhWzBdfXNldCB4KHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IHkoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IHkodCl7dGhpcy5fX2RhdGFbMV09dH1nZXQgeigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgeih0KXt0aGlzLl9fZGF0YVsyXT10fWdldCB4eSgpe3JldHVybiBuZXcgaSh0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSl9Z2V0IHl6KCl7cmV0dXJuIG5ldyBpKHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdKX1zZXQodCxlLHMpe3RoaXMueD10LHRoaXMueT12b2lkIDAhPT1lP2U6dCx0aGlzLno9dm9pZCAwIT09cz9zOnR9c2V0RGF0YUFycmF5KHQpe3RoaXMuX19kYXRhPXR9c2V0RnJvbU90aGVyKHQpe3RoaXMueD10LngsdGhpcy55PXQueSx0aGlzLno9dC56fWlzTnVsbCgpe3JldHVybiBNYXRoLmFicyh0aGlzLngpPE51bWJlci5FUFNJTE9OJiZNYXRoLmFicyh0aGlzLnkpPE51bWJlci5FUFNJTE9OJiZNYXRoLmFicyh0aGlzLnopPE51bWJlci5FUFNJTE9OfWlzMTExKCl7cmV0dXJuIE1hdGguYWJzKDEtdGhpcy54KTxOdW1iZXIuRVBTSUxPTiYmTWF0aC5hYnMoMS10aGlzLnkpPE51bWJlci5FUFNJTE9OJiZNYXRoLmFicygxLXRoaXMueik8TnVtYmVyLkVQU0lMT059ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueSYmdGhpcy56PT10Lnp9bm90RXF1YWxzKHQpe3JldHVybiB0aGlzLnghPXQueCYmdGhpcy55IT10LnkmJnRoaXMueiE9dC56fWFwcHJveEVxdWFsKHQsZT1OdW1iZXIuRVBTSUxPTil7cmV0dXJuIE1hdGguYWJzKHRoaXMueC10LngpPGUmJk1hdGguYWJzKHRoaXMueS10LnkpPGUmJk1hdGguYWJzKHRoaXMuei10LnopPGV9YWRkKHQpe3JldHVybiBuZXcgcih0aGlzLngrdC54LHRoaXMueSt0LnksdGhpcy56K3Queil9YWRkSW5QbGFjZSh0KXt0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzLnorPXQuen1zdWJ0cmFjdCh0KXtyZXR1cm4gbmV3IHIodGhpcy54LXQueCx0aGlzLnktdC55LHRoaXMuei10LnopfXN1YnRyYWN0SW5QbGFjZSh0KXt0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQuen1tdWx0aXBseSh0KXtyZXR1cm4gbmV3IHIodGhpcy54KnQueCx0aGlzLnkqdC55LHRoaXMueip0LnopfW11bHRpcGx5SW5QbGFjZSh0KXt0aGlzLngqPXQueCx0aGlzLnkqPXQueSx0aGlzLnoqPXQuen1kaXZpZGUodCl7cmV0dXJuIG5ldyByKHRoaXMueC90LngsdGhpcy55L3QueSx0aGlzLnovdC56KX1kaXZpZGVJblBsYWNlKHQpe3RoaXMueC89dC54LHRoaXMueS89dC55LHRoaXMuei89dC56fXNjYWxlKHQpe3JldHVybiBuZXcgcih0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCl9c2NhbGVJblBsYWNlKHQpe3RoaXMueCo9dCx0aGlzLnkqPXQsdGhpcy56Kj10fW5lZ2F0ZSgpe3JldHVybiBuZXcgcigtdGhpcy54LC10aGlzLnksLXRoaXMueil9aW52ZXJzZSgpe3JldHVybiBuZXcgcigxL3RoaXMueCwxL3RoaXMueSwxL3RoaXMueil9bGVuZ3RoU3F1YXJlZCgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdO3JldHVybiB0KnQrZSplK3Mqc31sZW5ndGgoKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMubGVuZ3RoU3F1YXJlZCgpKX1kaXN0YW5jZVRvKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0tdC54LHM9dGhpcy5fX2RhdGFbMV0tdC55LGE9dGhpcy5fX2RhdGFbMl0tdC56O3JldHVybiBNYXRoLnNxcnQoZSplK3MqcythKmEpfW5vcm1hbGl6ZSgpe2xldCB0PXRoaXMuX19kYXRhWzBdKnRoaXMuX19kYXRhWzBdK3RoaXMuX19kYXRhWzFdKnRoaXMuX19kYXRhWzFdK3RoaXMuX19kYXRhWzJdKnRoaXMuX19kYXRhWzJdO3JldHVybiB0PE51bWJlci5FUFNJTE9OP25ldyByOih0PTEvTWF0aC5zcXJ0KHQpLG5ldyByKHRoaXMuX19kYXRhWzBdKnQsdGhpcy5fX2RhdGFbMV0qdCx0aGlzLl9fZGF0YVsyXSp0KSl9bm9ybWFsaXplSW5QbGFjZSgpe2xldCB0PXRoaXMuX19kYXRhWzBdKnRoaXMuX19kYXRhWzBdK3RoaXMuX19kYXRhWzFdKnRoaXMuX19kYXRhWzFdK3RoaXMuX19kYXRhWzJdKnRoaXMuX19kYXRhWzJdO2lmKHQ8TnVtYmVyLkVQU0lMT04pcmV0dXJuO3Q9TWF0aC5zcXJ0KHQpO2NvbnN0IGU9MS90O3JldHVybiB0aGlzLl9fZGF0YVswXSo9ZSx0aGlzLl9fZGF0YVsxXSo9ZSx0aGlzLl9fZGF0YVsyXSo9ZSx0fXJlc2l6ZSh0KXtjb25zdCBlPXRoaXMuX19kYXRhWzBdKnRoaXMuX19kYXRhWzBdK3RoaXMuX19kYXRhWzFdKnRoaXMuX19kYXRhWzFdK3RoaXMuX19kYXRhWzJdKnRoaXMuX19kYXRhWzJdO2lmKGU8TnVtYmVyLkVQU0lMT04pcmV0dXJuO2NvbnN0IHM9dC9NYXRoLnNxcnQoZSk7cmV0dXJuIG5ldyByKHRoaXMuX19kYXRhWzBdKnMsdGhpcy5fX2RhdGFbMV0qcyx0aGlzLl9fZGF0YVsyXSpzKX1yZXNpemVJblBsYWNlKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0qdGhpcy5fX2RhdGFbMF0rdGhpcy5fX2RhdGFbMV0qdGhpcy5fX2RhdGFbMV0rdGhpcy5fX2RhdGFbMl0qdGhpcy5fX2RhdGFbMl07aWYoZTxOdW1iZXIuRVBTSUxPTilyZXR1cm47Y29uc3Qgcz10L01hdGguc3FydChlKTt0aGlzLl9fZGF0YVswXSo9cyx0aGlzLl9fZGF0YVsxXSo9cyx0aGlzLl9fZGF0YVsyXSo9c31kb3QodCl7cmV0dXJuIHRoaXMueCp0LngrdGhpcy55KnQueSt0aGlzLnoqdC56fWNyb3NzKHQpe2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dC54LG49dC55LGg9dC56O3JldHVybiBuZXcgcihzKmgtYSpuLGEqaS1lKmgsZSpuLXMqaSl9YW5nbGVUbyh0KXtjb25zdCBlPXRoaXMuZG90KHQpO3JldHVybiBlPjE/MDpNYXRoLmFjb3MoZSl9bGVycCh0LGUpe2NvbnN0IHM9dGhpcy54LGE9dGhpcy55LGk9dGhpcy56O3JldHVybiBuZXcgcihzK2UqKHQueC1zKSxhK2UqKHQueS1hKSxpK2UqKHQuei1pKSl9YWJzKCl7cmV0dXJuIG5ldyByKE1hdGguYWJzKHRoaXMueCksTWF0aC5hYnModGhpcy55KSxNYXRoLmFicyh0aGlzLnopKX1zZXRSYW5kb21EaXIodD0xKXtjb25zdCBlPTIqTWF0aC5yYW5kb20oKSpNYXRoLlBJLHM9MipNYXRoLnJhbmRvbSgpLTEsYT1NYXRoLnNxcnQoMS1zKnMpKnQ7cmV0dXJuIHRoaXMuX19kYXRhWzBdPU1hdGguY29zKGUpKmEsdGhpcy5fX2RhdGFbMV09TWF0aC5zaW4oZSkqYSx0aGlzLl9fZGF0YVsyXT1zKnQsdGhpc31zZXRSYW5kb20odD0xKXtyZXR1cm4gdGhpcy5fX2RhdGFbMF09KE1hdGgucmFuZG9tKCktLjUpKnQsdGhpcy5fX2RhdGFbMV09KE1hdGgucmFuZG9tKCktLjUpKnQsdGhpcy5fX2RhdGFbMl09KE1hdGgucmFuZG9tKCktLjUpKnQsdGhpc31jbG9uZSgpe3JldHVybiBuZXcgcih0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVsyXSl9YXNBcnJheSgpe3JldHVybiB0aGlzLl9fZGF0YX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgciguLi50KX1zdGF0aWMgY3JlYXRlRnJvbUpTT04odCl7Y29uc3QgZT1uZXcgcjtyZXR1cm4gZS5mcm9tSlNPTih0KSxlfXN0YXRpYyBjcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0LGU9MCl7cmV0dXJuIG5ldyByKHQsNCplKX1zdGF0aWMgY3JlYXRlRnJvbUZsb2F0MzJBcnJheSh0KXtyZXR1cm4gbmV3IHIodCl9c3RhdGljIG51bUVsZW1lbnRzKCl7cmV0dXJuIDN9dG9KU09OKCl7cmV0dXJue3g6dGhpcy54LHk6dGhpcy55LHo6dGhpcy56fX1mcm9tSlNPTih0KXt0aGlzLng9dC54LHRoaXMueT10LnksdGhpcy56PXQuen19YS5yZWdpc3RlclR5cGUoIlZlYzMiLHIpO2NsYXNzIG4gZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQ9MCxlPTAscz0wLGE9MCl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHQ/KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoNCksdGhpcy5mcm9tSlNPTih0KSk6KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoNCksdGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lLHRoaXMuX19kYXRhWzJdPXMsdGhpcy5fX2RhdGFbM109YSl9Z2V0IHgoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMF19c2V0IHgodCl7dGhpcy5fX2RhdGFbMF09dH1nZXQgeSgpe3JldHVybiB0aGlzLl9fZGF0YVsxXX1zZXQgeSh0KXt0aGlzLl9fZGF0YVsxXT10fWdldCB6KCl7cmV0dXJuIHRoaXMuX19kYXRhWzJdfXNldCB6KHQpe3RoaXMuX19kYXRhWzJdPXR9Z2V0IHQoKXtyZXR1cm4gdGhpcy5fX2RhdGFbM119c2V0IHQodCl7dGhpcy5fX2RhdGFbM109dH1nZXQgeHl6KCl7cmV0dXJuIG5ldyByKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdKX1zZXQodCxlLHMsYSl7dGhpcy54PXQsdGhpcy55PWUsdGhpcy56PXMsdGhpcy50PWF9c2V0RnJvbU90aGVyKHQpe3RoaXMueD10LngsdGhpcy55PXQueSx0aGlzLno9dC56LHRoaXMudD10LnR9ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueSYmdGhpcy56PT10LnomJnRoaXMudD09dC50fW5vdEVxdWFscyh0KXtyZXR1cm4gdGhpcy54IT10LngmJnRoaXMueSE9dC55JiZ0aGlzLnohPXQueiYmdGhpcy50IT10LnR9YXBwcm94RXF1YWwodCxlPU51bWJlci5FUFNJTE9OKXtyZXR1cm4gTWF0aC5hYnModGhpcy54LXQueCk8ZSYmTWF0aC5hYnModGhpcy55LXQueSk8ZSYmTWF0aC5hYnModGhpcy56LXQueik8ZSYmTWF0aC5hYnModGhpcy50LXQudCk8ZX1hZGQodCl7cmV0dXJuIG5ldyBuKHRoaXMueCt0LngsdGhpcy55K3QueSx0aGlzLnordC56LHRoaXMudCt0LnQpfWFkZEluUGxhY2UodCl7dGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpcy56Kz10LnosdGhpcy50Kz10LnR9c3VidHJhY3QodCl7cmV0dXJuIG5ldyBuKHRoaXMueC10LngsdGhpcy55LXQueSx0aGlzLnotdC56LHRoaXMudC10LnQpfXN1YnRyYWN0SW5QbGFjZSh0KXt0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQueix0aGlzLnQtPXQudH1tdWx0aXBseSh0KXtyZXR1cm4gbmV3IG4odGhpcy54KnQueCx0aGlzLnkqdC55LHRoaXMueip0LnosdGhpcy50KnQudCl9bXVsdGlwbHlJblBsYWNlKHQpe3RoaXMueCo9dC54LHRoaXMueSo9dC55LHRoaXMueio9dC56LHRoaXMudCo9dC50fWRpdmlkZSh0KXtyZXR1cm4gbmV3IG4odGhpcy54L3QueCx0aGlzLnkvdC55LHRoaXMuei90LnosdGhpcy50L3QudCl9ZGl2aWRlSW5QbGFjZSh0KXt0aGlzLngvPXQueCx0aGlzLnkvPXQueSx0aGlzLnovPXQueix0aGlzLnQvPXQudH1zY2FsZSh0KXtyZXR1cm4gbmV3IG4odGhpcy54KnQsdGhpcy55KnQsdGhpcy56KnQsdGhpcy50KnQpfXNjYWxlSW5QbGFjZSh0KXt0aGlzLnNldCh0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCx0aGlzLnQqdCl9bGVuZ3RoKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdLHM9dGhpcy5fX2RhdGFbMl0sYT10aGlzLl9fZGF0YVsyXTtyZXR1cm4gTWF0aC5zcXJ0KHQqdCtlKmUrcypzK2EqYSl9bGVuZ3RoU3F1YXJlZCgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM107cmV0dXJuIHQqdCtlKmUrcypzK2EqYX1ub3JtYWxpemUoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdO2xldCBpPXQqdCtlKmUrcypzK2EqYTtyZXR1cm4gaTxOdW1iZXIuRVBTSUxPTj9uZXcgbjooaT0xL01hdGguc3FydChpKSxuZXcgbih0KmksZSppLHMqaSkpfW5vcm1hbGl6ZUluUGxhY2UoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdO2xldCBpPXQqdCtlKmUrcypzK2EqYTtpPE51bWJlci5FUFNJTE9OfHwoaT0xL01hdGguc3FydChpKSx0aGlzLnNldCh0KmksZSppLHMqaSxhKmkpKX1kb3QodCl7cmV0dXJuIHRoaXMueCp0LngrdGhpcy55KnQueSt0aGlzLnoqdC56K3RoaXMudCpiLnR9Y3Jvc3ModCl7Y29uc3QgZT10aGlzLngscz10aGlzLnksYT10aGlzLnosaT10aGlzLnQscj10LngsaD10Lnksbz10LnosXz10LnQ7cmV0dXJuIG5ldyBuKHMqby1hKmgsYSpfLWkqbyxpKnItZSpfLGUqaC1zKnIpfWFuZ2xlVG8odCl7Y29uc3QgZT10aGlzLm5vcm1hbGl6ZSgpLHM9dC5ub3JtYWxpemUoKSxhPWUuZG90KHMpO3JldHVybiBhPjE/MDpNYXRoLmFjb3MoYSl9bGVycCh0LGUpe2NvbnN0IHM9dGhpcy54LGE9dGhpcy55LGk9dGhpcy56O3JldHVybiBhdD10aGlzLnQsbmV3IG4ocytlKih0LngtcyksYStlKih0LnktYSksaStlKih0LnotaSksYXQrZSoodC50LWF0KSl9cmFuZG9tKHQ9MSl7Y29uc3QgZT0yKmdsTWF0cml4LlJBTkRPTSgpKk1hdGguUEkscz0yKmdsTWF0cml4LlJBTkRPTSgpLTEsYT1NYXRoLnNxcnQoMS1zKnMpKnQ7cmV0dXJuIG91dFswXT1NYXRoLmNvcyhlKSphLG91dFsxXT1NYXRoLnNpbihlKSphLG91dFsyXT1zKnQsb3V0fWNsb25lKCl7cmV0dXJuIG5ldyBuKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzNdKX10b1ZlYzMoKXtyZXR1cm4gbmV3IHIodGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl0pfWFzQXJyYXkoKXtyZXR1cm4gdGhpcy5fX2RhdGF9c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IHIoLi4udCl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IG4odCw0KmUpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiA0fXRvSlNPTigpe3JldHVybnt4OnRoaXMueCx5OnRoaXMueSx6OnRoaXMueix0OnRoaXMudH19fWEucmVnaXN0ZXJUeXBlKCJWZWM0IixuKTtjbGFzcyBoIGV4dGVuZHMgc3tjb25zdHJ1Y3Rvcih0PTAsZT0wLHM9MCxhPTI1NSl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgVWludDhBcnJheSl0aGlzLl9fZGF0YT10O2Vsc2UgaWYodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXtjb25zdCBzPXQsYT1lO3RoaXMuX19kYXRhPW5ldyBVaW50OEFycmF5KHMsYSw0KX1lbHNlIHRoaXMuX19kYXRhPW5ldyBVaW50OEFycmF5KDQpLCJzdHJpbmciPT10eXBlb2YgdD90LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tQ1NTQ29sb3JOYW1lKHQpOih0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hKX1nZXQgcigpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgcih0KXt0aGlzLl9fZGF0YVswXT10fWdldCBnKCl7cmV0dXJuIHRoaXMuX19kYXRhWzFdfXNldCBnKHQpe3RoaXMuX19kYXRhWzFdPXR9Z2V0IGIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMl19c2V0IGIodCl7dGhpcy5fX2RhdGFbMl09dH1nZXQgYSgpe3JldHVybiB0aGlzLl9fZGF0YVszXX1zZXQgYSh0KXt0aGlzLl9fZGF0YVszXT10fXNldCh0LGUscyxhPTI1NSl7dGhpcy5yPXQsdGhpcy5nPWUsdGhpcy5iPXMsdGhpcy5hPWF9c2V0RnJvbU90aGVyKHQpe3RoaXMucj10LnIsdGhpcy5nPXQuZyx0aGlzLmI9dC5iLHRoaXMuYT10LmF9c2V0RnJvbUFycmF5KHQpe3RoaXMucj10WzBdLHRoaXMuZz10WzFdLHRoaXMuYj10WzJdLHRoaXMuYT00PT10Lmxlbmd0aD90WzNdOjF9c2V0RnJvbUhleCh0KXtjb25zdCBlPWZ1bmN0aW9uKHQpe2NvbnN0IGU9L14jPyhbYS1mXGRdezJ9KShbYS1mXGRdezJ9KShbYS1mXGRdezJ9KSQvaS5leGVjKHQpO3JldHVybiBlP3tyOnBhcnNlSW50KGVbMV0sMTYpLGc6cGFyc2VJbnQoZVsyXSwxNiksYjpwYXJzZUludChlWzNdLDE2KX06bnVsbH0odCk7ZT90aGlzLnNldChlLnIsZS5nLGUuYik6Y29uc29sZS53YXJuKCJJbnZhbGlkIGhleCBjb2RlOiIrdCl9c2V0RnJvbUNTU0NvbG9yTmFtZSh0KXt0LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tSGV4KCh0PT57Y29uc3QgZT17YWxpY2VibHVlOiIjZjBmOGZmIixhbnRpcXVld2hpdGU6IiNmYWViZDciLGFxdWE6IiMwMGZmZmYiLGFxdWFtYXJpbmU6IiM3ZmZmZDQiLGF6dXJlOiIjZjBmZmZmIixiZWlnZToiI2Y1ZjVkYyIsYmlzcXVlOiIjZmZlNGM0IixibGFjazoiIzAwMDAwMCIsYmxhbmNoZWRhbG1vbmQ6IiNmZmViY2QiLGJsdWU6IiMwMDAwZmYiLGJsdWV2aW9sZXQ6IiM4YTJiZTIiLGJyb3duOiIjYTUyYTJhIixidXJseXdvb2Q6IiNkZWI4ODciLGNhZGV0Ymx1ZToiIzVmOWVhMCIsY2hhcnRyZXVzZToiIzdmZmYwMCIsY2hvY29sYXRlOiIjZDI2OTFlIixjb3JhbDoiI2ZmN2Y1MCIsY29ybmZsb3dlcmJsdWU6IiM2NDk1ZWQiLGNvcm5zaWxrOiIjZmZmOGRjIixjcmltc29uOiIjZGMxNDNjIixjeWFuOiIjMDBmZmZmIixkYXJrYmx1ZToiIzAwMDA4YiIsZGFya2N5YW46IiMwMDhiOGIiLGRhcmtnb2xkZW5yb2Q6IiNiODg2MGIiLGRhcmtncmF5OiIjYTlhOWE5IixkYXJrZ3JlZW46IiMwMDY0MDAiLGRhcmtraGFraToiI2JkYjc2YiIsZGFya21hZ2VudGE6IiM4YjAwOGIiLGRhcmtvbGl2ZWdyZWVuOiIjNTU2YjJmIixkYXJrb3JhbmdlOiIjZmY4YzAwIixkYXJrb3JjaGlkOiIjOTkzMmNjIixkYXJrcmVkOiIjOGIwMDAwIixkYXJrc2FsbW9uOiIjZTk5NjdhIixkYXJrc2VhZ3JlZW46IiM4ZmJjOGYiLGRhcmtzbGF0ZWJsdWU6IiM0ODNkOGIiLGRhcmtzbGF0ZWdyYXk6IiMyZjRmNGYiLGRhcmt0dXJxdW9pc2U6IiMwMGNlZDEiLGRhcmt2aW9sZXQ6IiM5NDAwZDMiLGRlZXBwaW5rOiIjZmYxNDkzIixkZWVwc2t5Ymx1ZToiIzAwYmZmZiIsZGltZ3JheToiIzY5Njk2OSIsZG9kZ2VyYmx1ZToiIzFlOTBmZiIsZmlyZWJyaWNrOiIjYjIyMjIyIixmbG9yYWx3aGl0ZToiI2ZmZmFmMCIsZm9yZXN0Z3JlZW46IiMyMjhiMjIiLGZ1Y2hzaWE6IiNmZjAwZmYiLGdhaW5zYm9ybzoiI2RjZGNkYyIsZ2hvc3R3aGl0ZToiI2Y4ZjhmZiIsZ29sZDoiI2ZmZDcwMCIsZ29sZGVucm9kOiIjZGFhNTIwIixncmF5OiIjODA4MDgwIixncmVlbjoiIzAwODAwMCIsZ3JlZW55ZWxsb3c6IiNhZGZmMmYiLGhvbmV5ZGV3OiIjZjBmZmYwIixob3RwaW5rOiIjZmY2OWI0IiwiaW5kaWFucmVkICI6IiNjZDVjNWMiLGluZGlnbzoiIzRiMDA4MiIsaXZvcnk6IiNmZmZmZjAiLGtoYWtpOiIjZjBlNjhjIixsYXZlbmRlcjoiI2U2ZTZmYSIsbGF2ZW5kZXJibHVzaDoiI2ZmZjBmNSIsbGF3bmdyZWVuOiIjN2NmYzAwIixsZW1vbmNoaWZmb246IiNmZmZhY2QiLGxpZ2h0Ymx1ZToiI2FkZDhlNiIsbGlnaHRjb3JhbDoiI2YwODA4MCIsbGlnaHRjeWFuOiIjZTBmZmZmIixsaWdodGdvbGRlbnJvZHllbGxvdzoiI2ZhZmFkMiIsbGlnaHRncmV5OiIjZDNkM2QzIixsaWdodGdyZWVuOiIjOTBlZTkwIixsaWdodHBpbms6IiNmZmI2YzEiLGxpZ2h0c2FsbW9uOiIjZmZhMDdhIixsaWdodHNlYWdyZWVuOiIjMjBiMmFhIixsaWdodHNreWJsdWU6IiM4N2NlZmEiLGxpZ2h0c2xhdGVncmF5OiIjNzc4ODk5IixsaWdodHN0ZWVsYmx1ZToiI2IwYzRkZSIsbGlnaHR5ZWxsb3c6IiNmZmZmZTAiLGxpbWU6IiMwMGZmMDAiLGxpbWVncmVlbjoiIzMyY2QzMiIsbGluZW46IiNmYWYwZTYiLG1hZ2VudGE6IiNmZjAwZmYiLG1hcm9vbjoiIzgwMDAwMCIsbWVkaXVtYXF1YW1hcmluZToiIzY2Y2RhYSIsbWVkaXVtYmx1ZToiIzAwMDBjZCIsbWVkaXVtb3JjaGlkOiIjYmE1NWQzIixtZWRpdW1wdXJwbGU6IiM5MzcwZDgiLG1lZGl1bXNlYWdyZWVuOiIjM2NiMzcxIixtZWRpdW1zbGF0ZWJsdWU6IiM3YjY4ZWUiLG1lZGl1bXNwcmluZ2dyZWVuOiIjMDBmYTlhIixtZWRpdW10dXJxdW9pc2U6IiM0OGQxY2MiLG1lZGl1bXZpb2xldHJlZDoiI2M3MTU4NSIsbWlkbmlnaHRibHVlOiIjMTkxOTcwIixtaW50Y3JlYW06IiNmNWZmZmEiLG1pc3R5cm9zZToiI2ZmZTRlMSIsbW9jY2FzaW46IiNmZmU0YjUiLG5hdmFqb3doaXRlOiIjZmZkZWFkIixuYXZ5OiIjMDAwMDgwIixvbGRsYWNlOiIjZmRmNWU2IixvbGl2ZToiIzgwODAwMCIsb2xpdmVkcmFiOiIjNmI4ZTIzIixvcmFuZ2U6IiNmZmE1MDAiLG9yYW5nZXJlZDoiI2ZmNDUwMCIsb3JjaGlkOiIjZGE3MGQ2IixwYWxlZ29sZGVucm9kOiIjZWVlOGFhIixwYWxlZ3JlZW46IiM5OGZiOTgiLHBhbGV0dXJxdW9pc2U6IiNhZmVlZWUiLHBhbGV2aW9sZXRyZWQ6IiNkODcwOTMiLHBhcGF5YXdoaXA6IiNmZmVmZDUiLHBlYWNocHVmZjoiI2ZmZGFiOSIscGVydToiI2NkODUzZiIscGluazoiI2ZmYzBjYiIscGx1bToiI2RkYTBkZCIscG93ZGVyYmx1ZToiI2IwZTBlNiIscHVycGxlOiIjODAwMDgwIixyZWJlY2NhcHVycGxlOiIjNjYzMzk5IixyZWQ6IiNmZjAwMDAiLHJvc3licm93bjoiI2JjOGY4ZiIscm95YWxibHVlOiIjNDE2OWUxIixzYWRkbGVicm93bjoiIzhiNDUxMyIsc2FsbW9uOiIjZmE4MDcyIixzYW5keWJyb3duOiIjZjRhNDYwIixzZWFncmVlbjoiIzJlOGI1NyIsc2Vhc2hlbGw6IiNmZmY1ZWUiLHNpZW5uYToiI2EwNTIyZCIsc2lsdmVyOiIjYzBjMGMwIixza3libHVlOiIjODdjZWViIixzbGF0ZWJsdWU6IiM2YTVhY2QiLHNsYXRlZ3JheToiIzcwODA5MCIsc25vdzoiI2ZmZmFmYSIsc3ByaW5nZ3JlZW46IiMwMGZmN2YiLHN0ZWVsYmx1ZToiIzQ2ODJiNCIsdGFuOiIjZDJiNDhjIix0ZWFsOiIjMDA4MDgwIix0aGlzdGxlOiIjZDhiZmQ4Iix0b21hdG86IiNmZjYzNDciLHR1cnF1b2lzZToiIzQwZTBkMCIsdmlvbGV0OiIjZWU4MmVlIix3aGVhdDoiI2Y1ZGViMyIsd2hpdGU6IiNmZmZmZmYiLHdoaXRlc21va2U6IiNmNWY1ZjUiLHllbGxvdzoiI2ZmZmYwMCIseWVsbG93Z3JlZW46IiM5YWNkMzIifTtyZXR1cm4gdm9pZCAwIT09ZVt0LnRvTG93ZXJDYXNlKCldJiZlW3QudG9Mb3dlckNhc2UoKV19KSh0KSl9dG9IZXgoKXtmdW5jdGlvbiB0KHQpe2NvbnN0IGU9dC50b1N0cmluZygxNik7cmV0dXJuIDE9PWUubGVuZ3RoPyIwIitlOmV9cmV0dXJuIiMiK3QodGhpcy5yKSt0KHRoaXMuZykrdCh0aGlzLmIpfWVxdWFsKHQpe3JldHVybiB0aGlzLnI9PXQuciYmdGhpcy5nPT10LmcmJnRoaXMuYj09dC5iJiZ0aGlzLmE9PXQuYX1ub3RlcXVhbHModCl7cmV0dXJuIHRoaXMuciE9dC5yJiZ0aGlzLmchPXQuZyYmdGhpcy5iIT10LmImJnRoaXMuYSE9dC5hfWFwcHJveEVxdWFsKHQsZT1OdW1iZXIuRVBTSUxPTil7cmV0dXJuIE1hdGguYWJzKHRoaXMuci10LnIpPGUmJk1hdGguYWJzKHRoaXMuZy10LmcpPGUmJk1hdGguYWJzKHRoaXMuYi10LmIpPGUmJk1hdGguYWJzKHRoaXMuYS10LmEpPGV9YWRkKHQpe3JldHVybiBuZXcgaCh0aGlzLnIrdC5yLHRoaXMuZyt0LmcsdGhpcy5iK3QuYix0aGlzLmErdC5hKX1zdWJ0cmFjdCh0KXtyZXR1cm4gbmV3IGgodGhpcy5yLXQucix0aGlzLmctdC5nLHRoaXMuYi10LmIsdGhpcy5hLXQuYSl9c2NhbGUodCl7cmV0dXJuIG5ldyBoKHRoaXMucip0LHRoaXMuZyp0LHRoaXMuYip0LHRoaXMuYSp0KX1zY2FsZUluUGxhY2UodCl7dGhpcy5yKj10LHRoaXMuZyo9dCx0aGlzLmIqPXQsdGhpcy5hKj10fWFwcGx5R2FtbWEodCl7dGhpcy5zZXQoTWF0aC5wb3codGhpcy5yLHQpLE1hdGgucG93KHRoaXMuZyx0KSxNYXRoLnBvdyh0aGlzLmIsdCksdGhpcy5hKX10b0xpbmVhcih0PTIuMil7cmV0dXJuIG5ldyBoKE1hdGgucG93KHRoaXMucix0KSxNYXRoLnBvdyh0aGlzLmcsdCksTWF0aC5wb3codGhpcy5iLHQpLHRoaXMuYSl9dG9HYW1tYSh0PTIuMil7cmV0dXJuIG5ldyBoKE1hdGgucG93KHRoaXMuciwxL3QpLE1hdGgucG93KHRoaXMuZywxL3QpLE1hdGgucG93KHRoaXMuYiwxL3QpLHRoaXMuYSl9bHVtaW5hbmNlKCl7cmV0dXJuLjIxMjYqdGhpcy5yKy43MTUyKnRoaXMuZysuMDcyMip0aGlzLmJ9bGVycCh0LGUpe2NvbnN0IHM9dGhpcy5yLGE9dGhpcy5nLGk9dGhpcy5iLHI9dGhpcy5hO3JldHVybiBuZXcgaChzK2UqKHQuci1zKSxhK2UqKHQuZy1hKSxpK2UqKHQuYi1pKSxyK2UqKHQuYS1yKSl9c3RhdGljIHJhbmRvbSh0PTAsZT0hMSl7cmV0dXJuIHQ+MD9uZXcgaCh0K01hdGgucmFuZG9tKCkqKDEtdCksdCtNYXRoLnJhbmRvbSgpKigxLXQpLHQrTWF0aC5yYW5kb20oKSooMS10KSxlP3QrTWF0aC5yYW5kb20oKSooMS10KToxKTp0PDA/bmV3IGgoTWF0aC5yYW5kb20oKSooMSt0KSxNYXRoLnJhbmRvbSgpKigxK3QpLE1hdGgucmFuZG9tKCkqKDErdCksZT9NYXRoLnJhbmRvbSgpKigxK3QpOjEpOm5ldyBoKE1hdGgucmFuZG9tKCksTWF0aC5yYW5kb20oKSxNYXRoLnJhbmRvbSgpLGU/TWF0aC5yYW5kb20oKToxKX1jbG9uZSgpe3JldHVybiBuZXcgaCh0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVsyXSx0aGlzLl9fZGF0YVszXSl9YXNBcnJheSgpe3JldHVybiB0aGlzLl9fZGF0YX1hczNDb21wb25lbnRBcnJheSgpe3JldHVyblt0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVsyXV19c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IGgoLi4udCl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IGgodCw0KmUpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiA0fXRvSlNPTigpe3JldHVybntyOnRoaXMucixnOnRoaXMuZyxiOnRoaXMuYixhOnRoaXMuYX19ZnJvbUpTT04odCl7dGhpcy5yPXQucix0aGlzLmc9dC5nLHRoaXMuYj10LmIsdGhpcy5hPXQuYX10b0NTU1N0cmluZygpe3JldHVybiJyZ2JhKCIrTWF0aC5yb3VuZCgyNTUqdGhpcy5yKSsiLCAiK01hdGgucm91bmQoMjU1KnRoaXMuZykrIiwgIitNYXRoLnJvdW5kKDI1NSp0aGlzLmIpKyIsICIrdGhpcy5hKyIpIn19YS5yZWdpc3RlclR5cGUoIlJHQkEiLGgpO2NsYXNzIG8gZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQ9MCxlPTAscz0wLGE9MSl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXRoaXMuX19kYXRhPXQ7ZWxzZSBpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSB0aGlzLl9fZGF0YT1uZXcgRmxvYXQzMkFycmF5KDQpLCJzdHJpbmciPT10eXBlb2YgdD90LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tQ1NTQ29sb3JOYW1lKHQpOih0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hKX1nZXQgcigpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgcih0KXt0aGlzLl9fZGF0YVswXT10fWdldCBnKCl7cmV0dXJuIHRoaXMuX19kYXRhWzFdfXNldCBnKHQpe3RoaXMuX19kYXRhWzFdPXR9Z2V0IGIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMl19c2V0IGIodCl7dGhpcy5fX2RhdGFbMl09dH1nZXQgYSgpe3JldHVybiB0aGlzLl9fZGF0YVszXX1zZXQgYSh0KXt0aGlzLl9fZGF0YVszXT10fXNldCh0LGUscyxhPTEpe3RoaXMucj10LHRoaXMuZz1lLHRoaXMuYj1zLHRoaXMuYT1hfXNldEZyb21PdGhlcih0KXt0aGlzLnI9dC5yLHRoaXMuZz10LmcsdGhpcy5iPXQuYix0aGlzLmE9dC5hfXNldEZyb21TY2FsYXJBcnJheSh0KXt0aGlzLnI9dFswXSx0aGlzLmc9dFsxXSx0aGlzLmI9dFsyXSx0aGlzLmE9ND09dC5sZW5ndGg/dFszXToxfWdldEFzUkdCQXJyYXkoKXtyZXR1cm5bMjU1KnRoaXMuciwyNTUqdGhpcy5nLDI1NSp0aGlzLmJdfWdldEFzUkdCRGljdCgpe3JldHVybntyOjI1NSp0aGlzLnIsZzoyNTUqdGhpcy5nLGI6MjU1KnRoaXMuYn19c2V0RnJvbVJHQih0LGUscyxhKXt0aGlzLnI9dC8yNTUsdGhpcy5nPWUvMjU1LHRoaXMuYj1zLzI1NSx0aGlzLmE9YT9hLzI1NToxfXNldEZyb21SR0JBcnJheSh0KXt0aGlzLnI9dFswXS8yNTUsdGhpcy5nPXRbMV0vMjU1LHRoaXMuYj10WzJdLzI1NSx0aGlzLmE9ND09dC5sZW5ndGg/dFszXS8yNTU6MX1zZXRGcm9tUkdCRGljdCh0KXt0aGlzLnI9dC5yLzI1NSx0aGlzLmc9dC5nLzI1NSx0aGlzLmI9dC5iLzI1NSx0aGlzLmE9ND09dC5hP3QuYS8yNTU6MX1zZXRGcm9tSGV4KHQpe2NvbnN0IGU9ZnVuY3Rpb24odCl7Y29uc3QgZT0vXiM/KFthLWZcZF17Mn0pKFthLWZcZF17Mn0pKFthLWZcZF17Mn0pJC9pLmV4ZWModCk7cmV0dXJuIGU/e3I6cGFyc2VJbnQoZVsxXSwxNiksZzpwYXJzZUludChlWzJdLDE2KSxiOnBhcnNlSW50KGVbM10sMTYpfTpudWxsfSh0KTtlP3RoaXMuc2V0RnJvbVJHQihlLnIsZS5nLGUuYik6Y29uc29sZS53YXJuKCJJbnZhbGlkIGhleCBjb2RlOiIrdCl9c2V0RnJvbUNTU0NvbG9yTmFtZSh0KXt0LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tSGV4KCh0PT57Y29uc3QgZT17YWxpY2VibHVlOiIjZjBmOGZmIixhbnRpcXVld2hpdGU6IiNmYWViZDciLGFxdWE6IiMwMGZmZmYiLGFxdWFtYXJpbmU6IiM3ZmZmZDQiLGF6dXJlOiIjZjBmZmZmIixiZWlnZToiI2Y1ZjVkYyIsYmlzcXVlOiIjZmZlNGM0IixibGFjazoiIzAwMDAwMCIsYmxhbmNoZWRhbG1vbmQ6IiNmZmViY2QiLGJsdWU6IiMwMDAwZmYiLGJsdWV2aW9sZXQ6IiM4YTJiZTIiLGJyb3duOiIjYTUyYTJhIixidXJseXdvb2Q6IiNkZWI4ODciLGNhZGV0Ymx1ZToiIzVmOWVhMCIsY2hhcnRyZXVzZToiIzdmZmYwMCIsY2hvY29sYXRlOiIjZDI2OTFlIixjb3JhbDoiI2ZmN2Y1MCIsY29ybmZsb3dlcmJsdWU6IiM2NDk1ZWQiLGNvcm5zaWxrOiIjZmZmOGRjIixjcmltc29uOiIjZGMxNDNjIixjeWFuOiIjMDBmZmZmIixkYXJrYmx1ZToiIzAwMDA4YiIsZGFya2N5YW46IiMwMDhiOGIiLGRhcmtnb2xkZW5yb2Q6IiNiODg2MGIiLGRhcmtncmF5OiIjYTlhOWE5IixkYXJrZ3JlZW46IiMwMDY0MDAiLGRhcmtraGFraToiI2JkYjc2YiIsZGFya21hZ2VudGE6IiM4YjAwOGIiLGRhcmtvbGl2ZWdyZWVuOiIjNTU2YjJmIixkYXJrb3JhbmdlOiIjZmY4YzAwIixkYXJrb3JjaGlkOiIjOTkzMmNjIixkYXJrcmVkOiIjOGIwMDAwIixkYXJrc2FsbW9uOiIjZTk5NjdhIixkYXJrc2VhZ3JlZW46IiM4ZmJjOGYiLGRhcmtzbGF0ZWJsdWU6IiM0ODNkOGIiLGRhcmtzbGF0ZWdyYXk6IiMyZjRmNGYiLGRhcmt0dXJxdW9pc2U6IiMwMGNlZDEiLGRhcmt2aW9sZXQ6IiM5NDAwZDMiLGRlZXBwaW5rOiIjZmYxNDkzIixkZWVwc2t5Ymx1ZToiIzAwYmZmZiIsZGltZ3JheToiIzY5Njk2OSIsZG9kZ2VyYmx1ZToiIzFlOTBmZiIsZmlyZWJyaWNrOiIjYjIyMjIyIixmbG9yYWx3aGl0ZToiI2ZmZmFmMCIsZm9yZXN0Z3JlZW46IiMyMjhiMjIiLGZ1Y2hzaWE6IiNmZjAwZmYiLGdhaW5zYm9ybzoiI2RjZGNkYyIsZ2hvc3R3aGl0ZToiI2Y4ZjhmZiIsZ29sZDoiI2ZmZDcwMCIsZ29sZGVucm9kOiIjZGFhNTIwIixncmF5OiIjODA4MDgwIixncmVlbjoiIzAwODAwMCIsZ3JlZW55ZWxsb3c6IiNhZGZmMmYiLGhvbmV5ZGV3OiIjZjBmZmYwIixob3RwaW5rOiIjZmY2OWI0IiwiaW5kaWFucmVkICI6IiNjZDVjNWMiLGluZGlnbzoiIzRiMDA4MiIsaXZvcnk6IiNmZmZmZjAiLGtoYWtpOiIjZjBlNjhjIixsYXZlbmRlcjoiI2U2ZTZmYSIsbGF2ZW5kZXJibHVzaDoiI2ZmZjBmNSIsbGF3bmdyZWVuOiIjN2NmYzAwIixsZW1vbmNoaWZmb246IiNmZmZhY2QiLGxpZ2h0Ymx1ZToiI2FkZDhlNiIsbGlnaHRjb3JhbDoiI2YwODA4MCIsbGlnaHRjeWFuOiIjZTBmZmZmIixsaWdodGdvbGRlbnJvZHllbGxvdzoiI2ZhZmFkMiIsbGlnaHRncmV5OiIjZDNkM2QzIixsaWdodGdyZWVuOiIjOTBlZTkwIixsaWdodHBpbms6IiNmZmI2YzEiLGxpZ2h0c2FsbW9uOiIjZmZhMDdhIixsaWdodHNlYWdyZWVuOiIjMjBiMmFhIixsaWdodHNreWJsdWU6IiM4N2NlZmEiLGxpZ2h0c2xhdGVncmF5OiIjNzc4ODk5IixsaWdodHN0ZWVsYmx1ZToiI2IwYzRkZSIsbGlnaHR5ZWxsb3c6IiNmZmZmZTAiLGxpbWU6IiMwMGZmMDAiLGxpbWVncmVlbjoiIzMyY2QzMiIsbGluZW46IiNmYWYwZTYiLG1hZ2VudGE6IiNmZjAwZmYiLG1hcm9vbjoiIzgwMDAwMCIsbWVkaXVtYXF1YW1hcmluZToiIzY2Y2RhYSIsbWVkaXVtYmx1ZToiIzAwMDBjZCIsbWVkaXVtb3JjaGlkOiIjYmE1NWQzIixtZWRpdW1wdXJwbGU6IiM5MzcwZDgiLG1lZGl1bXNlYWdyZWVuOiIjM2NiMzcxIixtZWRpdW1zbGF0ZWJsdWU6IiM3YjY4ZWUiLG1lZGl1bXNwcmluZ2dyZWVuOiIjMDBmYTlhIixtZWRpdW10dXJxdW9pc2U6IiM0OGQxY2MiLG1lZGl1bXZpb2xldHJlZDoiI2M3MTU4NSIsbWlkbmlnaHRibHVlOiIjMTkxOTcwIixtaW50Y3JlYW06IiNmNWZmZmEiLG1pc3R5cm9zZToiI2ZmZTRlMSIsbW9jY2FzaW46IiNmZmU0YjUiLG5hdmFqb3doaXRlOiIjZmZkZWFkIixuYXZ5OiIjMDAwMDgwIixvbGRsYWNlOiIjZmRmNWU2IixvbGl2ZToiIzgwODAwMCIsb2xpdmVkcmFiOiIjNmI4ZTIzIixvcmFuZ2U6IiNmZmE1MDAiLG9yYW5nZXJlZDoiI2ZmNDUwMCIsb3JjaGlkOiIjZGE3MGQ2IixwYWxlZ29sZGVucm9kOiIjZWVlOGFhIixwYWxlZ3JlZW46IiM5OGZiOTgiLHBhbGV0dXJxdW9pc2U6IiNhZmVlZWUiLHBhbGV2aW9sZXRyZWQ6IiNkODcwOTMiLHBhcGF5YXdoaXA6IiNmZmVmZDUiLHBlYWNocHVmZjoiI2ZmZGFiOSIscGVydToiI2NkODUzZiIscGluazoiI2ZmYzBjYiIscGx1bToiI2RkYTBkZCIscG93ZGVyYmx1ZToiI2IwZTBlNiIscHVycGxlOiIjODAwMDgwIixyZWJlY2NhcHVycGxlOiIjNjYzMzk5IixyZWQ6IiNmZjAwMDAiLHJvc3licm93bjoiI2JjOGY4ZiIscm95YWxibHVlOiIjNDE2OWUxIixzYWRkbGVicm93bjoiIzhiNDUxMyIsc2FsbW9uOiIjZmE4MDcyIixzYW5keWJyb3duOiIjZjRhNDYwIixzZWFncmVlbjoiIzJlOGI1NyIsc2Vhc2hlbGw6IiNmZmY1ZWUiLHNpZW5uYToiI2EwNTIyZCIsc2lsdmVyOiIjYzBjMGMwIixza3libHVlOiIjODdjZWViIixzbGF0ZWJsdWU6IiM2YTVhY2QiLHNsYXRlZ3JheToiIzcwODA5MCIsc25vdzoiI2ZmZmFmYSIsc3ByaW5nZ3JlZW46IiMwMGZmN2YiLHN0ZWVsYmx1ZToiIzQ2ODJiNCIsdGFuOiIjZDJiNDhjIix0ZWFsOiIjMDA4MDgwIix0aGlzdGxlOiIjZDhiZmQ4Iix0b21hdG86IiNmZjYzNDciLHR1cnF1b2lzZToiIzQwZTBkMCIsdmlvbGV0OiIjZWU4MmVlIix3aGVhdDoiI2Y1ZGViMyIsd2hpdGU6IiNmZmZmZmYiLHdoaXRlc21va2U6IiNmNWY1ZjUiLHllbGxvdzoiI2ZmZmYwMCIseWVsbG93Z3JlZW46IiM5YWNkMzIifTtyZXR1cm4gdm9pZCAwIT09ZVt0LnRvTG93ZXJDYXNlKCldJiZlW3QudG9Mb3dlckNhc2UoKV19KSh0KSl9dG9IZXgoKXtmdW5jdGlvbiB0KHQpe2NvbnN0IGU9TWF0aC5yb3VuZCgyNTUqdCkudG9TdHJpbmcoMTYpO3JldHVybiAxPT1lLmxlbmd0aD8iMCIrZTplfXJldHVybiIjIit0KHRoaXMucikrdCh0aGlzLmcpK3QodGhpcy5iKX1lcXVhbCh0KXtyZXR1cm4gdGhpcy5yPT10LnImJnRoaXMuZz09dC5nJiZ0aGlzLmI9PXQuYiYmdGhpcy5hPT10LmF9bm90ZXF1YWxzKHQpe3JldHVybiB0aGlzLnIhPXQuciYmdGhpcy5nIT10LmcmJnRoaXMuYiE9dC5iJiZ0aGlzLmEhPXQuYX1hcHByb3hFcXVhbCh0LGU9TnVtYmVyLkVQU0lMT04pe3JldHVybiBNYXRoLmFicyh0aGlzLnItdC5yKTxlJiZNYXRoLmFicyh0aGlzLmctdC5nKTxlJiZNYXRoLmFicyh0aGlzLmItdC5iKTxlJiZNYXRoLmFicyh0aGlzLmEtdC5hKTxlfWFkZCh0KXtyZXR1cm4gbmV3IG8odGhpcy5yK3Qucix0aGlzLmcrdC5nLHRoaXMuYit0LmIsdGhpcy5hK3QuYSl9c3VidHJhY3QodCl7cmV0dXJuIG5ldyBvKHRoaXMuci10LnIsdGhpcy5nLXQuZyx0aGlzLmItdC5iLHRoaXMuYS10LmEpfXNjYWxlKHQpe3JldHVybiBuZXcgbyh0aGlzLnIqdCx0aGlzLmcqdCx0aGlzLmIqdCx0aGlzLmEqdCl9c2NhbGVJblBsYWNlKHQpe3RoaXMucio9dCx0aGlzLmcqPXQsdGhpcy5iKj10LHRoaXMuYSo9dH1hcHBseUdhbW1hKHQpe3RoaXMuc2V0KE1hdGgucG93KHRoaXMucix0KSxNYXRoLnBvdyh0aGlzLmcsdCksTWF0aC5wb3codGhpcy5iLHQpLHRoaXMuYSl9dG9MaW5lYXIodD0yLjIpe3JldHVybiBuZXcgbyhNYXRoLnBvdyh0aGlzLnIsdCksTWF0aC5wb3codGhpcy5nLHQpLE1hdGgucG93KHRoaXMuYix0KSx0aGlzLmEpfXRvR2FtbWEodD0yLjIpe3JldHVybiBuZXcgbyhNYXRoLnBvdyh0aGlzLnIsMS90KSxNYXRoLnBvdyh0aGlzLmcsMS90KSxNYXRoLnBvdyh0aGlzLmIsMS90KSx0aGlzLmEpfWx1bWluYW5jZSgpe3JldHVybi4yMTI2KnRoaXMucisuNzE1Mip0aGlzLmcrLjA3MjIqdGhpcy5ifWxlcnAodCxlKXtjb25zdCBzPXRoaXMucixhPXRoaXMuZyxpPXRoaXMuYixyPXRoaXMuYTtyZXR1cm4gbmV3IG8ocytlKih0LnItcyksYStlKih0LmctYSksaStlKih0LmItaSkscitlKih0LmEtcikpfXN0YXRpYyByYW5kb20odD0wLGU9ITEpe3JldHVybiB0PjA/bmV3IG8odCtNYXRoLnJhbmRvbSgpKigxLXQpLHQrTWF0aC5yYW5kb20oKSooMS10KSx0K01hdGgucmFuZG9tKCkqKDEtdCksZT90K01hdGgucmFuZG9tKCkqKDEtdCk6MSk6dDwwP25ldyBvKE1hdGgucmFuZG9tKCkqKDErdCksTWF0aC5yYW5kb20oKSooMSt0KSxNYXRoLnJhbmRvbSgpKigxK3QpLGU/TWF0aC5yYW5kb20oKSooMSt0KToxKTpuZXcgbyhNYXRoLnJhbmRvbSgpLE1hdGgucmFuZG9tKCksTWF0aC5yYW5kb20oKSxlP01hdGgucmFuZG9tKCk6MSl9Y2xvbmUoKXtyZXR1cm4gbmV3IG8odGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbM10pfWFzQXJyYXkoKXtyZXR1cm4gdGhpcy5fX2RhdGF9YXMzQ29tcG9uZW50QXJyYXkoKXtyZXR1cm5bdGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl1dfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBvKC4uLnQpfXN0YXRpYyBjcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0LGU9MCl7cmV0dXJuIG5ldyBvKHQsNCplKX1zdGF0aWMgbnVtRWxlbWVudHMoKXtyZXR1cm4gNH10b0pTT04oKXtyZXR1cm57cjp0aGlzLnIsZzp0aGlzLmcsYjp0aGlzLmIsYTp0aGlzLmF9fWZyb21KU09OKHQpe3RoaXMucj10LnIsdGhpcy5nPXQuZyx0aGlzLmI9dC5iLHRoaXMuYT10LmF9dG9DU1NTdHJpbmcoKXtyZXR1cm4icmdiYSgiK01hdGgucm91bmQoMjU1KnRoaXMucikrIiwgIitNYXRoLnJvdW5kKDI1NSp0aGlzLmcpKyIsICIrTWF0aC5yb3VuZCgyNTUqdGhpcy5iKSsiLCAiK3RoaXMuYSsiKSJ9fWEucmVnaXN0ZXJUeXBlKCJDb2xvciIsbyk7Y2xhc3MgXyBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0wLGU9MCxzPTAsYT0wKXtpZihzdXBlcigpLGlzTmFOKGEpKXN3aXRjaChhKXtjYXNlIlhZWiI6dGhpcy5vcmRlcj0wO2JyZWFrO2Nhc2UiWVpYIjp0aGlzLm9yZGVyPTE7YnJlYWs7Y2FzZSJaWFkiOnRoaXMub3JkZXI9MjticmVhaztjYXNlIlhaWSI6dGhpcy5vcmRlcj0zO2JyZWFrO2Nhc2UiWllYIjp0aGlzLm9yZGVyPTQ7YnJlYWs7Y2FzZSJZWFoiOnRoaXMub3JkZXI9NTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiSW52YWxpZCBFdWxlciBBbmdsZXMgT3JkZXI6IithKX1lbHNlIHRoaXMub3JkZXI9YTtpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSB0aGlzLl9fZGF0YT1uZXcgRmxvYXQzMkFycmF5KDMpLHRoaXMuX19kYXRhWzBdPXQsdGhpcy5fX2RhdGFbMV09ZSx0aGlzLl9fZGF0YVsyXT1zfWdldCB4KCl7cmV0dXJuIHRoaXMuX19kYXRhWzBdfXNldCB4KHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IHkoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IHkodCl7dGhpcy5fX2RhdGFbMV09dH1nZXQgeigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgeih0KXt0aGlzLl9fZGF0YVsyXT10fXNldCh0LGUscyl7dGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lLHRoaXMuX19kYXRhWzJdPXN9fWEucmVnaXN0ZXJUeXBlKCJFdWxlckFuZ2xlcyIsXyk7Y2xhc3MgZCBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0xLGU9MCxzPTAsYT0wLGk9MSxyPTAsbj0wLGg9MCxvPTEpe2lmKHN1cGVyKCksdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXtjb25zdCBzPXQsYT1lO3RoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkocyxhLDkpfWVsc2UgdGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheSg5KSx0aGlzLnNldCh0LGUscyxhLGkscixuLGgsbyl9Z2V0IG0wMCgpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgbTAwKHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IG0wMSgpe3JldHVybiB0aGlzLl9fZGF0YVsxXX1zZXQgbTAxKHQpe3RoaXMuX19kYXRhWzFdPXR9Z2V0IG0wMigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgbTAyKHQpe3RoaXMuX19kYXRhWzJdPXR9Z2V0IG0xMCgpe3JldHVybiB0aGlzLl9fZGF0YVszXX1zZXQgbTEwKHQpe3RoaXMuX19kYXRhWzNdPXR9Z2V0IG0xMSgpe3JldHVybiB0aGlzLl9fZGF0YVs0XX1zZXQgbTExKHQpe3RoaXMuX19kYXRhWzRdPXR9Z2V0IG0xMigpe3JldHVybiB0aGlzLl9fZGF0YVs1XX1zZXQgbTEyKHQpe3RoaXMuX19kYXRhWzVdPXR9Z2V0IG0yMCgpe3JldHVybiB0aGlzLl9fZGF0YVs2XX1zZXQgbTIwKHQpe3RoaXMuX19kYXRhWzZdPXR9Z2V0IG0yMSgpe3JldHVybiB0aGlzLl9fZGF0YVs3XX1zZXQgbTIxKHQpe3RoaXMuX19kYXRhWzddPXR9Z2V0IG0yMigpe3JldHVybiB0aGlzLl9fZGF0YVs4XX1zZXQgbTIyKHQpe3RoaXMuX19kYXRhWzhdPXR9Z2V0IHhBeGlzKCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLDApfXNldCB4QXhpcyh0KXt0aGlzLnhBeGlzLnNldCh0LngsdC55LHQueil9Z2V0IHlBeGlzKCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLDMpfXNldCB5QXhpcyh0KXt0aGlzLnlBeGlzLnNldCh0LngsdC55LHQueil9Z2V0IHpBeGlzKCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLDYpfXNldCB6QXhpcyh0KXt0aGlzLnpBeGlzLnNldCh0LngsdC55LHQueil9c2V0KHQ9MSxlPTAscz0wLGE9MCxpPTEscj0wLG49MCxoPTAsbz0xKXt0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hLHRoaXMuX19kYXRhWzRdPWksdGhpcy5fX2RhdGFbNV09cix0aGlzLl9fZGF0YVs2XT1uLHRoaXMuX19kYXRhWzddPWgsdGhpcy5fX2RhdGFbOF09b31zZXRJZGVudGl0eSgpe3RoaXMuc2V0KCl9c2V0RnJvbU1hdCh0KXt0aGlzLl9fZGF0YVswXT10Lm0wMCx0aGlzLl9fZGF0YVsxXT10Lm0wMSx0aGlzLl9fZGF0YVsyXT10Lm0wMix0aGlzLl9fZGF0YVszXT10Lm0xMCx0aGlzLl9fZGF0YVs0XT10Lm0xMSx0aGlzLl9fZGF0YVs1XT10Lm0xMix0aGlzLl9fZGF0YVs2XT10Lm0yMCx0aGlzLl9fZGF0YVs3XT10Lm0yMSx0aGlzLl9fZGF0YVs4XT10Lm0yMn1zZXRGcm9tRGlyZWN0aW9uQW5kVXB2ZWN0b3IodCxlKXtjb25zdCBzPXQsYT1zLmxlbmd0aCgpO2lmKGE8TnVtYmVyLkVQU0lMT04pcmV0dXJuIHZvaWQgdGhpcy5zZXRJZGVudGl0eSgpO3Muc2NhbGVJblBsYWNlKDEvYSk7Y29uc3QgaT1lLmNyb3NzKHMpLHI9aS5sZW5ndGgoKTtyPk51bWJlci5FUFNJTE9OJiZpLnNjYWxlSW5QbGFjZSgxL3IpO2NvbnN0IG49cy5jcm9zcyhpKSxoPW4ubGVuZ3RoKCk7aD5OdW1iZXIuRVBTSUxPTiYmbi5zY2FsZUluUGxhY2UoMS9oKSx0aGlzLnNldChpLngsaS55LGkueixuLngsbi55LG4ueixzLngscy55LHMueil9aW52ZXJzZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM10saT10aGlzLl9fZGF0YVs0XSxyPXRoaXMuX19kYXRhWzVdLG49dGhpcy5fX2RhdGFbNl0saD10aGlzLl9fZGF0YVs3XSxvPXRoaXMuX19kYXRhWzhdLF89byppLXIqaCxsPS1vKmErcipuLGM9aCphLWkqbix1PXQqXytlKmwrcypjO3JldHVybiB1Pyh1PTEvdSxuZXcgZChfKnUsKC1vKmUrcypoKSp1LChyKmUtcyppKSp1LGwqdSwobyp0LXMqbikqdSwoLXIqdCtzKmEpKnUsYyp1LCgtaCp0K2UqbikqdSwoaSp0LWUqYSkqdSkpOihjb25zb2xlLndhcm4oIlVuYWJsZSB0byBpbnZlcnQgTWF0MyIpLG51bGwpfWludmVydEluUGxhY2UoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdLGk9dGhpcy5fX2RhdGFbNF0scj10aGlzLl9fZGF0YVs1XSxuPXRoaXMuX19kYXRhWzZdLGg9dGhpcy5fX2RhdGFbN10sbz10aGlzLl9fZGF0YVs4XSxfPW8qaS1yKmgsZD0tbyphK3IqbixsPWgqYS1pKm4sYz10Kl8rZSpkK3MqbDtyZXR1cm4gYz8oYz0xL2MsdGhpcy5zZXQoXypjLCgtbyplK3MqaCkqYywociplLXMqaSkqYyxkKmMsKG8qdC1zKm4pKmMsKC1yKnQrcyphKSpjLGwqYywoLWgqdCtlKm4pKmMsKGkqdC1lKmEpKmMpLCEwKTooY29uc29sZS53YXJuKCJVbmFibGUgdG8gaW52ZXJ0IE1hdDMiKSwhMSl9dHJhbnNwb3NlKCl7cmV0dXJuIGQodGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbM10sdGhpcy5fX2RhdGFbNl0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbNF0sdGhpcy5fX2RhdGFbN10sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbNV0sdGhpcy5fX2RhdGFbOF0pfXRyYW5zcG9zZUluUGxhY2UoKXtjb25zdCB0PXRoaXMuX19kYXRhWzFdLGU9dGhpcy5fX2RhdGFbMl0scz10aGlzLl9fZGF0YVs1XTt0aGlzLl9fZGF0YVsxXT10aGlzLl9fZGF0YVszXSx0aGlzLl9fZGF0YVsyXT10aGlzLl9fZGF0YVs2XSx0aGlzLl9fZGF0YVszXT10LHRoaXMuX19kYXRhWzVdPXRoaXMuX19kYXRhWzddLHRoaXMuX19kYXRhWzZdPWUsdGhpcy5fX2RhdGFbN109c310cmFuc2Zvcm1WZWMzKHQpe3JldHVybiBuZXcgcih0aGlzLl9fZGF0YVswXSp0LngrdGhpcy5fX2RhdGFbMV0qdC55K3RoaXMuX19kYXRhWzJdKnQueix0aGlzLl9fZGF0YVszXSp0LngrdGhpcy5fX2RhdGFbNF0qdC55K3RoaXMuX19kYXRhWzVdKnQueix0aGlzLl9fZGF0YVs2XSp0LngrdGhpcy5fX2RhdGFbN10qdC55K3RoaXMuX19kYXRhWzhdKnQueil9Y2xvbmUoKXtyZXR1cm4gbmV3IGQodGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbM10sdGhpcy5fX2RhdGFbNF0sdGhpcy5fX2RhdGFbNV0sdGhpcy5fX2RhdGFbNl0sdGhpcy5fX2RhdGFbN10sdGhpcy5fX2RhdGFbOF0sdGhpcy5fX2RhdGFbOV0pfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBkKC4uLnQpfXN0YXRpYyBjcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0LGU9MCl7cmV0dXJuIG5ldyBkKHQsNCplKX10b0pTT04oKXtyZXR1cm4gdGhpcy5fX2RhdGF9ZnJvbUpTT04odCl7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheSh0KX10b1N0cmluZygpe3JldHVybiB0aGlzLnRvSlNPTigpLnRvU3RyaW5nKCl9fWEucmVnaXN0ZXJUeXBlKCJNYXQzIixkKTtjbGFzcyBsIGV4dGVuZHMgc3tjb25zdHJ1Y3Rvcih0PTEsZT0wLHM9MCxhPTAsaT0wLHI9MSxuPTAsaD0wLG89MCxfPTAsZD0xLGw9MCxjPTAsdT0wLGY9MCxtPTEpe2lmKHN1cGVyKCksdCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSl0aGlzLl9fZGF0YT10O2Vsc2UgaWYodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXtjb25zdCBzPXQsYT1lO3RoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkocyxhLDE2KX1lbHNlIHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMTYpLHRoaXMuc2V0KHQsZSxzLGEsaSxyLG4saCxvLF8sZCxsLGMsdSxmLG0pfWdldCBtMDAoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMF19c2V0IG0wMCh0KXt0aGlzLl9fZGF0YVswXT10fWdldCBtMDEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IG0wMSh0KXt0aGlzLl9fZGF0YVsxXT10fWdldCBtMDIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMl19c2V0IG0wMih0KXt0aGlzLl9fZGF0YVsyXT10fWdldCBtMDMoKXtyZXR1cm4gdGhpcy5fX2RhdGFbM119c2V0IG0wMyh0KXt0aGlzLl9fZGF0YVszXT10fWdldCBtMTAoKXtyZXR1cm4gdGhpcy5fX2RhdGFbNF19c2V0IG0xMCh0KXt0aGlzLl9fZGF0YVs0XT10fWdldCBtMTEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbNV19c2V0IG0xMSh0KXt0aGlzLl9fZGF0YVs1XT10fWdldCBtMTIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbNl19c2V0IG0xMih0KXt0aGlzLl9fZGF0YVs2XT10fWdldCBtMTMoKXtyZXR1cm4gdGhpcy5fX2RhdGFbN119c2V0IG0xMyh0KXt0aGlzLl9fZGF0YVs3XT10fWdldCBtMjAoKXtyZXR1cm4gdGhpcy5fX2RhdGFbOF19c2V0IG0yMCh0KXt0aGlzLl9fZGF0YVs4XT10fWdldCBtMjEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbOV19c2V0IG0yMSh0KXt0aGlzLl9fZGF0YVs5XT10fWdldCBtMjIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMTBdfXNldCBtMjIodCl7dGhpcy5fX2RhdGFbMTBdPXR9Z2V0IG0yMygpe3JldHVybiB0aGlzLl9fZGF0YVsxMV19c2V0IG0yMyh0KXt0aGlzLl9fZGF0YVsxMV09dH1nZXQgbTMwKCl7cmV0dXJuIHRoaXMuX19kYXRhWzEyXX1zZXQgbTMwKHQpe3RoaXMuX19kYXRhWzEyXT10fWdldCBtMzEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMTNdfXNldCBtMzEodCl7dGhpcy5fX2RhdGFbMTNdPXR9Z2V0IG0zMigpe3JldHVybiB0aGlzLl9fZGF0YVsxNF19c2V0IG0zMih0KXt0aGlzLl9fZGF0YVsxNF09dH1nZXQgbTMzKCl7cmV0dXJuIHRoaXMuX19kYXRhWzE1XX1zZXQgbTMzKHQpe3RoaXMuX19kYXRhWzE1XT10fWdldCB4QXhpcygpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciwwKX1zZXQgeEF4aXModCl7dGhpcy54QXhpcy5zZXQodC54LHQueSx0LnopfWdldCB5QXhpcygpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciw0KX1zZXQgeUF4aXModCl7dGhpcy55QXhpcy5zZXQodC54LHQueSx0LnopfWdldCB6QXhpcygpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciw4KX1zZXQgekF4aXModCl7dGhpcy56QXhpcy5zZXQodC54LHQueSx0LnopfWdldCB0cmFuc2xhdGlvbigpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciwxMil9c2V0IHRyYW5zbGF0aW9uKHQpe3RoaXMudHJhbnNsYXRpb24uc2V0KHQueCx0LnksdC56KX1zZXQodD0xLGU9MCxzPTAsYT0wLGk9MCxyPTEsbj0wLGg9MCxvPTAsXz0wLGQ9MSxsPTAsYz0wLHU9MCxmPTAsbT0xKXt0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hLHRoaXMuX19kYXRhWzRdPWksdGhpcy5fX2RhdGFbNV09cix0aGlzLl9fZGF0YVs2XT1uLHRoaXMuX19kYXRhWzddPWgsdGhpcy5fX2RhdGFbOF09byx0aGlzLl9fZGF0YVs5XT1fLHRoaXMuX19kYXRhWzEwXT1kLHRoaXMuX19kYXRhWzExXT1sLHRoaXMuX19kYXRhWzEyXT1jLHRoaXMuX19kYXRhWzEzXT11LHRoaXMuX19kYXRhWzE0XT1mLHRoaXMuX19kYXRhWzE1XT1tfXNldElkZW50aXR5KCl7dGhpcy5zZXQoKX1zZXREYXRhQXJyYXkodCl7dGhpcy5fX2RhdGE9dH1zZXRGcm9tTWF0NCh0KXt0aGlzLl9fZGF0YVswXT10Lm0wMCx0aGlzLl9fZGF0YVsxXT10Lm0wMSx0aGlzLl9fZGF0YVsyXT10Lm0wMix0aGlzLl9fZGF0YVszXT10Lm0wMyx0aGlzLl9fZGF0YVs0XT10Lm0xMCx0aGlzLl9fZGF0YVs1XT10Lm0xMSx0aGlzLl9fZGF0YVs2XT10Lm0xMix0aGlzLl9fZGF0YVs3XT10Lm0xMyx0aGlzLl9fZGF0YVs4XT10Lm0yMCx0aGlzLl9fZGF0YVs5XT10Lm0yMSx0aGlzLl9fZGF0YVsxMF09dC5tMjIsdGhpcy5fX2RhdGFbMTFdPXQubTIzLHRoaXMuX19kYXRhWzEyXT10Lm0zMCx0aGlzLl9fZGF0YVsxM109dC5tMzEsdGhpcy5fX2RhdGFbMTRdPXQubTMyLHRoaXMuX19kYXRhWzE1XT10Lm0zM310b01hdDModCl7cmV0dXJuIG5ldyBkKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzRdLHRoaXMuX19kYXRhWzVdLHRoaXMuX19kYXRhWzZdLHRoaXMuX19kYXRhWzhdLHRoaXMuX19kYXRhWzldLHRoaXMuX19kYXRhWzEwXSl9dHJhbnNwb3NlSW5QbGFjZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMV0sZT10aGlzLl9fZGF0YVsyXSxzPXRoaXMuX19kYXRhWzNdLGE9dGhpcy5fX2RhdGFbNl0saT10aGlzLl9fZGF0YVs3XSxyPXRoaXMuX19kYXRhWzExXTt0aGlzLl9fZGF0YVsxXT10aGlzLl9fZGF0YVs0XSx0aGlzLl9fZGF0YVsyXT10aGlzLl9fZGF0YVs4XSx0aGlzLl9fZGF0YVszXT10aGlzLl9fZGF0YVsxMl0sdGhpcy5fX2RhdGFbNF09dCx0aGlzLl9fZGF0YVs2XT10aGlzLl9fZGF0YVs5XSx0aGlzLl9fZGF0YVs3XT10aGlzLl9fZGF0YVsxM10sdGhpcy5fX2RhdGFbOF09ZSx0aGlzLl9fZGF0YVs5XT1hLHRoaXMuX19kYXRhWzExXT10aGlzLl9fZGF0YVsxNF0sdGhpcy5fX2RhdGFbMTJdPXMsdGhpcy5fX2RhdGFbMTNdPWksdGhpcy5fX2RhdGFbMTRdPXJ9dHJhbnNwb3NlKCl7cmV0dXJuIG5ldyBsKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzRdLHRoaXMuX19kYXRhWzhdLHRoaXMuX19kYXRhWzEyXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVs1XSx0aGlzLl9fZGF0YVs5XSx0aGlzLl9fZGF0YVsxM10sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbNl0sdGhpcy5fX2RhdGFbMTBdLHRoaXMuX19kYXRhWzE0XSx0aGlzLl9fZGF0YVszXSx0aGlzLl9fZGF0YVs3XSx0aGlzLl9fZGF0YVsxMV0sdGhpcy5fX2RhdGFbMTVdKX1pbnZlcnNlKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdLHM9dGhpcy5fX2RhdGFbMl0sYT10aGlzLl9fZGF0YVszXSxpPXRoaXMuX19kYXRhWzRdLHI9dGhpcy5fX2RhdGFbNV0sbj10aGlzLl9fZGF0YVs2XSxoPXRoaXMuX19kYXRhWzddLG89dGhpcy5fX2RhdGFbOF0sXz10aGlzLl9fZGF0YVs5XSxkPXRoaXMuX19kYXRhWzEwXSxjPXRoaXMuX19kYXRhWzExXSx1PXRoaXMuX19kYXRhWzEyXSxmPXRoaXMuX19kYXRhWzEzXSxtPXRoaXMuX19kYXRhWzE0XSxnPXRoaXMuX19kYXRhWzE1XSx5PXQqci1lKmkscD10Km4tcyppLGI9dCpoLWEqaSx4PWUqbi1zKnIsdz1lKmgtYSpyLEk9cypoLWEqbixOPW8qZi1fKnUsRj1vKm0tZCp1LHo9bypnLWMqdSxWPV8qbS1kKmYsTT1fKmctYypmLEE9ZCpnLWMqbTtsZXQgUz15KkEtcCpNK2IqVit4KnotdypGK0kqTjtyZXR1cm4gUz8oUz0xL1MsbmV3IGwoKHIqQS1uKk0raCpWKSpTLChzKk0tZSpBLWEqVikqUywoZipJLW0qdytnKngpKlMsKGQqdy1fKkktYyp4KSpTLChuKnotaSpBLWgqRikqUywodCpBLXMqeithKkYpKlMsKG0qYi11KkktZypwKSpTLChvKkktZCpiK2MqcCkqUywoaSpNLXIqeitoKk4pKlMsKGUqei10Kk0tYSpOKSpTLCh1KnctZipiK2cqeSkqUywoXypiLW8qdy1jKnkpKlMsKHIqRi1pKlYtbipOKSpTLCh0KlYtZSpGK3MqTikqUywoZipwLXUqeC1tKnkpKlMsKG8qeC1fKnArZCp5KSpTKSk6KGNvbnNvbGUud2FybigiVW5hYmxlIHRvIGludmVydCBNYXQ0IiksbnVsbCl9aW52ZXJ0SW5QbGFjZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM10saT10aGlzLl9fZGF0YVs0XSxyPXRoaXMuX19kYXRhWzVdLG49dGhpcy5fX2RhdGFbNl0saD10aGlzLl9fZGF0YVs3XSxvPXRoaXMuX19kYXRhWzhdLF89dGhpcy5fX2RhdGFbOV0sZD10aGlzLl9fZGF0YVsxMF0sbD10aGlzLl9fZGF0YVsxMV0sYz10aGlzLl9fZGF0YVsxMl0sdT10aGlzLl9fZGF0YVsxM10sZj10aGlzLl9fZGF0YVsxNF0sbT10aGlzLl9fZGF0YVsxNV0sZz10KnItZSppLHk9dCpuLXMqaSxwPXQqaC1hKmksYj1lKm4tcypyLHg9ZSpoLWEqcix3PXMqaC1hKm4sST1vKnUtXypjLE49bypmLWQqYyxGPW8qbS1sKmMsej1fKmYtZCp1LFY9XyptLWwqdSxNPWQqbS1sKmY7bGV0IEE9ZypNLXkqVitwKnorYipGLXgqTit3Kkk7cmV0dXJuIEE/KEE9MS9BLHRoaXMuc2V0KChyKk0tbipWK2gqeikqQSwocypWLWUqTS1hKnopKkEsKHUqdy1mKngrbSpiKSpBLChkKngtXyp3LWwqYikqQSwobipGLWkqTS1oKk4pKkEsKHQqTS1zKkYrYSpOKSpBLChmKnAtYyp3LW0qeSkqQSwobyp3LWQqcCtsKnkpKkEsKGkqVi1yKkYraCpJKSpBLChlKkYtdCpWLWEqSSkqQSwoYyp4LXUqcCttKmcpKkEsKF8qcC1vKngtbCpnKSpBLChyKk4taSp6LW4qSSkqQSwodCp6LWUqTitzKkkpKkEsKHUqeS1jKmItZipnKSpBLChvKmItXyp5K2QqZykqQSksITApOihjb25zb2xlLndhcm4oIlVuYWJsZSB0byBpbnZlcnQgTWF0NCIpLCExKX1zZXRJbnZlcnNlKHQpe2NvbnN0IGU9dC5fX2RhdGFbMF0scz10Ll9fZGF0YVsxXSxhPXQuX19kYXRhWzJdLGk9dC5fX2RhdGFbM10scj10Ll9fZGF0YVs0XSxuPXQuX19kYXRhWzVdLGg9dC5fX2RhdGFbNl0sbz10Ll9fZGF0YVs3XSxfPXQuX19kYXRhWzhdLGQ9dC5fX2RhdGFbOV0sbD10Ll9fZGF0YVsxMF0sYz10Ll9fZGF0YVsxMV0sdT10Ll9fZGF0YVsxMl0sZj10Ll9fZGF0YVsxM10sbT10Ll9fZGF0YVsxNF0sZz10Ll9fZGF0YVsxNV0seT1lKm4tcypyLHA9ZSpoLWEqcixiPWUqby1pKnIseD1zKmgtYSpuLHc9cypvLWkqbixJPWEqby1pKmgsTj1fKmYtZCp1LEY9XyptLWwqdSx6PV8qZy1jKnUsVj1kKm0tbCpmLE09ZCpnLWMqZixBPWwqZy1jKm07bGV0IFM9eSpBLXAqTStiKlYreCp6LXcqRitJKk47aWYoIVMpdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gaW52ZXJ0IE1hdDQiKTtTPTEvUyx0aGlzLnNldCgobipBLWgqTStvKlYpKlMsKGEqTS1zKkEtaSpWKSpTLChmKkktbSp3K2cqeCkqUywobCp3LWQqSS1jKngpKlMsKGgqei1yKkEtbypGKSpTLChlKkEtYSp6K2kqRikqUywobSpiLXUqSS1nKnApKlMsKF8qSS1sKmIrYypwKSpTLChyKk0tbip6K28qTikqUywocyp6LWUqTS1pKk4pKlMsKHUqdy1mKmIrZyp5KSpTLChkKmItXyp3LWMqeSkqUywobipGLXIqVi1oKk4pKlMsKGUqVi1zKkYrYSpOKSpTLChmKnAtdSp4LW0qeSkqUywoXyp4LWQqcCtsKnkpKlMpfW11bHRpcGx5KHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0scz10aGlzLl9fZGF0YVsxXSxhPXRoaXMuX19kYXRhWzJdLGk9dGhpcy5fX2RhdGFbM10scj10aGlzLl9fZGF0YVs0XSxuPXRoaXMuX19kYXRhWzVdLGg9dGhpcy5fX2RhdGFbNl0sbz10aGlzLl9fZGF0YVs3XSxfPXRoaXMuX19kYXRhWzhdLGQ9dGhpcy5fX2RhdGFbOV0sYz10aGlzLl9fZGF0YVsxMF0sdT10aGlzLl9fZGF0YVsxMV0sZj10aGlzLl9fZGF0YVsxMl0sbT10aGlzLl9fZGF0YVsxM10sZz10aGlzLl9fZGF0YVsxNF0seT10aGlzLl9fZGF0YVsxNV0scD10LmFzQXJyYXkoKTtsZXQgYj1wWzBdLHg9cFsxXSx3PXBbMl0sST1wWzNdO2NvbnN0IE49bmV3IGw7cmV0dXJuIE4ubTAwPWIqZSt4KnIrdypfK0kqZixOLm0wMT1iKnMreCpuK3cqZCtJKm0sTi5tMDI9YiphK3gqaCt3KmMrSSpnLE4ubTAzPWIqaSt4Km8rdyp1K0kqeSxiPXBbNF0seD1wWzVdLHc9cFs2XSxJPXBbN10sTi5tMTA9YiplK3gqcit3Kl8rSSpmLE4ubTExPWIqcyt4Km4rdypkK0kqbSxOLm0xMj1iKmEreCpoK3cqYytJKmcsTi5tMTM9YippK3gqbyt3KnUrSSp5LGI9cFs4XSx4PXBbOV0sdz1wWzEwXSxJPXBbMTFdLE4ubTIwPWIqZSt4KnIrdypfK0kqZixOLm0yMT1iKnMreCpuK3cqZCtJKm0sTi5tMjI9YiphK3gqaCt3KmMrSSpnLE4ubTIzPWIqaSt4Km8rdyp1K0kqeSxiPXBbMTJdLHg9cFsxM10sdz1wWzE0XSxJPXBbMTVdLE4ubTMwPWIqZSt4KnIrdypfK0kqZixOLm0zMT1iKnMreCpuK3cqZCtJKm0sTi5tMzI9YiphK3gqaCt3KmMrSSpnLE4ubTMzPWIqaSt4Km8rdyp1K0kqeSxOfW11bHRpcGx5SW5QbGFjZSh0KXtjb25zdCBlPXRoaXMuYXNBcnJheSgpLHM9ZVswXSxhPWVbMV0saT1lWzJdLHI9ZVszXSxuPWVbNF0saD1lWzVdLG89ZVs2XSxfPWVbN10sZD1lWzhdLGw9ZVs5XSxjPWVbMTBdLHU9ZVsxMV0sZj1lWzEyXSxtPWVbMTNdLGc9ZVsxNF0seT1lWzE1XSxwPXQuYXNBcnJheSgpO2xldCBiPXBbMF0seD1wWzFdLHc9cFsyXSxJPXBbM107cmV0dXJuIHRoaXMubTAwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0wMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMDI9YippK3gqbyt3KmMrSSpnLHRoaXMubTAzPWIqcit4Kl8rdyp1K0kqeSxiPXBbNF0seD1wWzVdLHc9cFs2XSxJPXBbN10sdGhpcy5tMTA9YipzK3gqbit3KmQrSSpmLHRoaXMubTExPWIqYSt4KmgrdypsK0kqbSx0aGlzLm0xMj1iKmkreCpvK3cqYytJKmcsdGhpcy5tMTM9YipyK3gqXyt3KnUrSSp5LGI9cFs4XSx4PXBbOV0sdz1wWzEwXSxJPXBbMTFdLHRoaXMubTIwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0yMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMjI9YippK3gqbyt3KmMrSSpnLHRoaXMubTIzPWIqcit4Kl8rdyp1K0kqeSxiPXBbMTJdLHg9cFsxM10sdz1wWzE0XSxJPXBbMTVdLHRoaXMubTMwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0zMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMzI9YippK3gqbyt3KmMrSSpnLHRoaXMubTMzPWIqcit4Kl8rdyp1K0kqeSx0aGlzfXBvc3RtdWx0aXBseUluUGxhY2UodCl7Y29uc3QgZT10LmFzQXJyYXkoKSxzPWVbMF0sYT1lWzFdLGk9ZVsyXSxyPWVbM10sbj1lWzRdLGg9ZVs1XSxvPWVbNl0sXz1lWzddLGQ9ZVs4XSxsPWVbOV0sYz1lWzEwXSx1PWVbMTFdLGY9ZVsxMl0sbT1lWzEzXSxnPWVbMTRdLHk9ZVsxNV0scD10aGlzLmFzQXJyYXkoKTtsZXQgYj1wWzBdLHg9cFsxXSx3PXBbMl0sST1wWzNdO3JldHVybiB0aGlzLm0wMD1iKnMreCpuK3cqZCtJKmYsdGhpcy5tMDE9YiphK3gqaCt3KmwrSSptLHRoaXMubTAyPWIqaSt4Km8rdypjK0kqZyx0aGlzLm0wMz1iKnIreCpfK3cqdStJKnksYj1wWzRdLHg9cFs1XSx3PXBbNl0sST1wWzddLHRoaXMubTEwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0xMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMTI9YippK3gqbyt3KmMrSSpnLHRoaXMubTEzPWIqcit4Kl8rdyp1K0kqeSxiPXBbOF0seD1wWzldLHc9cFsxMF0sST1wWzExXSx0aGlzLm0yMD1iKnMreCpuK3cqZCtJKmYsdGhpcy5tMjE9YiphK3gqaCt3KmwrSSptLHRoaXMubTIyPWIqaSt4Km8rdypjK0kqZyx0aGlzLm0yMz1iKnIreCpfK3cqdStJKnksYj1wWzEyXSx4PXBbMTNdLHc9cFsxNF0sST1wWzE1XSx0aGlzLm0zMD1iKnMreCpuK3cqZCtJKmYsdGhpcy5tMzE9YiphK3gqaCt3KmwrSSptLHRoaXMubTMyPWIqaSt4Km8rdypjK0kqZyx0aGlzLm0zMz1iKnIreCpfK3cqdStJKnksdGhpc310cmFuc2xhdGVJblBsYWNlKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGEscz10LngsYT10LnksaT10Lno7cmV0dXJuIGVbMTJdPWVbMF0qcytlWzRdKmErZVs4XSppK2VbMTJdLGVbMTNdPWVbMV0qcytlWzVdKmErZVs5XSppK2VbMTNdLGVbMTRdPWVbMl0qcytlWzZdKmErZVsxMF0qaStlWzE0XSxlWzE1XT1lWzNdKnMrZVs3XSphK2VbMTFdKmkrZVsxNV0sdGhpc31zZXRMb29rQXQodCxlLHMpe2NvbnN0IGE9dC5zdWJ0cmFjdChlKSxpPWEubGVuZ3RoKCk7aWYoaTxOdW1iZXIuRVBTSUxPTilyZXR1cm4gdm9pZCB0aGlzLnNldElkZW50aXR5KCk7YS5zY2FsZUluUGxhY2UoMS9pKTtjb25zdCByPXMuY3Jvc3MoYSksbj1yLmxlbmd0aCgpO24+TnVtYmVyLkVQU0lMT04mJnIuc2NhbGVJblBsYWNlKDEvbik7Y29uc3QgaD1hLmNyb3NzKHIpLG89aC5sZW5ndGgoKTtvPk51bWJlci5FUFNJTE9OJiZoLnNjYWxlSW5QbGFjZSgxL28pLHRoaXMuc2V0KHIueCxyLnksci56LDAsaC54LGgueSxoLnosMCxhLngsYS55LGEueiwwLHQueCx0LnksdC56LDEpfXNldFJvdGF0aW9uKHQsZSl7Y29uc3Qgcz10Lmxlbmd0aCgpO2lmKE1hdGguYWJzKHMpPE51bWJlci5FUFNJTE9OKXJldHVybiBudWxsO2NvbnN0IGE9dC54L3MsaT10LnkvcyxyPXQuei9zLG49TWF0aC5zaW4oZSksaD1NYXRoLmNvcyhlKSxvPTEtaCxfPXRoaXMuX19kYXRhO3JldHVybiBfWzBdPWEqYSpvK2gsX1sxXT1pKmEqbytyKm4sX1syXT1yKmEqby1pKm4sX1szXT0wLF9bNF09YSppKm8tcipuLF9bNV09aSppKm8raCxfWzZdPXIqaSpvK2EqbixfWzddPTAsX1s4XT1hKnIqbytpKm4sX1s5XT1pKnIqby1hKm4sX1sxMF09cipyKm8raCxfWzExXT0wLF9bMTJdPTAsX1sxM109MCxfWzE0XT0wLF9bMTVdPTEsdGhpc31zZXRYUm90YXRpb24odCl7Y29uc3QgZT1NYXRoLnNpbih0KSxzPU1hdGguY29zKHQpLGE9dGhpcy5fX2RhdGE7cmV0dXJuIGFbMF09MSxhWzFdPTAsYVsyXT0wLGFbM109MCxhWzRdPTAsYVs1XT1zLGFbNl09ZSxhWzddPTAsYVs4XT0wLGFbOV09LWUsYVsxMF09cyxhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsdGhpc31zZXRZUm90YXRpb24odCl7Y29uc3QgZT1NYXRoLnNpbih0KSxzPU1hdGguY29zKHQpLGE9dGhpcy5fX2RhdGE7cmV0dXJuIGFbMF09cyxhWzFdPTAsYVsyXT0tZSxhWzNdPTAsYVs0XT0wLGFbNV09MSxhWzZdPTAsYVs3XT0wLGFbOF09ZSxhWzldPTAsYVsxMF09cyxhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsdGhpc31zZXRaUm90YXRpb24odCl7Y29uc3QgZT1NYXRoLnNpbih0KSxzPU1hdGguY29zKHQpLGE9dGhpcy5fX2RhdGE7cmV0dXJuIGFbMF09cyxhWzFdPWUsYVsyXT0wLGFbM109MCxhWzRdPS1lLGFbNV09cyxhWzZdPTAsYVs3XT0wLGFbOF09MCxhWzldPTAsYVsxMF09MSxhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsdGhpc310cmFuc2Zvcm1WZWM0KHQpe2NvbnN0IGU9dGhpcy5fX2RhdGEscz10LngsYT10LnksaT10Lnoscj10LnQ7cmV0dXJuIG5ldyBWZWM0KGVbMF0qcytlWzRdKmErZVs4XSppK2VbMTJdKnIsZVsxXSpzK2VbNV0qYStlWzldKmkrZVsxM10qcixlWzJdKnMrZVs2XSphK2VbMTBdKmkrZVsxNF0qcixlWzNdKnMrZVs3XSphK2VbMTFdKmkrZVsxNV0qcil9dHJhbnNmb3JtVmVjMyh0KXtjb25zdCBlPXRoaXMuX19kYXRhLHM9dC54LGE9dC55LGk9dC56O3JldHVybiBuZXcgcihlWzBdKnMrZVs0XSphK2VbOF0qaStlWzEyXSxlWzFdKnMrZVs1XSphK2VbOV0qaStlWzEzXSxlWzJdKnMrZVs2XSphK2VbMTBdKmkrZVsxNF0pfXJvdGF0ZVZlYzModCl7Y29uc3QgZT10aGlzLl9fZGF0YSxzPXQueCxhPXQueSxpPXQuejtyZXR1cm4gbmV3IHIoZVswXSpzK2VbNF0qYStlWzhdKmksZVsxXSpzK2VbNV0qYStlWzldKmksZVsyXSpzK2VbNl0qYStlWzEwXSppKX1zZXRQZXJzcGVjdGl2ZU1hdHJpeCh0LGUscyxhKXtjb25zdCBpPU1hdGgudGFuKC41Kk1hdGguUEktLjUqdCkscj0xLyhzLWEpO3RoaXMuc2V0KGkvZSwwLDAsMCwwLGksMCwwLDAsMCwocythKSpyLC0xLDAsMCxzKmEqcioyLDApfXNldE9ydGhvZ3JhcGhpY01hdHJpeCh0LGUscyxhLGkscil7Y29uc3Qgbj0xLyh0LWUpLGg9MS8ocy1hKSxvPTEvKGktcik7dGhpcy5zZXQoLTIqbiwwLDAsMCwwLC0yKmgsMCwwLDAsMCwyKm8sMCwodCtlKSpuLChhK3MpKmgsKHIraSkqbywxKX1zZXRTY2FsZSh0LGUscyl7dCBpbnN0YW5jZW9mIHI/dGhpcy5zZXQodC54LDAsMCwwLDAsdC55LDAsMCwwLDAsdC56LDAsMCwwLDAsMSk6dGhpcy5zZXQodCwwLDAsMCwwLGUsMCwwLDAsMCxzLDAsMCwwLDAsMSl9c2V0RnJvbU1hdDN4NEFycmF5KHQpe3RoaXMuc2V0KHRbMF0sdFsxXSx0WzJdLDAsdFszXSx0WzRdLHRbNV0sMCx0WzZdLHRbN10sdFs4XSwwLHRbOV0sdFsxMF0sdFsxMV0sMSl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IGwodCw0KmUpfWNsb25lKCl7cmV0dXJuIG5ldyBsKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzNdLHRoaXMuX19kYXRhWzRdLHRoaXMuX19kYXRhWzVdLHRoaXMuX19kYXRhWzZdLHRoaXMuX19kYXRhWzddLHRoaXMuX19kYXRhWzhdLHRoaXMuX19kYXRhWzldLHRoaXMuX19kYXRhWzEwXSx0aGlzLl9fZGF0YVsxMV0sdGhpcy5fX2RhdGFbMTJdLHRoaXMuX19kYXRhWzEzXSx0aGlzLl9fZGF0YVsxNF0sdGhpcy5fX2RhdGFbMTVdKX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgbCguLi50KX10b0pTT04oKXtyZXR1cm4gdGhpcy5fX2RhdGF9ZnJvbUpTT04odCl7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheSh0KX19YS5yZWdpc3RlclR5cGUoIk1hdDQiLGwpO2NsYXNzIHUgZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQ9MCxlPTAscz0wLGE9MSl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSBpZih0aGlzLl9fZGF0YT1uZXcgRmxvYXQzMkFycmF5KDQpLCJvYmplY3QiPT10eXBlb2YgdCl7dGhpcy5fX2RhdGFbMF09MCx0aGlzLl9fZGF0YVsxXT0wLHRoaXMuX19kYXRhWzJdPTAsdGhpcy5fX2RhdGFbM109MTtmb3IoY29uc3QgZSBpbiB0KUFycmF5LmlzQXJyYXkodFtlXSk/dGhpc1tlXS5jYWxsKHRoaXMsLi4udFtlXSk6dGhpc1tlXS5jYWxsKHRoaXMsdFtlXSl9ZWxzZSB0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hfWdldCB4KCl7cmV0dXJuIHRoaXMuX19kYXRhWzBdfXNldCB4KHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IHkoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IHkodCl7dGhpcy5fX2RhdGFbMV09dH1nZXQgeigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgeih0KXt0aGlzLl9fZGF0YVsyXT10fWdldCB3KCl7cmV0dXJuIHRoaXMuX19kYXRhWzNdfXNldCB3KHQpe3RoaXMuX19kYXRhWzNdPXR9c2V0KHQsZSxzLGEpe3RoaXMuX19kYXRhWzBdPXQsdGhpcy5fX2RhdGFbMV09ZSx0aGlzLl9fZGF0YVsyXT1zLHRoaXMuX19kYXRhWzNdPWF9c2V0RGF0YUFycmF5KHQpe3RoaXMuX19kYXRhPXR9c2V0RnJvbU90aGVyKHQpe3RoaXMuX19kYXRhWzBdPXQueCx0aGlzLl9fZGF0YVsxXT10LnksdGhpcy5fX2RhdGFbMl09dC56LHRoaXMuX19kYXRhWzNdPXQud31zZXRGcm9tRXVsZXJBbmdsZXModCl7Y29uc3QgZT1uZXcgcjtzd2l0Y2godC5vcmRlcil7Y2FzZSAwOmUuc2V0KHQueCwtdC55LHQueik7YnJlYWs7Y2FzZSAxOmUuc2V0KHQueSwtdC56LHQueCk7YnJlYWs7Y2FzZSAyOmUuc2V0KHQueiwtdC54LHQueSk7YnJlYWs7Y2FzZSAzOmUuc2V0KHQueCx0LnosdC55KTticmVhaztjYXNlIDQ6ZS5zZXQodC56LHQueSx0LngpO2JyZWFrO2Nhc2UgNTplLnNldCh0LnksdC54LHQueik7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInNkcnR5Iil9Y29uc3Qgcz0uNSplLngsYT0uNSplLnksaT0uNSplLnosbj1NYXRoLmNvcyhzKSxoPU1hdGguY29zKGEpLG89TWF0aC5jb3MoaSksXz1NYXRoLnNpbihzKSxkPU1hdGguc2luKGEpLGw9TWF0aC5zaW4oaSksYz1uKm8sdT1uKmwsZj1fKm8sbT1fKmwsZz1oKmYtZCp1LHk9aCptK2QqYyxwPWgqdS1kKmY7c3dpdGNoKHRoaXMudz1oKmMrZCptLHQub3JkZXIpe2Nhc2UgMDp0aGlzLng9Zyx0aGlzLnk9LXksdGhpcy56PXA7YnJlYWs7Y2FzZSAxOnRoaXMueD1wLHRoaXMueT1nLHRoaXMuej0teTticmVhaztjYXNlIDI6dGhpcy54PS15LHRoaXMueT1wLHRoaXMuej1nO2JyZWFrO2Nhc2UgMzp0aGlzLng9Zyx0aGlzLnk9cCx0aGlzLno9eTticmVhaztjYXNlIDQ6dGhpcy54PXAsdGhpcy55PXksdGhpcy56PWc7YnJlYWs7Y2FzZSA1OnRoaXMueD15LHRoaXMueT1nLHRoaXMuej1wO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJzZHJ0eSIpfX10b0V1bGVyQW5nbGVzKHQpe2NvbnN0IGU9bmV3IHI7c3dpdGNoKHQpe2Nhc2UgMDplLnNldCh0aGlzLnosdGhpcy54LHRoaXMueSk7YnJlYWs7Y2FzZSAxOmUuc2V0KHRoaXMueCx0aGlzLnksdGhpcy56KTticmVhaztjYXNlIDI6ZS5zZXQodGhpcy55LHRoaXMueix0aGlzLngpO2JyZWFrO2Nhc2UgMzplLnNldCh0aGlzLnksLXRoaXMueCx0aGlzLnopO2JyZWFrO2Nhc2UgNDplLnNldCh0aGlzLngsLXRoaXMueix0aGlzLnkpO2JyZWFrO2Nhc2UgNTplLnNldCh0aGlzLnosLXRoaXMueSx0aGlzLngpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHJvdGF0aW9uIG9yZGVyOiIrdCl9Y29uc3Qgcz1uZXcgcixhPWUueCplLnkrZS56KnRoaXMudztpZihhPi40OTk5OSlzLnk9MipNYXRoLmF0YW4yKGUueCx0aGlzLncpLHMuej0uNSpNYXRoLlBJLHMueD0wO2Vsc2UgaWYoYTwtLjQ5OTk5KXMueT0tMipNYXRoLmF0YW4yKGUueCx0aGlzLncpLHMuej0tLjUqTWF0aC5QSSxzLng9MDtlbHNle2NvbnN0IHQ9ZS54KmUueCxpPWUueSplLnkscj1lLnoqZS56O3MueT1NYXRoLmF0YW4yKDIqZS55KnRoaXMudy0yKmUueCplLnosMS0yKmktMipyKSxzLno9TWF0aC5hc2luKDIqYSkscy54PU1hdGguYXRhbjIoMiplLngqdGhpcy53LTIqZS55KmUueiwxLTIqdC0yKnIpfXN3aXRjaCh0KXtjYXNlIDA6cmV0dXJuIG5ldyBfKHMueSxzLnoscy54LHQpO2Nhc2UgMTpyZXR1cm4gbmV3IF8ocy54LHMueSxzLnosdCk7Y2FzZSAyOnJldHVybiBuZXcgXyhzLnoscy54LHMueSx0KTtjYXNlIDM6cmV0dXJuIG5ldyBfKC1zLnkscy54LHMueix0KTtjYXNlIDQ6cmV0dXJuIG5ldyBfKHMueCxzLnosLXMueSx0KTtjYXNlIDU6cmV0dXJuIG5ldyBfKHMueiwtcy55LHMueCx0KX19c2V0RnJvbUF4aXNBbmRBbmdsZSh0LGUpe2NvbnN0IHM9ZS8yLGE9dC5ub3JtYWxpemUoKS5zY2FsZShNYXRoLnNpbihzKSk7dGhpcy5zZXQoYS54LGEueSxhLnosTWF0aC5jb3MocykpfXNldEZyb21EaXJlY3Rpb25BbmRVcHZlY3Rvcih0LGUpe2NvbnN0IHM9bmV3IGQ7cy5zZXRGcm9tRGlyZWN0aW9uQW5kVXB2ZWN0b3IodCxlKSx0aGlzLnNldEZyb21NYXQzKHMpfXNldEZyb20yVmVjdG9ycyh0LGUpe3Qubm9ybWFsaXplKCksZS5ub3JtYWxpemUoKTtjb25zdCBzPXQuY3Jvc3MoZSksYT10LmRvdChlKSxpPU1hdGguc3FydCgyKigxK2EpKTt0aGlzLnNldChzLngvaSxzLnkvaSxzLnovaSxpLzIpLHRoaXMubm9ybWFsaXplSW5QbGFjZSgpfXNldEZyb21NYXQzKHQpe2NvbnN0IGU9dC5fX2RhdGFbMF0rdC5fX2RhdGFbNF0rdC5fX2RhdGFbOF07bGV0IHM7aWYoZT4wKXM9TWF0aC5zcXJ0KGUrMSksdGhpcy5fX2RhdGFbM109LjUqcyxzPS41L3MsdGhpcy5fX2RhdGFbMF09KHQuX19kYXRhWzVdLXQuX19kYXRhWzddKSpzLHRoaXMuX19kYXRhWzFdPSh0Ll9fZGF0YVs2XS10Ll9fZGF0YVsyXSkqcyx0aGlzLl9fZGF0YVsyXT0odC5fX2RhdGFbMV0tdC5fX2RhdGFbM10pKnM7ZWxzZXtsZXQgZT0wO3QuX19kYXRhWzRdPnQuX19kYXRhWzBdJiYoZT0xKSx0Ll9fZGF0YVs4XT50Ll9fZGF0YVszKmUrZV0mJihlPTIpO2NvbnN0IGE9KGUrMSklMyxpPShlKzIpJTM7cz1NYXRoLnNxcnQodC5fX2RhdGFbMyplK2VdLXQuX19kYXRhWzMqYSthXS10Ll9fZGF0YVszKmkraV0rMSksdGhpcy5fX2RhdGFbZV09LjUqcyxzPS41L3MsdGhpcy5fX2RhdGFbM109KHQuX19kYXRhWzMqYStpXS10Ll9fZGF0YVszKmkrYV0pKnMsdGhpcy5fX2RhdGFbYV09KHQuX19kYXRhWzMqYStlXSt0Ll9fZGF0YVszKmUrYV0pKnMsdGhpcy5fX2RhdGFbaV09KHQuX19kYXRhWzMqaStlXSt0Ll9fZGF0YVszKmUraV0pKnN9dGhpcy5ub3JtYWxpemVJblBsYWNlKCl9c2V0RnJvbU1hdDQodCl7Y29uc3QgZT10Ll9fZGF0YVswXSt0Ll9fZGF0YVs1XSt0Ll9fZGF0YVsxMF07bGV0IHM7aWYoZT4wKXM9TWF0aC5zcXJ0KGUrMSksdGhpcy5fX2RhdGFbM109LjUqcyxzPS41L3MsdGhpcy5fX2RhdGFbMF09KHQuX19kYXRhWzZdLXQuX19kYXRhWzldKSpzLHRoaXMuX19kYXRhWzFdPSh0Ll9fZGF0YVs4XS10Ll9fZGF0YVsyXSkqcyx0aGlzLl9fZGF0YVsyXT0odC5fX2RhdGFbMV0tdC5fX2RhdGFbNF0pKnM7ZWxzZXtsZXQgZT0wO3QuX19kYXRhWzVdPnQuX19kYXRhWzBdJiYoZT0xKSx0Ll9fZGF0YVsxMF0+dC5fX2RhdGFbNCplK2VdJiYoZT0yKTtjb25zdCBhPShlKzEpJTMsaT0oZSsyKSUzO3M9TWF0aC5zcXJ0KHQuX19kYXRhWzQqZStlXS10Ll9fZGF0YVs0KmErYV0tdC5fX2RhdGFbNCppK2ldKzEpLHRoaXMuX19kYXRhW2VdPS41KnMscz0uNS9zLHRoaXMuX19kYXRhWzNdPSh0Ll9fZGF0YVs0KmEraV0tdC5fX2RhdGFbNCppK2FdKSpzLHRoaXMuX19kYXRhW2FdPSh0Ll9fZGF0YVs0KmErZV0rdC5fX2RhdGFbNCplK2FdKSpzLHRoaXMuX19kYXRhW2ldPSh0Ll9fZGF0YVs0KmkrZV0rdC5fX2RhdGFbNCplK2ldKSpzfXRoaXMubm9ybWFsaXplSW5QbGFjZSgpfWlzSWRlbnRpdHkoKXtyZXR1cm4gdGhpcy5nZXRBbmdsZSgpPE51bWJlci5FUFNJTE9OfWdldEFuZ2xlKCl7cmV0dXJuIDIqTWF0aC5hY29zKHRoaXMudyl9ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueSYmdGhpcy56PT10LnomJnRoaXMudz09dC53fW5vdGVxdWFscyh0KXtyZXR1cm4gdGhpcy54IT10LngmJnRoaXMueSE9dC55JiZ0aGlzLnohPXQueiYmdGhpcy53IT10Lnd9YXBwcm94RXF1YWwodCxlPU51bWJlci5FUFNJTE9OKXtyZXR1cm4gTWF0aC5hYnModGhpcy54LXQueCk8ZSYmTWF0aC5hYnModGhpcy55LXQueSk8ZSYmTWF0aC5hYnModGhpcy56LXQueik8ZSYmTWF0aC5hYnModGhpcy53LXQudyk8ZX1hZGQodCl7cmV0dXJuIG5ldyB1KHRoaXMueCt0LngsdGhpcy55K3QueSx0aGlzLnordC56LHRoaXMudyt0LncpfWFkZEluUGxhY2UodCl7dGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpcy56Kz10LnosdGhpcy53Kz10Lnd9c3VidHJhY3QodCl7cmV0dXJuIG5ldyB1KHRoaXMueC10LngsdGhpcy55LXQueSx0aGlzLnotdC56LHRoaXMudy10LncpfXNjYWxlKHQpe3JldHVybiBuZXcgdSh0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCx0aGlzLncqdCl9c2NhbGVJblBsYWNlKHQpe3RoaXMueCo9dCx0aGlzLnkqPXQsdGhpcy56Kj10LHRoaXMudyo9dH1sZW5ndGgoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdO3JldHVybiBNYXRoLnNxcnQodCp0K2UqZStzKnMrYSphKX1sZW5ndGhTcXVhcmVkKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdLHM9dGhpcy5fX2RhdGFbMl0sYT10aGlzLl9fZGF0YVszXTtyZXR1cm4gdCp0K2UqZStzKnMrYSphfW5vcm1hbGl6ZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM107bGV0IGk9dCp0K2UqZStzKnMrYSphO3JldHVybiBpPE51bWJlci5FUFNJTE9OP25ldyB1OihpPTEvTWF0aC5zcXJ0KGkpLG5ldyB1KHQqaSxlKmkscyppKSl9bm9ybWFsaXplSW5QbGFjZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM107bGV0IGk9dCp0K2UqZStzKnMrYSphO2k8TnVtYmVyLkVQU0lMT058fChpPTEvTWF0aC5zcXJ0KGkpLHRoaXMuc2V0KHQqaSxlKmkscyppLGEqaSkpfWRvdCh0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55K3RoaXMueip0LnordGhpcy53KnQud31jcm9zcyh0KXtjb25zdCBlPXRoaXMueCxzPXRoaXMueSxhPXRoaXMueixpPXRoaXMudyxyPXQueCxuPXQueSxoPXQueixvPXQudztyZXR1cm4gbmV3IHUocypoLWEqbixhKm8taSpoLGkqci1lKm8sZSpuLXMqcil9Y29uanVnYXRlKCl7cmV0dXJuIG5ldyB1KC10aGlzLngsLXRoaXMueSwtdGhpcy56LHRoaXMudyl9aW52ZXJzZSgpe3JldHVybiB0aGlzLmNvbmp1Z2F0ZSgpfWFsaWduV2l0aCh0KXt0aGlzLmRvdCh0KTwwJiZ0aGlzLnNldCgtdGhpcy54LC10aGlzLnksLXRoaXMueiwtdGhpcy53KX1tdWx0aXBseSh0KXtjb25zdCBlPXRoaXMuX19kYXRhWzBdLHM9dGhpcy5fX2RhdGFbMV0sYT10aGlzLl9fZGF0YVsyXSxpPXRoaXMuX19kYXRhWzNdLHI9dC5fX2RhdGFbMF0sbj10Ll9fZGF0YVsxXSxoPXQuX19kYXRhWzJdLG89dC5fX2RhdGFbM107cmV0dXJuIG5ldyB1KGUqbytpKnIrcypoLWEqbixzKm8raSpuK2Eqci1lKmgsYSpvK2kqaCtlKm4tcypyLGkqby1lKnItcypuLWEqaCl9bXVsdGlwbHlJblBsYWNlKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0scz10aGlzLl9fZGF0YVsxXSxhPXRoaXMuX19kYXRhWzJdLGk9dGhpcy5fX2RhdGFbM10scj10Ll9fZGF0YVswXSxuPXQuX19kYXRhWzFdLGg9dC5fX2RhdGFbMl0sbz10Ll9fZGF0YVszXTt0aGlzLnNldChlKm8raSpyK3MqaC1hKm4scypvK2kqbithKnItZSpoLGEqbytpKmgrZSpuLXMqcixpKm8tZSpyLXMqbi1hKmgpfXJvdGF0ZVZlYzModCl7Y29uc3QgZT1uZXcgdSh0LngsdC55LHQueiwwKSxzPXRoaXMubXVsdGlwbHkoZSkubXVsdGlwbHkodGhpcy5jb25qdWdhdGUoKSk7cmV0dXJuIG5ldyByKHMueCxzLnkscy56KX1yb3RhdGVYKHQpe3QqPS41O2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dGhpcy53LHI9TWF0aC5zaW4odCksbj1NYXRoLmNvcyh0KTt0aGlzLng9ZSpuK2kqcix0aGlzLnk9cypuK2Eqcix0aGlzLno9YSpuLXMqcix0aGlzLnc9aSpuLWUqcn1yb3RhdGVZKHQpe3QqPS41O2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dGhpcy53LHI9TWF0aC5zaW4odCksbj1NYXRoLmNvcyh0KTt0aGlzLng9ZSpuLWEqcix0aGlzLnk9cypuK2kqcix0aGlzLno9YSpuK2Uqcix0aGlzLnc9aSpuLXMqcn1yb3RhdGVaKHQpe3QqPS41O2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dGhpcy53LHI9TWF0aC5zaW4odCksbj1NYXRoLmNvcyh0KTt0aGlzLng9ZSpuK3Mqcix0aGlzLnk9cypuLWUqcix0aGlzLno9YSpuK2kqcix0aGlzLnc9aSpuLWEqcn10b01hdDMoKXtjb25zdCB0PXRoaXMueCxlPXRoaXMueSxzPXRoaXMueixhPXRoaXMudyxpPXQrdCxyPWUrZSxuPXMrcyxoPXQqaSxvPWUqaSxfPWUqcixsPXMqaSxjPXMqcix1PXMqbixmPWEqaSxtPWEqcixnPWEqbix5PW5ldyBkO3JldHVybiB5Ll9fZGF0YVswXT0xLV8tdSx5Ll9fZGF0YVszXT1vLWcseS5fX2RhdGFbNl09bCttLHkuX19kYXRhWzFdPW8rZyx5Ll9fZGF0YVs0XT0xLWgtdSx5Ll9fZGF0YVs3XT1jLWYseS5fX2RhdGFbMl09bC1tLHkuX19kYXRhWzVdPWMrZix5Ll9fZGF0YVs4XT0xLWgtXyx5fWdldFhheGlzKCl7Y29uc3QgdD10aGlzLngqdGhpcy55LGU9dGhpcy54KnRoaXMueixzPXRoaXMueSp0aGlzLnksYT10aGlzLnkqdGhpcy53LGk9dGhpcy56KnRoaXMueixuPXRoaXMueip0aGlzLnc7cmV0dXJuIG5ldyByKDEtMiooaStzKSwyKih0K24pLDIqKGUtYSkpfWdldFlheGlzKCl7Y29uc3QgdD10aGlzLngqdGhpcy54LGU9dGhpcy54KnRoaXMueSxzPXRoaXMueCp0aGlzLncsYT10aGlzLnkqdGhpcy56LGk9dGhpcy56KnRoaXMueixuPXRoaXMueip0aGlzLnc7cmV0dXJuIG5ldyByKDIqKGUtbiksMS0yKihpK3QpLDIqKGErcykpfWdldFpheGlzKCl7Y29uc3QgdD10aGlzLngqdGhpcy54LGU9dGhpcy54KnRoaXMueixzPXRoaXMueCp0aGlzLncsYT10aGlzLnkqdGhpcy55LGk9dGhpcy55KnRoaXMueixuPXRoaXMueSp0aGlzLnc7bmV3IHI7cmV0dXJuIG5ldyByKDIqKG4rZSksMiooaS1zKSwxLTIqKGErdCkpfW1pcnJvcih0KXtzd2l0Y2godCl7Y2FzZSAwOnJldHVybiBuZXcgdSh0aGlzLnosdGhpcy53LHRoaXMueCx0aGlzLnkpO2Nhc2UgMTpyZXR1cm4gbmV3IHUoLXRoaXMudyx0aGlzLnosdGhpcy55LC10aGlzLngpO2Nhc2UgMjpyZXR1cm4gbmV3IHUodGhpcy54LHRoaXMueSx0aGlzLnosLXRoaXMudyl9fXRvTWF0NCgpe2NvbnN0IHQ9dGhpcy54LGU9dGhpcy55LHM9dGhpcy56LGE9dGhpcy53LGk9dCt0LHI9ZStlLG49cytzLGg9dCppLG89ZSppLF89ZSpyLGQ9cyppLGM9cypyLHU9cypuLGY9YSppLG09YSpyLGc9YSpuLHk9bmV3IGw7cmV0dXJuIHkuX19kYXRhWzBdPTEtXy11LHkuX19kYXRhWzRdPW8tZyx5Ll9fZGF0YVs4XT1kK20seS5fX2RhdGFbMV09bytnLHkuX19kYXRhWzVdPTEtaC11LHkuX19kYXRhWzldPWMtZix5Ll9fZGF0YVsyXT1kLW0seS5fX2RhdGFbNl09YytmLHkuX19kYXRhWzEwXT0xLWgtXyx5fWxlcnAodCxlKXtjb25zdCBzPW5ldyB1KHRoaXMueCtlKih0LngtdGhpcy54KSx0aGlzLnkrZSoodC55LXRoaXMueSksdGhpcy56K2UqKHQuei10aGlzLnopLHRoaXMudytlKih0LnctdGhpcy53KSk7cmV0dXJuIHMubm9ybWFsaXplSW5QbGFjZSgpLHN9c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IHUoLi4udCl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IHUodCw0KmUpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiA0fWNsb25lKCl7cmV0dXJuIG5ldyB1KHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzNdKX10b0pTT04oKXtyZXR1cm57eDp0aGlzLngseTp0aGlzLnksejp0aGlzLnosdzp0aGlzLnd9fWZyb21KU09OKHQpe3RoaXMuX19kYXRhWzBdPXQueCx0aGlzLl9fZGF0YVsxXT10LnksdGhpcy5fX2RhdGFbMl09dC56LHRoaXMuX19kYXRhWzNdPXQudyx0aGlzLm5vcm1hbGl6ZUluUGxhY2UoKX19YS5yZWdpc3RlclR5cGUoIlF1YXQiLHUpO2NsYXNzIGZ7Y29uc3RydWN0b3IodCxlKXt0aGlzLnN0YXJ0PXQgaW5zdGFuY2VvZiByP3Q6bmV3IHIsdGhpcy5kaXI9ZSBpbnN0YW5jZW9mIHI/ZTpuZXcgcn1jbG9zZXN0UG9pbnQodCl7Y29uc3QgZT10LnN1YnRyYWN0KHRoaXMuc3RhcnQpLmRvdCh0aGlzLmRpcik7aWYoZTxOdW1iZXIuRVBTSUxPTilyZXR1cm4gdGhpcy5zdGFydDtjb25zdCBzPWUvdGhpcy5kaXIuZG90KHRoaXMuZGlyKTtyZXR1cm4gdGhpcy5zdGFydC5hZGQodGhpcy5kaXIuc2NhbGUocykpfXBvaW50QXREaXN0KHQpe3JldHVybiB0aGlzLnN0YXJ0LmFkZCh0aGlzLmRpci5zY2FsZSh0KSl9aW50ZXJzZWN0UmF5VmVjdG9yKHQpe2NvbnN0IGU9dGhpcy5kaXIscz10LmRpcixhPXRoaXMuc3RhcnQuc3VidHJhY3QodC5zdGFydCksaT1lLmRvdChlKSxyPWUuZG90KHMpLG49cy5kb3QocyksaD1lLmRvdChhKSxvPXMuZG90KGEpO2lmKDA9PWkmJjA9PW4pcmV0dXJuIHRoaXMuc3RhcnQuZGlzdGFuY2VUbyh0LnN0YXJ0KTtpZigwPT1pKXJldHVybiB0LmNsb3Nlc3RQb2ludCh0aGlzLnN0YXJ0KTtpZigwPT1uKXJldHVybiB0aGlzLmNsb3Nlc3RQb2ludCh0LnN0YXJ0KTtjb25zdCBfPWkqbi1yKnI7bGV0IGQsbDtyZXR1cm4gXzwuMDAxPyhkPTAsbD1yPm4/aC9yOm8vbik6KGQ9KHIqby1uKmgpL18sbD0oaSpvLXIqaCkvXyksW2QsbF19aW50ZXJzZWN0UmF5UGxhbmUodCl7Y29uc3QgZT10aGlzLnN0YXJ0LnN1YnRyYWN0KHQuc3RhcnQpLHM9dC5kaXIuZG90KHRoaXMuZGlyKSxhPS10LmRpci5kb3QoZSk7aWYoTWF0aC5hYnMocyk8TnVtYmVyLlBSRUNJU0lPTilyZXR1cm4tMTtjb25zdCBpPWEvcztyZXR1cm4gaTwtTnVtYmVyLlBSRUNJU0lPTj8tMTppfWNsb25lKCl7cmV0dXJuIG5ldyBmKHRoaXMuc3RhcnQuY2xvbmUoKSx0aGlzLmRpci5jbG9uZSgpKX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgZiguLi50KX10b0pTT04oKXtyZXR1cm57c3RhcnQ6dGhpcy5zdGFydCxkaXI6dGhpcy5kaXJ9fWZyb21KU09OKHQpe3RoaXMuc3RhcnQuZnJvbUpTT04odC5zdGFydCksdGhpcy5kaXIuZnJvbUpTT04odC5kaXIpfXRvU3RyaW5nKCl7cmV0dXJuIGUodGhpcy50b0pTT04oKSl9fWEucmVnaXN0ZXJUeXBlKCJSYXkiLGYpO25ldyByKDEsMSwxKTtjbGFzcyBte2NvbnN0cnVjdG9yKHQsZSxzKXtpZih0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXRoaXMuc2V0RnJvbUZsb2F0MzJBcnJheSh0KTtlbHNle2lmKHQgaW5zdGFuY2VvZiByKXRoaXMudHI9dDtlbHNle2lmKHQgaW5zdGFuY2VvZiB1JiZudWxsPT1lJiZudWxsPT1zKXJldHVybiB0aGlzLnRyPW5ldyByLHRoaXMub3JpPXQsdm9pZCh0aGlzLnNjPW5ldyByKDEsMSwxKSk7dGhpcy50cj1uZXcgcn10aGlzLm9yaT1lIGluc3RhbmNlb2YgdT9lOm5ldyB1LHRoaXMuc2M9cyBpbnN0YW5jZW9mIHI/czpuZXcgcigxLDEsMSl9fXNldCh0LGUscyl7dGhpcy50cj10LHRoaXMub3JpPWUscyBpbnN0YW5jZW9mIHImJih0aGlzLnNjPXMpfXNldEZyb21PdGhlcih0KXt0aGlzLnRyPXQudHIsdGhpcy5vcmk9dC5vcmksdGhpcy5zYz10LnNjfWlzSWRlbnRpdHkoKXtyZXR1cm4gdGhpcy50ci5pc051bGwoKSYmdGhpcy5vcmkuaXNJZGVudGl0eSgpJiZ0aGlzLnNjLmlzMTExKCl9c2V0TG9va0F0KHQsZSxzKXtjb25zdCBhPXQuc3VidHJhY3QoZSk7aWYoYS5sZW5ndGgoKTxOdW1iZXIuRVBTSUxPTil0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgZGlyIik7dGhpcy5vcmkuc2V0RnJvbURpcmVjdGlvbkFuZFVwdmVjdG9yKGEscyksdGhpcy50cj10fW11bHRpcGx5KHQpe2xldCBlPXRoaXMuc2M7dGhpcy5zYy54PT10aGlzLnNjLnkmJnRoaXMuc2MueD09dGhpcy5zYy56fHwoZT10Lm9yaS5yb3RhdGVWZWMzKHRoaXMuc2MpLE1hdGguc2lnbihlLngpIT1NYXRoLnNpZ24odGhpcy5zYy54KSYmKGUueD0tZS54KSxNYXRoLnNpZ24oZS55KSE9TWF0aC5zaWduKHRoaXMuc2MueSkmJihlLnk9LWUueSksTWF0aC5zaWduKGUueikhPU1hdGguc2lnbih0aGlzLnNjLnopJiYoZS56PS1lLnopKTtyZXR1cm4gbmV3IG0odGhpcy50ci5hZGQodGhpcy5vcmkucm90YXRlVmVjMyhlLm11bHRpcGx5KHQudHIpKSksdGhpcy5vcmkubXVsdGlwbHkodC5vcmkpLGUubXVsdGlwbHkodC5zYykpfWludmVyc2UoKXtjb25zdCB0PW5ldyBtO3JldHVybiB0Lm9yaT10aGlzLm9yaS5pbnZlcnNlKCksdGhpcy5zYy54IT10aGlzLnNjLnl8fHRoaXMuc2MueCE9dGhpcy5zYy56Pyh0LnNjPXQub3JpLnJvdGF0ZVZlYzModGhpcy5zYyksTWF0aC5zaWduKHQuc2MueCkhPU1hdGguc2lnbih0aGlzLnNjLngpJiYodC5zYy54PS10LnNjLngpLE1hdGguc2lnbih0LnNjLnkpIT1NYXRoLnNpZ24odGhpcy5zYy55KSYmKHQuc2MueT0tdC5zYy55KSxNYXRoLnNpZ24odC5zYy56KSE9TWF0aC5zaWduKHRoaXMuc2MueikmJih0LnNjLno9LXQuc2MueikpOnQuc2M9dGhpcy5zYy5pbnZlcnNlKCksdC50cj10Lm9yaS5yb3RhdGVWZWMzKHRoaXMudHIubmVnYXRlKCkubXVsdGlwbHkodC5zYykpLHR9dHJhbnNmb3JtVmVjMyh0KXtyZXR1cm4gdGhpcy50ci5hZGQodGhpcy5vcmkucm90YXRlVmVjMyh0aGlzLnNjLm11bHRpcGx5KHQpKSl9dG9NYXQ0KCl7Y29uc3QgdD1uZXcgbCh0aGlzLnNjLngsMCwwLDAsMCx0aGlzLnNjLnksMCwwLDAsMCx0aGlzLnNjLnosMCwwLDAsMCwxKSxlPXRoaXMub3JpLnRvTWF0NCgpLHM9bmV3IGw7cmV0dXJuIHMudHJhbnNsYXRpb249dGhpcy50cixzLm11bHRpcGx5KGUpLm11bHRpcGx5KHQpfWZyb21NYXQ0KHQpe3RoaXMudHI9dC50cmFuc2xhdGlvbix0aGlzLm9yaS5zZXRGcm9tTWF0NCh0KX1zZXRGcm9tRmxvYXQzMkFycmF5KHQpe2lmKDc9PXQubGVuZ3RoKXJldHVybiB0aGlzLnRyPW5ldyByKHQuYnVmZmVyLHQuYnl0ZU9mZnNldCksdGhpcy5vcmk9bmV3IHUodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzEyKSx2b2lkKHRoaXMuc2M9bmV3IHIoMSwxLDEpKTtpZig4IT10Lmxlbmd0aClyZXR1cm4gMTA9PXQubGVuZ3RoPyh0aGlzLnRyPW5ldyByKHQuYnVmZmVyLHQuYnl0ZU9mZnNldCksdGhpcy5vcmk9bmV3IHUodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzEyKSx2b2lkKHRoaXMuc2M9bmV3IHIodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzIxKSkpOnZvaWQgMDt7dGhpcy50cj1uZXcgcih0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQpLHRoaXMub3JpPW5ldyB1KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCsxMik7Y29uc3QgZT10WzddO3RoaXMuc2M9bmV3IHIoZSxlLGUpfX1jbG9uZSgpe3JldHVybiBuZXcgbSh0aGlzLnRyLmNsb25lKCksdGhpcy5vcmkuY2xvbmUoKSx0aGlzLnNjLmNsb25lKCkpfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBtKC4uLnQpfXRvSlNPTigpe2NvbnN0IHQ9e3RyOnRoaXMudHIudG9KU09OKCksb3JpOnRoaXMub3JpLnRvSlNPTigpfTtyZXR1cm4gdGhpcy5zYy5pczExMSgpfHwodC5zYz10aGlzLnNjLnRvSlNPTigpKSx0fWZyb21KU09OKHQpe3RoaXMudHIuZnJvbUpTT04odC50ciksdGhpcy5vcmkuZnJvbUpTT04odC5vcmkpLHQuc2MmJnRoaXMuc2MuZnJvbUpTT04odC5zYyl9dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX19YS5yZWdpc3RlclR5cGUoIlhmbyIsbSk7Y2xhc3MgZ3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMucDA9dCBpbnN0YW5jZW9mIGk/dDpuZXcgaShOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSx0aGlzLnAxPWUgaW5zdGFuY2VvZiBpP2U6bmV3IGkoTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLE51bWJlci5ORUdBVElWRV9JTkZJTklUWSl9c2V0KHQsZSl7dGhpcy5wMD10LHRoaXMucDE9ZX1yZXNldCgpe3RoaXMucDAueD1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksdGhpcy5wMS54PU51bWJlci5ORUdBVElWRV9JTkZJTklUWSx0aGlzLnAwLnk9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLHRoaXMucDEueT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFl9aXNWYWxpZCgpe3JldHVybiB0aGlzLnAwLnghPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdGhpcy5wMS54IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJnRoaXMucDAueSE9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZJiZ0aGlzLnAxLnkhPU51bWJlci5ORUdBVElWRV9JTkZJTklUWX1hZGRQb2ludCh0KXsodGhpcy5wMC54PT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl8fHQueDx0aGlzLnAwLngpJiYodGhpcy5wMC54PXQueCksKHRoaXMucDAueT09TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfHx0Lnk8dGhpcy5wMC55KSYmKHRoaXMucDAueT10LnkpLCh0aGlzLnAxLnk9PU51bWJlci5ORUdBVElWRV9JTkZJTklUWXx8dC54PnRoaXMucDEueCkmJih0aGlzLnAxLng9dC54KSwodGhpcy5wMS55PT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFl8fHQueT50aGlzLnAxLnkpJiYodGhpcy5wMS55PXQueSl9c2l6ZSgpe3JldHVybiB0aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApfWRpYWdvbmFsKCl7cmV0dXJuIHRoaXMucDEuc3VidHJhY3QodGhpcy5wMCl9Y2VudGVyKCl7Y29uc3QgdD10aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApO3JldHVybiB0LnNjYWxlSW5QbGFjZSguNSksdC5hZGRJblBsYWNlKHRoaXMucDApLHR9c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IGcoLi4udCl9dG9KU09OKCl7cmV0dXJue3AwOnRoaXMucDAudG9KU09OKCkscDE6dGhpcy5wMS50b0pTT04oKX19dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX19YS5yZWdpc3RlclR5cGUoIkJveDIiLGcpO2NsYXNzIHkgZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQsZT0wKXtzdXBlcigpLHRoaXMucG9zPXQgaW5zdGFuY2VvZiByP3Q6bmV3IHIsdGhpcy5yYWRpdXM9ZX1jbG9uZSgpe3JldHVybiBuZXcgU3BoZXJlKHRoaXMucG9zLmNsb25lKCksdGhpcy5yYWRpdXMpfWludGVyc2VjdHNCb3godCl7cmV0dXJuIHQuaW50ZXJzZWN0c1NwaGVyZSh0aGlzKX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgU3BoZXJlKC4uLnQpfXRvSlNPTigpe3JldHVybntwb3M6dGhpcy5wb3MudG9KU09OKCkscmFkaXVzOnRoaXMucmFkaXVzfX10b1N0cmluZygpe3JldHVybiBlKHRoaXMudG9KU09OKCkpfX1hLnJlZ2lzdGVyVHlwZSgiU3BoZXJlVHlwZSIseSk7Y2xhc3MgcHtjb25zdHJ1Y3Rvcih0LGUpe3QgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/dGhpcy5zZXRGcm9tRmxvYXQzMkFycmF5KHQpOih0aGlzLnAwPXQgaW5zdGFuY2VvZiByP3Q6bmV3IHIoTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLE51bWJlci5QT1NJVElWRV9JTkZJTklUWSxOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpLHRoaXMucDE9ZSBpbnN0YW5jZW9mIHI/ZTpuZXcgcihOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLE51bWJlci5ORUdBVElWRV9JTkZJTklUWSkpfWdldCBtaW4oKXtyZXR1cm4gdGhpcy5wMH1nZXQgbWF4KCl7cmV0dXJuIHRoaXMucDF9c2V0KHQsZSl7dGhpcy5wMD10LHRoaXMucDE9ZX1yZXNldCgpe3RoaXMucDAueD1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksdGhpcy5wMS54PU51bWJlci5ORUdBVElWRV9JTkZJTklUWSx0aGlzLnAwLnk9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLHRoaXMucDEueT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksdGhpcy5wMC56PU51bWJlci5QT1NJVElWRV9JTkZJTklUWSx0aGlzLnAxLno9TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZfWlzVmFsaWQoKXtyZXR1cm4gdGhpcy5wMC54IT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkmJnRoaXMucDEueCE9TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZJiZ0aGlzLnAwLnkhPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdGhpcy5wMS55IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJnRoaXMucDAueiE9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZJiZ0aGlzLnAxLnohPU51bWJlci5ORUdBVElWRV9JTkZJTklUWX1hZGRQb2ludCh0KXt0LnghPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdC54IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJih0Lng8dGhpcy5wMC54JiYodGhpcy5wMC54PXQueCksdC54PnRoaXMucDEueCYmKHRoaXMucDEueD10LngpKSx0LnkhPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdC55IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJih0Lnk8dGhpcy5wMC55JiYodGhpcy5wMC55PXQueSksdC55PnRoaXMucDEueSYmKHRoaXMucDEueT10LnkpKSx0LnohPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdC56IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJih0Lno8dGhpcy5wMC56JiYodGhpcy5wMC56PXQueiksdC56PnRoaXMucDEueiYmKHRoaXMucDEuej10LnopKX1hZGRCb3gzKHQsZSl7ZT8odGhpcy5hZGRQb2ludChlLnRyYW5zZm9ybVZlYzModC5wMCkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDAueCx0LnAwLnksdC5wMS56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDAueCx0LnAxLnksdC5wMC56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDEueCx0LnAwLnksdC5wMC56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDAueCx0LnAxLnksdC5wMS56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDEueCx0LnAwLnksdC5wMS56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDEueCx0LnAxLnksdC5wMC56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKHQucDEpKSk6KHRoaXMuYWRkUG9pbnQodC5wMCksdGhpcy5hZGRQb2ludCh0LnAxKSl9c2l6ZSgpe3JldHVybiB0aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApfWRpYWdvbmFsKCl7cmV0dXJuIHRoaXMucDEuc3VidHJhY3QodGhpcy5wMCl9Y2VudGVyKCl7Y29uc3QgdD10aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApO3JldHVybiB0LnNjYWxlSW5QbGFjZSguNSksdC5hZGRJblBsYWNlKHRoaXMucDApLHR9dG9NYXQ0KCl7Y29uc3QgdD10aGlzLnAxLngtdGhpcy5wMC54LGU9dGhpcy5wMS55LXRoaXMucDAueSxzPXRoaXMucDEuei10aGlzLnAwLno7cmV0dXJuIG5ldyBsKHQsMCwwLDAsMCxlLDAsMCwwLDAscywwLHRoaXMucDAueCx0aGlzLnAwLnksdGhpcy5wMC56LDEpfWdldEJvdW5kaW5nU3BoZXJlKCl7cmV0dXJuIG5ldyB5KHRoaXMuY2VudGVyKCksLjUqdGhpcy5kaWFnb25hbCgpLmxlbmd0aCgpKX1pbnRlcnNlY3RzQm94KHQpe3JldHVybiEodC5tYXgueDx0aGlzLm1pbi54fHx0Lm1pbi54PnRoaXMubWF4Lnh8fHQubWF4Lnk8dGhpcy5taW4ueXx8dC5taW4ueT50aGlzLm1heC55fHx0Lm1heC56PHRoaXMubWluLnp8fHQubWluLno+dGhpcy5tYXgueil9aW50ZXJzZWN0c1NwaGVyZSh0KXtyZXR1cm4gY2xvc2VzdFBvaW50LmRpc3RhbmNlVG9TcXVhcmVkKHQuY2VudGVyKTw9dC5yYWRpdXMqdC5yYWRpdXN9aW50ZXJzZWN0c1BsYW5lKHQpe2xldCBlLHM7cmV0dXJuIHQubm9ybWFsLng+MD8oZT10Lm5vcm1hbC54KnRoaXMubWluLngscz10Lm5vcm1hbC54KnRoaXMubWF4LngpOihlPXQubm9ybWFsLngqdGhpcy5tYXgueCxzPXQubm9ybWFsLngqdGhpcy5taW4ueCksdC5ub3JtYWwueT4wPyhlKz10Lm5vcm1hbC55KnRoaXMubWluLnkscys9dC5ub3JtYWwueSp0aGlzLm1heC55KTooZSs9dC5ub3JtYWwueSp0aGlzLm1heC55LHMrPXQubm9ybWFsLnkqdGhpcy5taW4ueSksdC5ub3JtYWwuej4wPyhlKz10Lm5vcm1hbC56KnRoaXMubWluLnoscys9dC5ub3JtYWwueip0aGlzLm1heC56KTooZSs9dC5ub3JtYWwueip0aGlzLm1heC56LHMrPXQubm9ybWFsLnoqdGhpcy5taW4ueiksZTw9LXQuY29uc3RhbnQmJnM+PS10LmNvbnN0YW50fWNsb25lKCl7cmV0dXJuIG5ldyBwKHRoaXMucDAuY2xvbmUoKSx0aGlzLnAxLmNsb25lKCkpfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBwKC4uLnQpfXN0YXRpYyBzaXplSW5CeXRlcygpe3JldHVybiAyNH10b0pTT04oKXtyZXR1cm57cDA6dGhpcy5wMC50b0pTT04oKSxwMTp0aGlzLnAxLnRvSlNPTigpfX1mcm9tSlNPTih0KXt0aGlzLnAwLmZyb21KU09OKHQucDApLHRoaXMucDEuZnJvbUpTT04odC5wMSl9bG9hZEJpbih0LGUpe3RoaXMucDAubG9hZEJpbih0LGUpLHRoaXMucDAubG9hZEJpbih0LGUrMTIpfXNldEZyb21GbG9hdDMyQXJyYXkodCl7dGhpcy5wMD1uZXcgcih0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQpLHRoaXMucDE9bmV3IHIodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzEyKX10b1N0cmluZygpe3JldHVybiBlKHRoaXMudG9KU09OKCkpfX1hLnJlZ2lzdGVyVHlwZSgiQm94MyIscCk7Y2xhc3MgeCBleHRlbmRzIHN7Y29uc3RydWN0b3IodCxlPTApe3N1cGVyKCksdGhpcy5ub3JtYWw9dCBpbnN0YW5jZW9mIHI/dDpuZXcgcix0aGlzLnc9ZX1zZXQodCxlLHMsYSl7dGhpcy5ub3JtYWwuc2V0KHQsZSxzKSx0aGlzLnc9YX1kaXZpZGVTY2FsYXIodCl7dGhpcy5ub3JtYWwuc2NhbGVJblBsYWNlKDEvdCksdGhpcy53Lz10fWRpc3RhbmNlVG9Qb2ludCh0KXtyZXR1cm4gdC5kb3QodGhpcy5ub3JtYWwpK3RoaXMud31ub3JtYWxpemVJblBsYWNlKCl7Y29uc3QgdD0xL3RoaXMubm9ybWFsLmxlbmd0aCgpO3RoaXMubm9ybWFsLnNjYWxlSW5QbGFjZSh0KSx0aGlzLncqPXR9Y2xvbmUoKXtyZXR1cm4gbmV3IFBsYW5lKHRoaXMubm9ybWFsLmNsb25lKCksdGhpcy53KX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgUGxhbmUoLi4udCl9dG9KU09OKCl7cmV0dXJue25vcm1hbDp0aGlzLm5vcm1hbC50b0pTT04oKSx3OnRoaXMud319dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX19YS5yZWdpc3RlclR5cGUoIlBsYW5lVHlwZSIseCk7YS5yZWdpc3RlclR5cGUoIkZydXN0dW0iLGNsYXNze2NvbnN0cnVjdG9yKHQsZSxzLGEsaSxyKXt0aGlzLnBsYW5lcz1bdHx8bmV3IHgsZXx8bmV3IHgsc3x8bmV3IHgsYXx8bmV3IHgsaXx8bmV3IHgscnx8bmV3IHhdfXNldEZyb21NYXRyaXgodCl7Y29uc3QgZT10LHM9dGhpcy5wbGFuZXM7c1swXS5zZXQoZS5tMDMtZS5tMDAsZS5tMTMtZS5tMTAsZS5tMjMtZS5tMjAsZS5tMzMtZS5tMzApLHNbMV0uc2V0KGUubTAzK2UubTAwLGUubTEzK2UubTEwLGUubTIzK2UubTIwLGUubTMzK2UubTMwKSxzWzJdLnNldChlLm0wMytlLm0wMSxlLm0xMytlLm0xMSxlLm0yMytlLm0yMSxlLm0zMytlLm0zMSksc1szXS5zZXQoZS5tMDMtZS5tMDEsZS5tMTMtZS5tMTEsZS5tMjMtZS5tMjEsZS5tMzMtZS5tMzEpLHNbNF0uc2V0KGUubTAzLWUubTAyLGUubTEzLWUubTEyLGUubTIzLWUubTIyLGUubTMzLWUubTMyKSxzWzVdLnNldChlLm0wMytlLm0wMixlLm0xMytlLm0xMixlLm0yMytlLm0yMixlLm0zMytlLm0zMikscy5mb3JFYWNoKHQ9PnQubm9ybWFsaXplSW5QbGFjZSgpKX1pbnRlcnNlY3RzQm94KHQpe2NvbnN0IGU9bmV3IHIscz10aGlzLnBsYW5lcyx7bWluOmEsbWF4Oml9PXQ7Zm9yKGxldCB0PTA7dDw2O3QrKyl7Y29uc3Qgcj1zW3RdO2lmKGUueD1yLm5vcm1hbC54PjA/aS54OmEueCxlLnk9ci5ub3JtYWwueT4wP2kueTphLnksZS56PXIubm9ybWFsLno+MD9pLno6YS56LHIuZGlzdGFuY2VUb1BvaW50KGUpPDApcmV0dXJuITF9cmV0dXJuITB9dG9KU09OKCl7cmV0dXJue3AwOnRoaXMucDAudG9KU09OKCkscDE6dGhpcy5wMS50b0pTT04oKSxwMjp0aGlzLnAyLnRvSlNPTigpLHAzOnRoaXMucDMudG9KU09OKCkscDQ6dGhpcy5wNC50b0pTT04oKSxwNTp0aGlzLnA1LnRvSlNPTigpfX1mcm9tSlNPTih0KXt0aGlzLnAwLmZyb21KU09OKHQucDApLHRoaXMucDEuZnJvbUpTT04odC5wMSksdGhpcy5wMi5mcm9tSlNPTih0LnAyKSx0aGlzLnAzLmZyb21KU09OKHQucDMpLHRoaXMucDQuZnJvbUpTT04odC5wNCksdGhpcy5wNS5mcm9tSlNPTih0LnA1KX10b1N0cmluZygpe3JldHVybiBlKHRoaXMudG9KU09OKCkpfX0pO2NvbnN0IHc9bmV3IGNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5fX3JlZ2lzdGVyZWRDbGFzc2VzPXt9LHRoaXMuX19jbGFzc05hbWVzPXt9LHRoaXMuX19jbGFzc0xpc3Q9W119cmVnaXN0ZXJDbGFzcyh0LGUpe3RoaXMuX19yZWdpc3RlcmVkQ2xhc3Nlc1t0XT17Y2xzOmUsY2FsbGJhY2tzOltdfTtjb25zdCBzPXRoaXMuX19jbGFzc0xpc3QubGVuZ3RoO3RoaXMuX19jbGFzc0xpc3QucHVzaChlKSx0aGlzLl9fY2xhc3NOYW1lc1tzXT10fWdldENsYXNzKHQpe2lmKHRoaXMuX19yZWdpc3RlcmVkQ2xhc3Nlc1t0XSlyZXR1cm4gdGhpcy5fX3JlZ2lzdGVyZWRDbGFzc2VzW3RdLmNsc31nZXRDbGFzc05hbWUodCl7Y29uc3QgZT10aGlzLl9fY2xhc3NMaXN0LmluZGV4T2YodC5jb25zdHJ1Y3Rvcik7cmV0dXJuIHRoaXMuX19jbGFzc05hbWVzW2VdP3RoaXMuX19jbGFzc05hbWVzW2VdOihjb25zb2xlLndhcm4oIkNsYXNzIG5vdCByZWdpc3RlcmVkOiIsdC5jb25zdHJ1Y3Rvci5uYW1lKSx0LmNvbnN0cnVjdG9yLm5hbWUpfWNvbnN0cnVjdENsYXNzKHQpe2NvbnN0IGU9dGhpcy5fX3JlZ2lzdGVyZWRDbGFzc2VzW3RdO2lmKCFlKXJldHVybiBjb25zb2xlLndhcm4oIkZhY3Rvcnkgbm90IHJlZ2lzdGVyZWQ6Iit0KSxudWxsO3RoaXMuX19jb25zdHJ1Y3Rpbmc9ITA7Y29uc3Qgcz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksYT1uZXcgZS5jbHMoLi4ucyk7cmV0dXJuIHRoaXMuX19jb25zdHJ1Y3Rpbmc9ITEsYX19LEk9MyxOPTI7bGV0IEY9MDtjbGFzcyB6e2NvbnN0cnVjdG9yKHQsZSxzKXtpZih0aGlzLl9fZGF0YVR5cGU9dCx0aGlzLm5vcm1hbGl6ZWQ9ITEsbnVsbCE9dC5udW1FbGVtZW50cyl0aGlzLl9fZGltZW5zaW9uPXRoaXMuX19kYXRhVHlwZS5udW1FbGVtZW50cygpO2Vsc2Ugc3dpdGNoKHQpe2Nhc2UgNjpjYXNlIDQ6Y2FzZSA1OnRoaXMuX19kaW1lbnNpb249MTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiSW52YWxpZCBkYXRhIHR5cGUgZm9yIGF0dHJpYnV0ZToiK3QpfXZhciBhO3RoaXMuX19kZWZhdWx0RWxlbWVudFZhbHVlPW51bGwhPXM/czpOdW1iZXIuTUFYX1ZBTFVFLChhPWUpJiZ2b2lkIDAhPT1hLmJ5dGVMZW5ndGg/dGhpcy5fX2RhdGE9ZToodGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShlKnRoaXMuX19kaW1lbnNpb24pLHRoaXMuaW5pdFJhbmdlKDApKX1yZXNpemUodCl7Y29uc3QgZT10aGlzLl9fZGF0YS5sZW5ndGgscz10KnRoaXMuX19kaW1lbnNpb24sYT1uZXcgRmxvYXQzMkFycmF5KHMpO2ZvcihsZXQgdD0wO3Q8TWF0aC5taW4odGhpcy5fX2RhdGEubGVuZ3RoLHMpO3QrKylhW3RdPXRoaXMuX19kYXRhW3RdO3RoaXMuX19kYXRhLmxlbmd0aDxzJiYodGhpcy5fX2RhdGE9YSksdGhpcy5pbml0UmFuZ2UoZSl9aW5pdFJhbmdlKHQpe2ZvcihsZXQgZT10O2U8dGhpcy5fX2RhdGEubGVuZ3RoO2UrKyl0aGlzLl9fZGF0YVtlXT10aGlzLl9fZGVmYXVsdEVsZW1lbnRWYWx1ZX1nZXRDb3VudCgpe3JldHVybiB0aGlzLl9fZGF0YS5sZW5ndGgvdGhpcy5fX2RpbWVuc2lvbn1nZXQgbGVuZ3RoKCl7cmV0dXJuIHRoaXMuX19kYXRhLmxlbmd0aC90aGlzLl9fZGltZW5zaW9ufWdldCBkYXRhVHlwZSgpe3JldHVybiB0aGlzLl9fZGF0YVR5cGV9Z2V0IGRhdGEoKXtyZXR1cm4gdGhpcy5fX2RhdGF9c2V0IGRhdGEodCl7dGhpcy5fX2RhdGE9dH1nZXQgbnVtRWxlbWVudHMoKXtyZXR1cm4gdGhpcy5fX2RpbWVuc2lvbn1nZXRGbG9hdDMyVmFsdWUodCl7cmV0dXJuIHRoaXMuX19kYXRhW3RdfXNldEZsb2F0MzJWYWx1ZSh0LGUpe3RoaXMuX19kYXRhW3RdPWV9Z2V0VmFsdWVSZWYodCl7Y29uc3QgZT10aGlzLl9fZGltZW5zaW9uO2lmKHQ+PXRoaXMuX19kYXRhLmxlbmd0aC9lKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCB2ZXJ0ZXggaW5kZXg6Iit0KyIuIE51bSBWZXJ0aWNlczoiK3RoaXMuX19kYXRhLmxlbmd0aC8zKTtyZXR1cm4gdGhpcy5fX2RhdGFUeXBlLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlcix0KmUpfXNldFZhbHVlKHQsZSl7Y29uc3Qgcz10aGlzLl9fZGltZW5zaW9uO2lmKHQ+PXRoaXMuX19kYXRhLmxlbmd0aC9zKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCB2ZXJ0ZXggaW5kZXg6Iit0KyIuIE51bSBWZXJ0aWNlczoiK3RoaXMuX19kYXRhLmxlbmd0aC8zKTt0aGlzLl9fZGF0YVR5cGUuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLHQqcykuc2V0RnJvbU90aGVyKGUpfXRvSlNPTih0LGUpe3JldHVybntkYXRhOkFycmF5LmZyb20odGhpcy5fX2RhdGEpLGRhdGFUeXBlOmEuZ2V0VHlwZU5hbWUodGhpcy5fX2RhdGFUeXBlKSxkZWZhdWx0VmFsdWU6dGhpcy5fX2RlZmF1bHRFbGVtZW50VmFsdWUsbGVuZ3RoOnRoaXMuX19kYXRhLmxlbmd0aC90aGlzLl9fZGltZW5zaW9ufX1mcm9tSlNPTih0KXt0aGlzLl9fZGF0YT1GbG9hdDMyQXJyYXkuZnJvbSh0LmRhdGEpfXRvU3RyaW5nKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCksbnVsbCwyKX19Y2xhc3MgViBleHRlbmRzIGNsYXNzIGV4dGVuZHMgY2xhc3N7Y29uc3RydWN0b3IoKXt0aGlzLl9fc2xvdHM9e319YWRkTGlzdGVuZXIodCxlKXtpZihudWxsPT1lKXRocm93IG5ldyBFcnJvcigiYSBmdW5jdGlvbiBjYWxsYmFjayBtdXN0IGJlIHBhc3NlZCB0byBFdmVudEVtaXR0ZXIuYWRkTGlzdGVuZXIiKTt0aGlzLl9fc2xvdHNbdF18fCh0aGlzLl9fc2xvdHNbdF09W10pO2NvbnN0IHM9dGhpcy5fX3Nsb3RzW3RdO2lmKC0xIT1zLmluZGV4T2YoZSkpcmV0dXJuIHZvaWQgY29uc29sZS53YXJuKCJsaXN0ZW5lciAnIitlLm5hbWUrIicgYWxyZWFkeSBjb25uZWN0ZWQgdG8gRXZlbnRFbWl0dGVyIHdpdGggZXZlbnROYW1lOiIrdCk7Y29uc3QgYT1zLmxlbmd0aDtyZXR1cm4gc1thXT1lLGF9cmVtb3ZlTGlzdGVuZXIodCxlKXtpZihudWxsPT1lKXRocm93IG5ldyBFcnJvcigiYSBmdW5jdGlvbiBjYWxsYmFjayBtdXN0IGJlIHBhc3NlZCB0byBFdmVudEVtaXR0ZXIuZGlzY29ubmVjdCIpO2NvbnN0IHM9dGhpcy5fX3Nsb3RzW3RdLGE9W107aWYocyYmcy5mb3JFYWNoKCh0LHMpPT57dD09PWUmJmEucHVzaChzKX0pLDA9PWEubGVuZ3RoKXtjb25zdCB0PXRoaXMuZ2V0TmFtZT90aGlzLmdldE5hbWUoKTp0aGlzLmNvbnN0cnVjdG9yLm5hbWU7Y29uc29sZS53YXJuKCJFcnJvciBpbiByZW1vdmVMaXN0ZW5lci4gbGlzdGVuZXIgOiIrZS5uYW1lKyIgd2FzIG5vdCBjb25uZWN0ZWQgdG8gdGhpcyBldmVudCBlbWl0dGVyOiIrdCl9ZWxzZSBmb3IoY29uc3QgdCBvZiBhKXNbdF09dm9pZCAwfXJlbW92ZUxpc3RlbmVyQnlJZCh0LGUpe2NvbnN0IHM9dGhpcy5fX3Nsb3RzW3RdO2lmKHMpe2lmKCFzW2VdKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBJRCIpO3NbZV09dm9pZCAwfWVsc2V7Y29uc3Qgcz0iY2FsbGJhY2sgOiIrZSsiIHdhcyBub3QgY29ubmVjdGVkIHRvIHRoaXMgc2lnbmFsOiIrdDtjb25zb2xlLndhcm4ocyl9fW9uKHQsZSl7cmV0dXJuIHRoaXMuYWRkTGlzdGVuZXIodCxlKX1vbmNlKHQsZSl7Y29uc3Qgcz10aGlzLmFkZExpc3RlbmVyKHQsYT0+e2UoYSksdGhpcy5yZW1vdmVMaXN0ZW5lckJ5SWQodCxzKX0pfW9mZih0LGUpeyJudW1iZXIiPT10eXBlb2YgZT90aGlzLnJlbW92ZUxpc3RlbmVyQnlJZCh0LGUpOnRoaXMucmVtb3ZlTGlzdGVuZXIodCxlKX1lbWl0KHQsZSl7Y29uc3Qgcz10aGlzLl9fc2xvdHNbdF07aWYoIXMpcmV0dXJuO2NvbnN0IGE9cy5sZW5ndGg7Zm9yKGxldCB0PTA7dDxhO3QrKyl7Y29uc3QgYT1zW3RdO2EmJmEoZSl9fX17Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuX19pZD0rK0YsdGhpcy5fX3BhcmFtcz1bXSx0aGlzLl9fcGFyYW1NYXBwaW5nPXt9LHRoaXMuX19wYXJhbVNpZ25hbElkcz17fX1nZXRJZCgpe3JldHVybiB0aGlzLl9faWR9bnVtUGFyYW1ldGVycygpe3JldHVybiB0aGlzLl9fcGFyYW1zLmxlbmd0aH1nZXRQYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX19wYXJhbXN9Z2V0UGFyYW1ldGVySW5kZXgodCl7cmV0dXJuIHRoaXMuX19wYXJhbU1hcHBpbmdbdF19Z2V0UGFyYW1ldGVyQnlJbmRleCh0KXtyZXR1cm4gdGhpcy5fX3BhcmFtc1t0XX1oYXNQYXJhbWV0ZXIodCl7cmV0dXJuIHQgaW4gdGhpcy5fX3BhcmFtTWFwcGluZ31nZXRQYXJhbWV0ZXIodCl7Y29uc3QgZT10aGlzLl9fcGFyYW1NYXBwaW5nW3RdO3JldHVybi0xPT1lP251bGw6dGhpcy5fX3BhcmFtc1tlXX1fX3BhcmFtZXRlclZhbHVlQ2hhbmdlZCh0KXt0aGlzLmVtaXQoInBhcmFtZXRlclZhbHVlQ2hhbmdlZCIsdCl9YWRkUGFyYW1ldGVyKHQpe2NvbnN0IGU9dC5nZXROYW1lKCk7cmV0dXJuIG51bGwhPXRoaXMuX19wYXJhbU1hcHBpbmdbZV0mJihjb25zb2xlLndhcm4oIlJlcGxhY2luZyBQYXJhbWV0ZXI6IitlKSx0aGlzLnJlbW92ZVBhcmFtZXRlcihlKSksdGhpcy5fX3BhcmFtU2lnbmFsSWRzW2VdPXQuYWRkTGlzdGVuZXIoInZhbHVlQ2hhbmdlZCIsZT0+dGhpcy5fX3BhcmFtZXRlclZhbHVlQ2hhbmdlZCh7Li4uZSxwYXJhbTp0fSkpLHRoaXMuX19wYXJhbXMucHVzaCh0KSx0aGlzLl9fcGFyYW1NYXBwaW5nW2VdPXRoaXMuX19wYXJhbXMubGVuZ3RoLTEsdC5zZXRPd25lcih0aGlzKSx0aGlzLmVtaXQoInBhcmFtZXRlckFkZGVkIix7bmFtZTplfSksdH1pbnNlcnRQYXJhbWV0ZXIodCxlKXtjb25zdCBzPXQuZ2V0TmFtZSgpO251bGwhPXRoaXMuX19wYXJhbU1hcHBpbmdbc10mJihjb25zb2xlLndhcm4oIlJlcGxhY2luZyBQYXJhbWV0ZXI6IitzKSx0aGlzLnJlbW92ZVBhcmFtZXRlcihzKSksdGhpcy5fX3BhcmFtU2lnbmFsSWRzW3NdPXQuYWRkTGlzdGVuZXIoInZhbHVlQ2hhbmdlZCIsZT0+dGhpcy5fX3BhcmFtZXRlclZhbHVlQ2hhbmdlZCh7Li4uZSxwYXJhbTp0fSkpLHRoaXMuX19wYXJhbXMuc3BsaWNlKGUsMCx0KTtjb25zdCBhPXt9O2ZvcihsZXQgdD0wO3Q8dGhpcy5fX3BhcmFtcy5sZW5ndGg7dCsrKWFbdGhpcy5fX3BhcmFtc1t0XS5nZXROYW1lKCldPXQ7cmV0dXJuIHRoaXMuX19wYXJhbU1hcHBpbmc9YSx0aGlzLmVtaXQoInBhcmFtZXRlckFkZGVkIix7bmFtZTpzfSksdH1yZW1vdmVQYXJhbWV0ZXIodCl7bnVsbD09dGhpcy5fX3BhcmFtTWFwcGluZ1t0XSYmY29uc29sZS50aHJvdygiVW5hYmxlIHRvIFJlbW92ZSBQYXJhbWV0ZXI6Iit0KTtjb25zdCBlPXRoaXMuX19wYXJhbU1hcHBpbmdbdF07dGhpcy5fX3BhcmFtc1t0aGlzLl9fcGFyYW1NYXBwaW5nW3RdXS5yZW1vdmVMaXN0ZW5lckJ5SWQoInZhbHVlQ2hhbmdlZCIsdGhpcy5fX3BhcmFtU2lnbmFsSWRzW3RdKSx0aGlzLl9fcGFyYW1zLnNwbGljZShlLDEpO2NvbnN0IHM9e307Zm9yKGxldCB0PTA7dDx0aGlzLl9fcGFyYW1zLmxlbmd0aDt0Kyspc1t0aGlzLl9fcGFyYW1zW3RdLmdldE5hbWUoKV09dDt0aGlzLl9fcGFyYW1NYXBwaW5nPXMsdGhpcy5lbWl0KCJwYXJhbWV0ZXJSZW1vdmVkIix7bmFtZTpuYW1lfSl9cmVwbGFjZVBhcmFtZXRlcih0KXtjb25zdCBlPXQuZ2V0TmFtZSgpLHM9dGhpcy5fX3BhcmFtTWFwcGluZ1tlXTtyZXR1cm4gdGhpcy5fX3BhcmFtc1t0aGlzLl9fcGFyYW1NYXBwaW5nW2VdXS5yZW1vdmVMaXN0ZW5lckJ5SWQoInZhbHVlQ2hhbmdlZCIsdGhpcy5fX3BhcmFtU2lnbmFsSWRzW2VdKSx0aGlzLl9fcGFyYW1TaWduYWxJZHNbZV09dC5hZGRMaXN0ZW5lcigidmFsdWVDaGFuZ2VkIixlPT50aGlzLl9fcGFyYW1ldGVyVmFsdWVDaGFuZ2VkKHsuLi5lLHBhcmFtOnR9KSksdGhpcy5fX3BhcmFtc1tzXT10LHR9dG9KU09OKHQsZSl7Y29uc3Qgcz17fTtsZXQgYT0wO2Zvcihjb25zdCBpIG9mIHRoaXMuX19wYXJhbXMpe2lmKCFpLnRlc3RGbGFnKE4pKWNvbnRpbnVlO2NvbnN0IHI9aS50b0pTT04odCxlKTtyJiYoc1tpLmdldE5hbWUoKV09cixhKyspfWlmKGE+MClyZXR1cm57cGFyYW1zOnN9fWZyb21KU09OKHQsZSxzKXtpZih0LnBhcmFtcylmb3IoY29uc3QgcyBpbiB0LnBhcmFtcyl7Y29uc3QgYT10LnBhcmFtc1tzXSxpPXRoaXMuZ2V0UGFyYW1ldGVyKHMpO2k/YS5wYXJhbVBhdGg/ZS5yZXNvbHZlUGF0aChhLnBhcmFtUGF0aCx0PT57dGhpcy5yZXBsYWNlUGFyYW1ldGVyKHQpfSx0PT57Y29uc29sZS53YXJuKCJVbmFibGUgdG8gcmVzb2x2ZSBzaGFyZWQgcGFyYW1ldGVyOiIrYS5wYXJhbVBhdGgpfSk6aS5mcm9tSlNPTihhLGUpOmNvbnNvbGUud2FybigiUGFyYW0gbm90IGZvdW5kOiIrcyl9fXJlYWRCaW5hcnkodCxlKXtpZihlLnZlcnNpb25zWyJ6ZWEtZW5naW5lIl0uZ3JlYXRlck9yRXF1YWxUaGFuKFswLDAsM10pKXtjb25zdCBzPXQubG9hZFVJbnQzMigpO2ZvcihsZXQgYT0wO2E8czthKyspe2NvbnN0IHM9dC5sb2FkU3RyKCksYT10LmxvYWRTdHIoKTtsZXQgaT10aGlzLmdldFBhcmFtZXRlcihhKTtpZighaSl7aWYoaT13LmNvbnN0cnVjdENsYXNzKHMsYSksIWkpe2NvbnNvbGUuZXJyb3IoIlVuYWJsZSB0byBjb25zdHJ1Y3QgcHJvcDoiK2ErIiBvZiB0eXBlOiIrcyk7Y29udGludWV9dGhpcy5hZGRQYXJhbWV0ZXIoaSl9aS5yZWFkQmluYXJ5KHQsZSl9fX10b1N0cmluZygpe3JldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRvSlNPTigpLG51bGwsMil9Y29weUZyb20odCxlKXtsZXQgcz10Lm51bVBhcmFtZXRlcnMoKTtmb3IoO3MtLTspe2NvbnN0IGU9dC5nZXRQYXJhbWV0ZXJCeUluZGV4KHMpLGE9dGhpcy5nZXRQYXJhbWV0ZXIoZS5nZXROYW1lKCkpO2E/YS5zZXRWYWx1ZShlLmdldFZhbHVlKCksSSk6dGhpcy5hZGRQYXJhbWV0ZXIoZS5jbG9uZSgpKX19fXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5fX2JvdW5kaW5nQm94PW5ldyBwLHRoaXMuX19ib3VuZGluZ0JveERpcnR5PSEwLHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzPW5ldyBNYXAsdGhpcy5fX21ldGFEYXRhPW5ldyBNYXAsdGhpcy5hZGRWZXJ0ZXhBdHRyaWJ1dGUoInBvc2l0aW9ucyIsciwwKX1zZXREZWJ1Z05hbWUodCl7dGhpcy5fX25hbWU9dH1hZGRWZXJ0ZXhBdHRyaWJ1dGUodCxlLHMpe2xldCBhO3ZhciBpO3JldHVybiBhPShpPXMpJiZ2b2lkIDAhPT1pLmJ5dGVMZW5ndGg/bmV3IHooZSxzKTpuZXcgeihlLG51bGwhPXRoaXMudmVydGljZXM/dGhpcy52ZXJ0aWNlcy5sZW5ndGg6MCxzKSx0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5zZXQodCxhKSxhfWhhc1ZlcnRleEF0dHJpYnV0ZSh0KXtyZXR1cm4gdGhpcy5fX3ZlcnRleEF0dHJpYnV0ZXMuaGFzKHQpfWdldFZlcnRleEF0dHJpYnV0ZSh0KXtyZXR1cm4gdGhpcy5fX3ZlcnRleEF0dHJpYnV0ZXMuZ2V0KHQpfWdldFZlcnRleEF0dHJpYnV0ZXModCl7Y29uc3QgZT17fTtmb3IoY29uc3RbdCxzXW9mIHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzLmVudHJpZXMoKSllW3RdPXM7cmV0dXJuIGV9Z2V0IHZlcnRpY2VzKCl7cmV0dXJuIHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzLmdldCgicG9zaXRpb25zIil9bnVtVmVydGljZXMoKXtyZXR1cm4gdGhpcy52ZXJ0aWNlcy5sZW5ndGh9Z2V0TnVtVmVydGljZXMoKXtyZXR1cm4gdGhpcy52ZXJ0aWNlcy5sZW5ndGh9c2V0TnVtVmVydGljZXModCl7dGhpcy5fX3ZlcnRleEF0dHJpYnV0ZXMuZm9yRWFjaChlPT5lLnJlc2l6ZSh0KSl9Z2V0VmVydGV4KHQpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMudmVydGljZXMuZGF0YS5idWZmZXIsMyp0KX1zZXRWZXJ0ZXgodCxlKXtyZXR1cm4gci5jcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0aGlzLnZlcnRpY2VzLmRhdGEuYnVmZmVyLDMqdCkuc2V0RnJvbU90aGVyKGUpfW1vdmVWZXJ0aWNlcyh0KXtjb25zdCBlPXRoaXMudmVydGljZXM7Zm9yKGxldCBzPTA7czxlLmxlbmd0aDtzKyspZS5nZXRWYWx1ZVJlZihzKS5hZGRJblBsYWNlKHQpO3RoaXMuc2V0Qm91bmRpbmdCb3hEaXJ0eSgpfXRyYW5zZm9ybVZlcnRpY2VzKHQpe2NvbnN0IGU9dGhpcy52ZXJ0aWNlcztmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKyl7Y29uc3QgYT1lLmdldFZhbHVlUmVmKHMpLGk9dC50cmFuc2Zvcm1WZWMzKGEpO2Euc2V0KGkueCxpLnksaS56KX10aGlzLnNldEJvdW5kaW5nQm94RGlydHkoKX1nZXQgYm91bmRpbmdCb3goKXtyZXR1cm4gdGhpcy5fX2JvdW5kaW5nQm94RGlydHkmJnRoaXMudXBkYXRlQm91bmRpbmdCb3goKSx0aGlzLl9fYm91bmRpbmdCb3h9c2V0Qm91bmRpbmdCb3hEaXJ0eSgpe3RoaXMuX19ib3VuZGluZ0JveERpcnR5PSEwLHRoaXMuZW1pdCgiYm91bmRpbmdCb3hDaGFuZ2VkIix7fSl9dXBkYXRlQm91bmRpbmdCb3goKXtjb25zdCB0PXRoaXMudmVydGljZXMsZT1uZXcgcCxzPXQubGVuZ3RoO2ZvcihsZXQgYT0wO2E8czthKyspZS5hZGRQb2ludCh0LmdldFZhbHVlUmVmKGEpKTt0aGlzLl9fYm91bmRpbmdCb3g9ZSx0aGlzLl9fYm91bmRpbmdCb3hEaXJ0eT0hMX1nZXRNZXRhZGF0YSh0KXtyZXR1cm4gdGhpcy5fX21ldGFEYXRhLmdldCh0KX1oYXNNZXRhZGF0YSh0KXtyZXR1cm4gdGhpcy5fX21ldGFEYXRhLmhhcyh0KX1zZXRNZXRhZGF0YSh0LGUpe3RoaXMuX19tZXRhRGF0YS5zZXQodCxlKX1kZWxldGVNZXRhZGF0YSh0KXt0aGlzLl9fbWV0YURhdGEuZGVsZXRlKHQpfWdlbkJ1ZmZlcnModCl7Y29uc3QgZT17fTtmb3IoY29uc3RbdCxzXW9mIHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzKWVbdF09e3ZhbHVlczpzLmRhdGEsY291bnQ6cy5zaXplLGRhdGFUeXBlOnMuZGF0YVR5cGUsbm9ybWFsaXplZDpzLm5vcm1hbGl6ZWR9O3JldHVybntudW1WZXJ0aWNlczp0aGlzLm51bVZlcnRpY2VzKCksYXR0ckJ1ZmZlcnM6ZX19ZnJlZUJ1ZmZlcnMoKXt9bG9hZEJhc2VHZW9tQmluYXJ5KHQpe3RoaXMubmFtZT10LmxvYWRTdHIoKTtjb25zdCBlPXQubG9hZFVJbnQ4KCk7dGhpcy5kZWJ1Z0NvbG9yPXQubG9hZFJHQkZsb2F0MzJDb2xvcigpO2NvbnN0IHM9dC5sb2FkVUludDMyKCk7dGhpcy5fX2JvdW5kaW5nQm94LnNldCh0LmxvYWRGbG9hdDMyVmVjMygpLHQubG9hZEZsb2F0MzJWZWMzKCkpLHRoaXMuc2V0TnVtVmVydGljZXMocyk7Y29uc3QgYT10aGlzLnZlcnRpY2VzO2xldCBuLGg7MiZlJiYobj10aGlzLmdldFZlcnRleEF0dHJpYnV0ZSgibm9ybWFscyIpLG58fChuPXRoaXMuYWRkVmVydGV4QXR0cmlidXRlKCJub3JtYWxzIixyLDApKSksNCZlJiYoaD10aGlzLmdldFZlcnRleEF0dHJpYnV0ZSgidGV4Q29vcmRzIiksaHx8KGg9dGhpcy5hZGRWZXJ0ZXhBdHRyaWJ1dGUoInRleENvb3JkcyIsaSwwKSkpO2NvbnN0IG89KHQsZSxzLGkpPT57Zm9yKGxldCBuPXRbMF07bjx0WzFdO24rKyl7Y29uc3QgdD1uZXcgcihpWzMqbiswXS8yNTUsaVszKm4rMV0vMjU1LGlbMypuKzJdLzI1NSk7dC5tdWx0aXBseUluUGxhY2UocyksdC5hZGRJblBsYWNlKGUpLGEuc2V0VmFsdWUobix0KX19LF89KHQsZSxzLGEpPT57cy5pc051bGwoKSYmcy5zZXQoMSwxLDEpO2ZvcihsZXQgaT10WzBdO2k8dFsxXTtpKyspe2NvbnN0IHQ9bmV3IHIoYVszKmkrMF0vMjU1LGFbMyppKzFdLzI1NSxhWzMqaSsyXS8yNTUpO3QubXVsdGlwbHlJblBsYWNlKHMpLHQuYWRkSW5QbGFjZShlKSx0Lm5vcm1hbGl6ZUluUGxhY2UoKSxuLnNldFZhbHVlKGksdCl9fSxkPSh0LGUscyxhKT0+e2ZvcihsZXQgcj10WzBdO3I8dFsxXTtyKyspe2NvbnN0IHQ9bmV3IGkoYVsyKnIrMF0vMjU1LGFbMipyKzFdLzI1NSk7dC5tdWx0aXBseUluUGxhY2UocyksdC5hZGRJblBsYWNlKGUpLGguc2V0VmFsdWUocix0KX19LGw9dC5sb2FkVUludDMyKCk7aWYoMT09bCl7e2NvbnN0IGU9dGhpcy5fX2JvdW5kaW5nQm94LGE9dC5sb2FkVUludDhBcnJheSgzKnMpO28oWzAsc10sZS5wMCxlLmRpYWdvbmFsKCksYSl9aWYobil7Y29uc3QgZT1uZXcgcCh0LmxvYWRGbG9hdDMyVmVjMygpLHQubG9hZEZsb2F0MzJWZWMzKCkpLGE9dC5sb2FkVUludDhBcnJheSgzKnMpO18oWzAsc10sZS5wMCxlLmRpYWdvbmFsKCksYSksbi5sb2FkU3BsaXRWYWx1ZXModCl9aWYoaCl7Y29uc3QgZT1uZXcgZyh0LmxvYWRGbG9hdDMyVmVjMigpLHQubG9hZEZsb2F0MzJWZWMyKCkpLGE9dC5sb2FkVUludDhBcnJheSgyKnMpO2QoWzAsc10sZS5wMCxlLmRpYWdvbmFsKCksYSksaC5sb2FkU3BsaXRWYWx1ZXModCl9fWVsc2V7Y29uc3QgZT1bXTtsZXQgYT0wO2ZvcihsZXQgcz0wO3M8bDtzKyspe2NvbnN0IHM9dC5sb2FkVUludDMyKCksaT17cmFuZ2U6W2EsYStzXSxiYm94Om5ldyBwKHQubG9hZEZsb2F0MzJWZWMzKCksdC5sb2FkRmxvYXQzMlZlYzMoKSl9O24mJihpLm5vcm1hbHNSYW5nZT1uZXcgcCh0LmxvYWRGbG9hdDMyVmVjMygpLHQubG9hZEZsb2F0MzJWZWMzKCkpKSxoJiYoaS50ZXhDb29yZHNSYW5nZT1uZXcgZyh0LmxvYWRGbG9hdDMyVmVjMigpLHQubG9hZEZsb2F0MzJWZWMyKCkpKSxlLnB1c2goaSksYSs9c31jb25zdCBpPXQubG9hZFVJbnQ4QXJyYXkoMypzKTtsZXQgcixjO24mJihyPXQubG9hZFVJbnQ4QXJyYXkoMypzKSksaCYmKGM9dC5sb2FkVUludDhBcnJheSgyKnMpKTtmb3IobGV0IHQ9MDt0PGw7dCsrKXt7Y29uc3Qgcz1lW3RdLmJib3g7byhlW3RdLnJhbmdlLHMucDAscy5kaWFnb25hbCgpLGkpfWlmKG4pe2NvbnN0IHM9ZVt0XS5ub3JtYWxzUmFuZ2U7XyhlW3RdLnJhbmdlLHMucDAscy5kaWFnb25hbCgpLHIpfWlmKGgpe2NvbnN0IHM9ZVt0XS50ZXhDb29yZHNSYW5nZTtkKGVbdF0ucmFuZ2Uscy5wMCxzLmRpYWdvbmFsKCksYyl9fW4mJm4ubG9hZFNwbGl0VmFsdWVzKHQpLGgmJmgubG9hZFNwbGl0VmFsdWVzKHQpfX10b0pTT04odCxlKXtsZXQgcz1zdXBlci50b0pTT04odCxlKTtpZihzfHwocz17fSkscy50eXBlPXcuZ2V0Q2xhc3NOYW1lKHRoaXMpLCEoMTAyNCZlKSl7Y29uc3QgYT17fTtmb3IoY29uc3RbcyxpXW9mIHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzLmVudHJpZXMoKSlhW3NdPWkudG9KU09OKHQsZSk7cy52ZXJ0ZXhBdHRyaWJ1dGVzPWF9cmV0dXJuIHN9ZnJvbUpTT04odCxlLHMpe3N1cGVyLmZyb21KU09OKHQsZSxzKTtmb3IoY29uc3QgZSBpbiB0LnZlcnRleEF0dHJpYnV0ZXMpe2xldCBzPXRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzLmdldChlKTtjb25zdCBpPXQudmVydGV4QXR0cmlidXRlc1tlXTtpZighcyl7Y29uc3QgdD1hLmdldFR5cGUoaS5kYXRhVHlwZSk7cz1uZXcgVmVydGV4QXR0cmlidXRlKHRoaXMsdCwwLGkuZGVmYXVsdFNjYWxhclZhbHVlKSx0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5zZXQoZSxzKX1zLmZyb21KU09OKGkpfX10b1N0cmluZygpe3JldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRvSlNPTigpLG51bGwsMil9fWNsYXNzIE0gZXh0ZW5kcyBWe2NvbnN0cnVjdG9yKCl7c3VwZXIoKX1sb2FkQmluKHQpe3RoaXMubmFtZT10LmxvYWRTdHIoKTtjb25zdCBlPXQubG9hZFVJbnQzMigpO3RoaXMuX19ib3VuZGluZ0JveC5zZXQodC5sb2FkRmxvYXQzMlZlYzMoKSx0LmxvYWRGbG9hdDMyVmVjMygpKSx0aGlzLnNldE51bVZlcnRpY2VzKGUpO2NvbnN0IHM9dGhpcy52ZXJ0aWNlcztpZihlPDI1Nil7Y29uc3QgYT10aGlzLl9fYm91bmRpbmdCb3gudG9NYXQ0KCksaT10LmxvYWRVSW50OEFycmF5KDMqZSk7Zm9yKGxldCB0PTA7dDxlO3QrKyl7Y29uc3QgZT1uZXcgVmVjMyhpWzMqdCswXS8yNTUsaVszKnQrMV0vMjU1LGlbMyp0KzJdLzI1NSk7cy5zZXRWYWx1ZSh0LGEudHJhbnNmb3JtVmVjMyhlKSl9fWVsc2V7Y29uc3QgYT10LmxvYWRVSW50MzIoKSxpPVtdO2ZvcihsZXQgZT0wO2U8YTtlKyspe2NvbnN0IGU9dC5sb2FkVUludDMyVmVjMigpLHM9dC5sb2FkRmxvYXQzMlZlYzMoKSxhPXQubG9hZEZsb2F0MzJWZWMzKCk7aS5wdXNoKHtyYW5nZTplLGJib3g6bmV3IEJveDMocyxhKX0pfWNvbnN0IHI9dC5sb2FkVUludDhBcnJheSgzKmUpO2ZvcihsZXQgdD0wO3Q8YTt0Kyspe2NvbnN0IGU9aVt0XS5iYm94LnRvTWF0NCgpO2ZvcihsZXQgYT1pW3RdLnJhbmdlLng7YTxpW3RdLnJhbmdlLnk7YSsrKXtjb25zdCB0PW5ldyBWZWMzKHJbMyphKzBdLzI1NSxyWzMqYSsxXS8yNTUsclszKmErMl0vMjU1KTtzLnNldFZhbHVlKGEsZS50cmFuc2Zvcm1WZWMzKHQpKX19fX1yZWFkQmluYXJ5KHQsZSl7c3VwZXIubG9hZEJhc2VHZW9tQmluYXJ5KHQpLHRoaXMuZW1pdCgiZ2VvbURhdGFDaGFuZ2VkIix7fSl9fWNsYXNzIEEgZXh0ZW5kcyBWe2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLl9faW5kaWNlcz1uZXcgVWludDMyQXJyYXksdGhpcy5fX3NlZ21lbnRBdHRyaWJ1dGVzPW5ldyBNYXAsdGhpcy5saW5lVGhpY2tuZXNzPTB9Z2V0SW5kaWNlcygpe3JldHVybiB0aGlzLl9faW5kaWNlc31nZXROdW1TZWdtZW50cygpe3JldHVybiB0aGlzLl9faW5kaWNlcy5sZW5ndGgvMn1zZXROdW1TZWdtZW50cyh0KXtjb25zdCBlPW5ldyBVaW50MzJBcnJheSgyKnQpO3RoaXMuX19pbmRpY2VzPWV9c2V0U2VnbWVudCh0LGUscyl7aWYodD49dGhpcy5fX2luZGljZXMubGVuZ3RoLzIpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGxpbmUgaW5kZXg6Iit0KyIuIE51bSBTZWdtZW50czoiK3RoaXMuX19pbmRpY2VzLmxlbmd0aC8yKTt0aGlzLl9faW5kaWNlc1syKnQrMF09ZSx0aGlzLl9faW5kaWNlc1syKnQrMV09c31nZXRTZWdtZW50VmVydGV4SW5kZXgodCxlKXtpZih0PHRoaXMubnVtTGluZXMpcmV0dXJuIHRoaXMuX19pbmRpY2VzWzIqdCtlXX1hZGRTZWdtZW50QXR0cmlidXRlKHQsZSxzKXtjb25zdCBhPW5ldyBBdHRyaWJ1dGUoZSxudWxsIT1zP3M6dGhpcy5wb2x5Z29uQ291bnQpO3JldHVybiB0aGlzLl9fc2VnbWVudEF0dHJpYnV0ZXMuc2V0KHQsYSksYX1oYXNTZWdtZW50QXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fc2VnbWVudEF0dHJpYnV0ZXMuaGFzKHQpfWdldFNlZ21lbnRBdHRyaWJ1dGUodCl7cmV0dXJuIHRoaXMuX19zZWdtZW50QXR0cmlidXRlcy5nZXQodCl9Z2VuQnVmZmVycygpe2NvbnN0IHQ9c3VwZXIuZ2VuQnVmZmVycygpO2xldCBlO3JldHVybiB0Lm51bVZlcnRpY2VzPE1hdGgucG93KDIsOCk/KGU9bmV3IFVpbnQ4QXJyYXkodGhpcy5fX2luZGljZXMubGVuZ3RoKSx0aGlzLl9faW5kaWNlcy5mb3JFYWNoKCh0LHMpPT57ZVtzXT10fSkpOnQubnVtVmVydGljZXM8TWF0aC5wb3coMiwxNik/KGU9bmV3IFVpbnQxNkFycmF5KHRoaXMuX19pbmRpY2VzLmxlbmd0aCksdGhpcy5fX2luZGljZXMuZm9yRWFjaCgodCxzKT0+e2Vbc109dH0pKTplPXRoaXMuX19pbmRpY2VzLHQuaW5kaWNlcz1lLHR9cmVhZEJpbmFyeSh0LGUpe3N1cGVyLmxvYWRCYXNlR2VvbUJpbmFyeSh0KSx0aGlzLnNldE51bVNlZ21lbnRzKHQubG9hZFVJbnQzMigpKTtjb25zdCBzPXQubG9hZFVJbnQ4KCk7MT09cz90aGlzLl9faW5kaWNlcz10LmxvYWRVSW50OEFycmF5KCk6Mj09cz90aGlzLl9faW5kaWNlcz10LmxvYWRVSW50MTZBcnJheSgpOjQ9PXMmJih0aGlzLl9faW5kaWNlcz10LmxvYWRVSW50MzJBcnJheSgpKSx0aGlzLmdlb21EYXRhQ2hhbmdlZC5lbWl0KCl9dG9KU09OKHQsZSl7Y29uc3Qgcz1zdXBlci50b0pTT04odCxlKTtyZXR1cm4gMTAyNCZlfHwocy5pbmRpY2VzPUFycmF5LmZyb20odGhpcy5fX2luZGljZXMpKSxzfWZyb21KU09OKHQsZSxzKXtzdXBlci5mcm9tSlNPTih0LGUscyksdGhpcy5fX2luZGljZXM9VWludDMyQXJyYXkuZnJvbSh0LmluZGljZXMpfX1jbGFzcyBTIGV4dGVuZHMgentjb25zdHJ1Y3Rvcih0LGUscyxhKXtzdXBlcihlLHMsYSksdGhpcy5fX2dlb209dCx0aGlzLl9fc3BsaXRzPXt9LHRoaXMuX19zcGxpdFZhbHVlcz1bXX1nZXRGYWNlVmVydGV4VmFsdWVSZWYodCxlKXtjb25zdCBzPXRoaXMuX19nZW9tLmdldEZhY2VWZXJ0ZXhJbmRleCh0LGUpO3JldHVybiBzIGluIHRoaXMuX19zcGxpdHMmJnQgaW4gdGhpcy5fX3NwbGl0c1tzXT90aGlzLl9fc3BsaXRWYWx1ZXNbdGhpcy5fX3NwbGl0c1tzXVt0XV06dGhpcy5nZXRWYWx1ZVJlZihzKX1zZXRGYWNlVmVydGV4VmFsdWUodCxlLHMpe2NvbnN0IGE9dGhpcy5fX2dlb20uZ2V0RmFjZVZlcnRleEluZGV4KHQsZSk7dGhpcy5zZXRGYWNlVmVydGV4VmFsdWVfQnlWZXJ0ZXhJbmRleCh0LGEscyl9c2V0RmFjZVZlcnRleFZhbHVlX0J5VmVydGV4SW5kZXgodCxlLHMpe2NvbnN0IGE9dGhpcy5nZXRWYWx1ZVJlZihlKTtpZihhLmlzVmFsaWQoKSlpZihhLmFwcHJveEVxdWFsKHMpKTtlbHNle2lmKGUgaW4gdGhpcy5fX3NwbGl0cyl7Y29uc3QgYT10aGlzLl9fc3BsaXRzW2VdO2Zvcihjb25zdCBlIGluIGEpe2NvbnN0IGk9YVtlXTtpZih0aGlzLl9fc3BsaXRWYWx1ZXNbaV0uYXBwcm94RXF1YWwocykpcmV0dXJuIHZvaWQoYVt0XT1pKX1pZih0IGluIHRoaXMuX19zcGxpdHNbZV0pe3JldHVybiB2b2lkIHRoaXMuX19zcGxpdFZhbHVlc1t0aGlzLl9fc3BsaXRzW2VdW3RdXS5zZXRGcm9tT3RoZXIocyl9fWVsc2UgdGhpcy5fX3NwbGl0c1tlXT17fTt0aGlzLl9fc3BsaXRzW2VdW3RdPXRoaXMuX19zcGxpdFZhbHVlcy5sZW5ndGgsdGhpcy5fX3NwbGl0VmFsdWVzLnB1c2gocyl9ZWxzZSBhLnNldEZyb21PdGhlcihzKX1zZXRTcGxpdFZlcnRleFZhbHVlKHQsZSxzKXtpZih0IGluIHRoaXMuX19zcGxpdHN8fCh0aGlzLl9fc3BsaXRzW3RdPXt9KSxlIGluIHRoaXMuX19zcGxpdHNbdF0pe2lmKHRoaXMuX19zcGxpdFZhbHVlc1t0aGlzLl9fc3BsaXRzW3RdW2VdXS5hcHByb3hFcXVhbChzKSlyZXR1cm47Y29uc29sZS53YXJuKCJGYWNlIFZlcnRleCBBbHJlYWR5IFNwbGl0IHdpdGggZGlmZmVyZW50IHZhbHVlIil9dGhpcy5fX3NwbGl0c1t0XVtlXT10aGlzLl9fc3BsaXRWYWx1ZXMubGVuZ3RoLHRoaXMuX19zcGxpdFZhbHVlcy5wdXNoKHMpfXNldFNwbGl0VmVydGV4VmFsdWVzKHQsZSxzKXt0IGluIHRoaXMuX19zcGxpdHN8fCh0aGlzLl9fc3BsaXRzW3RdPXt9KTtjb25zdCBhPXRoaXMuX19zcGxpdFZhbHVlcy5sZW5ndGg7dGhpcy5fX3NwbGl0VmFsdWVzLnB1c2gocyk7Zm9yKGNvbnN0IHMgb2YgZSl0aGlzLl9fc3BsaXRzW3RdW3NdPWF9Z2V0U3BsaXRzKCl7cmV0dXJuIHRoaXMuX19zcGxpdHN9Z2V0U3BsaXRDb3VudCgpe2xldCB0PTA7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fX3NwbGl0cyl0Kz1PYmplY3Qua2V5cyh0aGlzLl9fc3BsaXRzW2VdKS5sZW5ndGg7cmV0dXJuIHR9Z2VuZXJhdGVTcGxpdFZhbHVlcyh0LGUpe2lmKDA9PWUpcmV0dXJuIHRoaXMuX19kYXRhO2NvbnN0IHM9dGhpcy5sZW5ndGgsYT10aGlzLmxlbmd0aCtlLGk9dGhpcy5fX2RhdGFUeXBlLm51bUVsZW1lbnRzP3RoaXMuX19kYXRhVHlwZS5udW1FbGVtZW50cygpOjEscj1uZXcgRmxvYXQzMkFycmF5KGEqaSk7Zm9yKGxldCB0PTA7dDx0aGlzLl9fZGF0YS5sZW5ndGg7dCsrKXJbdF09dGhpcy5fX2RhdGFbdF07Zm9yKGNvbnN0IGUgaW4gdCl7Y29uc3QgYT10W2VdO2Zvcihjb25zdCB0IGluIGEpe2NvbnN0IG49cythW3RdO2lmKGUgaW4gdGhpcy5fX3NwbGl0cyYmdCBpbiB0aGlzLl9fc3BsaXRzW2VdKXtjb25zdCBzPXRoaXMuX19zcGxpdHNbZV1bdF07Nj09dGhpcy5fX2RhdGFUeXBlP3JbbippXT10aGlzLl9fc3BsaXRWYWx1ZXNbc106dGhpcy5fX2RhdGFUeXBlLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHIuYnVmZmVyLG4qaSkuc2V0RnJvbU90aGVyKHRoaXMuX19zcGxpdFZhbHVlc1tzXSl9ZWxzZXtjb25zdCB0PXBhcnNlSW50KGUpO2ZvcihsZXQgZT0wO2U8aTtlKyspdCppK2U+dGhpcy5fX2RhdGEubGVuZ3RoJiZjb25zb2xlLmxvZygiRXJyb3IgcmVtYXBwaW5nIHNyYzoiK3QqaStlKSxuKmkrZT5yLmxlbmd0aCYmY29uc29sZS5sb2coIkVycm9yIHJlbWFwcGluZyB0Z3Q6IituKmkrZSkscltuKmkrZV09dGhpcy5fX2RhdGFbdCppK2VdfX19cmV0dXJuIHJ9dG9KU09OKHQsZSl7Y29uc3Qgcz1zdXBlci50b0pTT04odCxlKTtyZXR1cm4gcy5zcGxpdHM9dGhpcy5fX3NwbGl0cyxzLnNwbGl0VmFsdWVzPXRoaXMuX19zcGxpdFZhbHVlcyxzfWZyb21KU09OKHQsZSxzKXtzdXBlci5mcm9tSlNPTih0LGUscyksdGhpcy5fX3NwbGl0cz10LnNwbGl0cyx0aGlzLl9fc3BsaXRWYWx1ZXM9W107Zm9yKGNvbnN0IGUgb2YgdC5zcGxpdFZhbHVlcyl0aGlzLl9fc3BsaXRWYWx1ZXMucHVzaCh0aGlzLl9fZGF0YVR5cGUuY3JlYXRlRnJvbUpTT04oZSkpfWxvYWRTcGxpdFZhbHVlcyh0KXtjb25zdCBlPXQubG9hZFVJbnQzMkFycmF5KCk7aWYoMD09ZS5sZW5ndGgpcmV0dXJuO2xldCBzPTAsYT0wO2Zvcig7Oyl7Y29uc3QgdD1lW3MrK10saT1lW3MrK10scj17fTtmb3IobGV0IHQ9MDt0PGk7dCsrKXtjb25zdCB0PWVbcysrXSxpPWVbcysrXTtyW3RdPWksaT49YSYmKGE9aSsxKX1pZih0aGlzLl9fc3BsaXRzW3RdPXIscz49ZS5sZW5ndGgpYnJlYWt9Y29uc3QgaT10aGlzLl9fbnVtRmxvYXQzMkVsZW1lbnRzLHI9dC5sb2FkRmxvYXQzMkFycmF5KGEqaSk7dGhpcy5fX3NwbGl0VmFsdWVzPVtdO2ZvcihsZXQgdD0wO3Q8YTt0Kyspe2NvbnN0IGU9dGhpcy5fX2RhdGFUeXBlLmNyZWF0ZUZyb21GbG9hdDMyQXJyYXkoci5zbGljZSh0KmksdCppK2kpKTt0aGlzLl9fc3BsaXRWYWx1ZXMucHVzaChlKX19fWNsYXNzIE8gZXh0ZW5kcyBWe2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmluaXQoKX1pbml0KCl7dGhpcy5fX2ZhY2VDb3VudHM9W10sdGhpcy5fX2ZhY2VWZXJ0ZXhDb3VudHM9bmV3IFVpbnQ4QXJyYXksdGhpcy5fX2ZhY2VPZmZzZXRzPW5ldyBVaW50MzJBcnJheSx0aGlzLl9fZmFjZVZlcnRleEluZGljZXM9bmV3IFVpbnQzMkFycmF5LHRoaXMuX19udW1Qb3B1bGF0ZWRGYWNlVmVydGV4SW5kaWNlcz0wLHRoaXMuX19mYWNlQXR0cmlidXRlcz1uZXcgTWFwLHRoaXMuX19lZGdlQXR0cmlidXRlcz1uZXcgTWFwLHRoaXMuX19sb2dUb3BvbG9neVdhcm5pbmdzPSExLHRoaXMuZWRnZVZlcnRzPXZvaWQgMCx0aGlzLnZlcnRleEVkZ2VzPXZvaWQgMCx0aGlzLm51bUVkZ2VzPTAsdGhpcy5lZGdlRmxhZ3M9bmV3IFVpbnQzMkFycmF5LHRoaXMuZWRnZUFuZ2xlcz1uZXcgRmxvYXQzMkFycmF5fWdldEZhY2VWZXJ0ZXhJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX19mYWNlVmVydGV4SW5kaWNlc31nZXRGYWNlQ291bnRzKCl7cmV0dXJuIHRoaXMuX19mYWNlQ291bnRzfWNsZWFyKCl7dGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzPXZvaWQgMCx0aGlzLl9fZmFjZUNvdW50cz1bXSx0aGlzLl9fbnVtUG9wdWxhdGVkRmFjZVZlcnRleEluZGljZXM9MH1zZXRGYWNlQ291bnRzKHQpe2lmKHRoaXMuX19udW1Qb3B1bGF0ZWRGYWNlVmVydGV4SW5kaWNlcyl0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzZXQgZmFjZSBjb3VudHMgb24gYSBtZXNoIHRoYXQgaXMgYWxyZWFkeSBwb3B1bGF0ZWQuIFBsZWFzZSBjYWxsICdjbGVhcicgYmVmb3JlIHJlLWJ1aWxkaW5nIHRoZSBtZXNoLiIpO3RoaXMuX19mYWNlQ291bnRzPXQ7bGV0IGU9MCxzPTAsYT0zO2Zvcihjb25zdCB0IG9mIHRoaXMuX19mYWNlQ291bnRzKWUrPXQscys9dCphLGErKzt0aGlzLl9fZmFjZVZlcnRleENvdW50cz1uZXcgVWludDhBcnJheShlKSx0aGlzLl9fZmFjZU9mZnNldHM9bmV3IFVpbnQzMkFycmF5KGUpLHRoaXMuX19mYWNlVmVydGV4SW5kaWNlcz1uZXcgVWludDMyQXJyYXkocyk7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fX2ZhY2VBdHRyaWJ1dGVzKXQucmVzaXplKGUpfXNldEZhY2VWZXJ0ZXhJbmRpY2VzKHQpe2NvbnN0IGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLHM9dGhpcy5fX251bVBvcHVsYXRlZEZhY2VWZXJ0ZXhJbmRpY2VzO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXRoaXMuX19mYWNlVmVydGV4SW5kaWNlc1tzK3RdPWVbdF07dGhpcy5fX2ZhY2VWZXJ0ZXhDb3VudHNbdF09ZS5sZW5ndGgtMyx0aGlzLl9fZmFjZU9mZnNldHNbdF09cyx0aGlzLl9fbnVtUG9wdWxhdGVkRmFjZVZlcnRleEluZGljZXMrPWUubGVuZ3RofWdldEZhY2VWZXJ0ZXhJbmRpY2VzKHQpe2NvbnN0IGU9W10scz10aGlzLl9fZmFjZU9mZnNldHNbdF0sYT10aGlzLl9fZmFjZVZlcnRleENvdW50c1t0XSszO2ZvcihsZXQgdD0wO3Q8YTt0KyspZS5wdXNoKHRoaXMuX19mYWNlVmVydGV4SW5kaWNlc1tzK3RdKTtyZXR1cm4gZX1nZXRGYWNlVmVydGV4SW5kZXgodCxlKXtjb25zdCBzPXRoaXMuX19mYWNlT2Zmc2V0c1t0XTtyZXR1cm4gdGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzW3MrZV19Z2V0TnVtRmFjZXMoKXtyZXR1cm4gdGhpcy5fX2ZhY2VWZXJ0ZXhDb3VudHMubGVuZ3RofWFkZFZlcnRleEF0dHJpYnV0ZSh0LGUscyl7Y29uc3QgYT1uZXcgUyh0aGlzLGUsbnVsbCE9dGhpcy52ZXJ0aWNlcz90aGlzLnZlcnRpY2VzLmxlbmd0aDowLHMpO3JldHVybiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5zZXQodCxhKSxhfWFkZEZhY2VBdHRyaWJ1dGUodCxlLHMpe2NvbnN0IGE9bmV3IHooZSxudWxsIT1zP3M6dGhpcy5nZXROdW1GYWNlcygpKTtyZXR1cm4gdGhpcy5fX2ZhY2VBdHRyaWJ1dGVzLnNldCh0LGEpLGF9aGFzRmFjZUF0dHJpYnV0ZSh0KXtyZXR1cm4gdGhpcy5fX2ZhY2VBdHRyaWJ1dGVzLmhhcyh0KX1nZXRGYWNlQXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fZmFjZUF0dHJpYnV0ZXMuZ2V0KHQpfWFkZEVkZ2VBdHRyaWJ1dGUodCxlLHMpe2NvbnN0IGE9bmV3IHooZSxudWxsIT1zP3M6dGhpcy5nZXROdW1FZGdlcygpKTtyZXR1cm4gdGhpcy5fX2VkZ2VBdHRyaWJ1dGVzLnNldCh0LGEpLGF9aGFzRWRnZUF0dHJpYnV0ZSh0KXtyZXR1cm4gdGhpcy5fX2VkZ2VBdHRyaWJ1dGVzLmhhcyh0KX1nZXRFZGdlQXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fZWRnZUF0dHJpYnV0ZXMuZ2V0KHQpfWdlblRvcG9sb2d5SW5mbygpe2NvbnN0IHQ9e307dGhpcy52ZXJ0ZXhFZGdlcz1bXSx0aGlzLmVkZ2VGYWNlcz1bXSx0aGlzLmVkZ2VWZXJ0cz1bXSx0aGlzLmZhY2VFZGdlcz1bXSx0aGlzLm51bUVkZ2VzPTA7Y29uc3QgZT0oZSxzKT0+e2xldCBhPWUsaT1zO2lmKGk8YSl7Y29uc3QgdD1hO2E9aSxpPXR9Y29uc3Qgcj1hKyI+IitpO2lmKHIgaW4gdClyZXR1cm4gdFtyXTtjb25zdCBuPXRoaXMudmVydGljZXMuZ2V0VmFsdWVSZWYoYSksaD10aGlzLnZlcnRpY2VzLmdldFZhbHVlUmVmKGkpLnN1YnRyYWN0KG4pLG89e2VkZ2VJbmRleDp0aGlzLmVkZ2VGYWNlcy5sZW5ndGgvMixlZGdlVmVjOmh9O3JldHVybiB0W3JdPW8sdGhpcy5lZGdlRmFjZXMucHVzaCgtMSksdGhpcy5lZGdlRmFjZXMucHVzaCgtMSksdGhpcy5lZGdlVmVydHMucHVzaChhKSx0aGlzLmVkZ2VWZXJ0cy5wdXNoKGkpLHRoaXMubnVtRWRnZXMrKyxvfSxzPSh0LHMsYSk9Pntjb25zdCBpPWUodCxzKS5lZGdlSW5kZXg7aWYoczx0KXtjb25zdCB0PTIqaSswO3RoaXMuX19sb2dUb3BvbG9neVdhcm5pbmdzJiYtMSE9dGhpcy5lZGdlRmFjZXNbdF0mJmNvbnNvbGUud2FybigiRWRnZSBwb2x5IDAgYWxyZWFkeSBzZXQuIE1lc2ggaXMgbm9uLW1hbmlmb2xkLiIpLHRoaXMuZWRnZUZhY2VzW3RdPWF9ZWxzZXtjb25zdCB0PTIqaSsxO3RoaXMuX19sb2dUb3BvbG9neVdhcm5pbmdzJiYtMSE9dGhpcy5lZGdlRmFjZXNbdF0mJmNvbnNvbGUud2FybigiRWRnZSBwb2x5IDEgYWxyZWFkeSBzZXQuIE1lc2ggaXMgbm9uLW1hbmlmb2xkLiIpLHRoaXMuZWRnZUZhY2VzW3RdPWF9YSBpbiB0aGlzLmZhY2VFZGdlc3x8KHRoaXMuZmFjZUVkZ2VzW2FdPVtdKSx0aGlzLmZhY2VFZGdlc1thXS5wdXNoKGkpLG51bGw9PXRoaXMudmVydGV4RWRnZXNbdF0mJih0aGlzLnZlcnRleEVkZ2VzW3RdPW5ldyBTZXQpLG51bGw9PXRoaXMudmVydGV4RWRnZXNbc10mJih0aGlzLnZlcnRleEVkZ2VzW3NdPW5ldyBTZXQpLHRoaXMudmVydGV4RWRnZXNbdF0uYWRkKGkpLHRoaXMudmVydGV4RWRnZXNbc10uYWRkKGkpfSxhPXRoaXMuZ2V0TnVtRmFjZXMoKTtmb3IobGV0IHQ9MDt0PGE7dCsrKXtjb25zdCBlPXRoaXMuZ2V0RmFjZVZlcnRleEluZGljZXModCk7Zm9yKGxldCBhPTA7YTxlLmxlbmd0aDthKyspe3MoZVthXSxlWyhhKzEpJWUubGVuZ3RoXSx0KX19fWNvbXB1dGVGYWNlTm9ybWFscygpe2NvbnN0IHQ9dGhpcy52ZXJ0aWNlcyxlPXRoaXMuYWRkRmFjZUF0dHJpYnV0ZSgibm9ybWFscyIscikscz10aGlzLmdldE51bUZhY2VzKCk7Zm9yKGxldCBhPTA7YTxzO2ErKyl7Y29uc3Qgcz10aGlzLmdldEZhY2VWZXJ0ZXhJbmRpY2VzKGEpLGk9dC5nZXRWYWx1ZVJlZihzWzBdKTtsZXQgbj10LmdldFZhbHVlUmVmKHNbMV0pO2NvbnN0IGg9bmV3IHI7Zm9yKGxldCBlPTI7ZTxzLmxlbmd0aDtlKyspe2NvbnN0IGE9dC5nZXRWYWx1ZVJlZihzW2VdKSxyPW4uc3VidHJhY3QoaSksbz1hLnN1YnRyYWN0KGkpO2guYWRkSW5QbGFjZShyLmNyb3NzKG8pLm5vcm1hbGl6ZSgpKSxuPWF9aC5sZW5ndGhTcXVhcmVkKCksTnVtYmVyLkVQU0lMT04sZS5zZXRWYWx1ZShhLGgubm9ybWFsaXplKCkpfX1nZW5lcmF0ZUVkZ2VGbGFncygpe251bGw9PXRoaXMudmVydGV4RWRnZXMmJnRoaXMuZ2VuVG9wb2xvZ3lJbmZvKCksdGhpcy5oYXNGYWNlQXR0cmlidXRlKCJub3JtYWxzIil8fHRoaXMuY29tcHV0ZUZhY2VOb3JtYWxzKCk7Y29uc3QgdD10aGlzLnZlcnRpY2VzLGU9dGhpcy5nZXRGYWNlQXR0cmlidXRlKCJub3JtYWxzIik7dGhpcy5lZGdlVmVjcz1bXSx0aGlzLmVkZ2VBbmdsZXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLm51bUVkZ2VzKTtmb3IobGV0IHM9MDtzPHRoaXMuZWRnZUZhY2VzLmxlbmd0aDtzKz0yKXtjb25zdCBhPXRoaXMuZWRnZVZlcnRzW3NdLGk9dGhpcy5lZGdlVmVydHNbcysxXSxyPXQuZ2V0VmFsdWVSZWYoaSkuc3VidHJhY3QodC5nZXRWYWx1ZVJlZihhKSk7ci5ub3JtYWxpemVJblBsYWNlKCksdGhpcy5lZGdlVmVjcy5wdXNoKHIpO2NvbnN0IG49dGhpcy5lZGdlRmFjZXNbc10saD10aGlzLmVkZ2VGYWNlc1tzKzFdO2lmKC0xPT1ufHwtMT09aCl7dGhpcy5lZGdlQW5nbGVzW3MvMl09MipNYXRoLlBJO2NvbnRpbnVlfWNvbnN0IG89ZS5nZXRWYWx1ZVJlZihuKSxfPWUuZ2V0VmFsdWVSZWYoaCk7dGhpcy5lZGdlQW5nbGVzW3MvMl09by5hbmdsZVRvKF8pfX1jb21wdXRlVmVydGV4Tm9ybWFscyh0PTEpe3RoaXMuZ2VuZXJhdGVFZGdlRmxhZ3MoKTt0aGlzLnZlcnRpY2VzO2NvbnN0IGU9dGhpcy5nZXRGYWNlQXR0cmlidXRlKCJub3JtYWxzIikscz10aGlzLmFkZFZlcnRleEF0dHJpYnV0ZSgibm9ybWFscyIsciksYT1lLmRhdGEuYnVmZmVyLGk9cy5kYXRhLG49KHQsZSk9PntpWzMqdCswXT1lLngsaVszKnQrMV09ZS55LGlbMyp0KzJdPWUuen0saD0odCxlKT0+e2xldCBzLGE7Y29uc3QgaT10aGlzLmZhY2VFZGdlc1t0XTtmb3IoY29uc3QgdCBvZiBpKSh0aGlzLmVkZ2VWZXJ0c1syKnRdPT1lfHx0aGlzLmVkZ2VWZXJ0c1syKnQrMV09PWUpJiYocz9hPXRoaXMuZWRnZVZlY3NbdF06cz10aGlzLmVkZ2VWZWNzW3RdKTtyZXR1cm5bcyxhXX07Zm9yKGxldCBlPTA7ZTx0aGlzLnZlcnRleEVkZ2VzLmxlbmd0aDtlKyspe2lmKG51bGw9PXRoaXMudmVydGV4RWRnZXNbZV0pY29udGludWU7Y29uc3QgaT10aGlzLnZlcnRleEVkZ2VzW2VdLF89W10sZD10PT57bGV0IGU9ITE7Zm9yKGNvbnN0IHMgb2YgXylpZihlPS0xIT1zLmluZGV4T2YodCksZSlicmVhaztlfHxfLnB1c2goW3RdKX07Zm9yKGNvbnN0IGUgb2YgaSl7Y29uc3Qgcz10aGlzLmVkZ2VGYWNlc1syKmVdLGE9dGhpcy5lZGdlRmFjZXNbMiplKzFdO2lmKC0xIT1zJiYtMT09YSYmdGhpcy5lZGdlQW5nbGVzW2VdPHQpe2xldCB0PS0xLGU9LTE7Zm9yKGxldCBpPTA7aTxfLmxlbmd0aDtpKyspLTE9PXQmJi0xIT1fW2ldLmluZGV4T2YocykmJih0PWkpLC0xPT1lJiYtMSE9X1tpXS5pbmRleE9mKGEpJiYoZT1pKTstMT09dCYmLTE9PWU/Xy5wdXNoKFtzLGFdKTotMSE9dCYmLTEhPWU/dCE9ZSYmKF9bdF09X1t0XS5jb25jYXQoX1tlXSksXy5zcGxpY2UoZSwxKSk6KC0xPT10JiZfW2VdLnB1c2gocyksLTE9PWUmJl9bdF0ucHVzaChhKSl9ZWxzZS0xIT1zJiZkKHMpLC0xIT1hJiZkKGEpfV8uc29ydCgodCxlKT0+dC5sZW5ndGg8ZS5sZW5ndGg/MTp0Lmxlbmd0aD5lLmxlbmd0aD8tMTowKTtsZXQgbD0hMDtmb3IoY29uc3QgdCBvZiBfKXtjb25zdCBpPW5ldyByO2Zvcihjb25zdCBzIG9mIHQpe2NvbnN0IHQ9aChzLGUpLG49dFswXS5hbmdsZVRvKHRbMV0pO2kuYWRkSW5QbGFjZSgobz1zLG5ldyByKGEsMTIqbykpLnNjYWxlKG4pKX1pLm5vcm1hbGl6ZUluUGxhY2UoKSxsPyhuKGUsaSksbD0hMSk6cy5zZXRTcGxpdFZlcnRleFZhbHVlcyhlLHQsaSl9fXZhciBvO3JldHVybiBzfWNvbXB1dGVOdW1UcmlhbmdsZXMoKXtsZXQgdD0zLGU9MDtmb3IoY29uc3QgcyBvZiB0aGlzLl9fZmFjZUNvdW50cyllKz1zKih0LTIpLHQrKztyZXR1cm4gZX1nZW5lcmF0ZVRyaWFuZ3VsYXRlZEluZGljZXModCxlLHMpe2NvbnN0IGE9dGhpcy5jb21wdXRlTnVtVHJpYW5nbGVzKCk7bGV0IGk7aT10PE1hdGgucG93KDIsOCk/bmV3IFVpbnQ4QXJyYXkoMyphKTp0PE1hdGgucG93KDIsMTYpP25ldyBVaW50MTZBcnJheSgzKmEpOm5ldyBVaW50MzJBcnJheSgzKmEpO2xldCByPTA7Y29uc3Qgbj1mdW5jdGlvbih0LGEpe3QgaW4gcyYmYSBpbiBzW3RdJiYodD1lK3NbdF1bYV0pLGlbcl09dCxyKyt9LGg9dGhpcy5nZXROdW1GYWNlcygpO2ZvcihsZXQgdD0wO3Q8aDt0Kyspe2NvbnN0IGU9dGhpcy5nZXRGYWNlVmVydGV4SW5kaWNlcyh0KTtmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKylzPj0zJiYobihlWzBdLHQpLG4oZVtzLTFdLHQpKSxuKGVbc10sdCl9cmV0dXJuIGl9Y29tcHV0ZUhhcmRFZGdlc0luZGljZXModD0xKXtjb25zdCBlPVtdLHM9dD0+e2UucHVzaCh0aGlzLmVkZ2VWZXJ0c1t0XSksZS5wdXNoKHRoaXMuZWRnZVZlcnRzW3QrMV0pfTtmb3IobGV0IGU9MDtlPHRoaXMuZWRnZUZsYWdzLmxlbmd0aDtlKz0yKXRoaXMuZWRnZUFuZ2xlc1tlLzJdPnQmJnMoZSk7cmV0dXJuIGV9Z2V0V2lyZWZyYW1lSW5kaWNlcygpe3JldHVybiBpbmRpY2VzfWdlbkJ1ZmZlcnModCl7Y29uc3QgZT17fTtsZXQgcz0wO2Zvcihjb25zdFssdF1vZiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcyl7Y29uc3QgYT10LmdldFNwbGl0cygpO2Zvcihjb25zdCB0IGluIGEpe3QgaW4gZXx8KGVbdF09e30pO2NvbnN0IGk9YVt0XTtmb3IoY29uc3QgYSBpbiBpKXtjb25zdCBpPXBhcnNlSW50KGEpO2kgaW4gZVt0XXx8KGVbdF1baV09cyxzKyspfX19Y29uc3QgYT10aGlzLnZlcnRpY2VzLmxlbmd0aCxpPWErcztsZXQgcjt0JiYwPT10LmluY2x1ZGVJbmRpY2VzfHwocj10aGlzLmdlbmVyYXRlVHJpYW5ndWxhdGVkSW5kaWNlcyhpLGEsZSkpO2NvbnN0IG49e307Zm9yKGNvbnN0W3QsYV1vZiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcyl7bGV0IGk7aT0wPT1zP2EuZGF0YTphLmdlbmVyYXRlU3BsaXRWYWx1ZXMoZSxzKTtjb25zdCByPWEubnVtRWxlbWVudHMsaD1pLmxlbmd0aC9yO25bdF09e3ZhbHVlczppLGNvdW50OmgsZGltZW5zaW9uOnIsbm9ybWFsaXplZDoibm9ybWFscyI9PXQsZGF0YVR5cGU6YS5kYXRhVHlwZX19Y29uc3QgaD17bnVtVmVydGljZXM6dGhpcy5udW1WZXJ0aWNlcygpLG51bVJlbmRlclZlcnRzOmksaW5kaWNlczpyLGF0dHJCdWZmZXJzOm59O2lmKHQmJnQuaW5jbHVkZVZlcnRleE5laWdoYm9ycyl7bnVsbD09dGhpcy52ZXJ0ZXhFZGdlcyYmdGhpcy5nZW5Ub3BvbG9neUluZm8oKTtsZXQgdD0wO2ZvcihsZXQgZT0wO2U8dGhpcy52ZXJ0ZXhFZGdlcy5sZW5ndGg7ZSsrKXRoaXMudmVydGV4RWRnZXNbZV0mJih0Kz10aGlzLnZlcnRleEVkZ2VzW2VdLnNpemUpO2NvbnN0IGU9bmV3IFVpbnQzMkFycmF5KDIqdGhpcy52ZXJ0ZXhFZGdlcy5sZW5ndGgrdCkscz10PT57Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDtlKyspe2NvbnN0IHM9dFtlXTtmb3IobGV0IGE9MDthPGU7YSsrKXtjb25zdCBpPXRbYV07aWYoLTEhPXNbMF0mJnNbMF09PWlbMV0pe2UhPWErMSYmKHQuc3BsaWNlKGUsMSksdC5zcGxpY2UoYSsxLDAscykpO2JyZWFrfWlmKC0xIT1zWzFdJiZzWzFdPT1pWzBdKXt0LnNwbGljZShlLDEpLHQuc3BsaWNlKGEsMCxzKTticmVha319fX0sYT10PT57aWYoISgtMSE9dFswXVswXSYmLTEhPXRbdC5sZW5ndGgtMV1bMV18fC0xPT10WzBdWzBdJiYtMT09dFt0Lmxlbmd0aC0xXVsxXSkpdGhyb3cgbmV3IEVycm9yKCJJZiBmYW4gc3RhcnRzIHdpdGggLTEsIGl0IG11c3QgYWxzbyBlbmQgd2l0aCAtMSIpO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKXtjb25zdCBzPXRbZV07aWYoKC0xPT1zWzBdfHwtMT09c1sxXSkmJjAhPWUmJmUhPXQubGVuZ3RoLTEpdGhyb3cgbmV3IEVycm9yKCItMSBvbmx5IGFsbG93ZWQgYXQgdGhlIGJlZ2lubmluZyBhbmQgZW5kIG9mIGEgZmFuLiIpO2lmKC0xIT1zWzBdKXtsZXQgYT1lLTE7aWYoYTwwJiYoYSs9dC5sZW5ndGgpLHNbMF0hPXRbYV1bMV0pdGhyb3cgbmV3IEVycm9yKCJGYWNlcyBhcmUgbm90IHNlcXVlbnRpYWwiKX1pZigtMSE9c1sxXSl7Y29uc3QgYT0oZSsxKSV0Lmxlbmd0aDtpZihzWzFdIT10W2FdWzBdKXRocm93IG5ldyBFcnJvcigiRmFjZXMgYXJlIG5vdCBzZXF1ZW50aWFsIil9fX07bGV0IGk9Mip0aGlzLnZlcnRleEVkZ2VzLmxlbmd0aDtmb3IobGV0IHQ9MDt0PHRoaXMudmVydGV4RWRnZXMubGVuZ3RoO3QrKyl7aWYobnVsbD09dGhpcy52ZXJ0ZXhFZGdlc1t0XSljb250aW51ZTtjb25zdCByPXRoaXMudmVydGV4RWRnZXNbdF0sbj1bXTtmb3IoY29uc3QgZSBvZiByKXtjb25zdCBzPXRoaXMuZWRnZVZlcnRzWzIqZV0sYT10aGlzLmVkZ2VWZXJ0c1syKmUrMV07bGV0IGkscj10aGlzLmVkZ2VGYWNlc1syKmVdLGg9dGhpcy5lZGdlRmFjZXNbMiplKzFdO2lmKHM9PXQpaT1hO2Vsc2V7aWYoYSE9dCl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgdG9wb2xvZ3kiKTt7aT1zO2NvbnN0IHQ9cjtyPWgsaD10fX1uLnB1c2goW3IsaCxpXSl9cyhuKSxhKG4pO2xldCBoPTA7KC0xIT1uWzBdWzBdfHwtMSE9bltuLmxlbmd0aC0xXVsxXSkmJihoKz0xKSxlWzIqdF09aSxlWzIqdCsxXT1yLnNpemUrKGg8PDgpO2Zvcihjb25zdCB0IG9mIG4pZVtpXT10WzJdLGkrK31oLnZlcnRleE5laWdoYm9ycz1lfXJldHVybiBofWZyZWVCdWZmZXJzKCl7c3VwZXIuZnJlZUJ1ZmZlcnMoKSx0aGlzLmluaXQoKX1yZWFkQmluYXJ5KHQsZSl7c3VwZXIubG9hZEJhc2VHZW9tQmluYXJ5KHQpLHRoaXMuc2V0RmFjZUNvdW50cyh0LmxvYWRVSW50MzJBcnJheSgpKSx0aGlzLl9fZmFjZVZlcnRleENvdW50cz10LmxvYWRVSW50OEFycmF5KHRoaXMuX19mYWNlVmVydGV4Q291bnRzLmxlbmd0aCk7Y29uc3Qgcz10LmxvYWRTSW50MzJWZWMyKCksYT10LmxvYWRVSW50OCgpO2xldCByOzE9PWE/cj10LmxvYWRVSW50OEFycmF5KCk6Mj09YT9yPXQubG9hZFVJbnQxNkFycmF5KCk6ND09YSYmKHI9dC5sb2FkVUludDMyQXJyYXkoKSk7Y29uc3Qgbj10aGlzLmdldE51bUZhY2VzKCk7bGV0IGg9MCxvPTA7Zm9yKGxldCB0PTA7dDxuO3QrKyl7Y29uc3QgZT10aGlzLl9fZmFjZVZlcnRleENvdW50c1t0XSszO3RoaXMuX19mYWNlT2Zmc2V0c1t0XT1oO2ZvcihsZXQgYT0wO2E8ZTthKyspe2NvbnN0IGU9aCthLGk9cltlXStzLng7aWYoMD09dCl0aGlzLl9fZmFjZVZlcnRleEluZGljZXNbZV09aTtlbHNle2xldCBzPXRoaXMuX19mYWNlT2Zmc2V0c1t0LTFdO3MrPWE8bz9hOm8tMSx0aGlzLl9fZmFjZVZlcnRleEluZGljZXNbZV09dGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzW3NdK2l9fWgrPWUsbz1lfXRoaXMuX19udW1Qb3B1bGF0ZWRGYWNlVmVydGV4SW5kaWNlcz1oO2NvbnN0IF89dC5sb2FkVUludDMyKCk7aWYoXz4wKXtjb25zdCBlPXRoaXMudmVydGljZXMscz10aGlzLmFkZFZlcnRleEF0dHJpYnV0ZSgibGlnaHRtYXBDb29yZHMiLGkpO2ZvcihsZXQgYT0wO2E8XzthKyspe2NvbnN0IGE9bmV3IG0odC5sb2FkRmxvYXQzMlZlYzMoKSx0LmxvYWRGbG9hdDMyUXVhdCgpKSxyPXQubG9hZEZsb2F0MzIoKSxuPXQubG9hZEZsb2F0MzJWZWMyKCksaD10LmxvYWRTSW50MzJWZWMyKCksbz10LmxvYWRVSW50OCgpO2xldCBfO189MT09bz90LmxvYWRVSW50OEFycmF5KCk6Mj09bz90LmxvYWRVSW50MTZBcnJheSgpOnQubG9hZFVJbnQzMkFycmF5KCk7bGV0IGQ9MDtmb3IoY29uc3QgdCBvZiBfKXtsZXQgbz10K2gueDtvKz1kLGQ9bztjb25zdCBfPXRoaXMuZ2V0RmFjZVZlcnRleEluZGljZXMobyk7Zm9yKGNvbnN0IHQgb2YgXyl7Y29uc3QgaD1lLmdldFZhbHVlUmVmKHQpLF89YS50cmFuc2Zvcm1WZWMzKGgpLGQ9bmV3IGkoXy54LF8ueik7ZC5zY2FsZUluUGxhY2UociksZC5hZGRJblBsYWNlKG4pLHMuc2V0RmFjZVZlcnRleFZhbHVlX0J5VmVydGV4SW5kZXgobyx0LGQpfX19fXRoaXMuaGFzVmVydGV4QXR0cmlidXRlKCJub3JtYWxzIil8fHRoaXMuY29tcHV0ZVZlcnRleE5vcm1hbHMoKSx0aGlzLmVtaXQoImdlb21EYXRhQ2hhbmdlZCIse30pfXRvSlNPTih0LGUpe2NvbnN0IHM9c3VwZXIudG9KU09OKHQsZSk7cmV0dXJuIDEwMjQmZXx8KHMuZmFjZUNvdW50cz1BcnJheS5mcm9tKHRoaXMuX19mYWNlQ291bnRzKSxzLmZhY2VWZXJ0ZXhJbmRpY2VzPUFycmF5LmZyb20odGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzKSksc31mcm9tSlNPTih0LGUscyl7c3VwZXIuZnJvbUpTT04odCxlLHMpLHQuZmFjZUNvdW50cyYmKHRoaXMuX19mYWNlQ291bnRzPVVpbnQzMkFycmF5LmZyb20odC5mYWNlQ291bnRzKSksdC5mYWNlVmVydGV4SW5kaWNlcyYmKHRoaXMuX19mYWNlVmVydGV4SW5kaWNlcz1VaW50MzJBcnJheS5mcm9tKHQuZmFjZVZlcnRleEluZGljZXMpKX19Y2xhc3MgRXtjb25zdHJ1Y3Rvcih0LGU9MCxzPSEwKXt0aGlzLl9fZGF0YT10LHRoaXMuX19ieXRlT2Zmc2V0PWUsdGhpcy5fX2RhdGFWaWV3PW5ldyBEYXRhVmlldyh0aGlzLl9fZGF0YSksdGhpcy5fX2lzTW9iaWxlRGV2aWNlPXMsdGhpcy51dGY4ZGVjb2Rlcj1uZXcgVGV4dERlY29kZXJ9Z2V0IGlzTW9iaWxlRGV2aWNlKCl7cmV0dXJuIHRoaXMuX19pc01vYmlsZURldmljZX1nZXQgZGF0YSgpe3JldHVybiB0aGlzLl9fZGF0YX1nZXQgYnl0ZUxlbmd0aCgpe3JldHVybiB0aGlzLl9fZGF0YVZpZXcuYnl0ZUxlbmd0aH1nZXQgcmVtYWluaW5nQnl0ZUxlbmd0aCgpe3JldHVybiB0aGlzLl9fZGF0YVZpZXcuYnl0ZUxlbmd0aC10aGlzLl9fYnl0ZU9mZnNldH1wb3MoKXtyZXR1cm4gdGhpcy5fX2J5dGVPZmZzZXR9c2Vlayh0KXt0aGlzLl9fYnl0ZU9mZnNldD10fWFkdmFuY2UodCl7dGhpcy5fX2J5dGVPZmZzZXQrPXR9bG9hZFVJbnQ4KCl7Y29uc3QgdD10aGlzLl9fZGF0YVZpZXcuZ2V0VWludDgodGhpcy5fX2J5dGVPZmZzZXQpO3JldHVybiB0aGlzLl9fYnl0ZU9mZnNldCs9MSx0fWxvYWRVSW50MTYoKXtjb25zdCB0PXRoaXMuX19kYXRhVmlldy5nZXRVaW50MTYodGhpcy5fX2J5dGVPZmZzZXQsITApO3JldHVybiB0aGlzLl9fYnl0ZU9mZnNldCs9Mix0fWxvYWRVSW50MzIoKXtjb25zdCB0PXRoaXMuX19kYXRhVmlldy5nZXRVaW50MzIodGhpcy5fX2J5dGVPZmZzZXQsITApO3JldHVybiB0aGlzLl9fYnl0ZU9mZnNldCs9NCx0fWxvYWRTSW50MzIoKXtjb25zdCB0PXRoaXMuX19kYXRhVmlldy5nZXRJbnQzMih0aGlzLl9fYnl0ZU9mZnNldCwhMCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz00LHR9bG9hZEZsb2F0MTYoKXtjb25zdCB0PXRoaXMubG9hZFVJbnQxNigpO3JldHVybiBNYXRoLmRlY29kZTE2Qml0RmxvYXQodCl9bG9hZFVGbG9hdDE2KCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDE2KCk7cmV0dXJuIHQ8MD8yMDQ4LXQ6dH1sb2FkRmxvYXQxNkZyb20yeFVJbnQ4KCl7Y29uc3QgdD10aGlzLl9fZGF0YVZpZXcuZ2V0RmxvYXQxNih0aGlzLl9fYnl0ZU9mZnNldCwhMCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz0yLHR9bG9hZFVJbnQzMkZyb20yeFVGbG9hdDE2KCl7cmV0dXJuIHRoaXMubG9hZFVGbG9hdDE2KCkrNDA5Nip0aGlzLmxvYWRVRmxvYXQxNigpfWxvYWRTSW50MzJGcm9tMnhGbG9hdDE2KCl7cmV0dXJuIHRoaXMubG9hZEZsb2F0MTYoKSsyMDQ4KnRoaXMubG9hZEZsb2F0MTYoKX1sb2FkRmxvYXQzMigpe2NvbnN0IHQ9dGhpcy5fX2RhdGFWaWV3LmdldEZsb2F0MzIodGhpcy5fX2J5dGVPZmZzZXQsITApO3JldHVybiB0aGlzLl9fYnl0ZU9mZnNldCs9NCx0fWxvYWRVSW50OEFycmF5KHQsZT0hMSl7bnVsbD09dCYmKHQ9dGhpcy5sb2FkVUludDMyKCkpO2NvbnN0IHM9bmV3IFVpbnQ4QXJyYXkodGhpcy5fX2RhdGEsdGhpcy5fX2J5dGVPZmZzZXQsdCk7dGhpcy5fX2J5dGVPZmZzZXQrPXQ7dGhpcy5fX2J5dGVPZmZzZXQ7cmV0dXJuIHN9bG9hZFVJbnQxNkFycmF5KHQsZT0hMSl7aWYobnVsbD09dCYmKHQ9dGhpcy5sb2FkVUludDMyKCkpLDA9PXQpcmV0dXJuIG5ldyBVaW50MTZBcnJheTtsZXQgcztpZih0aGlzLnJlYWRQYWRkKDIpLHRoaXMuX19pc01vYmlsZURldmljZSl7cz1uZXcgVWludDE2QXJyYXkodCk7Zm9yKGxldCBlPTA7ZTx0O2UrKylzW2VdPXRoaXMuX19kYXRhVmlldy5nZXRVaW50MTYodGhpcy5fX2J5dGVPZmZzZXQsITApLHRoaXMuX19ieXRlT2Zmc2V0Kz0yfWVsc2Ugcz1uZXcgVWludDE2QXJyYXkodGhpcy5fX2RhdGEsdGhpcy5fX2J5dGVPZmZzZXQsdCksdGhpcy5fX2J5dGVPZmZzZXQrPTIqdDtyZXR1cm4gc31sb2FkVUludDMyQXJyYXkodCxlPSExKXtpZihudWxsPT10JiYodD10aGlzLmxvYWRVSW50MzIoKSksMD09dClyZXR1cm4gbmV3IFVpbnQzMkFycmF5O2xldCBzO2lmKHRoaXMucmVhZFBhZGQoNCksdGhpcy5fX2lzTW9iaWxlRGV2aWNlKXtzPW5ldyBVaW50MzJBcnJheSh0KTtmb3IobGV0IGU9MDtlPHQ7ZSsrKXNbZV09dGhpcy5fX2RhdGFWaWV3LmdldFVpbnQzMih0aGlzLl9fYnl0ZU9mZnNldCwhMCksdGhpcy5fX2J5dGVPZmZzZXQrPTR9ZWxzZSBzPW5ldyBVaW50MzJBcnJheSh0aGlzLl9fZGF0YSx0aGlzLl9fYnl0ZU9mZnNldCx0KSx0aGlzLl9fYnl0ZU9mZnNldCs9NCp0O3JldHVybiBzfWxvYWRGbG9hdDMyQXJyYXkodCxlPSExKXtpZihudWxsPT10JiYodD10aGlzLmxvYWRVSW50MzIoKSksMD09dClyZXR1cm4gbmV3IEZsb2F0MzJBcnJheTtsZXQgcztpZih0aGlzLnJlYWRQYWRkKDQpLHRoaXMuX19pc01vYmlsZURldmljZSl7cz1uZXcgRmxvYXQzMkFycmF5KHQpO2ZvcihsZXQgZT0wO2U8dDtlKyspc1tlXT10aGlzLl9fZGF0YVZpZXcuZ2V0RmxvYXQzMih0aGlzLl9fYnl0ZU9mZnNldCwhMCksdGhpcy5fX2J5dGVPZmZzZXQrPTR9ZWxzZSBzPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5fX2RhdGEsdGhpcy5fX2J5dGVPZmZzZXQsdCksdGhpcy5fX2J5dGVPZmZzZXQrPTQqdDtyZXR1cm4gc31sb2FkU3RyKCl7Y29uc3QgdD10aGlzLmxvYWRVSW50MzIoKSxlPW5ldyBVaW50OEFycmF5KHRoaXMuX19kYXRhLHRoaXMuX19ieXRlT2Zmc2V0LHQpO3JldHVybiB0aGlzLl9fYnl0ZU9mZnNldCs9dCx0aGlzLnV0ZjhkZWNvZGVyLmRlY29kZShlKX1sb2FkU3RyQXJyYXkoKXtjb25zdCB0PXRoaXMubG9hZFVJbnQzMigpLGU9W107Zm9yKGxldCBzPTA7czx0O3MrKyllW3NdPXRoaXMubG9hZFN0cigpO3JldHVybiBlfWxvYWRTSW50MzJWZWMyKCl7Y29uc3QgdD10aGlzLmxvYWRTSW50MzIoKSxlPXRoaXMubG9hZFNJbnQzMigpO3JldHVybiBuZXcgaSh0LGUpfWxvYWRVSW50MzJWZWMyKCl7Y29uc3QgdD10aGlzLmxvYWRVSW50MzIoKSxlPXRoaXMubG9hZFVJbnQzMigpO3JldHVybiBuZXcgaSh0LGUpfWxvYWRGbG9hdDE2VmVjMigpe2NvbnN0IHQ9dGhpcy5sb2FkRmxvYXQxNigpLGU9dGhpcy5sb2FkRmxvYXQxNigpO3JldHVybiBuZXcgaSh0LGUpfWxvYWRGbG9hdDMyVmVjMigpe2NvbnN0IHQ9dGhpcy5sb2FkRmxvYXQzMigpLGU9dGhpcy5sb2FkRmxvYXQzMigpO3JldHVybiBuZXcgaSh0LGUpfWxvYWRGbG9hdDE2VmVjMygpe2NvbnN0IHQ9dGhpcy5sb2FkRmxvYXQxNigpLGU9dGhpcy5sb2FkRmxvYXQxNigpLHM9dGhpcy5sb2FkRmxvYXQxNigpO3JldHVybiBuZXcgcih0LGUscyl9bG9hZEZsb2F0MzJWZWMzKCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDMyKCksZT10aGlzLmxvYWRGbG9hdDMyKCkscz10aGlzLmxvYWRGbG9hdDMyKCk7cmV0dXJuIG5ldyByKHQsZSxzKX1sb2FkRmxvYXQxNlF1YXQoKXtjb25zdCB0PXRoaXMubG9hZEZsb2F0MTYoKSxlPXRoaXMubG9hZEZsb2F0MTYoKSxzPXRoaXMubG9hZEZsb2F0MTYoKSxhPXRoaXMubG9hZEZsb2F0MTYoKTtyZXR1cm4gbmV3IHUodCxlLHMsYSl9bG9hZEZsb2F0MzJRdWF0KCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDMyKCksZT10aGlzLmxvYWRGbG9hdDMyKCkscz10aGlzLmxvYWRGbG9hdDMyKCksYT10aGlzLmxvYWRGbG9hdDMyKCk7cmV0dXJuIG5ldyB1KHQsZSxzLGEpfWxvYWRSR0JGbG9hdDMyQ29sb3IoKXtjb25zdCB0PXRoaXMubG9hZEZsb2F0MzIoKSxlPXRoaXMubG9hZEZsb2F0MzIoKSxzPXRoaXMubG9hZEZsb2F0MzIoKTtyZXR1cm4gbmV3IG8odCxlLHMpfWxvYWRSR0JBRmxvYXQzMkNvbG9yKCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDMyKCksZT10aGlzLmxvYWRGbG9hdDMyKCkscz10aGlzLmxvYWRGbG9hdDMyKCksYT10aGlzLmxvYWRGbG9hdDMyKCk7cmV0dXJuIG5ldyBvKHQsZSxzLGEpfWxvYWRSR0JVSW50OENvbG9yKCl7Y29uc3QgdD10aGlzLmxvYWRVSW50OCgpLGU9dGhpcy5sb2FkVUludDgoKSxzPXRoaXMubG9hZFVJbnQ4KCk7cmV0dXJuIG5ldyBvKHQvMjU1LGUvMjU1LHMvMjU1KX1sb2FkUkdCQVVJbnQ4Q29sb3IoKXtjb25zdCB0PXRoaXMubG9hZFVJbnQ4KCksZT10aGlzLmxvYWRVSW50OCgpLHM9dGhpcy5sb2FkVUludDgoKSxhPXRoaXMubG9hZFVJbnQ4KCk7cmV0dXJuIG5ldyBvKHQvMjU1LGUvMjU1LHMvMjU1LGEvMjU1KX1sb2FkQm94Migpe3JldHVybiBuZXcgZyh0aGlzLmxvYWRGbG9hdDMyVmVjMigpLHRoaXMubG9hZEZsb2F0MzJWZWMyKCkpfWxvYWRCb3gzKCl7cmV0dXJuIG5ldyBwKHRoaXMubG9hZEZsb2F0MzJWZWMzKCksdGhpcy5sb2FkRmxvYXQzMlZlYzMoKSl9cmVhZFBhZGQodCl7Y29uc3QgZT10aGlzLl9fYnl0ZU9mZnNldCV0OzAhPWUmJih0aGlzLl9fYnl0ZU9mZnNldCs9dC1lKX19Y2xhc3MgUHtjb25zdHJ1Y3Rvcih0KXtpZih0KXtjb25zdCBlPXQuc3BsaXQoIi0iKSxzPWVbMF0uc3BsaXQoIi4iKTt0aGlzLm1ham9yPXBhcnNlSW50KHNbMF0pLHRoaXMubWlub3I9cGFyc2VJbnQoc1sxXSksdGhpcy5wYXRjaD1wYXJzZUludChzWzJdKSwyPT1lLmxlbmd0aCYmKHRoaXMuYnJhbmNoPWVbMV0pfWVsc2UgdGhpcy5tYWpvcj0wLHRoaXMubWlub3I9MCx0aGlzLnBhdGNoPTB9Y29tcGFyZSh0KXtjb25zdCBlPVt0aGlzLm1ham9yLHRoaXMubWlub3IsdGhpcy5wYXRjaF07Zm9yKGxldCBzPTA7czwzO3MrKylpZihlW3NdIT09dFtzXSlyZXR1cm4gZVtzXS10W3NdO3JldHVybiAwfWVxdWFscyh0KXtyZXR1cm4hKHRoaXMucGF0Y2g9PXRbMl0mJnRoaXMubWlub3I9PXRbMV0mJnRoaXMubWFqb3I9PXRbMF0pfWxlc3NUaGFuKHQpe3JldHVybiEodGhpcy5tYWpvcj49dFswXXx8dGhpcy5taW5vcj49dFsxXXx8dGhpcy5wYXRjaD49dFsyXSl9Z3JlYXRlclRoYW4odCl7cmV0dXJuIHRoaXMubWFqb3I+dFswXXx8dGhpcy5taW5vcj50WzFdfHx0aGlzLnBhdGNoPnRbMl19Z3JlYXRlck9yRXF1YWxUaGFuKHQpe3JldHVybiEodGhpcy5tYWpvcjx0WzBdKSYmKHRoaXMubWFqb3I+dFswXXx8ISh0aGlzLm1pbm9yPHRbMV0pJiYodGhpcy5taW5vcj50WzFdfHwhKHRoaXMucGF0Y2g8dFsyXSkpKX19c2VsZi5vbm1lc3NhZ2U9ZnVuY3Rpb24odCl7KCh0LGUpPT57Zm9yKGxldCBlIGluIHQuY29udGV4dC52ZXJzaW9ucyl7Y29uc3Qgcz10LmNvbnRleHQudmVyc2lvbnNbZV0sYT1uZXcgUDthLm1ham9yPXMubWFqb3IsYS5taW5vcj1zLm1pbm9yLGEucGF0Y2g9cy5wYXRjaCxhLmJyYW5jaD1zLmJyYW5jaCx0LmNvbnRleHQudmVyc2lvbnNbZV09YX1jb25zdCBzPVtdLGk9dC50b2NbdC5nZW9tc1JhbmdlWzBdXSxyPVtdO2ZvcihsZXQgZT10Lmdlb21zUmFuZ2VbMF07ZTx0Lmdlb21zUmFuZ2VbMV07ZSsrKXtjb25zdCBuPW5ldyBFKHQuYnVmZmVyU2xpY2UsdC50b2NbZV0taSx0LmlzTW9iaWxlRGV2aWNlKSxoPW4ubG9hZFN0cigpLG89bi5wb3MoKTtsZXQgXztzd2l0Y2goaCl7Y2FzZSJQb2ludHMiOl89bmV3IE07YnJlYWs7Y2FzZSJMaW5lcyI6Xz1uZXcgQTticmVhaztjYXNlIk1lc2giOl89bmV3IE87YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIlVuc3VwcG9ydGVkIEdlb20gdHlwZToiK2gpfXRyeXtuLnNlZWsobyksXy5yZWFkQmluYXJ5KG4sdC5jb250ZXh0KX1jYXRjaCh0KXtjb25zb2xlLndhcm4oIkVycm9yIGxvYWRpbmc6IitfLm5hbWUrIlxuOiIrdCkscy5wdXNoKHt9KTtjb250aW51ZX1jb25zdCBkPV8uZ2VuQnVmZmVycyh0LmdlbkJ1ZmZlcnNPcHRzKTtkLmluZGljZXMmJnIucHVzaChkLmluZGljZXMuYnVmZmVyKTtmb3IoY29uc3QgdCBpbiBkLmF0dHJCdWZmZXJzKXtjb25zdCBlPWQuYXR0ckJ1ZmZlcnNbdF0scz1hLmdldFR5cGVOYW1lKGUuZGF0YVR5cGUpO2UuZGF0YVR5cGU9cyxyLnB1c2goZS52YWx1ZXMuYnVmZmVyKX1kLnZlcnRleE5laWdoYm9ycyYmci5wdXNoKGQudmVydGV4TmVpZ2hib3JzLmJ1ZmZlciksci5wdXNoKF8uYm91bmRpbmdCb3gucDAuX19kYXRhLmJ1ZmZlciksci5wdXNoKF8uYm91bmRpbmdCb3gucDEuX19kYXRhLmJ1ZmZlcikscy5wdXNoKHtuYW1lOl8ubmFtZSx0eXBlOmgsZ2VvbUJ1ZmZlcnM6ZCxiYm94Ol8uYm91bmRpbmdCb3h9KX1lKHtrZXk6dC5rZXksZ2VvbUluZGV4T2Zmc2V0OnQuZ2VvbUluZGV4T2Zmc2V0LGdlb21zUmFuZ2U6dC5nZW9tc1JhbmdlLGdlb21EYXRhczpzfSxyKX0pKHQuZGF0YSwodCxlKT0+e3NlbGYucG9zdE1lc3NhZ2UodCxlKX0pfTsKCg==",null,!1);class ba extends Y{constructor(){super(),this.__streamInfos={},this.__genBuffersOpts={},this.__workers=[],this.__nextWorker=0;for(let t=0;t<3;t++)this.__workers.push(this.__constructWorker());this.clear()}clear(){this.__loaded=0,this.__numGeoms=0,this.geoms=[]}__constructWorker(){const t=new ua;return t.onmessage=t=>{this.__recieveGeomDatas(t.data.key,t.data.geomDatas,t.data.geomIndexOffset,t.data.geomsRange)},t}__terminateWorkers(){for(const t of this.__workers)t.terminate();this.__workers=[]}setGenBufferOption(t,e){this.__genBuffersOpts[t]=e}setNumGeoms(t){this.__numGeoms=t}getGeom(t){return t>=this.geoms.length?null:this.geoms[t]}loadUrl(t){re$1(t,t=>{this.loadBin(t)},t=>{console.warn(t)})}readBinaryBuffer(e,i,n){const s=t.isMobileDevice,o=new ge(i,0,s),r=o.loadUInt32(),a=o.loadUInt32();if(this.__streamInfos[e]={total:r,done:0},0==r)return this.emit("streamFileParsed",{}),r;0==this.__numGeoms&&(this.__numGeoms=r);const l=o.loadUInt32Array(r);let c=window.navigator.hardwareConcurrency;c||(c=s?2:4);const h=Math.max(1,Math.floor(r/c+1));let d=0;for(;d<r;){let t,s;d+h>=r?(s=[d,r],t=i.byteLength):(s=[d,d+h],t=l[s[1]]);const c=i.slice(l[d],t);d+=h,this.__workers[this.__nextWorker].postMessage({key:e,toc:l,geomIndexOffset:a,geomsRange:s,isMobileDevice:o.isMobileDevice,bufferSlice:c,genBuffersOpts:this.__genBuffersOpts,context:n},[c]),this.__nextWorker=(this.__nextWorker+1)%this.__workers.length}return r}__recieveGeomDatas(t,e,i,n){const s=i+n[0],o=[s,i+n[1]];for(let l=0;l<e.length;l++){const t=e[l];if(!t.type)continue;let i;switch(t.type){case"Points":i=new wt(t);break;case"Lines":i=new zt(t);break;case"Mesh":case"Plane":case"Sphere":case"Cone":i=new Ut(t);break;default:throw new Error("Unsupported Geom type:"+className)}this.geoms[s+l]=i}this.emit("rangeLoaded",{range:o});const r=o[1]-o[0],a=this.__streamInfos[t];a.done+=r,a.done==a.total&&this.emit("streamFileParsed",{count:1}),this.__loaded+=r,this.__loaded==this.__numGeoms&&(this.__terminateWorkers(),this.emit("loaded"))}toJSON(){return{numGeoms:this.geoms.length()}}toString(){return JSON.stringify(this.toJSON(),null,2)}}class pa extends na{constructor(t){super(t),this.__geomLibrary=new ba,this.__materials=new St,this.loaded=!1}isLoaded(){return this.loaded}getEngineDataVersion(){return this.__engineDataVersion}getGeometryLibrary(){return this.__geomLibrary}getMaterialLibrary(){return this.__materials}getUnitsConversion(){return this.__unitsScale}readBinary(t,e={}){let i;e.assetItem=this,e.numTreeItems=0,e.numGeomItems=0,e.versions["zea-engine"]||(e.versions["zea-engine"]=new pe(t.loadStr())),this.__engineDataVersion=e.versions["zea-engine"],console.log("Loading Engine File version:",e.versions["zea-engine"]);const n={};e.addGeomToLayer=(t,e)=>{if(!n[e]){i||(i=new na("Layers"),this.addChild(i,!1));const t=new ma(e);t.propagateXfoToItems=!1,i.addChild(t,!1),n[e]=t}n[e].addItem(t)};const s=()=>{this.__units=t.loadStr();let e=1;switch(this.__units){case"Millimeters":e=.001;break;case"Centimeters":e=.01;break;case"Meters":e=1;break;case"Kilometers":e=1e3;break;case"Inches":e=.0254;break;case"Feet":e=.3048;break;case"Miles":e=1609.34}this.__unitsScale=e;const i=this.getLocalXfo().clone();i.sc.scaleInPlace(e),this.setLocalXfo(i)};e.versions["zea-engine"].greaterThan([0,0,6])&&s(),this.__materials.readBinary(t,e),super.readBinary(t,e),e.versions["zea-engine"].greaterOrEqualThan([0,0,5])&&e.versions["zea-engine"].lessThan([0,0,7])&&s()}toJSON(t={},e=0){return t.makeRelative=t=>{const e=this.getPath(),i=t.slice(0,e.length);for(let s=0;s<i.length-1;s++)if(i[s]!=e[s])return console.warn("Param Path is not relative to the asset. May not be able to be resolved at load time:"+t),t;const n=t.slice(e.length-1);return n[0]=".",n},t.assetItem=this,super.toJSON(t,e)}fromJSON(t,e={},i=0,n){e||(e={}),e.assetItem=this,e.numTreeItems=0,e.numGeomItems=0,null==e.version&&(e.version=0),e.assetItem=this;const s=[];e.resolvePath=(t,e)=>{if(!t)throw new Error("Path not spcecified");const i=this.resolvePath(t);i?e(i):s.push(()=>{const i=this.resolvePath(t);i?e(i):console.warn("Path unable to be resolved:"+t)})},e.addPLCB=t=>s.push(t),super.fromJSON(t,e,i);for(const o of s)o();n&&n()}}J.registerClass("AssetItem",pa);class ga extends na{constructor(t,e){super(t);const i=this.addParameter(new Le("Image"));e&&i.setValue(e),this.addParameter(new Ze("PixelsPerMeter",1e3)),this.addParameter(new Ze("Alpha",1)),this.addParameter(new Ie("Color",new y$2(1,1,1))),this.addParameter(new Xe("AlignedToCamera",!1)),this.addParameter(new Xe("DrawOnTop",!1))}}J.registerClass("BillboardItem",ga);class _a extends na{constructor(t){null==t&&(t="Camera"),super(t),this.__isOrthographicParam=this.addParameter(new Xe("isOrthographic",!1)),this.__fovParam=this.addParameter(new Ze("fov",1)),this.__nearParam=this.addParameter(new Ze("near",.1)),this.__farParam=this.addParameter(new Ze("far",1e3)),this.__focalDistanceParam=this.addParameter(new Ze("focalDistance",5));const e=t=>{this.emit("projectionParamChanged",t)};this.__isOrthographicParam.addListener("valueChanged",e),this.__fovParam.addListener("valueChanged",e),this.__nearParam.addListener("valueChanged",e),this.__farParam.addListener("valueChanged",e),this.setPositionAndTarget(new Z(3,3,1.75),new Z(0,0,1),E.GENERATED_VALUE),this.setLensFocalLength("28mm",E.GENERATED_VALUE)}getNear(){return this.__nearParam.getValue()}setNear(t){this.__nearParam.setValue(t)}getFar(){return this.__farParam.getValue()}setFar(t){this.__farParam.setValue(t)}getFov(){return this.__fovParam.getValue()}setFov(t){this.__fovParam.setValue(t)}setLensFocalLength(t,e=E.USER_SETVALUE){const i={"10mm":100.4,"11mm":95,"12mm":90,"14mm":81.2,"15mm":77.3,"17mm":70.4,"18mm":67.4,"19mm":64.6,"20mm":61.9,"24mm":53.1,"28mm":46.4,"30mm":43.6,"35mm":37.8,"45mm":29.9,"50mm":27,"55mm":24.6,"60mm":22.6,"70mm":19.5,"75mm":18.2,"80mm":17.1,"85mm":16.1,"90mm":15.2,"100mm":13.7,"105mm":13,"120mm":11.4,"125mm":11,"135mm":10.2,"150mm":9.1,"170mm":8.1,"180mm":7.6,"210mm":6.5,"300mm":4.6,"400mm":3.4,"500mm":2.7,"600mm":2.3,"800mm":1.7};!t in i?console.warn("Camera lense focal length not suported:"+t):this.__fovParam.setValue(Math.degToRad(i[t]),e)}getFocalDistance(){return this.__focalDistanceParam.getValue()}setFocalDistance(t,e=E.USER_SETVALUE){t<1e-4&&console.error("Never set focal distance to zero"),this.__focalDistanceParam.setValue(t,e),this.__nearParam.setValue(.01*t,e),this.__farParam.setValue(200*t,e)}getIsOrthographic(){return this.__isOrthographicParam.getValue()}setIsOrthographic(t,e=E.USER_SETVALUE){this.__isOrthographicParam.setValue(t,e)}setPositionAndTarget(t,e,i=E.USER_SETVALUE){this.setFocalDistance(t.distanceTo(e),i);const n=new S;n.setLookAt(t,e,new Z(0,0,1)),this.setGlobalXfo(n,i)}getTargetPostion(){const t=this.__focalDistanceParam.getValue(),e=this.getGlobalXfo(),i=e.ori.getZaxis();return i.scaleInPlace(-t),i.addInPlace(e.tr),i}frameView(t,e,i=E.USER_SETVALUE){const n=new v;for(const y of e)n.addBox3(y.getBoundingBox());if(!n.isValid())return void console.warn("Bounding box not valid.");const s=this.__focalDistanceParam.getValue(),o=this.__fovParam.getValue(),r=this.getGlobalXfo().clone(),a=r.ori.getZaxis(),l=a.scale(-s),c=r.tr.add(l),h=n.center().subtract(c);r.tr.addInPlace(h);const d=new v;d.addBox3(n,r.inverse()),d.center();const u=o*(t.getWidth()/t.getHeight()),m=d.p1,p=Math.abs(m.x)/Math.tan(.5*u)*1.2,b=Math.abs(m.y)/Math.tan(.5*o)*1.2,f=-.5*(d.p0.z-d.p1.z),g=Math.max(p,b)+f;r.tr.addInPlace(a.scale(g-s)),this.setFocalDistance(g,i),this.setGlobalXfo(r,i),this.emit("movementFinished",{mode:i})}updateProjectionMatrix(t,e){this.__isOrthographicParam.getValue();const i=this.__fovParam.getValue(),n=this.__nearParam.getValue(),s=this.__farParam.getValue();t.setPerspectiveMatrix(i,e,n,s)}}J.registerClass("Camera",_a);class Za extends te{constructor(t){super(t),this.addParameter(new Ie("BackgroundColor",new y$2("#808080"))),this.addParameter(new Le("EnvMap")),this.addParameter(new Xe("Display EnvMap",!1)),this.addParameter(new Ze("EnvMapLOD",0))}}class Ga extends pa{constructor(t){super(t),this.loaded=!1,this.lightmap=null,this.geomsLoaded=!1,this.loaded=!1,this.__geomLibrary.addListener("loaded",()=>{this.emit("geomsLoaded",{})}),this.__datafileParam=this.addParameter(new Te("DataFilePath")),this.__datafileParam.addListener("valueChanged",()=>{const t=this.__datafileParam.getFileDesc();if(t){if(console.log(t),""==this.getName()){const t=this.__datafileParam.getStem();this.setName(t)}this.geomsLoaded=!1,this.loadDataFile(()=>{this.loaded||this.emit("loaded",{})},()=>{})}}),this.addParameter(new Ie("LightmapTint",new y$2(1,1,1,1)))}readBinary(t,e){if(-1!=e.version){const t=new pe;t.patch=e.version,e.versions={"zea-mesh":t,"zea-engine":t},e.meshSdk="FBX"}else{const i=t.loadUInt8();if(t.seek(0),10!=i){const i=new pe;i.patch=t.loadUInt32(),e.versions={"zea-mesh":i,"zea-engine":i},e.meshSdk="FBX"}else{const i=new pe(t.loadStr());e.versions={"zea-mesh":i},e.meshSdk="FBX"}}this.meshfileversion=e.versions["zea-mesh"],this.meshSdk=e.meshSdk,console.log("Loading CAD File version:",e.versions["zea-mesh"]," exported using SDK:",e.meshSdk);const i=t.loadUInt32();return super.readBinary(t,e),e.versions["zea-engine"].lessThan([0,0,5])&&t.seek(t.byteLength-4),this.__geomLibrary.setNumGeoms(t.loadUInt32()),i}loadDataFile(e,i){const n=this.__datafileParam.getFileDesc();if(!n)return void console.warn("VLAAsset data file not found.");const s=this.__datafileParam.getFileFolderPath(),o=this.__datafileParam.getValue(),r=this.__datafileParam.getStem();let a=0;const l=new RegExp("\\.(vla)$","i").test(n.name),c=[],h=n=>{let s,r=-1;if(n.tree2)s=new ge(n.tree2.buffer,0,t.isMobileDevice);else{const e=n.tree?n.tree:n[Object.keys(n)[0]];s=new ge(e.buffer,0,t.isMobileDevice),r=0}a=this.readBinary(s,{assetItem:this,version:r}),l||a!=c.length&&console.error("The number of GeomFiles does not match the count given by the VLA file."),e(),0==a&&n.geoms0?(be.addWork(o+"geoms",1),this.__geomLibrary.readBinaryBuffer(o,n.geoms0.buffer,{version:r}),i()):(be.addWork(o+"geoms",4*a),d())},d=()=>{const t=[];for(let e=0;e<a;e++)if(l){const i=s+r+e+".vlageoms",n=be.resolveFilepath(i);if(!n)throw new Error("VLA Geoms file not found:"+i);t.push(u(e,n.url))}else t.push(u(e,c[e].url));Promise.all(t).then(()=>{i&&i()})},u=(t,e)=>new Promise(i=>{be.loadUrl(o+t,e,t=>{const e=t[Object.keys(t)[0]];this.__geomLibrary.readBinaryBuffer(o,e.buffer),i()},!1)});if(l)be.loadResource(o,h);else if(n.metadata.ConvertFile){let t;n.metadata.ConvertFile.map(e=>{e.filename.endsWith(".vla")?t=e:e.filename.endsWith(".vlageoms")&&c.push(e)}),t?be.loadUrl(o,t.url,h):console.warn("ConvertFile metadata contains no vla file.")}this.__geomLibrary.addListener("streamFileParsed",t=>{be.addWorkDone(o+"geoms",t.fraction)})}fromJSON(t,e,i){e||(e={}),e.assetItem=this;const n=()=>{super.fromJSON(t,e,i),i&&i()};if(t.params&&t.params.DataFilePath){this.__datafileLoaded=n;const i=t.params.DataFilePath;delete t.params.DataFilePath,this.__datafileParam.fromJSON(i,e)}else n()}}J.registerClass("VLAAsset",Ga);const Xa=new y$2("#DCDCDC");class ya{constructor(t){t&&be.setResources(t),this.settings=new Za("Scene Settings"),this.root=new na("root"),this.root.addChild(this.settings),this.__commonResources={}}getSettings(){return this.settings}getRoot(){return this.root}getResourceLoader(){return be}setEnvMap(t){console.warn("Deprecated Function. Please access the Scene Settings object."),this.settings.getParameter("EnvMap").setValue(t)}addAsset(t){console.warn("Deprecated Function. Please access the Scene Root object."),this.root.addChild(t,!1)}setupGrid(t=5,e=50,i=Xa){const n=new na("Grid"),s=new Pe("gridMaterial","LinesShader");s.getParameter("BaseColor").setValue(i);const o=new Bt(t,t,e,e,!0);n.addChild(new ha("GridItem",o,s),!1);const r=new Ct;r.setNumVertices(2),r.setNumSegments(1),r.setSegment(0,0,1),r.getVertex(0).set(-.5*t,0,0),r.getVertex(1).set(.5*t,0,0);const a=new Pe("gridXAxisMaterial","LinesShader");a.getParameter("BaseColor").setValue(new y$2(i.luminance(),0,0)),n.addChild(new ha("xAxisLine",r,a),!1);const l=new Pe("gridZAxisMaterial","LinesShader");l.getParameter("BaseColor").setValue(new y$2(0,i.luminance(),0));const c=new S;c.ori.setFromAxisAndAngle(new Z(0,0,1),.5*Math.PI);const h=new ha("yAxisLine",r,l);return h.setGeomOffsetXfo(c),n.addChild(h,!1),n.setSelectable(!1,!0),n.setFlag($.IGNORE_BBOX),n.clearFlag($.USER_EDITED),n.setFlag($.INVISIBLE),this.root.addChild(n,!1),n}loadCommonAssetResource(t){if(t in this.__commonResources)return this.__commonResources[t];const e=new Ga;return e.getParameter("DataFilePath").setValue(t),this.__commonResources[t]=e,e}toJSON(t={},e=0){return t.makeRelative=t=>t,{root:this.root.toJSON(t,e)}}fromJSON(t,e={}){const i=[];e.resolvePath=(t,e)=>{if(!t)throw new Error("Path not spcecified");const n=this.root.resolvePath(t);n?e(n):i.push(()=>{const i=this.resolvePath(t);i?e(i):console.warn("Path unable to be resolved:"+t)})},e.addPLCB=t=>i.push(t),e.settings=this.settings,t.root&&this.root.fromJSON(t.root,e);for(const n of i)n()}}class fa extends pa{constructor(t){super(t),this.geomsLoaded=!1,this.loaded=!1,this.addParameter(new Xe("splitObjects",!1)),this.addParameter(new Xe("splitGroupsIntoObjects",!1)),this.addParameter(new Xe("loadMtlFile",!0)),this.addParameter(new Ze("unitsConversion",1)),this.addParameter(new We("defaultShader","")),this.objfileParam=this.addParameter(new Te("ObjFilePath")),this.objfileParam.addListener("valueChanged",()=>{this.loaded=!1,this.__loadObj(()=>{this.emit("loaded",{})},()=>{this.emit("geomsLoaded",{})})}),this.geomLibrary=new ba,this.materials=new St}getGeometryLibrary(){return this.geomLibrary}getMaterialLibrary(){return this.materials}__loadObj(t,e){const i=this.objfileParam.getStem(),n=t=>{const e=t.split("\n"),i=/\s+/;let n;const s=function(t){if(3==t.length)return new y$2(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]));throw new Error("Unable to parse a color from the following parts:"+t.join("_"))},o=t=>{const e=this.objfileParam.getFileFolder();return new FileImage(t[0],e+t[0])};for(let r=0;r<e.length;r++){let t=e[r].trim();if(t.startsWith("#"))continue;-1!=t.indexOf("#")&&(t=t.substring(0,t.indexOf("#")).trim());const a=t.split(i),l=a.shift(),c=a.join(" ");switch(l){case"newmtl":n=new Pe(c),n.setShaderName("StandardSurfaceShader"),this.materials.addMaterial(n);break;case"Kd":n.getParameter("BaseColor").setValue(s(a));break;case"map_Kd":n.getParameter("BaseColor").setValue(o(a));break;case"Ks":const t=(parseFloat(a[0])+parseFloat(a[1])+parseFloat(a[2]))/3;n.roughness=1-t,n.getParameter("Roughness").setValue(1-t),n.getParameter("Reflectance").setValue(t);break;case"map_Ks":n.getParameter("Roughness").setValue(o(a)),n.getParameter("Reflectance").setValue(.2);break;case"d":const e=parseFloat(c);e<1&&(n.setShaderName("TransparentSurfaceShader"),n.getParameter("Opacity").setValue(e));break;case"map_d":n.getParameter("alpha").setValue(parseFloat(a));break;case"map_bump":n.getParameter("normal").setValue(o(a))}}},s=new N;s.incAsyncCount(),s.addListener("ready",()=>{d()});const o=t=>new Promise(e=>{se(t.url,t=>{be.addWorkDone(i,1),n(t),s.decAsyncCount(),be.addWorkDone(i,1),e()})}),r=new Array,a=new Array,l=new Array,c={},h=async t=>{const e=t.split("\n"),n=/\s+/;let h=void 0,d=void 0;const u=t=>{let e=0;for(;t in c;)e++,t+=String(e);h={verticesRemapping:{},texCoordsRemapping:{},normalsRemapping:{},vertexIndices:[],texCoordIndices:[],normalIndices:[],numVertices:0,numTexCoords:0,numNormals:0,numTris:0,numQuads:0,material:d},c[t]=h};u(i);const m=this.getParameter("splitGroupsIntoObjects").getValue();for(let p=0;p<e.length;p++){let t=e[p].trim();if(t.startsWith("#"))continue;-1!=t.indexOf("#")&&(t=t.substring(0,t.indexOf("#")).trim());const b=t.split(n),f=b.shift(),g=b.join(" ");switch(f){case"":case"s":continue;case"mtllib":if(!this.getParameter("loadMtlFile").getValue())continue;s.incAsyncCount(),be.addWork(i,2);const e=this.objfileParam.getFileFolderPath(),n=be.resolveFilepath(e+g);n&&await o(n);break;case"o":u(g);break;case"usemtl":d=g,u(g+Object.keys(c).length);break;case"g":m&&u(b.join("_"));break;case"v":r.push(b.map(t=>parseFloat(t)));break;case"vt":l.push(b.map(t=>parseFloat(t)));break;case"vn":a.push(b.map(t=>parseFloat(t)));break;case"f":{const t=[],e=[],i=[];for(let n=0,s=b.length;n<s;n++){const s=b[n].split("/").map(t=>parseInt(t)-1),o=s[0];let r=h.verticesRemapping[o];null==r&&(r=h.numVertices,h.verticesRemapping[o]=r,h.numVertices++),t.push(r),s.length>1&&!isNaN(s[1])&&e.push(s[1]),s.length>2&&!isNaN(s[2])&&i.push(s[2])}h.vertexIndices.push(t),i.length>0&&h.normalIndices.push(i),e.length>0&&h.texCoordIndices.push(e),3==t.length?h.numTris++:h.numQuads++;break}default:console.warn("Unhandled line:"+t)}}s.decAsyncCount()},d=()=>{for(const t in c)0!=c[t].numVertices&&u(t,c[t]);t(),e()},u=(t,e)=>{const i=e.numVertices,n=new Nt(t);n.setFaceCounts([e.numTris,e.numQuads]),n.setNumVertices(i);const s=n.getVertexAttribute("positions"),o=this.getParameter("unitsConversion").getValue();for(const a in e.verticesRemapping)s.getValueRef(e.verticesRemapping[a]).set(r[a][0]*o,r[a][1]*o,r[a][2]*o);let c,h;e.normalIndices.length>0&&(c=n.addVertexAttribute("normals",Z)),e.texCoordIndices.length>0&&(h=n.addVertexAttribute("texCoords",_));for(let r=0;r<e.vertexIndices.length;r++){if(n.setFaceVertexIndices(r,...e.vertexIndices[r]),c){const t=e.normalIndices[r];for(let e=0;e<t.length;e++){const i=new Z(a[t[e]][0],a[t[e]][1],a[t[e]][2]);c.setFaceVertexValue(r,e,i)}}if(h&&e.texCoordIndices.length==e.vertexIndices.length){const t=e.texCoordIndices[r];for(let e=0;e<t.length;e++){const i=new _(l[t[e]][0],l[t[e]][1]);h.setFaceVertexValue(r,e,i)}}}const d=new ha(t,n);d.selectable=!0;const u=n.boundingBox.center();if(n.moveVertices(u.negate()),d.setLocalXfo(new S(u)),null!=e.material&&this.materials.hasMaterial(e.material))d.setMaterial(this.materials.getMaterial(e.material));else{const e=this.getParameter("defaultShader").getValue(),i=new Pe(t+"mat");i.setShaderName(""!=e?e:"StandardSurfaceShader");const n=i.getParameter("BaseColor");if(n)n.setValue(y$2.random(.5));else{const t=i.getParameter("Color");t&&t.setValue(y$2.random(.5))}const s=i.getParameter("Roughness");s&&s.setValue(.6);const o=i.getParameter("Reflectance");o&&o.setValue(.2),this.materials.addMaterial(i),d.setMaterial(i)}this.addChild(d,!1)};(()=>{const t=this.objfileParam.getFileDesc(),e=this.objfileParam.getStem();be.addWork(e,2),se(t.url,t=>{be.addWorkDone(e,1),h(t),be.addWorkDone(e,1)})})()}}class Va extends te{constructor(t){super(t),this.setFlag($.USER_EDITED),this.__outputs=[],this.__evalOutput=this.__evalOutput.bind(this)}setDirty(){for(const t of this.__outputs)t.setDirtyFromOp()}__parameterValueChanged(t){super.__parameterValueChanged(t),this.setDirty()}addOutput(t){return this.__outputs.push(t),t.addListener("paramSet",t=>{const{param:e}=t;e.bindOperator(this)}),t}removeOutput(t){t.getParam()&&t.getParam().unbindOperator(this),this.__outputs.splice(this.__outputs.indexOf(t),1)}getNumOutputs(){return this.__outputs.length}getOutputByIndex(t){return this.__outputs[t]}getOutput(t){for(const e of this.__outputs)if(e.getName()==t)return e}__evalOutput(t){for(const e of this.__outputs)e.removeCleanerFn(this.__evalOutput);this.evaluate()}__opInputChanged(){this.setDirty()}evaluate(){throw new Error("Not yet implemented")}toJSON(t,e){const i=super.toJSON(t,e);i.type=J.getClassName(this);const n=[];for(const s of this.__outputs)n.push(s.toJSON(t,e));return i.outputs=n,i}fromJSON(t,e,i){if(super.fromJSON(t,e,i),t.outputs){for(let i=0;i<this.__outputs.length;i++)this.__outputs[i].fromJSON(t.outputs[i],e);e.addPLCB(()=>{this.__opInputChanged()})}}detach(){this.__outputs.forEach(t=>t.detach())}reattach(){this.__outputs.forEach(t=>t.reattach())}destroy(){super.destroy(),this.__outputs=[]}}class Ia extends Y{constructor(t,e){super(),this.__name=t,this.__filterFn=e,this._param=void 0,this.detached=!1}getName(){return this.__name}getFilterFn(){return this.__filterFn}isConnected(){return null!=this._param}getParam(){return this._param}setParam(t){this._param=t,this.emit("paramSet",{param:t})}getValue(t=P.OPERATOR_GETVALUE){if(this._param)return this._param.getValue(t)}setValue(t,e=E.OPERATOR_SETVALUE){this._param&&this._param.setValue(t,e)}setClean(t){this._param&&this._param.setClean(t)}setDirty(t){this._param&&this._param.setDirty(t)}setDirtyFromOp(){this._param&&this._param.setDirtyFromOp()}removeCleanerFn(t){this._param&&this._param.removeCleanerFn(t)}toJSON(t,e){const i=this._param?this._param.getPath():"";return{type:J.getClassName(this),paramPath:t&&t.makeRelative?t.makeRelative(i):i}}fromJSON(t,e,i){t.paramPath&&e.resolvePath(t.paramPath,t=>{this.setParam(t)},()=>{console.warn("Operator Output: '"+this.getName()+"'. Unable to load item:"+t.paramPath)})}detach(){this.detached=!0}reattach(){this.detached=!1}}J.registerClass("OperatorOutput",Ia);class xa extends Ia{constructor(t){super(t,t=>"Xfo"==t.getDataType())}getInitialValue(){return this._initialParamValue}setParam(t){(()=>{if(this._initialParamValue=t.getValue(),this._initialParamValue.clone&&(this._initialParamValue=this._initialParamValue.clone()),null==this._initialParamValue)throw new Error("WTF?")})(),this._param=t,this.emit("paramSet",{param:t})}}J.registerClass("XfoOperatorOutput",xa);class Ra extends Me{constructor(t){super(t),this.__stageParam=this._addMember(new Ze("Stage",0)),this.__axisParam=this._addMember(new fe("Axis",new Z(1,0,0))),this.__movementParam=this._addMember(new ye("MovementTiming",new _(0,1),[new _(0,0),new _(1,1)])),this.__multiplierParam=this._addMember(new Ze("Multiplier",1)),this.__output=new xa("Part")}getStage(t=E.USER_GETVALUE){return this.__stageParam.getValue(t)}setStage(t,e=E.USER_SETVALUE){this.__stageParam.setValue(t,e)}getOutput(){return this.__output}evaluate(t,e,i,n,s,o,r,a){if(!this.__output.isConnected())return;const l=this.__stageParam.getValue(),c=this.__movementParam.getValue();let h;if(s){let i=l/n;o&&(i-=.5),h=e*Math.linStep(c.x,c.y,Math.max(0,t-i))}else{let i=1-l/n;o&&(i-=.5),h=e*Math.linStep(c.x,c.y,t)*i}h+=i;let d=this.__axisParam.getValue();const u=this.__multiplierParam.getValue(),m=this.__output.getInitialValue();let p;r?(p=a.multiply(m),d=r.ori.rotateVec3(d),p.tr.addInPlace(d.scale(h*u))):(p=this.__output.getValue(),p.tr=m.tr.add(d.scale(h*u))),this.__output.setClean(p)}toJSON(t,e){const i=super.toJSON(t,e);return i&&(i.output=this.__output.toJSON(t,e)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.output&&this.__output.fromJSON(t.output,e)}}class Sa extends Va{constructor(t){super(t),this.__stagesParam=this.addParameter(new Ze("Stages",0)),this._explodeParam=this.addParameter(new Ze("Explode",0,[0,1])),this._distParam=this.addParameter(new Ze("Dist",1)),this._offsetParam=this.addParameter(new Ze("Offset",0)),this._cascadeParam=this.addParameter(new Xe("Cascade",!1)),this._centeredParam=this.addParameter(new Xe("Centered",!1)),this.__parentItemParam=this.addParameter(new Ye("RelativeTo")),this.__parentItemParam.addListener("valueChanged",()=>{const t=this.__parentItemParam.getValue();this.__invParentSpace=t?t.getGlobalXfo().inverse():void 0}),this.__parentItemParam.addListener("treeItemGlobalXfoChanged",()=>{this.setDirty()}),this.__itemsParam=this.addParameter(new Fe("Parts",Ra)),this.__itemsParam.addListener("elementAdded",t=>{if(t.index>0){const e=this.__itemsParam.getElement(t.index-1).getStage();t.elem.setStage(e+1),this.__stagesParam.setClean(e+2)}else this.__stagesParam.setClean(1);this.addOutput(t.elem.getOutput()),this.setDirty()}),this.__itemsParam.addListener("elementRemoved",t=>{this.removeOutput(t.elem.getOutput())}),this.__localXfos=[],this.__parts=[],this.__stages=2}evaluate(){const t=this.__stagesParam.getValue(),e=this._explodeParam.getValue(),i=this._distParam.getValue(),n=this._offsetParam.getValue(),s=this._cascadeParam.getValue(),o=this._centeredParam.getValue(),r=this.__parentItemParam.getValue();let a,l;r&&(a=r.getGlobalXfo(),l=this.__invParentSpace.multiply(a));const c=this.__itemsParam.getValue();for(let h=0;h<c.length;h++)c[h].evaluate(e,i,n,t,s,o,a,l)}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i)}destroy(){clearTimeout(this.__timeoutId),super.destroy()}}J.registerClass("ExplodePartsOperator",Sa);class La extends Me{constructor(t){super(t),this.__ratioParam=this._addMember(new Ze("Ratio",1)),this.__offsetParam=this._addMember(new Ze("Offset",0)),this.__axisParam=this._addMember(new fe("Axis",new Z(1,0,0))),this.__output=new xa("Gear")}getOutput(){return this.__output}getRatio(){return this.__ratioParam.getValue()}getOffset(){return this.__offsetParam.getValue()}getAxis(){return this.__axisParam.getValue()}toJSON(t,e){const i=super.toJSON(t,e);return i&&(i.output=this.__output.toJSON(t,e)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.output&&this.__output.fromJSON(t.output,e)}}class Wa extends Va{constructor(t){super(t),this.__revolutionsParam=this.addParameter(new Ze("Revolutions",0));const e=this.addParameter(new Ze("RPM",0));e.addListener("valueChanged",()=>{const t=e.getValue();if(Math.abs(t)>0){if(!this.__timeoutId){const t=()=>{const i=e.getValue(),n=this.__revolutionsParam.getValue();this.__revolutionsParam.setValue(n+i*(1/3e3)),this.__timeoutId=setTimeout(t,20)};t()}}else clearTimeout(this.__timeoutId),this.__timeoutId=void 0}),this.__gearsParam=this.addParameter(new Fe("Gears",La)),this.__gearsParam.addListener("elementAdded",t=>{this.addOutput(t.elem.getOutput())}),this.__gearsParam.addListener("elementRemoved",t=>{this.removeOutput(t.index)}),this.__gears=[]}evaluate(){const t=this.__revolutionsParam.getValue(),e=this.__gearsParam.getValue();for(const i of e){const e=i.getOutput(),n=e.getInitialValue();if(!n)return;const s=t*i.getRatio()+i.getOffset(),o=new x;o.setFromAxisAndAngle(i.getAxis(),s*Math.PI*2);const r=e.getValue();r.ori=o.multiply(n.ori),e.setClean(r)}}detach(){super.detach(),this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=null)}reattach(){super.reattach(),this.getParameter("RPM").emit("valueChanged",{mode:Q.ValueSetMode.USER_SETVALUE})}destroy(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=null),super.destroy()}}J.registerClass("GearsOperator",Wa);class va extends Me{constructor(){super("Piston"),this.__pistonAngleParam=this._addMember(new Ze("PistonAngle",0)),this.__camPhaseParam=this._addMember(new Ze("CamPhase",0)),this.__camLengthParam=this._addMember(new Ze("CamLength",3)),this.__rodLengthParam=this._addMember(new Ze("RodLength",3)),this.__rodoutput=new xa("Rod"),this.__capoutput=new xa("Cap"),this.__pistonAngleParam.addListener("valueChanged",this.init.bind(this)),this.__camPhaseParam.addListener("valueChanged",this.init.bind(this)),this.__camLengthParam.addListener("valueChanged",this.init.bind(this)),this.__rodLengthParam.addListener("valueChanged",this.init.bind(this)),this.__bindXfos={}}getRodOutput(){return this.__rodoutput}getCapOutput(){return this.__capoutput}setCrankXfo(t){this.__baseCrankXfo=t,this.init()}init(){if(!this.__baseCrankXfo)return;const t=this.__camPhaseParam.getValue(),e=this.__camLengthParam.getValue(),i=this.__rodLengthParam.getValue(),n=this.__pistonAngleParam.getValue(),s=new Z(Math.sin(Math.degToRad(n)),Math.cos(Math.degToRad(n)),0);this.__pistonAxis=this.__baseCrankXfo.ori.rotateVec3(s),this.__camVec=this.__baseCrankXfo.ori.rotateVec3(new Z(Math.sin(2*t*Math.PI)*e,Math.cos(2*t*Math.PI)*e,0));const o=2*t*Math.PI,r=Math.sin(o)*e,a=Math.sqrt(i*i-r*r)+Math.cos(o)*e;this.__pistonOffset=a}evaluate(t,e,i){const n=this.__camPhaseParam.getValue(),s=this.__camLengthParam.getValue(),o=this.__rodLengthParam.getValue(),r=2*(n+i)*Math.PI,a=Math.sin(r)*s,l=Math.asin(a/o),c=Math.sqrt(o*o-a*a)+Math.cos(r)*s;if(this.__rodoutput.isConnected()){const i=this.__rodoutput.getInitialValue().clone(),n=this.__rodoutput.getValue(),s=n.tr.subtract(this.__baseCrankXfo.tr).dot(e),o=new x;o.setFromAxisAndAngle(e,-l),n.tr=this.__baseCrankXfo.tr.add(t.rotateVec3(this.__camVec)),n.tr.addInPlace(e.scale(s)),n.ori=o.multiply(i.ori),this.__rodoutput.setValue(n)}if(this.__capoutput.isConnected()){const t=this.__capoutput.getInitialValue().clone(),e=this.__capoutput.getValue();e.tr=t.tr.add(this.__pistonAxis.scale(c-this.__pistonOffset)),this.__capoutput.setValue(e)}}setOwner(t){this.__owner=t}getOwner(){return this.__owner}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i)}clone(t){return new va(this.__name,this.__value)}}class Ta extends Va{constructor(t){super(t),this.__revolutionsParam=this.addParameter(new Ze("Revolutions",0,[0,1]));const e=this.addParameter(new Ze("RPM",0));e.addListener("valueChanged",()=>{let t=e.getValue();if(t>0){if(!this.__timeoutId){const i=()=>{t=e.getValue();const n=this.__revolutionsParam.getValue();this.__revolutionsParam.setValue(n+t*(1/3e3)),this.__timeoutId=setTimeout(i,20)};i()}}else clearTimeout(this.__timeoutId),this.__timeoutId=void 0}),this.__crankOutput=this.addOutput(new xa("Crank")),this.__crankOutput.addListener("paramSet",this.init.bind(this)),this.__crankAxisParam=this.addParameter(new fe("CrankAxis",new Z(1,0,0))),this.__crankAxisParam.addListener("valueChanged",()=>{this.__baseCrankXfo.ori.setFromDirectionAndUpvector(this.__crankAxisParam.getValue(),new Z(0,0,1)),this.init()}),this.__pistonsParam=this.addParameter(new Fe("Pistons",va)),this.__pistonsParam.addListener("elementAdded",t=>{t.elem.setCrankXfo(this.__baseCrankXfo),this.addOutput(t.elem.getRodOutput()),this.addOutput(t.elem.getCapOutput())}),this.__pistonsParam.addListener("elementRemoved",t=>{this.removeOutput(t.elem.getRodOutput()),this.removeOutput(t.elem.getCapOutput())}),this.__baseCrankXfo=new S,this.__pistons=[]}setOwner(t){super.setOwner(t)}getCrankOutput(){return this.__crankOutput}init(){const t=this.__pistonsParam.getValue();for(const e of t)e.setCrankXfo(this.__baseCrankXfo);this.__crankOutput.isConnected()&&(this.__crankOffset=this.__baseCrankXfo.inverse().multiply(this.__crankOutput.getInitialValue()))}evaluate(){const t=this.__revolutionsParam.getValue(P.OPERATOR_GETVALUE),e=this.__crankAxisParam.getValue(P.OPERATOR_GETVALUE),i=new x;if(i.setFromAxisAndAngle(e,t*Math.PI*2),this.__crankOutput.isConnected()){const t=this.__crankOutput.getValue();t.ori=i.multiply(this.__crankOutput.getInitialValue().ori),this.__crankOutput.setValue(t)}const n=this.__pistonsParam.getValue(),s=n.length;for(let o=0;o<s;o++)n[o].evaluate(i,e,t);this.emit("postEval",{})}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i),t.crankOutput&&this.__crankOutput.fromJSON(t.crankOutput,e),this.init()}destroy(){clearTimeout(this.__timeoutId),super.destroy()}}J.registerClass("PistonOperator",Ta);class Fa extends Va{constructor(t){super(t),this.__inputParam=this.addParameter(new Ze("Input")),this.__multipliersParam=this.addParameter(new Fe("Multipliers",Ze)),this.__multipliersParam.on("elementAdded",t=>{t.elem.setValue(1),this.addOutput(new Ia("Output"))}),this.__multipliersParam.on("elementRemoved",t=>{this.removeOutput(this.getOutputByIndex(t.index))})}addRoute(){const t=this.__multipliersParam.getCount();return this.__multipliersParam.addElement(new Ze("Mult"+t)),this.getOutputByIndex(t)}evaluate(){const t=this.__inputParam.getValue(P.OPERATOR_GETVALUE),e=this.__multipliersParam.getValue();let i=this.__outputs.length;for(;i--;){const n=this.__outputs[i],s=e[i].getValue(P.OPERATOR_GETVALUE);n.setValue(t*s)}this.emit("postEval",{})}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i)}destroy(){super.destroy()}}J.registerClass("RouterOperator",Fa);class Ma extends Va{constructor(t){super(t),this.addParameter(new Ze("Weight",1)),this.addParameter(new Ge("Axis",0,["+X Axis","-X Axis","+Y Axis","-Y Axis","+Z Axis","-Z Axis"])),this.addParameter(new Ze("Stretch",0)),this.addParameter(new Ze("Initial Dist",1)),this.addParameter(new Se("Target")),this.addOutput(new xa("InputOutput"))}resetStretchRefDist(){const t=this.getParameter("Target").getValue(),e=this.getOutputByIndex(0).getValue(),i=t.tr.subtract(e.tr).length();this.getParameter("Initial Dist").setValue(i)}evaluate(){const t=this.getParameter("Weight").getValue(),e=this.getParameter("Target").getValue(),i=this.getParameter("Axis").getValue(),n=this.getOutputByIndex(0),s=n.getValue(),o=e.tr.subtract(s.tr),r=o.length();if(r<1e-6)return;let a;switch(o.scaleInPlace(1/r),i){case 0:a=s.ori.getXaxis();break;case 1:a=s.ori.getXaxis().negate();break;case 2:a=s.ori.getYaxis();break;case 3:a=s.ori.getYaxis().negate();break;case 4:a=s.ori.getZaxis();break;case 5:a=s.ori.getZaxis().negate()}let l=new x;l.setFrom2Vectors(a,o),l.alignWith(new x),t<1&&(l=(new x).lerp(l,t)),s.ori=l.multiply(s.ori);const c=this.getParameter("Stretch").getValue();if(c>0){const t=1+(r/this.getParameter("Initial Dist").getValue()-1)*c;switch(i){case 0:case 1:s.sc.x=t;break;case 2:case 3:s.sc.y=t;break;case 4:case 5:s.sc.z=t}}n.setClean(s)}}J.registerClass("AimOperator",Ma);class Ya extends q{constructor(e){null==e&&(e="Camera"),super(e),this.__defaultManipulationState="orbit",this.__manipulationState=this.__defaultManipulationState,this.__mouseDown=!1,this.__dragging=!1,this.__mouseDragDelta=new _,this.__keyboardMovement=!1,this.__keysPressed=[],this.__maxVel=.002,this.__velocity=new Z,this.__ongoingTouches={},this.__orbitRateParam=this.addParameter(new Ze("orbitRate",t.isMobileDevice?-.3:1)),this.__dollySpeedParam=this.addParameter(new Ze("dollySpeed",.02)),this.__mouseWheelDollySpeedParam=this.addParameter(new Ze("mouseWheelDollySpeed",5e-4))}setDefaultManipulationMode(t){this.__defaultManipulationState=t}look(t,e){const{viewport:i}=t,n=i.getCamera(),s=n.getFocalDistance(),o=this.__orbitRateParam.getValue();if(this.__keyboardMovement){const t=n.getGlobalXfo();this.__mouseDownCameraXfo=t.clone(),this.__mouseDownZaxis=t.ori.getZaxis();const e=this.__mouseDownZaxis.scale(-s);this.__mouseDownCameraTarget=t.tr.add(e)}const r=this.__mouseDownCameraXfo.clone(),a=new x;a.rotateZ(e.x/i.getWidth()*Math.PI*o),r.ori=a.multiply(r.ori);const l=new x;l.rotateX(e.y/i.getHeight()*Math.PI*o),r.ori.multiplyInPlace(l),n.setGlobalXfo(r)}orbit(t,e){const{viewport:i}=t,n=i.getCamera(),s=n.getFocalDistance(),o=this.__orbitRateParam.getValue();if(this.__keyboardMovement){const t=n.getGlobalXfo();this.__mouseDownCameraXfo=t.clone(),this.__mouseDownZaxis=t.ori.getZaxis();const e=this.__mouseDownZaxis.scale(-s);this.__mouseDownCameraTarget=t.tr.add(e)}const r=this.__mouseDownCameraXfo.clone(),a=new x;a.rotateZ(e.x/i.getWidth()*2*Math.PI*-o),r.ori=a.multiply(r.ori);const l=new x;l.rotateX(e.y/i.getHeight()*Math.PI*-o),r.ori.multiplyInPlace(l),r.tr=this.__mouseDownCameraTarget.add(r.ori.getZaxis().scale(s)),n.setGlobalXfo(r)}pan(t,e){const{viewport:i}=t,n=i.getCamera(),s=n.getFocalDistance(),o=n.getFov(),r=new Z(1,0,0),a=new Z(0,1,0),l=2*s*Math.tan(.5*o),c=l*(i.getWidth()/i.getHeight()),h=new S;h.tr=r.scale(-e.x/i.getWidth()*c),h.tr.addInPlace(a.scale(e.y/i.getHeight()*l)),n.setGlobalXfo(this.__mouseDownCameraXfo.multiply(h))}dolly(t,e){const{viewport:i}=t,n=i.getCamera(),s=e.x*this.__dollySpeedParam.getValue(),o=new S;o.tr.set(0,0,s),n.setGlobalXfo(this.__mouseDownCameraXfo.multiply(o))}panAndZoom(t,e,i){const{viewport:n}=t,s=n.getCamera(),o=s.getFocalDistance(),r=s.getFov(),a=new Z(1,0,0),l=new Z(0,1,0),c=2*o*Math.tan(.5*r),h=c*(n.getWidth()/n.getHeight()),d=new S;d.tr=a.scale(-e.x/n.getWidth()*h),d.tr.addInPlace(l.scale(e.y/n.getHeight()*c));const u=i*o;s.setFocalDistance(this.__mouseDownFocalDist+u),d.tr.z+=u,s.setGlobalXfo(this.__mouseDownCameraXfo.multiply(d))}initDrag(t){const{viewport:e}=t,i=e.getCamera(),n=i.getFocalDistance();this.__mouseDown=!0,this.__calculatingDragAction=!1,this.__mouseDownPos=t.mousePos,this.__mouseDownViewport=e,this.__mouseDragDelta.set(0,0),this.__mouseDownCameraXfo=i.getGlobalXfo().clone(),this.__mouseDownZaxis=this.__mouseDownCameraXfo.ori.getZaxis();const s=this.__mouseDownZaxis.scale(-n);this.__mouseDownCameraTarget=i.getGlobalXfo().tr.add(s),this.__mouseDownFocalDist=n,this.__dragListenerId=i.getParameter("GlobalXfo").on("valueChanged",this.__globalXfoChangedDuringDrag.bind(this))}__globalXfoChangedDuringDrag(t){this.__calculatingDragAction||(null!=this.__dragListenerId&&(this.__mouseDownViewport.getCamera().getParameter("GlobalXfo").removeListenerById("valueChanged",this.__dragListenerId),this.__dragListenerId=null),this.initDrag({viewport:this.__mouseDownViewport,mousePos:this.__mouseDownPos}))}endDrag(t){if(null!=this.__dragListenerId){const{viewport:e}=t;e.getCamera().getParameter("GlobalXfo").removeListenerById("valueChanged",this.__dragListenerId),this.__dragListenerId=null}this.__mouseDown=!1,this.__dragging=!1}aimFocus(t,e){const{viewport:i}=t,n=i.getCamera();this.__focusIntervalId&&clearInterval(this.__focusIntervalId);let s=0;const o=()=>{const t=n.getGlobalXfo(),i=n.getFocalDistance(),r=e.subtract(t.tr),a=r.normalizeInPlace(),l=new x,c=new x;{const e=t.ori.getZaxis().clone();e.z=0;const i=r.negate();i.z=0,l.setFrom2Vectors(e,i)}{const e=t.ori.getZaxis().clone(),i=r.negate();e.x=i.x,e.y=i.y,e.normalizeInPlace(),e.cross(i).dot(t.ori.getXaxis())>0?c.rotateX(e.angleTo(i)):c.rotateX(-e.angleTo(i))}const h=t.clone();h.ori=l.multiply(h.ori),h.ori.multiplyInPlace(c);const d=Math.pow(s/20,2),u=t.clone();u.ori=t.ori.lerp(h.ori,d),n.setFocalDistance(i+(a-i)*d),n.setGlobalXfo(u),s++,s<=20?this.__focusIntervalId=setTimeout(o,20):(this.__focusIntervalId=void 0,this.emit("movementFinished",{}),n.emit("movementFinished",{}))};o(),this.__manipulationState="focussing"}onMouseMove(t){}onDoubleClick(t){if(t.intersectionData){const e=t.viewport.getCamera().getGlobalXfo().tr.add(t.mouseRay.dir.scale(t.intersectionData.dist));this.aimFocus(t,e)}}onMouseDown(t){this.initDrag(t),this.__manipulationState=2==t.button?"pan":t.ctrlKey&&t.altKey?"dolly":t.ctrlKey||2==t.button?"look":this.__defaultManipulationState,t.stopPropagation(),t.preventDefault()}onMouseMove(t){if(!this.__mouseDown)return;const e=t.mousePos;switch(this.__calculatingDragAction=!0,this.__mouseDragDelta=this.__keyboardMovement?e:e.subtract(this.__mouseDownPos),this.__manipulationState){case"orbit":this.orbit(t,this.__mouseDragDelta);break;case"look":this.look(t,this.__mouseDragDelta);break;case"pan":this.pan(t,this.__mouseDragDelta);break;case"dolly":this.dolly(t,this.__mouseDragDelta)}this.__dragging=!0,this.__calculatingDragAction=!1,t.stopPropagation(),t.preventDefault()}onMouseUp(t){this.__dragging&&(this.emit("movementFinished",{}),t.viewport.getCamera().emit("movementFinished",{}),this.__dragging=!1,t.stopPropagation()),this.endDrag(t)}onWheel(t){const{viewport:e}=t,i=e.getCamera(),n=this.__mouseWheelDollySpeedParam.getValue(),s=t.shiftKey?.1:.5,o=i.getGlobalXfo(),r=o.ori.getZaxis();this.__mouseWheelZoomIntervalId&&clearInterval(this.__mouseWheelZoomIntervalId);let a=0;const l=()=>{const e=i.getFocalDistance(),c=t.deltaY*n*e*s;o.tr.addInPlace(r.scale(c)),"orbit"==this.__defaultManipulationState&&i.setFocalDistance(i.getFocalDistance()+c),i.setGlobalXfo(o),a++,a<10?this.__mouseWheelZoomIntervalId=setTimeout(l,10):(this.__mouseWheelZoomIntervalId=void 0,this.emit("movementFinished",{}),i.emit("movementFinished",{}))};l(),t.preventDefault(),t.stopPropagation()}__integrateVelocityChange(t){const{viewport:e}=t,i=e.getCamera(),n=new S;n.tr=this.__velocity.normalize().scale(this.__maxVel),i.setGlobalXfo(i.getGlobalXfo().multiply(n))}onKeyPressed(t,e){return!1}onKeyDown(t,e){}onKeyUp(t,e){}__startTouch(t){this.__ongoingTouches[t.identifier]={identifier:t.identifier,pos:new _(t.pageX,t.pageY)}}__endTouch(t){delete this.__ongoingTouches[t.identifier]}onTouchStart(t){console.log("onTouchStart"),t.preventDefault(),t.stopPropagation(),0==Object.keys(this.__ongoingTouches).length&&(this.__manipMode=void 0);const e=t.changedTouches;for(let i=0;i<e.length;i++)this.__startTouch(e[i]);1==Object.keys(this.__ongoingTouches).length&&(this.initDrag(t),this.__dragging=!0)}onTouchMove(t){t.preventDefault(),t.stopPropagation(),this.__calculatingDragAction=!0;const e=t.touches;if(1==e.length&&"panAndZoom"!=this.__manipMode){const i=e[0],n=new _(i.pageX,i.pageY),s=this.__ongoingTouches[i.identifier].pos.subtract(n);"look"==this.__defaultManipulationState?(s.scaleInPlace(6),this.look(t,s)):this.orbit(t,s)}else if(2==e.length){const i=e[0],n=this.__ongoingTouches[i.identifier],s=e[1],o=this.__ongoingTouches[s.identifier],r=new _(i.pageX,i.pageY),a=new _(s.pageX,s.pageY),l=o.pos.subtract(n.pos).length()-a.subtract(r).length(),c=r.subtract(n.pos),h=a.subtract(o.pos),d=c.add(h);d.scaleInPlace(.5),this.panAndZoom(t,d,.002*l),this.__manipMode="panAndZoom"}this.__calculatingDragAction=!1}onTouchEnd(t){t.preventDefault(),t.stopPropagation();const e=t.changedTouches;for(let i=0;i<e.length;i++)this.__endTouch(e[i]);0==Object.keys(this.__ongoingTouches).length&&this.endDrag(t)}onTouchCancel(t){t.preventDefault();const e=t.touches;for(let i=0;i<e.length;i++)this.__endTouch(e[i]);0==Object.keys(this.__ongoingTouches).length&&this.endDrag(t)}onDoubleTap(t){if(t.intersectionData){const{viewport:e}=t,i=e.getCamera().getGlobalXfo().tr.add(t.touchRay.dir.scale(t.intersectionData.dist));this.aimFocus(t,i)}t.preventDefault()}}var Ca=Object.freeze({__proto__:null,RefCounted:U,ParameterOwner:q,ItemFlags:$,BaseItem:te,getFileFolder:ae,loadTextfile:se,loadJSONfile:ne,loadXMLfile:le,loadBinfile:re$1,sgFactory:J,isObject:me,mergeDeep:ue,resourceLoader:be,Version:pe,BinReader:ge,BinWriter:_e,ParamFlags:H,ValueGetMode:P,ValueSetMode:E,BaseParameter:O,Parameter:Q,MultiChoiceParameter:Ge,BooleanParameter:Xe,NumberParameter:Ze,Vec2Parameter:ye,Vec3Parameter:fe,Vec4Parameter:Ve,ColorParameter:Ie,Mat3Parameter:xe,Mat4Parameter:Re,XfoParameter:Se,ImageParameter:Le,StringParameter:We,CodeParameter:ve,FilePathParameter:Te,ListParameter:Fe,StructParameter:Me,TreeItemParameter:Ye,ItemSetParameter:Ce,ProxyParameter:Ne,GeometryParameter:Ke,MaterialParameter:Wt,MaterialFloatParam:ze,MaterialColorParam:Ue,Attribute:vt,BaseGeom:Ft,SAVE_FLAG_SKIP_GEOMDATA:1024,VertexAttribute:Mt,Points:Yt,Lines:Ct,Mesh:Nt,PointsProxy:wt,LinesProxy:zt,MeshProxy:Ut,PointGrid:Jt,Rect:Pt,Circle:Et,Cross:Ht,LinesCuboid:kt,Grid:Bt,Cone:Dt,Cuboid:Ot,Cylinder:Qt,Disc:At,Plane:jt,Sphere:qt,Torus:$t,DataImage:Ee,FileImage:dt,FileImage2D:ot,LDRImage:ct,LDRVideo:mt,GIFImage:ut,EnvMap:Vt,Label:xt,VideoStreamImage2D:Rt,labelManager:It,SaveFlags:ea,LoadFlags:ta,CloneFlags:aa,TreeItem:na,InstanceItem:la,AudioItem:ra,FileAudioItem:da,BaseGeomItem:oa,GeomItem:ha,AssetItem:pa,BillboardItem:ga,Camera:_a,Group:ma,GeomLibrary:ba,Material:Pe,BaseImage:we,MaterialLibrary:St,Scene:ya,VLAAsset:Ga,ObjAsset:fa,Operator:Va,OperatorOutput:Ia,XfoOperatorOutput:xa,ExplodePartsOperator:Sa,GearsOperator:Wa,PistonOperator:Ta,RouterOperator:Fa,AimOperator:Ma,CameraMouseAndKeyboard:Ya});const Na=function(e,i){console.log(t);let n=null;if(null!=i.webglContextType)try{n=e.getContext(i.webglContextType,i),n.name=i.webglContextType}catch(e){}else["webgl2","webgl"].some(t=>{try{n=e.getContext(t,i),n.name=t}catch(e){}if(n)return!0});if(n)return n.sizeInBytes=function(t){switch(t){case this.BYTE:case this.UNSIGNED_BYTE:return 1;case this.SHORT:case this.UNSIGNED_SHORT:return 2;case this.INT:case this.UNSIGNED_INT:case this.FLOAT:return 4;default:throw new Error("unknown type")}},"webgl2"==n.name?(n.floatTexturesSupported=!0,n.__ext_float_linear=n.getExtension("OES_texture_float_linear"),n.__ext_texture_half_float_linear=n.getExtension("OES_texture_half_float_linear"),n.__ext_color_buffer_float=n.getExtension("EXT_color_buffer_float")):(n.__ext_float=n.getExtension("OES_texture_float"),n.__ext_float?(n.floatTexturesSupported=!0,n.__ext_float_linear=n.getExtension("OES_texture_float_linear")):console.warn("OES_texture_float is not available"),n.__ext_half_float=n.getExtension("OES_texture_half_float"),n.__ext_half_float&&(n.HALF_FLOAT=n.__ext_half_float.HALF_FLOAT_OES,n.floatTexturesSupported=!0,n.__ext_texture_half_float_linear=n.getExtension("OES_texture_half_float_linear")),n.__ext_color_buffer_float=n.getExtension("EXT_color_buffer_float"),n.__ext_std_derivatives=n.getExtension("OES_standard_derivatives"),n.__ext_Inst=n.getExtension("ANGLE_instanced_arrays"),n.__ext_Inst&&(n.vertexAttribDivisor=n.__ext_Inst.vertexAttribDivisorANGLE.bind(n.__ext_Inst),n.drawArraysInstanced=n.__ext_Inst.drawArraysInstancedANGLE.bind(n.__ext_Inst),n.drawElementsInstanced=n.__ext_Inst.drawElementsInstancedANGLE.bind(n.__ext_Inst)),n.__ext_VAO=n.getExtension("OES_vertex_array_object"),n.__ext_VAO&&(n.createVertexArray=n.__ext_VAO.createVertexArrayOES.bind(n.__ext_VAO),n.deleteVertexArray=n.__ext_VAO.deleteVertexArrayOES.bind(n.__ext_VAO),n.bindVertexArray=n.__ext_VAO.bindVertexArrayOES.bind(n.__ext_VAO)),n.__ext_element_index_uint=n.getExtension("OES_element_index_uint"),n.__ext_WEBGL_depth_texture=n.getExtension("WEBGL_depth_texture"),n.__ext_WEBGL_depth_texture&&(n.UNSIGNED_INT_24_8=n.__ext_WEBGL_depth_texture.UNSIGNED_INT_24_8_WEBGL),n.DRAW_FRAMEBUFFER=n.FRAMEBUFFER),n.__ext_frag_depth=n.getExtension("EXT_frag_depth"),n.setupInstancedQuad=function(){const t=new Float32Array([0,1,2,3]),e=new Uint16Array([0,1,2,2,1,3]);this.__quadVertexIdsBuffer=this.createBuffer(),this.bindBuffer(this.ARRAY_BUFFER,this.__quadVertexIdsBuffer),this.bufferData(this.ARRAY_BUFFER,t,this.STATIC_DRAW),this.__quadIndexBuffer=this.createBuffer(),this.bindBuffer(this.ELEMENT_ARRAY_BUFFER,this.__quadIndexBuffer),this.bufferData(this.ELEMENT_ARRAY_BUFFER,e,this.STATIC_DRAW),this.__quadattrbuffers={vertexIDs:{buffer:this.__quadVertexIdsBuffer,dataType:6,dimension:1,count:t.length,shared:!0}}},n.drawQuad=function(){this.drawElements(this.TRIANGLES,6,this.UNSIGNED_SHORT,0)},n.setupLineSegAttrBuffers=function(){const t=new Float32Array([0,1]),e=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,e),n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW),n.__linesegattrbuffers={vertexIDs:{buffer:e,dimension:1,count:t.length,shared:!0}}},n};class Ka extends U{constructor(t,e){super(),this.__gl=t,this.ready=!1,this.width=0,this.height=0,this.textureType=1,this.textureDesc=[0,0,0,0],this.__loaded=!1,this.__bound=!1,null!=e&&(e instanceof we?(this.__texture=e,this.__texture.setMetadata("gltexture",this),this.__texture.addListener("updated",()=>{const t=this.__texture.getParams();this.bufferData(t.data,t.width,t.height)}),this.__texture.isLoaded()?this.configure(this.__texture.getParams()):this.__texture.addListener("loaded",()=>{this.configure(this.__texture.getParams())})):this.configure(e))}isLoaded(){return this.__loaded}getTexture(){return this.__texture}getInternalFormat(){return this.__internalFormat}getType(){return this.__typeParam}getTypeID(){return this.__type}getFormat(){return this.__formatParam}getFormatID(){return this.__format}getFilter(){return this.__filterParam}getWrap(){return this.__wrapParam}getMipMapped(){return this.__mipMapped}configure(t,e=!0){if(!("type"in t&&"format"in t&&"width"in t&&"height"in t))throw new Error("Invalid texture params");const i=this.__gl,n=t.width,s=t.height,o=t.data,r=i.getParameter(i.MAX_TEXTURE_SIZE);if(n<=0||n>r||s<=0||s>r)throw new Error("gl-texture2d: Invalid texture size. width:"+n+" height:"+s+" maxSize:"+r);const a=t.format,l=t.type;let c="minFilter"in t?t.minFilter:"filter"in t?t.filter:"LINEAR",h="magFilter"in t?t.magFilter:"filter"in t?t.filter:"LINEAR";const d="wrap"in t?t.wrap:"CLAMP_TO_EDGE";if("FLOAT"==l)if(this.textureType=3,"webgl2"==i.name)"LINEAR"!=c||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),h="NEAREST");else if(i.__ext_float)"LINEAR"!=c||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),h="NEAREST");else{if(!i.__ext_half_float)throw new Error("OES_texture_half_float is not available");l="HALF_FLOAT","LINEAR"!=c||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),h="NEAREST")}else if("HALF_FLOAT"==l)if("webgl2"==i.name);else{if(!i.supportUploadingHalfFloat&&null!=o)throw new Error("Safari does not support uploading HALF_FLOAT texture data.");if(!i.__ext_half_float)throw new Error("OES_texture_half_float is not available");if("LINEAR"!=c||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),h="NEAREST"),"RGB"==a)throw new Error("OES_texture_half_float onlysupports RGBA textures")}else if("sRGB"==l&&!i.__ext_sRGB)throw new Error("EXT_sRGB is not available");this.__formatParam=a,this.__typeParam=l,this.__minFilterParam=c,this.__magFilterParam=h,this.__wrapParam=d,this.__format=i[a],this.__internalFormat="internalFormat"in t?i[t.internalFormat]:this.__format,this.__type=i[l],"webgl2"==i.name&&("internalFormat"in t||(this.__type==i.FLOAT?this.__format==i.RED?this.__internalFormat=i.R32F:this.__format==i.RG?this.__internalFormat=i.RG32F:this.__format==i.RGB?this.__internalFormat=i.RGB32F:this.__format==i.RGBA&&(this.__internalFormat=i.RGBA32F):this.__type==i.HALF_FLOAT?this.__format==i.RED?this.__internalFormat=i.R16F:this.__format==i.RG?this.__internalFormat=i.RG16F:this.__format==i.RGB?this.__internalFormat=i.RGB16F:this.__format==i.RGBA&&(this.__internalFormat=i.RGBA16F):this.__type==i.UNSIGNED_BYTE&&(this.__format==i.RED&&(this.__internalFormat=i.R8),this.__format==i.RG&&(this.__internalFormat=i.RG8),this.__format==i.RGB?this.__internalFormat=i.RGB8:this.__format==i.RGBA&&(this.__internalFormat=i.RGBA8)))),this.__minFilter=i[c],this.__magFilter=i[h],this.__wrap=i[d],this.__flipY="flipY"in t&&t.flipY,this.__mipMapped="mipMapped"in t&&t.mipMapped,this.invert="invert"in t&&t.invert,this.alphaFromLuminance="alphaFromLuminance"in t&&t.alphaFromLuminance,this.textureDesc=[n,s,0,0],this.__gltex&&i.deleteTexture(this.__gltex),this.__gltex=i.createTexture(),this.__updateGLTexParams(),o?this.bufferData(o,n,s,!1,!1):this.resize(n,s,!1,!1),this.__loaded||(this.emit("ready",{}),this.__loaded=!0)}__updateGLTexParams(){const t=this.__gl;t.bindTexture(t.TEXTURE_2D,this.__gltex),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.__minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.__magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.__wrap),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.__wrap)}bufferData(t,e=-1,i=-1,n=!0,s=!0){const o=this.__gl;if(n&&o.bindTexture(o.TEXTURE_2D,this.__gltex),null!=t){if(t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement)o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,this.__format,this.__type,t),this.width=t.width,this.height=t.height;else{-1==e&&(e=this.width),-1==i&&(i=this.height);const n=e*i;let s;switch(this.__format){case o.RED:case o.RED_INTEGER:case o.ALPHA:case o.LUMINANCE:case o.LUMINANCE_ALPHA:s=1;break;case o.RG:s=2;break;case o.RGB:s=3;break;case o.RGBA:s=4}t.length!=n*s&&console.warn("Invalid data for Image width:"+e+" height:"+i+" format:"+this.__formatParam+" type:"+this.__typeParam+" Data Length:"+t.length+" Expected:"+n*s),this.__type==o.HALF_FLOAT&&t instanceof Float32Array&&(t=Math.convertFloat32ArrayToUInt16Array(t)),"webgl2"==o.name?o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,e,i,0,this.__format,this.__type,t,0):o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,e,i,0,this.__format,this.__type,t),this.width=e,this.height=i}this.__mipMapped&&o.generateMipmap(o.TEXTURE_2D)}else o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,this.width,this.height,0,this.__format,this.__type,null),this.width=e,this.height=i;s&&this.emit("updated",{})}clear(){const t=this.__gl,e=this.width*this.height;let i,n;switch(this.__format){case t.RED:case t.RED_INTEGER:case t.ALPHA:case t.LUMINANCE:case t.LUMINANCE_ALPHA:i=1;break;case t.RG:i=2;break;case t.RGB:i=3;break;case t.RGBA:i=4;break;default:throw new Error("Invalid Format")}switch(this.__type){case t.UNSIGNED_BYTE:n=new UInt8Array(e*i);break;case t.HALF_FLOAT:n=new UInt16Array(e*i);break;case t.FLOAT:n=new Float32Array(e*i);break;default:throw new Error("Invalid Type")}"webgl2"==t.name?t.texImage2D(t.TEXTURE_2D,0,this.__internalFormat,this.width,this.height,0,this.__format,this.__type,n,0):t.texImage2D(t.TEXTURE_2D,0,this.__internalFormat,this.width,this.height,0,this.__format,this.__type,n)}resize(t,e,i=!1,n=!0){const s=this.__gl;if(this.width!=t||this.height!=e){const o=s.getParameter(s.MAX_TEXTURE_SIZE);if(t<0||t>o||e<0||e>o)throw new Error("gl-texture2d: Invalid texture size. width:"+t+" height:"+e+" maxSize:"+o);if(i){const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i),s.texImage2D(s.TEXTURE_2D,0,this.__internalFormat,t,e,0,this.__format,this.__type,null);const n=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,n),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this.__gltex,0),s.bindTexture(s.TEXTURE_2D,i),s.copyTexImage2D(s.TEXTURE_2D,0,this.__internalFormat,0,0,this.width,this.height,0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteFramebuffer(n),this.__gl.deleteTexture(this.__gltex),this.__gltex=i,this.__updateGLTexParams()}else s.bindTexture(s.TEXTURE_2D,this.__gltex),s.texImage2D(s.TEXTURE_2D,0,this.__internalFormat,t,e,0,this.__format,this.__type,null);this.width=t,this.height=e,n&&this.emit("resized",{width:t,height:e})}}populate(t,e,i,n=0,s=0,o=!0){const r=this.__gl;o&&r.bindTexture(r.TEXTURE_2D,this.__gltex),r.texSubImage2D(r.TEXTURE_2D,0,n,s,e,i,this.__format,this.__type,t)}getSize(){return[this.width,this.height]}get glTex(){return this.__gltex}getTexHdl(){return this.__gltex}bind(t,e){return console.warn("'bind' is deprecated. Please use 'bindToUniform'"),this.bindToUniform(t,e)}preBind(t,e){return{textureTypeUnif:e[t.name+"Type"],textureDescUnif:e[t.name+"Desc"]}}bindToUniform(t,e,i){if(!this.__loaded)return!1;if(!this.__gltex)throw new Error("Unable to bind non-initialized or deleted texture.");const n=t.boundTextures++,s=this.__gl;return s.activeTexture(this.__gl.TEXTURE0+n),s.bindTexture(s.TEXTURE_2D,this.__gltex),s.uniform1i(e.location,n),i&&(i.textureTypeUnif&&s.uniform1i(i.textureTypeUnif.location,this.textureType),i.textureDescUnif&&this.__gl.uniform4fv(i.textureDescUnif.location,this.textureDesc)),!0}destroy(){super.destroy(),this.__texture&&this.__texture.setMetadata("gltexture",void 0),this.__gl.deleteTexture(this.__gltex),this.__gltex=void 0}}class wa{constructor(t,e,i,n){this.__gl=t,this.__shaderAttrs=e,this.__glattrbuffers=i,this.__indexBuffer=n}bind(t){const e=this.__gl;for(const i in this.__shaderAttrs){if("instancedIds"==i)continue;const t=this.__shaderAttrs[i],n=t.location;if(-1==n)continue;const s=this.__glattrbuffers[i];if(!s){e.disableVertexAttribArray(n);continue}let o,r,a;switch(s.dataType){case 0:o=1,r=4,a=e.UNSIGNED_BYTE;break;case 1:o=1,r=4,a=e.BYTE;break;case 2:o=1,r=4,a=e.UNSIGNED_SHORT;break;case 3:o=1,r=4,a=e.SHORT;break;case 4:o=1,r=4,a=e.UNSIGNED_INT;break;case 5:o=1,r=4,a=e.INT;break;case 6:o=1,r=4,a=e.FLOAT;break;case _:o=2,r=4,a=e.FLOAT;break;case Z:o=3,r=4,a=e.FLOAT;break;case G:case y$2:o=4,r=4,a=e.FLOAT;break;case X:o=4,r=1,a=e.UNSIGNED_BYTE;break;default:throw"Unhandled Type"}const l=o*r,c=null!=s.offset?s.offset*o*r:0,h=1==s.normalized,d=t.instanced;e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,s.buffer),e.vertexAttribPointer(n,o,a,h,l,c),e.vertexAttribDivisor&&e.vertexAttribDivisor(n,1==d?1:0)}return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),!0}unbind(){const t=this.__gl;for(const e in this.__shaderAttrs){const i=this.__shaderAttrs[e].location;-1!=i&&(t.disableVertexAttribArray(i),t.vertexAttribDivisor(i,0))}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}destroy(){}}class za{constructor(t,e,i,n){this.__gl=t,this.__vao=t.createVertexArray(),t.bindVertexArray(this.__vao);for(const s in e){if("instancedIds"==s)continue;const n=e[s],o=n.location;if(-1==o)continue;const r=i[s];if(!r){t.disableVertexAttribArray(o);continue}let a,l,c;switch(r.dataType){case 0:a=1,l=4,c=t.UNSIGNED_BYTE;break;case 1:a=1,l=4,c=t.BYTE;break;case 2:a=1,l=4,c=t.UNSIGNED_SHORT;break;case 3:a=1,l=4,c=t.SHORT;break;case 4:a=1,l=4,c=t.UNSIGNED_INT;break;case 5:a=1,l=4,c=t.INT;break;case 6:a=1,l=4,c=t.FLOAT;break;case _:a=2,l=4,c=t.FLOAT;break;case Z:a=3,l=4,c=t.FLOAT;break;case G:case y$2:a=4,l=4,c=t.FLOAT;break;case X:a=4,l=1,c=t.UNSIGNED_BYTE;break;default:throw"Unhandled Type"}const h=a*l,d=null!=r.offset?r.offset*a*l:0,u=1==r.normalized,m=n.instanced;t.enableVertexAttribArray(o),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(o,a,c,u,h,d),t.vertexAttribDivisor(o,m?1:0)}this.__indexBuffer=n}bind(t){return this.__gl.bindVertexArray(this.__vao),this.__indexBuffer&&this.__gl.bindBuffer(this.__gl.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),!0}unbind(){const t=this.__gl;for(const e in this.__shaderAttrs){const i=this.__shaderAttrs[e].location;-1!=i&&(t.disableVertexAttribArray(i),t.vertexAttribDivisor(i,0))}this.__gl.bindVertexArray(null),this.__indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}destroy(){this.__gl.deleteVertexArray(this.__vao)}}function Ua(t,e,i,n){return null==t.createVertexArray?new wa(t,e,i,n):new za(t,e,i,n)}class Ja extends U{constructor(t,e){super(),this.__gl=t,this.__geom=e,this.__glattrs={},this.__glattrbuffers={},this.__shaderBindings={},this.__geom.addListener("geomDataChanged",t=>{this.updateBuffers(t),this.emit("updated",{})}),this.__geom.addListener("geomDataTopologyChanged",t=>{this.clearShaderBindings(),this.updateBuffers(t),this.emit("updated",{})})}getGeom(){return this.__geom}genBuffers(){}updateBuffers(t){}bind(t){if(this.__destroyed)throw new Error("Error binding a destroyed geom");let e=this.__shaderBindings[t.shaderkey];return e||(e=Ua(this.__gl,t.attrs,this.__glattrbuffers,this.__indexBuffer),this.__shaderBindings[t.shaderkey]=e),e.bind(t),!0}unbind(t){const e=this.__shaderBindings[t.shaderkey];e&&e.unbind(t)}draw(){throw new Error("Not implemented. Implement this method in a derived class.")}drawInstanced(t){throw new Error("Not implemented. Implement this method in a derived class.")}bindAndDraw(t){this.bind(t),this.draw(t)}clearShaderBindings(){for(const t in this.__shaderBindings)this.__shaderBindings[t].destroy();this.__shaderBindings={}}destroy(){this.__geom.deleteMetadata("glgeom"),this.clearShaderBindings();const t=this.__gl;for(const e in this.__glattrbuffers){const i=this.__glattrbuffers[e];i.shared||t.deleteBuffer(i.buffer)}this.__glattrs={},this.__shaderBindings={},this.__destroyed=!0}}class Pa extends Ja{constructor(t,e){super(t,e),this.genBuffers()}getNumTriangles(){return this.__numTriangles}genBuffers(){super.genBuffers();const t=this.__gl,e=this.__geom.genBuffers(),i=e.indices;this.__numTriIndices=e.indices.length,i instanceof Uint8Array&&(this.__indexDataType=this.__gl.UNSIGNED_BYTE),i instanceof Uint16Array&&(this.__indexDataType=this.__gl.UNSIGNED_SHORT),i instanceof Uint32Array&&(this.__indexDataType=this.__gl.UNSIGNED_INT),this.__numTriangles=i.length/3,this.__numRenderVerts=e.numRenderVerts,this.__indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices,t.STATIC_DRAW);for(const n in e.attrBuffers){const i=e.attrBuffers[n],s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,i.values,t.STATIC_DRAW),this.__glattrbuffers[n]={buffer:s,dataType:i.dataType,normalized:i.normalized},"textureCoords"==n&&(this.__glattrbuffers.texCoords=this.__glattrbuffers.textureCoords)}}updateBuffers(t){const e=this.__gl,i=this.__geom.genBuffers({includeIndices:!1});for(const n in i.attrBuffers){const t=i.attrBuffers[n];e.bindBuffer(e.ARRAY_BUFFER,this.__glattrbuffers[n].buffer),e.bufferData(e.ARRAY_BUFFER,t.values,e.STATIC_DRAW)}}getNumUnSplitVerts(){return this.__geom.vertices.length}getNumSplitVerts(){return this.__numRenderVerts}generateWireframesVAO(){if(!this.__vao)return!1;this.__geom.edgeVerts||this.__geom.genTopologyInfo(),this.__wireframesVao&&this.__ext.deleteVertexArrayOES(this.__wireframesVao),this.__wireframesVao=this.__ext.createVertexArrayOES(),this.__ext.bindVertexArrayOES(this.__wireframesVao);const t=this.__gl,e=t.createBuffer(),i=Uint32Array.from(this.__geom.edgeVerts);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW);const n=this.__glattrbuffers.positions.buffer;t.enableVertexAttribArray(0),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(0,3,t.FLOAT,!1,12,0),this.__numWireIndices=i.length,this.__ext.bindVertexArrayOES(null)}bindWireframeVAO(t){return null!=this.__wireframesVao&&(this.__ext.bindVertexArrayOES(this.__wireframesVao),!0)}unbindWireframeVAO(){this.__ext.bindVertexArrayOES(null)}drawWireframe(){this.__wireframesVao&&this.__gl.drawElements(this.__gl.LINES,this.__numWireIndices,this.__gl.UNSIGNED_INT,0)}generateHardEdgesVAO(){if(!this.__vao)return!1;this.__geom.edgeVerts||this.__geom.generateHardEdgesFlags(),this.__hardEdgesVao&&this.__ext.deleteVertexArrayOES(this.__hardEdgesVao),this.__hardEdgesVao=this.__ext.createVertexArrayOES(),this.__ext.bindVertexArrayOES(this.__hardEdgesVao);const t=this.__gl,e=t.createBuffer(),i=Uint32Array.from(this.__geom.computeHardEdgesIndices());t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW);const n=this.__glattrbuffers.positions.buffer;t.enableVertexAttribArray(0),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(0,3,t.FLOAT,!1,12,0),this.__numEdgeIndices=i.length,this.__ext.bindVertexArrayOES(null)}bindHardEdgesVAO(t){return null!=this.__hardEdgesVao&&(this.__ext.bindVertexArrayOES(this.__hardEdgesVao),!0)}unbindHardEdgesVAO(){this.__ext.bindVertexArrayOES(null)}drawHardEdges(){this.__hardEdgesVao&&this.__gl.drawElements(this.__gl.LINES,this.__numEdgeIndices,this.__gl.UNSIGNED_INT,0)}drawPoints(){this.__gl.drawArrays(this.__gl.POINTS,0,this.__geom.numVertices())}draw(){this.__gl.drawElements(this.__gl.TRIANGLES,this.__numTriIndices,this.__indexDataType,0)}drawInstanced(t){this.__gl.drawElementsInstanced(this.__gl.TRIANGLES,this.__numTriIndices,this.__indexDataType,0,t)}destroy(){super.destroy(),this.__gl.deleteBuffer(this.__indexBuffer),this.__indexBuffer=void 0}}class Ea extends Ja{constructor(t,e){super(t,e),this.genBuffers()}genBuffers(){super.genBuffers();const t=this.__gl,e=this.__geom.genBuffers(),i=e.indices;if(this.fatLines=(this.__geom.lineThickness>0||e.attrBuffers.lineThickness)&&t.floatTexturesSupported,this.fatLines){t.__quadVertexIdsBuffer||t.setupInstancedQuad(),this.__glattrbuffers.vertexIDs=t.__quadattrbuffers.vertexIDs,this.__drawCount=i.length/2;const e=this.__geom.getVertexAttributes(),n=e.positions,s=e.lineThickness,o=new Float32Array(4*n.length);for(let t=0;t<n.length;t++)Z.createFromFloat32Buffer(o.buffer,4*t).setFromOther(n.getValueRef(t)),o[4*t+3]=s?s.getFloat32Value(t):this.__geom.lineThickness;this.__positionsTexture=new Ka(t,{format:"RGBA",type:"FLOAT",width:n.length,height:1,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",data:o,mipMapped:!1});const r=new Float32Array(i.length);for(let t=0;t<i.length;t++){let e;e=t%2==0?t>0?i[t]==i[t-1]:i[t]==i[i.length-1]:t<i.length-1?i[t]==i[t+1]:i[t]==i[0],r[t]=(e?1:0)+2*i[t]}const a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),this.__glattrbuffers.segmentIndices={buffer:a,dimension:2}}else{this.__indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW);for(const i in e.attrBuffers){const n=e.attrBuffers[i],s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,n.values,t.STATIC_DRAW),this.__glattrbuffers[i]={buffer:s,dataType:n.dataType,normalized:n.normalized}}this.__numSegIndices=i.length,this.__numVertices=e.numVertices}i instanceof Uint8Array&&(this.__indexDataType=this.__gl.UNSIGNED_BYTE),i instanceof Uint16Array&&(this.__indexDataType=this.__gl.UNSIGNED_SHORT),i instanceof Uint32Array&&(this.__indexDataType=this.__gl.UNSIGNED_INT)}updateBuffers(t){const e=this.__gl,i=this.__geom.genBuffers(),n=i.indices;if(this.fatLines){this.__drawCount=n.length/2;const t=this.__geom.getVertexAttributes(),i=t.positions,s=t.lineThickness,o=new Float32Array(4*i.length);for(let e=0;e<i.length;e++)Z.createFromFloat32Buffer(o.buffer,4*e).setFromOther(i.getValueRef(e)),o[4*e+3]=s?s.getFloat32Value(e):this.__geom.lineThickness;this.__positionsTexture.bufferData(o,i.length,1);const r=new Float32Array(n.length);for(let e=0;e<n.length;e++){let t;t=e%2==0?e>0&&n[e]==n[e-1]:e<n.length-1&&n[e]==n[e+1],r[e]=(t?1:0)+2*n[e]}e.bindBuffer(e.ARRAY_BUFFER,this.__glattrbuffers.segmentIndices.buffer),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}else{if(this.__geom.getVertexAttributes(),t&&t.indicesChanged){const t=this.__geom.getIndices();this.__numSegIndices!=t.length&&(e.deleteBuffer(this.__indexBuffer),this.__indexBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.__numSegIndices=t.length}const s=i.numVertices!=this.__numVertices;for(const t in i.attrBuffers){const n=i.attrBuffers[t],o=this.__glattrbuffers[t];s&&(e.deleteBuffer(o.buffer),o.buffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,o.buffer),e.bufferData(e.ARRAY_BUFFER,n.values,e.STATIC_DRAW)}this.__numVertices=i.numVertices,this.__numSegIndices=n.length}n instanceof Uint8Array&&(this.__indexDataType=this.__gl.UNSIGNED_BYTE),n instanceof Uint16Array&&(this.__indexDataType=this.__gl.UNSIGNED_SHORT),n instanceof Uint32Array&&(this.__indexDataType=this.__gl.UNSIGNED_INT)}bind(t){if(this.fatLines&&"LineThickness"in t.unifs){const e=this.__gl;let i=this.__shaderBindings[t.shaderkey];i||(i=Ua(e,t.attrs,this.__glattrbuffers,e.__quadIndexBuffer),this.__shaderBindings[t.shaderkey]=i),i.bind(t);{const i=t.unifs;i.positionsTexture&&(this.__positionsTexture.bindToUniform(t,i.positionsTexture),e.uniform1i(i.positionsTextureSize.location,this.__positionsTexture.width))}return e.uniform1f(t.unifs.LineThickness.location,(this.__geom.lineThickness?this.__geom.lineThickness:1)*t.viewScale),!0}return super.bind(t)}drawPoints(){this.__gl.drawArrays(this.__gl.POINTS,0,this.__geom.numVertices())}draw(t){const e=this.__gl;this.fatLines?t.unifs.LineThickness&&e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,this.__drawCount):e.drawElements(this.__gl.LINES,this.__numSegIndices,this.__indexDataType,0)}drawInstanced(t){this.__gl.drawElementsInstanced(this.__gl.LINES,this.__numSegIndices,this.__indexDataType,0,t)}}class Ha extends Ja{constructor(t,e){super(t,e),this.genBuffers()}genBuffers(){super.genBuffers();const t=this.__gl,e=this.__geom.genBuffers();for(const i in e.attrBuffers){const n=e.attrBuffers[i],s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,n.values,t.STATIC_DRAW),this.__glattrbuffers[i]={buffer:s,dataType:n.dataType,normalized:n.normalized}}this.__numVerts=e.numVertices,this.__vboState=2}bind(t){if(t.unifs.PointSize){const e=this.__gl;let i=this.__shaderBindings[t.shaderkey];if(!i){e.__quadVertexIdsBuffer||e.setupInstancedQuad();const n=Object.assign(this.__glattrbuffers,e.__quadattrbuffers);i=Ua(e,t.attrs,n,e.__quadIndexBuffer),this.__shaderBindings[t.shaderkey]=i}return i.bind(t),!0}return super.bind(t)}draw(t){const e=this.__gl;t.unifs.PointSize?e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,this.__numVerts):e.drawArrays(e.POINTS,0,this.__numVerts)}drawInstanced(t){this.__gl.drawArraysInstanced(this.__gl.POINTS,0,this.__numVerts,t)}}const ka={bool:Boolean,int:5,uint:4,float:6,ivec2:_,ivec3:Z,ivec4:G,vec2:_,vec3:Z,vec4:G,color:y$2,mat3:V,mat4:I,sampler2D:we},Ba=new class{constructor(){this.__shaderModules={}}hasShaderModule(t){return t in this.__shaderModules}setShaderModule(t,e){return this.parseShader(t,e)}getShaderModule(t){return this.__shaderModules[t]}getShaderModuleNames(){const t=[];for(const e in this.__shaderModules)t.push(e);return t}parseShader(t,e){const i=t=>t.startsWith("..")?n.substring(0,n.lastIndexOf("/"))+t.substring(2):t.startsWith(".")?n+t.substring(1):t.startsWith("/")?t.substring(1):t,n=(m$2(t),t.substring(0,t.lastIndexOf("/"))),s=e.split("\n"),o={glsl:" //starting:"+t+"\n",lines:s,numLines:0,includeMetaData:[],uniforms:{},attributes:{}},r=/\s+/;for(let a=0;a<s.length;a++){let e=s[a],n=e.trim();if(n.startsWith("//")||n.startsWith("*"))o.glsl=o.glsl+e+"\n",o.numLines++;else if(-1!=n.indexOf("//")&&(n=n.slice(0,n.indexOf("//")).trim()),n.startsWith("<%")||n.startsWith("</%")){const n=function(t){const e=(t=(t=t.startsWith("</%")?t.slice(3):t.slice(2)).endsWith("/>")?t.slice(0,t.length-2):t.slice(0,t.length-1)).split(r),i={tag:e.shift(),attributes:{}};for(const n of e){const t=n.split("=");i.attributes[t[0]]=t[1].replace(/['"]+/g,"")}return i}(s[a].trim());switch(n.tag){case"include":{const e=i(n.attributes.file);if(!this.hasShaderModule(e))throw new Error("Error while parsing :"+t+" \nShader module not found:"+e+"\n in:"+this.getShaderModuleNames());const s=this.getShaderModule(e);m$2(n.attributes.file);let r=s.glsl;r=r.substring(r.indexOf("\n")+1),o.glsl=o.glsl+" //including:"+n.attributes.file+"\n";const l={};for(const t in n.attributes){if("file"==t)continue;const e=n.attributes[t];r=r.replaceAll(t,e),l[t]=e}o.glsl=o.glsl+r,o.includeMetaData.push({src:o.numLines,tgt:a,length:s.numLines,key:e}),o.glsl=o.glsl+" //continuing:"+t+"\n",o.numLines+=s.numLines+1;for(const t in s.attributes){let e=t;for(const t in l)e=e.replaceAll(t,l[t]);o.attributes[e]=s.attributes[t]}for(const t in s.uniforms){let e=t;for(const t in l)e=e.replaceAll(t,l[t]);o.uniforms[e]=s.uniforms[t]}break}default:console.warn("Error while parsing :"+t+" \nUnhandled line:"+e);continue}}else{const i=(i,n)=>{if(!(i[1]in ka))throw new Error("Error while parsing :"+t+" \nType not recognized:"+i[1]);const s=i[2].slice(0,i[2].length-1);o.attributes[s]={type:ka[i[1]],instanced:n},"color"==i[1]&&(i[1]="vec4",e=i.join(" "))};if(n.startsWith("struct")){let t="";if(-1!=n.indexOf("}"))t=n.substring(n.indexOf("{")+1,n.indexOf("}")-1);else for(a++;e+=s[a]+"\n",t+=e.trim(),a++,-1==t.indexOf("}"););const i=t.substring(t.indexOf("{")+1,t.indexOf("}")-1).split(";"),o=[];for(const e of i){if(0==e.length)continue;const t=e.trim().split(r);o.push({name:t[1],type:ka[t[0]]})}const l=n.split(r);ka[l[1]]=o}if(n.startsWith("attribute")&&i(n.split(r),!1),n.startsWith("instancedattribute")){const t=n.split(r);i(t,!0),t[0]="attribute",e=t.join(" ")}else if(n.startsWith("uniform")){const i=n.split(r);let s=1;4==i.length&&(s=2);const a=i[s];if(!(a in ka))throw new Error("Error while parsing :"+t+" \nType not recognized:"+i[1]);const l=i[s+1].slice(0,i[s+1].length-1);o.uniforms[l]=ka[a],"struct"==o.uniforms[l]&&console.log(i),"color"==i[1]&&(i[1]="vec4",e=i.join(" "))}o.glsl=o.glsl+e+"\n",o.numLines++}}return this.__shaderModules[t]=o,o}};let Da=0;class Oa extends te{constructor(t){if(super(),!t)throw new Error("gl context must be passed to shader constructor");this.__gl=t,this.__shaderStages={VERTEX_SHADER:{glsl:"",lines:0,uniforms:{},attributes:{}},FRAGMENT_SHADER:{glsl:"",lines:0,uniforms:{},attributes:{}}},this.__shaderProgramHdls={},this.__gltextures={},this.__id=Da++,this.invisibleToGeomBuffer=!1}static isTransparent(){return!1}static isOverlay(){return!1}__compileShaderStage(t,e,i,n){const s=this.__gl;if(n||(n=s.shaderopts),n){if(n.repl)for(const e in n.repl)t=t.replaceAll(e,n.repl[e]);n.defines&&(t=n.defines+t)}"webgl2"==s.name&&(t="#version 300 es\n"+(t=(t=(t=t.replaceAll("attribute","in")).replaceAll("varying","vertexShader"==i?"out":"in")).replaceAll("texture2D","texture")));const o=s.createShader(e);if(s.shaderSource(o,t),s.compileShader(o),!s.getShaderParameter(o,s.COMPILE_STATUS)){console.log("Errors in :"+this.constructor.name);const e=s.getShaderInfoLog(o).split("\n"),n={};for(let t in e){if(e[t].startsWith("'")){e[t-1]=e[t-1]+e[t],delete e[t],t--;continue}const i=e[t].split(":");if(i.length>=2){const s=parseInt(i[2]);isNaN(s)||(n[s]?n[s].push(e[t]):n[s]=[e[t]])}}const r=[],a=t.split("\n");for(let t=0;t<a.length;t++)if(r.push((t+1+":").lpad(" ",3)+a[t]),t+1 in n){const e=n[t+1];for(const t of e)r.push(t),r.push("-".lpad("-",t.length))}throw new Error("An error occurred compiling the shader \n=================\n"+this.constructor.name+"."+i+": \n\n"+e.join("\n")+"\n"+r.join("\n"))}return o}__createProgram(t){const e=this.__gl;this.__shaderCompilationAttempted=!0;const i=e.createProgram(),n=this.__shaderStages.VERTEX_SHADER.glsl,s={};if(null!=n){const o=this.__compileShaderStage(n,e.VERTEX_SHADER,"vertexShader",t);if(!o)return!1;e.attachShader(i,o),s[e.VERTEX_SHADER]=o}const o=this.__shaderStages.FRAGMENT_SHADER.glsl;if(null!=o){const n=Object.assign({},e.shaderopts,t);n.frag&&(n.defines=n.frag.defines+n.defines);const r=this.__compileShaderStage(o,e.FRAGMENT_SHADER,"fragmentShader",n);if(!r)return!1;e.attachShader(i,r),s[e.FRAGMENT_SHADER]=r}if(e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);if(t.includes("D3D shader compilation failed")){const t=e.getExtension("WEBGL_debug_shaders");if(t){const i=t.getTranslatedShaderSource(s[e.VERTEX_SHADER]);console.log(i)}}throw console.log("vertexShaderGLSL:"+n),console.log("fragmentShaderGLSL:"+o),new Error("Unable to link the shader program:"+this.constructor.name+"\n==================\n"+t)}const r=this.__extractAttributeAndUniformLocations(i,t);return r.shaderProgramHdl=i,r}__extractAttributeAndUniformLocations(t,e){const i=this.__gl,n=this.getAttributes(),s={attrs:{},unifs:{}};for(const r in n){const e=i.getAttribLocation(t,r);if(null==e){console.warn("Shader attribute not found:"+r);continue}const o=n[r];s.attrs[r]={name:r,location:e,type:o.type,instanced:o.instanced}}const o=this.getUniforms();for(let r in o){const n=o[r];if(n instanceof Array)for(const e of n){const n=r+"."+e.name,o=i.getUniformLocation(t,n);null!=o&&(s.unifs[n]={name:n,location:o,type:e.type})}if(e&&e.repl)for(const t in e.repl)r=r.replace(t,e.repl[t]);const a=i.getUniformLocation(t,r);null!=a&&(s.unifs[r]={name:r,location:a,type:n})}return s}getAttributes(){const t={};for(const e in this.__shaderStages){const i=this.__shaderStages[e];for(const e in i.attributes)t[e]=i.attributes[e]}return t}getUniforms(){const t={};for(const e in this.__shaderStages){const i=this.__shaderStages[e];for(const e in i.uniforms)t[e]=i.uniforms[e]}return t}finalize(){}compileForTarget(t,e){const i=t?this.__id+t:this.__id;let n=this.__shaderProgramHdls[i];return n||!1!==n&&(n=this.__createProgram(e),n.shaderkey=i,this.__shaderProgramHdls[i]=n),n}compile(){this.compileForTarget()}bind(t,e){const i=this.__gl;if(t.glshader!=this){const n=this.compileForTarget(e,t.shaderopts);if(!1===n)return console.warn(this.constructor.name+" is not compiled for "+e),!1;i.useProgram(n.shaderProgramHdl),t.glshader=this,t.shaderkey=n.shaderkey,t.unifs=n.unifs,t.attrs=n.attrs,t.boundTextures=0,t.boundLightmap=void 0,t.glgeom=void 0,t.bindRendererUnifs&&t.bindRendererUnifs(n.unifs)}return t.supportsInstancing=!0,!0}unbind(t){return!0}static getParamDeclarations(){return[]}static getGeomDataShaderName(){}static getSelectedShaderName(){}destroy(){const t=this.__gl;for(const e in this.__shaderProgramHdls)t.deleteProgram(this.__shaderProgramHdls[e].shaderProgramHdl);this.__shaderProgramHdls={}}}Ba.setShaderModule("utils/quadVertexFromID.glsl","\n\nattribute float vertexIDs;\n\nvec2 getQuadVertexPositionFromID(){\n    int vertexID = int(vertexIDs);\n    if(vertexID == 0)\n        return vec2(-0.5, -0.5);\n    else if(vertexID == 1)\n        return vec2(0.5, -0.5);\n    else if(vertexID == 2)\n        return vec2(-0.5, 0.5);\n    else if(vertexID == 3)\n        return vec2(0.5, 0.5);\n    return vec2(0,0);\n}\n"),Ba.setShaderModule("utils/unpackHDR.glsl","\n\nvec3 decodeHDR(const in vec3 ldrPixel, const in float cdmAlpha) {\n    float avg = (cdmAlpha * 16.0 - 8.0);\n    float scl = 1.0;\n    vec3 color;\n    color.x = (tan((ldrPixel.x-0.5)*1.5)/scl)+avg;\n    color.y = (tan((ldrPixel.y-0.5)*1.5)/scl)+avg;\n    color.z = (tan((ldrPixel.z-0.5)*1.5)/scl)+avg;\n\n    // convert from logarithmic curve to linear curve.\n    // subtract the epsilon that was added during encoding.\n    const float eps = 0.001;\n    color.x = pow(10.0, color.x) - eps;\n    color.y = pow(10.0, color.y) - eps;\n    color.z = pow(10.0, color.z) - eps;\n    return color;\n}\n\nvec3 decodeHDR(sampler2D ldrSampler, sampler2D cdmSampler, vec2 texCoord) {\n#ifdef ENABLE_ES3\n    float cdm = texture2D(cdmSampler, texCoord).r;\n#else\n    float cdm = texture2D(cdmSampler, texCoord).a;\n#endif\n    return decodeHDR(texture2D(ldrSampler, texCoord).rgb, cdm);\n}\n\n");class Qa extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("UnpackHDRShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(position*2.0, 0.0, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("UnpackHDRShader.fragmentShader",'\nprecision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D ldrSampler;\nuniform sampler2D cdmSampler;\nuniform float exposure;\nuniform vec4 tint;\n\n<%include file="utils/unpackHDR.glsl"/>\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(decodeHDR(ldrSampler, cdmSampler, v_texCoord) * tint.rgb * exposure, 1.0);\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n\n')}}class Aa{constructor(e,i,n=!1){!t.isIOSDevice||"FLOAT"!=i.getType()&&"HALF_FLOAT"!=i.getType()||console.error("IOS devices are unable to render to float textures."),this.__gl=e,this.__colorTexture=i,this.__createDepthTexture=n,this.__clearColor=[0,0,0,0],this.__depthTexture=void 0,this.setup=this.setup.bind(this),this.resize=this.resize.bind(this),this.__colorTexture&&this.__colorTexture.addListener("resized",this.resize),this.setup()}setClearColor(t){this.__clearColor=t}getWidth(){return this.__colorTexture.width}getHeight(){return this.__colorTexture.height}getSize(){return[this.__colorTexture.width,this.__colorTexture.height]}getColorTexture(){return this.__colorTexture}getDepthTextureGL(){return this.__depthTexture}get width(){return this.__colorTexture.width}get height(){return this.__colorTexture.height}get size(){return[this.__colorTexture.width,this.__colorTexture.height]}get colorTexture(){return this.__colorTexture}setColorTexture(t){this.__colorTexture=t,gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.__colorTexture.glTex,0)}get depthTextureGL(){return this.__depthTexture}setup(){const t=this.__gl;if(this.__fbo=t.createFramebuffer(),t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,this.__fbo),this.__colorTexture&&t.framebufferTexture2D("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.__colorTexture.glTex,0),this.__createDepthTexture)if("webgl2"==t.name||t.__ext_WEBGL_depth_texture)t.activeTexture(t.TEXTURE0),this.__depthTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.__depthTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),"webgl2"==t.name?(t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT24,this.width,this.height,0,t.DEPTH_COMPONENT,t.UNSIGNED_INT,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.__depthTexture,0)):(t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT,this.width,this.height,0,t.DEPTH_COMPONENT,t.UNSIGNED_INT,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.__depthTexture,0));else{const e=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,e),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)}this.__checkFramebuffer(),t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,null)}resize(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,this.__fbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.__colorTexture.glTex,0),this.__depthTexture&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.__depthTexture),t.texImage2D(t.TEXTURE_2D,0,"webgl2"==t.name?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT,this.width,this.height,0,t.DEPTH_COMPONENT,t.UNSIGNED_INT,null)),this.__checkFramebuffer()}__checkFramebuffer(){const t=this.__gl;let e;if(e=t.checkFramebufferStatus("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER),e!==t.FRAMEBUFFER_COMPLETE)switch(t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,null),console.warn("Error creating Fbo width:",this.width,", height:",this.height," Texture Type:",this.__colorTexture.getType()),e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete.");case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("There is no attachment.");case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("Height and width of the attachment are not the same.");case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("The format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer.");case 36061:throw new Error("The framebuffer is unsupported");default:throw new Error("Incomplete Frambuffer")}}bindForWriting(t){t&&(this.__prevBoundFbo=t.boundRendertarget,t.boundRendertarget=this.__fbo);const e=this.__gl;e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.__fbo),e.viewport(0,0,this.width,this.height)}unbindForWriting(t){t&&(t.boundRendertarget=this.__prevBoundFbo);const e=this.__gl;e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.__prevBoundFbo)}bind(t){this.bindForWriting(t)}unbind(t){this.unbindForWriting(t)}bindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,this.__fbo)}unbindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,null)}clear(){const t=this.__gl;t.colorMask(!0,!0,!0,!0),t.clearColor(...this.__clearColor),t.clear(this.__createDepthTexture?t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT:t.COLOR_BUFFER_BIT)}bindAndClear(t){this.bind(t),this.clear(t)}unbind(){const t=this.__gl;t.bindFramebuffer(t.FRAMEBUFFER,null)}destroy(){const t=this.__gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.__fbo),this.__fbo=null,this.__colorTexture.removeListener("resized",this.resize)}}class ja extends Ka{constructor(t,e){super(t),this.__hdrImage=e,this.__hdrImage.setMetadata("gltexture",this);const i=()=>{this.__unpackHDRImage(this.__hdrImage.getParams())};this.__hdrImage.addListener("updated",i),this.__hdrImage.isLoaded()?i():this.__hdrImage.addListener("loaded",i)}__unpackHDRImage(t){const e=this.__gl,i=t.data.ldr,n=t.data.cdm;if(this.__fbo)this.__srcLDRTex.bufferData(i),this.__srcCDMTex.bufferData(n);else{this.configure({format:"RGBA",type:"FLOAT",width:i.width,height:i.height,filter:"LINEAR",wrap:"CLAMP_TO_EDGE"}),this.__fbo=new Aa(e,this),this.__fbo.setClearColor([0,0,0,0]),this.__srcLDRTex=new Ka(e,{format:"RGB",type:"UNSIGNED_BYTE",width:i.width,height:i.height,filter:"NEAREST",mipMapped:!1,wrap:"CLAMP_TO_EDGE",data:i}),this.__srcCDMTex=new Ka(e,{format:"webgl2"==e.name?"RED":"ALPHA",type:"UNSIGNED_BYTE",width:i.width,height:i.height,filter:"NEAREST",mipMapped:!1,wrap:"CLAMP_TO_EDGE",data:n}),this.__unpackHDRShader=new Qa(e);const t=this.__unpackHDRShader.compileForTarget("GLHDRImage");this.__shaderBinding=Ua(e,t.attrs,e.__quadattrbuffers,e.__quadIndexBuffer)}this.__fbo.bindAndClear();const s={};this.__unpackHDRShader.bind(s,"GLHDRImage"),this.__shaderBinding.bind(s);const o=s.unifs;this.__srcLDRTex.bindToUniform(s,o.ldrSampler),this.__srcCDMTex.bindToUniform(s,o.cdmSampler),e.uniform1f(o.exposure.location,1),e.uniform4fv(o.tint.location,this.__hdrImage.getHDRTint().asArray()),e.drawQuad(),this.__fbo.unbind(),this.emit("updated",{})}bindToUniform(t,e,i){return super.bindToUniform(t,e,i)}destroy(){super.destroy(),this.__fbo&&(this.__fbo.destroy(),this.__srcLDRTex.destroy(),this.__srcCDMTex.destroy()),this.__unpackHDRShader&&this.__unpackHDRShader.destroy(),this.__shaderBinding&&this.__shaderBinding.destroy(),this.__hdrImage.loaded.disconnectScope(this),this.__hdrImage.updated.disconnectScope(this)}}Ba.setShaderModule("GLSLUtils.glsl","\n\n\nint ftoi(float val){\n    return int(floor(val + 0.5));\n}\nivec2 ftoi(vec2 v2) {\n    return ivec2(ftoi(v2.x), ftoi(v2.y));\n}\nivec3 ftoi(vec3 v4) {\n    return ivec3(ftoi(v4.x), ftoi(v4.y), ftoi(v4.z));\n}\nivec4 ftoi(vec4 v4) {\n    return ivec4(ftoi(v4.x), ftoi(v4.y), ftoi(v4.z), ftoi(v4.w));\n}\n\n#ifdef ENABLE_ES3\n\nint imod(int x, int y) {\n    return x % y;\n}\n\nvoid setFlag(inout int flags, int flag) {\n    flags |= flag;\n}\n\nvoid clearFlag(inout int flags, int flag) {\n    flags &= ~flag;\n}\n\nbool testFlag(int flags, int flag) {\n    return (flags & flag) != 0;\n}\n\n// private function: Mangle me...\nivec2 _pixelIndexToUV(int index, int textureWidth){\n    return ivec2(index % textureWidth, index / textureWidth);\n}\n\nvec4 fetchTexel(sampler2D texture, int textureWidth, int index) {\n    return texelFetch(texture, _pixelIndexToUV(index, textureWidth), 0);\n}\n\nvec4 fetchTexel(sampler2D texture, ivec2 textureSize, ivec2 texCoord) {\n    return texelFetch(texture, texCoord, 0);\n}\n\n#else\n\n// TODO: integrate: https://gist.github.com/mattatz/70b96f8c57d4ba1ad2cd\n\nint max(int a, int b) {\n    return a > b ? a : b;\n}\nint min(int a, int b) {\n    return a < b ? a : b;\n}\n\n\nfloat round(float val){\n    return floor(val + 0.4);\n}\n\nint imod(int x, int y) {\n    return x-y*(x/y);\n}\n\nvoid setFlag(inout int flags, int flag) {\n    flags += flag;\n}\nvoid clearFlag(inout int flags, int flag) {\n    flags -= flag;\n}\n\nbool testFlag(int flags, int flag) {\n    return imod(flags / flag, 2) != 0;\n}\n\n// private function: Mangle me...\nvec2 _pixelIndexToUV(int index, int textureSize){\n    float flTexSize = float(textureSize);\n    float x = (float(imod(index, textureSize))+0.5)/flTexSize;\n    float y = (floor(float(index / textureSize))+0.5)/flTexSize;\n    return vec2(x, y);\n}\n\nvec4 fetchTexel(sampler2D texture, int textureSize, int index) {\n    vec2 texCoord = _pixelIndexToUV(index, textureSize);\n    return texture2D(texture, texCoord);\n}\n\nvec4 fetchTexel(sampler2D texture, ivec2 textureSize, ivec2 texCoord) {\n    vec2 ftextureSize = vec2(textureSize);\n    return texture2D(texture, (vec2(texCoord) + 0.5) / ftextureSize);\n}\n\n\n#endif // ENABLE_ES3\n\nint uvToPixelIndex(vec2 uv, int textureSize){\n    return int(uv.x * float(textureSize)) + (int(floor(uv.y * float(textureSize))) * textureSize);\n}\n\n\n\n"),Ba.setShaderModule("utils/ImageStream.glsl","\n\n// Stream Desc looks like the following\n// x : atlas Width in images\n// y : atlas height in images\n// z : image Width\n// w : image Height\n\nvec2 calcFrameImageTexCoords(vec2 texCoord, int index, in vec4 streamDesc){\n\tfloat index_x = floor(mod(float(index), streamDesc.x));\n\tfloat index_y = floor(float(index) / streamDesc.x);\n    return vec2( \n    \t(index_x + texCoord.x) / streamDesc.x, \n    \t(index_y + texCoord.y) / streamDesc.y\n    \t);\n}\n\nvec4 sampleStreamFrame(vec2 texCoord, int index, in sampler2D streamImage, in vec4 streamDesc){\n    return texture2D(streamImage, calcFrameImageTexCoords(texCoord, index, streamDesc));\n}\n\n");class qa extends U{constructor(t,e){super(),this.__gl=t,this.__streamImage=e,this.__descParam=this.__streamImage.getParameter("StreamAtlasDesc"),this.__indexParam=this.__streamImage.getParameter("StreamAtlasIndex"),this.__indexParam.addListener("valueChanged",()=>{this.emit("updated",{})});const i=()=>{const e=this.__streamImage.getParams();e.data.__atlasTexture||(e.data.__atlasTexture=new Ka(t,e)),this.__atlasTexture=e.data.__atlasTexture,this.__atlasTexture.textureType=2,this.__atlasTexture.textureDesc=this.__descParam.getValue().asArray()};this.__streamImage.isLoaded()?i():this.__indexParam.addListener("loaded",()=>{i()})}preBind(t,e){const i=this.__atlasTexture.preBind(t,e);return i.textureDescUnif=e[t.name+"Desc"],i.textureIndexUnif=e[t.name+"Index"],i}bindToUniform(t,e,i){return!!this.__atlasTexture.bindToUniform(t,e,i)&&(i&&i.textureIndexUnif&&this.__gl.uniform1i(i.textureIndexUnif.location,this.__indexParam.getValue()),!0)}}class $a{constructor(t,e,i,n){switch(this.__unif=n,n.type){case Boolean:this.uniformXX=t.uniform1i.bind(t);break;case 4:this.uniformXX="webgl2"==t.name?t.uniform1ui.bind(t):t.uniform1i.bind(t);break;case 5:this.uniformXX=t.uniform1i.bind(t);break;case 6:this.uniformXX=t.uniform1f.bind(t)}this.__val=i.getValue(),i.addListener("valueChanged",()=>{this.__val=i.getValue(),e.emit("updated",{})})}bind(t){this.uniformXX(this.__unif.location,this.__val)}unbind(){}destroy(){}}class ei{constructor(t,e,i,n){switch(this.__unif=n,n.type){case _:this.uniformXX=t.uniform2fv.bind(t);break;case Z:this.uniformXX=t.uniform3fv.bind(t);break;case G:this.uniformXX=t.uniform4fv.bind(t)}this.__vals=i.getValue().asArray(),i.addListener("valueChanged",()=>{this.__vals=i.getValue().asArray(),e.emit("updated",{})})}bind(t){this.uniformXX(this.__unif.location,this.__vals)}unbind(){}destroy(){}}class ti{constructor(t,e,i,n){switch(this.__unif=n,n.type){case Mat3:this.uniformMatrixXXX=t.uniformMatrix3fv.bind(t);break;case I:this.uniformMatrixXXX=t.uniformMatrix4fv.bind(t)}this.__vals=i.getValue().asArray(),i.addListener("valueChanged",()=>{this.__val=i.getValue().asArray(),e.emit("updated",{})})}bind(t){this.uniformMatrixXXX(this.__unif.location,!1,this.__val)}unbind(){}destroy(){}}class ai{constructor(t,e,i,n,s){this.__gl=t,this.__unif=n,this.__textureUnif=s[n.name+"Tex"],this.__textureTypeUnif=s[n.name+"TexType"],this.__vals=[0,0,0,0],this.bind=this.bindValue;const o=t=>{let i=t.getMetadata("gltexture");i||(i="FLOAT"===t.type?new ja(this.__gl,t):t.isStreamAtlas()?new qa(this.__gl,t):new Ka(this.__gl,t)),this.texBinding=i.preBind(this.__textureUnif,s),i.addListener("updated",()=>{e.emit("updated",{})}),this.gltexture=i,this.gltexture.addRef(this),this.textureType=1,this.bind=this.bindTexture,e.emit("updated",{})};let r,a;const l=()=>{o(r)},c=t=>{t.isLoaded()?o(t):t.addListener("loaded",l),r=t},h=()=>{r.getMetadata("gltexture").removeRef(this),this.texBinding=null,this.gltexture=null,this.textureType=null,this.bind=this.bindValue,a&&r.removeListenerById("loaded",a),r=null,a=null,e.emit("updated",{})},d=()=>{const t=i.getValue(!1);if(this.__vals=t.asArray(),this.__textureUnif){let t;i.getImage&&(t=i.getImage()),t&&t!=r?c(t):!t&&r&&h()}e.emit("updated")};d(),i.textureConnected&&i.addListener("textureConnected",()=>{c(i.getImage())}),i.addListener("valueChanged",d),this.uniform1i=t.uniform1i.bind(t),this.uniform4fv=t.uniform4fv.bind(t)}bindValue(t){this.uniform4fv(this.__unif.location,this.__vals),this.__textureTypeUnif&&this.uniform1i(this.__textureTypeUnif.location,0)}bindTexture(t){this.gltexture.bindToUniform(t,this.__textureUnif,this.texBinding)}}const ii={};class si{constructor(t,e,i,n){this.__uniformBindings=[];const s=s=>{const o=s.getName(),r=i[o];if(null!=r)switch(r.type){case Boolean:case 4:case 5:case 6:this.__uniformBindings.push(new $a(t,e,s,r));break;case _:case Z:case G:this.__uniformBindings.push(new ei(t,e,s,r));break;case y$2:this.__uniformBindings.push(new ai(t,e,s,r,i));break;case I:this.__uniformBindings.push(new ti(t,e,s,r));break;default:return void console.warn("Param :"+o+" has unhandled data type:"+r.type)}else if(n){const t=e.getMaterial().getShaderName();ii[t]||(ii[t]={}),ii[t][o]||(console.warn("Material:"+e.getMaterial().getName(),"with Shader ",t,"Param has no unif",o),ii[t][o]=!0)}},o=e.getMaterial().getParameters();for(const r of o)s(r)}bind(t){for(const e of this.__uniformBindings)e.bind(t);return!0}unbind(){for(const t of this.__uniformBindings)t.unbind(renderstate)}destroy(){for(const t of this.__uniformBindings)t.destroy(renderstate)}}class ni extends Y{constructor(t,e,i){super(),this.__gl=t,this.__material=e,this.__glshader=i,this.__shaderBindings={}}getMaterial(){return this.__material}getGLShader(){return this.__glshader}generateShaderBinding(){const t=this.__material.getParameters();for(const e of t)bindParam(gl,e)}bind(t,e){this.__boundTexturesBeforeMaterial=t.boundTextures;let i=this.__shaderBindings[t.shaderkey];return i||(i=new si(this.__gl,this,t.unifs,e),this.__shaderBindings[t.shaderkey]=i),i.bind(t)}unbind(t){t.boundTextures=this.__boundTexturesBeforeMaterial}}class li extends Y{constructor(t,e){super(),this.__gl=t,this.textureTargets=[],this.depthTexture=null,e&&this.configure(e)}configure(t){const e=this.__gl,i=function(t,e){if(!e.width||!e.height)throw new Error("Invalid texture params");const i=t.getParameter(t.MAX_TEXTURE_SIZE);if(e.width<=0||e.width>i||e.height<=0||e.height>i)throw new Error("GLTextureParams: Invalid texture size. width:"+e.width+" height:"+e.height+" maxSize:"+i);const n={width:e.width,height:e.height},s=(i,s)=>{i in e?n[i]=isNaN(e[i])?t[e[i]]:e[i]:s&&(n[i]=s)};if(s("format"),s("internalFormat",n.format),s("type",t.UNSIGNED_BYTE),s("minFilter",t.LINEAR),s("magFilter",t.LINEAR),s("wrapS",t.CLAMP_TO_EDGE),s("wrapT",t.CLAMP_TO_EDGE),s("flipY",!1),s("mipMapped",!1),s("depthFormat"),s("depthType"),n.format==t.FLOAT)if("webgl2"==t.name)n.filter!=t.LINEAR||t.__ext_float_linear||(console.warn("Floating point texture filtering not supported on result device"),n.filter=t.NEAREST);else if(t.__ext_float)n.filter!=t.LINEAR||t.__ext_float_linear||(console.warn("Floating point texture filtering not supported on result device"),n.filter=t.NEAREST);else{if(!t.__ext_half_float)throw new Error("OES_texture_half_float is not available");n.format=t.HALF_FLOAT,n.filter!=t.LINEAR||t.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on result device"),n.filter=t.NEAREST)}else if(n.format==t.HALF_FLOAT)if("webgl2"==t.name);else{if(!t.__ext_half_float)throw new Error("OES_texture_half_float is not available");if(n.filter!=t.LINEAR||t.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on result device"),n.filter=t.NEAREST),n.channels==t.RGB)throw new Error("OES_texture_half_float onlysupports RGBA textures")}else if("sRGB"==n.format&&!t.__ext_sRGB)throw new Error("EXT_sRGB is not available");return null!=n.format&&"webgl2"==t.name&&n.internalFormat==n.format&&(n.type==t.FLOAT?n.format==t.RED||n.format==t.RED?n.internalFormat=t.R32F:n.format==t.RG?n.internalFormat=t.RG32F:n.format==t.RGBA&&(n.internalFormat=t.RGBA32F):n.type==t.HALF_FLOAT?n.format==t.RED?n.internalFormat=t.R16F:n.format==t.RGB?n.internalFormat=t.RGB16F:n.format==t.RGBA&&(n.internalFormat=t.RGBA16F):n.type==t.UNSIGNED_BYTE&&(n.format==t.RED&&(n.internalFormat=t.R8),n.format==t.RGB?n.internalFormat=t.RGB8:n.format==t.RGBA&&(n.internalFormat=t.RGBA8))),null!=n.depthFormat&&("webgl2"==t.name?n.depthType==t.UNSIGNED_SHORT?n.depthInternalFormat=t.DEPTH_COMPONENT16:n.depthType==t.UNSIGNED_INT&&(n.depthInternalFormat=t.UNSIGNED_INT):n.depthInternalFormat=n.depthFormat),n}(e,t);this.textureTargets.forEach(t=>{e.deleteTexture(t)}),this.textureTargets=[],this.depthTexture&&(e.deleteTexture(this.depthTexture),this.depthTexture=null),this.frameBuffer&&e.deleteFramebuffer(this.frameBuffer),this.type=i.type,this.format=i.format,this.internalFormat=i.internalFormat,this.filter=i.filter,this.wrap=i.wrap,this.flipY=i.flipY,this.width=i.width,this.height=i.height,this.clearColor=new y$2(0,0,0,0),this.colorMask=[!0,!0,!0,!0],this.textureType=1,this.textureDesc=[this.width,this.height,0,0];const n=null!=t.numColorChannels?t.numColorChannels:null!=i.format?1:0;for(let o=0;o<n;o++){e.activeTexture(e.TEXTURE0+1);const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapS),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter),e.texImage2D(e.TEXTURE_2D,0,this.internalFormat,i.width,i.height,0,this.format,this.type,null),this.textureTargets.push(t)}if(i.depthFormat){if("webgl"==e.name&&!e.__ext_WEBGL_depth_texture)throw new Error("Depth textures not support on this device");e.activeTexture(e.TEXTURE0),this.depthTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.depthTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapS),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter),e.texImage2D(e.TEXTURE_2D,0,i.depthInternalFormat,i.width,i.height,0,i.depthFormat,i.depthType,null)}if(this.frameBuffer=e.createFramebuffer(),e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.frameBuffer),this.textureTargets.length>0){if(this.textureTargets.length>1&&"webgl"==e.name&&!e.drawBuffers){e.__ext_draw_buffers=e.getExtension("WEBGL_draw_buffers"),e.drawBuffers=e.__ext_draw_buffers.drawBuffersWEBGL.bind(e.__ext_draw_buffers);for(let t=1;t<14;t++)e["COLOR_ATTACHMENT"+t]=e.__ext_draw_buffers["COLOR_ATTACHMENT"+t+"_WEBGL"];e.MAX_COLOR_ATTACHMENTS=e.__ext_draw_buffers.MAX_COLOR_ATTACHMENTS_WEBGL,e.MAX_DRAW_BUFFERS=e.__ext_draw_buffers.MAX_DRAW_BUFFERS_WEBGL}const t=[];for(let i=0;i<this.textureTargets.length;i++)e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,this.textureTargets[i],0),t.push(e.COLOR_ATTACHMENT0+i);this.textureTargets.length>1&&e.drawBuffers(t)}this.depthTexture&&e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthTexture,0);const s=e.checkFramebufferStatus(e.DRAW_FRAMEBUFFER);if(s!=e.FRAMEBUFFER_COMPLETE)switch(s){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete.");case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("There is no attachment.");case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("Height and width of the attachment are not the same.");case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("The format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer.");case 36061:throw new Error("The framebuffer is unsupported");default:throw new Error("Incomplete Frambuffer")}this.unbind()}bindForWriting(t,e=!1){t&&(this.__prevBoundFbo=t.boundRendertarget,t.boundRendertarget=this.frameBuffer);const i=this.__gl;i.bindFramebuffer("webgl2"==i.name?i.DRAW_FRAMEBUFFER:i.FRAMEBUFFER,this.frameBuffer),i.viewport(0,0,this.width,this.height),e&&this.clear()}unbindForWriting(t){t&&(t.boundRendertarget=this.__prevBoundFbo);const e=this.__gl;e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.__prevBoundFbo)}clear(t=!0){const e=this.__gl;e.colorMask(...this.colorMask),e.clearColor(...this.clearColor.asArray());let i=0;this.textureTargets.length>0&&(i|=e.COLOR_BUFFER_BIT),this.depthTexture&&(i|=e.DEPTH_BUFFER_BIT),e.clear(i)}bindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,this.frameBuffer)}unbindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,null)}bindColorTexture(t,e,i=0){const n=this.__gl,s=t.boundTextures++;return n.uniform1i(e.location,s),n.activeTexture(n.TEXTURE0+s),n.bindTexture(n.TEXTURE_2D,this.textureTargets[i]),!0}bindDepthTexture(t,e){const i=this.__gl,n=t.boundTextures++;return i.uniform1i(e.location,n),i.activeTexture(i.TEXTURE0+n),i.bindTexture(i.TEXTURE_2D,this.depthTexture),!0}unbind(){const t=this.__gl;t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)}resize(t,e,i=!1){}bindToUniform(t,e,i){const n=t.boundTextures++,s=this.__gl;return s.activeTexture(this.__gl.TEXTURE0+n),s.bindTexture(s.TEXTURE_2D,this.textureTargets[0]),s.uniform1i(e.location,n),i&&(i.textureTypeUnif&&s.uniform1i(i.textureTypeUnif.location,this.textureType),i.textureDescUnif&&this.__gl.uniform4fv(i.textureDescUnif.location,this.textureDesc)),!0}destroy(){const t=this.__gl;this.textureTargets.forEach(e=>{t.deleteTexture(e)}),this.textureTargets=[],this.depthTexture&&(t.deleteTexture(this.depthTexture),this.depthTexture=null),this.frameBuffer&&t.deleteFramebuffer(this.frameBuffer)}}const ri=new Uint32Array(1);function di(t){return ri[0]=t,ri[0]=(ri[0]<<16|ri[0]>>16)>>>0,ri[0]=(1431655765&ri[0])<<1|(2863311530&ri[0])>>>1>>>0,ri[0]=(858993459&ri[0])<<2|(3435973836&ri[0])>>>2>>>0,ri[0]=(252645135&ri[0])<<4|(4042322160&ri[0])>>>4>>>0,ri[0]=(16711935&ri[0])<<8|(4278255360&ri[0])>>>8>>>0,2.3283064365386963e-10*ri[0]}function oi(t,e){return[t/e,di(t)]}Ba.setShaderModule("utils/imageAtlas.glsl","\n\n// Note: On mobile, I can't seem to pass around a stuct containing sampler2D.\n// I have to unpack the struct and pass its members. :(\n// struct ImageAtlas {\n//     sampler2D layout;\n//     sampler2D image;\n//     vec4 desc;\n// };\n\n\n\nvec4 getSubImageLayout(int index, in sampler2D atlasLayout, in vec4 atlasDesc){\n    return fetchTexel(atlasLayout, int(floor(atlasDesc.z+0.5)), index);\n}\n\nvec2 calcSubImageTexCoords(vec2 texCoord, int index, in sampler2D atlasLayout, in vec4 atlasDesc){\n    vec4 layoutData = fetchTexel(atlasLayout, int(floor(atlasDesc.z+0.5)), index);\n    // The following line is a hack to fix artifacts in our PBR lighting\n    // We were seeing loads of lighting garbage on some sufaces that were orthogonal\n    // to the world. The UV coordinates would have been landing right on the edges\n    // of our subimages and were often sampling outside the image. This couuld\n    // have been because of filtering, or an error in the uv coords. \n    texCoord = clamp(texCoord, vec2(0.01, 0.01), vec2(0.99, 0.99));\n    vec2 subimageTexel = texCoord * layoutData.zw;\n    // subimageTexel = clamp(subimageTexel, vec2(0.0, 0.0), vec2(1.0, 1.0));\n    return subimageTexel + layoutData.xy;\n}\n\nvec4 sampleSubImage(vec2 texCoord, int index, in sampler2D atlasLayout, in sampler2D atlasImage, in vec4 atlasDesc){\n    vec4 layoutData = fetchTexel(atlasLayout, int(floor(atlasDesc.z+0.5)), index);\n    vec2 atlasCoords = calcSubImageTexCoords(texCoord, index, atlasLayout, atlasDesc);\n    return texture2D(atlasImage, atlasCoords);\n}\n\n");class hi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("AtlasLayoutShader.vertexShader",'\n\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform vec2 pos;\nuniform vec2 size;\nuniform vec2 srctextureDim;\nconst int border = 2;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n  vec2 position = getQuadVertexPositionFromID();\n  v_texCoord = position+0.5;\n  gl_Position = vec4(vec2(-1.0, -1.0) + (pos * 2.0) + (v_texCoord * size * 2.0), 0.0, 1.0);\n\n  vec2 borderVec2 = vec2(float(border), float(border));\n  v_texCoord *= (srctextureDim + (borderVec2 * 2.0)) / srctextureDim;\n  v_texCoord -= borderVec2 / srctextureDim;\n}\n\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("AtlasLayoutShader.fragmentShader","\nprecision highp float;\n\nuniform sampler2D srctexture;\nuniform vec2 srctextureDim;\nuniform bool alphaFromLuminance;\nuniform bool invert;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n\nfloat luminanceFromRGB(vec3 rgb) {\n  return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n  vec2 pixelCoord = v_texCoord*srctextureDim;\n  vec2 uv = v_texCoord;\n\n  // Wrap X coords\n  if(pixelCoord.x < 0.0){\n    uv.x += 1.0/srctextureDim.x;\n    uv.y = 1.0 - uv.y;\n  }\n  else if(pixelCoord.x > srctextureDim.x){\n    uv.x -= 1.0/srctextureDim.x;\n    uv.y = 1.0 - uv.y;\n  }\n\n  // Wrap Y coords\n  if(pixelCoord.y < 0.0){\n    uv.y += 1.0/srctextureDim.y;\n    uv.x = 1.0 - uv.x;\n  }\n  else if(pixelCoord.y > srctextureDim.y){\n    uv.y -= 1.0/srctextureDim.y;\n    uv.x = 1.0 - uv.x;\n  }\n\n  vec4 texel = texture2D(srctexture, uv);\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  // TODO: check why we pre-multiply alphas here.\n  // fragColor = vec4(texel.rgb/texel.a, texel.a);\n\n  if(alphaFromLuminance) {\n    fragColor = vec4(texel.rgb, luminanceFromRGB(texel.rgb));\n  }\n  else {\n    fragColor = texel;\n  }\n  \n  if(invert) {\n    fragColor = vec4(1.0) - fragColor;\n  }\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n\n")}}class ci extends li{constructor(t,e,i="RGBA",n="FLOAT"){super(t),this.__name=e,this.__formatParam=i,this.__typeParam=n,this.clearColor=new y$2(0,0,0,0),this.__subImages=[],this.__layoutNeedsRegeneration=!1,this.__async=new N,this.loaded=!1,this.__async.addListener("ready",()=>{this.loaded=!0,this.emit("loaded",{})})}isLoaded(){return 0==this.__async.count}getMainImage(){return this.super}addSubImage(t){if(t instanceof we){const e=new Ka(this.__gl,t);t.isLoaded()||(this.__async.incAsyncCount(),t.addListener("loaded",()=>{this.__async.decAsyncCount()})),t.setMetadata("ImageAtlas_gltex",e),e.addRef(this),t.addListener("updated",()=>{this.__layoutNeedsRegeneration=!0,this.renderAtlas()}),this.__subImages.push(e)}else t.addRef(this),this.__subImages.push(t);return this.__layoutNeedsRegeneration=!0,this.__subImages.length-1}removeSubImage(t){let e;if(t instanceof we){const i=t.getMetadata("ImageAtlas_gltex");e=this.__subImages.indexOf(i),t.deleteMetadata("ImageAtlas_gltex")}else e=this.__subImages.indexOf(t);this.__subImages[e].removeRef(this),this.__subImages.splice(e,1),this.__layoutNeedsRegeneration=!0}getSubImage(t){return this.__subImages[t]}numSubImages(){return this.__layout?this.__layout.length:this.__subImages.length}generateAtlasLayout(){if(0==this.__subImages.length)return void(this.__layoutNeedsRegeneration=!1);const t=[];this.__subImages.forEach((e,i)=>{t.push({w:e.width+4,h:e.height+4,area:e.width*e.height,index:i})}),t.sort((t,e)=>t.area>e.area?-1:t.area<e.area?1:0);const e=new C;e.fit(t),this.__layout=[],t.forEach(t=>{t.fit?this.__layout[t.index]={pos:new _(t.fit.x+2,t.fit.y+2),size:new _(t.w,t.h)}:console.warn("Unable to fit image")});const i=e.root.w,n=e.root.h;this.configure({width:i,height:n,format:"FLOAT"==this.__typeParam&&"RGB"==this.__formatParam?"RGBA":this.__formatParam,type:this.__typeParam,filter:"LINEAR"});const s=this.__gl;if(s.__quadVertexIdsBuffer||s.setupInstancedQuad(),!s.__atlasLayoutShader){s.__atlasLayoutShader=new hi(s);const t=s.__atlasLayoutShader.compileForTarget("GLImageAtlas");s.__atlasLayoutShaderBinding=Ua(s,t.attrs,s.__quadattrbuffers,s.__quadIndexBuffer)}let o=Math.round(Math.sqrt(1*this.__layout.length)+.5);if(o=Math.nextPow2(o),o%1!=0&&(o+=1-o%1),s.floatTexturesSupported){const t=new Float32Array(o*o*4);for(let e=0;e<this.__layout.length;e++){const s=this.__layout[e];G.createFromFloat32Buffer(t.buffer,4*e).set(s.pos.x/i,s.pos.y/n,s.size.x/i,s.size.y/n)}this.__atlasLayoutTexture&&this.__atlasLayoutTexture.width==o&&this.__atlasLayoutTexture.height==o?this.__atlasLayoutTexture.bufferData(t,o,o):(this.__atlasLayoutTexture&&this.__atlasLayoutTexture.destroy(),this.__atlasLayoutTexture=new Ka(s,{format:"RGBA",type:"FLOAT",filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1,width:o,height:o,data:t}))}else this.__layoutVec4s=[],this.__layout.forEach((t,e)=>{this.__layoutVec4s[e]=[t.pos.x/i,t.pos.y/n,t.size.x/i,t.size.y/n]});this.__layoutNeedsRegeneration=!1}getLayoutData(t){return this.__layoutVec4s[t]}renderAtlas(t=!1,e=0){if(0==this.__subImages.length)return;this.__layoutNeedsRegeneration&&this.generateAtlasLayout();const i=this.__gl,n={};this.bindForWriting(n,!0),i.__atlasLayoutShader.bind(n,"GLImageAtlas"),i.__atlasLayoutShaderBinding.bind(n);const s=new _(1/this.width,1/this.height),o=n.unifs;for(let r=e;r<this.__subImages.length;r++){const t=this.__subImages[r],e=this.__layout[r];t.bindToUniform(n,o.srctexture),i.uniform2fv(o.pos.location,e.pos.multiply(s).asArray()),i.uniform2fv(o.size.location,e.size.multiply(s).asArray()),i.uniform2f(o.srctextureDim.location,t.width,t.height),i.uniform1i(o.alphaFromLuminance.location,t.alphaFromLuminance),i.uniform1i(o.invert.location,t.invert),i.drawQuad(),n.boundTextures--}t&&this.cleanup(),this.unbind(n),this.emit("updated",{})}isReady(){return null!=this.__atlasLayoutTexture}bindToUniform(t,e){if(!this.__atlasLayoutTexture)return!1;super.bindToUniform(t,e);const i=t.unifs,n=i[e.name+"_layout"];n&&this.__atlasLayoutTexture.bindToUniform(t,n);const s=i[e.name+"_desc"];return s&&this.__gl.uniform4f(s.location,this.width,this.height,this.__atlasLayoutTexture.width,0),!0}cleanup(){for(const t of this.__subImages)t.removeRef(this);this.__subImages=[],this.destroy()}destroy(){this.cleanup(),super.destroy()}}class mi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("ConvolverShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n  vec2 position = getQuadVertexPositionFromID();\n  v_texCoord = position+0.5;\n  gl_Position = vec4(position*2.0, 0.0, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("ConvolverShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="utils/imagePyramid.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n\nuniform float roughness;\nvarying vec2 v_texCoord;\n\nuniform sampler2D hammersleyMap;\nvec2 Hammersley(int i, int N) {\n  vec4 rgba =  texture2D(hammersleyMap, vec2((float(i) + 0.5)/float(N)), 0.5);\n  return rgba.rg;\n}\n\nmat3 matrixFromVector(vec3 n) { // frisvad\n  float a = 1.0 / (1.0 + n.z);\n  float b = -n.x * n.y * a;\n  vec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n  vec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n  return mat3(b1, b2, n);\n}\n\nvec3 ImportanceSampleGGX(vec2 Xi, float a) {\n  float phi = 2.0 * PI * Xi.x;\n  float cos_theta = sqrt((1.0 - Xi.y)/(1.0 + (a*a - 1.0) * Xi.y));\n  float sin_theta = sqrt(1.0 - cos_theta * cos_theta);\n\n  // float phi = Xi.y * 2.0 * PI;\n  // float cos_theta = sqrt(1.0 - Xi.x);\n  // float sin_theta = sqrt(1.0 - cos_theta * cos_theta);\n\n  vec3 H;\n  H.x = sin_theta * cos(phi);\n  H.y = sin_theta * sin(phi);\n  H.z = cos_theta;\n  return H;\n}\n\n// TODO: use tobias\'s code. The guy clearly knows what he\'s doing...\n// https://github.com/thefranke/dirtchamber/blob/master/shader/importance.hlsl\n// Compute a LOD level for filtered importance sampling.\n// From GPU Gems 3: GPU-Based Importance Sampling.\n\n\n#define M_PI       3.14159265358979323846   // pi\n#define M_HALF_PI  1.57079632679489661923   // pi/2\nfloat sqr(float val){ return val*val; }\nfloat saturate(float val) { return clamp(val, 0.0, 1.0); }\nvec3 saturate(vec3 val) { return clamp(val, 0.0, 1.0); }\n\n// Microfacet Models for Refraction through Rough Surfaces\n// Walter et al.\n// http://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.html\n// aka Towbridge-Reitz\nfloat D_ggx(in float alpha, in float NoH)\n{\n  float a2 = alpha*alpha;\n  float cos2 = NoH*NoH;\n\n  return (1.0/M_PI) * sqr(alpha/(cos2 * (a2 - 1.0) + 1.0));\n\n  /*\n  // version from the paper, eq 33\n  float CosSquared = NoH*NoH;\n  float TanSquared = (1.0 - CosSquared)/CosSquared;\n  return (1.0/M_PI) * sqr(alpha/(CosSquared * (alpha*alpha + TanSquared)));\n  */\n}\nfloat compute_lod(in vec3 H, in float pdf, in int num_samples, in int ww, in int hh)\n{\n  return max(0.0, 0.5*log2(float(ww*hh)/float(num_samples)) - 0.5*log2(pdf));\n}\n\nuniform sampler2D   envMapPyramid;\nuniform sampler2D   envMapPyramid_layout;\nuniform vec4        envMapPyramid_desc;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec3 N = sphOctUvToDir(v_texCoord);\n\n  if(false){\n    vec2 uv = dirToSphOctUv(N);\n    // fragColor = vec4(uv.x, uv.y, 0.0, 1.0);\n    fragColor = sampleImagePyramid(uv, 0.5, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc);\n    // fragColor = sampleSubImage(uv, 0, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc);\n    // fragColor = texture2D(envMapPyramid, uv);\n  }\n  else{\n    const int numSamples = NUM_SAMPLES;\n    int w = int(floor(envMapPyramid_desc.x + 0.5));\n    int h = int(floor(envMapPyramid_desc.y + 0.5));\n\n    vec4 color = vec4(0.0,0.0,0.0,0.0);\n    float weight = 0.0;\n    mat3 vecSpace = matrixFromVector(N);\n    float a = roughness*roughness;\n    for(int i=0; i<numSamples; i++) {\n      vec2 Xi = Hammersley(i, numSamples);\n      vec3 H = ImportanceSampleGGX(Xi, a);\n      vec3 V = normalize(vecSpace * H);\n      float VdotN = dot(V, N);\n      float NoH = saturate( dot( N, H ) );\n      float VoH = saturate( dot( V, H ) );\n\n      vec2 uv = dirToSphOctUv(V);\n      // float pdf = D_ggx(a, NoH) * NoH / (4.0 * VoH);\n      // float lod = compute_lod(H, pdf, numSamples, w, h);\n\n      color += sampleImagePyramid(uv, a, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc) * VdotN;\n      weight += VdotN;\n    }\n    color /= float(weight);\n    fragColor = vec4(color.rgb, 1.0);\n  }\n  \n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n\n')}}Ba.setShaderModule("utils/imagePyramid.glsl",'\n\n<%include file="utils/imageAtlas.glsl"/>\n\nvec4 sampleImagePyramid(vec2 uv, float lod, in sampler2D atlasLayout, in sampler2D atlasImage, in vec4 atlasDesc){\n  if (lod < 0.00001 || lod > 0.9999) {\n    float imageIndex = lod * (atlasDesc.z-1.0);\n    int imageId0 = int(imageIndex);\n    return sampleSubImage(uv, imageId0, atlasLayout, atlasImage, atlasDesc);\n  } else {\n    float imageIndex = lod * (atlasDesc.z-1.0);\n    int imageId0 = int(floor(imageIndex));\n    int imageId1 = imageId0+1;\n    float blend = fract(imageIndex);\n    vec4 c0 = sampleSubImage(uv, imageId0, atlasLayout, atlasImage, atlasDesc);\n    vec4 c1 = sampleSubImage(uv, imageId1, atlasLayout, atlasImage, atlasDesc);\n    return mix(c0, c1, blend);\n  } \n}\n\n\n');class ui extends ci{constructor(t,e,i,n=!0,s=16){super(t,e),this.__srcGLTex=i,this.__fbos=[],i.addListener("updated",()=>{this.renderAtlas(n)}),this.__srcGLTex.isLoaded()?(this.generateAtlasLayout(s),this.renderAtlas(n)):this.__srcGLTex.addListener("updated",()=>{this.generateAtlasLayout(s),this.renderAtlas(n)}),i.addListener("destructing",()=>{console.log(this.__srcGLTex.getName()+" ImagePyramid destructing"),this.destroy()})}generateAtlasLayout(t){const e=this.__gl;this.size=this.__srcGLTex.height;const i=this.__srcGLTex.width/this.__srcGLTex.height;this.addSubImage(this.__srcGLTex);for(let n=Math.round(function(t){return Math.log2(t)}(this.size))-1;n>=0;--n){const s=Math.pow(2,n);if(s<t)break;const o=new Ka(e,{format:this.__srcGLTex.getFormat(),type:this.__srcGLTex.getType(),width:s*i,height:s,filter:"LINEAR",wrap:"CLAMP_TO_EDGE"});this.addSubImage(o),this.__fbos.push(new Aa(e,o))}super.generateAtlasLayout()}renderAtlas(t=!0){const e=this.__gl,i={};e.screenQuad.bindShader(i);for(let n=0;n<this.__fbos.length;n++)this.__fbos[n].bindAndClear(),e.screenQuad.draw(i,this.getSubImage(n));super.renderAtlas(t)}destroy(){super.destroy();for(const t of this.__fbos)t.destroy()}}class bi extends ci{constructor(t,e){super(t,e),this.__gl=t,t.__quadVertexIdsBuffer||t.setupInstancedQuad(),this.__convolved=!1,this.__fbos=[]}generateHammersleySamples(t){const e=this.__gl;if(!e["Hammersley"+t]){const i=new Float32Array(3*t);for(let e=0;e<t;e++){const n=oi(e,t),s=3*e;i[s+0]=n[0],i[s+1]=n[1]}e["Hammersley"+t]=new Ka(e,{format:"RGB",type:"FLOAT",filter:"NEAREST",wrap:"CLAMP_TO_EDGE",width:t,height:1,data:i,mipMapped:!1})}return e["Hammersley"+t]}convolveProbe(t){const e=this.__gl,i=this.generateHammersleySamples(1024);if(!this.__convolved){this.__lodPyramid||(this.__lodPyramid=new ui(e,"Probe Lods",t,!1),this.__lodPyramid.addListener("updated",()=>{this.convolveProbe(t)})),this.addSubImage(t);let i=[t.width/2,t.height/2];const n=6;for(let t=0;t<n;t++){const t=new Ka(e,{format:"RGBA",type:"FLOAT",filter:"LINEAR",wrap:"CLAMP_TO_EDGE",width:i[0],height:i[1]});this.addSubImage(t);const n=new Aa(e,t);n.setClearColor([0,1,0,0]),this.__fbos.push(n),i=[i[0]/2,i[1]/2]}this.generateAtlasLayout(),this.__convolverShader=new mi(e);const s=this.__convolverShader.compileForTarget("GLProbe",Object.assign({repl:{NUM_SAMPLES:1024}},e.shaderopts));this.__covolverShaderBinding=Ua(e,s.attrs,e.__quadattrbuffers,e.__quadIndexBuffer)}const n={};this.__convolverShader.bind(n,"GLProbe"),this.__covolverShaderBinding.bind(n);const s=n.unifs;for(let o=0;o<this.__fbos.length;o++)this.__fbos[o].bindAndClear(),this.__lodPyramid.bindToUniform(n,s.envMapPyramid),"hammersleyMap"in s&&i.bindToUniform(n,s.hammersleyMap),"roughness"in s&&e.uniform1f(s.roughness.location,(o+1)/this.__fbos.length),e.drawQuad();this.__convolved=!0,this.renderAtlas(!1)}bindProbeToUniform(t,e){this.__convolved&&super.bindToUniform(t,e)}destroy(){super.destroy(),this.__convolverShader.destroy();for(const t of this.__fbos)t.destroy()}}Ba.setShaderModule("stack-gl/inverse.glsl","\n\n\n#ifndef ENABLE_ES3\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n#endif\n\n"),Ba.setShaderModule("stack-gl/transpose.glsl","\n\n\n#ifndef ENABLE_ES3\n\nfloat transpose(float m) {\n  return m;\n}\n\nmat2 transpose(mat2 m) {\n  return mat2(m[0][0], m[1][0],\n              m[0][1], m[1][1]);\n}\n\nmat3 transpose(mat3 m) {\n  return mat3(m[0][0], m[1][0], m[2][0],\n              m[0][1], m[1][1], m[2][1],\n              m[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose(mat4 m) {\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n              m[0][1], m[1][1], m[2][1], m[3][1],\n              m[0][2], m[1][2], m[2][2], m[3][2],\n              m[0][3], m[1][3], m[2][3], m[3][3]);\n}\n\n#endif\n\n"),Ba.setShaderModule("pragmatic-pbr/envmap-octahedral.glsl","\n\n#define sectorize(value) step(0.0, (value))*2.0-1.0\n#define sum(value) dot(clamp((value), 1.0, 1.0), (value))\n\n\nvec2 dirToSphOctUv(vec3 normal){\n    normal = normalize(normal);\n    vec3 aNorm = abs(normal);\n    vec3 sNorm = sectorize(normal);\n\n    vec2 dir = max(aNorm.xy, 1e-20);\n    float orient = atan(dir.x, dir.y)/HalfPI;\n\n    dir = max(vec2(aNorm.z, length(aNorm.xy)), 1e-20);\n    float pitch = atan(dir.y, dir.x)/HalfPI;\n\n    vec2 uv = vec2(sNorm.x*orient, sNorm.y*(1.0-orient))*pitch;\n\n    if(normal.z < 0.0){\n        uv = sNorm.xy - abs(uv.ts)*sNorm.xy;\n    }\n    return uv*0.5+0.5;\n}\n\n\nvec3 sphOctUvToDir(vec2 uv){\n    uv = uv*2.0-1.0;\n    vec2 suv = sectorize(uv);\n    float sabsuv =  sum(abs(uv));\n    float pitch = sabsuv*HalfPI;\n\n    if (pitch <= 0.0) {\n        return vec3(0.0, 0.0, 1.0);\n    }\n    if (abs(pitch - PI) < 0.000001) {\n        return vec3(0.0, 0.0, -1.0);\n    }\n    if(sabsuv > 1.0){\n        uv = (1.0-abs(uv.ts))*suv;\n    }\n\n    float orient = (abs(uv.s)/sabsuv)*HalfPI;\n    float sOrient = sin(orient);\n    float cOrient = cos(orient);\n    float sPitch = sin(pitch);\n    float cPitch = cos(pitch);\n\n    return vec3(\n        sOrient*suv.s*sPitch,\n        cOrient*suv.t*sPitch,\n        cPitch\n    );\n}\n\n"),Ba.setShaderModule("pragmatic-pbr/envmap-equirect.glsl","\n\n\nvec2 latLongUVsFromDir(vec3 dir) {\n  // Math function taken from...\n  // http://gl.ict.usc.edu/Data/HighResProbes/\n  // Note: Scaling from u=[0,2], v=[0,1] to u=[0,1], v=[0,1]\n  float phi = acos(dir.z);\n  float theta = atan(dir.x, dir.y);\n  return vec2((1.0 + theta / PI) / 2.0, phi / PI);\n}\n\n// Note: when u == 0.5 z = 1.0\nvec3 dirFromLatLongUVs(float u, float v) {\n    // http://gl.ict.usc.edu/Data/HighResProbes/\n    float theta = PI*((u * 2.0) - 1.0);\n    float phi = PI*v;\n    return vec3(sin(phi)*sin(theta), sin(phi)*cos(theta), cos(phi));\n}\n\nvec3 dirFromPolar(vec2 polar) {\n    float u = polar.x / (PI * 2.0);\n    float v = polar.y / PI;\n    return dirFromLatLongUVs(u, v);\n}\n\n"),Ba.setShaderModule("pragmatic-pbr/envmap-dualfisheye.glsl","\n\n\n\nvec2 dualfisheyeUVsFromDir(vec3 dir) {\n  vec2 result;\n  float angle = 0.465;\n    if(dir.x < 0.0) {\n        result = vec2(((dir.z * -angle) + 0.5) * 0.5, (dir.y * angle) + 0.5);\n    }\n    else {\n        result = vec2( 0.5 + ((dir.z * angle) + 0.5) * 0.5, (dir.y * angle) + 0.5);\n    }\n    return result;\n}\n\n\n");class pi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("EnvMapShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\n\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="stack-gl/transpose.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n  vec2 position = getQuadVertexPositionFromID() * 2.0;\n  v_texCoord = position * 0.5 + 0.5;\n\n  mat4 inverseProjection = inverse(projectionMatrix);\n  mat3 inverseModelview = transpose(mat3(viewMatrix));\n\n  // transform from the normalized device coordinates back to the view space\n  vec3 unprojected = (inverseProjection * vec4(position, 0, 1)).xyz;\n\n  // transfrom from the view space back to the world space\n  // and use it as a sampling vector\n  v_worldDir = inverseModelview * unprojected;\n\n  gl_Position = vec4(position, 0, 1);\n}\n\n')}}class gi extends pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("LatLongEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec4 texel = texture2D(backgroundImage, v_texCoord);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class _i extends pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("OctahedralEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n<%include file="utils/imagePyramid.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n\nuniform float focus;\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\n// uniform ImageAtlas envMap;\nuniform sampler2D   envMapPyramid;\nuniform sampler2D   envMapPyramid_layout;\nuniform vec4        envMapPyramid_desc;\n\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = dirToSphOctUv(normalize(v_worldDir));\n  if(false){\n    // Use these lines to debug the src GL image.\n    vec4 texel = texture2D(envMapPyramid, uv);\n    fragColor = vec4(texel.rgb/texel.a, 1.0);\n  }\n  else{\n    fragColor = vec4(sampleImagePyramid(uv, focus, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc).rgb, 1.0);\n  }\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class Zi extends pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("LatLongEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = latLongUVsFromDir(normalize(v_worldDir));\n\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){return super.getParamDeclarations()}}class Gi extends pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("SterioLatLongEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform int eye;// L = 0, R = 1;\n\nuniform sampler2D backgroundImage;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = latLongUVsFromDir(normalize(v_worldDir));\n  uv.y *= 0.5;\n  if(eye == 1){\n    uv.y += 0.5;\n  }\n\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class Xi extends pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("DualFishEyeEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-dualfisheye.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = dualfisheyeUVsFromDir(normalize(v_worldDir));\n\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class yi extends pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("DualFishEyeEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n<%include file="pragmatic-pbr/envmap-dualfisheye.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = dualfisheyeUVsFromDir(dirFromLatLongUVs(v_texCoord.x, v_texCoord.y));\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  // fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class fi extends bi{constructor(t,e,i){super(t.gl,"EnvMap"),this.__renderer=t,this.__envMap=e,this.__backgroundFocus=0;const n=t.gl;n.__quadVertexIdsBuffer||n.setupInstancedQuad();let s=this.__envMap.getMetadata("gltexture");s||(s=new ja(n,this.__envMap)),this.__srcGLTex=s,this.__envMapShader=new _i(n);const o=this.__envMapShader.compileForTarget("GLEnvMap",i);this.__envMapShaderBinding=Ua(n,o.attrs,n.__quadattrbuffers,n.__quadIndexBuffer),this.__envMap.isLoaded()?this.convolveProbe(s):this.__envMap.addListener("loaded",()=>{this.convolveProbe(s),this.emit("loaded",{})})}getEnvMap(){return this.__envMap}getBackgroundFocus(){return this.__backgroundFocus}setBackgroundFocus(t){this.__backgroundFocus=t,this.__renderer.requestRedraw()}draw(t){if(this.__envMap.isLoaded()){const e=this.__gl;{this.__envMapShader.bind(t,"GLEnvMap");const i=t.unifs;this.bindProbeToUniform(t,i.envMapPyramid);{const t=i.focus;t&&e.uniform1f(t.location,this.__backgroundFocus)}{const n=i.exposure;n&&e.uniform1f(n.location,t.exposure)}this.__envMapShaderBinding.bind(t),e.depthMask(!1),t.bindViewports(i,()=>{e.drawQuad()})}}}bindToUniform(t,e,i){return this.__srcGLTex.bindToUniform(t,e,i)}destroy(){super.destroy(),this.__srcGLTex.loaded.disconnectScope(this),this.__srcGLTex.updated.disconnectScope(this),this.__srcGLTex.destroy()}}class Vi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("ScreenQuadShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform vec2 pos;\nuniform vec2 size;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(vec2(-1.0, -1.0) + (pos * 2.0) + (v_texCoord * abs(size) * 2.0), 0.0, 1.0);\n    if(size.x < 0.0)\n        v_texCoord.x = 1.0 - v_texCoord.x;\n    if(size.y < 0.0)\n        v_texCoord.y = 1.0 - v_texCoord.y;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("ScreenQuadShader.fragmentShader","\nprecision highp float;\n\nuniform sampler2D image;\n\nvarying vec2 v_texCoord;\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = texture2D(image, v_texCoord);\n    fragColor = vec4(fragColor.rgb/fragColor.a, 1.0);\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n"),this.finalize()}}class Ii{constructor(t,e){this.__gl=t,this.__pos=[0,0],this.__size=[1,1],this.flipY=!0,this.__glshader=new Vi(t),t.__quadVertexIdsBuffer||t.setupInstancedQuad();const i=this.__glshader.compileForTarget("GLScreenQuad",e);this.__quadBinding=Ua(t,i.attrs,t.__quadattrbuffers,t.__quadIndexBuffer),this.ready=!0}bind(t,e,i,n){const s=t.unifs;e.bindToUniform(t,t.unifs.image);const o=this.__gl;{const t=s.pos;t&&o.uniform2fv(t.location,i?i instanceof p?i.asArray():i:this.__pos)}{const t=s.size;t&&o.uniform2fv(t.location,n?n instanceof p?n.asArray():n:this.__size)}this.__quadBinding.bind(t)}bindShader(t){return this.__glshader.bind(t,"GLScreenQuad")}draw(t,e,i,n){this.bind(t,e,i,n),this.__gl.drawQuad()}destroy(){}}class xi extends q{constructor(t){super(),this.__renderer=t,this.__doubleClickTimeMSParam=this.addParameter(new Ze("DoubleClickTimeMS",200)),this.__fbo=void 0,this.__renderer.addListener("sceneSet",()=>{const e=t.getScene().settings.getParameter("BackgroundColor"),i=()=>{const t=e.getValue(),i=this.__renderer.gl;t instanceof we?"FLOAT"===t.type?(this.__backgroundTexture=t,this.__backgroundGLTexture=new ja(i,t)):(this.__backgroundTexture=t,this.__backgroundGLTexture=new Ka(i,t)):t instanceof y$2?(this.__backgroundGLTexture&&(this.__backgroundGLTexture.destroy(),this.__backgroundGLTexture=void 0,this.__backgroundTexture=void 0),this.__backgroundColor=t):console.warn("Invalid background:"+t),this.emit("updated",{})};i(e.getValue()),e.addListener("valueChanged",i)})}getRenderer(){return this.__renderer}getName(){return this.__name}getBl(){return this.__bl}setBl(t){this.__bl=t,this.resize(this.__canvasWidth,this.__canvasHeight)}getTr(){return this.__tr}setTr(t){this.__tr=t,this.resize(this.__canvasWidth,this.__canvasHeight)}getPosX(){return this.__x}getPosY(){return this.__y}getWidth(){return this.__width}getHeight(){return this.__height}getBackground(){return console.warn("Deprecated Function. Please access the Scene Settings object."),this.__renderer.getScene().settings.getParameter("BackgroundColor").getValue()}setBackground(t){console.warn("Deprecated Function. Please access the Scene Settings object."),this.__renderer.getScene().settings.getParameter("BackgroundColor").setValue(t),this.emit("updated",{})}resize(t,e){this.__canvasWidth=t,this.__canvasHeight=e,this.__width=t,this.__height=e,this.emit("resized",{width:this.__width,height:this.__height})}onMouseDown(t){return!1}onMouseUp(t){return!1}onMouseMove(t){return!1}onMouseLeave(t){return!1}onKeyPressed(t,e){return!1}onKeyDown(t,e){return!1}onKeyUp(t,e){return!1}}class Ri extends xi{constructor(t,e,i,n){super(t),this.__name=e,this.__projectionMatrix=new I,this.__frustumDim=new _,this.__bl=new _(0,0),this.__tr=new _(1,1),this.__exposure=0,this.__exposureRange=[-5,10],this.__tonemap=!0,this.__gamma=2.2,this.__prevDownTime=0,this.__geomDataBuffer=void 0,this.__geomDataBufferFbo=void 0,this.setCamera(new _a("Default")),this.setManipulator(new Ya),this.resize(i,n)}resize(t,e){this.__canvasWidth=t,this.__canvasHeight=e,this.__x=t*this.__bl.x,this.__y=t*this.__bl.y,this.__width=t*this.__tr.x-t*this.__bl.x,this.__height=e*this.__tr.y-e*this.__bl.y,this.region=[this.__x,this.__y,this.__width,this.__height],this.__camera&&this.__updateProjectionMatrix(),this.__geomDataBufferFbo&&(this.__geomDataBuffer.resize(this.__width,this.__height),this.__geomDataBufferFbo.resize()),this.emit("resized",{width:t,height:e})}getCamera(){return this.__camera}setCamera(t){this.__camera=t;const e=t.getParameter("GlobalXfo"),i=()=>{this.__cameraXfo=e.getValue(),this.__cameraMat=this.__cameraXfo.toMat4(),this.__viewMat=this.__cameraMat.inverse()};i(),e.addListener("valueChanged",()=>{i(),this.invalidateGeomDataBuffer(),this.emit("updated",{}),this.emit("viewChanged",{interfaceType:"CameraAndPointer",viewXfo:this.__cameraXfo,focalDistance:this.__camera.getFocalDistance()})}),this.__camera.addListener("projectionParamChanged",()=>{this.__updateProjectionMatrix(),this.emit("updated",{})}),this.__updateProjectionMatrix()}getManipulator(){return this.__cameraManipulator}setManipulator(t){this.__cameraManipulator=t}__updateProjectionMatrix(){const t=this.__width/this.__height;this.__camera.updateProjectionMatrix(this.__projectionMatrix,t);const e=Math.tan(this.__camera.getFov()/2)*this.__camera.getNear()*2;this.__frustumDim.set(e*t,e)}getProjectionMatrix(){return this.__projectionMatrix}getViewMatrix(){return this.__viewMat}setActive(t){activeViewport=t?this:void 0}frameView(t){this.__width>0&&this.__height>0?this.__camera.frameView(this,t):console.warn("Unable to frameView while Viewport with and height are 0.")}calcRayFromScreenPos(t){let e=(t.x-this.__x)/this.__width,i=(t.y-this.__canvasHeight*(1-this.__tr.y))/this.__height;e=2*e-1,i=2*i-1;const n=this.__cameraMat,s=this.__projectionMatrix.inverse();if(null==s)return null;let o,r;return this.__camera.getIsOrthographic()?(o=n.transformVec3(s.transformVec3(new Z(e,-i,-1))),r=new Z(0,0,-1)):(o=n.translation,r=s.transformVec3(new Z(e,-i,-1))),r=n.rotateVec3(r).normalize(),new R(o,r)}createGeomDataFbo(t){const e=this.__renderer.gl;this.__floatGeomBuffer=t,this.__geomDataBuffer=new Ka(e,this.__floatGeomBuffer?{type:"FLOAT",format:"RGBA",filter:"NEAREST",width:this.__width<=1?1:this.__width,height:this.__height<=1?1:this.__height}:{type:"UNSIGNED_BYTE",format:"RGBA",filter:"NEAREST",width:this.__width<=1?1:this.__width,height:this.__height<=1?1:this.__height}),this.__geomDataBufferFbo=new Aa(e,this.__geomDataBuffer,!0),this.__geomDataBufferFbo.setClearColor([0,0,0,0])}getGeomDataFbo(){return this.__geomDataBufferFbo}renderGeomDataFbo(){if(this.__geomDataBufferFbo){this.__geomDataBufferFbo.bindAndClear();const t={};this.__initRenderState(t),this.__renderer.drawSceneGeomData(t),this.__geomDataBufferInvalid=!1}}invalidateGeomDataBuffer(){this.__geomDataBufferInvalid=!0}getGeomDataAtPos(t,e){if(this.__geomDataBufferFbo){if(this.__geomDataBufferInvalid&&(this.renderGeomDataFbo(),this.__screenPos=null),t===this.__screenPos)return this.__intersectionData;this.__screenPos=t,this.__intersectionData=null;const i=this.__renderer.gl;let n,s;if(i.finish(),this.__geomDataBufferFbo.bindForReading(),i.floatGeomBuffer){if(s=new Float32Array(4),i.readPixels(t.x,this.__height-t.y,1,1,i.RGBA,i.FLOAT,s),0==s[3])return;n=63&Math.round(s[0])}else{if(s=new Uint8Array(4),i.readPixels(t.x,this.__height-t.y,1,1,i.RGBA,i.UNSIGNED_BYTE,s),i.bindFramebuffer(i.FRAMEBUFFER,null),0==s[0]&&0==s[1])return;n=0}this.__geomDataBufferFbo.unbind();const o=this.__renderer.getPass(n);if(!o)return void console.warn("Geom data buffer returns invalid pass id:",n);const r=o.getGeomItemAndDist(s);if(r){e||(e=this.calcRayFromScreenPos(t));const i=e.start.add(e.dir.scale(r.dist));this.__intersectionData={screenPos:t,mouseRay:e,intersectionPos:i,geomItem:r.geomItem,dist:r.dist,geomData:s}}return this.__intersectionData}}getGeomItemsInRect(t,e){if(this.__geomDataBufferFbo){const i=this.__renderer.gl;i.finish();const n=Math.round(this.__height-e.y),s=Math.round(t.x),o=Math.round(e.x-t.x),r=Math.round(e.y-t.y),a=o*r;let l;this.__geomDataBufferFbo.bindForReading(),i.floatGeomBuffer?(l=new Float32Array(4*a),i.readPixels(s,n,o,r,i.RGBA,i.FLOAT,l)):(l=new Uint8Array(4*a),i.readPixels(s,n,o,r,i.RGBA,i.UNSIGNED_BYTE,l)),i.bindFramebuffer(i.FRAMEBUFFER,null);const c=new Set;for(let t=0;t<a;t++){let e;const n=l.subarray(4*t,4*(t+1));e=i.floatGeomBuffer?Math.round(n[0]):0;const s=this.__renderer.getPass(e).getGeomItemAndDist(n);s&&c.add(s.geomItem)}return c}}__eventMousePos(t){return new _(t.rendererX-this.getPosX(),t.rendererY-this.getPosY())}__prepareEvent(t){if(t.viewport=this,t.propagating=!0,t.stopPropagation=()=>{t.propagating=!1},t.setCapture=t=>{this.capturedItem=t},t.getCapture=()=>this.capturedItem,t.releaseCapture=()=>{this.capturedItem=null,this.renderGeomDataFbo()},t instanceof MouseEvent){const e=this.__eventMousePos(t);t.mousePos=e,t.mouseRay=this.calcRayFromScreenPos(e);const i=this.getGeomDataAtPos(t.mousePos,t.mouseRay);null!=i&&(t.intersectionData=i)}}setCapture(t){this.capturedItem=t}getCapture(){return this.capturedItem}releaseCapture(){this.capturedItem=null,this.renderGeomDataFbo()}onMouseDown(t){if(this.__prepareEvent(t),this.capturedItem)return void this.capturedItem.onMouseDown(t);if(null!=t.intersectionData){if(t.intersectionData.geomItem.onMouseDown(t),!t.propagating||this.capturedItem)return;if(this.emit("mouseDownOnGeom",t),!t.propagating)return}const e=Date.now();if(e-this.__prevDownTime<this.__doubleClickTimeMSParam.getValue()){if(this.__cameraManipulator&&(this.__cameraManipulator.onDoubleClick(t),!t.propagating))return;this.emit("mouseDoubleClicked",t)}else{if(this.__prevDownTime=e,this.__cameraManipulator&&(this.__cameraManipulator.onMouseDown(t),!t.propagating))return;this.emit("mouseDown",t)}return!1}onMouseMove(t){if(this.__prepareEvent(t),this.capturedItem)this.capturedItem.onMouseMove(t);else{if(null!=t.intersectionData){if(t.intersectionData.geomItem!=this.mouseOverItem&&(this.mouseOverItem&&this.mouseOverItem.onMouseLeave(t),this.mouseOverItem=t.intersectionData.geomItem,this.mouseOverItem.onMouseEnter(t)),t.intersectionData.geomItem.onMouseMove(t),!t.propagating||this.capturedItem)return}else this.mouseOverItem&&(this.mouseOverItem.onMouseLeave(t),this.mouseOverItem=null);this.__cameraManipulator&&(this.__cameraManipulator.onMouseMove(t),!t.propagating)||this.emit("mouseMove",t)}}onMouseUp(t){this.__prepareEvent(t),this.capturedItem?this.capturedItem.onMouseUp(t):(null==t.intersectionData||(t.intersectionData.geomItem.onMouseUp(t),t.propagating))&&(this.__cameraManipulator&&(this.__cameraManipulator.onMouseUp(t),!t.propagating)||this.emit("mouseUp",t))}onMouseLeave(t){this.__prepareEvent(t),this.emit("mouseLeave",t)}onKeyPressed(t,e){this.__prepareEvent(e),this.__cameraManipulator&&this.__cameraManipulator.onKeyPressed(t,e)||this.emit("keyPressed",e)}onKeyDown(t,e){this.__prepareEvent(e),this.__cameraManipulator&&this.__cameraManipulator.onKeyDown(t,e)||this.emit("keyDown",e)}onKeyUp(t,e){this.__prepareEvent(e),this.__cameraManipulator&&this.__cameraManipulator.onKeyUp(t,e)||this.emit("keyUp",e)}onWheel(t){this.__prepareEvent(t),(null==t.intersectionData||(t.intersectionData.geomItem.onWheel(t),t.propagating))&&(this.__cameraManipulator?this.__cameraManipulator.onWheel(t):this.emit("mouseWheel",t))}__eventTouchPos(t){return new _(t.rendererX-this.getPosX(),t.rendererY-this.getPosY())}onTouchStart(t){if(this.__prepareEvent(t),1==t.touches.length){const e=this.__eventTouchPos(t.touches[0]);t.touchPos=e,t.touchRay=this.calcRayFromScreenPos(e);const i=this.getGeomDataAtPos(e,t.touchRay);if(null!=i){if(t.intersectionData=i,i.geomItem.onMouseDown(t,i),!t.propagating)return;if(this.capturedItem)return;if(this.emit("mouseDownOnGeom",t),!t.propagating)return}const n=Date.now();if(n-this.__prevDownTime<this.__doubleClickTimeMSParam.getValue()){if(this.__cameraManipulator&&(this.__cameraManipulator.onDoubleTap(t),!t.propagating))return;return void this.emit("doubleTapped",t)}this.__prevDownTime=n}this.__cameraManipulator?this.__cameraManipulator.onTouchStart(t):this.emit("touchStart",t)}onTouchMove(t){if(this.__prepareEvent(t),this.capturedItem){t.touchPos=[],t.touchRay=[];for(let e=0;e<t.touches.length;e++){const i=this.__eventTouchPos(t.touches[e]);t.touchPos[e]=i,t.touchRay[e]=this.calcRayFromScreenPos(i)}return t.mousePos=t.touchPos[0],t.mouseRay=t.touchRay[0],void this.capturedItem.onMouseMove(t)}this.__cameraManipulator?this.__cameraManipulator.onTouchMove(t):this.emit("touchMove",t)}onTouchEnd(t){this.__prepareEvent(t),this.capturedItem?this.capturedItem.onMouseUp(t):this.__cameraManipulator?this.__cameraManipulator.onTouchEnd(t):this.emit("touchEnd",t)}onTouchCancel(t){this.__prepareEvent(t),this.capturedItem?this.capturedItem.onTouchCancel(t):this.__cameraManipulator?this.__cameraManipulator.onTouchCancel(t):this.emit("touchCancel",t)}__initRenderState(t){t.viewXfo=this.__cameraXfo,t.viewScale=1,t.region=this.region,t.cameraMatrix=this.__cameraMat,t.viewports=[{region:this.region,viewMatrix:this.__viewMat,projectionMatrix:this.__projectionMatrix,viewportFrustumSize:this.__frustumDim,isOrthographic:this.__camera.getIsOrthographic(),fovY:this.__camera.getFov()}]}draw(){const t=this.__renderer.gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(...this.region),this.__backgroundColor&&t.clearColor(...this.__backgroundColor.asArray()),t.colorMask(!0,!0,!0,!0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const e={};this.__initRenderState(e),this.__renderer.drawScene(e)}}class Si{constructor(t,e){this.__vrviewport=t,this.__treeItem=new na("VRHead"),e.addChild(this.__treeItem),this.__mat4=new I,this.__localXfo=new S}update(t){this.__mat4.setDataArray(t.transform.matrix),this.__localXfo.fromMat4(this.__mat4),this.__treeItem.setLocalXfo(this.__localXfo)}getTreeItem(){return this.__treeItem}getXfo(){return this.__localXfo}}class Li{constructor(e,i,n){if(this.__vrviewport=e,this.__inputSource=i,this.__id=n,this.__isDaydramController=t.isMobileDevice,this.__pressedButtons=[],this.__mat4=new I,this.__xfo=new S,this.__treeItem=new na("VRController:"+i.handedness+n),!this.__isDaydramController){this.__tip=new na("Tip");const t=new S;t.tr.set(0,-.05,-.13),this.__tip.setLocalXfo(t),this.__treeItem.addChild(this.__tip,!1),e.getTreeItem().addChild(this.__treeItem),this.__activeVolumeSize=.04,e.loadHMDResources().then(t=>{t.addListener("loaded",()=>{let e;0==n?e=t.getChildByName("LeftController"):1==n&&(e=t.getChildByName("RightController")),e||(e=t.getChildByName("Controller"));const i=e.clone();i.setLocalXfo(new S(new Z(0,-.035,-.085),new x({setFromAxisAndAngle:[new Z(0,1,0),Math.PI]}),new Z(.001,.001,.001))),this.__treeItem.addChild(i,!1)})})}}getHandedness(){return this.__inputSource.handedness}getId(){return this.__id}getTreeItem(){return this.__treeItem}getTipItem(){return this.__tip}getTipXfo(){return this.__tip.getGlobalXfo()}getTouchPadValue(){return this.__touchpadValue}isButtonPressed(){return this.__buttonPressed}getControllerStageLocalXfo(){return this.__xfo}getControllerTipStageLocalXfo(){return this.__xfo.multiply(this.__tip.getLocalXfo())}updatePose(t,e,i){const n=e.getPose(i.gripSpace,t);n&&n.transform&&(this.__mat4.setDataArray(n.transform.matrix),this.__xfo.fromMat4(this.__mat4),this.__treeItem.setLocalXfo(this.__xfo),this.__geomAtTip=void 0,this.__hitTested=!1)}getGeomItemAtTip(){if(this.__hitTested)return this.__intersectionData;this.__hitTested=!0;const t=this.__vrviewport.getRenderer(),e=this.__tip.getGlobalXfo(),i=this.__activeVolumeSize;return this.__intersectionData=t.raycastWithXfo(e,i,i),this.__intersectionData}}class Wi extends xi{constructor(t){super(t),this.getParameter("DoubleClickTimeMS").setValue(300),this.__projectionMatriciesUpdated=!1,this.__far=1024,this.__near=.1,this.__stageTreeItem=new na("VRStage"),this.__stageTreeItem.setSelectable(!1),this.__stageTreeItem.setVisible(!1),this.__renderer.addTreeItem(this.__stageTreeItem),this.__vrhead=new Si(this.__renderer.gl,this.__stageTreeItem),this.__vrControllersMap={},this.__vrControllers=[];const e=new S;e.ori.setFromAxisAndAngle(new Z(1,0,0),.5*Math.PI),this.setXfo(e),this.__leftViewMatrix=new I,this.__leftProjectionMatrix=new I,this.__rightViewMatrix=new I,this.__rightProjectionMatrix=new I}getVRDisplay(){return this.__vrDisplay}getAsset(){return this.__vrAsset}getTreeItem(){return this.__stageTreeItem}getVRHead(){return this.__vrhead}getXfo(){return this.__stageXfo}setXfo(t){this.__stageXfo=t,this.__stageTreeItem.setGlobalXfo(t),this.__stageMatrix=t.inverse().toMat4(),this.__stageScale=t.sc.x}getControllers(){return this.__vrControllers}canPresent(){return this.__canPresent}isPresenting(){return this.__session}__startSession(){const t=(e,i)=>{this.__session&&(this.__session.requestAnimationFrame(t),this.draw(i))};this.__session.requestAnimationFrame(t)}loadHMDResources(){const e=localStorage.getItem("hmd");return this.__hmd!=e&&(this.__hmdAssetPromise=void 0),this.__hmdAssetPromise||(this.__hmd=e,this.__hmdAssetPromise=new Promise((i,n)=>{this.__renderer.addListener("sceneSet",s=>{const o=s.scene.getResourceLoader();let r;switch(e){case"Vive":r="ZeaEngine/Vive.vla";break;case"Oculus":default:r="ZeaEngine/Oculus.vla"}const a=o.resolveFilePathToId(r);a&&!t.isMobileDevice?(this.__vrAsset=this.__renderer.getScene().loadCommonAssetResource(a),this.__vrAsset.addListener("loaded",()=>{const t=this.__vrAsset.getMaterialLibrary(),e=t.getMaterialNames();for(const i of e){const e=t.getMaterial(i,!1);e&&(e.visibleInGeomDataBuffer=!1,e.setShaderName("SimpleSurfaceShader"))}i(this.__vrAsset)})):n()})})),this.__hmdAssetPromise}startPresenting(){return new Promise((e,i)=>{const n=this.__renderer.gl,s=()=>{navigator.xr.requestSession("immersive-vr",{requiredFeatures:["local-floor"],optionalFeatures:["bounded-floor"]}).then(s=>{let o;this.__renderer.__xrViewportPresenting=!0,t.isMobileDevice||(o=document.createElement("canvas"),o.style.position="relative",o.style.left="0px",o.style.top="0px",o.style.width="100%",o.style.height="100%",this.__renderer.getDiv().replaceChild(o,this.__renderer.getGLCanvas()),s.addListener("end",()=>{this.__renderer.getDiv().replaceChild(this.__renderer.getGLCanvas(),o)})),s.addListener("end",()=>{this.__stageTreeItem.setVisible(!1),this.__session=null,this.emit("presentingChanged",{state:!1})}),s.addListener("selectstart",t=>{const e=this.__vrControllersMap[t.inputSource.handedness];if(e){const i=Date.now();console.log("controller:",t.inputSource.handedness," down",i-e.__prevDownTime),i-e.__prevDownTime<this.__doubleClickTimeMSParam.getValue()?this.emit("controllerDoubleClicked",{button:1,controller:e,vleStopPropagation:!1,vrviewport:this},this):(e.__prevDownTime=i,this.emit("controllerButtonDown",{button:1,controller:e,vleStopPropagation:!1,vrviewport:this},this))}}),s.addListener("selectend",t=>{const e=this.__vrControllersMap[t.inputSource.handedness];e&&(console.log("controller:",t.inputSource.handedness," up"),this.emit("controllerButtonUp",{button:1,controller:e,vleStopPropagation:!1,vrviewport:this},this))}),this.__session=s,s.updateRenderState({baseLayer:new XRWebGLLayer(s,n,{compositionDisabled:"inline"==s.mode}),outputContext:o?o.getContext("xrpresent"):null}),s.requestReferenceSpace(t.isMobileDevice?"local":"local-floor").catch(()=>(console.log("Falling back to identity reference space"),s.requestReferenceSpace("viewer").then(t=>t.getOffsetReferenceSpace(new XRRigidTransform({y:-1.6}))))).then(t=>{this.__refSpace=t,this.__stageTreeItem.setVisible(!0),this.emit("presentingChanged",{state:!0}),this.__startSession(),e()}).catch(t=>{console.warn(t.message),i("Unable to start XR Session:"+t.message)})}).catch(t=>{console.warn(t.message)})};t.isMobileDevice?s():this.loadHMDResources().then(s)})}stopPresenting(){this.__session&&this.__session.end()}togglePresenting(){this.__session?this.stopPresenting():this.startPresenting()}getHMDCanvasSize(){return this.__hmdCanvasSize}__createController(t,e){console.log("creating controller:",e.handedness);const i=new Li(this,e,t);return this.__vrControllersMap[e.handedness]=i,this.__vrControllers[t]=i,this.emit("controllerAdded",{controller:i}),vrController}updateControllers(t){const e=this.__session.inputSources;for(let i=0;i<e.length;i++){const n=e[i];if(""==n.handedness||"none"==n.handedness)return;this.__vrControllers[i]||this.__createController(i,n),this.__vrControllers[i].updatePose(this.__refSpace,t,n)}}draw(t){const e=t.session.renderState.baseLayer,i=t.getViewerPose(this.__refSpace),n=i.views;if(!this.__projectionMatriciesUpdated){this.__projectionMatrices=[],this.__viewMatrices=[],this.__cameraMatrices=[],this.__region=[0,0,0,0];for(let t=0;t<n.length;t++){const i=n[t],s=new I;s.setDataArray(i.projectionMatrix),this.__projectionMatrices[t]=s,this.__viewMatrices[t]=new I,this.__cameraMatrices[t]=new I;const o=e.getViewport(i);this.__region[2]=Math.max(this.__region[2],o.x+o.width),this.__region[3]=Math.max(this.__region[3],o.y+o.height)}this.__renderer.resizeFbos(this.__region[2],this.__region[3]),this.__projectionMatriciesUpdated=!0}const s=this.__renderer.gl;s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer),this.__backgroundColor&&s.clearColor(...this.__backgroundColor.asArray()),s.colorMask(!0,!0,!0,!0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);const o={boundRendertarget:e.framebuffer,region:this.__region,viewports:[]};for(let r=0;r<n.length;r++){const t=n[r];this.__viewMatrices[r].setDataArray(t.transform.inverse.matrix),this.__viewMatrices[r].multiplyInPlace(this.__stageMatrix);const i=e.getViewport(t);o.viewports.push({viewMatrix:this.__viewMatrices[r],projectionMatrix:this.__projectionMatrices[r],region:[i.x,i.y,i.width,i.height]})}this.__vrhead.update(i),this.updateControllers(t),o.viewXfo=this.__vrhead.getTreeItem().getGlobalXfo(),o.viewScale=1/this.__stageScale,o.cameraMatrix=o.viewXfo.toMat4(),o.region=this.__region,o.vrPresenting=!0,this.__renderer.drawScene(o),this.capturedElement&&this.capturedElement.onMouseMove({viewport:this}),this.emit("viewChanged",{interfaceType:"VR",hmd:this.__hmd,viewXfo:o.viewXfo,controllers:this.__vrControllers,vrviewport:this})}setCapture(t){this.capturedElement=t}getCapture(){return this.capturedElement}releaseCapture(){this.capturedElement=null,this.renderGeomDataFbo()}}let vi=void 0,Ti=!1,Fi=!1;const Mi={};class Yi extends q{constructor(e,i={}){if(super(),t.gpuDesc){this.__shaders={},this.__passes={},this.__passCallbacks=[],this.__childItemAdded=this.__childItemAdded.bind(this),this.__childItemRemoved=this.__childItemRemoved.bind(this),this.__viewports=[],this.__activeViewport=void 0,this.__continuousDrawing=!1,this.__redrawRequested=!1,this.__isMobile=t.isMobileDevice,this.__drawSuspensionLevel=1,this.__shaderDirectives={},this.__preproc={},this.__xrViewportPresenting=!1,this.renderGeomDataFbos=this.renderGeomDataFbos.bind(this),this.requestRedraw=this.requestRedraw.bind(this),this.setupWebGL(e,i.webglOptions?i.webglOptions:{}),this.bindEventHandlers();for(const t in Mi)for(const e of Mi[t])this.addPass(new e,t,!1);this.addViewport("main"),this.__supportXR=void 0===i.supportXR||i.supportXR,this.__xrViewport=void 0,this.__xrViewportPromise=new Promise(t=>{if(this.__supportXR&&navigator.xr){const e=()=>{this.__gl.makeXRCompatible().then(()=>{this.__xrViewport=this.__setupXRViewport(),this.emit("xrViewportSetup",{xrViewport:this.__xrViewport}),t(this.__xrViewport)})};navigator.xr.supportsSessionMode?navigator.xr.supportsSessionMode("immersive-vr").then(e).catch(t=>{console.warn("Unable to setup XR:"+t)}):navigator.xr.isSessionSupported("immersive-vr").then(t=>{t&&e()}).catch(t=>{console.warn("Unable to setup XR:"+t)})}})}else console.warn("Unable to create renderer")}addShaderPreprocessorDirective(t,e){this.__shaderDirectives[t]=e?"#define "+t+" = "+e:"#define "+t;const i=[];for(const n in this.__shaderDirectives)i.push(this.__shaderDirectives[n]);this.__preproc.defines=i.join("\n")+"\n",this.__gl.shaderopts=this.__preproc}getShaderPreproc(){return this.__preproc}getWidth(){return this.__glcanvas.width}getHeight(){return this.__glcanvas.height}addViewport(t){const e=new Ri(this,t,this.getWidth(),this.getHeight());return e.createGeomDataFbo(this.__floatGeomBuffer),e.addListener("updated",()=>{this.requestRedraw()}),e.addListener("viewChanged",t=>{this.__xrViewportPresenting||this.emit("viewChanged",t)}),this.__viewports.push(e),e}getViewport(t=0){return this.__viewports[t]}getViewportAtPos(t,e){for(const i of this.__viewports){const n=i.getPosX(),s=i.getPosY(),o=i.getWidth(),r=i.getHeight();if(t>=n&&e>=s&&t<=o+n&&e<=r+s)return i}}activateViewport(t){this.__activeViewport!=t&&(this.__activeViewport=t)}activateViewportAtPos(t,e){if(this.__xrViewportPresenting)return;const i=this.getViewportAtPos(t,e);i&&i!=this.__activeViewport&&this.activateViewport(i)}getActiveViewport(){return this.__xrViewportPresenting?this.__xrViewport:this.__activeViewport}suspendDrawing(){this.__drawSuspensionLevel++}resumeDrawing(){this.__drawSuspensionLevel--,0==this.__drawSuspensionLevel&&(this.__loadingImg&&this.__glcanvasDiv.removeChild(this.__loadingImg),this.renderGeomDataFbos(),this.requestRedraw())}renderGeomDataFbos(){1!=this.__renderGeomDataFbosRequested&&(this.__renderGeomDataFbosRequested=!0,window.requestAnimationFrame(()=>{for(const t of this.__viewports)t.renderGeomDataFbo();this.__renderGeomDataFbosRequested=!1}))}setupGrid(t,e,i,n){return console.warn("Deprecated Method. Please use scene.setupGrid"),this.__scene.setupGrid(t,i,e)}getScene(){return this.__scene}setScene(t){this.__scene=t,this.addTreeItem(this.__scene.getRoot()),this.__gizmoContext&&this.__gizmoContext.setSelectionManager(t.getSelectionManager()),this.emit("sceneSet",{scene:this.__scene})}__childItemAdded(t){this.addTreeItem(t.childItem)}__childItemRemoved(t){this.removeTreeItem(t.childItem)}addTreeItem(t){if(t instanceof na){for(const e of this.__passCallbacks){const i={continueInSubTree:!0};if(e.itemAddedFn(t,i)){if(!i.continueInSubTree)return;break}}for(const e of t.getChildren())e&&this.addTreeItem(e);t.addListener("childAdded",this.__childItemAdded),t.addListener("childRemoved",this.__childItemRemoved),this.renderGeomDataFbos()}}removeTreeItem(t){if(t instanceof na){t.removeListener("childAdded",this.__childItemAdded),t.removeListener("childRemoved",this.__childItemRemoved);for(const e of this.__passCallbacks){if(!e.itemRemovedFn)continue;const i={continueInSubTree:!0};if(e.itemRemovedFn(t,i)){if(!i.continueInSubTree)return;break}}for(const e of t.getChildren())e&&this.removeTreeItem(e);this.renderGeomDataFbos()}}get gl(){return this.__gl}getGL(){return this.__gl}resizeFbos(t,e){}__onResize(){if(!this.__xrViewportPresenting){const t=1;this.__glcanvas.width=this.__glcanvas.clientWidth*t,this.__glcanvas.height=this.__glcanvas.clientHeight*t;for(const e of this.__viewports)e.resize(this.__glcanvas.width,this.__glcanvas.height);this.resizeFbos(this.__glcanvas.width,this.__glcanvas.height),this.emit("resized",{width:this.__glcanvas.width,height:this.__glcanvas.height}),this.requestRedraw()}}getDiv(){return this.__glcanvasDiv}setupWebGL(i,n){this.__glcanvas=document.createElement("canvas"),this.__glcanvas.style.position=n.canvasPosition?n.canvasPosition:"absolute",this.__glcanvas.style.left="0px",this.__glcanvas.style.top="0px",this.__glcanvas.style.width="100%",this.__glcanvas.style.height="100%",this.__glcanvasDiv=i,this.__glcanvasDiv.appendChild(this.__glcanvas),e(this.__glcanvas,()=>{this.__onResize()}),this.__onResize(),n.preserveDrawingBuffer=!0,n.stencil=!!n.stencil&&n.stencil,n.alpha=!!n.alpha&&n.alpha,n.xrCompatible=!0,this.__gl=Na(this.__glcanvas,n),this.__gl||alert("Unable to create WebGL context. WebGL not supported."),this.__gl.renderer=this,"webgl2"==this.__gl.name&&this.addShaderPreprocessorDirective("ENABLE_ES3"),this.__gl.floatTexturesSupported&&this.addShaderPreprocessorDirective("ENABLE_FLOAT_TEXTURES"),this.__gl.screenQuad=new Ii(this.__gl),this.__screenQuad=this.__gl.screenQuad,this.__floatGeomBuffer=this.__gl.floatTexturesSupported&&"Safari"!=t.browserName,this.__gl.floatGeomBuffer=this.__floatGeomBuffer}bindEventHandlers(){const t=()=>this.__glcanvas.width>0&&this.__glcanvas.height,e=t=>{const e=this.__glcanvas.getBoundingClientRect();t.rendererX=1*(t.clientX-e.left),t.rendererY=1*(t.clientY-e.top)};this.__glcanvas.addEventListener("mouseenter",t=>{t.undoRedoManager=this.undoRedoManager,Ti||(vi=this,e(t),vi.activateViewportAtPos(t.rendererX,t.rendererY),Fi=!1)}),this.__glcanvas.addEventListener("mouseleave",e=>{if(vi==this&&t())if(e.undoRedoManager=this.undoRedoManager,Ti)Fi=!0;else{const t=vi.getActiveViewport();t&&(t.onMouseLeave(e),e.preventDefault()),vi=void 0}}),this.__glcanvas.addEventListener("mousedown",t=>{t.undoRedoManager=this.undoRedoManager,e(t),Ti=!0,vi=this,vi.activateViewportAtPos(t.rendererX,t.rendererY);const i=vi.getActiveViewport();return i&&i.onMouseDown(t),Fi=!1,!1}),document.addEventListener("mouseup",i=>{if(vi!=this||!t())return;i.undoRedoManager=this.undoRedoManager,e(i),Ti=!1;const n=vi.getActiveViewport();if(n&&n.onMouseUp(i),Fi){const t=vi.getActiveViewport();t&&(t.onMouseLeave(i),i.preventDefault()),vi=void 0}return!1}),document.addEventListener("mousemove",i=>{if(vi!=this||!t())return;i.undoRedoManager=this.undoRedoManager,e(i),Ti||vi.activateViewportAtPos(i.rendererX,i.rendererY);const n=vi.getActiveViewport();return n&&n.onMouseMove(i),!1});const i=e=>{if(vi==this&&t())return vi&&(e.undoRedoManager=this.undoRedoManager,this.onWheel(e)),!1};window.addEventListener?window.addEventListener("wheel",i,{passive:!1}):window.onmousewheel=document.onmousewheel=i,window.oncontextmenu=function(){return!1},document.addEventListener("keypress",e=>{if(vi!=this||!t())return;const i=String.fromCharCode(e.keyCode).toLowerCase(),n=vi.getActiveViewport();n&&n.onKeyPressed(i,e)}),document.addEventListener("keydown",e=>{if(vi!=this||!t())return;const i=String.fromCharCode(e.keyCode).toLowerCase(),n=vi.getActiveViewport();n&&n.onKeyDown(i,e)}),document.addEventListener("keyup",e=>{if(vi!=this||!t())return;const i=String.fromCharCode(e.keyCode).toLowerCase(),n=vi.getActiveViewport();n&&n.onKeyUp(i,e)}),this.__glcanvas.addEventListener("touchstart",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager;for(let i=0;i<t.touches.length;i++)e(t.touches[i]);this.getViewport().onTouchStart(t)},!1),this.__glcanvas.addEventListener("touchmove",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager;for(let i=0;i<t.touches.length;i++)e(t.touches[i]);this.getViewport().onTouchMove(t)},!1),this.__glcanvas.addEventListener("touchend",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager;for(let i=0;i<t.touches.length;i++)e(t.touches[i]);this.getViewport().onTouchEnd(t)},!1),this.__glcanvas.addEventListener("touchcancel",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager,this.getViewport().onTouchCancel(t)},!1)}setUndoRedoManager(t){this.undoRedoManager=t}getGLCanvas(){return this.__glcanvas}getScreenQuad(){return this.__screenQuad}onWheel(t){this.__viewports[0].onWheel(t)}frameAll(t=0){this.__viewports[t].frameView([this.__scene.getRoot()])}getOrCreateShader(t){let e=this.__shaders[t];return e||(e=J.constructClass(t,this.__gl),e||console.error("Shader not registered with the SGFactory:",t),this.__shaders[t]=e),e}addPass(t,e=0,i=!0){this.__passes[e]||(this.__passes[e]=[]);let n=0;for(const s in this.__passes){if(s==e)break;n+=this.__passes[s].length}if(n+=this.__passes[e].length,t.addListener("updated",this.requestRedraw),t.init(this,n),this.__passes[e].push(t),i){let t=0;for(const e in this.__passes){const i=this.__passes[e];i.forEach((e,i)=>{e.setPassIndex(t+i)}),t+=i.length}}return this.requestRedraw(),n}registerPass(t,e){this.__passCallbacks.splice(0,0,{itemAddedFn:t,itemRemovedFn:e})}getPass(t){let e=0;for(const i in this.__passes){const n=this.__passes[i];if(t-e<n.length)return n[t-e];e+=n.length}}findPass(t){for(const e in this.__passes){const i=this.__passes[e];for(const e of i)if(e.constructor==t)return e}}getGizmoPass(){return this.__gizmoPass}supportsVR(){return console.warn("Deprecated Method. Please instead connect to the vrViewportSetup signal."),this.__supportXR&&null!=navigator.xr}__setupXRViewport(){const t=new Wi(this),e=t=>{this.emit("viewChanged",t)};return t.addListener("presentingChanged",i=>{const n=i.state;if(this.__xrViewportPresenting=n,n){for(const t in this.__passes){const e=this.__passes[t];for(const t of e)t.startPresenting()}t.addListener("viewChanged",e)}else{t.removeListener("viewChanged",e),this.emit("updated",{});for(const t in this.__passes){const e=this.__passes[t];for(const t of e)t.stopPresenting()}const i={interfaceType:"CameraAndPointer",viewXfo:this.getViewport().getCamera().getGlobalXfo()};this.emit("viewChanged",i),this.resizeFbos(this.__glcanvas.width,this.__glcanvas.height),this.requestRedraw()}}),t}getVRViewport(){return this.__xrViewport}getXRViewport(){return this.__xrViewportPromise}isXRViewportPresenting(){return this.__xrViewportPresenting}isContinuouslyDrawing(){return this.__continuousDrawing}startContinuousDrawing(){if(this.isContinuouslyDrawing()||this.__xrViewportPresenting)return;const t=()=>{this.__continuousDrawing&&!this.__xrViewportPresenting&&window.requestAnimationFrame(t);for(const t of this.__viewports)t.draw()};this.__continuousDrawing=!0,window.requestAnimationFrame(t)}stopContinuousDrawing(){this.__continuousDrawing=!1}toggleContinuousDrawing(){this.__continuousDrawing?this.stopContinuousDrawing():this.startContinuousDrawing()}drawItemChanged(){for(const t of this.__viewports)t.invalidateGeomDataBuffer();this.requestRedraw()}requestRedraw(){return!(this.__redrawRequested||this.__continuousDrawing||this.__xrViewportPresenting||(window.requestAnimationFrame(()=>{this.__redrawRequested=!1;for(const t of this.__viewports)t.draw()}),this.__redrawRequested=!0,0))}bindGLBaseRenderer(t){t.shaderopts=this.__preproc;const e=this.__gl;t.viewports&&1!=t.viewports.length?(t.bindRendererUnifs=i=>{const{cameraMatrix:n}=i;n&&e.uniformMatrix4fv(n.location,!1,t.cameraMatrix.asArray())},t.bindViewports=(i,n)=>{t.viewports.forEach((t,s)=>{e.viewport(...t.region);const{viewMatrix:o,projectionMatrix:r,eye:a}=i;o&&e.uniformMatrix4fv(o.location,!1,t.viewMatrix.asArray()),r&&e.uniformMatrix4fv(r.location,!1,t.projectionMatrix.asArray()),a&&e.uniform1i(a.location,s),n()})}):(t.bindRendererUnifs=i=>{const{cameraMatrix:n,viewMatrix:s,projectionMatrix:o,eye:r}=i;n&&e.uniformMatrix4fv(n.location,!1,t.cameraMatrix.asArray());const a=t.viewports[0];s&&e.uniformMatrix4fv(s.location,!1,a.viewMatrix.asArray()),o&&e.uniformMatrix4fv(o.location,!1,a.projectionMatrix.asArray()),r&&e.uniform1i(r.location,index)},t.bindViewports=(t,e)=>e())}drawScene(t){for(const e in this.__passes){const i=this.__passes[e];for(const e of i)e.enabled&&e.draw(t)}}drawHighlightedGeoms(t){this.bindGLBaseRenderer(t);for(const e in this.__passes){const i=this.__passes[e];for(const e of i)e.enabled&&e.drawHighlightedGeoms(t)}}drawSceneGeomData(t,e=255){this.bindGLBaseRenderer(t);for(const i in this.__passes){if(0==(Number.parseInt(i)&e))continue;const n=this.__passes[i];for(const e of n)e.enabled&&e.drawGeomData(t)}}static registerPass(t,e){Mi[e]||(Mi[e]=[]),Mi[e].push(t)}}const Ci={OPAQUE:1,TRANSPARENT:2,OVERLAY:4};class Ni extends q{constructor(){super(),this.enabled=!0,this.__passIndex=0;const t=this.addParameter(new Xe("Enabled",!0));t.addListener("valueChanged",()=>this.enabled=t.getValue())}__parameterValueChanged(t){super.__parameterValueChanged(t),this.__renderer&&this.__renderer.requestRedraw()}init(t,e){if(null==e)throw new Error("Missing constructor argument.");this.__gl=t.gl,this.__renderer=t,this.__passIndex=e}setPassIndex(t){this.__passIndex=t}startPresenting(){}stopPresenting(){}draw(t){}drawHighlightedGeoms(t){}drawGeomData(t){}getGeomItemAndDist(t){}}class Ki extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("OutlinesShader.vertexShader","\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    v_texCoord = positions.xy+0.5;\n    gl_Position = vec4(positions.xy*2.0, 0.0, 1.0);\n}\n\n"),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("OutlinesShader.fragmentShader","\nprecision highp float;\n\nuniform sampler2D highlightDataTexture;\nuniform vec2 highlightDataTextureSize;\n\nvarying vec2 v_texCoord;\n\n\nbool isFilledPixel(vec4 p) {\n    return p.r > 0.01 || p.g > 0.01 || p.b > 0.01;\n}\nvoid accumOutlinePixel(vec2 fragCoord, inout vec4 res) {\n    vec3 p = texture2D(highlightDataTexture, fragCoord/highlightDataTextureSize).rgb;\n    if(p.r > 0.01 || p.g > 0.01 || p.b > 0.01) {\n        res.r += p.r;\n        res.g += p.g;\n        res.b += p.b;\n        res.a += 1.0;\n    }\n}\nvec4 getOutlinePixelColor(vec2 fragCoord) {\n    vec4 M = texture2D(highlightDataTexture, fragCoord/highlightDataTextureSize);\n    \n    /// To display a fill instead of an outline.\n    // return M;\n\n    if( isFilledPixel(M) ) {\n        // Note: the filled pixel has an alpha value\n        // that determines how much fill is applied\n        // The outline is a solid color. \n        return M;\n    }\n    // Search surrounding pixels for selected geoms.\n    vec4 res;\n    accumOutlinePixel(fragCoord+vec2( 1, 1), res); // NW\n    accumOutlinePixel(fragCoord+vec2(-1, 1), res); // NE\n    accumOutlinePixel(fragCoord+vec2( 1,-1), res); // SW\n    accumOutlinePixel(fragCoord+vec2(-1,-1), res); // SE\n    accumOutlinePixel(fragCoord+vec2( 0, 2), res); // NN\n    accumOutlinePixel(fragCoord+vec2(-2, 0), res); // EE\n    accumOutlinePixel(fragCoord+vec2( 2, 0), res); // WW\n    accumOutlinePixel(fragCoord+vec2( 0,-2), res); // SS\n    accumOutlinePixel(fragCoord+vec2( 1, 2), res); // NNW\n    accumOutlinePixel(fragCoord+vec2(-1, 2), res); // NNE\n    accumOutlinePixel(fragCoord+vec2(-2, 1), res); // EEN\n    accumOutlinePixel(fragCoord+vec2(-2,-1), res); // EES\n    accumOutlinePixel(fragCoord+vec2( 2, 1), res); // WWN\n    accumOutlinePixel(fragCoord+vec2( 2,-1), res); // WWS\n    accumOutlinePixel(fragCoord+vec2( 1,-2), res); // SSW\n    accumOutlinePixel(fragCoord+vec2(-1,-2), res); // SSE\n\n    if(isFilledPixel(res))\n        return vec4(res.rgb / res.a, 1.0);\n    else\n        return vec4(0.0, 0.0, 0.0, 0.0);\n}\n\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n    // fragColor = texture2D(highlightDataTexture, v_texCoord);;\n    //can also use gl_FragCoord.xy\n    mediump vec2 fragCoord = v_texCoord * highlightDataTextureSize; \n    /////////////////\n    // Selection Outlines\n    vec4 outlineColor = getOutlinePixelColor(fragCoord);\n    if(outlineColor.a > 0.0001){\n#ifndef ENABLE_ES3\n        gl_FragColor = outlineColor;\n#else\n        fragColor = outlineColor;\n#endif\n    }\n    else {\n        discard;\n    }\n}\n\n")}}const wi=Ci.OPAQUE|Ci.TRANSPARENT|Ci.OVERLAY;class zi extends Yi{constructor(e,i={}){super(e,i,{antialias:!0,depth:!0}),this.__exposure=1,this.__tonemap=!0,this.__gamma=2.2,this.__glEnvMap=void 0,this.__glBackgroundMap=void 0,this.__glLightmaps={},this.__displayEnvironment=!0,this.__debugMode=0,this.__debugLightmaps=!1,this._planeDist=0,this.__cutPlaneNormal=new Z(1,0,0);const n=this.__gl;this.__debugTextures=[void 0],this.addShaderPreprocessorDirective("ENABLE_INLINE_GAMMACORRECTION"),i.disableLightmaps||this.addShaderPreprocessorDirective("ENABLE_LIGHTMAPS"),i.disableTextures||this.addShaderPreprocessorDirective("ENABLE_TEXTURES"),t.isMobileDevice||i.disableSpecular||this.addShaderPreprocessorDirective("ENABLE_SPECULAR"),this.__outlineShader=new Ki(n),this.quad=new Pa(n,new jt(1,1)),this.createSelectedGeomsFbo(),this.createRayCastRenderTarget()}__bindEnvMap(t){if(t instanceof Vt)this.__glEnvMap=t.getMetadata("gltexture"),this.__glEnvMap||("FLOAT"===t.type?(this.addShaderPreprocessorDirective("ENABLE_SPECULAR"),this.__glEnvMap=new fi(this,t,this.__preproc)):this.__glEnvMap=t.isStreamAtlas()?new GLImageStream(this.__gl,t):new Ka(this.__gl,t)),this.__glEnvMap.addListener("loaded",this.requestRedraw),this.__glEnvMap.addListener("updated",this.requestRedraw),this.emit("envMapAssigned",{envMap:this.__glEnvMap});else{const e=t;if(this.__glBackgroundMap=e.getMetadata("gltexture"),this.__glBackgroundMap||(this.__glBackgroundMap="FLOAT"===e.type?new ja(gl,e):new Ka(gl,e)),this.__glBackgroundMap.addListener("loaded",this.requestRedraw),this.__glBackgroundMap.addListener("updated",this.requestRedraw),!this.__backgroundMapShader){switch(gl.__quadVertexIdsBuffer||gl.setupInstancedQuad(),e.getMapping()){case"octahedral":this.__backgroundMapShader=new _i(gl);break;case"latlong":this.__backgroundMapShader=new Zi(gl);break;case"steriolatlong":this.__backgroundMapShader=new Gi(gl);break;case"dualfisheye":this.__backgroundMapShader=new yi(gl);break;case"uv":default:this.__backgroundMapShader=new gi(gl)}const t=this.__backgroundMapShader.compileForTarget();this.__backgroundMapShaderBinding=Ua(gl,t.attrs,gl.__quadattrbuffers,gl.__quadIndexBuffer)}}}getGLEnvMap(){return this.__glEnvMap}getEnvMapTex(){return console.warn("Deprecated Function"),this.__glEnvMap}setScene(t){const e=t.settings.getParameter("EnvMap");null!=e.getValue()&&this.__bindEnvMap(e.getValue()),e.addListener("valueChanged",()=>{this.__bindEnvMap(e.getValue())});const i=t.settings.getParameter("Display EnvMap");this.__displayEnvironment=i.getValue(),i.addListener("valueChanged",()=>{this.__displayEnvironment=i.getValue(),this.requestRedraw()}),super.setScene(t)}addTreeItem(t){if(super.addTreeItem(t),t instanceof Ga){const e=(t,e)=>{let i=e.image.getMetadata("gltexture");i||(i=new ja(this.__gl,e.image)),i.addListener("updated",()=>{this.requestRedraw()}),this.__glLightmaps[t]={atlasSize:e.atlasSize,glimage:i}},i=t;i.addListener("loaded",()=>{this.__glEnvMap&&i.getLightmap()&&e(i.getName(),i.getLightmap())})}}removeTreeItem(t){super.removeTreeItem(t)}addViewport(t){return super.addViewport(t)}onKeyPressed(t,e){switch(t){case"b":this.__displayEnvironment=!this.__displayEnvironment,this.requestRedraw();break;default:super.onKeyPressed(t,e)}}get exposure(){return this.__exposure}set exposure(t){this.__exposure=t,this.requestRedraw()}get gamma(){return this.__gamma}set gamma(t){this.__gamma=t,this.requestRedraw()}get displayEnvironment(){return this.__displayEnvironment}set displayEnvironment(t){this.__displayEnvironment=t,this.requestRedraw()}get planeDist(){return this._planeDist}set planeDist(t){this._planeDist=t,this.requestRedraw()}get cutPlaneNormal(){return this.__cutPlaneNormal}set cutPlaneNormal(t){this.__cutPlaneNormal=t,this.requestRedraw()}resizeFbos(t,e){super.resizeFbos(),this.__fbo&&this.__fbo.colorTexture.resize(t,e),this.__highlightedGeomsBufferFbo&&this.__highlightedGeomsBuffer.resize(t,e)}createSelectedGeomsFbo(){const t=this.__gl;this.__highlightedGeomsBuffer=new Ka(t,{type:"UNSIGNED_BYTE",format:"RGBA",filter:"NEAREST",width:this.__glcanvas.width<=1?1:this.__glcanvas.width,height:this.__glcanvas.height<=1?1:this.__glcanvas.height}),this.__highlightedGeomsBufferFbo=new Aa(t,this.__highlightedGeomsBuffer,!0),this.__highlightedGeomsBufferFbo.setClearColor([0,0,0,0])}getFbo(){return this.__fbo}createOffscreenFbo(t="RGB"){const e=this.__gl;this.__fwBuffer=new Ka(e,{type:"FLOAT",format:t,filter:"NEAREST",width:this.__glcanvas.width,height:this.__glcanvas.height}),this.__fbo=new Aa(e,this.__fwBuffer,!0),this.__fbo.setClearColor(this.__backgroundColor.asArray())}createRayCastRenderTarget(){this.__rayCastRenderTarget=new li(this.__gl,{type:"FLOAT",format:"RGBA",filter:"NEAREST",width:3,height:3,numColorChannels:1}),this.__rayCastRenderTargetProjMatrix=new I,this.rayCastDist=0,this.rayCastArea=0}raycastWithRay(t,e,i=.01,n=wi){const s=new S;return s.setLookAt(t.start,t.start.add(t.dir)),this.raycast(s,t,e,i,n)}raycastWithXfo(t,e,i=.01,n=wi){const s=new R(t.tr,t.ori.getZaxis().negate());return this.raycast(t,s,e,i,n)}raycast(t,e,i,n=.01,s=wi){this.rayCastDist==i&&this.rayCastArea==n||(this.__rayCastRenderTargetProjMatrix.setOrthographicMatrix(-.5*n,.5*n,-.5*n,.5*n,0,i),this.rayCastDist=i,this.rayCastArea=n);const o=this.__gl,r={cameraMatrix:t.toMat4(),viewports:[{region:[0,0,3,3],viewMatrix:t.inverse().toMat4(),projectionMatrix:this.__rayCastRenderTargetProjMatrix,isOrthographic:!0}]};this.__rayCastRenderTarget.bindForWriting(r,!0),o.enable(o.CULL_FACE),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.depthMask(!0),this.drawSceneGeomData(r,s),o.finish(),this.__rayCastRenderTarget.unbindForWriting(),this.__rayCastRenderTarget.bindForReading();const a=new Float32Array(36);o.readPixels(0,0,3,3,o.RGBA,o.FLOAT,a),this.__rayCastRenderTarget.unbindForReading();const l=[4,3,5,1,7];let c;for(const u of l)if(0!=a[4*u+3]){c=a.subarray(4*u,4*u+4);break}if(!c)return;const h=63&Math.round(c[0]),d=this.getPass(h).getGeomItemAndDist(c);if(d){const t=e.start.add(e.dir.scale(d.dist));return{ray:e,intersectionPos:t,geomItem:d.geomItem,dist:d.dist,geomData:c}}}drawBackground(t){if(this.__glBackgroundMap){if(!this.__glBackgroundMap.isLoaded())return;const e=this.__gl;e.depthMask(!1),this.__backgroundMapShader.bind(t),this.__glBackgroundMap.bindToUniform(t,t.unifs.backgroundImage),this.__backgroundMapShaderBinding.bind(t),e.drawQuad()}else this.__glEnvMap&&this.__glEnvMap.draw&&this.__glEnvMap.draw(t)}bindGLRenderer(t){super.bindGLBaseRenderer(t),t.envMap=this.__glEnvMap,t.exposure=this.__exposure,t.gamma=this.__gamma,t.lightmaps=this.__glLightmaps,t.boundLightmap=void 0;const e=this.__gl,i=t.bindRendererUnifs;t.bindRendererUnifs=n=>{if(i(n),this.__glEnvMap){const e=n.envMapPyramid;if(e&&this.__glEnvMap.bindProbeToUniform)this.__glEnvMap.bindProbeToUniform(t,e);else{const{envMapTex:e,envMapTexType:i}=n;e&&this.__glEnvMap.bindToUniform(t,e,{textureTypeUnif:i})}}{const t=n.exposure;t&&e.uniform1f(t.location,this.__exposure)}{const t=n.gamma;t&&e.uniform1f(t.location,this.__gamma)}}}drawScene(t){if(this.bindGLRenderer(t),this.__displayEnvironment&&this.drawBackground(t),super.drawScene(t),this.__highlightedGeomsBufferFbo){const e=this.__gl;this.__highlightedGeomsBufferFbo.bindForWriting(t),this.__highlightedGeomsBufferFbo.clear(),e.disable(e.BLEND),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0),this.drawHighlightedGeoms(t),this.__highlightedGeomsBufferFbo.unbindForWriting(t),e.viewport(...t.region),this.__outlineShader.bind(t),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);const i=t.unifs;this.__highlightedGeomsBuffer.bindToUniform(t,i.highlightDataTexture),e.uniform2f(i.highlightDataTextureSize.location,t.region[2],t.region[3]),this.quad.bindAndDraw(t),e.disable(e.BLEND)}this.emit("redrawOccured",{})}}Ba.setShaderModule("drawItemId.glsl","\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\nattribute float instancedIds;    // instanced attribute..\nuniform int instancedDraw;\nuniform int transformIndex;\n\nint getDrawItemId() {\n    if(instancedDraw == 0){\n       return transformIndex;\n    }\n    else{\n       return int(instancedIds);\n    }\n}\n\n\n#else\n\nuniform int transformIndex;\n\nint getDrawItemId() {\n    return transformIndex;\n}\n\n#endif\n\n"),Ba.setShaderModule("drawItemTexture.glsl",'\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\nuniform sampler2D instancesTexture;\nuniform highp int instancesTextureSize;\n\n<%include file="GLSLUtils.glsl"/>\n\nconst int pixelsPerItem = 6;\n\nvec4 getInstanceData(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 0);\n}\n\n#else\n\nuniform vec4 drawItemData;\n\nvec4 getInstanceData(int id) {\n    return drawItemData;\n}\n\n#endif\n\n\n'),Ba.setShaderModule("modelMatrix.glsl","\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\nmat4 getMatrix(sampler2D texture, int textureSize, int index) {\n    // Unpack 3 x 4 matix columns into a 4 x 4 matrix.\n    vec4 col0 = fetchTexel(texture, textureSize, (index * pixelsPerItem) + 1);\n    vec4 col1 = fetchTexel(texture, textureSize, (index * pixelsPerItem) + 2);\n    vec4 col2 = fetchTexel(texture, textureSize, (index * pixelsPerItem) + 3);\n    mat4 result = mat4(col0, col1, col2, vec4(0.0, 0.0, 0.0, 1.0));\n    return transpose(result);\n    // return mat4(1.0);\n}\n\nmat4 getModelMatrix(int id) {\n    return getMatrix(instancesTexture, instancesTextureSize, id);\n}\n\n#else\n\nuniform mat4 modelMatrix;\n\nmat4 getModelMatrix(int id) {\n    return modelMatrix;\n}\n\n#endif\n\n\n"),Ba.setShaderModule("materialparams.glsl","\n\n////////////////////////\n// Material Param Helpers.\n\nvec4 getColorParamValue(vec4 value, sampler2D tex, int texType, vec2 texCoord) {\n    if(texType == 0){\n        return toLinear(value);\n    }\n    else if(texType == 1 || texType == 2){\n        // TODO: Use SRGB textures.\n        return toLinear(texture2D(tex, texCoord));\n    }\n    else if(texType == 3){\n        // Float HDR Texture\n        return texture2D(tex, texCoord);\n    }\n    else\n        return value;\n}\n\n\n\nfloat luminanceFromRGB(vec3 rgb) {\n    return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\nfloat getLuminanceParamValue(float value, sampler2D tex, int texType, vec2 texCoord) {\n    if(texType == 0)\n        return value;\n    else\n        return luminanceFromRGB(texture2D(tex, texCoord).rgb);\n}\n"),Ba.setShaderModule("debugColors.glsl","\n\nfloat modI(float a, float b) {\n    float m=a-floor((a+0.5)/b)*b;\n    return floor(m+0.5);\n}\n\nvec3 getDebugColor(float id) {\n#ifdef GLSL_ES3\n    const vec3 clusterColors[4] = vec3[4]( vec3(0.0, 0.25, 0.25), vec3(0.0, 0.85, 0.25), vec3(0.0, 0.25, 0.85), vec3(0.0, 0.85, 0.85) );\n#else\n    vec3 clusterColors[8];\n    clusterColors[0] = vec3(0.0, 0.15, 0.15);\n    clusterColors[1] = vec3(0.0, 0.85, 0.15);\n    clusterColors[2] = vec3(0.0, 0.15, 0.85);\n    clusterColors[3] = vec3(0.0, 0.85, 0.85);\n    clusterColors[4] = vec3(0.75, 0.15, 0.15);\n    clusterColors[5] = vec3(0.75, 0.85, 0.15);\n    clusterColors[6] = vec3(0.75, 0.15, 0.85);\n    clusterColors[7] = vec3(0.75, 0.85, 0.85);\n#endif\n\n    if(modI(id, 8.0) == 0.0)\n        return clusterColors[0];\n    else if(modI(id, 8.0) == 1.0)\n        return clusterColors[1];\n    else if(modI(id, 8.0) == 2.0)\n        return clusterColors[2];\n    else if(modI(id, 8.0) == 3.0)\n        return clusterColors[3];\n    else if(modI(id, 8.0) == 4.0)\n        return clusterColors[4];\n    else if(modI(id, 8.0) == 5.0)\n        return clusterColors[5];\n    else if(modI(id, 8.0) == 6.0)\n        return clusterColors[6];\n    else if(modI(id, 8.0) == 7.0)\n        return clusterColors[7];\n\n    return vec3(1,0,0);\n}\n\n\n");class Ui extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("BillboardShader.vertexShader",'\nprecision highp float;\n\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 cameraMatrix;\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\ninstancedattribute float instanceIds;\n\n<%include file="GLSLUtils.glsl"/>\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="utils/imageAtlas.glsl"/>\n\nuniform sampler2D atlasBillboards_layout;\nuniform vec4 atlasBillboards_desc;\n\nuniform sampler2D instancesTexture;\nuniform int instancesTextureSize;\n\n\nconst int cols_per_instance = 5;\n\nmat4 getMatrix(sampler2D texture, int textureSize, int index) {\n  // Unpack 3 x 4 matix columns into a 4 x 4 matrix.\n  vec4 col0 = fetchTexel(texture, textureSize, (index * cols_per_instance) + 0);\n  vec4 col1 = fetchTexel(texture, textureSize, (index * cols_per_instance) + 1);\n  vec4 col2 = fetchTexel(texture, textureSize, (index * cols_per_instance) + 2);\n  mat4 result = mat4(col0, col1, col2, vec4(0.0, 0.0, 0.0, 1.0));\n  return transpose(result);\n  // return mat4(1.0);\n}\n\nmat4 getModelMatrix(int id) {\n  return getMatrix(instancesTexture, instancesTextureSize, id);\n}\nvec4 getInstanceData(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * cols_per_instance) + 3);\n}\nvec4 getTintColor(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * cols_per_instance) + 4);\n}\n\n\n#else\n\nuniform vec4 atlasBillboards_desc;\n\nuniform mat4 modelMatrix;\nuniform vec4 billboardData;\nuniform vec4 tintColor;\nuniform vec4 layoutData;\n\n#endif\n\nuniform int inVR;\n\nmat4 calcLookAtMatrix(vec3 origin, vec3 target, float roll) {\n  // vec3 rr = vec3(sin(roll), 0.0, cos(roll));\n  vec3 rr = vec3(0.0, 0.0, 1.0);\n  vec3 ww = normalize(target - origin);\n  vec3 uu = normalize(cross(rr, ww));\n  vec3 vv = normalize(cross(ww, uu));\n\n  return mat4(vec4(uu, 0.0), vec4(vv, 0.0), vec4(ww, 0.0), vec4(origin, 1.0));\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying float v_alpha;\nvarying vec4 v_tint;\n\nvoid main(void) {\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\n  int instanceID = int(instanceIds);\n\n  mat4 modelMatrix = getModelMatrix(instanceID);\n  vec4 billboardData = getInstanceData(instanceID);\n  vec4 layoutData = fetchTexel(atlasBillboards_layout, int(atlasBillboards_desc.z), int(billboardData.z));\n  v_tint = getTintColor(instanceID);\n\n#else\n\n  v_tint = tintColor;\n\n#endif\n\n  vec2 quadVertex = getQuadVertexPositionFromID();\n\n\n  v_texCoord = vec2(quadVertex.x, -quadVertex.y) + 0.5;\n  v_alpha = billboardData.w;\n  v_texCoord *= layoutData.zw;\n  v_texCoord += layoutData.xy;\n\n  float scl = billboardData.x;\n  float width = layoutData.z * atlasBillboards_desc.x * scl;\n  float height = layoutData.w * atlasBillboards_desc.y * scl;\n  int flags = int(billboardData.y);\n  bool alignedToCamera = (flags & (1<<2)) != 0;\n  mat4 modelViewProjectionMatrix;\n  if(alignedToCamera){\n    if (inVR == 0) {\n      gl_Position = (viewMatrix * modelMatrix) * vec4(0.0, 0.0, 0.0, 1.0);\n      gl_Position += vec4(quadVertex.x * width, (quadVertex.y + 0.5) * height, 0.0, 0.0);\n      gl_Position = projectionMatrix * gl_Position;\n    } else {\n      vec3 cameraPos = vec3(cameraMatrix[3][0], cameraMatrix[3][1], cameraMatrix[3][2]);\n      vec3 billboardPos = vec3(modelMatrix[3][0], modelMatrix[3][1], modelMatrix[3][2]);\n      mat4 lookAt = calcLookAtMatrix(billboardPos, cameraPos, 0.0);\n      mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * lookAt;\n      gl_Position = modelViewProjectionMatrix * vec4(quadVertex.x * width, (quadVertex.y + 0.5) * height, 0.0, 1.0);\n    }\n  }\n  else{\n    modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position = modelViewProjectionMatrix * vec4(quadVertex.x * width, (quadVertex.y + 0.5) * height, 0.0, 1.0);\n  }\n\n  // Note: nowhere are we setting this flag\n  bool drawOnTop = (flags & (1<<3)) != 0;\n  if(drawOnTop){\n    gl_Position.z -= 0.05;\n  }\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("BillboardShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="materialparams.glsl"/>\n<%include file="utils/imageAtlas.glsl"/>\n\nuniform sampler2D atlasBillboards;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying float v_alpha;\nvarying vec4 v_tint;\n\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  fragColor = texture2D(atlasBillboards, v_texCoord) * v_tint;\n  fragColor.a *= v_alpha;\n\n  // fragColor.r = 1.0;\n  // fragColor.a = 1.0;\n  \n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}}class Ji extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("DepthMapShader.vertexShader","\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\nuniform mat4 modelMatrix;\nuniform mat4 lightViewMatrix;\nuniform mat4 lightProjectionMatrix;\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n\nvoid main(void) {\n  mat4 modelViewMatrix = lightViewMatrix * modelMatrix;\n  v_viewPos = modelViewMatrix * vec4(positions, 1.0);\n  gl_Position = lightProjectionMatrix * v_viewPos;\n}\n\n"),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("DepthMapShader.fragmentShader","\n#extension GL_OES_standard_derivatives : enable\nprecision highp float;\n\nuniform float near;\nuniform float far;\n\nvarying vec3 v_viewPos;\n\nfloat linstep(float edge0, float edge1, float value){\n  return clamp((value-edge0)/(edge1-edge0), 0.0, 1.0);\n}\n\nvoid main(void) {\n  float depth = linstep(near, far, -v_viewPos.z);\n  //gl_FragColor = vec4(depth, depth, depth,  1.0);\n\n  float dx = dFdx(depth);\n  float dy = dFdy(depth);\n  gl_FragColor = vec4(depth, pow(depth, 2.0) + 0.25*(dx*dx + dy*dy), 0.0, 1.0);\n}\n")}}class Pi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("EnvProjectionShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform vec3 projectionCenter;\n\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\n \nvoid main()\n{\n  int drawItemId = getDrawItemId();\n  vec4 pos = vec4(positions, 1.);\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n\n  gl_Position = modelViewProjectionMatrix * pos;\n\n  vec4 worldPos = modelMatrix * pos;\n  v_worldDir = worldPos.xyz - projectionCenter;\n}\n\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"projectionCenter",defaultValue:new Z(0,0,1.7)}),t}}class Ei extends Pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("OctahedralEnvProjectionShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\n\nuniform color envMap;\nuniform sampler2D envMapTex;\nuniform int envMapTexType;\n\n\nuniform float exposure;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 texCoord = dirToSphOctUv(normalize(v_worldDir));\n  vec4 env = getColorParamValue(envMap, envMapTex, envMapTexType, texCoord);\n\n  fragColor = vec4(env.rgb/env.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}J.registerClass("OctahedralEnvProjectionShader",Ei);class Hi extends Pi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("LatLongEnvProjectionShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color envMap;\nuniform sampler2D envMapTex;\nuniform int envMapTexType;\n\nuniform float exposure;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 texCoord = latLongUVsFromDir(normalize(v_worldDir));\n  vec4 env = getColorParamValue(envMap, envMapTex, envMapTexType, texCoord);\n  fragColor = vec4(env.rgb/env.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}J.registerClass("LatLongEnvProjectionShader",Hi);class ki extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("FatLinesShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec2 segmentIndices;\nattribute float vertexIDs;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nuniform sampler2D positionsTexture;\nuniform int positionsTextureSize;\n\nuniform float LineThickness;\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\nvarying vec2 v_texCoord;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  int vertexID = int(vertexIDs);\n\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n\n  int seqentialIndex_0 = int(mod(segmentIndices.x, 2.));\n  int seqentialIndex_1 = int(mod(segmentIndices.y, 2.));\n  int index_0 = int(segmentIndices.x) / 2;\n  int index_1 = int(segmentIndices.y) / 2;\n\n  vec3 viewPos;\n  vec4 data_0 = fetchTexel(positionsTexture, positionsTextureSize, index_0);\n  vec4 data_1 = fetchTexel(positionsTexture, positionsTextureSize, index_1);\n\n  vec4 pos_0 = modelViewMatrix * vec4(data_0.xyz, 1.0);\n  vec4 pos_1 = modelViewMatrix * vec4(data_1.xyz, 1.0);\n  // Note: multiply the per-vertex line thickness with the line thickness uniform value;\n  float lineThickness_0 = LineThickness * data_0.w;\n  float lineThickness_1 = LineThickness * data_1.w;\n\n  if(vertexID < 2){\n    viewPos = pos_0.xyz;\n  }\n  else{\n    viewPos = pos_1.xyz;\n  }\n  if(pos_1 != pos_0){\n    vec3 segmentDir = normalize(pos_1.xyz - pos_0.xyz);\n    vec3 viewVector = normalize(viewPos);\n\n    if(vertexID < 2){\n      vec3 segmentStartDir = segmentDir;\n      if(seqentialIndex_0 != 0){\n        //if index_0 == 0, get the last index in the line as previous\n        int index_prev = (index_0 > 0) ? (index_0-1) : (positionsTextureSize-1);\n        vec4 data_prev = fetchTexel(positionsTexture, positionsTextureSize, index_prev);\n        vec4 pos_prev = modelViewMatrix * vec4(data_prev.xyz, 1.0);\n        segmentStartDir = normalize(segmentDir + normalize(pos_0.xyz - pos_prev.xyz));\n      }\n      vec3 startBiTangent = normalize(cross(segmentStartDir, viewVector));\n      v_viewNormal = normalize(cross(segmentStartDir, startBiTangent));\n      // Move the endpoints to overlap a bit more.\n      //viewPos -= vec3(segmentStartDir * lineThickness_0 * 0.25);\n      if(mod(vertexIDs, 2.0) == 0.0){\n        viewPos += vec3(startBiTangent * lineThickness_0);\n        v_texCoord.x = 1.0;\n      }\n      else{\n        viewPos -= vec3(startBiTangent * lineThickness_0);\n        v_texCoord.x = 0.0;\n      }\n      v_texCoord.y = 0.0;\n    }\n    else{\n      vec3 segmentEndDir = segmentDir;\n      if(seqentialIndex_1 != 0){\n        //if index_1 == numPoints-1, get the first index in the line as next\n        int index_next = (index_1 < (positionsTextureSize-1)) ? (index_1+1) : 0;\n        vec4 data_next = fetchTexel(positionsTexture, positionsTextureSize, index_next);\n        vec4 pos_next = modelViewMatrix * vec4(data_next.xyz, 1.0);\n        segmentEndDir = normalize(segmentDir + normalize(pos_next.xyz - pos_1.xyz));\n      }\n      vec3 endBiTangent = normalize(cross(segmentEndDir, viewVector));\n      v_viewNormal = normalize(cross(segmentEndDir, endBiTangent));\n      // Move the endpoints to overlap a bit more.\n      //viewPos += vec3(segmentEndDir * lineThickness_1 * 0.25);\n      if(mod(vertexIDs, 2.0) == 0.0){\n        viewPos += vec3(endBiTangent * lineThickness_1);\n        v_texCoord.x = 1.0;\n      }\n      else{\n        viewPos -= vec3(endBiTangent * lineThickness_1);\n        v_texCoord.x = 0.0;\n      }\n      v_texCoord.y = 1.0;\n    }\n\n    // Move the line towards the viewer by the line thickness.\n    // this is to avoid depth issues when lines are rendered over meshes. \n    viewPos.z -= (lineThickness_0 + lineThickness_1) * 0.25;\n  }\n\n  v_viewPos       = viewPos;\n  gl_Position     = projectionMatrix * vec4(viewPos, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("FatLinesShader.fragmentShader","\nprecision highp float;\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\nvarying vec2 v_texCoord;\n\nuniform color BaseColor;\nuniform mat4 cameraMatrix;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  int debugLevel = 0;\n  if(debugLevel == 0){\n\n    vec3 viewVector = mat3(cameraMatrix) * normalize(-v_viewPos);\n    vec3 normal = mat3(cameraMatrix) * v_viewNormal;\n    float NdotV = dot(normalize(normal), normalize(viewVector));\n\n    // Modulate the lighting using the texture coord so the line looks round.\n    NdotV *= cos((v_texCoord.x - 0.5) * 2.0);\n\n    vec4 color = BaseColor * NdotV;\n    fragColor = vec4(color.rgb, BaseColor.a);\n  }\n  else{\n    fragColor = vec4(v_texCoord.x, 0.0, 0.0, 1.0);\n  }\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n"),this.finalize()}bind(t){return!!super.bind(t)&&(t.supportsInstancing=!1,!0)}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"Opacity",defaultValue:1}),t}}J.registerClass("FatLinesShader",ki),Ba.setShaderModule("stack-gl/gamma.glsl","\n\nconst float gamma_const = 2.2;\n\nfloat toLinear(float v) {\n  return pow(v, gamma_const);\n}\n\nvec2 toLinear(vec2 v) {\n  return pow(v, vec2(gamma_const));\n}\n\nvec3 toLinear(vec3 v) {\n  return pow(v, vec3(gamma_const));\n}\n\nvec4 toLinear(vec4 v) {\n  return vec4(toLinear(v.rgb), v.a);\n}\n\n\nfloat toGamma(float v) {\n  return pow(v, 1.0 / gamma_const);\n}\n\nvec2 toGamma(vec2 v) {\n  return pow(v, vec2(1.0 / gamma_const));\n}\n\nvec3 toGamma(vec3 v) {\n  return pow(v, vec3(1.0 / gamma_const));\n}\n\nvec4 toGamma(vec4 v) {\n  return vec4(toGamma(v.rgb), v.a);\n}\n\nfloat toGamma(float v, float gamma) {\n  return pow(v, 1.0 / gamma);\n}\n\nvec2 toGamma(vec2 v, float gamma) {\n  return pow(v, vec2(1.0 / gamma));\n}\n\nvec3 toGamma(vec3 v, float gamma) {\n  return pow(v, vec3(1.0 / gamma));\n}\n\nvec4 toGamma(vec4 v, float gamma) {\n  return vec4(toGamma(v.rgb, gamma), v.a);\n}\n\n\n");class Bi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("FlatSurfaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n\n    vec4 viewPos = (modelViewMatrix * vec4(positions, 1.0));\n    gl_Position = projectionMatrix * viewPos;\n\n    v_viewPos = viewPos.xyz;\n    v_textureCoord = texCoords;\n    v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("FlatSurfaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color BaseColor;\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n#endif\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor = BaseColor;\n#else\n    vec4 baseColor = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = baseColor;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J.registerClass("FlatSurfaceShader",Bi);class Di extends Bi{static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}J.registerClass("FlatAlphaSurfaceShader",Di),Ba.setShaderModule("math/constants.glsl","\n\n#define PI 3.141592653589793\n#define TwoPI (2.0 * PI)\n#define HalfPI (0.5 * PI)\n\n"),Ba.setShaderModule("GGX_Specular.glsl",'\n\n\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n<%include file="utils/imagePyramid.glsl"/>\n\n// uniform ImageAtlas envMap;\n// see: GLImageAtlas.js: line 460.\nuniform sampler2D   envMapPyramid;\nuniform sampler2D   envMapPyramid_layout;\nuniform vec4        envMapPyramid_desc;\n\n\nvec3 sampleEnvMap(vec3 dir, float roughness) {\n    return sampleImagePyramid(dirToSphOctUv(dir), roughness, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc).rgb;\n}\n\n\n// Borrowed heavily from here: http://www.codinglabs.net/article_physically_based_rendering_cook_torrance.aspx\n\nvec3 Fresnel_Schlick(float cosT, vec3 F0)\n{\n    return F0 + (vec3(1.0)-F0) * vec3(pow( 1.0 - cosT, 5.0));\n\n    // for now we calculate this in the suface shader\n    // float schlick = reflectance + pow((1.0-reflectance)*(1.0-dot(N,V)), 5.0);\n}\n\nfloat chiGGX(float v)\n{\n    return v > 0.0 ? 1.0 : 0.0;\n}\n\nfloat saturate(float v)\n{\n    return clamp(v, 0.0, 1.0);\n}\n\nvec3 saturate(vec3 v)\n{\n    return clamp(v, vec3(0.0), vec3(1.0));\n}\n\nfloat saturatedDot( in vec3 a, in vec3 b )\n{\n    return max( dot( a, b ), 0.0 );   \n}\n\nfloat GGX_PartialGeometryTerm(vec3 v, vec3 n, vec3 h, float alpha)\n{\n    float VoH2 = saturate(dot(v,h));\n    float chi = chiGGX( VoH2 / saturate(dot(v,n)) );\n    VoH2 = VoH2 * VoH2;\n    float tan2 = ( 1.0 - VoH2 ) / VoH2;\n    return (chi * 2.0) / ( 1.0 + sqrt( 1.0 + alpha * alpha * tan2 ) );\n}\n\nvec3 GGX_Specular_PrefilteredEnv(vec3 normal, vec3 viewVector, float roughness, float fresnel)\n{\n    vec3 reflectionVector = reflect(-viewVector, normal);\n    vec3 radiance = vec3(0.0);\n    float NoV = saturate(dot(normal, viewVector));\n\n    vec3 sampleVector = reflectionVector;\n\n    // Calculate the half vector\n    vec3 halfVector = normalize(sampleVector + viewVector);\n    float cosT = saturatedDot(reflectionVector, normal);\n    float sinT = sqrt( 1.0 - cosT * cosT);\n\n    // Calculate fresnel\n    // vec3 fresnel = Fresnel_Schlick( saturate(dot( halfVector, viewVector ) ), F0 );\n    // Geometry term\n    float geometry = GGX_PartialGeometryTerm(viewVector, normal, halfVector, clamp(roughness, 0.01, 1.0)) * GGX_PartialGeometryTerm(reflectionVector, normal, halfVector, clamp(roughness, 0.01, 1.0));\n\n    // Calculate the Cook-Torrance denominator\n    float denominator = clamp( 4.0 * (NoV * saturate(dot(halfVector, normal)) + 0.05), 0.0, 1.0 );\n    // kS += fresnel;\n\n    // Accumulate the radiance\n    vec3 envColor = sampleEnvMap(reflectionVector, roughness);\n    radiance += envColor * geometry * fresnel * sinT / denominator;\n    //radiance += envColor * fresnel; // Removing "geometry" for now until we construct a better geometric shading term\n\n    return radiance;        \n}\n'),Ba.setShaderModule("PBRSurfaceRadiance.glsl","\n\nstruct MaterialParams {\n    vec3 baseColor;\n    float metallic;\n    float roughness;\n    float reflectance;\n};\n\nvec4 pbrSpecularReflectance(in MaterialParams materialParams, vec3 normal, in vec3 viewVector) {\n\n    float NdotV = dot(normal, viewVector);\n    \n    // -------------------------- Specular Reflectance --------------------------\n    // vec3 ks = vec3(0.0);\n    // vec3 specular = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, F0, ks );\n    // vec3 kd = (vec3(1.0) - ks) * vec3(1.0 - metallic);    \n\n    float schlickFresnel = materialParams.reflectance + pow((1.0-materialParams.reflectance)*(1.0-NdotV), 5.0);\n\n    vec3 specularReflectance = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, schlickFresnel);\n\n\n    // -------------------------- Specular Occlusion --------------------------\n    // Fast and quick way of reducing specular reflection in areas that are less exposed to the environment\n    // A better approch is to try screen space specular occlusion but need to check performance and feasibility in webGL\n    //float specularOcclusion = clamp(length(irradiance), 0.01, 1.0);    \n    //specularReflectance = (specularReflectance * specularOcclusion); \n\n    return vec4(specularReflectance, schlickFresnel);\n}\n\n\nvec3 pbrSurfaceRadiance(in MaterialParams materialParams, vec3 irradiance, vec3 normal, in vec3 viewVector) {\n\n    float NdotV = dot(normal, viewVector);\n    vec3 specularReflectance;\n\n    // -------------------------- Diffuse Reflectance --------------------------\n\n    vec3 diffuseReflectance = materialParams.baseColor * irradiance;\n\n    // From the Disney dielectric BRDF    \n    // Need to check if this is useful for us but the implementation works based on their paper\n    //diffuseReflectance = (diffuseReflectance / PI); // << [PT 18-08-2018] What did this line do??? (makes everything 3.1x darker.)\n    // diffuseReflectance = vec3(mix(diffuseReflectance, diffuseReflectance * mix(0.5, 2.5, materialParams.roughness), pow(1.0 - NdotV, 5.0)));\n    diffuseReflectance = vec3(mix(diffuseReflectance, diffuseReflectance * mix(0.5, 1.0, materialParams.roughness), pow(1.0 - NdotV, 5.0)));\n\n\n    // -------------------------- Color at normal incidence --------------------------\n    \n    // Need to use 'Reflectance' here instead of 'ior'\n    //vec3 F0 = vec3(abs((1.0 - ior) / (1.0 + ior)));    \n    //F0 = F0 * F0;\n    //F0 = mix(F0, materialParams.baseColor, materialParams.metallic);      \n\n\n    // -------------------------- Specular Reflectance --------------------------\n    // vec3 ks = vec3(0.0);\n    // vec3 specular = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, F0, ks );\n    // vec3 kd = (vec3(1.0) - ks) * vec3(1.0 - metallic);    \n\n    float schlickFresnel = materialParams.reflectance + pow((1.0-materialParams.reflectance)*(1.0-NdotV), 5.0);\n\n    specularReflectance = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, schlickFresnel);\n\n\n    // -------------------------- Specular Occlusion --------------------------\n    // Fast and quick way of reducing specular reflection in areas that are less exposed to the environment\n    // A better approch is to try screen space specular occlusion but need to check performance and feasibility in webGL\n    //float specularOcclusion = clamp(length(irradiance), 0.01, 1.0);    \n    //specularReflectance = (specularReflectance * specularOcclusion);  \n      \n\n    // -------------------------- Metallic --------------------------\n    // We need to do few things given a higher > 0 metallic value\n    //      1. tint specular reflectance by the albedo color (not at grazing angles)\n    //      2. almost elliminate all diffuse reflectance (in reality metals have some diffuse due to layering (i.e. dust, prints, etc.))\n    //      3. set \"specular\" artistic value to metallic range (0.6 - 0.85)\n\n    specularReflectance = mix(specularReflectance, specularReflectance * materialParams.baseColor, materialParams.metallic);\n    diffuseReflectance = mix(diffuseReflectance, vec3(0.0,0.0,0.0), materialParams.metallic); // Leaveing at pure black for now but always need some %3 diffuse left for imperfection of pulished pure metal\n    // Would be best to compute reflectace internally and set here to 0.6-0.85 for metals\n    \n\n    // -------------------------- Final color --------------------------\n    // Energy conservation already taken into account in both the diffuse and specular reflectance\n    vec3 radiance = diffuseReflectance + specularReflectance;\n\n    // radiance = vec4( kd * diffuse + /*ks */ specular, 1);\n    return radiance;\n}\n");class Oi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("LayeredCarPaintShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec3 normals;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\nattribute vec2 lightmapCoords;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nattribute float clusterIDs;\nuniform vec2 lightmapSize;\n\n/* VS Outputs */\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n\n    v_geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n\n#ifdef ENABLE_TEXTURES\n    v_textureCoord  = texCoords;\n#endif\n    // v_lightmapCoord = (lightmapCoords + geomItemData.zw) / lightmapSize;\n\n    // mat4 mvp = projectionMatrix * viewMatrix * modelMatrix;\n    // gl_Position = mvp * vec4((lightmapCoords + geomItemData.xy), 0., 1.);\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n//     v_clusterID = clusterIDs;\n// #endif\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("LayeredCarPaintShader.fragmentShader",'\n#ifndef ENABLE_ES3\n    #extension GL_OES_standard_derivatives : enable\n#endif\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="GGX_Specular.glsl"/>\n<%include file="PBRSurfaceRadiance.glsl"/>\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\n#endif\n<%include file="materialparams.glsl"/>\n\n/* VS Outputs */\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\nuniform sampler2D lightmap;\nuniform vec2 lightmapSize;\n#ifdef ENABLE_DEBUGGING_LIGHTMAPS\n<%include file="debugColors.glsl"/>\nuniform bool debugLightmapTexelSize;\n#endif\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nuniform mat4 cameraMatrix;\n\nuniform color BaseColor;\nuniform color MidColorTint;\nuniform float MidColorTintReflectance;\n\nuniform float MicroflakePerturbation;\nuniform sampler2D FlakesNormalTex;\nuniform float FlakesScale;\n\n#ifdef ENABLE_SPECULAR\n\nuniform float BaseRoughness;\nuniform float BaseMetallic;\nuniform float BaseReflectance;\nuniform float GlossRoughness;\nuniform float GlossMetallic;\nuniform float GlossReflectance;\n\n#endif\n\n#ifdef ENABLE_TEXTURES\n\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n\n#endif\n\n// Followup: Normal Mapping Without Precomputed Tangents\n// http://www.thetenthplanet.de/archives/1180\nmat3 cotangent_frame( vec3 normal, vec3 position, vec2 uv )\n{\n    // get edge vectors of the pixel triangle\n    vec3 dp1 = dFdx( position );\n    vec3 dp2 = dFdy( position );\n    vec2 duv1 = dFdx( uv );\n    vec2 duv2 = dFdy( uv );\n \n    // solve the linear system\n    vec3 dp2perp = cross( dp2, normal );\n    vec3 dp1perp = cross( normal, dp1 );\n    vec3 tangent = dp2perp * duv1.x + dp1perp * duv2.x;\n    vec3 bitangent = dp2perp * duv1.y + dp1perp * duv2.y;\n \n    // construct a scale-invariant frame \n    float invmax = inversesqrt( max( dot(tangent,tangent), dot(bitangent,bitangent) ) );\n    return mat3( tangent * invmax, bitangent * invmax, normal );\n}\n\n#define WITH_NORMALMAP_UNSIGNED 1\n\nvec3 sampleNormalMap( sampler2D normalMap, vec2 texcoord )\n{\n    // assume normal, the interpolated vertex normal and \n    // viewVec, the view vector (vertex to eye)\n    vec3 map = texture2D( normalMap, texcoord ).xyz;\n#ifdef WITH_NORMALMAP_UNSIGNED\n    map = map * 255./127. - 128./127.;\n#endif\n#ifdef WITH_NORMALMAP_2CHANNEL\n    map.z = sqrt( 1. - dot( map.xy, map.xy ) );\n#endif\n#ifdef WITH_NORMALMAP_GREEN_UP\n    map.y = -map.y;\n#endif\n    return map;\n}\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n    MaterialParams material;\n\n#ifndef ENABLE_TEXTURES\n    material.baseColor      = BaseColor.rgb;\n#else\n    vec2 texCoord           = vec2(v_textureCoord.x, 1.0 - v_textureCoord.y);\n    material.baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, texCoord).rgb;\n#endif\n\n#ifdef ENABLE_SPECULAR\n    material.roughness      = BaseRoughness;\n    material.metallic       = BaseMetallic;\n    material.reflectance    = BaseReflectance;\n#endif\n\n    vec3 irradiance = texture2D(lightmap, v_lightmapCoord).rgb;\n \n#ifdef ENABLE_DEBUGGING_LIGHTMAPS\n    if(debugLightmapTexelSize)\n    {\n        vec2 coord_texelSpace = (v_lightmapCoord * lightmapSize) - v_geomItemData.zw;\n        //vec2 coord_texelSpace = (v_textureCoord * lightmapSize);\n        float total = floor(coord_texelSpace.x) +\n                      floor(coord_texelSpace.y);\n                      \n        vec3 clustercolor = getDebugColor(v_clusterID);\n\n        if(mod(total,2.0)==0.0){\n            material.baseColor = clustercolor;\n            irradiance = vec3(1.0);\n        }\n        else{\n            material.baseColor = material.baseColor * 1.5;\n        }\n    }\n#endif\n\n    vec3 viewNormal = normalize(v_viewNormal);\n    vec3 surfacePos = -v_viewPos;\n\n    // The vector from the camera to the surface point.\n    vec3 viewVector = mat3(cameraMatrix) * normalize(v_viewPos);\n    vec3 viewDir = normalize(viewVector);\n    vec3 normal = normalize(mat3(cameraMatrix) * viewNormal);\n\n    float NdotV = dot(normal, viewDir);\n    if(NdotV < 0.0){\n        normal = -normal;\n        NdotV = dot(normal, viewDir);\n    }\n\n#ifndef ENABLE_SPECULAR\n    vec3 radiance = material.baseColor * irradiance;\n#else\n    \n    // Mix the base color to give a multi-layered paint look.\n    material.baseColor      = mix(material.baseColor, material.baseColor * MidColorTint.rgb, (1.0-NdotV));\n\n    mat3 TBN = cotangent_frame( normal, surfacePos, v_lightmapCoord );\n    vec3 flakesNormal = TBN * -sampleNormalMap( FlakesNormalTex, (v_lightmapCoord * lightmapSize) / FlakesScale );\n    flakesNormal = normalize(mix(normal, flakesNormal, MicroflakePerturbation));\n\n    vec3 baseRadiance = pbrSurfaceRadiance(material, irradiance, flakesNormal, viewVector);\n\n    material.roughness      = GlossRoughness;\n    material.reflectance    = GlossReflectance;\n    vec4 gloss = pbrSpecularReflectance(material, normal, viewVector);\n    vec3 radiance = mix(baseRadiance, gloss.rgb, gloss.a);\n    //vec3 radiance = baseRadiance;\n\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(radiance, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();t.push({name:"BaseColor",defaultValue:new y$2(1,0,0)}),t.push({name:"BaseMetallic",defaultValue:0}),t.push({name:"BaseRoughness",defaultValue:.35}),t.push({name:"BaseReflectance",defaultValue:.03}),t.push({name:"MidColorTint",defaultValue:new y$2(1,1,1)}),t.push({name:"MidColorTintReflectance",defaultValue:.03}),t.push({name:"GlossMetallic",defaultValue:0}),t.push({name:"GlossRoughness",defaultValue:.35}),t.push({name:"GlossReflectance",defaultValue:.03});const e=new dt("flakes","ZeaEngine/FlakesNormalMap.png");return e.wrap="REPEAT",e.mipMapped=!0,t.push({name:"FlakesNormal",defaultValue:e}),t.push({name:"FlakesScale",defaultValue:.1}),t.push({name:"MicroflakePerturbation",defaultValue:.1}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J.registerClass("LayeredCarPaintShader",Oi);class Qi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("FlatShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec2 lightmapCoords;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform vec3 ProjectionCenter;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nattribute float clusterIDs;\nuniform vec2 lightmapSize;\n\n/* VS Outputs */\n// varying vec2 v_lightmapCoord;\nvarying vec3 v_worldDir;\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n\n    vec4 geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position     = modelViewProjectionMatrix * pos;\n\n    vec4 worldPos = modelMatrix * pos;\n    v_worldDir = worldPos.xyz - ProjectionCenter;\n\n    v_lightmapCoord = (lightmapCoords + geomItemData.zw) / lightmapSize;\n}\n')}}J.registerClass("ShadowCatcherShader",class extends Qi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("ShadowCatcherShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\n#endif\n\n/* VS Outputs */\nvarying vec2 v_lightmapCoord;\nvarying vec3 v_worldDir;\n\nuniform sampler2D lightmap;\nuniform float ShadowMultiplier;\n\nuniform color envMap;\nuniform sampler2D envMapTex;\nuniform int envMapTexType;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nfloat luminanceFromRGB(vec3 rgb) {\n    return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n    vec4 env = envMap;\n    if(envMapTexType != 0) {\n        vec2 texCoord = dirToSphOctUv(normalize(v_worldDir));\n        env = texture2D(envMapTex, texCoord);\n    }\n\n    vec3 irradiance = texture2D(lightmap, v_lightmapCoord).rgb * ShadowMultiplier;\n    float irradianceLum = clamp(luminanceFromRGB(irradiance), 0.0, 1.0);\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(env.rgb/env.a, 1.0);\n    fragColor.rgb = mix(fragColor.rgb * irradiance, fragColor.rgb, irradianceLum);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"ProjectionCenter",defaultValue:new Z(0,0,1.7)}),t.push({name:"ShadowMultiplier",defaultValue:1}),t}static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}),J.registerClass("FloatingShadowCatcherShader",class extends Qi{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("FloatingShadowCatcherShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_lightmapCoord;\nvarying vec3 v_worldDir;\n\nuniform sampler2D lightmap;\n\nuniform float ShadowMultiplier;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    \n    float shadow = luminanceFromRGB(texture2D(lightmap, v_lightmapCoord).rgb) * ShadowMultiplier;\n\n    // This material works by multiplying the image buffer values by the luminance in the lightmap.\n    fragColor.rgb = vec3(pow(shadow, 1.0/ShadowMultiplier));\n    fragColor.a = 1.0;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n')}bind(t,e){return"MULTIPLY"==t.pass&&super.bind(t,e)}static isTransparent(){return!0}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"ShadowMultiplier",defaultValue:1}),t}});class Ai extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("LinesShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position = modelViewProjectionMatrix * vec4(positions, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("LinesShader.fragmentShader","\nprecision highp float;\n\nuniform color BaseColor;\nuniform float Opacity;\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = BaseColor;\n    fragColor.a *= Opacity;\n    \n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n"),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"Opacity",defaultValue:1}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}J.registerClass("LinesShader",Ai);class ji extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("NormalsShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec3 positions;\ninstancedattribute vec3 normals;\nattribute vec2 vertexIDs;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\nuniform float normalLength;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n\n/* VS Outputs */\nvarying float v_weight;\n\nvoid main(void) {\n  mat4 modelMatrix = getModelMatrix(transformIndex);\n  mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n  if(vertexIDs.x == 0.0){\n    gl_Position = modelViewProjectionMatrix * vec4(positions, 1.0);\n    v_weight = 1.0;\n  }\n  else{\n    gl_Position = modelViewProjectionMatrix * vec4(positions+(normals*normalLength), 1.0);\n    v_weight = 0.0;\n  }\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("NormalsShader.fragmentShader","\nprecision highp float;\n\nuniform color normalColor;\n\n/* VS Outputs */\nvarying float v_weight;\n\n\nvoid main(void) {\n  gl_FragColor = normalColor;\n  gl_FragColor.a = v_weight;\n}\n")}}class qi extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("PointsShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n  gl_Position = modelViewProjectionMatrix * vec4(positions, 1.);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("PointsShader.fragmentShader","\nprecision highp float;\n\nuniform color BaseColor;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  fragColor = BaseColor;\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n")}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t}}J.registerClass("PointsShader",qi);class $i extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("FatPointsShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform float PointSize;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  vec2 quadPointPos = getQuadVertexPositionFromID();\n  v_texCoord = quadPointPos + 0.5;\n\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  \n  vec4 viewPos = modelViewMatrix * vec4(positions, 1.);\n\n  viewPos += vec4(vec3(quadPointPos, 0.0) * PointSize, 0.);\n\n  // Generate a quad which is 0.5 * PointSize closer towards\n  // us. This allows points to be visualized even if snug on \n  // a surface. (else they get fully clipped)\n  viewPos.z += 0.5 * PointSize;\n\n  v_drawItemId = float(getDrawItemId());\n  v_viewPos = -viewPos.xyz;\n  \n  gl_Position = projectionMatrix * viewPos;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("FatPointsShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n\nuniform color BaseColor;\nuniform float Rounded;\nuniform float BorderWidth;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  float dist = length(v_texCoord - 0.5);\n  if(dist > 0.5)\n    discard;\n  if(dist > 0.5 - (BorderWidth * 0.5))\n    fragColor = vec4(0.,0.,0.,1.);\n  else {\n    // Modulate the lighting using the texture coord so the point looks round.\n    float NdotV = cos(dist * PI);\n\n    fragColor = BaseColor * mix(1.0, NdotV, Rounded);\n  }\n  \n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}bind(t){return!!super.bind(t)&&(t.supportsInstancing=!1,!0)}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"PointSize",defaultValue:.05}),t.push({name:"Rounded",defaultValue:1}),t.push({name:"BorderWidth",defaultValue:.2}),t}static getGeomDataShaderName(){return"FatPointsGeomDataShader"}static getSelectedShaderName(){return"FatPointsSelectedShader"}}class es extends $i{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("FatPointsGeomDataShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLBits.glsl"/>\n\nuniform int floatGeomBuffer;\nuniform int passId;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  float dist = length(v_texCoord - 0.5);\n  if(dist > 0.5)\n    discard;\n    \n\n  float viewDist = length(v_viewPos);\n\n  if(floatGeomBuffer != 0) {\n    fragColor.r = float(passId); \n    fragColor.g = float(v_drawItemId);\n    fragColor.b = 0.0;// TODO: store poly-id or something.\n    fragColor.a = viewDist;\n  }\n  else {\n    ///////////////////////////////////\n    // UInt8 buffer\n    fragColor.r = (mod(v_drawItemId, 256.) + 0.5) / 255.;\n    fragColor.g = (floor(v_drawItemId / 256.) + 0.5) / 255.;\n\n    // encode the dist as a 16 bit float\n    vec2 float16bits = encode16BitFloatInto2xUInt8(viewDist);\n    fragColor.b = float16bits.x;\n    fragColor.a = float16bits.y;\n  }\n\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}}class ts extends $i{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("FatPointsSelectedShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLBits.glsl"/>\n\nuniform int floatGeomBuffer;\nuniform int passId;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\n\n<%include file="drawItemTexture.glsl"/>\n\n#ifdef ENABLE_FLOAT_TEXTURES\nvec4 getHighlightColor(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 4);\n}\n#else\n\nuniform vec4 highlightColor;\n\nvec4 getHighlightColor() {\n    return highlightColor;\n}\n\n#endif\n\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  float dist = length(v_texCoord - 0.5);\n  if(dist > 0.5)\n    discard;\n  \n  int drawItemId = int(v_drawItemId + 0.5);\n  fragColor = getHighlightColor(drawItemId);\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}}J.registerClass("FatPointsShader",$i),J.registerClass("FatPointsGeomDataShader",es),J.registerClass("FatPointsSelectedShader",ts),Ba.setShaderModule("pragmatic-pbr/exposure.glsl","\n\n/*\n* Get an exposure using the Saturation-based Speed method.\n*/\nfloat getSaturationBasedExposure(float aperture,\n                                 float shutterSpeed,\n                                 float iso)\n{\n    float l_max = (7800.0 / 65.0) * sqrt(aperture) / (iso * shutterSpeed);\n    return 1.0 / l_max;\n}\n\n//White balance middle grey we are targetting for a good scene exposure\n//https://en.wikipedia.org/wiki/Middle_gray\nconst float MIDDLE_GREY = 0.18;\n\n/*\n* Get an exposure using the Standard Output Sensitivity method.\n* Accepts an additional parameter of the target middle grey.\n*/\nfloat getStandardOutputBasedExposure(float aperture,\n                                     float shutterSpeed,\n                                     float iso)\n{\n    //https://placeholderart.wordpress.com/2014/11/21/implementing-a-physically-based-camera-manual-exposure/\n    //https://en.wikipedia.org/wiki/Film_speed#Standard_output_sensitivity_.28SOS.29\n    //photometric exposure magic\n    //represents the properties of lens\n    float q = 0.65;\n\n    //float l_avg = (1000.0f / 65.0f) * sqrt(aperture) / (iso * shutterSpeed);\n    float l_avg = (1.0 / q) * sqrt(aperture) / (iso * shutterSpeed);\n    //float l_avg = sqrt(aperture) / (iso * shutterSpeed);\n    return MIDDLE_GREY / l_avg;\n}\n\n"),Ba.setShaderModule("pragmatic-pbr/tonemap-filmic.glsl","\n\n//Based on Filmic Tonemapping Operators http://filmicgames.com/archives/75\nvec3 tonemapFilmic(vec3 color) {\n    vec3 x = max(vec3(0.0), color - 0.004);\n    return (x * (6.2 * x + 0.5)) / (x * (6.2 * x + 1.7) + 0.06);\n}\n\n"),Ba.setShaderModule("mattdesl/fxaa-texcoords.glsl","\n//To save 9 dependent texture reads, you can compute\n//these in the vertex shader and use the optimized\n//frag.glsl function in your frag shader. \n\n//This is best suited for mobile devices, like iOS.\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\n"),Ba.setShaderModule("mattdesl/fxaa.glsl",'\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n--\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\nCopyright (c) 2011 by Armin Ronacher.\nSome rights reserved.\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE, \n            vec2 v_rgbSW, vec2 v_rgbSE, \n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n'),Ba.setShaderModule("mattdesl/fxaa-apply.glsl",'\n\n<%include file="mattdesl/fxaa.glsl"/>\n\nvec4 apply(sampler2D tex, vec2 fragCoord, vec2 resolution) {\n    mediump vec2 v_rgbNW;\n    mediump vec2 v_rgbNE;\n    mediump vec2 v_rgbSW;\n    mediump vec2 v_rgbSE;\n    mediump vec2 v_rgbM;\n\n    //compute the texture coords\n    texcoords(fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n    \n    //compute FXAA\n    return fxaa(tex, fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n\n');class as extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("PostProcessing.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n<%include file="mattdesl/fxaa-texcoords.glsl"/>\n\nuniform vec2 textureSize;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(position*2.0, 0.0, 1.0);\n\n    vec2 fragCoord = v_texCoord * textureSize;\n    texcoords(fragCoord, textureSize, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("PostProcessing.fragmentShader",'\nprecision highp float;\n\n<%include file="pragmatic-pbr/exposure.glsl"/>\n<%include file="pragmatic-pbr/tonemap-filmic.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n\n<%include file="mattdesl/fxaa.glsl"/>\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D texture;\nuniform vec2 textureSize;\n\nuniform bool antialiase;\nuniform bool tonemap;\nuniform float exposure;\nuniform float gamma;\n\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n    //can also use gl_FragCoord.xy\n    mediump vec2 fragCoord = v_texCoord * textureSize; \n\n    if (antialiase) {\n        fragColor = fxaa(texture, fragCoord, textureSize, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n    } else {\n        fragColor = texture2D(texture, v_texCoord);\n    }\n    \n    //fragColor.rgb *= getStandardOutputBasedExposure(aperture, shutterSpeed, iso);\n    fragColor.rgb *= exposure;\n    \n    if (tonemap) \n        fragColor.rgb = tonemapFilmic(fragColor.rgb);\n    else\n        fragColor.rgb = toGamma(fragColor.rgb, gamma);\n\n    \n    //fragColor.rgb = toGamma(fragColor.rgb, gamma);\n    \n    fragColor.a = 1.0;\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}'),this.finalize()}}class is extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("SimpleSurfaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec3 normals;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\nvarying vec3 v_worldPos;\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    v_drawItemId = float(drawItemId);\n    v_geomItemData  = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n\n#ifdef ENABLE_TEXTURES\n    v_textureCoord  = texCoords;\n    // v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n#endif\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("SimpleSurfaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="drawItemTexture.glsl"/>\n<%include file="cutaways.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\nvarying vec3 v_worldPos;\n\nuniform mat4 cameraMatrix;\n\nuniform color BaseColor;\nuniform float Opacity;\n\n#ifdef ENABLE_TEXTURES\n\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\nuniform sampler2D OpacityTex;\nuniform int OpacityTexType;\n\nuniform color cutColor;\nvec4 getCutaway(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 5);\n}\n\n#endif\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\n\nvoid main(void) {\n    int drawItemId = int(v_drawItemId + 0.5);\n\n    int flags = int(v_geomItemData.r + 0.5);\n    // Cutaways\n    if(testFlag(flags, GEOMITEM_FLAG_CUTAWAY)) \n    {\n        vec4 cutAwayData   = getCutaway(drawItemId);\n        vec3 planeNormal = cutAwayData.xyz;\n        float planeDist = cutAwayData.w;\n        if(cutaway(v_worldPos, planeNormal, planeDist)){\n            discard;\n            return;\n        }\n        else if(!gl_FrontFacing){\n            fragColor = cutColor;\n#ifndef ENABLE_ES3\n            gl_FragColor = fragColor;\n#endif\n            return;\n        }\n    }\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor      = BaseColor;\n    float opacity       = baseColor.a * Opacity;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n    float opacity       = baseColor.a * getLuminanceParamValue(Opacity, OpacityTex, OpacityTexType, v_textureCoord);\n#endif\n\n    // Hacky simple irradiance. \n    vec3 viewVector = normalize(mat3(cameraMatrix) * normalize(v_viewPos));\n    vec3 normal = normalize(mat3(cameraMatrix) * v_viewNormal);\n    float ndotv = dot(normal, viewVector);\n    if(ndotv < 0.0){\n        normal = -normal;\n        ndotv = dot(normal, viewVector);\n\n        // Note: these 2 lines can be used to debug inverted meshes.\n        //baseColor = vec4(1.0, 0.0, 0.0, 1.0);\n        //ndotv = 1.0;\n    }\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = vec4(ndotv * baseColor.rgb, opacity);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"Opacity",defaultValue:1,range:[0,1]}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J.registerClass("SimpleSurfaceShader",is),Ba.setShaderModule("cutaways.glsl","\n\n\nconst int GEOMITEM_FLAG_CUTAWAY =  1; // 1<<0;\n\n#define RAY_EPS 0.0000001\nstruct Ray {\n    vec3 start;\n    vec3 dir;\n};\n\nfloat intersectRayPlane(Ray ray, Ray plane) {\n    vec3 w = ray.start - plane.start;\n    float D = dot(plane.dir, ray.dir);\n    float N = dot(-plane.dir, w);\n\n    if (abs(D) < RAY_EPS) {\n        // segment is parallel to plane\n        if (N == 0.0)\n            return -1.0; // segment lies in plane\n        else\n            return -1.0; // no intersection\n    }\n    // they are not parallel\n    // compute intersect param\n    float sI = N / D;\n    if (sI < -RAY_EPS) {\n        return -1.0; // no intersection\n    }\n    return sI;\n}\n\n\nbool cutaway(vec3 worldPos, vec3 planeNormal, float planeDist) {\n\n    vec3 planePos = planeNormal * planeDist;\n    vec3 planeDir = worldPos + planePos;\n    float planeOffset = dot(planeDir, planeNormal);\n    if(planeOffset > 0.0){\n        return true;\n    }\n    return  false;\n}\n");class ss extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("StandardSurfaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec3 normals;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\nattribute vec2 lightmapCoords;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n// attribute float clusterIDs;\n// uniform vec2 lightmapSize;\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    v_drawItemId = float(drawItemId);\n    v_geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n\n#ifdef ENABLE_TEXTURES\n    v_textureCoord  = texCoords;\n#endif\n\n    // v_lightmapCoord = (lightmapCoords + v_geomItemData.zw) / lightmapSize;\n\n    // mat4 mvp = projectionMatrix * viewMatrix * modelMatrix;\n    // gl_Position = mvp * vec4((lightmapCoords + v_geomItemData.zw), 0., 1.);\n#ifdef ENABLE_DEBUGGING_LIGHTMAPS\n    v_clusterID = clusterIDs;\n#endif\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("StandardSurfaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="cutaways.glsl"/>\n\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\n<%include file="GGX_Specular.glsl"/>\n<%include file="PBRSurfaceRadiance.glsl"/>\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\n// uniform sampler2D lightmap;\n// uniform bool lightmapConnected;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// <%include file="debugColors.glsl"/>\n// uniform vec2 lightmapSize;\n// uniform bool debugLightmapTexelSize;\n// #endif\n\nuniform color cutColor;\nvec4 getCutaway(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 5);\n}\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nuniform mat4 cameraMatrix;\n\nuniform color BaseColor;\nuniform float EmissiveStrength;\n\n\n#ifdef ENABLE_SPECULAR\nuniform float Roughness;\nuniform float Metallic;\nuniform float Reflectance;\n#endif\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n\n#ifdef ENABLE_SPECULAR\nuniform sampler2D RoughnessTex;\nuniform int RoughnessTexType;\n\nuniform sampler2D MetallicTex;\nuniform int MetallicTexType;\n\nuniform sampler2D ReflectanceTex;\nuniform int ReflectanceTexType;\n\nuniform sampler2D NormalTex;\nuniform int NormalTexType;\n// uniform float NormalScale;\n#endif\n\nuniform sampler2D EmissiveStrengthTex;\nuniform int EmissiveStrengthTexType;\n\n\n#endif\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n\n#endif\n\nvoid main(void) {\n    int drawItemId = int(v_drawItemId + 0.5);\n\n    int flags = int(v_geomItemData.r + 0.5);\n    // Cutaways\n    if(testFlag(flags, GEOMITEM_FLAG_CUTAWAY)) {\n        vec4 cutAwayData   = getCutaway(drawItemId);\n        vec3 planeNormal = cutAwayData.xyz;\n        float planeDist = cutAwayData.w;\n        if(cutaway(v_worldPos, planeNormal, planeDist)){\n            discard;\n            return;\n        }\n        else if(!gl_FrontFacing){\n            fragColor = cutColor;\n#ifndef ENABLE_ES3\n            gl_FragColor = fragColor;\n#endif\n            return;\n        }\n    }\n\n\n    MaterialParams material;\n\n#ifndef ENABLE_TEXTURES\n    material.BaseColor     = BaseColor.rgb;\n    float emission         = EmissiveStrength;\n\n#ifdef ENABLE_SPECULAR\n    material.roughness     = Roughness;\n    material.metallic      = Metallic;\n    material.reflectance   = Reflectance;\n#endif\n\n#else\n    // Planar YZ projection for texturing, repeating every meter.\n    // vec2 texCoord       = v_worldPos.xz * 0.2;\n    vec2 texCoord          = vec2(v_textureCoord.x, 1.0 - v_textureCoord.y);\n    material.baseColor     = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, texCoord).rgb;\n\n#ifdef ENABLE_SPECULAR\n    material.roughness     = getLuminanceParamValue(Roughness, RoughnessTex, RoughnessTexType, texCoord);\n    material.metallic      = getLuminanceParamValue(Metallic, MetallicTex, MetallicTexType, texCoord);\n    material.reflectance   = getLuminanceParamValue(Reflectance, ReflectanceTex, ReflectanceTexType, texCoord);\n#endif\n    float emission         = getLuminanceParamValue(EmissiveStrength, EmissiveStrengthTex, EmissiveStrengthTexType, texCoord);\n#endif\n\n    vec3 viewNormal = normalize(v_viewNormal);\n    //vec3 surfacePos = -v_viewPos;\n\n#ifdef ENABLE_TEXTURES\n#ifdef ENABLE_SPECULAR\n    if(NormalTexType != 0){\n        vec3 textureNormal_tangentspace = normalize(texture2D(NormalTex, texCoord).rgb * 2.0 - 1.0);\n        viewNormal = normalize(mix(viewNormal, textureNormal_tangentspace, 0.3));\n    }\n#endif\n#endif\n\n    vec3 viewVector = normalize(mat3(cameraMatrix) * normalize(v_viewPos));\n    vec3 normal = normalize(mat3(cameraMatrix) * viewNormal);\n    if(dot(normal, viewVector) < 0.0){\n        normal = -normal;\n        // Note: this line can be used to debug inverted meshes.\n        //material.baseColor = vec3(1.0, 0.0, 0.0);\n    }\n\n    vec3 irradiance;\n    // if(lightmapConnected){\n    //     irradiance = texture2D(lightmap, v_lightmapCoord).rgb;\n    // }\n    // else{\n#ifndef ENABLE_SPECULAR\n        irradiance = sampleEnvMap(normal, 1.0);\n#else\n        irradiance = vec3(dot(normal, viewVector));\n#endif\n        \n    // }\n\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n//     if(debugLightmapTexelSize)\n//     {\n//         vec2 coord_texelSpace = (v_lightmapCoord * lightmapSize) - v_geomItemData.zw;\n//         //vec2 coord_texelSpace = (v_textureCoord * lightmapSize);\n//         float total = floor(coord_texelSpace.x) +\n//                       floor(coord_texelSpace.y);\n                      \n//         vec3 clustercolor = getDebugColor(v_clusterID);\n\n//         material.metallic = 0.0;\n//         material.reflectance = 0.0;\n//         if(mod(total,2.0)==0.0){\n//             material.baseColor = clustercolor;\n//             irradiance = vec3(1.0);\n//         }\n//         else{\n//             material.baseColor = material.baseColor * 1.5;\n//         }\n//     }\n// #endif\n\n#ifndef ENABLE_SPECULAR\n    vec3 radiance = material.baseColor * irradiance;\n#else\n    vec3 radiance = pbrSurfaceRadiance(material, irradiance, normal, viewVector);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    // fragColor = vec4(material.baseColor, 1.0);\n    // fragColor = vec4(material.baseColor * irradiance, 1.0);\n    fragColor = vec4(radiance + (emission * material.baseColor), 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"Metallic",defaultValue:0,range:[0,1]}),t.push({name:"Roughness",defaultValue:.85,range:[0,1]}),t.push({name:"Reflectance",defaultValue:.1,range:[0,1]}),t.push({name:"EmissiveStrength",defaultValue:0,range:[0,1]}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J.registerClass("StandardSurfaceShader",ss),Ba.setShaderModule("GLSLBits.glsl",'\n    \n/////////////////////////////////////////////////////////////////\n// http://concord-consortium.github.io/lab/experiments/webgl-gpgpu/script.js\nfloat shift_right(float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shift_left(float v, float amt) {\n  return floor(v * exp2(amt) + 0.5);\n}\n\nfloat mask_last(float v, float bits) {\n  return mod(v, shift_left(1.0, bits));\n}\nfloat extract_bits(float num, float from, float to) {\n  from = floor(from + 0.5);\n  to = floor(to + 0.5);\n  return mask_last(shift_right(num, from), to - from);\n}\n\n/////////////////////////////////////////////////////////////////\n// https://stackoverflow.com/questions/18453302/how-do-you-pack-one-32bit-int-into-4-8bit-ints-in-glsl-webgl\n\nconst vec4 bitEnc = vec4(1.,255.,65025.,16581375.);\nconst vec4 bitDec = 1./bitEnc;\nvec4 EncodeFloatRGBA (float v) {\n    vec4 enc = bitEnc * v;\n    enc = fract(enc);\n    enc -= enc.yzww * vec2(1./255., 0.).xxxy;\n    return enc;\n}\nfloat DecodeFloatRGBA (vec4 v) {\n    return dot(v, bitDec);\n}\n\n\n\n/////////////////////////////////////////////////////////////////\n// https://gist.github.com/Flexi23/1713774\n// \nvec2 encode16BitFloatInto2xUInt8(float v){\n    vec2 c = vec2(0.);\n\n    int signum = (v >= 0.) ? 128 : 0;\n    v = abs(v);\n    int exponent = 15;\n    float limit = 1024.; // considering the bias from 2^-5 to 2^10 (==1024)\n    for(int exp = 15; exp > 0; exp--){\n        if( v < limit){\n            limit /= 2.;\n            exponent--;\n        }\n    }\n\n    float rest;\n    if(exponent == 0){\n        rest = v / limit / 2.;      // "subnormalize" implicite preceding 0. \n    }else{\n        rest = (v - limit)/limit;   // normalize accordingly to implicite preceding 1.\n    }\n\n    int mantissa = int(rest * 2048.);   // 2048 = 2^11 for the (split) 11 bit mantissa\n    int msb = mantissa / 256;           // the most significant 3 bits go into the lower part of the first byte\n    int lsb = mantissa - msb * 256;     // there go the other 8 bit of the lower significance\n\n    c.x = float(signum + exponent * 8 + msb) / 255.;    // color normalization for texture2D\n    c.y = float(lsb) / 255.;\n\n    if(v >= 2048.){\n        c.y = 1.;\n    }\n\n    return c;\n}\n\nfloat decode16BitFloatFrom2xUInt8(vec2 c){\n    float v = 0.;\n\n    int ix = int(c.x*255.); // 1st byte: 1 bit signum, 4 bits exponent, 3 bits mantissa (MSB)\n    int iy = int(c.y*255.); // 2nd byte: 8 bit mantissa (LSB)\n\n    int s = (c.x >= 0.5) ? 1 : -1;\n    ix = (s > 0) ? ix - 128 : ix;   // remove the signum bit from exponent\n    int iexp = ix / 8;              // cut off the last 3 bits of the mantissa to select the 4 exponent bits\n    int msb = ix - iexp * 8;        // subtract the exponent bits to select the 3 most significant bits of the mantissa\n\n    int norm = (iexp == 0) ? 0 : 2048;          // distinguish between normalized and subnormalized numbers\n    int mantissa = norm + msb * 256 + iy;       // implicite preceding 1 or 0 added here\n    norm = (iexp == 0) ? 1 : 0;                 // normalization toggle\n    float exponent = pow( 2., float(iexp + norm) - 16.); // -5 for the the exponent bias from 2^-5 to 2^10 plus another -11 for the normalized 12 bit mantissa \n    v = float( s * mantissa ) * exponent;\n\n    return v;\n}\n\n\n// TODO : Encoding Float32 to 4x UInt8\n// http://concord-consortium.github.io/lab/experiments/webgl-gpgpu/script.js\n// http://ultraist.hatenablog.com/entry/20110608/1307539319\n\n');class ns extends Oa{constructor(t,e){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("StandardSurfaceGeomDataShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying float v_drawItemID;\nvarying vec3 v_worldPos;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  v_drawItemId = float(drawItemId);\n  v_geomItemData = getInstanceData(drawItemId);\n\n  vec4 pos = vec4(positions, 1.);\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  vec4 viewPos = modelViewMatrix * pos;\n  gl_Position = projectionMatrix * viewPos;\n\n  v_viewPos = -viewPos.xyz;\n\n  v_drawItemID = float(getDrawItemId());\n  \n  v_worldPos      = (modelMatrix * pos).xyz;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("StandardSurfaceGeomDataShader.fragmentShader",'\nprecision highp float;\n\n<%include file="drawItemTexture.glsl"/>\n<%include file="cutaways.glsl"/>\n<%include file="GLSLBits.glsl"/>\n\nuniform int floatGeomBuffer;\nuniform int passId;\n\nuniform color cutColor;\nvec4 getCutaway(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 5);\n}\n\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying float v_drawItemID;\nvarying vec3 v_worldPos;\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n  int drawItemId = int(v_drawItemId + 0.5);\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n  int flags = int(v_geomItemData.r + 0.5);\n  // Cutaways\n  if(testFlag(flags, GEOMITEM_FLAG_CUTAWAY)) {\n      vec4 cutAwayData   = getCutaway(drawItemId);\n      vec3 planeNormal = cutAwayData.xyz;\n      float planeDist = cutAwayData.w;\n      if(cutaway(v_worldPos, planeNormal, planeDist)){\n          discard;\n          return;\n      }\n      else if(!gl_FrontFacing){\n          fragColor = cutColor;\n  #ifndef ENABLE_ES3\n          gl_FragColor = fragColor;\n  #endif\n          return;\n      }\n  }\n\n    float dist = length(v_viewPos);\n\n    if(floatGeomBuffer != 0) {\n        fragColor.r = float(passId); \n        fragColor.g = float(v_drawItemID);\n        fragColor.b = 0.0;// TODO: store poly-id or something.\n        fragColor.a = dist;\n    }\n    else {\n        ///////////////////////////////////\n        // UInt8 buffer\n        fragColor.r = (mod(v_drawItemID, 256.) + 0.5) / 255.;\n        fragColor.g = (floor(v_drawItemID / 256.) + 0.5) / 255.;\n\n\n        // encode the dist as a 16 bit float\n        vec2 float16bits = encode16BitFloatInto2xUInt8(dist);\n        fragColor.b = float16bits.x;\n        fragColor.a = float16bits.y;\n    }\n\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n')}}J.registerClass("StandardSurfaceGeomDataShader",ns);class ls extends Oa{constructor(t,e){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("StandardSurfaceSelectedGeomsShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nvarying float v_drawItemId;\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    v_drawItemId = float(drawItemId);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos = modelViewMatrix * vec4(positions, 1.0);\n    gl_Position = projectionMatrix * viewPos;\n\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("StandardSurfaceSelectedGeomsShader.fragmentShader",'\nprecision highp float;\n\nvarying float v_drawItemId;\n\n\n<%include file="drawItemTexture.glsl"/>\n\n#ifdef ENABLE_FLOAT_TEXTURES\nvec4 getHighlightColor(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 4);\n}\n#else\n\nuniform vec4 highlightColor;\n\nvec4 getHighlightColor() {\n    return highlightColor;\n}\n\n#endif\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    int drawItemId = int(v_drawItemId + 0.5);\n    fragColor = getHighlightColor(drawItemId);\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n')}}J.registerClass("StandardSurfaceSelectedGeomsShader",ls);class rs extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("HandleShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform int maintainScreenSize;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n\n  if(maintainScreenSize != 0) {\n    float dist = modelViewMatrix[3][2];\n    float sc = dist;\n    mat4 scmat = mat4(\n      sc, 0.0, 0.0, 0.0,\n      0.0, sc, 0.0, 0.0,\n      0.0, 0.0, sc, 0.0,\n      0.0, 0.0, 0.0, 1.0\n    );\n    modelViewMatrix = modelViewMatrix * scmat;\n  }\n\n  vec4 viewPos = modelViewMatrix * vec4(positions, 1.0);\n  gl_Position = projectionMatrix * viewPos;\n\n  v_viewPos = viewPos.xyz;\n  v_textureCoord = texCoords;\n  v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("HandleShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color BaseColor;\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n#endif\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor = BaseColor;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = baseColor;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"maintainScreenSize",defaultValue:0}),t}static isOverlay(){return!0}static getGeomDataShaderName(){return"HandleGeomDataShader"}}J.registerClass("HandleShader",rs);class ds extends ns{constructor(t,e){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("HandleGeomDataShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform int maintainScreenSize;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying float v_drawItemID;\nvarying vec3 v_worldPos;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  \n  if(maintainScreenSize != 0) {\n    float dist = modelViewMatrix[3][2];\n    float sc = dist;\n    mat4 scmat = mat4(\n      sc, 0.0, 0.0, 0.0,\n      0.0, sc, 0.0, 0.0,\n      0.0, 0.0, sc, 0.0,\n      0.0, 0.0, 0.0, 1.0\n    );\n    modelViewMatrix = modelViewMatrix * scmat;\n  }\n\n  vec4 viewPos = modelViewMatrix * vec4(positions, 1.0);\n  gl_Position = projectionMatrix * viewPos;\n\n  v_viewPos = -viewPos.xyz;\n\n  v_drawItemID = float(getDrawItemId());\n}\n')}}J.registerClass("HandleGeomDataShader",ds);class os extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("TransparentSurfaceShader.vertexShader",'\nprecision highp float;\n\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n\n    vec4 geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n    // mat4 mvp = projectionMatrix * viewMatrix * modelMatrix;\n    // gl_Position = mvp * vec4((lightmapCoords + geomItemData.xy), 0., 1.);\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("TransparentSurfaceShader.fragmentShader",'\nprecision highp float;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\n#endif\n<%include file="GLSLUtils.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nuniform mat4 cameraMatrix;\nuniform float planeDist;\nuniform float planeAngle;\n\nuniform color BaseColor;\nuniform float Opacity;\n\n#ifdef ENABLE_SPECULAR\n<%include file="math/constants.glsl"/>\n<%include file="GGX_Specular.glsl"/>\n<%include file="PBRSurfaceRadiance.glsl"/>\nuniform float Roughness;\nuniform float Metallic;\nuniform float Reflectance;\n#endif\n\n#ifdef __ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform bool BaseColorTexType;\n\nuniform sampler2D OpacityTex;\nuniform bool OpacityTexType;\n\nuniform sampler2D RoughnessTex;\nuniform bool RoughnessTexType;\n\nuniform sampler2D ReflectanceTex;\nuniform bool ReflectanceTexType;\n\nuniform sampler2D NormalTex;\nuniform bool NormalTexType;\nuniform float NormalScale;\n\n\n#endif\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n    MaterialParams material;\n\n#ifndef __ENABLE_TEXTURES\n    material.baseColor      = BaseColor.rgb;\n    float opacity           = Opacity;\n\n#ifdef ENABLE_SPECULAR\n    material.roughness      = Roughness;\n    material.metallic       = Metallic;\n    material.reflectance    = Reflectance;\n#endif\n\n#else\n    // Planar YZ projection for texturing, repeating every meter.\n    // vec2 texCoord        = v_worldPos.xz * 0.2;\n    vec2 texCoord           = vec2(v_textureCoord.x, 1.0 - v_textureCoord.y);\n    material.baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, texCoord).rgb;\n    material.roughness      = getLuminanceParamValue(Roughness, RoughnessTex, RoughnessTexType, texCoord);\n    material.metallic       = getLuminanceParamValue(Metallic, MetallicTex, MetallicTexType, texCoord);\n    material.reflectance    = Reflectance;//getLuminanceParamValue(Reflectance, ReflectanceTex, ReflectanceTexType, texCoord);\n\n    float opacity           = getLuminanceParamValue(Opacity, OpacityTex, OpacityTexType, texCoords);\n#endif\n\n#ifndef ENABLE_SPECULAR\n    gl_FragColor = vec4(material.baseColor.rgb, opacity);\n#else\n\n    vec3 viewNormal = normalize(v_viewNormal);\n    //vec3 surfacePos = -v_viewPos;\n\n#ifdef __ENABLE_TEXTURES\n    if(NormalTexType != 0){\n        vec3 textureNormal_tangentspace = normalize(texture2D(NormalTex, texCoord).rgb * 2.0 - 1.0);\n        viewNormal = normalize(mix(viewNormal, textureNormal_tangentspace, 0.3));\n    }\n#endif\n\n    vec3 viewVector = normalize(mat3(cameraMatrix) * normalize(v_viewPos));\n    vec3 normal = normalize(mat3(cameraMatrix) * viewNormal);\n    if(dot(normal, viewVector) < 0.0){\n        normal = -normal;\n        // Note: this line can be used to debug inverted meshes.\n        //material.baseColor = vec3(1.0, 0.0, 0.0);\n    }\n\n    vec4 specularReflectance = pbrSpecularReflectance(material, normal, viewVector);\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(specularReflectance.rgb, mix(opacity, 1.0, specularReflectance.a));\n\n#endif\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t.push({name:"Opacity",defaultValue:1,range:[0,1]}),t.push({name:"Roughness",defaultValue:.85}),t.push({name:"Reflectance",defaultValue:1e-4}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}J.registerClass("TransparentSurfaceShader",os);class hs extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("ScreenSpaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n\n    gl_Position = (modelMatrix * vec4(positions, 1.0));\n\n    v_textureCoord = texCoords;\n    v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("ScreenSpaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color BaseColor;\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n#endif\n\n/* VS Outputs */\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor = BaseColor;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = baseColor;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static isOverlay(){return!0}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$2(1,1,.5)}),t}static getGeomDataShaderName(){return null}static getSelectedShaderName(){return null}}J.registerClass("ScreenSpaceShader",hs);class cs extends Bi{constructor(t){super(t),this.invisibleToGeomBuffer=!0}}J.registerClass("ToolIconShader",cs);class ms$2 extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("UnpackLDRAlphaImageShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(position*2.0, 0.0, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("UnpackLDRAlphaImageShader.fragmentShader","\nprecision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D ldrSampler;\nuniform sampler2D alphaSampler;\n\nfloat luminanceFromRGB(vec3 rgb) {\n    return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(texture2D(ldrSampler, v_texCoord).rgb, luminanceFromRGB(texture2D(alphaSampler, v_texCoord).rgb));\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n\n")}}class us extends Oa{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ba.parseShader("WireShader.vertexShader","\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n/* VS Outputs */\n\nvoid main(void) {\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position = modelViewProjectionMatrix * vec4(positions, 1.0);\n\n    // Apply the perspective transform, and then move the vertices\n    //  towards the camera by a tiny little bit...\n    gl_Position.z -= 0.001 / gl_Position.w;\n    //gl_Position.z *= 0.999;\n}\n"),this.__shaderStages.FRAGMENT_SHADER=Ba.parseShader("WireShader.fragmentShader","\nprecision highp float;\n\nuniform color wireColor;\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifdef ENABLE_ES3\n    gl_FragColor = color;\n#else\n    fragColor = color;\n#endif  \n}\n")}}const bs=0,ps=1,gs=2,_s=3;class Zs extends Y{constructor(t,e,i,n,s=null){super(),this.gl=t,this.geomItem=e,this.glGeom=i,this.id=n,this.flags=s,this.visible=this.geomItem.getVisible(),this.culled=!1,this.lightmapName=e.getLightmapName(),this.updateVisibility=this.updateVisibility.bind(this),this.updateVisibility=this.updateVisibility.bind(this),this.destroy=this.destroy.bind(this),this.updateXfo=t.floatTexturesSupported?()=>{this.emit("updated",{type:bs})}:()=>{this.updateGeomMatrix()},this.geomItem.addListener("geomXfoChanged",this.updateXfo),this.geomItem.addListener("visibilityChanged",this.updateVisibility),this.geomItem.addListener("cutAwayChanged",()=>{this.emit("updated",{type:bs})}),this.geomItem.addListener("destructing",this.destroy),this.highlightChangedId=this.geomItem.addListener("highlightChanged",()=>{this.emit("updated",{type:_s}),this.emit("highlightChanged")}),this.glGeom.addListener("updated",()=>{this.emit("updated",{type:ps})});const o=this.geomItem.getLightmapCoordsOffset();this.geomData=[o.x,o.y,0,0]}getGeomItem(){return this.geomItem}getGLGeom(){return this.glGeom}getVisible(){return this.geomItem.getVisible()}getId(){return this.id}getFlags(){return this.flags}updateVisibility(){const t=this.geomItem.getVisible()&&!this.culled;this.visible!=t&&(this.visible=t,this.emit("visibilityChanged",{visible:t}),this.emit("updated",{}))}setCullState(t){this.culled=t,this.updateVisibility()}updateGeomMatrix(){this.modelMatrixArray=this.geomItem.getGeomMat4().asArray()}getGeomMatrixArray(){return this.modelMatrixArray}bind(t){const e=this.gl,i=t.unifs;if(!e.floatTexturesSupported){const t=i.modelMatrix;t&&e.uniformMatrix4fv(t.location,!1,this.modelMatrixArray);const n=i.drawItemData;n&&e.uniform4f(n.location,this.geomData)}const n=i.transformIndex;if(n&&e.uniform1i(n.location,this.id),t.lightmaps&&i.lightmap&&t.boundLightmap!=this.lightmapName){const n=t.lightmaps[this.lightmapName];n&&n.glimage.isLoaded()?(n.glimage.bindToUniform(t,i.lightmap),e.uniform2fv(i.lightmapSize.location,n.atlasSize.asArray()),i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!0),t.boundLightmap=this.lightmapName):i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!1)}return!0}destroy(){this.geomItem.removeListener("visibilityChanged",this.updateVisibility),this.geomItem.removeListener("geomXfoChanged",this.updateXfo),this.geomItem.removeListenerById("highlightChanged",this.highlightChangedId)}}class Gs extends Ni{constructor(){super(),this.__drawItems=[void 0],this.__drawItemsIndexFreeList=[],this.__dirtyItemIndices=[]}init(t,e){super.init(t,e),this.__renderer.registerPass(t=>{if(t instanceof ha){if(t.getMetadata("glgeomItem"))return!1;{const e=e=>!!this.filterGeomItem(e)&&(null==t.getGeometry()?t.addListener("geomAssigned",()=>{this.addGeomItem(e)}):this.addGeomItem(e),!0);return null==t.getMaterial()?(console.warn("Scene item :"+t.getPath()+" has no material"),!1):e(t)}}return!1},t=>!!(t instanceof ha&&t.getMetadata("glgeomItem"))&&this.removeGeomItem(t))}filterGeomItem(t){return!0}addShader(t){return this.__renderer.getOrCreateShader(t.getShaderName())}constructShaders(t){let e,i;const n=this.__renderer.getOrCreateShader(t);return n.constructor.getGeomDataShaderName()&&(e=this.__renderer.getOrCreateShader(n.constructor.getGeomDataShaderName())),n.constructor.getSelectedShaderName()&&(i=this.__renderer.getOrCreateShader(n.constructor.getSelectedShaderName())),{glshader:n,glgeomdatashader:e,glselectedshader:i}}addMaterial(t){let e=t.getMetadata("glmaterial");if(e)return e;const i=this.__renderer.getOrCreateShader(t.getShaderName());return e=new ni(this.__gl,t,i),e.addListener("updated",()=>{this.__renderer.requestRedraw()}),t.setMetadata("glmaterial",e),e}addGeom(t){let e=t.getMetadata("glgeom");if(e)return e.addRef(this),e;const i=this.__gl;if(t instanceof Nt||t instanceof Ut)e=new Pa(i,t);else if(t instanceof Ct||t instanceof zt)e=new Ea(i,t);else{if(!(t instanceof Yt||t instanceof wt))throw new Error("Unsupported geom type:"+t.constructor.name);e=new Ha(i,t)}return t.setMetadata("glgeom",e),e.addRef(this),e}removeGeom(t){let e=t.getMetadata("glgeom");if(e)return e.removeRef(this),e}addGeomItem(t){const e=this.addGeom(t.getGeometry());let i;this.__drawItemsIndexFreeList.length>0?i=this.__drawItemsIndexFreeList.pop():(i=this.__drawItems.length,this.__drawItems.push(null)),this.__dirtyItemIndices.push(i);const n=new Zs(this.__gl,t,e,i,1);return t.setMetadata("glgeomItem",n),n.addListener("updated",t=>{switch(t.type){case bs:if(-1!=this.__dirtyItemIndices.indexOf(i))return;this.__dirtyItemIndices.push(i);break;case ps:case gs:break;case _s:if(-1!=this.__dirtyItemIndices.indexOf(i))return;return this.__dirtyItemIndices.push(i),void this.__renderer.requestRedraw()}this.__renderer.drawItemChanged()}),this.__drawItems[i]=n,this.__renderer.requestRedraw(),t.setMetadata("glpass",this),n}removeGeomItem(t){if(t.getMetadata("glpass")!=this)return;const e=t.getMetadata("glgeomItem"),i=e.getId();return this.__drawItems[i]=null,this.__drawItemsIndexFreeList.push(i),this.__renderer.requestRedraw(),t.getMetadata("glpass"),t.deleteMetadata("glgeomItem"),e}removeGLGeom(t,e){const i=e.geomItemMappings.indexOf(t);e.geomItemMappings.splice(i,1)}getGeomItem(t){if(!(t>=this.__drawItems.length))return this.__drawItems[t];console.warn("Invalid Draw Item id:"+t+" NumItems:"+(this.__drawItems.length-1))}__populateDrawItemDataArray(t,e,i){const n=24*e;let s=0;t.isCutawayEnabled()&&(s|=1);const o=t.getLightmapCoordsOffset();G.createFromFloat32Buffer(i.buffer,n+0).set(s,0,o.x,o.y);const r=t.getGeomMat4(),a=G.createFromFloat32Buffer(i.buffer,n+4),l=G.createFromFloat32Buffer(i.buffer,n+8),c=G.createFromFloat32Buffer(i.buffer,n+12);a.set(r.xAxis.x,r.yAxis.x,r.zAxis.x,r.translation.x),l.set(r.xAxis.y,r.yAxis.y,r.zAxis.y,r.translation.y),c.set(r.xAxis.z,r.yAxis.z,r.zAxis.z,r.translation.z);const h=G.createFromFloat32Buffer(i.buffer,n+16);if(t.isHighlighted()){const e=t.getHighlight();h.set(e.r,e.g,e.b,e.a)}const d=G.createFromFloat32Buffer(i.buffer,n+20);if(t.isCutawayEnabled()){const e=t.getCutVector(),i=t.getCutDist();d.set(e.x,e.y,e.z,i)}}newItemsReadyForLoading(){return this.__dirtyItemIndices.length>0}uploadGeomItems(){const t=this.__gl;if(!t.floatTexturesSupported){const t=this.__dirtyItemIndices.length;for(let e=0;e<t;e++){const t=this.__drawItems[this.__dirtyItemIndices[e]];t&&t.updateGeomMatrix()}return void(this.__dirtyItemIndices=[])}let e=Math.round(Math.sqrt(6*this.__drawItems.length)+.5);e=Math.nextPow2(e),e%6!=0&&(e+=6-e%6),this.__drawItemsTexture?this.__drawItemsTexture.width!=e&&(this.__drawItemsTexture.resize(e,e),this.__dirtyItemIndices=Array(e*e/6).fill().map((t,e)=>e)):(this.__drawItemsTexture=new Ka(t,{format:"RGBA",type:"FLOAT",width:e,height:e,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1}),this.__drawItemsTexture.clear()),t.bindTexture(t.TEXTURE_2D,this.__drawItemsTexture.glTex);const i=this.__drawItemsTexture.getTypeID();for(let n=0;n<this.__dirtyItemIndices.length;n++){const s=this.__dirtyItemIndices[n],o=Math.floor(6*s/e);let r=s+1;for(let t=n+1;t<this.__dirtyItemIndices.length;t++){const i=this.__dirtyItemIndices[t];if(Math.floor(6*i/e)!=o)break;if(i!=r)break;r++}const a=r-s,l=6*s%e,c=6*a,h=1,d=new Float32Array(24*a);for(let t=s;t<r;t++){const e=this.__drawItems[t];e&&this.__populateDrawItemDataArray(e.getGeomItem(),t-s,d)}if(i==t.FLOAT)this.__drawItemsTexture.populate(d,c,h,l,o,!1);else{const t=Math.convertFloat32ArrayToUInt16Array(d);this.__drawItemsTexture.populate(t,c,h,l,o,!1)}n+=a-1}this.__dirtyItemIndices=[]}finalize(){0!=this.__dirtyItemIndices.length&&this.uploadGeomItems()}bind(t){const e=this.__gl,i=t.unifs;return this.__drawItemsTexture&&i.instancesTexture&&(this.__drawItemsTexture.bindToUniform(t,i.instancesTexture),e.uniform1i(i.instancesTextureSize.location,this.__drawItemsTexture.width)),!0}bindShader(t,e){return!!e.bind(t)&&!!this.bind(t)}bindMaterial(t,e,i){return e.bind(t,i)}}class Xs extends Y{constructor(t,e){super(),this.gl=t,this.glgeom=e,this.glgeomItems=[],this.glgeomItems_freeIndices=[],this.glgeomItemSignalIds=[],this.drawIdsArray=null,this.drawIdsBuffer=null,this.drawIdsBufferDirty=!0,this.highlightedIdsArray=null,this.highlightedIdsBuffer=null,this.highlightedIdsBufferDirty=!0,this.lightmapName=void 0,this.visibleItems=[],this.highlightedItems=[]}getGLGeom(){return this.glgeom}getLightmapName(){return this.lightmapName}getDrawCount(){return this.visibleItems.length}addGeomItem(t){let e;this.glgeomItems_freeIndices.length>0?e=this.glgeomItems_freeIndices.pop():(e=this.glgeomItems.length,this.glgeomItems.push(null)),t.visible&&(this.visibleItems.push(e),this.emit("drawCountChanged",{count:1})),t.getGeomItem().isHighlighted()&&(this.highlightedItems.push(e),this.highlightedIdsBufferDirty=!0),1==this.glgeomItems.length&&(this.lightmapName=t.getGeomItem().getLightmapName());const i={};i.hil=t.on("highlightChanged",()=>{if(t.getGeomItem().isHighlighted()){if(-1!=this.highlightedItems.indexOf(e))return;this.highlightedItems.push(e)}else this.highlightedItems.splice(this.highlightedItems.indexOf(e),1);this.highlightedIdsBufferDirty=!0}),i.vis=t.on("visibilityChanged",t=>{t.visible?(this.visibleItems.push(e),this.emit("drawCountChanged",{count:1})):(this.visibleItems.splice(this.visibleItems.indexOf(e),1),this.emit("drawCountChanged",{count:-1})),this.drawIdsBufferDirty=!0}),this.glgeomItems[e]=t,this.glgeomItemSignalIds[e]=i,this.drawIdsBufferDirty=!0}removeGeomItem(t){const e=this.glgeomItems.indexOf(t),i=this.glgeomItemSignalIds[e];t.removeListenerById("highlightChanged",i.hil),t.removeListenerById("visibilityChanged",i.vis),this.glgeomItems[e]=null,this.glgeomItemSignalIds[e]=null,this.glgeomItems_freeIndices.push(e),t.visible&&(this.visibleItems.splice(this.visibleItems.indexOf(e),1),this.emit("drawCountChanged",{count:-1})),t.getGeomItem().isHighlighted()&&this.highlightedItems.splice(this.highlightedItems.indexOf(e),1),this.drawIdsBufferDirty=!0,0==this.glgeomItems.length&&this.destroy()}updateDrawIDsBuffer(){const t=this.gl;t.floatTexturesSupported?(this.drawIdsBuffer&&this.glgeomItems.length!=this.drawIdsArray.length&&(this.gl.deleteBuffer(this.drawIdsBuffer),this.drawIdsBuffer=null),this.drawIdsBuffer||(this.drawIdsArray=new Float32Array(this.glgeomItems.length),this.drawIdsBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.drawIdsBuffer)),this.visibleItems.forEach((t,e)=>{this.drawIdsArray[e]=this.glgeomItems[t].getId()}),t.bindBuffer(t.ARRAY_BUFFER,this.drawIdsBuffer),t.bufferData(t.ARRAY_BUFFER,this.drawIdsArray,t.STATIC_DRAW),this.drawIdsBufferDirty=!1):this.drawIdsBufferDirty=!1}updateHighlightedIDsBuffer(){const t=this.gl;t.floatTexturesSupported?(this.highlightedIdsBuffer&&this.glgeomItems.length!=this.highlightedIdsArray.length&&(this.gl.deleteBuffer(this.highlightedIdsBuffer),this.highlightedIdsBuffer=null),(!this.highlightedIdsArray||this.highlightedItems.length>this.highlightedIdsArray.length)&&(this.highlightedIdsArray=new Float32Array(this.highlightedItems.length),this.highlightedIdsBuffer&&(t.deleteBuffer(this.highlightedIdsBuffer),this.highlightedIdsBuffer=null)),this.highlightedItems.forEach((t,e)=>{this.highlightedIdsArray[e]=this.glgeomItems[t].getId()}),this.highlightedIdsBuffer||(this.highlightedIdsBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.highlightedIdsBuffer),t.bufferData(t.ARRAY_BUFFER,this.highlightedIdsArray,t.STATIC_DRAW),this.highlightedIdsBufferDirty=!1):this.highlightedIdsBufferDirty=!1}draw(t){if(0==this.visibleItems.length)return;this.drawIdsBufferDirty&&this.updateDrawIDsBuffer();const e=this.gl,i=t.unifs;if(t.lightmaps&&i.lightmap&&t.boundLightmap!=this.lightmapName){const n=t.lightmaps[this.lightmapName];n&&n.glimage.isLoaded()?(n.glimage.bindToUniform(t,i.lightmap),e.uniform2fv(i.lightmapSize.location,n.atlasSize.asArray()),i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!0),t.boundLightmap=this.lightmapName):i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!1)}this.__bindAndRender(t,this.visibleItems,this.drawIdsBuffer)}drawHighlighted(t){0!=this.highlightedItems.length&&(this.highlightedIdsBufferDirty&&this.updateHighlightedIDsBuffer(),this.__bindAndRender(t,this.highlightedItems,this.highlightedIdsBuffer))}__bindAndRender(t,e,i){const n=this.gl,s=t.unifs;if(t.glgeom!=this.glgeom&&(this.glgeom.bind(t),t.glgeom=this.glgeom),n.floatTexturesSupported&&n.drawElementsInstanced&&t.supportsInstancing){n.uniform1i(t.unifs.instancedDraw.location,1);const o=t.attrs.instancedIds.location;n.enableVertexAttribArray(o),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(o,1,n.FLOAT,!1,4,0),n.vertexAttribDivisor(o,1),t.bindViewports(s,()=>{this.glgeom.drawInstanced(e.length)})}else t.unifs.instancedDraw&&n.uniform1i(t.unifs.instancedDraw.location,0),e.forEach(e=>{this.glgeomItems[e].bind(t),t.bindViewports(s,()=>{this.glgeom.draw(t)})})}destroy(){this.emit("destructing",{})}}class ys{constructor(t){this.glshader=t.glshader,this.glgeomdatashader=t.glgeomdatashader,this.glselectedshader=t.glselectedshader,this.glmaterialGeomItemSets=[]}findMaterialGeomItemSets(t){for(const e of this.glmaterialGeomItemSets)if(e.glmaterial==t)return e}addMaterialGeomItemSets(t){this.glmaterialGeomItemSets.push(t)}removeMaterialGeomItemSets(t){const e=this.glmaterialGeomItemSets.indexOf(t);this.glmaterialGeomItemSets.splice(e,1)}getMaterialGeomItemSets(){return this.glmaterialGeomItemSets}}class fs{constructor(t){this.glmaterial=t,this.geomItemSets=[],this.drawCount=0,this.visibleInGeomDataBuffer=t.getMaterial().visibleInGeomDataBuffer,this.__drawCountChanged=this.__drawCountChanged.bind(this)}getGLMaterial(){return this.glmaterial}__drawCountChanged(t){this.drawCount+=t}addGeomItemSet(t){-1==this.geomItemSets.indexOf(t)?(this.geomItemSets.push(t),this.drawCount+=t.drawCount,t.addListener("drawCountChanged",this.__drawCountChanged)):console.warn("geomItemSet already added to GLMaterialGeomItemSets")}removeGeomItemSet(t){const e=this.geomItemSets.indexOf(t);this.geomItemSets.splice(e,1),t.removeListener("drawCountChanged",this.__drawCountChanged)}findGeomItemSet(t){for(const e of this.geomItemSets)if(e.getGLGeom()==t)return e;return null}getGeomItemSets(){return this.geomItemSets}}class Vs extends Gs{constructor(){super(),this.__glshadermaterials={}}init(t,e){super.init(t,e)}filterGeomItem(t){const e=t.getMaterial().getShaderClass();if(e){if(e.isTransparent())return!1;if(e.isOverlay())return!1;const i=t.getMaterial().getParameter("BaseColor");return!(i&&i.getValue().a<1)}return!1}addGeomItem(t){const e=t.getMaterial(),i=e.getShaderName(),n=this.constructShaders(i),s=this.addMaterial(e),o=super.addGeomItem(t);let r=this.__glshadermaterials[i];r||(r=new ys(n),this.__glshadermaterials[i]=r);let a=r.findMaterialGeomItemSets(s);a||(a=new fs(s),r.addMaterialGeomItemSets(a));let l=a.findGeomItemSet(o.glGeom);return l||(l=new Xs(this.__gl,o.glGeom),a.addGeomItemSet(l)),t.setMetadata("geomItemSet",l),l.addGeomItem(o),!0}removeGeomItem(t){const e=super.removeGeomItem(t);if(!e)return!1;const i=t.getMetadata("geomItemSet");return i&&(i.removeGeomItem(e),t.deleteMetadata("geomItemSet")),!0}removeMaterial(t){const e=this.__glshadermaterials[t.hash];if(!e||e!=t.getMetadata("glshaderMaterials"))return void console.warn("Material not found in pass");const i=t.getMetadata("glmaterialGeomItemSets");e.removeMaterialGeomItemSets(i)}__traverseTreeAndDraw(t){for(const e in this.__glshadermaterials){const i=this.__glshadermaterials[e],n=i.glshader;if(this.bindShader(t,n)){const e=i.getMaterialGeomItemSets();for(const i of e)if(0!=i.drawCount&&this.bindMaterial(t,i.getGLMaterial(),!0)){const e=i.getGeomItemSets();for(const i of e)i.draw(t)}}n.unbind(t)}t.glgeom&&t.glgeom.unbind(t)}draw(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0),this.__traverseTreeAndDraw(t)}drawHighlightedGeoms(t){const e=this.__gl;e.disable(e.CULL_FACE);for(const i in this.__glshadermaterials){const e=this.__glshadermaterials[i];if(!e.glselectedshader)continue;if(!this.bindShader(t,e.glselectedshader))continue;const n=e.getMaterialGeomItemSets();for(const i of n){const e=i.getGeomItemSets();for(const i of e)i.drawHighlighted(t)}}t.glgeom&&t.glgeom.unbind(t)}getGeomItemAndDist(t){let e,i;this.__gl.floatGeomBuffer?(e=Math.round(t[1]),i=t[3]):(e=t[0]+(t[1]<<8),i=Math.decode16BitFloatFrom2xUInt8([t[2],t[3]]));const n=this.__drawItems[e];if(n)return{geomItem:n.getGeomItem(),dist:i}}drawGeomData(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0);for(const i in this.__glshadermaterials){const n=this.__glshadermaterials[i];if(!n.glgeomdatashader)continue;if(!this.bindShader(t,n.glgeomdatashader))continue;{const i=t.unifs.floatGeomBuffer;i&&e.uniform1i(i.location,e.floatGeomBuffer?1:0)}{const i=t.unifs.passId;i&&e.uniform1i(i.location,this.__passIndex)}const s=n.getMaterialGeomItemSets();for(const e of s)if(0!=e.drawCount&&e.visibleInGeomDataBuffer&&this.bindMaterial(t,e.getGLMaterial(),!1)){const i=e.getGeomItemSets();for(const e of i)e.draw(t)}}t.glgeom&&t.glgeom.unbind(t)}}zi.registerPass(Vs,Ci.OPAQUE);class Is extends Gs{constructor(){super()}init(t,e){super.init(t,e),this.transparentItems=[],this.freeList=[],this.visibleItems=[],this.prevSortCameraPos=new Z(999,999,999),this.resort=!1}filterGeomItem(t){const e=t.getMaterial().getShaderClass();if(e){if(e.isTransparent())return!0;if(e.isOverlay())return!1;const i=t.getMaterial().getParameter("BaseColor");if(i&&i.getValue().a<.999)return!0}return!1}addGeomItem(t){const e=t.getMaterial(),i=e.getShaderName(),n=this.constructShaders(i),s=this.addMaterial(e),o=super.addGeomItem(t),r=t.addListener("visibilityChanged",t=>{if(t.visible)this.visibleItems.push(l);else{const t=this.visibleItems.indexOf(l);this.visibleItems.splice(t,1)}}),a=t.addListener("geomXfoChanged",()=>{this.resort=!0}),l={geomItem:t,shaders:n,glmaterial:s,glgeomitem:o,visibilityChangedId:r,geomXfoChangedId:a};let c;c=this.freeList.length>0?this.freeList.pop():this.transparentItems.length,this.transparentItems[c]=l,t.setMetadata("itemIndex",c),t.getVisible()&&this.visibleItems.push(l),this.resort=!0}removeGeomItem(t){if(!super.removeGeomItem(t))return;const e=t.getMetadata("itemIndex"),i=this.transparentItems[e];this.transparentItems[e]=null,this.freeList.push(e);const n=this.visibleItems.indexOf(i);-1!=n&&this.visibleItems.splice(n,1)}sortItems(t){for(const e of this.visibleItems){const i=e.glgeomitem.geomItem.getGeomMat4();e.dist=i.translation.distanceTo(t)}this.visibleItems.sort((t,e)=>t.dist>e.dist?-1:t.dist<e.dist?1:0),this.prevSortCameraPos=t,this.resort=!1}_drawItem(t,e,i){if(i.currentglMaterial!=e.glmaterial&&(i.currentglMaterial=e.glmaterial,!i.currentglMaterial.bind(t)))return;const n=e.glgeomitem;if((i.currentglGeom==n.glGeom||(i.currentglGeom=n.glGeom,i.currentglGeom.bind(t)))&&n.bind(t)){if(t.unifs.instancedDraw){const e=this.__gl;e.uniform1i(t.unifs.instancedDraw.location,0),e.disableVertexAttribArray(t.attrs.instancedIds.location)}t.bindViewports(t.unifs,()=>{i.currentglGeom.draw(t)})}}_drawItems(t){const e={currentglShader:null,currentglMaterial:null,currentglGeom:null};for(const i of this.visibleItems){if(e.currentglShader!=i.shaders.glshader){if(!this.bindShader(t,i.shaders.glshader))continue;e.currentglShader=i.shaders.glshader}this._drawItem(t,i,e)}e.currentglGeom&&e.currentglGeom.unbind(t)}draw(t){if(0==this.visibleItems.length)return;this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl,i=t.viewXfo.tr;(this.resort||i.distanceTo(this.prevSortCameraPos)>.3)&&this.sortItems(i),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),t.pass="MULTIPLY",e.blendFunc(e.DST_COLOR,e.ZERO),this._drawItems(t),t.pass="ADD",e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this._drawItems(t),e.disable(e.BLEND)}drawHighlightedGeoms(t){const e=this.__gl;e.disable(e.CULL_FACE);const i={currentglShader:null,currentglMaterial:null,currentglGeom:null};for(const n of this.visibleItems){if(!n.geomItem.isHighlighted())continue;if(!n.shaders.glselectedshader)continue;const e=n.shaders;if(i.currentglShader!=e.glselectedshader){if(!this.bindShader(t,e.glselectedshader))continue;i.currentglShader=e.glselectedshader}this._drawItem(t,n,i)}i.currentglGeom&&i.currentglGeom.unbind(t)}getGeomItemAndDist(t){let e,i;this.__gl.floatGeomBuffer?(e=Math.round(t[1]),i=t[3]):(e=t[0]+(t[1]<<8),i=Math.decode16BitFloatFrom2xUInt8([t[2],t[3]]));const n=this.__drawItems[e];if(n)return{geomItem:n.getGeomItem(),dist:i}}drawGeomData(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0);const i={currentglShader:null,currentglMaterial:null,currentglGeom:null};for(const n of this.visibleItems){const s=n.shaders;if(!s.glgeomdatashader){if(i.currentglShader!=s.glgeomdatashader){if(!this.bindShader(t,s.glgeomdatashader))continue;i.currentglShader=s.glgeomdatashader}{const i=t.unifs.floatGeomBuffer;i&&e.uniform1i(i.location,e.floatGeomBuffer?1:0)}{const i=t.unifs.passId;i&&e.uniform1i(i.location,this.__passIndex)}this._drawItem(t,n,i)}}i.currentglGeom&&i.currentglGeom.unbind(t)}}zi.registerPass(Is,Ci.TRANSPARENT);class xs extends Ni{constructor(){super()}init(t,e){super.init(t,e),this.__billboards=[],this.__freeIndices=[],this.__drawCount=0,this.__threshold=0,this.__updateRequested=!1,this.__prevSortCameraPos=new Z,this.__atlas=new ci(this.__renderer.gl,"Billboards","RGBA","UNSIGNED_BYTE",[1,1,1,0]);const i=t=>this.emit("updated",t);this.__atlas.on("loaded",i),this.__atlas.on("updated",i),this.__renderer.registerPass(t=>t instanceof ga&&(this.addBillboard(t),!0),t=>t instanceof ga&&(this.removeBillboard(t),!0))}filterRenderTree(){}addBillboard(t){const e=t.getParameter("Image"),i=e.getValue();if(!i)return void e.on("valueChanged",()=>this.addBillboard(t));let n;n=this.__freeIndices.length>0?this.__freeIndices.pop():this.__billboards.length;const s=this.__atlas.addSubImage(i);t.setMetadata("GLBillboardsPass_Index",n);const o=t.on("visibilityChanged",()=>{t.getVisible()?(this.__drawCount++,this.__updateBillboard(n)):this.__drawCount--,this.__reqUpdateIndexArray()}),r=t.getParameter("GlobalXfo").on("valueChanged",()=>{t.getVisible()&&(this.__updateBillboard(n),this.emit("updated",{}))}),a=t.getParameter("Alpha").on("valueChanged",()=>{t.getVisible()&&(this.__updateBillboard(n),this.emit("updated",{}))});t.getVisible()&&this.__drawCount++,this.__billboards[n]={billboard:t,imageIndex:s,visibilityChangedId:o,xfoChangedId:r,alphaChangedId:a},this.indexArrayUpdateNeeded=!0,this.__requestUpdate()}removeBillboard(t){const e=t.getMetadata("GLBillboardsPass_Index");if(-1==e)return void console.warn("Billboard already removed.");const i=this.__billboards[e],n=i.billboard.getParameter("Image").getValue();this.__atlas.removeSubImage(n),t.removeListenerById("visibilityChanged",i.visibilityChangedId),t.getParameter("GlobalXfo").removeListenerById("valueChanged",i.xfoChangedId),t.getParameter("Alpha").removeListenerById("valueChanged",i.alphaChangedId),this.__billboards[e]=null,this.__freeIndices.push(e),t.getVisible()&&this.__drawCount--,this.indexArrayUpdateNeeded=!0,this.__requestUpdate()}__populateBillboardDataArray(t,e,i){const n=t.billboard,s=n.getGlobalXfo().toMat4(),o=1/n.getParameter("PixelsPerMeter").getValue();let r=0;n.getParameter("AlignedToCamera").getValue()&&(r|=4),n.getParameter("DrawOnTop").getValue()&&(r|=8);const a=n.getParameter("Alpha").getValue(),l=n.getParameter("Color").getValue(),c=5*e*4,h=G.createFromFloat32Buffer(i.buffer,c),d=G.createFromFloat32Buffer(i.buffer,c+4),u=G.createFromFloat32Buffer(i.buffer,c+8),m=G.createFromFloat32Buffer(i.buffer,c+12);h.set(s.xAxis.x,s.yAxis.x,s.zAxis.x,s.translation.x),d.set(s.xAxis.y,s.yAxis.y,s.zAxis.y,s.translation.y),u.set(s.xAxis.z,s.yAxis.z,s.zAxis.z,s.translation.z),m.set(o,r,t.imageIndex,a),G.createFromFloat32Buffer(i.buffer,c+16).set(l.r,l.g,l.b,l.a)}__requestUpdate(){this.__updateRequested||(this.__updateRequested=!0,setTimeout(()=>{this.__updateBillboards()},100))}__reqUpdateIndexArray(){this.indexArrayUpdateNeeded||(this.indexArrayUpdateNeeded=!0,this.updateIndexArrayId=setTimeout(()=>{this.indexArrayUpdateNeeded&&(this.__updateIndexArray(),this.emit("updated",{}))},1))}__updateIndexArray(){const t=this.__gl;this.__indexArray&&this.__indexArray.length!=this.__drawCount&&(t.deleteBuffer(this.__instanceIdsBuffer),this.__instanceIdsBuffer=null),this.__indexArray=new Float32Array(this.__drawCount);let e=0;for(let i=0;i<this.__billboards.length;i++)this.__billboards[i]&&this.__billboards[i].billboard.getVisible()&&(this.__indexArray[e]=i,e++);this.__instanceIdsBuffer||(this.__instanceIdsBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.__instanceIdsBuffer),t.bufferData(t.ARRAY_BUFFER,this.__indexArray,t.STATIC_DRAW),this.indexArrayUpdateNeeded=!1}__updateBillboards(){const t=()=>{this.indexArrayUpdateNeeded&&this.__updateIndexArray();const t=this.__gl;if(!this.__glshader){t.__quadVertexIdsBuffer||t.setupInstancedQuad(),this.__glshader=new Ui(t);const e=this.__glshader.compileForTarget("GLBillboardsPass",this.__renderer.getShaderPreproc());this.__shaderBinding=Ua(t,e.attrs,t.__quadattrbuffers,t.__quadIndexBuffer)}if(this.__atlas.renderAtlas(),!t.floatTexturesSupported||!t.drawElementsInstanced)return this.__modelMatrixArray=[],this.__billboardDataArray=[],this.__tintColorArray=[],this.__indexArray.forEach(t=>{const e=this.__billboards[t],i=e.billboard,n=i.getGlobalXfo().toMat4(),s=1/i.getParameter("PixelsPerMeter").getValue();let o=0;i.getParameter("AlignedToCamera").getValue()&&(o|=4);const r=i.getParameter("Alpha").getValue(),a=i.getParameter("Color").getValue();this.__modelMatrixArray[t]=n.asArray(),this.__billboardDataArray[t]=[s,o,e.imageIndex,r],this.__tintColorArray[t]=[a.r,a.g,a.b,a.a]}),void(this.__updateRequested=!1);let e=Math.round(Math.sqrt(5*(this.__billboards.length-this.__freeIndices.length))+.5);e%5!=0&&(e+=5-e%5),this.__width=e,this.__drawItemsTexture?this.__drawItemsTexture.resize(e,e):(this.__drawItemsTexture=new Ka(t,{format:"RGBA",type:"FLOAT",width:e,height:e,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1}),this.__drawItemsTexture.clear()),this.__indexArray.forEach(t=>{-1!=t&&this.__updateBillboard(t)}),this.__updateRequested=!1};this.__atlas.isLoaded()?t():this.__atlas.on("loaded",t)}__updateBillboard(t){if(0==this.__drawCount||!this.__drawItemsTexture)return;const e=this.__billboards[t];if(!e.billboard.getVisible())return;const i=this.__gl,n=new Float32Array(20);this.__populateBillboardDataArray(e,0,n),i.bindTexture(i.TEXTURE_2D,this.__drawItemsTexture.glTex);const s=5*t%this.__width,o=Math.floor(5*t/this.__width),r=this.__drawItemsTexture.getType(),a=this.__drawItemsTexture.getFormat();if("FLOAT"==r)i.texSubImage2D(i.TEXTURE_2D,0,s,o,5,1,i[a],i[r],n);else{const t=Math.convertFloat32ArrayToUInt16Array(n);i.texSubImage2D(i.TEXTURE_2D,0,s,o,5,1,i[a],i[r],t)}}sort(t){for(const i of this.__billboards){const{billboard:e}=i;if(e&&e.getVisible()){const n=e.getGlobalXfo();i.dist=n.tr.distanceTo(t)}}this.__indexArray.sort((t,e)=>-1==t?1:-1==e||this.__billboards[t].dist>this.__billboards[e].dist?-1:this.__billboards[t].dist<this.__billboards[e].dist?1:0);const e=this.__gl;e.floatTexturesSupported&&this.__instanceIdsBuffer&&(e.bindBuffer(e.ARRAY_BUFFER,this.__instanceIdsBuffer),e.bufferData(e.ARRAY_BUFFER,this.__indexArray,e.STATIC_DRAW))}draw(t){if(0==this.__drawCount||!this.__atlas.isReady()||this.__updateRequested)return;this.indexArrayUpdateNeeded&&this.__updateIndexArray();const e=this.__gl;e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);const i=t.viewXfo.tr;if(i.distanceTo(this.__prevSortCameraPos)>this.__threshold)if(this.sort(i),this.__prevSortCameraPos=i.clone(),this.__drawCount>1){const t=this.__billboards[this.__indexArray[0]].billboard.getGlobalXfo().tr,e=this.__billboards[this.__indexArray[1]].billboard.getGlobalXfo().tr;this.__threshold=t.distanceTo(e)}else this.__threshold=9999;this.__glshader.bind(t),this.__shaderBinding.bind(t);const n=t.unifs;if(this.__atlas.bindToUniform(t,n.atlasBillboards),e.uniform1i(n.inVR.location,1==t.vrPresenting),e.floatTexturesSupported&&e.drawElementsInstanced){this.__drawItemsTexture.bindToUniform(t,n.instancesTexture),e.uniform1i(n.instancesTextureSize.location,this.__width);{const i=t.attrs.instanceIds.location;e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,this.__instanceIdsBuffer),e.vertexAttribPointer(i,1,e.FLOAT,!1,4,0),e.vertexAttribDivisor(i,1)}t.bindViewports(n,()=>{e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,this.__drawCount)})}else{const i=this.__indexArray.length;for(let s=0;s<i;s++)e.uniformMatrix4fv(n.modelMatrix.location,!1,this.__modelMatrixArray[s]),e.uniform4fv(n.billboardData.location,this.__billboardDataArray[s]),e.uniform4fv(n.tintColor.location,this.__tintColorArray[s]),e.uniform4fv(n.layoutData.location,this.__atlas.getLayoutData(this.__billboards[s].imageIndex)),t.bindViewports(n,()=>{e.drawQuad()})}e.disable(e.BLEND)}}zi.registerPass(xs,Ci.TRANSPARENT);class Rs extends Vs{constructor(){super()}init(t,e){super.init(t,e)}filterGeomItem(t){if(t.isOverlay())return!0;const e=t.getMaterial().getShaderClass();return!(!e||!e.isOverlay())}draw(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),t.pass="ADD",e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.__traverseTreeAndDraw(t),e.disable(e.BLEND)}drawGeomData(t){const e=this.__gl;e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),t.pass="ADD",e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),super.drawGeomData(t),e.disable(e.BLEND),e.enable(e.DEPTH_TEST)}}zi.registerPass(Rs,Ci.OVERLAY);const Ss=window.AudioContext||window.webkitAudioContext||!1;let Ls;Ss?Ls=new Ss:alert("Sorry, but the Web Audio API is not supported by your browser. Please, consider upgrading to the latest version or downloading Google Chrome or Mozilla Firefox");class Ws extends Ni{constructor(){super(),this.__audioItems=[]}init(t,e){super.init(t,e),Ls&&this.__renderer.registerPass(t=>{if(t instanceof ra)return t.addListener("audioSourceCreated",e=>{const{audioSource:i}=e;this.addAudioSource(t,i,t)}),!0;if(t instanceof ha){const e=t.getMaterial();if(e){const i=e.getParameter("BaseColor");if(i&&i.getImage&&i.getImage()){const e=i.getImage();e.addListener("loaded",()=>{if(e.getAudioSource){const i=e.getAudioSource();(i instanceof HTMLMediaElement||i instanceof AudioBufferSourceNode)&&this.addAudioSource(t,i,e)}})}}return!1}},()=>{})}addAudioSource(t,e,i){if(e.addedToCollector)return;let n;n=e instanceof HTMLMediaElement?Ls.createMediaElementSource(e):e instanceof AudioBufferSourceNode?e:Ls.createMediaStreamSource(e);const s=Ls.createGain(),o=i.getParameter("Gain");var r,a;o&&(a=s.gain,(r=o)&&(a.setValueAtTime(r.getValue(),0),a.setValueAtTime(r.getValue(),5),r.addListener("valueChanged",()=>{a.value=r.getValue()}))),inNode;const l=i.getParameter("SpatializeAudio");if(l&&0==l.getValue())dioCtx;else{const e=Ls.createPanner();e.panningModel="HRTF",e.distanceModel="inverse"("pasource",nner)("aupanner",dioCtx.destination);const n=t=>{const n=i.getParameter(t);n&&(e[t]=n.getValue(),n.addListener("valueChanged",()=>{e[t]=n.getValue()}))};n("coneInnerAngle"),n("coneOuterAngle"),n("coneOuterGain");const s=()=>{let i;i=t instanceof ha?t.getGeomMat4():t.getGlobalXfo().toMat4();const n=i.translation;e.setPosition(n.x,n.y,n.z);const s=i.zAxis;e.setOrientation(s.x,s.y,s.z)};s(),t.addListener("globalXfoChanged",()=>{s()})}e.addedToCollector=!0,this.__audioItems.push({treeItem:t,audioSource:e,parameterOwner:i}),this.emit("updated",{})}__updateListenerPosition(t){if(!Ls)return;const e=Ls.listener;e.setPosition(t.tr.x,t.tr.y,t.tr.z);const i=t.ori.getYaxis(),n=t.ori.getZaxis().negate();e.setOrientation(n.x,n.y,n.z,i.x,i.y,i.z)}draw(t){0!=this.__audioItems.length&&this.__updateListenerPosition(t.viewXfo)}}zi.registerPass(Ws,Ci.OVERLAY),window&&(window.ZeaAudioaudioCtx=Ls);var vs=Object.freeze({__proto__:null,create3DContext:Na,GLTexture2D:Ka,GLMesh:Pa,GLLines:Ea,GLPoints:Ha,GLMaterial:ni,GLShader:Oa,GLFbo:Aa,GLRenderTarget:li,GLRenderer:zi,GLBaseViewport:xi,GLViewport:Ri,shaderLibrary:Ba,generateShaderGeomBinding:Ua,BillboardShader:Ui,ConvolverShader:mi,DepthMapShader:Ji,EnvMapShader:pi,BackgroundImageShader:gi,OctahedralEnvMapShader:_i,LatLongEnvMapShader:Zi,SterioLatLongEnvMapShader:Gi,DualFishEyeEnvMapShader:Xi,DualFishEyeToLatLongBackgroundShader:yi,EnvProjectionShader:Pi,OctahedralEnvProjectionShader:Ei,LatLongEnvProjectionShader:Hi,FatLinesShader:ki,FlatSurfaceShader:Bi,FlatAlphaSurfaceShader:Di,LayeredCarPaintShader:Oi,LinesShader:Ai,NormalsShader:ji,PointsShader:qi,FatPointsShader:$i,FatPointsGeomDataShader:es,FatPointsSelectedShader:ts,PostProcessing:as,ScreenQuadShader:Vi,SimpleSurfaceShader:is,StandardSurfaceShader:ss,StandardSurfaceGeomDataShader:ns,StandardSurfaceSelectedGeomsShader:ls,HandleShader:rs,HandleGeomDataShader:ds,TransparentSurfaceShader:os,ScreenSpaceShader:hs,ToolIconShader:cs,UnpackHDRShader:Qa,UnpackLDRAlphaImageShader:ms$2,WireShader:us,GLPass:Ni,PassType:Ci,GLStandardGeomsPass:Gs,GLOpaqueGeomsPass:Vs,GLTransparentGeomsPass:Is,GLBillboardsPass:xs,GLOverlayPass:Rs,GLAudioItemsPass:Ws,get audioCtx(){return Ls},VRViewport:Wi});class Ts{constructor(t){this.__name=t||J.getClassName(this),this.__stateEvents=[],this.__activationActions=[],this.__deactivationActions=[]}getName(){return this.__name}setName(t){this.__name=t}setStateMachine(t){this.__stateMachine=t}getStateMachine(){return this.__stateMachine}activate(){this.__stateEvents.forEach(t=>{t.activate()}),this.__activationActions.forEach(t=>{t.activate()})}deactivate(){this.__stateEvents.forEach(t=>{t.deactivate()}),this.__activationActions.forEach(t=>{t.deactivate()}),this.__deactivationActions.forEach(t=>{t.activate()})}addStateEvent(t){t.setState(this),this.__stateEvents.push(t)}getStateEvent(t){return this.__stateEvents[t]}addActivationAction(t){t.setState(this),this.__activationActions.push(t)}getActivationAction(t){return this.__activationActions[t]}addDeactivationAction(t){t.setState(this),this.__deactivationActions.push(t)}toJSON(t,e){const i={name:this.__name,type:J.getClassName(this)},n=[];for(const r of this.__stateEvents)n.push(r.toJSON(t,e));i.stateEvents=n;const s=[];for(const r of this.__activationActions)s.push(r.toJSON(t,e));i.activationActions=s;const o=[];for(const r of this.__deactivationActions)o.push(r.toJSON(t,e));return i.deactivationActions=o,i}fromJSON(t,e,i){this.__name=t.name;for(const n of t.stateEvents){const t=J.constructClass(n.type);t.fromJSON(n,e),this.addStateEvent(t)}for(const n of t.activationActions){const t=J.constructClass(n.type);t.fromJSON(n,e),this.addActivationAction(t)}for(const n of t.deactivationActions){const t=J.constructClass(n.type);t.fromJSON(n,e),this.addDeactivationAction(t)}}}J.registerClass("State",Ts);class Fs extends q{constructor(t){super(),this.__name=t,this.__childActions=[],this.__outputs={}}addOutput(t){return this.__outputs[t.getName()]=t,t}getOutput(t){return this.__outputs[t]}setState(t){this.__state=t,this.__childActions.forEach(e=>{e.setState(t)})}addChild(t){this.__childActions.push(t),t.setState(this.__state)}getChild(t){return this.__childActions[t]}activate(){console.warn("activate must be implmented by each action. this:"+J.getClassName(this))}addChild(t){this.__childActions.push(t),t.setState(this.__state)}deactivate(){this.__childActions.forEach(t=>{t.deactivate()})}__onDone(){this.__childActions.forEach(t=>{t.activate()})}toJSON(t,e){let i=super.toJSON(t,e);i||(i={}),i.type=J.getClassName(this);const n=[];for(const o of this.__childActions)n.push(o.toJSON(t,e));i.childActions=n;const s={};for(const o in this.__outputs)s[o]=this.__outputs[o].toJSON(t,e);return i.outputs=s,i}fromJSON(t,e,i){super.fromJSON(t,e,i);for(const n of t.childActions){const t=J.constructClass(n.type);if(!t)throw new Error("Invalid type:"+n.type);t.fromJSON(n,e),this.addChild(t)}for(const n in t.outputs)this.__outputs[n].fromJSON(t.outputs[n],e)}destroy(){super.destroy(),this.__outputs=[]}}class Ms extends Fs{constructor(t){super(),this.__name=t,this.__onEvent=this.__onEvent.bind(this)}__onEvent(){this.__childActions.forEach(t=>{t.activate()})}deactivate(){this.__childActions.forEach(t=>{t.deactivate()})}}class Ys extends te{constructor(t){super(t),this.__states={},this.setFlag($.USER_EDITED)}addState(t){t.setStateMachine(this),this.__states[t.getName()]=t,1==Object.keys(this.__states).length&&null==this.__initialStateName&&(this.__initialStateName=t.getName())}getState(t){return this.__states[t]}activateState(t){if(!this.__states[t])throw new Error("Invalid state transtion:"+t);this.__currentState!=this.__states[t]&&(this.__currentState&&this.__currentState.deactivate(),this.__currentState=this.__states[t],this.__currentState.activate(),this.emit("stateChanged",{name:t}))}getActiveState(){return this.__currentState}getActiveStateName(){return J.getClassName(this.__currentState)}getInitialState(){return this.__initialStateName}setInitialState(t){this.__initialStateName=t}toJSON(t,e){const i=super.toJSON(t,e);i.initialStateName=this.__initialStateName;const n={};for(const s in this.__states)n[s]=this.__states[s].toJSON(t,e);return i.states=n,i}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__initialStateName=t.initialStateName,e.stateMachine=this;for(const n in t.states){const i=t.states[n],s=J.constructClass(i.type);if(!s)throw new Error("Invalid type:"+i.type);s.fromJSON(i,e),this.addState(s)}e.addPLCB(()=>{})}}J.registerClass("StateMachine",Ys);class Cs extends Fs{constructor(){super(),this.__targetStateParam=this.addParameter(new We("TargetState",""))}activate(){this.__state.getStateMachine().activateState(this.__targetStateParam.getValue())}}J.registerClass("SwitchState",Cs);class Ns extends Fs{constructor(){super(),this.addParameter(new Ye("Camera",t=>t instanceof _a)),this.addParameter(new fe("CameraPos")),this.addParameter(new fe("CameraTarget")),this.addParameter(new Ze("InterpTime",1)),this.addParameter(new Ze("UpdateFrequency",30))}setCameraPositionAndTarget(t,e){this.getParameter("CameraPos").setValue(t),this.getParameter("CameraTarget").setValue(e)}activate(){const t=this.getParameter("Camera").getValue();if(!t)return void console.warn("Camera not assigned to SetCameraPositionAndTarget state action");const e=this.getParameter("CameraPos").getValue(),i=this.getParameter("CameraTarget").getValue(),n=this.getParameter("InterpTime").getValue();if(n>0){const s=t.getGlobalXfo().tr,o=t.getTargetPostion(),r=(s.subtract(o).length(),this.getParameter("UpdateFrequency").getValue()),a=e.subtract(i).length();let l=!0,c=0,h=0;const d=Math.round(n*r);let u=!1;const m=()=>{u||(l=!1)};t.addListener("globalXfoChanged",m);const p=()=>{if(l)if(h++,h<d){const n=h/d,s=Math.smoothStep(0,1,n),o=(s-c)/(1-n);c=s;const m=t.getGlobalXfo().tr,b=t.getTargetPostion(),f=m.subtract(b).length();let g=m;const y=b.lerp(i,o);l&&(g=m.lerp(e,o));const v=g.subtract(y),Z=(v.length(),Math.lerp(f,a,o));v.scaleInPlace(Z/v.length()),u=!0,t.setPositionAndTarget(y.add(v),y),u=!1,this.__timeoutId=window.setTimeout(p,1e3/r)}else t.removeListener("globalXfoChanged",m),t.emit("movementFinished",{}),this.__timeoutId=void 0,this.__onDone()};p()}else t.setPositionAndTarget(e,i)}deactivate(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=void 0),super.deactivate()}cancel(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=void 0)}}J.registerClass("SetCameraPositionAndTarget",Ns);class Ks extends Fs{constructor(){super(),this.__interpTimeParam=this.addParameter(new Ze("InterpTime",1)),this.__updateFrequencyParam=this.addParameter(new Ze("UpdateFrequency",30)),this.__outParam=this.addOutput(new Ia("Param")),this.__outParam.addListener("paramSet",t=>{const{param:e}=t;if(e&&!this.__valueParam||e.getDataType()!=this.__valueParam.getDataType()){const t=e.clone();t.setName("Value"),t.setValue(this.__outParam.getInitialValue?this.__outParam.getInitialValue():e.getValue()),this.__valueParam=this.addParameter(t)}})}activate(){if(this.__outParam.isConnected()){const t=this.__interpTimeParam.getValue();if(t>0){const e=this.__updateFrequencyParam.getValue(),i=this.__outParam.getValue(),n=this.__valueParam.getValue();let s=0;const o=Math.round(t/(1/e)),r=()=>{if(s++,s<o){const t=Math.smoothStep(0,1,s/o),a=Math.lerp(i,n,t);this.__outParam.setValue(a,E.GENERATED_VALUE),this.__timeoutId=window.setTimeout(r,1e3/e)}else this.__outParam.setValue(this.__valueParam.getValue(),E.GENERATED_VALUE),this.__timeoutId=void 0,this.__onDone()};r()}else this.__outParam.setValue(this.__valueParam.getValue(),E.GENERATED_VALUE),this.__onDone()}}deactivate(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=void 0),super.deactivate()}cancel(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=void 0)}toJSON(t,e){const i=super.toJSON(t,e);return this.__valueParam&&(i.valueParamType=J.getClassName(this.__valueParam)),i}fromJSON(t,e,i){if(t.valueParamType){const e=J.constructClass(t.valueParamType,"Value");e&&(this.__valueParam=this.addParameter(e))}super.fromJSON(t,e,i)}}J.registerClass("SetParameterValue",Ks);class ws extends Ms{constructor(t){super(t),this.__geomParam=this.addParameter(new Ye("TreeItem")),this.__geomParam.addListener("valueChanged",()=>{this.__geom=this.__geomParam.getValue(),this.__activated&&this.__geom&&this.__geom.addListener("mouseDown",this.__geomClicked)}),this.__geomClicked=this.__geomClicked.bind(this),this.__activated=!1,this.__geomClickedBindId=-1}__geomClicked(t){t.stopPropagation(),this.__onEvent()}activate(){this.__geom&&this.__geom.addListener("mouseDown",this.__geomClicked),this.__activated=!0}deactivate(){this.__geom&&this.__geom.removeListener("mouseDown",this.__geomClicked),this.__activated=!1,super.deactivate()}}J.registerClass("GeomClicked",ws);class zs extends Ms{constructor(t){super(t),this.onKeyPressed=this.onKeyPressed.bind(this),this.__keyParam=this.addParameter(new We("Key",""))}onKeyPressed(t){console.log(t.key),t.key==this.__keyParam.getValue()&&this.__onEvent()}activate(){document.addEventListener("keydown",this.onKeyPressed)}deactivate(){document.removeEventListener("keydown",this.onKeyPressed)}}J.registerClass("KeyPressedEvent",zs);class Us extends Ms{constructor(t){super(t),this.__waitTimeParam=this.addParameter(new Ze("WaitTime",1))}activate(){this.__timeoutId=window.setTimeout(()=>{delete this.__timeoutId,this.__onEvent()},1e3*this.__waitTimeParam.getValue())}deactivate(){this.__timeoutId&&window.clearTimeout(this.__timeoutId)}}J.registerClass("TimedWait",Us);const Js={onResize:e,...a$1,...M,...w$1,...Ca,...vs,...Object.freeze({__proto__:null,State:Ts,StateAction:Fs,StateEvent:Ms,StateMachine:Ys,SwitchState:Cs,SetCameraPositionAndTarget:Ns,SetParameterValue:Ks,GeomClicked:ws,KeyPressedEvent:zs,TimedWait:Us})};function e$1(t,e){if(!e$1.watchedElementData){e$1.watchedElementData=[];const t=function(){e$1.watchedElementData.forEach((function(t){t.element.offsetWidth===t.offsetWidth&&t.element.offsetHeight===t.offsetHeight||(t.offsetWidth=t.element.offsetWidth,t.offsetHeight=t.element.offsetHeight,t.callback())}))};window.addEventListener("resize",t),new MutationObserver(t).observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}e$1.watchedElementData.push({element:t,offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight,callback:e})}const t$1=function(){const t=null!=(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Pixel/i)||navigator.userAgent.match(/Windows Phone/i)),e=function(){const t=navigator.userAgent;let e,i,n,s=navigator.appName,o=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);return-1!=(i=t.indexOf("Opera"))?(s="Opera",o=t.substring(i+6),-1!=(i=t.indexOf("Version"))&&(o=t.substring(i+8))):-1!=(i=t.indexOf("MSIE"))?(s="Microsoft Internet Explorer",o=t.substring(i+5)):-1!=(i=t.indexOf("Edge"))?(s="Edge",o=t.substring(i+4)):-1!=(i=t.indexOf("Chrome"))?(s="Chrome",o=t.substring(i+7)):-1!=(i=t.indexOf("Safari"))?(s="Safari",o=t.substring(i+7),-1!=(i=t.indexOf("Version"))&&(o=t.substring(i+8))):-1!=(i=t.indexOf("Firefox"))?(s="Firefox",o=t.substring(i+8)):(e=t.lastIndexOf(" ")+1)<(i=t.lastIndexOf("/"))&&(s=t.substring(e,i),o=t.substring(i+1),s.toLowerCase()==s.toUpperCase()&&(s=navigator.appName)),-1!=(n=o.indexOf(";"))&&(o=o.substring(0,n)),-1!=(n=o.indexOf(" "))&&(o=o.substring(0,n)),r=parseInt(""+o,10),isNaN(r)&&(o=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10)),{browserName:s,fullVersion:o,majorVersion:r,appName:navigator.appName,userAgent:navigator.userAgent}}(),i=function(){let t,e;try{t=document.createElement("canvas").getContext("webgl")}catch(t){}if(!t)return;try{e=document.createElement("canvas").getContext("webgl2")}catch(t){}const i=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(i.UNMASKED_VENDOR_WEBGL),s=t.getParameter(i.UNMASKED_RENDERER_WEBGL),o=t.getParameter(t.MAX_TEXTURE_SIZE);let r;return s.match(/NVIDIA/i)?r="NVidia":s.match(/AMD/i)||s.match(/Radeon/i)?r="AMD":s.match(/Intel/i)?r="Intel":s.match(/Mali/i)?r="ARM":s.match(/Adreno/i)?r="Adreno":console.warn("Unable to determine GPU vendor:",s),{vendor:n,renderer:s,gpuVendor:r,maxTextureSize:o,supportsWebGL2:null!=e}}();let n="Low";if(i)if(t)n="Low";else{const t=i.renderer.replace(/[()]/g,"").split(" ");if("NVidia"==i.gpuVendor){const e=t.indexOf("GTX");if(-1!=e){const i=t[e+1];n=i.endsWith("M")?parseInt(i.substring(0,i.length-2))>=900?"Medium":"Low":parseInt(i)>=1030?"High":"Medium"}else n=-1!=t.indexOf("TITAN")||-1!=t.indexOf("Quadro")?"High":"Low"}else if("AMD"==i.gpuVendor){const e=t.indexOf("Radeon");if(-1!=e){const i=t.indexOf("RX");if(-1!=i)if("Vega"==t[i+1])n="High";else{const e=t[i+1];let s;e.endsWith("X")?(s=parseInt(e.substring(0,e.length-2)),n="High"):s=parseInt(e),n=s>=480?"High":"Medium"}else n="Pro"==t[e+1]?parseInt(t[i+1])>=450?"Medium":"Low":"Sky"==t[e+1]&&parseInt(t[i+1])>=700?"Medium":"Low"}else n=-1!=t.indexOf("FirePro")||-1!=t.indexOf("Quadro")?"High":"Low"}else("Adreno"==i.gpuVendor||"Intel"==i.gpuVendor)&&(n="Low")}return{isMobileDevice:t,isIOSDevice:null!=(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)),browserName:e.browserName,fullVersion:e.fullVersion,majorVersion:e.majorVersion,appName:e.appName,userAgent:e.userAgent,webGLSupported:null!=i,gpuDesc:i,deviceCategory:n}}();var a$2=Object.freeze({__proto__:null,SystemDesc:t$1});const i$6=Math.PI/180;Math.HALF_PI=.5*Math.PI,Math.TWO_PI=2*Math.PI,Math.radToDeg=function(t){return t/i$6},Math.degToRad=function(t){return t*i$6},Number.isNumeric=t=>!isNaN(parseFloat(t))&&isFinite(t),String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)};const m$3=function(t){let e,i,n,s=0;if(0===t.length)return s;for(e=0,n=t.length;e<n;e++)i=t.charCodeAt(e),s=(s<<5)-s+i,s|=0;return Math.abs(s)};function u$1(t,e=0,i=5){return JSON.stringify(t,(function(t,e){return e&&e.toFixed?Number(e.toFixed(i)):e}),e)}String.prototype.hash=function(){return m$3(this)},String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},String.prototype.lpad=function(t,e){let i=this;for(;i.length<e;)i=t+i;return i},String.prototype.rpad=function(t,e){let i=this;for(;i.length<e;)i+=t;return i},Math.randomInt=function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t},Math.lerp=(t,e,i)=>t+i*(e-t),Math.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},Math.nearestPow2=function(t){return Math.pow(2,Math.round(Math.log(t)/Math.log(2)))},Math.nearestPow10=function(t){return Math.pow(10,Math.round(Math.log10(t)/Math.log10(10)))},Math.nextPow2=function(t){let e=0;for(;t>0;)e++,t>>=1;return 1<<e},Math.fract=function(t){return 0==t?0:t<0?t>-1?-t:-t%Math.floor(-t):t<1?t:t%Math.floor(t)},Math.remap=function(t,e,i,n,s){return n+(t-e)/(i-e)*(s-n)},Math.convertFloat32ArrayToUInt16Array=function(t){const e=new Uint16Array(t.length),i=new Int32Array(t.buffer),n=t=>{let e=t>>16&32768,i=t>>12&2047;const n=t>>23&255;return n<103?e:n>142?(e|=31744,e|=(255==n?0:1)&&8388607&t,e):n<113?(i|=2048,e|=(i>>114-n)+(i>>113-n&1),e):(e|=n-112<<10|i>>1,e+=1&i,e)};for(let s=0;s<t.length;s++)e[s]=n(i[s]);return e},Math.decode16BitFloatFrom2xUInt8=t=>{const e=t[0],i=(120&e)>>3;let n=0==i?0:2048;const s=n+((7&e)<<8)+t[1];return n=0==i?1:0,(128&e?1:-1)*s*Math.pow(2,i+n-16)},Math.encode16BitFloatInto2xUInt8=t=>{c||(c=new Uint8Array(2));const e=t>=0?128:0;t=Math.abs(t);let i,n=15,s=1024;for(let l=15;l>0;l--)t<s&&(s/=2,n--);i=0==n?t/s/2:(t-s)/s;const o=Math.round(2048*i),r=o/256,a=o-256*r;return c[0]=e+8*n+r,c[1]=a,t>=2048&&(c[0]=255),c},Math.encode16BitFloat=t=>{const e=new Float32Array(1);return e[0]=t,(t=>{let e=t>>16&32768,i=t>>12&2047;const n=t>>23&255;return n<103?e:n>142?(e|=31744,e|=(255==n?0:1)&&8388607&t,e):n<113?(i|=2048,e|=(i>>114-n)+(i>>113-n&1),e):(e|=n-112<<10|i>>1,e+=1&i,e)})(new Int32Array(e.buffer)[0])},Math.decode16BitFloat=t=>{const e=(32768&t)>>15,i=(31744&t)>>10,n=1023&t;return 0==i?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):31==i?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,i-15)*(1+n/Math.pow(2,10))},Math.smoothStep=(t,e,i)=>{const n=Math.clamp((i-t)/(e-t),0,1);return n*n*(3-2*n)},Math.linStep=(t,e,i)=>Math.clamp((i-t)/(e-t),0,1);class p$1{isValid(){for(const t of this.__data)if(t==1/0||isNaN(t))return!1;return!0}static createFromFloat32Buffer(t,e){throw new Error("Not yet implemented for this type:"+this.constructor.name)}static numElements(){throw new Error("Not yet implemented for this type:"+this.constructor.name)}asArray(){return this.__data}toString(){return u$1(this.toJSON())}}const g$1=new class{constructor(){this.__types={},this.__names={},this.registerType("SInt32",5),this.registerType("UInt32",4),this.registerType("Float32",6)}registerType(t,e){this.__types[t]=e,e.name?this.__names[e.name]=t:this.__names[e]=t}getType(t){return this.__types[t]}getTypeName(t){if(this.__names[t])return this.__names[t];if(this.__names[t.name])return this.__names[t.name];throw t}};class _$1 extends p$1{constructor(t=0,e=0){super(),t instanceof Float32Array||t instanceof Uint32Array||t instanceof Int32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,2):null!=t&&"object"==typeof t?(this.__data=new Float32Array(2),this.fromJSON(t)):(this.__data=new Float32Array(2),this.__data[0]=t,this.__data[1]=e)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}set(t,e){this.__data[0]=t,this.__data[1]=e}setFromOther(t){this.x=t.x,this.y=t.y}equal(t){return this.x==t.x&&this.y==t.y}notEquals(t){return this.x!=t.x&&this.y!=t.y}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e}add(t){return new _$1(this.x+t.x,this.y+t.y)}addInPlace(t){this.x+=t.x,this.y+=t.y}subtract(t){return new _$1(this.x-t.x,this.y-t.y)}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}scale(t){return new _$1(this.x*t,this.y*t)}scaleInPlace(t){this.x*=t,this.y*=t}invert(){return new _$1(1/this.x,1/this.y)}invertInPlace(){return this.x=1/this.x,this.y=1/this.y,this}multiply(t){return new _$1(this.x*t.x,this.y*t.y)}multiplyInPlace(t){this.x*=t.x,this.y*=t.y}lengthSquared(){const t=this.__data[0],e=this.__data[1];return t*t+e*e}length(){return Math.sqrt(this.lengthSquared())}distanceTo(t){const e=this.__data[0]-t.x,i=this.__data[1]-t.y;return Math.sqrt(e*e+i*i)}normalize(){const t=this.__data[0],e=this.__data[1];let i=t*t+e*e;return i<Number.EPSILON?new _$1:(i=1/Math.sqrt(i),new _$1(t*i,e*i))}normalizeInPlace(){const t=this.__data[0],e=this.__data[1];let i=t*t+e*e;i<Number.EPSILON||(i=1/Math.sqrt(i),this.set(t*i,e*i))}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}angleTo(t){const e=this.normalize().dot(t.normalize());return e>1?0:e<-1?Math.PI:Math.acos(e)}signedAngleTo(t){const e=this.angleTo(t);return this.cross(t)<0?-e:e}rotate(t){const e=Math.cos(t),i=Math.sin(t);return new _$1(this.x*e-this.y*i,this.x*i+this.y*e)}lerp(t,e){const i=this.x,n=this.y;return new _$1(i+e*(t.x-i),n+e*(t.y-n))}setRandomDir(t=1){const e=2*Math.random()*Math.PI;return this.__data[0]=Math.cos(e)*zScale,this.__data[1]=Math.sin(e)*zScale,this}setRandom(t=1){return this.__data[0]=Math.random()*t,this.__data[1]=Math.random()*t,this}clone(){return new _$1(this.__data[0],this.__data[1])}asArray(){return this.__data}static create(...t){return new _$1(...t)}static createFromFloat32Buffer(t,e=0){return new _$1(t,4*e)}static createFromFloat32Array(t){return new _$1(t)}static numElements(){return 2}toJSON(){return{x:this.x,y:this.y}}fromJSON(t){this.x=t.x,this.y=t.y}}g$1.registerType("Vec2",_$1);class Z$1 extends p$1{constructor(t=0,e=0,i=0){super(),t instanceof Float32Array||t instanceof Uint32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,3):null!=t&&"object"==typeof t?(this.__data=new Float32Array(3),this.fromJSON(t)):(this.__data=new Float32Array(3),this.__data[0]=t,this.__data[1]=e,this.__data[2]=i)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}get xy(){return new _$1(this.__data[0],this.__data[1])}get yz(){return new _$1(this.__data[1],this.__data[2])}set(t,e,i){this.x=t,this.y=void 0!==e?e:t,this.z=void 0!==i?i:t}setDataArray(t){this.__data=t}setFromOther(t){this.x=t.x,this.y=t.y,this.z=t.z}isNull(){return Math.abs(this.x)<Number.EPSILON&&Math.abs(this.y)<Number.EPSILON&&Math.abs(this.z)<Number.EPSILON}is111(){return Math.abs(1-this.x)<Number.EPSILON&&Math.abs(1-this.y)<Number.EPSILON&&Math.abs(1-this.z)<Number.EPSILON}equal(t){return this.x==t.x&&this.y==t.y&&this.z==t.z}notEquals(t){return this.x!=t.x&&this.y!=t.y&&this.z!=t.z}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e}add(t){return new Z$1(this.x+t.x,this.y+t.y,this.z+t.z)}addInPlace(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}subtract(t){return new Z$1(this.x-t.x,this.y-t.y,this.z-t.z)}subtractInPlace(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}multiply(t){return new Z$1(this.x*t.x,this.y*t.y,this.z*t.z)}multiplyInPlace(t){this.x*=t.x,this.y*=t.y,this.z*=t.z}divide(t){return new Z$1(this.x/t.x,this.y/t.y,this.z/t.z)}divideInPlace(t){this.x/=t.x,this.y/=t.y,this.z/=t.z}scale(t){return new Z$1(this.x*t,this.y*t,this.z*t)}scaleInPlace(t){this.x*=t,this.y*=t,this.z*=t}negate(){return new Z$1(-this.x,-this.y,-this.z)}inverse(){return new Z$1(1/this.x,1/this.y,1/this.z)}lengthSquared(){const t=this.__data[0],e=this.__data[1],i=this.__data[2];return t*t+e*e+i*i}length(){return Math.sqrt(this.lengthSquared())}distanceTo(t){const e=this.__data[0]-t.x,i=this.__data[1]-t.y,n=this.__data[2]-t.z;return Math.sqrt(e*e+i*i+n*n)}normalize(){let t=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];return t<Number.EPSILON?new Z$1:(t=1/Math.sqrt(t),new Z$1(this.__data[0]*t,this.__data[1]*t,this.__data[2]*t))}normalizeInPlace(){let t=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];if(t<Number.EPSILON)return;t=Math.sqrt(t);const e=1/t;return this.__data[0]*=e,this.__data[1]*=e,this.__data[2]*=e,t}resize(t){const e=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];if(e<Number.EPSILON)return;const i=t/Math.sqrt(e);return new Z$1(this.__data[0]*i,this.__data[1]*i,this.__data[2]*i)}resizeInPlace(t){const e=this.__data[0]*this.__data[0]+this.__data[1]*this.__data[1]+this.__data[2]*this.__data[2];if(e<Number.EPSILON)return;const i=t/Math.sqrt(e);this.__data[0]*=i,this.__data[1]*=i,this.__data[2]*=i}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const e=this.x,i=this.y,n=this.z,s=t.x,o=t.y,r=t.z;return new Z$1(i*r-n*o,n*s-e*r,e*o-i*s)}angleTo(t){const e=this.dot(t);return e>1?0:Math.acos(e)}lerp(t,e){const i=this.x,n=this.y,s=this.z;return new Z$1(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s))}abs(){return new Z$1(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}setRandomDir(t=1){const e=2*Math.random()*Math.PI,i=2*Math.random()-1,n=Math.sqrt(1-i*i)*t;return this.__data[0]=Math.cos(e)*n,this.__data[1]=Math.sin(e)*n,this.__data[2]=i*t,this}setRandom(t=1){return this.__data[0]=(Math.random()-.5)*t,this.__data[1]=(Math.random()-.5)*t,this.__data[2]=(Math.random()-.5)*t,this}clone(){return new Z$1(this.__data[0],this.__data[1],this.__data[2])}asArray(){return this.__data}static create(...t){return new Z$1(...t)}static createFromJSON(t){const e=new Z$1;return e.fromJSON(t),e}static createFromFloat32Buffer(t,e=0){return new Z$1(t,4*e)}static createFromFloat32Array(t){return new Z$1(t)}static numElements(){return 3}toJSON(){return{x:this.x,y:this.y,z:this.z}}fromJSON(t){this.x=t.x,this.y=t.y,this.z=t.z}}g$1.registerType("Vec3",Z$1);class G$1 extends p$1{constructor(t=0,e=0,i=0,n=0){super(),t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,4):null!=t&&"object"==typeof t?(this.__data=new Float32Array(4),this.fromJSON(t)):(this.__data=new Float32Array(4),this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}get t(){return this.__data[3]}set t(t){this.__data[3]=t}get xyz(){return new Z$1(this.__data[0],this.__data[1],this.__data[2])}set(t,e,i,n){this.x=t,this.y=e,this.z=i,this.t=n}setFromOther(t){this.x=t.x,this.y=t.y,this.z=t.z,this.t=t.t}equal(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.t==t.t}notEquals(t){return this.x!=t.x&&this.y!=t.y&&this.z!=t.z&&this.t!=t.t}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&Math.abs(this.t-t.t)<e}add(t){return new G$1(this.x+t.x,this.y+t.y,this.z+t.z,this.t+t.t)}addInPlace(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.t+=t.t}subtract(t){return new G$1(this.x-t.x,this.y-t.y,this.z-t.z,this.t-t.t)}subtractInPlace(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.t-=t.t}multiply(t){return new G$1(this.x*t.x,this.y*t.y,this.z*t.z,this.t*t.t)}multiplyInPlace(t){this.x*=t.x,this.y*=t.y,this.z*=t.z,this.t*=t.t}divide(t){return new G$1(this.x/t.x,this.y/t.y,this.z/t.z,this.t/t.t)}divideInPlace(t){this.x/=t.x,this.y/=t.y,this.z/=t.z,this.t/=t.t}scale(t){return new G$1(this.x*t,this.y*t,this.z*t,this.t*t)}scaleInPlace(t){this.set(this.x*t,this.y*t,this.z*t,this.t*t)}length(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[2];return Math.sqrt(t*t+e*e+i*i+n*n)}lengthSquared(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];return t*t+e*e+i*i+n*n}normalize(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;return s<Number.EPSILON?new G$1:(s=1/Math.sqrt(s),new G$1(t*s,e*s,i*s))}normalizeInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;s<Number.EPSILON||(s=1/Math.sqrt(s),this.set(t*s,e*s,i*s,n*s))}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.t*b.t}cross(t){const e=this.x,i=this.y,n=this.z,s=this.t,o=t.x,r=t.y,a=t.z,l=t.t;return new G$1(i*a-n*r,n*l-s*a,s*o-e*l,e*r-i*o)}angleTo(t){const e=this.normalize(),i=t.normalize(),n=e.dot(i);return n>1?0:Math.acos(n)}lerp(t,e){const i=this.x,n=this.y,s=this.z;return at=this.t,new G$1(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s),at+e*(t.t-at))}random(t=1){const e=2*glMatrix.RANDOM()*Math.PI,i=2*glMatrix.RANDOM()-1,n=Math.sqrt(1-i*i)*t;return out[0]=Math.cos(e)*n,out[1]=Math.sin(e)*n,out[2]=i*t,out}clone(){return new G$1(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}toVec3(){return new Z$1(this.__data[0],this.__data[1],this.__data[2])}asArray(){return this.__data}static create(...t){return new Z$1(...t)}static createFromFloat32Buffer(t,e=0){return new G$1(t,4*e)}static numElements(){return 4}toJSON(){return{x:this.x,y:this.y,z:this.z,t:this.t}}}g$1.registerType("Vec4",G$1);class X$1 extends p$1{constructor(t=0,e=0,i=0,n=255){super(),t instanceof Uint8Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Uint8Array(t,e,4):(this.__data=new Uint8Array(4),"string"==typeof t?t.startsWith("#")?this.setFromHex(t):this.setFromCSSColorName(t):(this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n))}get r(){return this.__data[0]}set r(t){this.__data[0]=t}get g(){return this.__data[1]}set g(t){this.__data[1]=t}get b(){return this.__data[2]}set b(t){this.__data[2]=t}get a(){return this.__data[3]}set a(t){this.__data[3]=t}set(t,e,i,n=255){this.r=t,this.g=e,this.b=i,this.a=n}setFromOther(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}setFromArray(t){this.r=t[0],this.g=t[1],this.b=t[2],this.a=4==t.length?t[3]:1}setFromHex(t){const e=function(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);e?this.set(e.r,e.g,e.b):console.warn("Invalid hex code:"+t)}setFromCSSColorName(t){t.startsWith("#")?this.setFromHex(t):this.setFromHex((t=>{const e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==e[t.toLowerCase()]&&e[t.toLowerCase()]})(t))}toHex(){function t(t){const e=t.toString(16);return 1==e.length?"0"+e:e}return"#"+t(this.r)+t(this.g)+t(this.b)}equal(t){return this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a}notequals(t){return this.r!=t.r&&this.g!=t.g&&this.b!=t.b&&this.a!=t.a}approxEqual(t,e=Number.EPSILON){return Math.abs(this.r-t.r)<e&&Math.abs(this.g-t.g)<e&&Math.abs(this.b-t.b)<e&&Math.abs(this.a-t.a)<e}add(t){return new X$1(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new X$1(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}scale(t){return new X$1(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){this.r*=t,this.g*=t,this.b*=t,this.a*=t}applyGamma(t){this.set(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toLinear(t=2.2){return new X$1(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toGamma(t=2.2){return new X$1(Math.pow(this.r,1/t),Math.pow(this.g,1/t),Math.pow(this.b,1/t),this.a)}luminance(){return.2126*this.r+.7152*this.g+.0722*this.b}lerp(t,e){const i=this.r,n=this.g,s=this.b,o=this.a;return new X$1(i+e*(t.r-i),n+e*(t.g-n),s+e*(t.b-s),o+e*(t.a-o))}static random(t=0,e=!1){return t>0?new X$1(t+Math.random()*(1-t),t+Math.random()*(1-t),t+Math.random()*(1-t),e?t+Math.random()*(1-t):1):t<0?new X$1(Math.random()*(1+t),Math.random()*(1+t),Math.random()*(1+t),e?Math.random()*(1+t):1):new X$1(Math.random(),Math.random(),Math.random(),e?Math.random():1)}clone(){return new X$1(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}asArray(){return this.__data}as3ComponentArray(){return[this.__data[0],this.__data[1],this.__data[2]]}static create(...t){return new X$1(...t)}static createFromFloat32Buffer(t,e=0){return new X$1(t,4*e)}static numElements(){return 4}toJSON(){return{r:this.r,g:this.g,b:this.b,a:this.a}}fromJSON(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}toCSSString(){return"rgba("+Math.round(255*this.r)+", "+Math.round(255*this.g)+", "+Math.round(255*this.b)+", "+this.a+")"}}g$1.registerType("RGBA",X$1);class y$3 extends p$1{constructor(t=0,e=0,i=0,n=1){super(),t instanceof Float32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,4):(this.__data=new Float32Array(4),"string"==typeof t?t.startsWith("#")?this.setFromHex(t):this.setFromCSSColorName(t):(this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n))}get r(){return this.__data[0]}set r(t){this.__data[0]=t}get g(){return this.__data[1]}set g(t){this.__data[1]=t}get b(){return this.__data[2]}set b(t){this.__data[2]=t}get a(){return this.__data[3]}set a(t){this.__data[3]=t}set(t,e,i,n=1){this.r=t,this.g=e,this.b=i,this.a=n}setFromOther(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}setFromScalarArray(t){this.r=t[0],this.g=t[1],this.b=t[2],this.a=4==t.length?t[3]:1}getAsRGBArray(){return[255*this.r,255*this.g,255*this.b]}getAsRGBDict(){return{r:255*this.r,g:255*this.g,b:255*this.b}}setFromRGB(t,e,i,n){this.r=t/255,this.g=e/255,this.b=i/255,this.a=n?n/255:1}setFromRGBArray(t){this.r=t[0]/255,this.g=t[1]/255,this.b=t[2]/255,this.a=4==t.length?t[3]/255:1}setFromRGBDict(t){this.r=t.r/255,this.g=t.g/255,this.b=t.b/255,this.a=4==t.a?t.a/255:1}setFromHex(t){const e=function(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}(t);e?this.setFromRGB(e.r,e.g,e.b):console.warn("Invalid hex code:"+t)}setFromCSSColorName(t){t.startsWith("#")?this.setFromHex(t):this.setFromHex((t=>{const e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==e[t.toLowerCase()]&&e[t.toLowerCase()]})(t))}toHex(){function t(t){const e=Math.round(255*t).toString(16);return 1==e.length?"0"+e:e}return"#"+t(this.r)+t(this.g)+t(this.b)}equal(t){return this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a}notequals(t){return this.r!=t.r&&this.g!=t.g&&this.b!=t.b&&this.a!=t.a}approxEqual(t,e=Number.EPSILON){return Math.abs(this.r-t.r)<e&&Math.abs(this.g-t.g)<e&&Math.abs(this.b-t.b)<e&&Math.abs(this.a-t.a)<e}add(t){return new y$3(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}subtract(t){return new y$3(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}scale(t){return new y$3(this.r*t,this.g*t,this.b*t,this.a*t)}scaleInPlace(t){this.r*=t,this.g*=t,this.b*=t,this.a*=t}applyGamma(t){this.set(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toLinear(t=2.2){return new y$3(Math.pow(this.r,t),Math.pow(this.g,t),Math.pow(this.b,t),this.a)}toGamma(t=2.2){return new y$3(Math.pow(this.r,1/t),Math.pow(this.g,1/t),Math.pow(this.b,1/t),this.a)}luminance(){return.2126*this.r+.7152*this.g+.0722*this.b}lerp(t,e){const i=this.r,n=this.g,s=this.b,o=this.a;return new y$3(i+e*(t.r-i),n+e*(t.g-n),s+e*(t.b-s),o+e*(t.a-o))}static random(t=0,e=!1){return t>0?new y$3(t+Math.random()*(1-t),t+Math.random()*(1-t),t+Math.random()*(1-t),e?t+Math.random()*(1-t):1):t<0?new y$3(Math.random()*(1+t),Math.random()*(1+t),Math.random()*(1+t),e?Math.random()*(1+t):1):new y$3(Math.random(),Math.random(),Math.random(),e?Math.random():1)}clone(){return new y$3(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}asArray(){return this.__data}as3ComponentArray(){return[this.__data[0],this.__data[1],this.__data[2]]}static create(...t){return new y$3(...t)}static createFromFloat32Buffer(t,e=0){return new y$3(t,4*e)}static numElements(){return 4}toJSON(){return{r:this.r,g:this.g,b:this.b,a:this.a}}fromJSON(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a}toCSSString(){return"rgba("+Math.round(255*this.r)+", "+Math.round(255*this.g)+", "+Math.round(255*this.b)+", "+this.a+")"}}g$1.registerType("Color",y$3);class f$2 extends p$1{constructor(t=0,e=0,i=0,n=0){if(super(),isNaN(n))switch(n){case"XYZ":this.order=0;break;case"YZX":this.order=1;break;case"ZXY":this.order=2;break;case"XZY":this.order=3;break;case"ZYX":this.order=4;break;case"YXZ":this.order=5;break;default:throw new Error("Invalid Euler Angles Order:"+n)}else this.order=n;t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,4):(this.__data=new Float32Array(3),this.__data[0]=t,this.__data[1]=e,this.__data[2]=i)}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}set(t,e,i){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i}}g$1.registerType("EulerAngles",f$2);class V$1 extends p$1{constructor(t=1,e=0,i=0,n=0,s=1,o=0,r=0,a=0,l=1){super(),t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,9):(this.__data=new Float32Array(9),this.set(t,e,i,n,s,o,r,a,l))}get m00(){return this.__data[0]}set m00(t){this.__data[0]=t}get m01(){return this.__data[1]}set m01(t){this.__data[1]=t}get m02(){return this.__data[2]}set m02(t){this.__data[2]=t}get m10(){return this.__data[3]}set m10(t){this.__data[3]=t}get m11(){return this.__data[4]}set m11(t){this.__data[4]=t}get m12(){return this.__data[5]}set m12(t){this.__data[5]=t}get m20(){return this.__data[6]}set m20(t){this.__data[6]=t}get m21(){return this.__data[7]}set m21(t){this.__data[7]=t}get m22(){return this.__data[8]}set m22(t){this.__data[8]=t}get xAxis(){return Z$1.createFromFloat32Buffer(this.__data.buffer,0)}set xAxis(t){this.xAxis.set(t.x,t.y,t.z)}get yAxis(){return Z$1.createFromFloat32Buffer(this.__data.buffer,3)}set yAxis(t){this.yAxis.set(t.x,t.y,t.z)}get zAxis(){return Z$1.createFromFloat32Buffer(this.__data.buffer,6)}set zAxis(t){this.zAxis.set(t.x,t.y,t.z)}set(t=1,e=0,i=0,n=0,s=1,o=0,r=0,a=0,l=1){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n,this.__data[4]=s,this.__data[5]=o,this.__data[6]=r,this.__data[7]=a,this.__data[8]=l}setIdentity(){this.set()}setFromMat(t){this.__data[0]=t.m00,this.__data[1]=t.m01,this.__data[2]=t.m02,this.__data[3]=t.m10,this.__data[4]=t.m11,this.__data[5]=t.m12,this.__data[6]=t.m20,this.__data[7]=t.m21,this.__data[8]=t.m22}setFromDirectionAndUpvector(t,e){const i=t,n=i.length();if(n<Number.EPSILON)return void this.setIdentity();i.scaleInPlace(1/n);const s=e.cross(i),o=s.length();o>Number.EPSILON&&s.scaleInPlace(1/o);const r=i.cross(s),a=r.length();a>Number.EPSILON&&r.scaleInPlace(1/a),this.set(s.x,s.y,s.z,r.x,r.y,r.z,i.x,i.y,i.z)}inverse(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=l*s-o*a,h=-l*n+o*r,d=a*n-s*r,u=t*c+e*h+i*d;return u?(u=1/u,new V$1(c*u,(-l*e+i*a)*u,(o*e-i*s)*u,h*u,(l*t-i*r)*u,(-o*t+i*n)*u,d*u,(-a*t+e*r)*u,(s*t-e*n)*u)):(console.warn("Unable to invert Mat3"),null)}invertInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=l*s-o*a,h=-l*n+o*r,d=a*n-s*r,u=t*c+e*h+i*d;return u?(u=1/u,this.set(c*u,(-l*e+i*a)*u,(o*e-i*s)*u,h*u,(l*t-i*r)*u,(-o*t+i*n)*u,d*u,(-a*t+e*r)*u,(s*t-e*n)*u),!0):(console.warn("Unable to invert Mat3"),!1)}transpose(){return V$1(this.__data[0],this.__data[3],this.__data[6],this.__data[1],this.__data[4],this.__data[7],this.__data[2],this.__data[5],this.__data[8])}transposeInPlace(){const t=this.__data[1],e=this.__data[2],i=this.__data[5];this.__data[1]=this.__data[3],this.__data[2]=this.__data[6],this.__data[3]=t,this.__data[5]=this.__data[7],this.__data[6]=e,this.__data[7]=i}transformVec3(t){return new Z$1(this.__data[0]*t.x+this.__data[1]*t.y+this.__data[2]*t.z,this.__data[3]*t.x+this.__data[4]*t.y+this.__data[5]*t.z,this.__data[6]*t.x+this.__data[7]*t.y+this.__data[8]*t.z)}clone(){return new V$1(this.__data[0],this.__data[1],this.__data[2],this.__data[3],this.__data[4],this.__data[5],this.__data[6],this.__data[7],this.__data[8],this.__data[9])}static create(...t){return new V$1(...t)}static createFromFloat32Buffer(t,e=0){return new V$1(t,4*e)}toJSON(){return this.__data}fromJSON(t){this.__data=new Float32Array(t)}toString(){return this.toJSON().toString()}}g$1.registerType("Mat3",V$1);class I$1 extends p$1{constructor(t=1,e=0,i=0,n=0,s=0,o=1,r=0,a=0,l=0,c=0,h=1,d=0,u=0,m=0,p=0,b=1){super(),t instanceof Float32Array?this.__data=t:t instanceof ArrayBuffer?this.__data=new Float32Array(t,e,16):(this.__data=new Float32Array(16),this.set(t,e,i,n,s,o,r,a,l,c,h,d,u,m,p,b))}get m00(){return this.__data[0]}set m00(t){this.__data[0]=t}get m01(){return this.__data[1]}set m01(t){this.__data[1]=t}get m02(){return this.__data[2]}set m02(t){this.__data[2]=t}get m03(){return this.__data[3]}set m03(t){this.__data[3]=t}get m10(){return this.__data[4]}set m10(t){this.__data[4]=t}get m11(){return this.__data[5]}set m11(t){this.__data[5]=t}get m12(){return this.__data[6]}set m12(t){this.__data[6]=t}get m13(){return this.__data[7]}set m13(t){this.__data[7]=t}get m20(){return this.__data[8]}set m20(t){this.__data[8]=t}get m21(){return this.__data[9]}set m21(t){this.__data[9]=t}get m22(){return this.__data[10]}set m22(t){this.__data[10]=t}get m23(){return this.__data[11]}set m23(t){this.__data[11]=t}get m30(){return this.__data[12]}set m30(t){this.__data[12]=t}get m31(){return this.__data[13]}set m31(t){this.__data[13]=t}get m32(){return this.__data[14]}set m32(t){this.__data[14]=t}get m33(){return this.__data[15]}set m33(t){this.__data[15]=t}get xAxis(){return Z$1.createFromFloat32Buffer(this.__data.buffer,0)}set xAxis(t){this.xAxis.set(t.x,t.y,t.z)}get yAxis(){return Z$1.createFromFloat32Buffer(this.__data.buffer,4)}set yAxis(t){this.yAxis.set(t.x,t.y,t.z)}get zAxis(){return Z$1.createFromFloat32Buffer(this.__data.buffer,8)}set zAxis(t){this.zAxis.set(t.x,t.y,t.z)}get translation(){return Z$1.createFromFloat32Buffer(this.__data.buffer,12)}set translation(t){this.translation.set(t.x,t.y,t.z)}set(t=1,e=0,i=0,n=0,s=0,o=1,r=0,a=0,l=0,c=0,h=1,d=0,u=0,m=0,p=0,b=1){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n,this.__data[4]=s,this.__data[5]=o,this.__data[6]=r,this.__data[7]=a,this.__data[8]=l,this.__data[9]=c,this.__data[10]=h,this.__data[11]=d,this.__data[12]=u,this.__data[13]=m,this.__data[14]=p,this.__data[15]=b}setIdentity(){this.set()}setDataArray(t){this.__data=t}setFromMat4(t){this.__data[0]=t.m00,this.__data[1]=t.m01,this.__data[2]=t.m02,this.__data[3]=t.m03,this.__data[4]=t.m10,this.__data[5]=t.m11,this.__data[6]=t.m12,this.__data[7]=t.m13,this.__data[8]=t.m20,this.__data[9]=t.m21,this.__data[10]=t.m22,this.__data[11]=t.m23,this.__data[12]=t.m30,this.__data[13]=t.m31,this.__data[14]=t.m32,this.__data[15]=t.m33}toMat3(t){return new V$1(this.__data[0],this.__data[1],this.__data[2],this.__data[4],this.__data[5],this.__data[6],this.__data[8],this.__data[9],this.__data[10])}transposeInPlace(){const t=this.__data[1],e=this.__data[2],i=this.__data[3],n=this.__data[6],s=this.__data[7],o=this.__data[11];this.__data[1]=this.__data[4],this.__data[2]=this.__data[8],this.__data[3]=this.__data[12],this.__data[4]=t,this.__data[6]=this.__data[9],this.__data[7]=this.__data[13],this.__data[8]=e,this.__data[9]=n,this.__data[11]=this.__data[14],this.__data[12]=i,this.__data[13]=s,this.__data[14]=o}transpose(){return new I$1(this.__data[0],this.__data[4],this.__data[8],this.__data[12],this.__data[1],this.__data[5],this.__data[9],this.__data[13],this.__data[2],this.__data[6],this.__data[10],this.__data[14],this.__data[3],this.__data[7],this.__data[11],this.__data[15])}inverse(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=this.__data[9],h=this.__data[10],d=this.__data[11],u=this.__data[12],m=this.__data[13],p=this.__data[14],b=this.__data[15],f=t*o-e*s,g=t*r-i*s,y=t*a-n*s,v=e*r-i*o,Z=e*a-n*o,x=i*a-n*r,G=l*m-c*u,X=l*p-h*u,w=l*b-d*u,V=c*p-h*m,I=c*b-d*m,S=h*b-d*p;let R=f*S-g*I+y*V+v*w-Z*X+x*G;return R?(R=1/R,new I$1((o*S-r*I+a*V)*R,(i*I-e*S-n*V)*R,(m*x-p*Z+b*v)*R,(h*Z-c*x-d*v)*R,(r*w-s*S-a*X)*R,(t*S-i*w+n*X)*R,(p*y-u*x-b*g)*R,(l*x-h*y+d*g)*R,(s*I-o*w+a*G)*R,(e*w-t*I-n*G)*R,(u*Z-m*y+b*f)*R,(c*y-l*Z-d*f)*R,(o*X-s*V-r*G)*R,(t*V-e*X+i*G)*R,(m*g-u*v-p*f)*R,(l*v-c*g+h*f)*R)):(console.warn("Unable to invert Mat4"),null)}invertInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3],s=this.__data[4],o=this.__data[5],r=this.__data[6],a=this.__data[7],l=this.__data[8],c=this.__data[9],h=this.__data[10],d=this.__data[11],u=this.__data[12],m=this.__data[13],p=this.__data[14],b=this.__data[15],f=t*o-e*s,g=t*r-i*s,y=t*a-n*s,v=e*r-i*o,Z=e*a-n*o,x=i*a-n*r,G=l*m-c*u,X=l*p-h*u,w=l*b-d*u,V=c*p-h*m,I=c*b-d*m,S=h*b-d*p;let R=f*S-g*I+y*V+v*w-Z*X+x*G;return R?(R=1/R,this.set((o*S-r*I+a*V)*R,(i*I-e*S-n*V)*R,(m*x-p*Z+b*v)*R,(h*Z-c*x-d*v)*R,(r*w-s*S-a*X)*R,(t*S-i*w+n*X)*R,(p*y-u*x-b*g)*R,(l*x-h*y+d*g)*R,(s*I-o*w+a*G)*R,(e*w-t*I-n*G)*R,(u*Z-m*y+b*f)*R,(c*y-l*Z-d*f)*R,(o*X-s*V-r*G)*R,(t*V-e*X+i*G)*R,(m*g-u*v-p*f)*R,(l*v-c*g+h*f)*R),!0):(console.warn("Unable to invert Mat4"),!1)}setInverse(t){const e=t.__data[0],i=t.__data[1],n=t.__data[2],s=t.__data[3],o=t.__data[4],r=t.__data[5],a=t.__data[6],l=t.__data[7],c=t.__data[8],h=t.__data[9],d=t.__data[10],u=t.__data[11],m=t.__data[12],p=t.__data[13],b=t.__data[14],f=t.__data[15],g=e*r-i*o,y=e*a-n*o,v=e*l-s*o,Z=i*a-n*r,x=i*l-s*r,G=n*l-s*a,X=c*p-h*m,w=c*b-d*m,V=c*f-u*m,I=h*b-d*p,S=h*f-u*p,R=d*f-u*b;let k=g*R-y*S+v*I+Z*V-x*w+G*X;if(!k)throw new Error("Unable to invert Mat4");k=1/k,this.set((r*R-a*S+l*I)*k,(n*S-i*R-s*I)*k,(p*G-b*x+f*Z)*k,(d*x-h*G-u*Z)*k,(a*V-o*R-l*w)*k,(e*R-n*V+s*w)*k,(b*v-m*G-f*y)*k,(c*G-d*v+u*y)*k,(o*S-r*V+l*X)*k,(i*V-e*S-s*X)*k,(m*x-p*v+f*g)*k,(h*v-c*x-u*g)*k,(r*w-o*I-a*X)*k,(e*I-i*w+n*X)*k,(p*y-m*Z-b*g)*k,(c*Z-h*y+d*g)*k)}multiply(t){const e=this.__data[0],i=this.__data[1],n=this.__data[2],s=this.__data[3],o=this.__data[4],r=this.__data[5],a=this.__data[6],l=this.__data[7],c=this.__data[8],h=this.__data[9],d=this.__data[10],u=this.__data[11],m=this.__data[12],p=this.__data[13],b=this.__data[14],f=this.__data[15],g=t.asArray();let y=g[0],v=g[1],Z=g[2],x=g[3];const G=new I$1;return G.m00=y*e+v*o+Z*c+x*m,G.m01=y*i+v*r+Z*h+x*p,G.m02=y*n+v*a+Z*d+x*b,G.m03=y*s+v*l+Z*u+x*f,y=g[4],v=g[5],Z=g[6],x=g[7],G.m10=y*e+v*o+Z*c+x*m,G.m11=y*i+v*r+Z*h+x*p,G.m12=y*n+v*a+Z*d+x*b,G.m13=y*s+v*l+Z*u+x*f,y=g[8],v=g[9],Z=g[10],x=g[11],G.m20=y*e+v*o+Z*c+x*m,G.m21=y*i+v*r+Z*h+x*p,G.m22=y*n+v*a+Z*d+x*b,G.m23=y*s+v*l+Z*u+x*f,y=g[12],v=g[13],Z=g[14],x=g[15],G.m30=y*e+v*o+Z*c+x*m,G.m31=y*i+v*r+Z*h+x*p,G.m32=y*n+v*a+Z*d+x*b,G.m33=y*s+v*l+Z*u+x*f,G}multiplyInPlace(t){const e=this.asArray(),i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],u=e[10],m=e[11],p=e[12],b=e[13],f=e[14],g=e[15],y=t.asArray();let v=y[0],Z=y[1],x=y[2],G=y[3];return this.m00=v*i+Z*r+x*h+G*p,this.m01=v*n+Z*a+x*d+G*b,this.m02=v*s+Z*l+x*u+G*f,this.m03=v*o+Z*c+x*m+G*g,v=y[4],Z=y[5],x=y[6],G=y[7],this.m10=v*i+Z*r+x*h+G*p,this.m11=v*n+Z*a+x*d+G*b,this.m12=v*s+Z*l+x*u+G*f,this.m13=v*o+Z*c+x*m+G*g,v=y[8],Z=y[9],x=y[10],G=y[11],this.m20=v*i+Z*r+x*h+G*p,this.m21=v*n+Z*a+x*d+G*b,this.m22=v*s+Z*l+x*u+G*f,this.m23=v*o+Z*c+x*m+G*g,v=y[12],Z=y[13],x=y[14],G=y[15],this.m30=v*i+Z*r+x*h+G*p,this.m31=v*n+Z*a+x*d+G*b,this.m32=v*s+Z*l+x*u+G*f,this.m33=v*o+Z*c+x*m+G*g,this}postmultiplyInPlace(t){const e=t.asArray(),i=e[0],n=e[1],s=e[2],o=e[3],r=e[4],a=e[5],l=e[6],c=e[7],h=e[8],d=e[9],u=e[10],m=e[11],p=e[12],b=e[13],f=e[14],g=e[15],y=this.asArray();let v=y[0],Z=y[1],x=y[2],G=y[3];return this.m00=v*i+Z*r+x*h+G*p,this.m01=v*n+Z*a+x*d+G*b,this.m02=v*s+Z*l+x*u+G*f,this.m03=v*o+Z*c+x*m+G*g,v=y[4],Z=y[5],x=y[6],G=y[7],this.m10=v*i+Z*r+x*h+G*p,this.m11=v*n+Z*a+x*d+G*b,this.m12=v*s+Z*l+x*u+G*f,this.m13=v*o+Z*c+x*m+G*g,v=y[8],Z=y[9],x=y[10],G=y[11],this.m20=v*i+Z*r+x*h+G*p,this.m21=v*n+Z*a+x*d+G*b,this.m22=v*s+Z*l+x*u+G*f,this.m23=v*o+Z*c+x*m+G*g,v=y[12],Z=y[13],x=y[14],G=y[15],this.m30=v*i+Z*r+x*h+G*p,this.m31=v*n+Z*a+x*d+G*b,this.m32=v*s+Z*l+x*u+G*f,this.m33=v*o+Z*c+x*m+G*g,this}translateInPlace(t){const e=this.__data,i=t.x,n=t.y,s=t.z;return e[12]=e[0]*i+e[4]*n+e[8]*s+e[12],e[13]=e[1]*i+e[5]*n+e[9]*s+e[13],e[14]=e[2]*i+e[6]*n+e[10]*s+e[14],e[15]=e[3]*i+e[7]*n+e[11]*s+e[15],this}setLookAt(t,e,i){const n=t.subtract(e),s=n.length();if(s<Number.EPSILON)return void this.setIdentity();n.scaleInPlace(1/s);const o=i.cross(n),r=o.length();r>Number.EPSILON&&o.scaleInPlace(1/r);const a=n.cross(o),l=a.length();l>Number.EPSILON&&a.scaleInPlace(1/l),this.set(o.x,o.y,o.z,0,a.x,a.y,a.z,0,n.x,n.y,n.z,0,t.x,t.y,t.z,1)}setRotation(t,e){const i=t.length();if(Math.abs(i)<Number.EPSILON)return null;const n=t.x/i,s=t.y/i,o=t.z/i,r=Math.sin(e),a=Math.cos(e),l=1-a,c=this.__data;return c[0]=n*n*l+a,c[1]=s*n*l+o*r,c[2]=o*n*l-s*r,c[3]=0,c[4]=n*s*l-o*r,c[5]=s*s*l+a,c[6]=o*s*l+n*r,c[7]=0,c[8]=n*o*l+s*r,c[9]=s*o*l-n*r,c[10]=o*o*l+a,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}setXRotation(t){const e=Math.sin(t),i=Math.cos(t),n=this.__data;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=e,n[7]=0,n[8]=0,n[9]=-e,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}setYRotation(t){const e=Math.sin(t),i=Math.cos(t),n=this.__data;return n[0]=i,n[1]=0,n[2]=-e,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=e,n[9]=0,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}setZRotation(t){const e=Math.sin(t),i=Math.cos(t),n=this.__data;return n[0]=i,n[1]=e,n[2]=0,n[3]=0,n[4]=-e,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}transformVec4(t){const e=this.__data,i=t.x,n=t.y,s=t.z,o=t.t;return new Vec4(e[0]*i+e[4]*n+e[8]*s+e[12]*o,e[1]*i+e[5]*n+e[9]*s+e[13]*o,e[2]*i+e[6]*n+e[10]*s+e[14]*o,e[3]*i+e[7]*n+e[11]*s+e[15]*o)}transformVec3(t){const e=this.__data,i=t.x,n=t.y,s=t.z;return new Z$1(e[0]*i+e[4]*n+e[8]*s+e[12],e[1]*i+e[5]*n+e[9]*s+e[13],e[2]*i+e[6]*n+e[10]*s+e[14])}rotateVec3(t){const e=this.__data,i=t.x,n=t.y,s=t.z;return new Z$1(e[0]*i+e[4]*n+e[8]*s,e[1]*i+e[5]*n+e[9]*s,e[2]*i+e[6]*n+e[10]*s)}setPerspectiveMatrix(t,e,i,n){const s=Math.tan(.5*Math.PI-.5*t),o=1/(i-n);this.set(s/e,0,0,0,0,s,0,0,0,0,(i+n)*o,-1,0,0,i*n*o*2,0)}setOrthographicMatrix(t,e,i,n,s,o){const r=1/(t-e),a=1/(i-n),l=1/(s-o);this.set(-2*r,0,0,0,0,-2*a,0,0,0,0,2*l,0,(t+e)*r,(n+i)*a,(o+s)*l,1)}setScale(t,e,i){t instanceof Z$1?this.set(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1):this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1)}setFromMat3x4Array(t){this.set(t[0],t[1],t[2],0,t[3],t[4],t[5],0,t[6],t[7],t[8],0,t[9],t[10],t[11],1)}static createFromFloat32Buffer(t,e=0){return new I$1(t,4*e)}clone(){return new I$1(this.__data[0],this.__data[1],this.__data[2],this.__data[3],this.__data[4],this.__data[5],this.__data[6],this.__data[7],this.__data[8],this.__data[9],this.__data[10],this.__data[11],this.__data[12],this.__data[13],this.__data[14],this.__data[15])}static create(...t){return new I$1(...t)}toJSON(){return this.__data}fromJSON(t){this.__data=new Float32Array(t)}}g$1.registerType("Mat4",I$1);class R$1 extends p$1{constructor(t=0,e=0,i=0,n=1){if(super(),t instanceof ArrayBuffer)this.__data=new Float32Array(t,e,4);else if(this.__data=new Float32Array(4),"object"==typeof t){this.__data[0]=0,this.__data[1]=0,this.__data[2]=0,this.__data[3]=1;for(const e in t)Array.isArray(t[e])?this[e].call(this,...t[e]):this[e].call(this,t[e])}else this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n}get x(){return this.__data[0]}set x(t){this.__data[0]=t}get y(){return this.__data[1]}set y(t){this.__data[1]=t}get z(){return this.__data[2]}set z(t){this.__data[2]=t}get w(){return this.__data[3]}set w(t){this.__data[3]=t}set(t,e,i,n){this.__data[0]=t,this.__data[1]=e,this.__data[2]=i,this.__data[3]=n}setDataArray(t){this.__data=t}setFromOther(t){this.__data[0]=t.x,this.__data[1]=t.y,this.__data[2]=t.z,this.__data[3]=t.w}setFromEulerAngles(t){const e=new Z$1;switch(t.order){case 0:e.set(t.x,-t.y,t.z);break;case 1:e.set(t.y,-t.z,t.x);break;case 2:e.set(t.z,-t.x,t.y);break;case 3:e.set(t.x,t.z,t.y);break;case 4:e.set(t.z,t.y,t.x);break;case 5:e.set(t.y,t.x,t.z);break;default:throw new Error("sdrty")}const i=.5*e.x,n=.5*e.y,s=.5*e.z,o=Math.cos(i),r=Math.cos(n),a=Math.cos(s),l=Math.sin(i),c=Math.sin(n),h=Math.sin(s),d=o*a,u=o*h,m=l*a,p=l*h,b=r*m-c*u,f=r*p+c*d,g=r*u-c*m;switch(this.w=r*d+c*p,t.order){case 0:this.x=b,this.y=-f,this.z=g;break;case 1:this.x=g,this.y=b,this.z=-f;break;case 2:this.x=-f,this.y=g,this.z=b;break;case 3:this.x=b,this.y=g,this.z=f;break;case 4:this.x=g,this.y=f,this.z=b;break;case 5:this.x=f,this.y=b,this.z=g;break;default:throw new Error("sdrty")}}toEulerAngles(t){const e=new Z$1;switch(t){case 0:e.set(this.z,this.x,this.y);break;case 1:e.set(this.x,this.y,this.z);break;case 2:e.set(this.y,this.z,this.x);break;case 3:e.set(this.y,-this.x,this.z);break;case 4:e.set(this.x,-this.z,this.y);break;case 5:e.set(this.z,-this.y,this.x);break;default:throw new Error("Invalid rotation order:"+t)}const i=new Z$1,n=e.x*e.y+e.z*this.w;if(n>.49999)i.y=2*Math.atan2(e.x,this.w),i.z=.5*Math.PI,i.x=0;else if(n<-.49999)i.y=-2*Math.atan2(e.x,this.w),i.z=-.5*Math.PI,i.x=0;else{const t=e.x*e.x,s=e.z*e.z;i.y=Math.atan2(2*e.y*this.w-2*e.x*e.z,1-e.y*e.y*2-2*s),i.z=Math.asin(2*n),i.x=Math.atan2(2*e.x*this.w-2*e.y*e.z,1-2*t-2*s)}switch(t){case 0:return new f$2(i.y,i.z,i.x,t);case 1:return new f$2(i.x,i.y,i.z,t);case 2:return new f$2(i.z,i.x,i.y,t);case 3:return new f$2(-i.y,i.x,i.z,t);case 4:return new f$2(i.x,i.z,-i.y,t);case 5:return new f$2(i.z,-i.y,i.x,t)}}setFromAxisAndAngle(t,e){const i=e/2,n=t.normalize().scale(Math.sin(i));this.set(n.x,n.y,n.z,Math.cos(i))}setFromDirectionAndUpvector(t,e){const i=new V$1;i.setFromDirectionAndUpvector(t,e),this.setFromMat3(i)}setFrom2Vectors(t,e){t.normalize(),e.normalize();const i=t.cross(e),n=t.dot(e),s=Math.sqrt(2*(1+n));this.set(i.x/s,i.y/s,i.z/s,s/2),this.normalizeInPlace()}setFromMat3(t){const e=t.__data[0]+t.__data[4]+t.__data[8];let i;if(e>0)i=Math.sqrt(e+1),this.__data[3]=.5*i,i=.5/i,this.__data[0]=(t.__data[5]-t.__data[7])*i,this.__data[1]=(t.__data[6]-t.__data[2])*i,this.__data[2]=(t.__data[1]-t.__data[3])*i;else{let e=0;t.__data[4]>t.__data[0]&&(e=1),t.__data[8]>t.__data[3*e+e]&&(e=2);const n=(e+1)%3,s=(e+2)%3;i=Math.sqrt(t.__data[3*e+e]-t.__data[3*n+n]-t.__data[3*s+s]+1),this.__data[e]=.5*i,i=.5/i,this.__data[3]=(t.__data[3*n+s]-t.__data[3*s+n])*i,this.__data[n]=(t.__data[3*n+e]+t.__data[3*e+n])*i,this.__data[s]=(t.__data[3*s+e]+t.__data[3*e+s])*i}this.normalizeInPlace()}setFromMat4(t){const e=t.__data[0]+t.__data[5]+t.__data[10];let i;if(e>0)i=Math.sqrt(e+1),this.__data[3]=.5*i,i=.5/i,this.__data[0]=(t.__data[6]-t.__data[9])*i,this.__data[1]=(t.__data[8]-t.__data[2])*i,this.__data[2]=(t.__data[1]-t.__data[4])*i;else{let e=0;t.__data[5]>t.__data[0]&&(e=1),t.__data[10]>t.__data[4*e+e]&&(e=2);const n=(e+1)%3,s=(e+2)%3;i=Math.sqrt(t.__data[4*e+e]-t.__data[4*n+n]-t.__data[4*s+s]+1),this.__data[e]=.5*i,i=.5/i,this.__data[3]=(t.__data[4*n+s]-t.__data[4*s+n])*i,this.__data[n]=(t.__data[4*n+e]+t.__data[4*e+n])*i,this.__data[s]=(t.__data[4*s+e]+t.__data[4*e+s])*i}this.normalizeInPlace()}isIdentity(){return this.getAngle()<Number.EPSILON}getAngle(){return 2*Math.acos(this.w)}equal(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.w==t.w}notequals(t){return this.x!=t.x&&this.y!=t.y&&this.z!=t.z&&this.w!=t.w}approxEqual(t,e=Number.EPSILON){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&Math.abs(this.w-t.w)<e}add(t){return new R$1(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)}addInPlace(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w}subtract(t){return new R$1(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)}scale(t){return new R$1(this.x*t,this.y*t,this.z*t,this.w*t)}scaleInPlace(t){this.x*=t,this.y*=t,this.z*=t,this.w*=t}length(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];return Math.sqrt(t*t+e*e+i*i+n*n)}lengthSquared(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];return t*t+e*e+i*i+n*n}normalize(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;return s<Number.EPSILON?new R$1:(s=1/Math.sqrt(s),new R$1(t*s,e*s,i*s))}normalizeInPlace(){const t=this.__data[0],e=this.__data[1],i=this.__data[2],n=this.__data[3];let s=t*t+e*e+i*i+n*n;s<Number.EPSILON||(s=1/Math.sqrt(s),this.set(t*s,e*s,i*s,n*s))}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}cross(t){const e=this.x,i=this.y,n=this.z,s=this.w,o=t.x,r=t.y,a=t.z,l=t.w;return new R$1(i*a-n*r,n*l-s*a,s*o-e*l,e*r-i*o)}conjugate(){return new R$1(-this.x,-this.y,-this.z,this.w)}inverse(){return this.conjugate()}alignWith(t){this.dot(t)<0&&this.set(-this.x,-this.y,-this.z,-this.w)}multiply(t){const e=this.__data[0],i=this.__data[1],n=this.__data[2],s=this.__data[3],o=t.__data[0],r=t.__data[1],a=t.__data[2],l=t.__data[3];return new R$1(e*l+s*o+i*a-n*r,i*l+s*r+n*o-e*a,n*l+s*a+e*r-i*o,s*l-e*o-i*r-n*a)}multiplyInPlace(t){const e=this.__data[0],i=this.__data[1],n=this.__data[2],s=this.__data[3],o=t.__data[0],r=t.__data[1],a=t.__data[2],l=t.__data[3];this.set(e*l+s*o+i*a-n*r,i*l+s*r+n*o-e*a,n*l+s*a+e*r-i*o,s*l-e*o-i*r-n*a)}rotateVec3(t){const e=new R$1(t.x,t.y,t.z,0),i=this.multiply(e).multiply(this.conjugate());return new Z$1(i.x,i.y,i.z)}rotateX(t){t*=.5;const e=this.x,i=this.y,n=this.z,s=this.w,o=Math.sin(t),r=Math.cos(t);this.x=e*r+s*o,this.y=i*r+n*o,this.z=n*r-i*o,this.w=s*r-e*o}rotateY(t){t*=.5;const e=this.x,i=this.y,n=this.z,s=this.w,o=Math.sin(t),r=Math.cos(t);this.x=e*r-n*o,this.y=i*r+s*o,this.z=n*r+e*o,this.w=s*r-i*o}rotateZ(t){t*=.5;const e=this.x,i=this.y,n=this.z,s=this.w,o=Math.sin(t),r=Math.cos(t);this.x=e*r+i*o,this.y=i*r-e*o,this.z=n*r+s*o,this.w=s*r-n*o}toMat3(){const t=this.x,e=this.y,i=this.z,n=this.w,s=t+t,o=e+e,r=i+i,a=t*s,l=e*s,c=e*o,h=i*s,d=i*o,u=i*r,m=n*s,p=n*o,b=n*r,f=new V$1;return f.__data[0]=1-c-u,f.__data[3]=l-b,f.__data[6]=h+p,f.__data[1]=l+b,f.__data[4]=1-a-u,f.__data[7]=d-m,f.__data[2]=h-p,f.__data[5]=d+m,f.__data[8]=1-a-c,f}getXaxis(){return new Z$1(1-2*(this.z*this.z+this.y*this.y),2*(this.x*this.y+this.z*this.w),2*(this.x*this.z-this.y*this.w))}getYaxis(){return new Z$1(2*(this.x*this.y-this.z*this.w),1-2*(this.z*this.z+this.x*this.x),2*(this.y*this.z+this.x*this.w))}getZaxis(){const t=this.x*this.x,e=this.x*this.z,i=this.x*this.w,n=this.y*this.y,s=this.y*this.z,o=this.y*this.w;return new Z$1,new Z$1(2*(o+e),2*(s-i),1-2*(n+t))}mirror(t){switch(t){case 0:return new R$1(this.z,this.w,this.x,this.y);case 1:return new R$1(-this.w,this.z,this.y,-this.x);case 2:return new R$1(this.x,this.y,this.z,-this.w)}}toMat4(){const t=this.x,e=this.y,i=this.z,n=this.w,s=t+t,o=e+e,r=i+i,a=t*s,l=e*s,c=e*o,h=i*s,d=i*o,u=i*r,m=n*s,p=n*o,b=n*r,f=new I$1;return f.__data[0]=1-c-u,f.__data[4]=l-b,f.__data[8]=h+p,f.__data[1]=l+b,f.__data[5]=1-a-u,f.__data[9]=d-m,f.__data[2]=h-p,f.__data[6]=d+m,f.__data[10]=1-a-c,f}lerp(t,e){const i=new R$1(this.x+e*(t.x-this.x),this.y+e*(t.y-this.y),this.z+e*(t.z-this.z),this.w+e*(t.w-this.w));return i.normalizeInPlace(),i}static create(...t){return new R$1(...t)}static createFromFloat32Buffer(t,e=0){return new R$1(t,4*e)}static numElements(){return 4}clone(){return new R$1(this.__data[0],this.__data[1],this.__data[2],this.__data[3])}toJSON(){return{x:this.x,y:this.y,z:this.z,w:this.w}}fromJSON(t){this.__data[0]=t.x,this.__data[1]=t.y,this.__data[2]=t.z,this.__data[3]=t.w,this.normalizeInPlace()}}g$1.registerType("Quat",R$1);class x$1{constructor(t,e){this.start=t instanceof Z$1?t:new Z$1,this.dir=e instanceof Z$1?e:new Z$1}closestPoint(t){const e=t.subtract(this.start).dot(this.dir);if(e<Number.EPSILON)return this.start;const i=e/this.dir.dot(this.dir);return this.start.add(this.dir.scale(i))}pointAtDist(t){return this.start.add(this.dir.scale(t))}intersectRayVector(t){const e=this.dir,i=t.dir,n=this.start.subtract(t.start),s=e.dot(e),o=e.dot(i),r=i.dot(i),a=e.dot(n),l=i.dot(n);if(0==s&&0==r)return this.start.distanceTo(t.start);if(0==s)return t.closestPoint(this.start);if(0==r)return this.closestPoint(t.start);const c=s*r-o*o;let h,d;return c<.001?(h=0,d=o>r?a/o:l/r):(h=(o*l-r*a)/c,d=(s*l-o*a)/c),[h,d]}intersectRayPlane(t){const e=this.start.subtract(t.start),i=t.dir.dot(this.dir),n=-t.dir.dot(e);if(Math.abs(i)<Number.PRECISION)return-1;const s=n/i;return s<-Number.PRECISION?-1:s}clone(){return new x$1(this.start.clone(),this.dir.clone())}static create(...t){return new x$1(...t)}toJSON(){return{start:this.start,dir:this.dir}}fromJSON(t){this.start.fromJSON(t.start),this.dir.fromJSON(t.dir)}toString(){return u$1(this.toJSON())}}g$1.registerType("Ray",x$1),new Z$1(1,1,1);class S$1{constructor(t,e,i){if(t instanceof Float32Array)this.setFromFloat32Array(t);else{if(t instanceof Z$1)this.tr=t;else{if(t instanceof R$1&&null==e&&null==i)return this.tr=new Z$1,this.ori=t,void(this.sc=new Z$1(1,1,1));this.tr=new Z$1}this.ori=e instanceof R$1?e:new R$1,this.sc=i instanceof Z$1?i:new Z$1(1,1,1)}}set(t,e,i){this.tr=t,this.ori=e,i instanceof Z$1&&(this.sc=i)}setFromOther(t){this.tr=t.tr,this.ori=t.ori,this.sc=t.sc}isIdentity(){return this.tr.isNull()&&this.ori.isIdentity()&&this.sc.is111()}setLookAt(t,e,i){const n=t.subtract(e);if(n.length()<Number.EPSILON)throw new Error("Invalid dir");this.ori.setFromDirectionAndUpvector(n,i),this.tr=t}multiply(t){let e=this.sc;return this.sc.x==this.sc.y&&this.sc.x==this.sc.z||(e=t.ori.rotateVec3(this.sc),Math.sign(e.x)!=Math.sign(this.sc.x)&&(e.x=-e.x),Math.sign(e.y)!=Math.sign(this.sc.y)&&(e.y=-e.y),Math.sign(e.z)!=Math.sign(this.sc.z)&&(e.z=-e.z)),new S$1(this.tr.add(this.ori.rotateVec3(e.multiply(t.tr))),this.ori.multiply(t.ori),e.multiply(t.sc))}inverse(){const t=new S$1;return t.ori=this.ori.inverse(),this.sc.x!=this.sc.y||this.sc.x!=this.sc.z?(t.sc=t.ori.rotateVec3(this.sc),Math.sign(t.sc.x)!=Math.sign(this.sc.x)&&(t.sc.x=-t.sc.x),Math.sign(t.sc.y)!=Math.sign(this.sc.y)&&(t.sc.y=-t.sc.y),Math.sign(t.sc.z)!=Math.sign(this.sc.z)&&(t.sc.z=-t.sc.z)):t.sc=this.sc.inverse(),t.tr=t.ori.rotateVec3(this.tr.negate().multiply(t.sc)),t}transformVec3(t){return this.tr.add(this.ori.rotateVec3(this.sc.multiply(t)))}toMat4(){const t=new I$1(this.sc.x,0,0,0,0,this.sc.y,0,0,0,0,this.sc.z,0,0,0,0,1),e=this.ori.toMat4(),i=new I$1;return i.translation=this.tr,i.multiply(e).multiply(t)}fromMat4(t){this.tr=t.translation,this.ori.setFromMat4(t)}setFromFloat32Array(t){if(7==t.length)return this.tr=new Z$1(t.buffer,t.byteOffset),this.ori=new R$1(t.buffer,t.byteOffset+12),void(this.sc=new Z$1(1,1,1));if(8!=t.length)return 10==t.length?(this.tr=new Z$1(t.buffer,t.byteOffset),this.ori=new R$1(t.buffer,t.byteOffset+12),void(this.sc=new Z$1(t.buffer,t.byteOffset+21))):void 0;{this.tr=new Z$1(t.buffer,t.byteOffset),this.ori=new R$1(t.buffer,t.byteOffset+12);const e=t[7];this.sc=new Z$1(e,e,e)}}clone(){return new S$1(this.tr.clone(),this.ori.clone(),this.sc.clone())}static create(...t){return new S$1(...t)}toJSON(){const t={tr:this.tr.toJSON(),ori:this.ori.toJSON()};return this.sc.is111()||(t.sc=this.sc.toJSON()),t}fromJSON(t){this.tr.fromJSON(t.tr),this.ori.fromJSON(t.ori),t.sc&&this.sc.fromJSON(t.sc)}toString(){return u$1(this.toJSON())}}g$1.registerType("Xfo",S$1);class W$1{constructor(t,e){this.p0=t instanceof _$1?t:new _$1(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.p1=e instanceof _$1?e:new _$1(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY)}set(t,e){this.p0=t,this.p1=e}reset(){this.p0.x=Number.POSITIVE_INFINITY,this.p1.x=Number.NEGATIVE_INFINITY,this.p0.y=Number.POSITIVE_INFINITY,this.p1.y=Number.NEGATIVE_INFINITY}isValid(){return this.p0.x!=Number.POSITIVE_INFINITY&&this.p1.x!=Number.NEGATIVE_INFINITY&&this.p0.y!=Number.POSITIVE_INFINITY&&this.p1.y!=Number.NEGATIVE_INFINITY}addPoint(t){(this.p0.x==Number.POSITIVE_INFINITY||t.x<this.p0.x)&&(this.p0.x=t.x),(this.p0.y==Number.POSITIVE_INFINITY||t.y<this.p0.y)&&(this.p0.y=t.y),(this.p1.y==Number.NEGATIVE_INFINITY||t.x>this.p1.x)&&(this.p1.x=t.x),(this.p1.y==Number.NEGATIVE_INFINITY||t.y>this.p1.y)&&(this.p1.y=t.y)}size(){return this.p1.subtract(this.p0)}diagonal(){return this.p1.subtract(this.p0)}center(){const t=this.p1.subtract(this.p0);return t.scaleInPlace(.5),t.addInPlace(this.p0),t}static create(...t){return new W$1(...t)}toJSON(){return{p0:this.p0.toJSON(),p1:this.p1.toJSON()}}toString(){return u$1(this.toJSON())}}g$1.registerType("Box2",W$1);class L$1 extends p$1{constructor(t,e=0){super(),this.pos=t instanceof Z$1?t:new Z$1,this.radius=e}clone(){return new Sphere(this.pos.clone(),this.radius)}intersectsBox(t){return t.intersectsSphere(this)}static create(...t){return new Sphere(...t)}toJSON(){return{pos:this.pos.toJSON(),radius:this.radius}}toString(){return u$1(this.toJSON())}}g$1.registerType("SphereType",L$1);class v$1{constructor(t,e){t instanceof Float32Array?this.setFromFloat32Array(t):(this.p0=t instanceof Z$1?t:new Z$1(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.p1=e instanceof Z$1?e:new Z$1(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY))}get min(){return this.p0}get max(){return this.p1}set(t,e){this.p0=t,this.p1=e}reset(){this.p0.x=Number.POSITIVE_INFINITY,this.p1.x=Number.NEGATIVE_INFINITY,this.p0.y=Number.POSITIVE_INFINITY,this.p1.y=Number.NEGATIVE_INFINITY,this.p0.z=Number.POSITIVE_INFINITY,this.p1.z=Number.NEGATIVE_INFINITY}isValid(){return this.p0.x!=Number.POSITIVE_INFINITY&&this.p1.x!=Number.NEGATIVE_INFINITY&&this.p0.y!=Number.POSITIVE_INFINITY&&this.p1.y!=Number.NEGATIVE_INFINITY&&this.p0.z!=Number.POSITIVE_INFINITY&&this.p1.z!=Number.NEGATIVE_INFINITY}addPoint(t){t.x!=Number.POSITIVE_INFINITY&&t.x!=Number.NEGATIVE_INFINITY&&(t.x<this.p0.x&&(this.p0.x=t.x),t.x>this.p1.x&&(this.p1.x=t.x)),t.y!=Number.POSITIVE_INFINITY&&t.y!=Number.NEGATIVE_INFINITY&&(t.y<this.p0.y&&(this.p0.y=t.y),t.y>this.p1.y&&(this.p1.y=t.y)),t.z!=Number.POSITIVE_INFINITY&&t.z!=Number.NEGATIVE_INFINITY&&(t.z<this.p0.z&&(this.p0.z=t.z),t.z>this.p1.z&&(this.p1.z=t.z))}addBox3(t,e){e?(this.addPoint(e.transformVec3(t.p0)),this.addPoint(e.transformVec3(new Z$1(t.p0.x,t.p0.y,t.p1.z))),this.addPoint(e.transformVec3(new Z$1(t.p0.x,t.p1.y,t.p0.z))),this.addPoint(e.transformVec3(new Z$1(t.p1.x,t.p0.y,t.p0.z))),this.addPoint(e.transformVec3(new Z$1(t.p0.x,t.p1.y,t.p1.z))),this.addPoint(e.transformVec3(new Z$1(t.p1.x,t.p0.y,t.p1.z))),this.addPoint(e.transformVec3(new Z$1(t.p1.x,t.p1.y,t.p0.z))),this.addPoint(e.transformVec3(t.p1))):(this.addPoint(t.p0),this.addPoint(t.p1))}size(){return this.p1.subtract(this.p0)}diagonal(){return this.p1.subtract(this.p0)}center(){const t=this.p1.subtract(this.p0);return t.scaleInPlace(.5),t.addInPlace(this.p0),t}toMat4(){return new I$1(this.p1.x-this.p0.x,0,0,0,0,this.p1.y-this.p0.y,0,0,0,0,this.p1.z-this.p0.z,0,this.p0.x,this.p0.y,this.p0.z,1)}getBoundingSphere(){return new L$1(this.center(),.5*this.diagonal().length())}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return closestPoint.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}clone(){return new v$1(this.p0.clone(),this.p1.clone())}static create(...t){return new v$1(...t)}static sizeInBytes(){return 24}toJSON(){return{p0:this.p0.toJSON(),p1:this.p1.toJSON()}}fromJSON(t){this.p0.fromJSON(t.p0),this.p1.fromJSON(t.p1)}loadBin(t,e){this.p0.loadBin(t,e),this.p0.loadBin(t,e+12)}setFromFloat32Array(t){this.p0=new Z$1(t.buffer,t.byteOffset),this.p1=new Z$1(t.buffer,t.byteOffset+12)}toString(){return u$1(this.toJSON())}}g$1.registerType("Box3",v$1);class F$1 extends p$1{constructor(t,e=0){super(),this.normal=t instanceof Z$1?t:new Z$1,this.w=e}set(t,e,i,n){this.normal.set(t,e,i),this.w=n}divideScalar(t){this.normal.scaleInPlace(1/t),this.w/=t}distanceToPoint(t){return t.dot(this.normal)+this.w}normalizeInPlace(){const t=1/this.normal.length();this.normal.scaleInPlace(t),this.w*=t}clone(){return new Plane(this.normal.clone(),this.w)}static create(...t){return new Plane(...t)}toJSON(){return{normal:this.normal.toJSON(),w:this.w}}toString(){return u$1(this.toJSON())}}g$1.registerType("PlaneType",F$1);class T$1{constructor(t,e,i,n,s,o){this.planes=[t||new F$1,e||new F$1,i||new F$1,n||new F$1,s||new F$1,o||new F$1]}setFromMatrix(t){const e=t,i=this.planes;i[0].set(e.m03-e.m00,e.m13-e.m10,e.m23-e.m20,e.m33-e.m30),i[1].set(e.m03+e.m00,e.m13+e.m10,e.m23+e.m20,e.m33+e.m30),i[2].set(e.m03+e.m01,e.m13+e.m11,e.m23+e.m21,e.m33+e.m31),i[3].set(e.m03-e.m01,e.m13-e.m11,e.m23-e.m21,e.m33-e.m31),i[4].set(e.m03-e.m02,e.m13-e.m12,e.m23-e.m22,e.m33-e.m32),i[5].set(e.m03+e.m02,e.m13+e.m12,e.m23+e.m22,e.m33+e.m32),i.forEach(t=>t.normalizeInPlace())}intersectsBox(t){const e=new Z$1,i=this.planes,{min:n,max:s}=t;for(let o=0;o<6;o++){const t=i[o];if(e.x=t.normal.x>0?s.x:n.x,e.y=t.normal.y>0?s.y:n.y,e.z=t.normal.z>0?s.z:n.z,t.distanceToPoint(e)<0)return!1}return!0}toJSON(){return{p0:this.p0.toJSON(),p1:this.p1.toJSON(),p2:this.p2.toJSON(),p3:this.p3.toJSON(),p4:this.p4.toJSON(),p5:this.p5.toJSON()}}fromJSON(t){this.p0.fromJSON(t.p0),this.p1.fromJSON(t.p1),this.p2.fromJSON(t.p2),this.p3.fromJSON(t.p3),this.p4.fromJSON(t.p4),this.p5.fromJSON(t.p5)}toString(){return u$1(this.toJSON())}}g$1.registerType("Frustum",T$1);var M$1=Object.freeze({__proto__:null,UInt8:0,SInt8:1,SInt16:3,UInt16:2,SInt32:5,UInt32:4,Float32:6,hashStr:m$3,JSON_stringify_fixedPrecision:u$1,AttrValue:p$1,Vec2:_$1,Vec3:Z$1,Vec4:G$1,RGBA:X$1,Color:y$3,EulerAngles:f$2,Quat:R$1,Ray:x$1,Mat3:V$1,Mat4:I$1,Xfo:S$1,Box2:W$1,Box3:v$1,Frustum:T$1,PlaneType:F$1,SphereType:L$1,typeRegistry:g$1});class C$1{constructor(t=!1){this.__slots=[],this.__toggledSignal=t,this.__toggled=!1,this.__data=null,this.connect=this.connect.bind(this),this.disconnect=this.disconnect.bind(this),this.emit=this.emit.bind(this)}connect(t){if(null==t)throw new Error("a function callback must be passed to Signal.connect");if(-1!=this.__slots.indexOf(t))return void console.warn("fn '"+t.name+"' already connected to Signal.");const e=this.__slots.length;return this.__slots[e]=t,this.__toggledSignal&&this.__toggled&&(this.__data?t(...this.__data):t()),e}disconnect(t){if(null==t)throw new Error("a function callback must be passed to Signal.disconnect");const e=[];if(this.__slots.forEach((function(i,n){i===t&&e.push(n)})),0!=e.length)for(const i of e)this.__slots[i]=void 0;else console.warn("callback :"+t.name+" was not connected to this signal:"+this.__name)}disconnectId(t){if(!this.__slots[t])throw new Error("Invalid ID");this.__slots[t]=void 0}emit(...t){this.__toggledSignal&&(this.__toggled?console.warn("Toggled signals should only be fired once, or untoggled before re-firing.."):(this.__toggled=!0,this.__data=t));const e=this.__slots.length;for(let i=0;i<e;i++){const e=this.__slots[i];e&&e(...t)}}isToggled(){return this.__toggled}setToggled(t){this.__toggled=t,this.__data=void 0}getNumConnections(){return this.__slots.length}untoggle(){this.__toggled=!1,this.__data=void 0}}class N$1{constructor(t=0,e=0){this.root={x:0,y:0,w:t,h:e},this.resized=new C$1}fit(t){if(0==t.length)return;let e=!1;this.root.w<t[0].w&&(this.root.w=t[0].w,e=!0),this.root.h<t[0].h&&(this.root.h=t[0].h,e=!0),e&&this.resized.emit(this.root.w,this.root.h),t.forEach(t=>{t.fit=this.__addBlock(t)})}__addBlock(t){const e=this.findNode(this.root,t.w,t.h);return e?this.splitNode(e,t.w,t.h):this.growNode(t.w,t.h)}addBlock(t){let e=!1;this.root.w<t.w&&(this.root.w=t.w,e=!0),this.root.h<t.h&&(this.root.h=t.h,e=!0),e&&this.resized.emit(this.root.w,this.root.h);const i=this.findNode(this.root,t.w,t.h);return i?this.splitNode(i,t.w,t.h):this.growNode(t.w,t.h)}findNode(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.w&&i<=t.h?t:null}splitNode(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i},t.right={x:t.x+e,y:t.y,w:t.w-e,h:i},t}growNode(t,e){const i=t<=this.root.w,n=e<=this.root.h,s=i&&this.root.w>=this.root.h+e;return n&&this.root.h>=this.root.w+t?this.growRight(t,e):s?this.growDown(t,e):n?this.growRight(t,e):i?this.growDown(t,e):null}growRight(t,e){this.root={used:!0,x:0,y:0,w:this.root.w+t,h:this.root.h,down:this.root,right:{x:this.root.w,y:0,w:t,h:this.root.h}};const i=this.findNode(this.root,t,e);let n;return i&&(n=this.splitNode(i,t,e)),this.resized.emit(this.root.w,this.root.h),n}growDown(t,e){this.root={used:!0,x:0,y:0,w:this.root.w,h:this.root.h+e,down:{x:0,y:this.root.h,w:this.root.w,h:e},right:this.root};const i=this.findNode(this.root,t,e);let n;return i&&(n=this.splitNode(i,t,e)),this.resized.emit(this.root.w,this.root.h),n}}class Y$1{constructor(t=0){this.__asyncCount=t,this.ready=new C$1(!0),this.incAsyncCount=function(t=1){this.__asyncCount+=t,this.ready.setToggled(!1)}.bind(this),this.decAsyncCount=function(){this.__asyncCount>0&&(this.__asyncCount--,0==this.__asyncCount&&this.__asyncsCompleted())}.bind(this),this.__asyncsCompleted=function(){this.ready.emit()}.bind(this)}get count(){return this.__asyncCount}}const K$1=t=>{if(window.TextDecoder)return new TextDecoder("utf-8").decode(t);{let e="";for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e}};var w$2=Object.freeze({__proto__:null,GrowingPacker:N$1,Async:Y$1,Signal:C$1,decodeText:K$1});let z$1=0;class U$1{constructor(){if("RefCounted"==this.constructor.name)throw new Error("RefCounted should not be instantiated directly.");this.__id=++z$1,this.__refs=[],this.destructing=new C$1,this.__destroyed=!1}getId(){return this.__id}numRefs(){return this.__refs.length}addRef(t){if(!t)throw new Error("Error in RefCounted.addRef: Must provide a referer");return this.__refs.push(t),!0}removeRef(t){if(!t)throw new Error("Error in RefCounted.removeRef: Must provide a referer");const e=this.__refs.indexOf(t);if(-1==e)throw new Error("Error in RefCounted.removeRef: referer not found in refs list.");this.__refs.splice(e,1),0==this.__refs.length&&this.destroy()}getRefer(t){return this.__refs[t]}getRefIndex(t){return this.__refs.indexOf(t)}isDestroyed(){return this.__destroyed}destroy(){this.__destroyed=!0,this.destructing.emit(this)}}const J$1=new class{constructor(){this.__registeredClasses={},this.__classNames={},this.__classList=[]}registerClass(t,e){this.__registeredClasses[t]={cls:e,callbacks:[]};const i=this.__classList.length;this.__classList.push(e),this.__classNames[i]=t}getClass(t){if(this.__registeredClasses[t])return this.__registeredClasses[t].cls}getClassName(t){const e=this.__classList.indexOf(t.constructor);return this.__classNames[e]?this.__classNames[e]:(console.warn("Class not registered:",t.constructor.name),t.constructor.name)}constructClass(t){const e=this.__registeredClasses[t];if(!e)return console.warn("Factory not registered:"+t),null;this.__constructing=!0;const i=Array.prototype.slice.call(arguments,1),n=new e.cls(...i);return this.__constructing=!1,n}},P$1={NORMAL:0,OPERATOR_GETVALUE:1},E$1={USER_SETVALUE:0,REMOTEUSER_SETVALUE:1,USER_SETVALUE_DONE:2,OPERATOR_SETVALUE:3,OPERATOR_DIRTIED:4,COMPUTED_VALUE:4,GENERATED_VALUE:4,DATA_LOAD:4},H$1={USER_EDITED:2,DISABLED:4},k$1=0,B$1=1,D$1=2;class O$1{constructor(t){this.__name=t,this.__cleanerFns=[],this.__boundOps=[],this.__state=k$1,this.__flags=0,this.valueChanged=new C$1,this.nameChanged=new C$1,this.getName=this.getName.bind(this),this.setName=this.setName.bind(this),this.getValue=this.getValue.bind(this),this.setValue=this.setValue.bind(this)}getName(){return this.__name}setName(t){if(t!=this.__name){const e=this.__name;this.__name=t,this.nameChanged.emit(this.__name,e)}}getOwner(){return this.ownerItem}addOwner(t){this.ownerItem=t}getPath(){const t=this.getOwner();if(t&&t.getName){if(t.getPath){const e=t.getPath().slice();return e.push(this.__name),e}return[t.getName(),this.__name]}return[this.__name]}setFlag(t){this.__flags|=t}clearFlag(t){this.__flags&=~t}testFlag(t){return 0!=(this.__flags&t)}getValue(){}setValue(t){}setEnabled(t){console.warn("Deprecated Method: This method will be removed soon."),t?this.setFlag(H$1.DISABLED):this.clearFlag(H$1.DISABLED)}isEnabled(){console.warn("Deprecated Method: This method will be removed soon."),this.testFlag(H$1.DISABLED)}bindOperator(t){this.__boundOps.push(t),this.__state=B$1,this.valueChanged.emit(E$1.OPERATOR_DIRTIED)}unbindOperator(t){const e=this.__boundOps.indexOf(t);if(-1==e)return!1;this.__boundOps.splice(e,1),this.__state=B$1,this.valueChanged.emit(E$1.OPERATOR_DIRTIED)}setDirty(t){return-1==this.__cleanerFns.indexOf(t)&&(this.__cleanerFns.push(t),this.__state=B$1,this.valueChanged.emit(E$1.OPERATOR_DIRTIED),!0)}setDirtyFromOp(){return this.__state==k$1&&(this.__state=B$1,this.valueChanged.emit(E$1.OPERATOR_DIRTIED)),!0}isDirty(){return this.__state==B$1}_clean(){this.__state=D$1;const t=this.__cleanerFns;this.__cleanerFns=[];for(const e of t){const t=e(this.__value);null!=t&&(this.__value=t)}for(const e of this.__boundOps)e.evaluate();this.__state=k$1}removeCleanerFn(t){const e=this.__cleanerFns.indexOf(t);if(-1==e)return 0;this.__cleanerFns.splice(e,1)}clone(t){console.error("TOOD: implment me")}destroy(){}}class Q$1 extends O$1{constructor(t,e,i){super(t),this.__value=e,this.__dataType=i||e.constructor.name}getDataType(){return this.__dataType}getValue(t=P$1.NORMAL){return this.__state==B$1&&this._clean(),this.__value}setClean(t){this.__value=t}setValue(t,e=E$1.USER_SETVALUE){if(this.__cleanerFns.length>0&&(this.__cleanerFns=[]),null==t)throw"undefined was passed into the setvalue for param:"+this.getName();(t.fromJSON||this.__value!=t)&&(this.__value=t,e!=E$1.USER_SETVALUE&&e!=E$1.REMOTEUSER_SETVALUE||this.setFlag(H$1.USER_EDITED),e!=E$1.OPERATOR_SETVALUE&&this.valueChanged.emit(e))}setValueDone(){this.valueChanged.emit(E$1.USER_SETVALUE_DONE)}toJSON(t,e){return this.__value.toJSON?{value:this.__value.toJSON(t,e)}:{value:this.__value}}fromJSON(t,e,i){null!=t.value?(this.setFlag(H$1.USER_EDITED),t.value.type&&null==this.__value&&(this.__value=J$1.constructClass(t.value.type)),null!=this.__value&&this.__value.fromJSON?(this.__value.fromJSON(t.value,e),this.valueChanged.emit(E$1.DATA_LOAD)):this.setValue(t.value,E$1.DATA_LOAD)):console.warn("Invalid Parameter JSON")}readBinary(t,e){console.error("TODO")}clone(t){const e=this.__value;return e.clone&&(e=e.clone()),new Q$1(this.__name,e,this.__dataType)}}let A$1=0;class q$1{constructor(){this.__id=++A$1,this.__params=[],this.__paramMapping={},this.__paramSignalIds={},this.parameterAdded=new C$1,this.parameterRemoved=new C$1,this.parameterValueChanged=new C$1}getId(){return this.__id}numParameters(){return this.__params.length}getParameters(){return this.__params}getParameterIndex(t){return this.__paramMapping[t]}getParameterByIndex(t){return this.__params[t]}hasParameter(t){return t in this.__paramMapping}getParameter(t){const e=this.__paramMapping[t];return-1==e?null:this.__params[e]}__parameterValueChanged(t,e){this.parameterValueChanged.emit(t,e)}addParameter(t){const e=t.getName();return null!=this.__paramMapping[e]&&(console.warn("Replacing Parameter:"+e),this.removeParameter(e)),this.__paramSignalIds[e]=t.valueChanged.connect(e=>this.__parameterValueChanged(t,e)),this.__params.push(t),this.__paramMapping[e]=this.__params.length-1,this.parameterAdded.emit(e),t}insertParameter(t,e){const i=t.getName();null!=this.__paramMapping[i]&&(console.warn("Replacing Parameter:"+i),this.removeParameter(i)),this.__paramSignalIds[i]=t.valueChanged.connect(e=>this.__parameterValueChanged(t,e)),this.__params.splice(e,0,t);const n={};for(let s=0;s<this.__params.length;s++)n[this.__params[s].getName()]=s;return this.__paramMapping=n,this.parameterAdded.emit(i),t}removeParameter(t){null==this.__paramMapping[t]&&console.throw("Unable to Remove Parameter:"+t);const e=this.__paramMapping[t];this.__params[this.__paramMapping[t]].valueChanged.disconnectId(this.__paramSignalIds[t]),this.__params.splice(e,1);const i={};for(let n=0;n<this.__params.length;n++)i[this.__params[n].getName()]=n;this.__paramMapping=i,this.parameterRemoved.emit(t)}replaceParameter(t){const e=t.getName(),i=this.__paramMapping[e];return this.__params[this.__paramMapping[e]].valueChanged.disconnectId(this.__paramSignalIds[e]),this.__paramSignalIds[e]=t.valueChanged.connect(e=>this.__parameterValueChanged(t,e)),this.__params[i]=t,t}toJSON(t,e){const i={};let n=0;for(const s of this.__params)if(s.testFlag(H$1.USER_EDITED))if(s.numRefs()>1&&0!=s.getRefIndex(this))i[s.getName()]={paramPath:t.makeRelative(s.getPath())},n++;else{const o=s.toJSON(t,e);o&&(i[s.getName()]=o,n++)}if(n>0)return{params:i}}fromJSON(t,e,i){if(t.params)for(const n in t.params){const i=t.params[n],s=this.getParameter(n);s?i.paramPath?e.resolvePath(i.paramPath,t=>{this.replaceParameter(t)},()=>{console.warn("Unable to resolve shared parameter:"+i.paramPath)}):s.fromJSON(i,e):console.warn("Param not found:"+n)}}readBinary(t,e){if(e.versions["zea-engine"].greaterOrEqualThan([0,0,3])){const i=t.loadUInt32();for(let n=0;n<i;n++){const i=t.loadStr(),n=t.loadStr();let s=this.getParameter(n);if(!s){if(s=J$1.constructClass(i,n),!s){console.error("Unable to construct prop:"+n+" of type:"+i);continue}this.addParameter(s)}s.readBinary(t,e)}}}toString(){return JSON.stringify(this.toJSON(),null,2)}copyFrom(t,e){let i=t.numParameters();for(;i--;){const e=t.getParameterByIndex(i),n=this.getParameter(e.getName());n?n.setValue(e.getValue(),E$1.OPERATOR_SETVALUE):this.addParameter(e.clone())}}destroy(){for(const t of this.__params)t.destroy();super.destroy()}}const $$1={USER_EDITED:2,IGNORE_BBOX:4,BIN_NODE:8,INVISIBLE:16};let ee$1=0;class te$1 extends q$1{constructor(t){super(),this.__name=t||"",this.__path=[this.__name],this.__ownerItem=void 0,this.__flags=0,this.__selectable=!0,this.__selected=!1,this.selectedChanged=new C$1,this.__metaData={},this.nameChanged=new C$1,ee$1++}static getNumBaseItems(){return ee$1}__parameterValueChanged(t,e){super.__parameterValueChanged(t,e),e!=E$1.USER_SETVALUE&&e!=E$1.REMOTEUSER_SETVALUE||this.setFlag($$1.USER_EDITED)}getName(){return this.__name}setName(t,e=E$1.USER_SETVALUE){if(this.__name!=t){const i=this.__name;this.__name=t,this.__updatePath(),this.nameChanged.emit(t,i,e)}}__updatePath(){null==this.__ownerItem?this.__path=[this.__name]:(this.__path=this.__ownerItem.getPath().slice(),this.__path.push(this.__name))}getPath(){return this.__path}setFlag(t){this.__flags|=t}clearFlag(t){this.__flags&=~t}testFlag(t){return 0!=(this.__flags&t)}resolvePath(t,e){if(e==t.length)return this;if(">"==t[e]&&e==t.length-1)return this.getParameter(t[e+1]);const i=this.getParameter(t[e]);if(i)return i;throw new Error("Invalid path:"+t+" member not found")}getOwner(){return this.__ownerItem}setOwner(t){this.__ownerItem!==t&&(this.__ownerItem=t,this.__updatePath())}getSelectable(){return this.__selectable}setSelectable(t){return this.__selectable!=t&&(this.__selectable=t,!0)}isSelected(){return this.__selected}getSelected(){return this.__selected}setSelected(t){this.__selected=t,this.selectedChanged.emit(this.__selected)}getMetadata(t){return this.__metaData[t]}hasMetadata(t){return t in this.__metaData}setMetadata(t,e){this.__metaData[t]=e}deleteMetadata(t){delete this.__metaData[t]}toJSON(t,e){let i=super.toJSON(t,e);return!i&&this.testFlag($$1.USER_EDITED)&&(i={}),i&&(i.name=this.__name,this.testFlag($$1.BIN_NODE)||(i.type=J$1.getClassName(this))),i}fromJSON(t,e,i){t.name&&(this.__name=t.name),super.fromJSON(t,e,i),this.__flags|=$$1.USER_EDITED}readBinary(t,e){t.loadStr(),this.setName(t.loadStr()),super.readBinary(t,e)}clone(t){throw new Error(this.constructor.name+" does not implment its clone method")}copyFrom(t,e){super.copyFrom(t,e),this.setName(t.getName())}destroy(){super.destroy()}}const ae$1=function(t){return t.substring(0,t.lastIndexOf("/"))+"/"},ie$1=function(t,e,i,n){const s=new XMLHttpRequest;s.responseType=e;try{s.addEventListener("timeout",(function(){throw new Error("The request for "+t+" timed out.")})),s.addEventListener("error",(function(){throw new Error("The request for "+t+": xhr.readyState:"+s.readyState)})),s.addEventListener("abort",(function(){throw new Error("The request for "+t+": xhr.readyState:"+s.readyState)})),s.addEventListener("loadend",(function(){200==s.status?i(s):n(s.statusText)})),s.open("GET",t,!0),s.send()}catch(t){n(t)}},se$1=function(t,e,i){ie$1(t,"text",t=>{e(t.responseText)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},ne$1=function(t,e,i){ie$1(t,"json",t=>{e(t.response,t)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},le$1=function(t,e,i){ie$1(t,"document",t=>{e(t.responseXML)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},re$2=function(t,e,i){ie$1(t,"arraybuffer",t=>{e(t.response)},e=>{if(null==i)throw new Error("Unable to XHR File:"+t);i(e)})},oe$1="[object process]"===Object.prototype.toString.call(void 0!==process_1?process_1:0),de$1=oe$1&&"function"==typeof module.require?module.require:null;function he$1(t,e=null,i=!1){const n=oe$1?function(t,e){return Buffer.from(t,"base64").toString(e?"utf16":"utf8")}(t,i):function(t,e){const i=atob(t);if(e){const t=new Uint8Array(i.length);return Array.prototype.forEach.call(t,(t,e,n)=>{n[e]=i.charCodeAt(e)}),String.fromCharCode.apply(null,new Uint16Array(t.buffer))}return i}(t,i),s=n.indexOf("\n",10)+1,o=n.substring(s)+(e?"//# sourceMappingURL="+e:"");if(de$1){const t=de$1("worker_threads").Worker;return function(e){return new t(o,Object.assign({},e,{eval:!0}))}}const r=new Blob([o],{type:"application/javascript"}),a=URL.createObjectURL(r);return function(t){return new Worker(a,t)}}var ce$1=he$1("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpNb2R1bGU9e0VOVklST05NRU5UOiJXT1JLRVIifTtjb25zdCBlPXt9O3ZhciB0Oyh0PWUpLnVucGFja0JyaWRnZT1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQ9e307ZnVuY3Rpb24gcihuKXtpZih0W25dKXJldHVybiB0W25dLmV4cG9ydHM7dmFyIG89dFtuXT17aTpuLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIGVbbl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsciksby5sPSEwLG8uZXhwb3J0c31yZXR1cm4gci5tPWUsci5jPXQsci5kPWZ1bmN0aW9uKGUsdCxuKXtyLm8oZSx0KXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7ZW51bWVyYWJsZTohMCxnZXQ6bn0pfSxyLnI9ZnVuY3Rpb24oZSl7InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZToiTW9kdWxlIn0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KX0sci50PWZ1bmN0aW9uKGUsdCl7aWYoMSZ0JiYoZT1yKGUpKSw4JnQpcmV0dXJuIGU7aWYoNCZ0JiYib2JqZWN0Ij09dHlwZW9mIGUmJmUmJmUuX19lc01vZHVsZSlyZXR1cm4gZTt2YXIgbj1PYmplY3QuY3JlYXRlKG51bGwpO2lmKHIucihuKSxPYmplY3QuZGVmaW5lUHJvcGVydHkobiwiZGVmYXVsdCIse2VudW1lcmFibGU6ITAsdmFsdWU6ZX0pLDImdCYmInN0cmluZyIhPXR5cGVvZiBlKWZvcih2YXIgbyBpbiBlKXIuZChuLG8sZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19LmJpbmQobnVsbCxvKSk7cmV0dXJuIG59LHIubj1mdW5jdGlvbihlKXt2YXIgdD1lJiZlLl9fZXNNb2R1bGU/ZnVuY3Rpb24oKXtyZXR1cm4gZS5kZWZhdWx0fTpmdW5jdGlvbigpe3JldHVybiBlfTtyZXR1cm4gci5kKHQsImEiLHQpLHR9LHIubz1mdW5jdGlvbihlLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KX0sci5wPSIiLHIoci5zPTIpfShbZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTtjb25zdCBvPXIoMSksaT17MDoiRVJBUl9TVUNDRVNTIiwxMDoiRVJBUl9FTkRfQVJDSElWRSIsMTE6IkVSQVJfTk9fTUVNT1JZIiwxMjoiRVJBUl9CQURfREFUQSIsMTM6IkVSQVJfQkFEX0FSQ0hJVkUiLDE0OiJFUkFSX1VOS05PV05fRk9STUFUIiwxNToiRVJBUl9FT1BFTiIsMTY6IkVSQVJfRUNSRUFURSIsMTc6IkVSQVJfRUNMT1NFIiwxODoiRVJBUl9FUkVBRCIsMTk6IkVSQVJfRVdSSVRFIiwyMDoiRVJBUl9TTUFMTF9CVUYiLDIxOiJFUkFSX1VOS05PV04iLDIyOiJFUkFSX01JU1NJTkdfUEFTU1dPUkQiLDIzOiJFUkFSX0VSRUZFUkVOQ0UiLDI0OiJFUkFSX0JBRF9QQVNTV09SRCJ9LGE9ezA6IlN1Y2Nlc3MiLDExOiJOb3QgZW5vdWdoIG1lbW9yeSIsMTI6IkFyY2hpdmUgaGVhZGVyIG9yIGRhdGEgYXJlIGRhbWFnZWQiLDEzOiJGaWxlIGlzIG5vdCBSQVIgYXJjaGl2ZSIsMTQ6IlVua25vd24gYXJjaGl2ZSBmb3JtYXQiLDE1OiJGaWxlIG9wZW4gZXJyb3IiLDE2OiJGaWxlIGNyZWF0ZSBlcnJvciIsMTc6IkZpbGUgY2xvc2UgZXJyb3IiLDE4OiJGaWxlIHJlYWQgZXJyb3IiLDE5OiJGaWxlIHdyaXRlIGVycm9yIiwyMDoiQnVmZmVyIGZvciBhcmNoaXZlIGNvbW1lbnQgaXMgdG9vIHNtYWxsLCBjb21tZW50IHRydW5jYXRlZCIsMjE6IlVua25vd24gZXJyb3IiLDIyOiJQYXNzd29yZCBmb3IgZW5jcnlwdGVkIGZpbGUgb3IgaGVhZGVyIGlzIG5vdCBzcGVjaWZpZWQiLDIzOiJDYW5ub3Qgb3BlbiBmaWxlIHNvdXJjZSBmb3IgcmVmZXJlbmNlIHJlY29yZCIsMjQ6Ildyb25nIHBhc3N3b3JkIGlzIHNwZWNpZmllZCJ9O2NsYXNzIHN7Y29uc3RydWN0b3IoZT0iIil7dGhpcy5fcGFzc3dvcmQ9ZSx0aGlzLl9hcmNoaXZlPW51bGx9Z2V0RmlsZUxpc3QoKXtsZXQgZSxbdCxyXT10aGlzLm9wZW5BcmMoITApO2lmKCJTVUNDRVNTIiE9PXQuc3RhdGUpZT1bdCxudWxsXTtlbHNle2xldCB0LG4sbz1bXTtmb3IoO1t0LG5dPXRoaXMucHJvY2Vzc05leHRGaWxlKCgpPT4hMCksIlNVQ0NFU1MiPT09dC5zdGF0ZTspby5wdXNoKG4uZmlsZUhlYWRlcik7ZT0iRVJBUl9FTkRfQVJDSElWRSIhPT10LnJlYXNvbj9bdCxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2FyY0hlYWRlcjpyLGZpbGVIZWFkZXJzOm99XX1yZXR1cm4gdGhpcy5jbG9zZUFyYygpLGV9ZXh0cmFjdEFsbCgpe2xldCBlLFt0LHJdPXRoaXMub3BlbkFyYyghMSk7aWYoIlNVQ0NFU1MiIT09dC5zdGF0ZSllPVt0LG51bGxdO2Vsc2V7bGV0IHQsbixvPVtdO2Zvcig7W3Qsbl09dGhpcy5wcm9jZXNzTmV4dEZpbGUoKCk9PiExKSwiU1VDQ0VTUyI9PT10LnN0YXRlOylvLnB1c2gobik7ZT0iRVJBUl9FTkRfQVJDSElWRSIhPT10LnJlYXNvbj9bdCxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2FyY0hlYWRlcjpyLGZpbGVzOm99XX1yZXR1cm4gdGhpcy5jbG9zZUFyYygpLGV9ZXh0cmFjdEZpbGVzKGUsdCl7bGV0IHIsW24sb109dGhpcy5vcGVuQXJjKCExLHQpLGk9e307Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDsrK3QpaVtlW3RdXT10O2lmKCJTVUNDRVNTIiE9PW4uc3RhdGUpcj1bbixudWxsXTtlbHNle2xldCB0LG4sYT1BcnJheShlLmxlbmd0aCkuZmlsbChudWxsKSxzPTA7Zm9yKDs7KXtsZXQgcj0hMSxvPW51bGw7aWYoW3Qsbl09dGhpcy5wcm9jZXNzTmV4dEZpbGUoZT0+ZSBpbiBpPyhvPWlbZV0sITEpOihyPSEwLCEwKSksIlNVQ0NFU1MiIT09dC5zdGF0ZSlicmVhaztpZighciYmKGFbb109biwrK3M9PT1lLmxlbmd0aCkpe3QucmVhc29uPSJFUkFSX0VORF9BUkNISVZFIjticmVha319cj0iRVJBUl9FTkRfQVJDSElWRSIhPT10LnJlYXNvbj9bdCxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2FyY0hlYWRlcjpvLGZpbGVzOmF9XX1yZXR1cm4gdGhpcy5jbG9zZUFyYygpLHJ9ZmlsZUNyZWF0ZWQoZSl7fWNsb3NlKGUpe3RoaXMuX2xhc3RGaWxlQ29udGVudD10aGlzLmNsb3NlRmlsZShlKX1vcGVuQXJjKGUsdCl7by5FeHQuY3VycmVudD10aGlzLHRoaXMuX2FyY2hpdmU9bmV3IG4uUmFyQXJjaGl2ZTtsZXQgcixpPXRoaXMuX2FyY2hpdmUub3Blbih0aGlzLl9maWxlUGF0aCx0fHx0aGlzLl9wYXNzd29yZCxlKTtyZXR1cm4gcj0wIT09aS5zdGF0ZS5lcnJDb2RlP1t0aGlzLmdldEZhaWxJbmZvKGkuc3RhdGUuZXJyQ29kZSxpLnN0YXRlLmVyclR5cGUpLG51bGxdOlt7c3RhdGU6IlNVQ0NFU1MifSx7Y29tbWVudDppLmNvbW1lbnQsZmxhZ3M6e3ZvbHVtZTowIT0oMSZpLmZsYWdzKSxsb2NrOjAhPSg0JmkuZmxhZ3MpLHNvbGlkOjAhPSg4JmkuZmxhZ3MpLGF1dGhJbmZvOjAhPSgzMiZpLmZsYWdzKSxyZWNvdmVyeVJlY29yZDowIT0oNjQmaS5mbGFncyksaGVhZGVyRW5jcnlwdGVkOjAhPSgxMjgmaS5mbGFncyl9fV0sby5FeHQuY3VycmVudD1udWxsLHJ9cHJvY2Vzc05leHRGaWxlKGUpe2xldCB0O28uRXh0LmN1cnJlbnQ9dGhpcztsZXQgcj10aGlzLl9hcmNoaXZlLmdldEZpbGVIZWFkZXIoKSxuPVt7c3RhdGU6IlNVQ0NFU1MifSxudWxsXTtpZigwPT09ci5zdGF0ZS5lcnJDb2RlKXtsZXQgdD1lKHIubmFtZSk7dGhpcy5fbGFzdEZpbGVDb250ZW50PW51bGw7bGV0IG89dGhpcy5fYXJjaGl2ZS5yZWFkRmlsZSh0KTswPT09by5lcnJDb2RlfHx0fHwoblswXT10aGlzLmdldEZhaWxJbmZvKG8uZXJyQ29kZSxvLmVyclR5cGUpLDIyPT09by5lcnJDb2RlP289dGhpcy5fYXJjaGl2ZS5yZWFkRmlsZSghMCk6by5lcnJDb2RlPTApLDA9PT1vLmVyckNvZGU/blsxXT10aGlzLl9sYXN0RmlsZUNvbnRlbnQ6KHIuc3RhdGUuZXJyQ29kZT1vLmVyckNvZGUsci5zdGF0ZS5lcnJUeXBlPW8uZXJyVHlwZSksdGhpcy5fbGFzdEZpbGVDb250ZW50PW51bGx9cmV0dXJuIHQ9MCE9PXIuc3RhdGUuZXJyQ29kZT9bdGhpcy5nZXRGYWlsSW5mbyhyLnN0YXRlLmVyckNvZGUsci5zdGF0ZS5lcnJUeXBlKSxudWxsXTpbe3N0YXRlOiJTVUNDRVNTIn0se2ZpbGVIZWFkZXI6e25hbWU6ci5uYW1lLGZsYWdzOntlbmNyeXB0ZWQ6MCE9KDQmci5mbGFncyksc29saWQ6MCE9KDE2JnIuZmxhZ3MpLGRpcmVjdG9yeTowIT0oMzImci5mbGFncyl9LHBhY2tTaXplOnIucGFja1NpemUsdW5wU2l6ZTpyLnVucFNpemUsY3JjOnIuY3JjLHRpbWU6ZnVuY3Rpb24oZSl7Y29uc3QgdD1bNSw2LDUsNSw0LDddO2xldCByPVtdO2ZvcihsZXQgbiBvZiB0KXIucHVzaChlJigxPDxuKS0xKSxlPj49bjtsZXQgbj1lPT5lPDEwPyIwIitlOiIiK2U7cmV0dXJuYCR7MTk4MCsocj1yLnJldmVyc2UoKSlbMF19LSR7bihyWzFdKX0tJHtuKHJbMl0pfVQke24oclszXSl9OiR7bihyWzRdKX06JHtuKDIqcls1XSl9LjAwMGB9KHIudGltZSksdW5wVmVyOmAke01hdGguZmxvb3Ioci51bnBWZXIvMTApfS4ke3IudW5wVmVyJTEwfWAsbWV0aG9kOmZ1bmN0aW9uKGUpe3JldHVybns0ODoiU3RvcmluZyIsNDk6IkZhc3Rlc3QiLDUwOiJGYXN0Iiw1MToiTm9ybWFsIiw1MjoiR29vZCIsNTM6IkJlc3QifVtlXXx8IlVua25vd24ifShyLm1ldGhvZCl9LGV4dHJhY3Q6bn1dLG8uRXh0LmN1cnJlbnQ9bnVsbCx0fWNsb3NlQXJjKCl7by5FeHQuY3VycmVudD10aGlzLHRoaXMuX2FyY2hpdmUuZGVsZXRlKCksby5FeHQuY3VycmVudD1udWxsLHRoaXMuX2FyY2hpdmU9bnVsbH1nZXRGYWlsSW5mbyhlLHQpe3JldHVybntzdGF0ZToiRkFJTCIscmVhc29uOmlbZV0sbXNnOmFbZV19fX1zLl9jdXJyZW50PW51bGwsdC5FeHRyYWN0b3I9c30sZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0LkV4dD17Y3VycmVudDpudWxsfX0sZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSxmdW5jdGlvbihlKXtmb3IodmFyIHIgaW4gZSl0Lmhhc093blByb3BlcnR5KHIpfHwodFtyXT1lW3JdKX0ocigzKSk7dmFyIG49cigxKTt0LkV4dD1uLkV4dH0sZnVuY3Rpb24oZSx0LHIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTtjb25zdCBuPXIoNCksbz1yKDYpO3QuY3JlYXRlRXh0cmFjdG9yRnJvbURhdGE9ZnVuY3Rpb24oZSx0PSIiKXtyZXR1cm4gbmV3IG4uRGF0YUV4dHJhY3RvcihlLHQpfSx0LmNyZWF0ZUV4dHJhY3RvckZyb21GaWxlPWZ1bmN0aW9uKGUsdD0iIixyPSIiKXtyZXR1cm4gbmV3IG8uRmlsZUV4dHJhY3RvcihlLHQscil9fSxmdW5jdGlvbihlLHQscil7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO2NvbnN0IG89cig1KSxpPXIoMCk7dC5EYXRhRXh0cmFjdG9yPWNsYXNzIGV4dGVuZHMgaS5FeHRyYWN0b3J7Y29uc3RydWN0b3IoZSx0KXtzdXBlcih0KSx0aGlzLmRhdGFGaWxlcz17fSx0aGlzLmRhdGFGaWxlTWFwPXt9LHRoaXMuY3VycmVudEZkPTE7bGV0IHI9e2ZpbGU6bmV3IG8uRGF0YUZpbGUobmV3IFVpbnQ4QXJyYXkoZSkpLGZkOnRoaXMuY3VycmVudEZkKyt9O3RoaXMuX2ZpbGVQYXRoPSJfZGVmYXVsdFVucmFySlNfLnJhciIsdGhpcy5kYXRhRmlsZXNbdGhpcy5fZmlsZVBhdGhdPXIsdGhpcy5kYXRhRmlsZU1hcFtyLmZkXT10aGlzLl9maWxlUGF0aH1vcGVuKGUpe2xldCB0PXRoaXMuZGF0YUZpbGVzW2VdO3JldHVybiB0P3QuZmQ6MH1jcmVhdGUoZSl7bGV0IHQ9dGhpcy5jdXJyZW50RmQrKztyZXR1cm4gdGhpcy5kYXRhRmlsZXNbZV09e2ZpbGU6bmV3IG8uRGF0YUZpbGUsZmQ6dGhpcy5jdXJyZW50RmQrK30sdGhpcy5kYXRhRmlsZU1hcFt0XT1lLHR9Y2xvc2VGaWxlKGUpe2xldCB0PXRoaXMuZGF0YUZpbGVzW3RoaXMuZGF0YUZpbGVNYXBbZV1dO2lmKCF0KXJldHVybiBudWxsO2xldCByPXQuZmlsZS5yZWFkQWxsKCk7cmV0dXJuIDEhPT1lPyhkZWxldGUgdGhpcy5kYXRhRmlsZXNbdGhpcy5kYXRhRmlsZU1hcFtlXV0sZGVsZXRlIHRoaXMuZGF0YUZpbGVNYXBbZV0pOnQuZmlsZS5zZWVrKDAsIlNFVCIpLHJ9cmVhZChlLHQscil7bGV0IG89dGhpcy5kYXRhRmlsZXNbdGhpcy5kYXRhRmlsZU1hcFtlXV07aWYoIW8pcmV0dXJuLTE7bGV0IGk9by5maWxlLnJlYWQocik7cmV0dXJuIG51bGw9PT1pPy0xOihuLkhFQVBVOC5zZXQoaSx0KSxpLmJ5dGVMZW5ndGgpfXdyaXRlKGUsdCxyKXtsZXQgbz10aGlzLmRhdGFGaWxlc1t0aGlzLmRhdGFGaWxlTWFwW2VdXTtyZXR1cm4hIW8mJihvLmZpbGUud3JpdGUobi5IRUFQVTguc2xpY2UodCx0K3IpKSwhMCl9dGVsbChlKXtsZXQgdD10aGlzLmRhdGFGaWxlc1t0aGlzLmRhdGFGaWxlTWFwW2VdXTtyZXR1cm4gdD90LmZpbGUudGVsbCgpOi0xfXNlZWsoZSx0LHIpe2xldCBuPXRoaXMuZGF0YUZpbGVzW3RoaXMuZGF0YUZpbGVNYXBbZV1dO3JldHVybiEhbiYmbi5maWxlLnNlZWsodCxyKX19fSxmdW5jdGlvbihlLHQscil7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHQuRGF0YUZpbGU9Y2xhc3N7Y29uc3RydWN0b3IoZSl7dGhpcy5idWZmZXJzPVtdLHRoaXMucG9zPTAsdGhpcy5zaXplPTAsZSYmKHRoaXMuYnVmZmVycy5wdXNoKGUpLHRoaXMuc2l6ZT1lLmJ5dGVMZW5ndGgsdGhpcy5wb3M9MCl9cmVhZChlKXtpZih0aGlzLmZsYXR0ZW4oKSxlK3RoaXMucG9zPnRoaXMuc2l6ZSlyZXR1cm4gbnVsbDtsZXQgdD10aGlzLnBvcztyZXR1cm4gdGhpcy5wb3MrPWUsdGhpcy5idWZmZXJzWzBdLnNsaWNlKHQsdGhpcy5wb3MpfXJlYWRBbGwoKXtyZXR1cm4gdGhpcy5mbGF0dGVuKCksdGhpcy5idWZmZXJzWzBdfXdyaXRlKGUpe3JldHVybiB0aGlzLmJ1ZmZlcnMucHVzaChlKSx0aGlzLnNpemUrPWUuYnl0ZUxlbmd0aCx0aGlzLnBvcys9ZS5ieXRlTGVuZ3RoLCEwfXRlbGwoKXtyZXR1cm4gdGhpcy5wb3N9c2VlayhlLHQpe2xldCByPXRoaXMucG9zO3JldHVybiJTRVQiPT09dD9yPWU6IkNVUiI9PT10P3IrPWU6cj10aGlzLnNpemUtZSwhKHI8MHx8cj50aGlzLnNpemV8fCh0aGlzLnBvcz1yLDApKX1mbGF0dGVuKCl7aWYodGhpcy5idWZmZXJzLmxlbmd0aDw9MSlyZXR1cm47bGV0IGU9bmV3IFVpbnQ4QXJyYXkodGhpcy5zaXplKSx0PTA7Zm9yKGxldCByIG9mIHRoaXMuYnVmZmVycyllLnNldChyLHQpLHQrPXIuYnl0ZUxlbmd0aDt0aGlzLmJ1ZmZlcnM9W2VdfX19LGZ1bmN0aW9uKGUsdCxyKXsoZnVuY3Rpb24oZSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pO2NvbnN0IG89cigxMiksaT1yKDEzKSxhPXIoMCk7dC5GaWxlRXh0cmFjdG9yPWNsYXNzIGV4dGVuZHMgYS5FeHRyYWN0b3J7Y29uc3RydWN0b3IoZSx0LHIpe3N1cGVyKHIpLHRoaXMuX2ZpbGVQYXRoPWUsdGhpcy5maWxlTWFwPXt9LHRoaXMuX3RhcmdldD10fW9wZW4oZSl7bGV0IHQ9by5vcGVuU3luYyhlLCJyIik7cmV0dXJuIHRoaXMuZmlsZU1hcFt0XT17c2l6ZTpvLmZzdGF0U3luYyh0KS5zaXplLHBvczowLG5hbWU6ZX0sdH1jcmVhdGUoZSl7bGV0IHQ9aS5qb2luKHRoaXMuX3RhcmdldCxlKTtpLnBhcnNlKHQpLmRpci5zcGxpdCgiLyIpLnJlZHVjZSgoZSx0KT0+KGUrPXQrIi8iLG8uZXhpc3RzU3luYyhlKXx8by5ta2RpclN5bmMoZSksZSksIiIpO2xldCByPW8ub3BlblN5bmModCwidyIpO3JldHVybiB0aGlzLmZpbGVNYXBbcl09e3NpemU6MCxwb3M6MCxuYW1lOmV9LHJ9Y2xvc2VGaWxlKGUpe3JldHVybiBkZWxldGUgdGhpcy5maWxlTWFwW2VdLG8uY2xvc2VTeW5jKGUpLG51bGx9cmVhZCh0LHIsaSl7bGV0IGE9dGhpcy5maWxlTWFwW3RdLHM9bmV3IGUoaSksdT1vLnJlYWRTeW5jKHQscywwLGksYS5wb3MpO3JldHVybiBuLkhFQVBVOC5zZXQocyxyKSxhLnBvcys9dSx1fXdyaXRlKHQscixpKXtsZXQgYT10aGlzLmZpbGVNYXBbdF0scz1vLndyaXRlU3luYyh0LG5ldyBlKG4uSEVBUFU4LnN1YmFycmF5KHIscitpKSksMCxpKTtyZXR1cm4gYS5wb3MrPXMsYS5zaXplKz1zLHM9PT1pfXRlbGwoZSl7cmV0dXJuIHRoaXMuZmlsZU1hcFtlXS5wb3N9c2VlayhlLHQscil7bGV0IG49dGhpcy5maWxlTWFwW2VdLG89bi5wb3M7cmV0dXJuIlNFVCI9PT1yP289MDoiRU5EIj09PXImJihvPW4uc2l6ZSksISgobys9dCk8MHx8bz5uLnNpemV8fChuLnBvcz1vLDApKX19fSkuY2FsbCh0aGlzLHIoNykuQnVmZmVyKX0sZnVuY3Rpb24oZSx0LHIpeyhmdW5jdGlvbihlKXsKLyohCiAqIFRoZSBidWZmZXIgbW9kdWxlIGZyb20gbm9kZS5qcywgZm9yIHRoZSBicm93c2VyLgogKgogKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8ZmVyb3NzQGZlcm9zcy5vcmc+IDxodHRwOi8vZmVyb3NzLm9yZz4KICogQGxpY2Vuc2UgIE1JVAogKi8KdmFyIG49cig5KSxvPXIoMTApLGk9cigxMSk7ZnVuY3Rpb24gYSgpe3JldHVybiB1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/MjE0NzQ4MzY0NzoxMDczNzQxODIzfWZ1bmN0aW9uIHMoZSx0KXtpZihhKCk8dCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiSW52YWxpZCB0eXBlZCBhcnJheSBsZW5ndGgiKTtyZXR1cm4gdS5UWVBFRF9BUlJBWV9TVVBQT1JUPyhlPW5ldyBVaW50OEFycmF5KHQpKS5fX3Byb3RvX189dS5wcm90b3R5cGU6KG51bGw9PT1lJiYoZT1uZXcgdSh0KSksZS5sZW5ndGg9dCksZX1mdW5jdGlvbiB1KGUsdCxyKXtpZighKHUuVFlQRURfQVJSQVlfU1VQUE9SVHx8dGhpcyBpbnN0YW5jZW9mIHUpKXJldHVybiBuZXcgdShlLHQscik7aWYoIm51bWJlciI9PXR5cGVvZiBlKXtpZigic3RyaW5nIj09dHlwZW9mIHQpdGhyb3cgbmV3IEVycm9yKCJJZiBlbmNvZGluZyBpcyBzcGVjaWZpZWQgdGhlbiB0aGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZyIpO3JldHVybiBmKHRoaXMsZSl9cmV0dXJuIGModGhpcyxlLHQscil9ZnVuY3Rpb24gYyhlLHQscixuKXtpZigibnVtYmVyIj09dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcignInZhbHVlIiBhcmd1bWVudCBtdXN0IG5vdCBiZSBhIG51bWJlcicpO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgQXJyYXlCdWZmZXImJnQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9mdW5jdGlvbihlLHQscixuKXtpZih0LmJ5dGVMZW5ndGgscjwwfHx0LmJ5dGVMZW5ndGg8cil0aHJvdyBuZXcgUmFuZ2VFcnJvcigiJ29mZnNldCcgaXMgb3V0IG9mIGJvdW5kcyIpO2lmKHQuYnl0ZUxlbmd0aDxyKyhufHwwKSl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiJ2xlbmd0aCcgaXMgb3V0IG9mIGJvdW5kcyIpO3JldHVybiB0PXZvaWQgMD09PXImJnZvaWQgMD09PW4/bmV3IFVpbnQ4QXJyYXkodCk6dm9pZCAwPT09bj9uZXcgVWludDhBcnJheSh0LHIpOm5ldyBVaW50OEFycmF5KHQscixuKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KGU9dCkuX19wcm90b19fPXUucHJvdG90eXBlOmU9ZChlLHQpLGV9KGUsdCxyLG4pOiJzdHJpbmciPT10eXBlb2YgdD9mdW5jdGlvbihlLHQscil7aWYoInN0cmluZyI9PXR5cGVvZiByJiYiIiE9PXJ8fChyPSJ1dGY4IiksIXUuaXNFbmNvZGluZyhyKSl0aHJvdyBuZXcgVHlwZUVycm9yKCciZW5jb2RpbmciIG11c3QgYmUgYSB2YWxpZCBzdHJpbmcgZW5jb2RpbmcnKTt2YXIgbj0wfHAodCxyKSxvPShlPXMoZSxuKSkud3JpdGUodCxyKTtyZXR1cm4gbyE9PW4mJihlPWUuc2xpY2UoMCxvKSksZX0oZSx0LHIpOmZ1bmN0aW9uKGUsdCl7aWYodS5pc0J1ZmZlcih0KSl7dmFyIHI9MHxoKHQubGVuZ3RoKTtyZXR1cm4gMD09PShlPXMoZSxyKSkubGVuZ3RofHx0LmNvcHkoZSwwLDAsciksZX1pZih0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiZ0LmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyfHwibGVuZ3RoImluIHQpcmV0dXJuIm51bWJlciIhPXR5cGVvZiB0Lmxlbmd0aHx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUhPWV9KHQubGVuZ3RoKT9zKGUsMCk6ZChlLHQpO2lmKCJCdWZmZXIiPT09dC50eXBlJiZpKHQuZGF0YSkpcmV0dXJuIGQoZSx0LmRhdGEpfXRocm93IG5ldyBUeXBlRXJyb3IoIkZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcsIEJ1ZmZlciwgQXJyYXlCdWZmZXIsIEFycmF5LCBvciBhcnJheS1saWtlIG9iamVjdC4iKX0oZSx0KX1mdW5jdGlvbiBsKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSl0aHJvdyBuZXcgVHlwZUVycm9yKCcic2l6ZSIgYXJndW1lbnQgbXVzdCBiZSBhIG51bWJlcicpO2lmKGU8MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcignInNpemUiIGFyZ3VtZW50IG11c3Qgbm90IGJlIG5lZ2F0aXZlJyl9ZnVuY3Rpb24gZihlLHQpe2lmKGwodCksZT1zKGUsdDwwPzA6MHxoKHQpKSwhdS5UWVBFRF9BUlJBWV9TVVBQT1JUKWZvcih2YXIgcj0wO3I8dDsrK3IpZVtyXT0wO3JldHVybiBlfWZ1bmN0aW9uIGQoZSx0KXt2YXIgcj10Lmxlbmd0aDwwPzA6MHxoKHQubGVuZ3RoKTtlPXMoZSxyKTtmb3IodmFyIG49MDtuPHI7bis9MSllW25dPTI1NSZ0W25dO3JldHVybiBlfWZ1bmN0aW9uIGgoZSl7aWYoZT49YSgpKXRocm93IG5ldyBSYW5nZUVycm9yKCJBdHRlbXB0IHRvIGFsbG9jYXRlIEJ1ZmZlciBsYXJnZXIgdGhhbiBtYXhpbXVtIHNpemU6IDB4IithKCkudG9TdHJpbmcoMTYpKyIgYnl0ZXMiKTtyZXR1cm4gMHxlfWZ1bmN0aW9uIHAoZSx0KXtpZih1LmlzQnVmZmVyKGUpKXJldHVybiBlLmxlbmd0aDtpZigidW5kZWZpbmVkIiE9dHlwZW9mIEFycmF5QnVmZmVyJiYiZnVuY3Rpb24iPT10eXBlb2YgQXJyYXlCdWZmZXIuaXNWaWV3JiYoQXJyYXlCdWZmZXIuaXNWaWV3KGUpfHxlIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpKXJldHVybiBlLmJ5dGVMZW5ndGg7InN0cmluZyIhPXR5cGVvZiBlJiYoZT0iIitlKTt2YXIgcj1lLmxlbmd0aDtpZigwPT09cilyZXR1cm4gMDtmb3IodmFyIG49ITE7Oylzd2l0Y2godCl7Y2FzZSJhc2NpaSI6Y2FzZSJsYXRpbjEiOmNhc2UiYmluYXJ5IjpyZXR1cm4gcjtjYXNlInV0ZjgiOmNhc2UidXRmLTgiOmNhc2Ugdm9pZCAwOnJldHVybiBVKGUpLmxlbmd0aDtjYXNlInVjczIiOmNhc2UidWNzLTIiOmNhc2UidXRmMTZsZSI6Y2FzZSJ1dGYtMTZsZSI6cmV0dXJuIDIqcjtjYXNlImhleCI6cmV0dXJuIHI+Pj4xO2Nhc2UiYmFzZTY0IjpyZXR1cm4geihlKS5sZW5ndGg7ZGVmYXVsdDppZihuKXJldHVybiBVKGUpLmxlbmd0aDt0PSgiIit0KS50b0xvd2VyQ2FzZSgpLG49ITB9fWZ1bmN0aW9uIG0oZSx0LHIpe3ZhciBuPWVbdF07ZVt0XT1lW3JdLGVbcl09bn1mdW5jdGlvbiB5KGUsdCxyLG4sbyl7aWYoMD09PWUubGVuZ3RoKXJldHVybi0xO2lmKCJzdHJpbmciPT10eXBlb2Ygcj8obj1yLHI9MCk6cj4yMTQ3NDgzNjQ3P3I9MjE0NzQ4MzY0NzpyPC0yMTQ3NDgzNjQ4JiYocj0tMjE0NzQ4MzY0OCkscj0rcixpc05hTihyKSYmKHI9bz8wOmUubGVuZ3RoLTEpLHI8MCYmKHI9ZS5sZW5ndGgrcikscj49ZS5sZW5ndGgpe2lmKG8pcmV0dXJuLTE7cj1lLmxlbmd0aC0xfWVsc2UgaWYocjwwKXtpZighbylyZXR1cm4tMTtyPTB9aWYoInN0cmluZyI9PXR5cGVvZiB0JiYodD11LmZyb20odCxuKSksdS5pc0J1ZmZlcih0KSlyZXR1cm4gMD09PXQubGVuZ3RoPy0xOkUoZSx0LHIsbixvKTtpZigibnVtYmVyIj09dHlwZW9mIHQpcmV0dXJuIHQmPTI1NSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQmJiJmdW5jdGlvbiI9PXR5cGVvZiBVaW50OEFycmF5LnByb3RvdHlwZS5pbmRleE9mP28/VWludDhBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGUsdCxyKTpVaW50OEFycmF5LnByb3RvdHlwZS5sYXN0SW5kZXhPZi5jYWxsKGUsdCxyKTpFKGUsW3RdLHIsbixvKTt0aHJvdyBuZXcgVHlwZUVycm9yKCJ2YWwgbXVzdCBiZSBzdHJpbmcsIG51bWJlciBvciBCdWZmZXIiKX1mdW5jdGlvbiBFKGUsdCxyLG4sbyl7dmFyIGksYT0xLHM9ZS5sZW5ndGgsdT10Lmxlbmd0aDtpZih2b2lkIDAhPT1uJiYoInVjczIiPT09KG49U3RyaW5nKG4pLnRvTG93ZXJDYXNlKCkpfHwidWNzLTIiPT09bnx8InV0ZjE2bGUiPT09bnx8InV0Zi0xNmxlIj09PW4pKXtpZihlLmxlbmd0aDwyfHx0Lmxlbmd0aDwyKXJldHVybi0xO2E9MixzLz0yLHUvPTIsci89Mn1mdW5jdGlvbiBjKGUsdCl7cmV0dXJuIDE9PT1hP2VbdF06ZS5yZWFkVUludDE2QkUodCphKX1pZihvKXt2YXIgbD0tMTtmb3IoaT1yO2k8cztpKyspaWYoYyhlLGkpPT09Yyh0LC0xPT09bD8wOmktbCkpe2lmKC0xPT09bCYmKGw9aSksaS1sKzE9PT11KXJldHVybiBsKmF9ZWxzZS0xIT09bCYmKGktPWktbCksbD0tMX1lbHNlIGZvcihyK3U+cyYmKHI9cy11KSxpPXI7aT49MDtpLS0pe2Zvcih2YXIgZj0hMCxkPTA7ZDx1O2QrKylpZihjKGUsaStkKSE9PWModCxkKSl7Zj0hMTticmVha31pZihmKXJldHVybiBpfXJldHVybi0xfWZ1bmN0aW9uIGcoZSx0LHIsbil7cj1OdW1iZXIocil8fDA7dmFyIG89ZS5sZW5ndGgtcjtuPyhuPU51bWJlcihuKSk+byYmKG49byk6bj1vO3ZhciBpPXQubGVuZ3RoO2lmKGklMiE9MCl0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGhleCBzdHJpbmciKTtuPmkvMiYmKG49aS8yKTtmb3IodmFyIGE9MDthPG47KythKXt2YXIgcz1wYXJzZUludCh0LnN1YnN0cigyKmEsMiksMTYpO2lmKGlzTmFOKHMpKXJldHVybiBhO2VbcithXT1zfXJldHVybiBhfWZ1bmN0aW9uIHYoZSx0LHIsbil7cmV0dXJuICQoVSh0LGUubGVuZ3RoLXIpLGUscixuKX1mdW5jdGlvbiB3KGUsdCxyLG4pe3JldHVybiAkKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxyPTA7cjxlLmxlbmd0aDsrK3IpdC5wdXNoKDI1NSZlLmNoYXJDb2RlQXQocikpO3JldHVybiB0fSh0KSxlLHIsbil9ZnVuY3Rpb24gXyhlLHQscixuKXtyZXR1cm4gdyhlLHQscixuKX1mdW5jdGlvbiBiKGUsdCxyLG4pe3JldHVybiAkKHoodCksZSxyLG4pfWZ1bmN0aW9uIEEoZSx0LHIsbil7cmV0dXJuICQoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHIsbixvLGk9W10sYT0wO2E8ZS5sZW5ndGgmJiEoKHQtPTIpPDApOysrYSluPShyPWUuY2hhckNvZGVBdChhKSk+Pjgsbz1yJTI1NixpLnB1c2gobyksaS5wdXNoKG4pO3JldHVybiBpfSh0LGUubGVuZ3RoLXIpLGUscixuKX1mdW5jdGlvbiBUKGUsdCxyKXtyZXR1cm4gMD09PXQmJnI9PT1lLmxlbmd0aD9uLmZyb21CeXRlQXJyYXkoZSk6bi5mcm9tQnl0ZUFycmF5KGUuc2xpY2UodCxyKSl9ZnVuY3Rpb24gUyhlLHQscil7cj1NYXRoLm1pbihlLmxlbmd0aCxyKTtmb3IodmFyIG49W10sbz10O288cjspe3ZhciBpLGEscyx1LGM9ZVtvXSxsPW51bGwsZj1jPjIzOT80OmM+MjIzPzM6Yz4xOTE/MjoxO2lmKG8rZjw9cilzd2l0Y2goZil7Y2FzZSAxOmM8MTI4JiYobD1jKTticmVhaztjYXNlIDI6MTI4PT0oMTkyJihpPWVbbysxXSkpJiYodT0oMzEmYyk8PDZ8NjMmaSk+MTI3JiYobD11KTticmVhaztjYXNlIDM6aT1lW28rMV0sYT1lW28rMl0sMTI4PT0oMTkyJmkpJiYxMjg9PSgxOTImYSkmJih1PSgxNSZjKTw8MTJ8KDYzJmkpPDw2fDYzJmEpPjIwNDcmJih1PDU1Mjk2fHx1PjU3MzQzKSYmKGw9dSk7YnJlYWs7Y2FzZSA0Omk9ZVtvKzFdLGE9ZVtvKzJdLHM9ZVtvKzNdLDEyOD09KDE5MiZpKSYmMTI4PT0oMTkyJmEpJiYxMjg9PSgxOTImcykmJih1PSgxNSZjKTw8MTh8KDYzJmkpPDwxMnwoNjMmYSk8PDZ8NjMmcyk+NjU1MzUmJnU8MTExNDExMiYmKGw9dSl9bnVsbD09PWw/KGw9NjU1MzMsZj0xKTpsPjY1NTM1JiYobC09NjU1MzYsbi5wdXNoKGw+Pj4xMCYxMDIzfDU1Mjk2KSxsPTU2MzIwfDEwMjMmbCksbi5wdXNoKGwpLG8rPWZ9cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0PWUubGVuZ3RoO2lmKHQ8PWspcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLGUpO2Zvcih2YXIgcj0iIixuPTA7bjx0OylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZyxlLnNsaWNlKG4sbis9aykpO3JldHVybiByfShuKX10LkJ1ZmZlcj11LHQuU2xvd0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4rZSE9ZSYmKGU9MCksdS5hbGxvYygrZSl9LHQuSU5TUEVDVF9NQVhfQllURVM9NTAsdS5UWVBFRF9BUlJBWV9TVVBQT1JUPXZvaWQgMCE9PWUuVFlQRURfQVJSQVlfU1VQUE9SVD9lLlRZUEVEX0FSUkFZX1NVUFBPUlQ6ZnVuY3Rpb24oKXt0cnl7dmFyIGU9bmV3IFVpbnQ4QXJyYXkoMSk7cmV0dXJuIGUuX19wcm90b19fPXtfX3Byb3RvX186VWludDhBcnJheS5wcm90b3R5cGUsZm9vOmZ1bmN0aW9uKCl7cmV0dXJuIDQyfX0sNDI9PT1lLmZvbygpJiYiZnVuY3Rpb24iPT10eXBlb2YgZS5zdWJhcnJheSYmMD09PWUuc3ViYXJyYXkoMSwxKS5ieXRlTGVuZ3RofWNhdGNoKGUpe3JldHVybiExfX0oKSx0LmtNYXhMZW5ndGg9YSgpLHUucG9vbFNpemU9ODE5Mix1Ll9hdWdtZW50PWZ1bmN0aW9uKGUpe3JldHVybiBlLl9fcHJvdG9fXz11LnByb3RvdHlwZSxlfSx1LmZyb209ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBjKG51bGwsZSx0LHIpfSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQmJih1LnByb3RvdHlwZS5fX3Byb3RvX189VWludDhBcnJheS5wcm90b3R5cGUsdS5fX3Byb3RvX189VWludDhBcnJheSwidW5kZWZpbmVkIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnNwZWNpZXMmJnVbU3ltYm9sLnNwZWNpZXNdPT09dSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHUsU3ltYm9sLnNwZWNpZXMse3ZhbHVlOm51bGwsY29uZmlndXJhYmxlOiEwfSkpLHUuYWxsb2M9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBmdW5jdGlvbihlLHQscixuKXtyZXR1cm4gbCh0KSx0PD0wP3MoZSx0KTp2b2lkIDAhPT1yPyJzdHJpbmciPT10eXBlb2Ygbj9zKGUsdCkuZmlsbChyLG4pOnMoZSx0KS5maWxsKHIpOnMoZSx0KX0obnVsbCxlLHQscil9LHUuYWxsb2NVbnNhZmU9ZnVuY3Rpb24oZSl7cmV0dXJuIGYobnVsbCxlKX0sdS5hbGxvY1Vuc2FmZVNsb3c9ZnVuY3Rpb24oZSl7cmV0dXJuIGYobnVsbCxlKX0sdS5pc0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4hKG51bGw9PWV8fCFlLl9pc0J1ZmZlcil9LHUuY29tcGFyZT1mdW5jdGlvbihlLHQpe2lmKCF1LmlzQnVmZmVyKGUpfHwhdS5pc0J1ZmZlcih0KSl0aHJvdyBuZXcgVHlwZUVycm9yKCJBcmd1bWVudHMgbXVzdCBiZSBCdWZmZXJzIik7aWYoZT09PXQpcmV0dXJuIDA7Zm9yKHZhciByPWUubGVuZ3RoLG49dC5sZW5ndGgsbz0wLGk9TWF0aC5taW4ocixuKTtvPGk7KytvKWlmKGVbb10hPT10W29dKXtyPWVbb10sbj10W29dO2JyZWFrfXJldHVybiByPG4/LTE6bjxyPzE6MH0sdS5pc0VuY29kaW5nPWZ1bmN0aW9uKGUpe3N3aXRjaChTdHJpbmcoZSkudG9Mb3dlckNhc2UoKSl7Y2FzZSJoZXgiOmNhc2UidXRmOCI6Y2FzZSJ1dGYtOCI6Y2FzZSJhc2NpaSI6Y2FzZSJsYXRpbjEiOmNhc2UiYmluYXJ5IjpjYXNlImJhc2U2NCI6Y2FzZSJ1Y3MyIjpjYXNlInVjcy0yIjpjYXNlInV0ZjE2bGUiOmNhc2UidXRmLTE2bGUiOnJldHVybiEwO2RlZmF1bHQ6cmV0dXJuITF9fSx1LmNvbmNhdD1mdW5jdGlvbihlLHQpe2lmKCFpKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIHUuYWxsb2MoMCk7dmFyIHI7aWYodm9pZCAwPT09dClmb3IodD0wLHI9MDtyPGUubGVuZ3RoOysrcil0Kz1lW3JdLmxlbmd0aDt2YXIgbj11LmFsbG9jVW5zYWZlKHQpLG89MDtmb3Iocj0wO3I8ZS5sZW5ndGg7KytyKXt2YXIgYT1lW3JdO2lmKCF1LmlzQnVmZmVyKGEpKXRocm93IG5ldyBUeXBlRXJyb3IoJyJsaXN0IiBhcmd1bWVudCBtdXN0IGJlIGFuIEFycmF5IG9mIEJ1ZmZlcnMnKTthLmNvcHkobixvKSxvKz1hLmxlbmd0aH1yZXR1cm4gbn0sdS5ieXRlTGVuZ3RoPXAsdS5wcm90b3R5cGUuX2lzQnVmZmVyPSEwLHUucHJvdG90eXBlLnN3YXAxNj1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGUlMiE9MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDE2LWJpdHMiKTtmb3IodmFyIHQ9MDt0PGU7dCs9MiltKHRoaXMsdCx0KzEpO3JldHVybiB0aGlzfSx1LnByb3RvdHlwZS5zd2FwMzI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxlbmd0aDtpZihlJTQhPTApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkJ1ZmZlciBzaXplIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAzMi1iaXRzIik7Zm9yKHZhciB0PTA7dDxlO3QrPTQpbSh0aGlzLHQsdCszKSxtKHRoaXMsdCsxLHQrMik7cmV0dXJuIHRoaXN9LHUucHJvdG90eXBlLnN3YXA2ND1mdW5jdGlvbigpe3ZhciBlPXRoaXMubGVuZ3RoO2lmKGUlOCE9MCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQnVmZmVyIHNpemUgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDY0LWJpdHMiKTtmb3IodmFyIHQ9MDt0PGU7dCs9OCltKHRoaXMsdCx0KzcpLG0odGhpcyx0KzEsdCs2KSxtKHRoaXMsdCsyLHQrNSksbSh0aGlzLHQrMyx0KzQpO3JldHVybiB0aGlzfSx1LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBlPTB8dGhpcy5sZW5ndGg7cmV0dXJuIDA9PT1lPyIiOjA9PT1hcmd1bWVudHMubGVuZ3RoP1ModGhpcywwLGUpOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj0hMTtpZigodm9pZCAwPT09dHx8dDwwKSYmKHQ9MCksdD50aGlzLmxlbmd0aClyZXR1cm4iIjtpZigodm9pZCAwPT09cnx8cj50aGlzLmxlbmd0aCkmJihyPXRoaXMubGVuZ3RoKSxyPD0wKXJldHVybiIiO2lmKChyPj4+PTApPD0odD4+Pj0wKSlyZXR1cm4iIjtmb3IoZXx8KGU9InV0ZjgiKTs7KXN3aXRjaChlKXtjYXNlImhleCI6cmV0dXJuIFIodGhpcyx0LHIpO2Nhc2UidXRmOCI6Y2FzZSJ1dGYtOCI6cmV0dXJuIFModGhpcyx0LHIpO2Nhc2UiYXNjaWkiOnJldHVybiBQKHRoaXMsdCxyKTtjYXNlImxhdGluMSI6Y2FzZSJiaW5hcnkiOnJldHVybiBEKHRoaXMsdCxyKTtjYXNlImJhc2U2NCI6cmV0dXJuIFQodGhpcyx0LHIpO2Nhc2UidWNzMiI6Y2FzZSJ1Y3MtMiI6Y2FzZSJ1dGYxNmxlIjpjYXNlInV0Zi0xNmxlIjpyZXR1cm4gTyh0aGlzLHQscik7ZGVmYXVsdDppZihuKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrZSk7ZT0oZSsiIikudG9Mb3dlckNhc2UoKSxuPSEwfX0uYXBwbHkodGhpcyxhcmd1bWVudHMpfSx1LnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7aWYoIXUuaXNCdWZmZXIoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciIpO3JldHVybiB0aGlzPT09ZXx8MD09PXUuY29tcGFyZSh0aGlzLGUpfSx1LnByb3RvdHlwZS5pbnNwZWN0PWZ1bmN0aW9uKCl7dmFyIGU9IiIscj10LklOU1BFQ1RfTUFYX0JZVEVTO3JldHVybiB0aGlzLmxlbmd0aD4wJiYoZT10aGlzLnRvU3RyaW5nKCJoZXgiLDAscikubWF0Y2goLy57Mn0vZykuam9pbigiICIpLHRoaXMubGVuZ3RoPnImJihlKz0iIC4uLiAiKSksIjxCdWZmZXIgIitlKyI+In0sdS5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbihlLHQscixuLG8pe2lmKCF1LmlzQnVmZmVyKGUpKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50IG11c3QgYmUgYSBCdWZmZXIiKTtpZih2b2lkIDA9PT10JiYodD0wKSx2b2lkIDA9PT1yJiYocj1lP2UubGVuZ3RoOjApLHZvaWQgMD09PW4mJihuPTApLHZvaWQgMD09PW8mJihvPXRoaXMubGVuZ3RoKSx0PDB8fHI+ZS5sZW5ndGh8fG48MHx8bz50aGlzLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigib3V0IG9mIHJhbmdlIGluZGV4Iik7aWYobj49byYmdD49cilyZXR1cm4gMDtpZihuPj1vKXJldHVybi0xO2lmKHQ+PXIpcmV0dXJuIDE7aWYodGhpcz09PWUpcmV0dXJuIDA7Zm9yKHZhciBpPShvPj4+PTApLShuPj4+PTApLGE9KHI+Pj49MCktKHQ+Pj49MCkscz1NYXRoLm1pbihpLGEpLGM9dGhpcy5zbGljZShuLG8pLGw9ZS5zbGljZSh0LHIpLGY9MDtmPHM7KytmKWlmKGNbZl0hPT1sW2ZdKXtpPWNbZl0sYT1sW2ZdO2JyZWFrfXJldHVybiBpPGE/LTE6YTxpPzE6MH0sdS5wcm90b3R5cGUuaW5jbHVkZXM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybi0xIT09dGhpcy5pbmRleE9mKGUsdCxyKX0sdS5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbihlLHQscil7cmV0dXJuIHkodGhpcyxlLHQsciwhMCl9LHUucHJvdG90eXBlLmxhc3RJbmRleE9mPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4geSh0aGlzLGUsdCxyLCExKX0sdS5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24oZSx0LHIsbil7aWYodm9pZCAwPT09dCluPSJ1dGY4IixyPXRoaXMubGVuZ3RoLHQ9MDtlbHNlIGlmKHZvaWQgMD09PXImJiJzdHJpbmciPT10eXBlb2YgdCluPXQscj10aGlzLmxlbmd0aCx0PTA7ZWxzZXtpZighaXNGaW5pdGUodCkpdGhyb3cgbmV3IEVycm9yKCJCdWZmZXIud3JpdGUoc3RyaW5nLCBlbmNvZGluZywgb2Zmc2V0WywgbGVuZ3RoXSkgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCIpO3R8PTAsaXNGaW5pdGUocik/KHJ8PTAsdm9pZCAwPT09biYmKG49InV0ZjgiKSk6KG49cixyPXZvaWQgMCl9dmFyIG89dGhpcy5sZW5ndGgtdDtpZigodm9pZCAwPT09cnx8cj5vKSYmKHI9byksZS5sZW5ndGg+MCYmKHI8MHx8dDwwKXx8dD50aGlzLmxlbmd0aCl0aHJvdyBuZXcgUmFuZ2VFcnJvcigiQXR0ZW1wdCB0byB3cml0ZSBvdXRzaWRlIGJ1ZmZlciBib3VuZHMiKTtufHwobj0idXRmOCIpO2Zvcih2YXIgaT0hMTs7KXN3aXRjaChuKXtjYXNlImhleCI6cmV0dXJuIGcodGhpcyxlLHQscik7Y2FzZSJ1dGY4IjpjYXNlInV0Zi04IjpyZXR1cm4gdih0aGlzLGUsdCxyKTtjYXNlImFzY2lpIjpyZXR1cm4gdyh0aGlzLGUsdCxyKTtjYXNlImxhdGluMSI6Y2FzZSJiaW5hcnkiOnJldHVybiBfKHRoaXMsZSx0LHIpO2Nhc2UiYmFzZTY0IjpyZXR1cm4gYih0aGlzLGUsdCxyKTtjYXNlInVjczIiOmNhc2UidWNzLTIiOmNhc2UidXRmMTZsZSI6Y2FzZSJ1dGYtMTZsZSI6cmV0dXJuIEEodGhpcyxlLHQscik7ZGVmYXVsdDppZihpKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gZW5jb2Rpbmc6ICIrbik7bj0oIiIrbikudG9Mb3dlckNhc2UoKSxpPSEwfX0sdS5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6IkJ1ZmZlciIsZGF0YTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLl9hcnJ8fHRoaXMsMCl9fTt2YXIgaz00MDk2O2Z1bmN0aW9uIFAoZSx0LHIpe3ZhciBuPSIiO3I9TWF0aC5taW4oZS5sZW5ndGgscik7Zm9yKHZhciBvPXQ7bzxyOysrbyluKz1TdHJpbmcuZnJvbUNoYXJDb2RlKDEyNyZlW29dKTtyZXR1cm4gbn1mdW5jdGlvbiBEKGUsdCxyKXt2YXIgbj0iIjtyPU1hdGgubWluKGUubGVuZ3RoLHIpO2Zvcih2YXIgbz10O288cjsrK28pbis9U3RyaW5nLmZyb21DaGFyQ29kZShlW29dKTtyZXR1cm4gbn1mdW5jdGlvbiBSKGUsdCxyKXt2YXIgbj1lLmxlbmd0aDsoIXR8fHQ8MCkmJih0PTApLCghcnx8cjwwfHxyPm4pJiYocj1uKTtmb3IodmFyIG89IiIsaT10O2k8cjsrK2kpbys9aihlW2ldKTtyZXR1cm4gb31mdW5jdGlvbiBPKGUsdCxyKXtmb3IodmFyIG49ZS5zbGljZSh0LHIpLG89IiIsaT0wO2k8bi5sZW5ndGg7aSs9MilvKz1TdHJpbmcuZnJvbUNoYXJDb2RlKG5baV0rMjU2Km5baSsxXSk7cmV0dXJuIG99ZnVuY3Rpb24gQyhlLHQscil7aWYoZSUxIT0wfHxlPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIm9mZnNldCBpcyBub3QgdWludCIpO2lmKGUrdD5yKXRocm93IG5ldyBSYW5nZUVycm9yKCJUcnlpbmcgdG8gYWNjZXNzIGJleW9uZCBidWZmZXIgbGVuZ3RoIil9ZnVuY3Rpb24gTihlLHQscixuLG8saSl7aWYoIXUuaXNCdWZmZXIoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcignImJ1ZmZlciIgYXJndW1lbnQgbXVzdCBiZSBhIEJ1ZmZlciBpbnN0YW5jZScpO2lmKHQ+b3x8dDxpKXRocm93IG5ldyBSYW5nZUVycm9yKCcidmFsdWUiIGFyZ3VtZW50IGlzIG91dCBvZiBib3VuZHMnKTtpZihyK24+ZS5sZW5ndGgpdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEYoZSx0LHIsbil7dDwwJiYodD02NTUzNSt0KzEpO2Zvcih2YXIgbz0wLGk9TWF0aC5taW4oZS5sZW5ndGgtciwyKTtvPGk7KytvKWVbcitvXT0odCYyNTU8PDgqKG4/bzoxLW8pKT4+PjgqKG4/bzoxLW8pfWZ1bmN0aW9uIE0oZSx0LHIsbil7dDwwJiYodD00Mjk0OTY3Mjk1K3QrMSk7Zm9yKHZhciBvPTAsaT1NYXRoLm1pbihlLmxlbmd0aC1yLDQpO288aTsrK28pZVtyK29dPXQ+Pj44KihuP286My1vKSYyNTV9ZnVuY3Rpb24gSShlLHQscixuLG8saSl7aWYocituPmUubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJJbmRleCBvdXQgb2YgcmFuZ2UiKTtpZihyPDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoIkluZGV4IG91dCBvZiByYW5nZSIpfWZ1bmN0aW9uIEIoZSx0LHIsbixpKXtyZXR1cm4gaXx8SShlLDAsciw0KSxvLndyaXRlKGUsdCxyLG4sMjMsNCkscis0fWZ1bmN0aW9uIEwoZSx0LHIsbixpKXtyZXR1cm4gaXx8SShlLDAsciw4KSxvLndyaXRlKGUsdCxyLG4sNTIsOCkscis4fXUucHJvdG90eXBlLnNsaWNlPWZ1bmN0aW9uKGUsdCl7dmFyIHIsbj10aGlzLmxlbmd0aDtpZigoZT1+fmUpPDA/KGUrPW4pPDAmJihlPTApOmU+biYmKGU9biksKHQ9dm9pZCAwPT09dD9uOn5+dCk8MD8odCs9bik8MCYmKHQ9MCk6dD5uJiYodD1uKSx0PGUmJih0PWUpLHUuVFlQRURfQVJSQVlfU1VQUE9SVCkocj10aGlzLnN1YmFycmF5KGUsdCkpLl9fcHJvdG9fXz11LnByb3RvdHlwZTtlbHNle3ZhciBvPXQtZTtyPW5ldyB1KG8sdm9pZCAwKTtmb3IodmFyIGk9MDtpPG87KytpKXJbaV09dGhpc1tpK2VdfXJldHVybiByfSx1LnByb3RvdHlwZS5yZWFkVUludExFPWZ1bmN0aW9uKGUsdCxyKXtlfD0wLHR8PTAscnx8QyhlLHQsdGhpcy5sZW5ndGgpO2Zvcih2YXIgbj10aGlzW2VdLG89MSxpPTA7KytpPHQmJihvKj0yNTYpOyluKz10aGlzW2UraV0qbztyZXR1cm4gbn0sdS5wcm90b3R5cGUucmVhZFVJbnRCRT1mdW5jdGlvbihlLHQscil7ZXw9MCx0fD0wLHJ8fEMoZSx0LHRoaXMubGVuZ3RoKTtmb3IodmFyIG49dGhpc1tlKy0tdF0sbz0xO3Q+MCYmKG8qPTI1Nik7KW4rPXRoaXNbZSstLXRdKm87cmV0dXJuIG59LHUucHJvdG90eXBlLnJlYWRVSW50OD1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsMSx0aGlzLmxlbmd0aCksdGhpc1tlXX0sdS5wcm90b3R5cGUucmVhZFVJbnQxNkxFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSwyLHRoaXMubGVuZ3RoKSx0aGlzW2VdfHRoaXNbZSsxXTw8OH0sdS5wcm90b3R5cGUucmVhZFVJbnQxNkJFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSwyLHRoaXMubGVuZ3RoKSx0aGlzW2VdPDw4fHRoaXNbZSsxXX0sdS5wcm90b3R5cGUucmVhZFVJbnQzMkxFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSw0LHRoaXMubGVuZ3RoKSwodGhpc1tlXXx0aGlzW2UrMV08PDh8dGhpc1tlKzJdPDwxNikrMTY3NzcyMTYqdGhpc1tlKzNdfSx1LnByb3RvdHlwZS5yZWFkVUludDMyQkU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8QyhlLDQsdGhpcy5sZW5ndGgpLDE2Nzc3MjE2KnRoaXNbZV0rKHRoaXNbZSsxXTw8MTZ8dGhpc1tlKzJdPDw4fHRoaXNbZSszXSl9LHUucHJvdG90eXBlLnJlYWRJbnRMRT1mdW5jdGlvbihlLHQscil7ZXw9MCx0fD0wLHJ8fEMoZSx0LHRoaXMubGVuZ3RoKTtmb3IodmFyIG49dGhpc1tlXSxvPTEsaT0wOysraTx0JiYobyo9MjU2KTspbis9dGhpc1tlK2ldKm87cmV0dXJuIG4+PShvKj0xMjgpJiYobi09TWF0aC5wb3coMiw4KnQpKSxufSx1LnByb3RvdHlwZS5yZWFkSW50QkU9ZnVuY3Rpb24oZSx0LHIpe2V8PTAsdHw9MCxyfHxDKGUsdCx0aGlzLmxlbmd0aCk7Zm9yKHZhciBuPXQsbz0xLGk9dGhpc1tlKy0tbl07bj4wJiYobyo9MjU2KTspaSs9dGhpc1tlKy0tbl0qbztyZXR1cm4gaT49KG8qPTEyOCkmJihpLT1NYXRoLnBvdygyLDgqdCkpLGl9LHUucHJvdG90eXBlLnJlYWRJbnQ4PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSwxLHRoaXMubGVuZ3RoKSwxMjgmdGhpc1tlXT8tMSooMjU1LXRoaXNbZV0rMSk6dGhpc1tlXX0sdS5wcm90b3R5cGUucmVhZEludDE2TEU9ZnVuY3Rpb24oZSx0KXt0fHxDKGUsMix0aGlzLmxlbmd0aCk7dmFyIHI9dGhpc1tlXXx0aGlzW2UrMV08PDg7cmV0dXJuIDMyNzY4JnI/NDI5NDkwMTc2MHxyOnJ9LHUucHJvdG90eXBlLnJlYWRJbnQxNkJFPWZ1bmN0aW9uKGUsdCl7dHx8QyhlLDIsdGhpcy5sZW5ndGgpO3ZhciByPXRoaXNbZSsxXXx0aGlzW2VdPDw4O3JldHVybiAzMjc2OCZyPzQyOTQ5MDE3NjB8cjpyfSx1LnByb3RvdHlwZS5yZWFkSW50MzJMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsNCx0aGlzLmxlbmd0aCksdGhpc1tlXXx0aGlzW2UrMV08PDh8dGhpc1tlKzJdPDwxNnx0aGlzW2UrM108PDI0fSx1LnByb3RvdHlwZS5yZWFkSW50MzJCRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsNCx0aGlzLmxlbmd0aCksdGhpc1tlXTw8MjR8dGhpc1tlKzFdPDwxNnx0aGlzW2UrMl08PDh8dGhpc1tlKzNdfSx1LnByb3RvdHlwZS5yZWFkRmxvYXRMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsNCx0aGlzLmxlbmd0aCksby5yZWFkKHRoaXMsZSwhMCwyMyw0KX0sdS5wcm90b3R5cGUucmVhZEZsb2F0QkU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdHx8QyhlLDQsdGhpcy5sZW5ndGgpLG8ucmVhZCh0aGlzLGUsITEsMjMsNCl9LHUucHJvdG90eXBlLnJlYWREb3VibGVMRT1mdW5jdGlvbihlLHQpe3JldHVybiB0fHxDKGUsOCx0aGlzLmxlbmd0aCksby5yZWFkKHRoaXMsZSwhMCw1Miw4KX0sdS5wcm90b3R5cGUucmVhZERvdWJsZUJFPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHR8fEMoZSw4LHRoaXMubGVuZ3RoKSxvLnJlYWQodGhpcyxlLCExLDUyLDgpfSx1LnByb3RvdHlwZS53cml0ZVVJbnRMRT1mdW5jdGlvbihlLHQscixuKXtlPStlLHR8PTAscnw9MCxufHxOKHRoaXMsZSx0LHIsTWF0aC5wb3coMiw4KnIpLTEsMCk7dmFyIG89MSxpPTA7Zm9yKHRoaXNbdF09MjU1JmU7KytpPHImJihvKj0yNTYpOyl0aGlzW3QraV09ZS9vJjI1NTtyZXR1cm4gdCtyfSx1LnByb3RvdHlwZS53cml0ZVVJbnRCRT1mdW5jdGlvbihlLHQscixuKXtlPStlLHR8PTAscnw9MCxufHxOKHRoaXMsZSx0LHIsTWF0aC5wb3coMiw4KnIpLTEsMCk7dmFyIG89ci0xLGk9MTtmb3IodGhpc1t0K29dPTI1NSZlOy0tbz49MCYmKGkqPTI1Nik7KXRoaXNbdCtvXT1lL2kmMjU1O3JldHVybiB0K3J9LHUucHJvdG90eXBlLndyaXRlVUludDg9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlPStlLHR8PTAscnx8Tih0aGlzLGUsdCwxLDI1NSwwKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlR8fChlPU1hdGguZmxvb3IoZSkpLHRoaXNbdF09MjU1JmUsdCsxfSx1LnByb3RvdHlwZS53cml0ZVVJbnQxNkxFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT0rZSx0fD0wLHJ8fE4odGhpcyxlLHQsMiw2NTUzNSwwKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09MjU1JmUsdGhpc1t0KzFdPWU+Pj44KTpGKHRoaXMsZSx0LCEwKSx0KzJ9LHUucHJvdG90eXBlLndyaXRlVUludDE2QkU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlPStlLHR8PTAscnx8Tih0aGlzLGUsdCwyLDY1NTM1LDApLHUuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT1lPj4+OCx0aGlzW3QrMV09MjU1JmUpOkYodGhpcyxlLHQsITEpLHQrMn0sdS5wcm90b3R5cGUud3JpdGVVSW50MzJMRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDQsNDI5NDk2NzI5NSwwKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdCszXT1lPj4+MjQsdGhpc1t0KzJdPWU+Pj4xNix0aGlzW3QrMV09ZT4+PjgsdGhpc1t0XT0yNTUmZSk6TSh0aGlzLGUsdCwhMCksdCs0fSx1LnByb3RvdHlwZS53cml0ZVVJbnQzMkJFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT0rZSx0fD0wLHJ8fE4odGhpcyxlLHQsNCw0Mjk0OTY3Mjk1LDApLHUuVFlQRURfQVJSQVlfU1VQUE9SVD8odGhpc1t0XT1lPj4+MjQsdGhpc1t0KzFdPWU+Pj4xNix0aGlzW3QrMl09ZT4+PjgsdGhpc1t0KzNdPTI1NSZlKTpNKHRoaXMsZSx0LCExKSx0KzR9LHUucHJvdG90eXBlLndyaXRlSW50TEU9ZnVuY3Rpb24oZSx0LHIsbil7aWYoZT0rZSx0fD0wLCFuKXt2YXIgbz1NYXRoLnBvdygyLDgqci0xKTtOKHRoaXMsZSx0LHIsby0xLC1vKX12YXIgaT0wLGE9MSxzPTA7Zm9yKHRoaXNbdF09MjU1JmU7KytpPHImJihhKj0yNTYpOyllPDAmJjA9PT1zJiYwIT09dGhpc1t0K2ktMV0mJihzPTEpLHRoaXNbdCtpXT0oZS9hPj4wKS1zJjI1NTtyZXR1cm4gdCtyfSx1LnByb3RvdHlwZS53cml0ZUludEJFPWZ1bmN0aW9uKGUsdCxyLG4pe2lmKGU9K2UsdHw9MCwhbil7dmFyIG89TWF0aC5wb3coMiw4KnItMSk7Tih0aGlzLGUsdCxyLG8tMSwtbyl9dmFyIGk9ci0xLGE9MSxzPTA7Zm9yKHRoaXNbdCtpXT0yNTUmZTstLWk+PTAmJihhKj0yNTYpOyllPDAmJjA9PT1zJiYwIT09dGhpc1t0K2krMV0mJihzPTEpLHRoaXNbdCtpXT0oZS9hPj4wKS1zJjI1NTtyZXR1cm4gdCtyfSx1LnByb3RvdHlwZS53cml0ZUludDg9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlPStlLHR8PTAscnx8Tih0aGlzLGUsdCwxLDEyNywtMTI4KSx1LlRZUEVEX0FSUkFZX1NVUFBPUlR8fChlPU1hdGguZmxvb3IoZSkpLGU8MCYmKGU9MjU1K2UrMSksdGhpc1t0XT0yNTUmZSx0KzF9LHUucHJvdG90eXBlLndyaXRlSW50MTZMRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDIsMzI3NjcsLTMyNzY4KSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09MjU1JmUsdGhpc1t0KzFdPWU+Pj44KTpGKHRoaXMsZSx0LCEwKSx0KzJ9LHUucHJvdG90eXBlLndyaXRlSW50MTZCRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDIsMzI3NjcsLTMyNzY4KSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09ZT4+PjgsdGhpc1t0KzFdPTI1NSZlKTpGKHRoaXMsZSx0LCExKSx0KzJ9LHUucHJvdG90eXBlLndyaXRlSW50MzJMRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIGU9K2UsdHw9MCxyfHxOKHRoaXMsZSx0LDQsMjE0NzQ4MzY0NywtMjE0NzQ4MzY0OCksdS5UWVBFRF9BUlJBWV9TVVBQT1JUPyh0aGlzW3RdPTI1NSZlLHRoaXNbdCsxXT1lPj4+OCx0aGlzW3QrMl09ZT4+PjE2LHRoaXNbdCszXT1lPj4+MjQpOk0odGhpcyxlLHQsITApLHQrNH0sdS5wcm90b3R5cGUud3JpdGVJbnQzMkJFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT0rZSx0fD0wLHJ8fE4odGhpcyxlLHQsNCwyMTQ3NDgzNjQ3LC0yMTQ3NDgzNjQ4KSxlPDAmJihlPTQyOTQ5NjcyOTUrZSsxKSx1LlRZUEVEX0FSUkFZX1NVUFBPUlQ/KHRoaXNbdF09ZT4+PjI0LHRoaXNbdCsxXT1lPj4+MTYsdGhpc1t0KzJdPWU+Pj44LHRoaXNbdCszXT0yNTUmZSk6TSh0aGlzLGUsdCwhMSksdCs0fSx1LnByb3RvdHlwZS53cml0ZUZsb2F0TEU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBCKHRoaXMsZSx0LCEwLHIpfSx1LnByb3RvdHlwZS53cml0ZUZsb2F0QkU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBCKHRoaXMsZSx0LCExLHIpfSx1LnByb3RvdHlwZS53cml0ZURvdWJsZUxFPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gTCh0aGlzLGUsdCwhMCxyKX0sdS5wcm90b3R5cGUud3JpdGVEb3VibGVCRT1mdW5jdGlvbihlLHQscil7cmV0dXJuIEwodGhpcyxlLHQsITEscil9LHUucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24oZSx0LHIsbil7aWYocnx8KHI9MCksbnx8MD09PW58fChuPXRoaXMubGVuZ3RoKSx0Pj1lLmxlbmd0aCYmKHQ9ZS5sZW5ndGgpLHR8fCh0PTApLG4+MCYmbjxyJiYobj1yKSxuPT09cilyZXR1cm4gMDtpZigwPT09ZS5sZW5ndGh8fDA9PT10aGlzLmxlbmd0aClyZXR1cm4gMDtpZih0PDApdGhyb3cgbmV3IFJhbmdlRXJyb3IoInRhcmdldFN0YXJ0IG91dCBvZiBib3VuZHMiKTtpZihyPDB8fHI+PXRoaXMubGVuZ3RoKXRocm93IG5ldyBSYW5nZUVycm9yKCJzb3VyY2VTdGFydCBvdXQgb2YgYm91bmRzIik7aWYobjwwKXRocm93IG5ldyBSYW5nZUVycm9yKCJzb3VyY2VFbmQgb3V0IG9mIGJvdW5kcyIpO24+dGhpcy5sZW5ndGgmJihuPXRoaXMubGVuZ3RoKSxlLmxlbmd0aC10PG4tciYmKG49ZS5sZW5ndGgtdCtyKTt2YXIgbyxpPW4tcjtpZih0aGlzPT09ZSYmcjx0JiZ0PG4pZm9yKG89aS0xO28+PTA7LS1vKWVbbyt0XT10aGlzW28rcl07ZWxzZSBpZihpPDFlM3x8IXUuVFlQRURfQVJSQVlfU1VQUE9SVClmb3Iobz0wO288aTsrK28pZVtvK3RdPXRoaXNbbytyXTtlbHNlIFVpbnQ4QXJyYXkucHJvdG90eXBlLnNldC5jYWxsKGUsdGhpcy5zdWJhcnJheShyLHIraSksdCk7cmV0dXJuIGl9LHUucHJvdG90eXBlLmZpbGw9ZnVuY3Rpb24oZSx0LHIsbil7aWYoInN0cmluZyI9PXR5cGVvZiBlKXtpZigic3RyaW5nIj09dHlwZW9mIHQ/KG49dCx0PTAscj10aGlzLmxlbmd0aCk6InN0cmluZyI9PXR5cGVvZiByJiYobj1yLHI9dGhpcy5sZW5ndGgpLDE9PT1lLmxlbmd0aCl7dmFyIG89ZS5jaGFyQ29kZUF0KDApO288MjU2JiYoZT1vKX1pZih2b2lkIDAhPT1uJiYic3RyaW5nIiE9dHlwZW9mIG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiZW5jb2RpbmcgbXVzdCBiZSBhIHN0cmluZyIpO2lmKCJzdHJpbmciPT10eXBlb2YgbiYmIXUuaXNFbmNvZGluZyhuKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIGVuY29kaW5nOiAiK24pfWVsc2UibnVtYmVyIj09dHlwZW9mIGUmJihlJj0yNTUpO2lmKHQ8MHx8dGhpcy5sZW5ndGg8dHx8dGhpcy5sZW5ndGg8cil0aHJvdyBuZXcgUmFuZ2VFcnJvcigiT3V0IG9mIHJhbmdlIGluZGV4Iik7aWYocjw9dClyZXR1cm4gdGhpczt2YXIgaTtpZih0Pj4+PTAscj12b2lkIDA9PT1yP3RoaXMubGVuZ3RoOnI+Pj4wLGV8fChlPTApLCJudW1iZXIiPT10eXBlb2YgZSlmb3IoaT10O2k8cjsrK2kpdGhpc1tpXT1lO2Vsc2V7dmFyIGE9dS5pc0J1ZmZlcihlKT9lOlUobmV3IHUoZSxuKS50b1N0cmluZygpKSxzPWEubGVuZ3RoO2ZvcihpPTA7aTxyLXQ7KytpKXRoaXNbaSt0XT1hW2klc119cmV0dXJuIHRoaXN9O3ZhciB4PS9bXitcLzAtOUEtWmEtei1fXS9nO2Z1bmN0aW9uIGooZSl7cmV0dXJuIGU8MTY/IjAiK2UudG9TdHJpbmcoMTYpOmUudG9TdHJpbmcoMTYpfWZ1bmN0aW9uIFUoZSx0KXt2YXIgcjt0PXR8fDEvMDtmb3IodmFyIG49ZS5sZW5ndGgsbz1udWxsLGk9W10sYT0wO2E8bjsrK2Epe2lmKChyPWUuY2hhckNvZGVBdChhKSk+NTUyOTUmJnI8NTczNDQpe2lmKCFvKXtpZihyPjU2MzE5KXsodC09Myk+LTEmJmkucHVzaCgyMzksMTkxLDE4OSk7Y29udGludWV9aWYoYSsxPT09bil7KHQtPTMpPi0xJiZpLnB1c2goMjM5LDE5MSwxODkpO2NvbnRpbnVlfW89cjtjb250aW51ZX1pZihyPDU2MzIwKXsodC09Myk+LTEmJmkucHVzaCgyMzksMTkxLDE4OSksbz1yO2NvbnRpbnVlfXI9NjU1MzYrKG8tNTUyOTY8PDEwfHItNTYzMjApfWVsc2UgbyYmKHQtPTMpPi0xJiZpLnB1c2goMjM5LDE5MSwxODkpO2lmKG89bnVsbCxyPDEyOCl7aWYoKHQtPTEpPDApYnJlYWs7aS5wdXNoKHIpfWVsc2UgaWYocjwyMDQ4KXtpZigodC09Mik8MClicmVhaztpLnB1c2gocj4+NnwxOTIsNjMmcnwxMjgpfWVsc2UgaWYocjw2NTUzNil7aWYoKHQtPTMpPDApYnJlYWs7aS5wdXNoKHI+PjEyfDIyNCxyPj42JjYzfDEyOCw2MyZyfDEyOCl9ZWxzZXtpZighKHI8MTExNDExMikpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGNvZGUgcG9pbnQiKTtpZigodC09NCk8MClicmVhaztpLnB1c2gocj4+MTh8MjQwLHI+PjEyJjYzfDEyOCxyPj42JjYzfDEyOCw2MyZyfDEyOCl9fXJldHVybiBpfWZ1bmN0aW9uIHooZSl7cmV0dXJuIG4udG9CeXRlQXJyYXkoZnVuY3Rpb24oZSl7aWYoKGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUudHJpbT9lLnRyaW0oKTplLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKX0oZSkucmVwbGFjZSh4LCIiKSkubGVuZ3RoPDIpcmV0dXJuIiI7Zm9yKDtlLmxlbmd0aCU0IT0wOyllKz0iPSI7cmV0dXJuIGV9KGUpKX1mdW5jdGlvbiAkKGUsdCxyLG4pe2Zvcih2YXIgbz0wO288biYmIShvK3I+PXQubGVuZ3RofHxvPj1lLmxlbmd0aCk7KytvKXRbbytyXT1lW29dO3JldHVybiBvfX0pLmNhbGwodGhpcyxyKDgpKX0sZnVuY3Rpb24oZSx0KXt2YXIgcjtyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCk7dHJ5e3I9cnx8RnVuY3Rpb24oInJldHVybiB0aGlzIikoKXx8KDAsZXZhbCkoInRoaXMiKX1jYXRjaChlKXsib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyYmKHI9d2luZG93KX1lLmV4cG9ydHM9cn0sZnVuY3Rpb24oZSx0LHIpe3QuYnl0ZUxlbmd0aD1mdW5jdGlvbihlKXt2YXIgdD1jKGUpLHI9dFswXSxuPXRbMV07cmV0dXJuIDMqKHIrbikvNC1ufSx0LnRvQnl0ZUFycmF5PWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxyPWMoZSksbj1yWzBdLGE9clsxXSxzPW5ldyBpKGZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gMyoodCtyKS80LXJ9KDAsbixhKSksdT0wLGw9YT4wP24tNDpuLGY9MDtmPGw7Zis9NCl0PW9bZS5jaGFyQ29kZUF0KGYpXTw8MTh8b1tlLmNoYXJDb2RlQXQoZisxKV08PDEyfG9bZS5jaGFyQ29kZUF0KGYrMildPDw2fG9bZS5jaGFyQ29kZUF0KGYrMyldLHNbdSsrXT10Pj4xNiYyNTUsc1t1KytdPXQ+PjgmMjU1LHNbdSsrXT0yNTUmdDtyZXR1cm4gMj09PWEmJih0PW9bZS5jaGFyQ29kZUF0KGYpXTw8MnxvW2UuY2hhckNvZGVBdChmKzEpXT4+NCxzW3UrK109MjU1JnQpLDE9PT1hJiYodD1vW2UuY2hhckNvZGVBdChmKV08PDEwfG9bZS5jaGFyQ29kZUF0KGYrMSldPDw0fG9bZS5jaGFyQ29kZUF0KGYrMildPj4yLHNbdSsrXT10Pj44JjI1NSxzW3UrK109MjU1JnQpLHN9LHQuZnJvbUJ5dGVBcnJheT1mdW5jdGlvbihlKXtmb3IodmFyIHQscj1lLmxlbmd0aCxvPXIlMyxpPVtdLGE9MCxzPXItbzthPHM7YSs9MTYzODMpaS5wdXNoKGYoZSxhLGErMTYzODM+cz9zOmErMTYzODMpKTtyZXR1cm4gMT09PW8/KHQ9ZVtyLTFdLGkucHVzaChuW3Q+PjJdK25bdDw8NCY2M10rIj09IikpOjI9PT1vJiYodD0oZVtyLTJdPDw4KStlW3ItMV0saS5wdXNoKG5bdD4+MTBdK25bdD4+NCY2M10rblt0PDwyJjYzXSsiPSIpKSxpLmpvaW4oIiIpfTtmb3IodmFyIG49W10sbz1bXSxpPSJ1bmRlZmluZWQiIT10eXBlb2YgVWludDhBcnJheT9VaW50OEFycmF5OkFycmF5LGE9IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8iLHM9MCx1PWEubGVuZ3RoO3M8dTsrK3MpbltzXT1hW3NdLG9bYS5jaGFyQ29kZUF0KHMpXT1zO2Z1bmN0aW9uIGMoZSl7dmFyIHQ9ZS5sZW5ndGg7aWYodCU0PjApdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHN0cmluZy4gTGVuZ3RoIG11c3QgYmUgYSBtdWx0aXBsZSBvZiA0Iik7dmFyIHI9ZS5pbmRleE9mKCI9Iik7cmV0dXJuLTE9PT1yJiYocj10KSxbcixyPT09dD8wOjQtciU0XX1mdW5jdGlvbiBsKGUpe3JldHVybiBuW2U+PjE4JjYzXStuW2U+PjEyJjYzXStuW2U+PjYmNjNdK25bNjMmZV19ZnVuY3Rpb24gZihlLHQscil7Zm9yKHZhciBuLG89W10saT10O2k8cjtpKz0zKW49KGVbaV08PDE2JjE2NzExNjgwKSsoZVtpKzFdPDw4JjY1MjgwKSsoMjU1JmVbaSsyXSksby5wdXNoKGwobikpO3JldHVybiBvLmpvaW4oIiIpfW9bIi0iLmNoYXJDb2RlQXQoMCldPTYyLG9bIl8iLmNoYXJDb2RlQXQoMCldPTYzfSxmdW5jdGlvbihlLHQpe3QucmVhZD1mdW5jdGlvbihlLHQscixuLG8pe3ZhciBpLGEscz04Km8tbi0xLHU9KDE8PHMpLTEsYz11Pj4xLGw9LTcsZj1yP28tMTowLGQ9cj8tMToxLGg9ZVt0K2ZdO2ZvcihmKz1kLGk9aCYoMTw8LWwpLTEsaD4+PS1sLGwrPXM7bD4wO2k9MjU2KmkrZVt0K2ZdLGYrPWQsbC09OCk7Zm9yKGE9aSYoMTw8LWwpLTEsaT4+PS1sLGwrPW47bD4wO2E9MjU2KmErZVt0K2ZdLGYrPWQsbC09OCk7aWYoMD09PWkpaT0xLWM7ZWxzZXtpZihpPT09dSlyZXR1cm4gYT9OYU46MS8wKihoPy0xOjEpO2ErPU1hdGgucG93KDIsbiksaS09Y31yZXR1cm4oaD8tMToxKSphKk1hdGgucG93KDIsaS1uKX0sdC53cml0ZT1mdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGEscyx1LGM9OCppLW8tMSxsPSgxPDxjKS0xLGY9bD4+MSxkPTIzPT09bz9NYXRoLnBvdygyLC0yNCktTWF0aC5wb3coMiwtNzcpOjAsaD1uPzA6aS0xLHA9bj8xOi0xLG09dDwwfHwwPT09dCYmMS90PDA/MTowO2Zvcih0PU1hdGguYWJzKHQpLGlzTmFOKHQpfHx0PT09MS8wPyhzPWlzTmFOKHQpPzE6MCxhPWwpOihhPU1hdGguZmxvb3IoTWF0aC5sb2codCkvTWF0aC5MTjIpLHQqKHU9TWF0aC5wb3coMiwtYSkpPDEmJihhLS0sdSo9MiksKHQrPWErZj49MT9kL3U6ZCpNYXRoLnBvdygyLDEtZikpKnU+PTImJihhKyssdS89MiksYStmPj1sPyhzPTAsYT1sKTphK2Y+PTE/KHM9KHQqdS0xKSpNYXRoLnBvdygyLG8pLGErPWYpOihzPXQqTWF0aC5wb3coMixmLTEpKk1hdGgucG93KDIsbyksYT0wKSk7bz49ODtlW3IraF09MjU1JnMsaCs9cCxzLz0yNTYsby09OCk7Zm9yKGE9YTw8b3xzLGMrPW87Yz4wO2VbcitoXT0yNTUmYSxoKz1wLGEvPTI1NixjLT04KTtlW3IraC1wXXw9MTI4Km19fSxmdW5jdGlvbihlLHQpe3ZhciByPXt9LnRvU3RyaW5nO2UuZXhwb3J0cz1BcnJheS5pc0FycmF5fHxmdW5jdGlvbihlKXtyZXR1cm4iW29iamVjdCBBcnJheV0iPT1yLmNhbGwoZSl9fSxmdW5jdGlvbih0LHIpe3QuZXhwb3J0cz1lfSxmdW5jdGlvbihlLHQscil7KGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHIoZSx0KXtmb3IodmFyIHI9MCxuPWUubGVuZ3RoLTE7bj49MDtuLS0pe3ZhciBvPWVbbl07Ii4iPT09bz9lLnNwbGljZShuLDEpOiIuLiI9PT1vPyhlLnNwbGljZShuLDEpLHIrKyk6ciYmKGUuc3BsaWNlKG4sMSksci0tKX1pZih0KWZvcig7ci0tO3IpZS51bnNoaWZ0KCIuLiIpO3JldHVybiBlfXZhciBuPS9eKFwvP3wpKFtcc1xTXSo/KSgoPzpcLnsxLDJ9fFteXC9dKz98KShcLlteLlwvXSp8KSkoPzpbXC9dKikkLyxvPWZ1bmN0aW9uKGUpe3JldHVybiBuLmV4ZWMoZSkuc2xpY2UoMSl9O2Z1bmN0aW9uIGkoZSx0KXtpZihlLmZpbHRlcilyZXR1cm4gZS5maWx0ZXIodCk7Zm9yKHZhciByPVtdLG49MDtuPGUubGVuZ3RoO24rKyl0KGVbbl0sbixlKSYmci5wdXNoKGVbbl0pO3JldHVybiByfXQucmVzb2x2ZT1mdW5jdGlvbigpe2Zvcih2YXIgdD0iIixuPSExLG89YXJndW1lbnRzLmxlbmd0aC0xO28+PS0xJiYhbjtvLS0pe3ZhciBhPW8+PTA/YXJndW1lbnRzW29dOmUuY3dkKCk7aWYoInN0cmluZyIhPXR5cGVvZiBhKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50cyB0byBwYXRoLnJlc29sdmUgbXVzdCBiZSBzdHJpbmdzIik7YSYmKHQ9YSsiLyIrdCxuPSIvIj09PWEuY2hhckF0KDApKX1yZXR1cm4obj8iLyI6IiIpKyh0PXIoaSh0LnNwbGl0KCIvIiksKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhbikuam9pbigiLyIpKXx8Ii4ifSx0Lm5vcm1hbGl6ZT1mdW5jdGlvbihlKXt2YXIgbj10LmlzQWJzb2x1dGUoZSksbz0iLyI9PT1hKGUsLTEpO3JldHVybihlPXIoaShlLnNwbGl0KCIvIiksKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhbikuam9pbigiLyIpKXx8bnx8KGU9Ii4iKSxlJiZvJiYoZSs9Ii8iKSwobj8iLyI6IiIpK2V9LHQuaXNBYnNvbHV0ZT1mdW5jdGlvbihlKXtyZXR1cm4iLyI9PT1lLmNoYXJBdCgwKX0sdC5qb2luPWZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO3JldHVybiB0Lm5vcm1hbGl6ZShpKGUsKGZ1bmN0aW9uKGUsdCl7aWYoInN0cmluZyIhPXR5cGVvZiBlKXRocm93IG5ldyBUeXBlRXJyb3IoIkFyZ3VtZW50cyB0byBwYXRoLmpvaW4gbXVzdCBiZSBzdHJpbmdzIik7cmV0dXJuIGV9KSkuam9pbigiLyIpKX0sdC5yZWxhdGl2ZT1mdW5jdGlvbihlLHIpe2Z1bmN0aW9uIG4oZSl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aCYmIiI9PT1lW3RdO3QrKyk7Zm9yKHZhciByPWUubGVuZ3RoLTE7cj49MCYmIiI9PT1lW3JdO3ItLSk7cmV0dXJuIHQ+cj9bXTplLnNsaWNlKHQsci10KzEpfWU9dC5yZXNvbHZlKGUpLnN1YnN0cigxKSxyPXQucmVzb2x2ZShyKS5zdWJzdHIoMSk7Zm9yKHZhciBvPW4oZS5zcGxpdCgiLyIpKSxpPW4oci5zcGxpdCgiLyIpKSxhPU1hdGgubWluKG8ubGVuZ3RoLGkubGVuZ3RoKSxzPWEsdT0wO3U8YTt1KyspaWYob1t1XSE9PWlbdV0pe3M9dTticmVha312YXIgYz1bXTtmb3IodT1zO3U8by5sZW5ndGg7dSsrKWMucHVzaCgiLi4iKTtyZXR1cm4oYz1jLmNvbmNhdChpLnNsaWNlKHMpKSkuam9pbigiLyIpfSx0LnNlcD0iLyIsdC5kZWxpbWl0ZXI9IjoiLHQuZGlybmFtZT1mdW5jdGlvbihlKXt2YXIgdD1vKGUpLHI9dFswXSxuPXRbMV07cmV0dXJuIHJ8fG4/KG4mJihuPW4uc3Vic3RyKDAsbi5sZW5ndGgtMSkpLHIrbik6Ii4ifSx0LmJhc2VuYW1lPWZ1bmN0aW9uKGUsdCl7dmFyIHI9byhlKVsyXTtyZXR1cm4gdCYmci5zdWJzdHIoLTEqdC5sZW5ndGgpPT09dCYmKHI9ci5zdWJzdHIoMCxyLmxlbmd0aC10Lmxlbmd0aCkpLHJ9LHQuZXh0bmFtZT1mdW5jdGlvbihlKXtyZXR1cm4gbyhlKVszXX07dmFyIGE9ImIiPT09ImFiIi5zdWJzdHIoLTEpP2Z1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZS5zdWJzdHIodCxyKX06ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0PDAmJih0PWUubGVuZ3RoK3QpLGUuc3Vic3RyKHQscil9fSkuY2FsbCh0aGlzLHIoMTQpKX0sZnVuY3Rpb24oZSx0KXt2YXIgcixuLG89ZS5leHBvcnRzPXt9O2Z1bmN0aW9uIGkoKXt0aHJvdyBuZXcgRXJyb3IoInNldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQiKX1mdW5jdGlvbiBhKCl7dGhyb3cgbmV3IEVycm9yKCJjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQiKX1mdW5jdGlvbiBzKGUpe2lmKHI9PT1zZXRUaW1lb3V0KXJldHVybiBzZXRUaW1lb3V0KGUsMCk7aWYoKHI9PT1pfHwhcikmJnNldFRpbWVvdXQpcmV0dXJuIHI9c2V0VGltZW91dCxzZXRUaW1lb3V0KGUsMCk7dHJ5e3JldHVybiByKGUsMCl9Y2F0Y2godCl7dHJ5e3JldHVybiByLmNhbGwobnVsbCxlLDApfWNhdGNoKHQpe3JldHVybiByLmNhbGwodGhpcyxlLDApfX19IWZ1bmN0aW9uKCl7dHJ5e3I9ImZ1bmN0aW9uIj09dHlwZW9mIHNldFRpbWVvdXQ/c2V0VGltZW91dDppfWNhdGNoKGUpe3I9aX10cnl7bj0iZnVuY3Rpb24iPT10eXBlb2YgY2xlYXJUaW1lb3V0P2NsZWFyVGltZW91dDphfWNhdGNoKGUpe249YX19KCk7dmFyIHUsYz1bXSxsPSExLGY9LTE7ZnVuY3Rpb24gZCgpe2wmJnUmJihsPSExLHUubGVuZ3RoP2M9dS5jb25jYXQoYyk6Zj0tMSxjLmxlbmd0aCYmaCgpKX1mdW5jdGlvbiBoKCl7aWYoIWwpe3ZhciBlPXMoZCk7bD0hMDtmb3IodmFyIHQ9Yy5sZW5ndGg7dDspe2Zvcih1PWMsYz1bXTsrK2Y8dDspdSYmdVtmXS5ydW4oKTtmPS0xLHQ9Yy5sZW5ndGh9dT1udWxsLGw9ITEsZnVuY3Rpb24oZSl7aWYobj09PWNsZWFyVGltZW91dClyZXR1cm4gY2xlYXJUaW1lb3V0KGUpO2lmKChuPT09YXx8IW4pJiZjbGVhclRpbWVvdXQpcmV0dXJuIG49Y2xlYXJUaW1lb3V0LGNsZWFyVGltZW91dChlKTt0cnl7bihlKX1jYXRjaCh0KXt0cnl7cmV0dXJuIG4uY2FsbChudWxsLGUpfWNhdGNoKHQpe3JldHVybiBuLmNhbGwodGhpcyxlKX19fShlKX19ZnVuY3Rpb24gcChlLHQpe3RoaXMuZnVuPWUsdGhpcy5hcnJheT10fWZ1bmN0aW9uIG0oKXt9by5uZXh0VGljaz1mdW5jdGlvbihlKXt2YXIgdD1uZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aC0xKTtpZihhcmd1bWVudHMubGVuZ3RoPjEpZm9yKHZhciByPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKyl0W3ItMV09YXJndW1lbnRzW3JdO2MucHVzaChuZXcgcChlLHQpKSwxIT09Yy5sZW5ndGh8fGx8fHMoaCl9LHAucHJvdG90eXBlLnJ1bj1mdW5jdGlvbigpe3RoaXMuZnVuLmFwcGx5KG51bGwsdGhpcy5hcnJheSl9LG8udGl0bGU9ImJyb3dzZXIiLG8uYnJvd3Nlcj0hMCxvLmVudj17fSxvLmFyZ3Y9W10sby52ZXJzaW9uPSIiLG8udmVyc2lvbnM9e30sby5vbj1tLG8uYWRkTGlzdGVuZXI9bSxvLm9uY2U9bSxvLm9mZj1tLG8ucmVtb3ZlTGlzdGVuZXI9bSxvLnJlbW92ZUFsbExpc3RlbmVycz1tLG8uZW1pdD1tLG8ucHJlcGVuZExpc3RlbmVyPW0sby5wcmVwZW5kT25jZUxpc3RlbmVyPW0sby5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuW119LG8uYmluZGluZz1mdW5jdGlvbihlKXt0aHJvdyBuZXcgRXJyb3IoInByb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkIil9LG8uY3dkPWZ1bmN0aW9uKCl7cmV0dXJuIi8ifSxvLmNoZGlyPWZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcigicHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkIil9LG8udW1hc2s9ZnVuY3Rpb24oKXtyZXR1cm4gMH19XSl9KHQuZnMpO2NvbnN0IHI9ZS51bnBhY2tCcmlkZ2U7bGV0IG47dmFyIG89ZnVuY3Rpb24oZSl7Y29uc3QgdD17fTtjcmVkZW50aWFscz0ib21pdCI7dmFyIG4sbz12b2lkIDAhPT10P3Q6e30saT1yLkV4dCxhPXtvcGVuOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY3VycmVudC5vcGVuLmFwcGx5KGkuY3VycmVudCxhcmd1bWVudHMpfSxjbG9zZTpmdW5jdGlvbigpe3JldHVybiBpLmN1cnJlbnQuY2xvc2UuYXBwbHkoaS5jdXJyZW50LGFyZ3VtZW50cyl9LHJlYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gaS5jdXJyZW50LnJlYWQuYXBwbHkoaS5jdXJyZW50LGFyZ3VtZW50cyl9LHdyaXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY3VycmVudC53cml0ZS5hcHBseShpLmN1cnJlbnQsYXJndW1lbnRzKX0sdGVsbDpmdW5jdGlvbigpe3JldHVybiBpLmN1cnJlbnQudGVsbC5hcHBseShpLmN1cnJlbnQsYXJndW1lbnRzKX0sc2VlazpmdW5jdGlvbigpe3JldHVybiBpLmN1cnJlbnQuc2Vlay5hcHBseShpLmN1cnJlbnQsYXJndW1lbnRzKX0sY3JlYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGkuY3VycmVudC5jcmVhdGUuYXBwbHkoaS5jdXJyZW50LGFyZ3VtZW50cyl9fSxzPXt9O2ZvcihuIGluIG8pby5oYXNPd25Qcm9wZXJ0eShuKSYmKHNbbl09b1tuXSk7by5hcmd1bWVudHM9W10sby50aGlzUHJvZ3JhbT0iLi90aGlzLnByb2dyYW0iLG8ucXVpdD1mdW5jdGlvbihlLHQpe3Rocm93IHR9LG8ucHJlUnVuPVtdLG8ucG9zdFJ1bj1bXTt2YXIgdT0hMSxjPSExLGw9ITE7aWYoby5FTlZJUk9OTUVOVCl7aWYoIldFQiI9PT1vLkVOVklST05NRU5UKXU9ITA7ZWxzZSBpZigiV09SS0VSIj09PW8uRU5WSVJPTk1FTlQpYz0hMDtlbHNlIGlmKCJOT0RFIj09PW8uRU5WSVJPTk1FTlQpbD0hMDtlbHNlIGlmKCJTSEVMTCIhPT1vLkVOVklST05NRU5UKXRocm93IG5ldyBFcnJvcigiTW9kdWxlWydFTlZJUk9OTUVOVCddIHZhbHVlIGlzIG5vdCB2YWxpZC4gbXVzdCBiZSBvbmUgb2Y6IFdFQnxXT1JLRVJ8Tk9ERXxTSEVMTC4iKX1lbHNlIHU9Im9iamVjdCI9PXR5cGVvZiB3aW5kb3csYz0iZnVuY3Rpb24iPT10eXBlb2YgaW1wb3J0U2NyaXB0cyxsPSJvYmplY3QiPT10eXBlb2YgcHJvY2VzcyYmImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUmJiF1JiYhYztmb3IobiBpbih1fHxjKSYmKG8ucmVhZD1mdW5jdGlvbihlKXt2YXIgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIHQub3BlbigiR0VUIixlLCExKSx0LnNlbmQobnVsbCksdC5yZXNwb25zZVRleHR9LGMmJihvLnJlYWRCaW5hcnk9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFhNTEh0dHBSZXF1ZXN0O3JldHVybiB0Lm9wZW4oIkdFVCIsZSwhMSksdC5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIix0LnNlbmQobnVsbCksbmV3IFVpbnQ4QXJyYXkodC5yZXNwb25zZSl9KSxvLnJlYWRBc3luYz1mdW5jdGlvbihlLHQscil7dmFyIG49bmV3IFhNTEh0dHBSZXF1ZXN0O24ub3BlbigiR0VUIixlLCEwKSxuLnJlc3BvbnNlVHlwZT0iYXJyYXlidWZmZXIiLG4ub25sb2FkPWZ1bmN0aW9uKCl7MjAwPT1uLnN0YXR1c3x8MD09bi5zdGF0dXMmJm4ucmVzcG9uc2U/dChuLnJlc3BvbnNlKTpyKCl9LG4ub25lcnJvcj1yLG4uc2VuZChudWxsKX0sby5zZXRXaW5kb3dUaXRsZT1mdW5jdGlvbihlKXtkb2N1bWVudC50aXRsZT1lfSksby5wcmludD0idW5kZWZpbmVkIiE9dHlwZW9mIGNvbnNvbGU/Y29uc29sZS5sb2cuYmluZChjb25zb2xlKToidW5kZWZpbmVkIiE9dHlwZW9mIHByaW50P3ByaW50Om51bGwsby5wcmludEVycj0idW5kZWZpbmVkIiE9dHlwZW9mIHByaW50RXJyP3ByaW50RXJyOiJ1bmRlZmluZWQiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuLmJpbmQoY29uc29sZSl8fG8ucHJpbnQsby5wcmludD1vLnByaW50LG8ucHJpbnRFcnI9by5wcmludEVycixzKXMuaGFzT3duUHJvcGVydHkobikmJihvW25dPXNbbl0pO3M9dm9pZCAwO2Z1bmN0aW9uIGYoZSl7eSgheCk7dmFyIHQ9TDtyZXR1cm4gTD1MK2UrMTUmLTE2LHR9ZnVuY3Rpb24gZChlKXt5KCQpO3ZhciB0PUZbJD4+Ml0scj10K2UrMTUmLTE2O2lmKChGWyQ+PjJdPXIscj49cSkmJiFIKCkpcmV0dXJuIEZbJD4+Ml09dCwwO3JldHVybiB0fWZ1bmN0aW9uIGgoZSx0KXtyZXR1cm4gdHx8KHQ9MTYpLGU9TWF0aC5jZWlsKGUvdCkqdH1mdW5jdGlvbiBwKGUpe3N3aXRjaChlKXtjYXNlImkxIjpjYXNlImk4IjpyZXR1cm4gMTtjYXNlImkxNiI6cmV0dXJuIDI7Y2FzZSJpMzIiOnJldHVybiA0O2Nhc2UiaTY0IjpyZXR1cm4gODtjYXNlImZsb2F0IjpyZXR1cm4gNDtjYXNlImRvdWJsZSI6cmV0dXJuIDg7ZGVmYXVsdDppZigiKiI9PT1lW2UubGVuZ3RoLTFdKXJldHVybiA0O2lmKCJpIj09PWVbMF0pe3ZhciB0PXBhcnNlSW50KGUuc3Vic3RyKDEpKTtyZXR1cm4geSh0JTg9PTApLHQvOH1yZXR1cm4gMH19bmV3IEFycmF5KDApO3ZhciBtPTA7ZnVuY3Rpb24geShlLHQpe2V8fHJyKCJBc3NlcnRpb24gZmFpbGVkOiAiK3QpfWZ1bmN0aW9uIEUoZSx0LHIsbil7c3dpdGNoKCIqIj09PShyPXJ8fCJpOCIpLmNoYXJBdChyLmxlbmd0aC0xKSYmKHI9ImkzMiIpLHIpe2Nhc2UiaTEiOmNhc2UiaTgiOlJbZT4+MF09dDticmVhaztjYXNlImkxNiI6Q1tlPj4xXT10O2JyZWFrO2Nhc2UiaTMyIjpGW2U+PjJdPXQ7YnJlYWs7Y2FzZSJpNjQiOnRlbXBJNjQ9W3Q+Pj4wLCh0ZW1wRG91YmxlPXQsK25lKHRlbXBEb3VibGUpPj0xP3RlbXBEb3VibGU+MD8oMHxhZSgraWUodGVtcERvdWJsZS80Mjk0OTY3Mjk2KSw0Mjk0OTY3Mjk1KSk+Pj4wOn5+K29lKCh0ZW1wRG91YmxlLSsofn50ZW1wRG91YmxlPj4+MCkpLzQyOTQ5NjcyOTYpPj4+MDowKV0sRltlPj4yXT10ZW1wSTY0WzBdLEZbZSs0Pj4yXT10ZW1wSTY0WzFdO2JyZWFrO2Nhc2UiZmxvYXQiOklbZT4+Ml09dDticmVhaztjYXNlImRvdWJsZSI6QltlPj4zXT10O2JyZWFrO2RlZmF1bHQ6cnIoImludmFsaWQgdHlwZSBmb3Igc2V0VmFsdWU6ICIrcil9fWZ1bmN0aW9uIGcoZSx0LHIsbil7dmFyIG8saTsibnVtYmVyIj09dHlwZW9mIGU/KG89ITAsaT1lKToobz0hMSxpPWUubGVuZ3RoKTt2YXIgYSxzPSJzdHJpbmciPT10eXBlb2YgdD90Om51bGw7aWYoYT00PT1yP246WyJmdW5jdGlvbiI9PXR5cGVvZiBKdD9KdDpmLFF0LGYsZF1bdm9pZCAwPT09cj8yOnJdKE1hdGgubWF4KGkscz8xOnQubGVuZ3RoKSksbyl7dmFyIHU7Zm9yKG49YSx5KDA9PSgzJmEpKSx1PWErKC00JmkpO248dTtuKz00KUZbbj4+Ml09MDtmb3IodT1hK2k7bjx1OylSW24rKz4+MF09MDtyZXR1cm4gYX1pZigiaTgiPT09cylyZXR1cm4gZS5zdWJhcnJheXx8ZS5zbGljZT9PLnNldChlLGEpOk8uc2V0KG5ldyBVaW50OEFycmF5KGUpLGEpLGE7Zm9yKHZhciBjLGwsaCxtPTA7bTxpOyl7dmFyIGc9ZVttXTswIT09KGM9c3x8dFttXSk/KCJpNjQiPT1jJiYoYz0iaTMyIiksRShhK20sZyxjKSxoIT09YyYmKGw9cChjKSxoPWMpLG0rPWwpOm0rK31yZXR1cm4gYX1mdW5jdGlvbiB2KGUsdCl7aWYoMD09PXR8fCFlKXJldHVybiIiO2Zvcih2YXIgcixuPTAsbz0wO258PXI9T1tlK28+PjBdLCgwIT1yfHx0KSYmKG8rKywhdHx8byE9dCk7KTt0fHwodD1vKTt2YXIgaT0iIjtpZihuPDEyOCl7Zm9yKHZhciBhO3Q+MDspYT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KFN0cmluZyxPLnN1YmFycmF5KGUsZStNYXRoLm1pbih0LDEwMjQpKSksaT1pP2krYTphLGUrPTEwMjQsdC09MTAyNDtyZXR1cm4gaX1yZXR1cm4gYihlKX12YXIgdz0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyP25ldyBUZXh0RGVjb2RlcigidXRmOCIpOnZvaWQgMDtmdW5jdGlvbiBfKGUsdCl7Zm9yKHZhciByPXQ7ZVtyXTspKytyO2lmKHItdD4xNiYmZS5zdWJhcnJheSYmdylyZXR1cm4gdy5kZWNvZGUoZS5zdWJhcnJheSh0LHIpKTtmb3IodmFyIG4sbyxpLGEscyx1PSIiOzspe2lmKCEobj1lW3QrK10pKXJldHVybiB1O2lmKDEyOCZuKWlmKG89NjMmZVt0KytdLDE5MiE9KDIyNCZuKSlpZihpPTYzJmVbdCsrXSwyMjQ9PSgyNDAmbik/bj0oMTUmbik8PDEyfG88PDZ8aTooYT02MyZlW3QrK10sMjQwPT0oMjQ4Jm4pP249KDcmbik8PDE4fG88PDEyfGk8PDZ8YToocz02MyZlW3QrK10sbj0yNDg9PSgyNTImbik/KDMmbik8PDI0fG88PDE4fGk8PDEyfGE8PDZ8czooMSZuKTw8MzB8bzw8MjR8aTw8MTh8YTw8MTJ8czw8Nnw2MyZlW3QrK10pKSxuPDY1NTM2KXUrPVN0cmluZy5mcm9tQ2hhckNvZGUobik7ZWxzZXt2YXIgYz1uLTY1NTM2O3UrPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8Yz4+MTAsNTYzMjB8MTAyMyZjKX1lbHNlIHUrPVN0cmluZy5mcm9tQ2hhckNvZGUoKDMxJm4pPDw2fG8pO2Vsc2UgdSs9U3RyaW5nLmZyb21DaGFyQ29kZShuKX19ZnVuY3Rpb24gYihlKXtyZXR1cm4gXyhPLGUpfWZ1bmN0aW9uIEEoZSx0LHIsbil7aWYoIShuPjApKXJldHVybiAwO2Zvcih2YXIgbz1yLGk9cituLTEsYT0wO2E8ZS5sZW5ndGg7KythKXt2YXIgcz1lLmNoYXJDb2RlQXQoYSk7aWYocz49NTUyOTYmJnM8PTU3MzQzJiYocz02NTUzNisoKDEwMjMmcyk8PDEwKXwxMDIzJmUuY2hhckNvZGVBdCgrK2EpKSxzPD0xMjcpe2lmKHI+PWkpYnJlYWs7dFtyKytdPXN9ZWxzZSBpZihzPD0yMDQ3KXtpZihyKzE+PWkpYnJlYWs7dFtyKytdPTE5MnxzPj42LHRbcisrXT0xMjh8NjMmc31lbHNlIGlmKHM8PTY1NTM1KXtpZihyKzI+PWkpYnJlYWs7dFtyKytdPTIyNHxzPj4xMix0W3IrK109MTI4fHM+PjYmNjMsdFtyKytdPTEyOHw2MyZzfWVsc2UgaWYoczw9MjA5NzE1MSl7aWYociszPj1pKWJyZWFrO3RbcisrXT0yNDB8cz4+MTgsdFtyKytdPTEyOHxzPj4xMiY2Myx0W3IrK109MTI4fHM+PjYmNjMsdFtyKytdPTEyOHw2MyZzfWVsc2UgaWYoczw9NjcxMDg4NjMpe2lmKHIrND49aSlicmVhazt0W3IrK109MjQ4fHM+PjI0LHRbcisrXT0xMjh8cz4+MTgmNjMsdFtyKytdPTEyOHxzPj4xMiY2Myx0W3IrK109MTI4fHM+PjYmNjMsdFtyKytdPTEyOHw2MyZzfWVsc2V7aWYocis1Pj1pKWJyZWFrO3RbcisrXT0yNTJ8cz4+MzAsdFtyKytdPTEyOHxzPj4yNCY2Myx0W3IrK109MTI4fHM+PjE4JjYzLHRbcisrXT0xMjh8cz4+MTImNjMsdFtyKytdPTEyOHxzPj42JjYzLHRbcisrXT0xMjh8NjMmc319cmV0dXJuIHRbcl09MCxyLW99ZnVuY3Rpb24gVChlLHQscil7cmV0dXJuIEEoZSxPLHQscil9ZnVuY3Rpb24gUyhlKXtmb3IodmFyIHQ9MCxyPTA7cjxlLmxlbmd0aDsrK3Ipe3ZhciBuPWUuY2hhckNvZGVBdChyKTtuPj01NTI5NiYmbjw9NTczNDMmJihuPTY1NTM2KygoMTAyMyZuKTw8MTApfDEwMjMmZS5jaGFyQ29kZUF0KCsrcikpLG48PTEyNz8rK3Q6dCs9bjw9MjA0Nz8yOm48PTY1NTM1PzM6bjw9MjA5NzE1MT80Om48PTY3MTA4ODYzPzU6Nn1yZXR1cm4gdH0idW5kZWZpbmVkIiE9dHlwZW9mIFRleHREZWNvZGVyJiZuZXcgVGV4dERlY29kZXIoInV0Zi0xNmxlIik7ZnVuY3Rpb24gayhlKXtmb3IodmFyIHQ9MCxyPSIiOzspe3ZhciBuPUZbZSs0KnQ+PjJdO2lmKDA9PW4pcmV0dXJuIHI7aWYoKyt0LG4+PTY1NTM2KXt2YXIgbz1uLTY1NTM2O3IrPVN0cmluZy5mcm9tQ2hhckNvZGUoNTUyOTZ8bz4+MTAsNTYzMjB8MTAyMyZvKX1lbHNlIHIrPVN0cmluZy5mcm9tQ2hhckNvZGUobil9fWZ1bmN0aW9uIFAoKXt2YXIgZT1mdW5jdGlvbigpe3ZhciBlPW5ldyBFcnJvcjtpZighZS5zdGFjayl7dHJ5e3Rocm93IG5ldyBFcnJvcigwKX1jYXRjaCh0KXtlPXR9aWYoIWUuc3RhY2spcmV0dXJuIihubyBzdGFjayB0cmFjZSBhdmFpbGFibGUpIn1yZXR1cm4gZS5zdGFjay50b1N0cmluZygpfSgpO3JldHVybiBvLmV4dHJhU3RhY2tUcmFjZSYmKGUrPSJcbiIrby5leHRyYVN0YWNrVHJhY2UoKSksZS5yZXBsYWNlKC9fX1pbXHdcZF9dKy9nLChmdW5jdGlvbihlKXtyZXR1cm4gZT09ZT9lOmUrIiBbIitlKyJdIn0pKX12YXIgRCxSLE8sQyxOLEYsTSxJLEIsTCx4LGosVSx6LCQ7ZnVuY3Rpb24gVyhlLHQpe3JldHVybiBlJXQ+MCYmKGUrPXQtZSV0KSxlfWZ1bmN0aW9uIFkoZSl7by5idWZmZXI9RD1lfWZ1bmN0aW9uIFYoKXtvLkhFQVA4PVI9bmV3IEludDhBcnJheShEKSxvLkhFQVAxNj1DPW5ldyBJbnQxNkFycmF5KEQpLG8uSEVBUDMyPUY9bmV3IEludDMyQXJyYXkoRCksby5IRUFQVTg9Tz1uZXcgVWludDhBcnJheShEKSxvLkhFQVBVMTY9Tj1uZXcgVWludDE2QXJyYXkoRCksby5IRUFQVTMyPU09bmV3IFVpbnQzMkFycmF5KEQpLG8uSEVBUEYzMj1JPW5ldyBGbG9hdDMyQXJyYXkoRCksby5IRUFQRjY0PUI9bmV3IEZsb2F0NjRBcnJheShEKX1mdW5jdGlvbiBIKCl7dmFyIGU9by51c2luZ1dhc20/NjU1MzY6MTY3NzcyMTYsdD0yMTQ3NDgzNjQ4LWU7aWYoRlskPj4yXT50KXJldHVybiExO3ZhciByPXE7Zm9yKHE9TWF0aC5tYXgocSwxNjc3NzIxNik7cTxGWyQ+PjJdOylxPXE8PTUzNjg3MDkxMj9XKDIqcSxlKTpNYXRoLm1pbihXKCgzKnErMjE0NzQ4MzY0OCkvNCxlKSx0KTt2YXIgbj1vLnJlYWxsb2NCdWZmZXIocSk7cmV0dXJuIG4mJm4uYnl0ZUxlbmd0aD09cT8oWShuKSxWKCksITApOihxPXIsITEpfUw9VT0kPTAseD0hMSxvLnJlYWxsb2NCdWZmZXJ8fChvLnJlYWxsb2NCdWZmZXI9ZnVuY3Rpb24oZSl7dmFyIHQ7dHJ5e2lmKEFycmF5QnVmZmVyLnRyYW5zZmVyKXQ9QXJyYXlCdWZmZXIudHJhbnNmZXIoRCxlKTtlbHNle3ZhciByPVI7dD1uZXcgQXJyYXlCdWZmZXIoZSksbmV3IEludDhBcnJheSh0KS5zZXQocil9fWNhdGNoKGUpe3JldHVybiExfXJldHVybiEhWHQodCkmJnR9KTt0cnl7RnVuY3Rpb24ucHJvdG90eXBlLmNhbGwuYmluZChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEFycmF5QnVmZmVyLnByb3RvdHlwZSwiYnl0ZUxlbmd0aCIpLmdldCkobmV3IEFycmF5QnVmZmVyKDQpKX1jYXRjaChlKXsoZnVuY3Rpb24oZSl7cmV0dXJuIGUuYnl0ZUxlbmd0aH0pfXZhciBHPW8uVE9UQUxfU1RBQ0t8fDUyNDI4ODAscT1vLlRPVEFMX01FTU9SWXx8MTY3NzcyMTY7aWYocTxHJiZvLnByaW50RXJyKCJUT1RBTF9NRU1PUlkgc2hvdWxkIGJlIGxhcmdlciB0aGFuIFRPVEFMX1NUQUNLLCB3YXMgIitxKyIhIChUT1RBTF9TVEFDSz0iK0crIikiKSxvLmJ1ZmZlcj9EPW8uYnVmZmVyOigib2JqZWN0Ij09dHlwZW9mIFdlYkFzc2VtYmx5JiYiZnVuY3Rpb24iPT10eXBlb2YgV2ViQXNzZW1ibHkuTWVtb3J5PyhvLndhc21NZW1vcnk9bmV3IFdlYkFzc2VtYmx5Lk1lbW9yeSh7aW5pdGlhbDpxLzY1NTM2fSksRD1vLndhc21NZW1vcnkuYnVmZmVyKTpEPW5ldyBBcnJheUJ1ZmZlcihxKSxvLmJ1ZmZlcj1EKSxWKCksRlswXT0xNjY4NTA5MDI5LENbMV09MjU0NTksMTE1IT09T1syXXx8OTkhPT1PWzNdKXRocm93IlJ1bnRpbWUgZXJyb3I6IGV4cGVjdGVkIHRoZSBzeXN0ZW0gdG8gYmUgbGl0dGxlLWVuZGlhbiEiO2Z1bmN0aW9uIFgoZSl7Zm9yKDtlLmxlbmd0aD4wOyl7dmFyIHQ9ZS5zaGlmdCgpO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0KXt2YXIgcj10LmZ1bmM7Im51bWJlciI9PXR5cGVvZiByP3ZvaWQgMD09PXQuYXJnP28uZHluQ2FsbF92KHIpOm8uZHluQ2FsbF92aShyLHQuYXJnKTpyKHZvaWQgMD09PXQuYXJnP251bGw6dC5hcmcpfWVsc2UgdCgpfX12YXIgSz1bXSxKPVtdLFo9W10sUT1bXSxlZT1bXSx0ZT0hMTtmdW5jdGlvbiByZShlLHQscil7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDsrK24pUlt0Kys+PjBdPWUuY2hhckNvZGVBdChuKTtyfHwoUlt0Pj4wXT0wKX12YXIgbmU9TWF0aC5hYnMsb2U9TWF0aC5jZWlsLGllPU1hdGguZmxvb3IsYWU9TWF0aC5taW4sc2U9MCx1ZT1udWxsO2Z1bmN0aW9uIGNlKGUpe3NlKyssby5tb25pdG9yUnVuRGVwZW5kZW5jaWVzJiZvLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMoc2UpfWZ1bmN0aW9uIGxlKGUpe2lmKHNlLS0sby5tb25pdG9yUnVuRGVwZW5kZW5jaWVzJiZvLm1vbml0b3JSdW5EZXBlbmRlbmNpZXMoc2UpLDA9PXNlJiZ1ZSl7dmFyIHQ9dWU7dWU9bnVsbCx0KCl9fW8ucHJlbG9hZGVkSW1hZ2VzPXt9LG8ucHJlbG9hZGVkQXVkaW9zPXt9O2Z1bmN0aW9uIGZlKGUpe3JldHVybiBTdHJpbmcucHJvdG90eXBlLnN0YXJ0c1dpdGg/ZS5zdGFydHNXaXRoKCJkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsIik6MD09PWUuaW5kZXhPZigiZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LCIpfSFmdW5jdGlvbigpe3ZhciB0PSJ1bnBhY2sud2FzdCIscj0idW5wYWNrLnRlbXAuYXNtLmpzIjsiZnVuY3Rpb24iPT10eXBlb2Ygby5sb2NhdGVGaWxlJiYoZmUodCl8fCh0PW8ubG9jYXRlRmlsZSh0KSksZmUoZSl8fChlPW8ubG9jYXRlRmlsZShlKSksZmUocil8fChyPW8ubG9jYXRlRmlsZShyKSkpO3ZhciBuPXtnbG9iYWw6bnVsbCxlbnY6bnVsbCxhc20yd2FzbTp7ImY2NC1yZW0iOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUldH0sZGVidWdnZXI6ZnVuY3Rpb24oKXt9fSxwYXJlbnQ6b30saT1udWxsO2Z1bmN0aW9uIGEoKXt0cnl7aWYoby53YXNtQmluYXJ5KXJldHVybiBuZXcgVWludDhBcnJheShvLndhc21CaW5hcnkpO2lmKG8ucmVhZEJpbmFyeSlyZXR1cm4gby5yZWFkQmluYXJ5KGUpO3Rocm93Im9uIHRoZSB3ZWIsIHdlIG5lZWQgdGhlIHdhc20gYmluYXJ5IHRvIGJlIHByZWxvYWRlZCBhbmQgc2V0IG9uIE1vZHVsZVsnd2FzbUJpbmFyeSddLiBlbWNjLnB5IHdpbGwgZG8gdGhhdCBmb3IgeW91IHdoZW4gZ2VuZXJhdGluZyBIVE1MIChidXQgbm90IEpTKSJ9Y2F0Y2goZSl7cnIoZSl9fWZ1bmN0aW9uIHModCxyLHMpe2lmKCJvYmplY3QiIT10eXBlb2YgV2ViQXNzZW1ibHkpcmV0dXJuIG8ucHJpbnRFcnIoIm5vIG5hdGl2ZSB3YXNtIHN1cHBvcnQgZGV0ZWN0ZWQiKSwhMTtpZighKG8ud2FzbU1lbW9yeSBpbnN0YW5jZW9mIFdlYkFzc2VtYmx5Lk1lbW9yeSkpcmV0dXJuIG8ucHJpbnRFcnIoIm5vIG5hdGl2ZSB3YXNtIE1lbW9yeSBpbiB1c2UiKSwhMTtmdW5jdGlvbiBsKGUsdCl7KGk9ZS5leHBvcnRzKS5tZW1vcnkmJmZ1bmN0aW9uKGUpe3ZhciB0PW8uYnVmZmVyO2UuYnl0ZUxlbmd0aDx0LmJ5dGVMZW5ndGgmJm8ucHJpbnRFcnIoInRoZSBuZXcgYnVmZmVyIGluIG1lcmdlTWVtb3J5IGlzIHNtYWxsZXIgdGhhbiB0aGUgcHJldmlvdXMgb25lLiBpbiBuYXRpdmUgd2FzbSwgd2Ugc2hvdWxkIGdyb3cgbWVtb3J5IGhlcmUiKTt2YXIgcj1uZXcgSW50OEFycmF5KHQpO25ldyBJbnQ4QXJyYXkoZSkuc2V0KHIpLFkoZSksVigpfShpLm1lbW9yeSksby5hc209aSxvLnVzaW5nV2FzbT0hMCxsZSgpfWlmKHIubWVtb3J5PW8ud2FzbU1lbW9yeSxuLmdsb2JhbD17TmFOOk5hTixJbmZpbml0eToxLzB9LG5bImdsb2JhbC5NYXRoIl09TWF0aCxuLmVudj1yLGNlKCksby5pbnN0YW50aWF0ZVdhc20pdHJ5e3JldHVybiBvLmluc3RhbnRpYXRlV2FzbShuLGwpfWNhdGNoKGUpe3JldHVybiBvLnByaW50RXJyKCJNb2R1bGUuaW5zdGFudGlhdGVXYXNtIGNhbGxiYWNrIGZhaWxlZCB3aXRoIGVycm9yOiAiK2UpLCExfWZ1bmN0aW9uIGYoZSl7bChlLmluc3RhbmNlLGUubW9kdWxlKX1mdW5jdGlvbiBkKHQpeyhvLndhc21CaW5hcnl8fCF1JiYhY3x8ImZ1bmN0aW9uIiE9dHlwZW9mIGZldGNoP25ldyBQcm9taXNlKChmdW5jdGlvbihlLHQpe2UoYSgpKX0pKTpmZXRjaChlLHtjcmVkZW50aWFsczoib21pdCJ9KS50aGVuKChmdW5jdGlvbih0KXtpZighdC5vayl0aHJvdyJmYWlsZWQgdG8gbG9hZCB3YXNtIGJpbmFyeSBmaWxlIGF0ICciK2UrIiciO3JldHVybiB0LmFycmF5QnVmZmVyKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKCl7cmV0dXJuIGEoKX0pKSkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuIFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGUsbil9KSkudGhlbih0KS5jYXRjaCgoZnVuY3Rpb24oZSl7by5wcmludEVycigiZmFpbGVkIHRvIGFzeW5jaHJvbm91c2x5IHByZXBhcmUgd2FzbTogIitlKSxycihlKX0pKX1yZXR1cm4gby53YXNtQmluYXJ5fHwiZnVuY3Rpb24iIT10eXBlb2YgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGVTdHJlYW1pbmd8fGZlKGUpfHwiZnVuY3Rpb24iIT10eXBlb2YgZmV0Y2g/ZChmKTpXZWJBc3NlbWJseS5pbnN0YW50aWF0ZVN0cmVhbWluZyhmZXRjaChlLHtjcmVkZW50aWFsczoib21pdCJ9KSxuKS50aGVuKGYpLmNhdGNoKChmdW5jdGlvbihlKXtvLnByaW50RXJyKCJ3YXNtIHN0cmVhbWluZyBjb21waWxlIGZhaWxlZDogIitlKSxvLnByaW50RXJyKCJmYWxsaW5nIGJhY2sgdG8gQXJyYXlCdWZmZXIgaW5zdGFudGlhdGlvbiIpLGQoZil9KSkse319by5hc21QcmVsb2FkPW8uYXNtLG8ucmVhbGxvY0J1ZmZlcj1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oZSl7ZT1XKGUsby51c2luZ1dhc20/NjU1MzY6MTY3NzcyMTYpO3ZhciB0PW8uYnVmZmVyLmJ5dGVMZW5ndGg7aWYoby51c2luZ1dhc20pdHJ5e3JldHVybi0xIT09by53YXNtTWVtb3J5Lmdyb3coKGUtdCkvNjU1MzYpP28uYnVmZmVyPW8ud2FzbU1lbW9yeS5idWZmZXI6bnVsbH1jYXRjaChlKXtyZXR1cm4gbnVsbH19KGUpfSxvLmFzbT1mdW5jdGlvbihlLHQscil7aWYoISh0PXQpLnRhYmxlKXt2YXIgbj1vLndhc21UYWJsZVNpemU7dm9pZCAwPT09biYmKG49MTAyNCk7dmFyIGk9by53YXNtTWF4VGFibGVTaXplOyJvYmplY3QiPT10eXBlb2YgV2ViQXNzZW1ibHkmJiJmdW5jdGlvbiI9PXR5cGVvZiBXZWJBc3NlbWJseS5UYWJsZT90LnRhYmxlPXZvaWQgMCE9PWk/bmV3IFdlYkFzc2VtYmx5LlRhYmxlKHtpbml0aWFsOm4sbWF4aW11bTppLGVsZW1lbnQ6ImFueWZ1bmMifSk6bmV3IFdlYkFzc2VtYmx5LlRhYmxlKHtpbml0aWFsOm4sZWxlbWVudDoiYW55ZnVuYyJ9KTp0LnRhYmxlPW5ldyBBcnJheShuKSxvLndhc21UYWJsZT10LnRhYmxlfXZhciBhO3JldHVybiB0Lm1lbW9yeUJhc2V8fCh0Lm1lbW9yeUJhc2U9by5TVEFUSUNfQkFTRSksdC50YWJsZUJhc2V8fCh0LnRhYmxlQmFzZT0wKSwoYT1zKDAsdCkpfHxycigibm8gYmluYXJ5ZW4gbWV0aG9kIHN1Y2NlZWRlZC4gY29uc2lkZXIgZW5hYmxpbmcgbW9yZSBvcHRpb25zLCBsaWtlIGludGVycHJldGluZywgaWYgeW91IHdhbnQgdGhhdDogaHR0cHM6Ly9naXRodWIuY29tL2tyaXBrZW4vZW1zY3JpcHRlbi93aWtpL1dlYkFzc2VtYmx5I2JpbmFyeWVuLW1ldGhvZHMiKSxhfX0oKSxMPTY3OTg0LEoucHVzaCh7ZnVuYzpmdW5jdGlvbigpe0d0KCl9fSx7ZnVuYzpmdW5jdGlvbigpe0h0KCl9fSx7ZnVuYzpmdW5jdGlvbigpe1Z0KCl9fSx7ZnVuYzpmdW5jdGlvbigpe1l0KCl9fSk7by5TVEFUSUNfQkFTRT0xMDI0LG8uU1RBVElDX0JVTVA9NjY5NjAsTCs9MTY7dmFyIGRlPXtsYXN0OjAsY2F1Z2h0OltdLGluZm9zOnt9LGRlQWRqdXN0OmZ1bmN0aW9uKGUpe2lmKCFlfHxkZS5pbmZvc1tlXSlyZXR1cm4gZTtmb3IodmFyIHQgaW4gZGUuaW5mb3Mpe3ZhciByPSt0O2lmKGRlLmluZm9zW3JdLmFkanVzdGVkPT09ZSlyZXR1cm4gcn1yZXR1cm4gZX0sYWRkUmVmOmZ1bmN0aW9uKGUpe2UmJmRlLmluZm9zW2VdLnJlZmNvdW50Kyt9LGRlY1JlZjpmdW5jdGlvbihlKXtpZihlKXt2YXIgdD1kZS5pbmZvc1tlXTt5KHQucmVmY291bnQ+MCksdC5yZWZjb3VudC0tLDAhPT10LnJlZmNvdW50fHx0LnJldGhyb3dufHwodC5kZXN0cnVjdG9yJiZvLmR5bkNhbGxfdmkodC5kZXN0cnVjdG9yLGUpLGRlbGV0ZSBkZS5pbmZvc1tlXSxoZShlKSl9fSxjbGVhclJlZjpmdW5jdGlvbihlKXtlJiYoZGUuaW5mb3NbZV0ucmVmY291bnQ9MCl9fTtmdW5jdGlvbiBoZShlKXt0cnl7cmV0dXJuIEt0KGUpfWNhdGNoKGUpe319ZnVuY3Rpb24gcGUoKXt2YXIgZT1kZS5sYXN0O2lmKCFlKXJldHVybiAwfChadCgwKSwwKTt2YXIgdD1kZS5pbmZvc1tlXSxyPXQudHlwZTtpZighcilyZXR1cm4gMHwoWnQoMCksZSk7dmFyIG49QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtvLl9fX2N4YV9pc19wb2ludGVyX3R5cGUocik7cGUuYnVmZmVyfHwocGUuYnVmZmVyPUp0KDQpKSxGW3BlLmJ1ZmZlcj4+Ml09ZSxlPXBlLmJ1ZmZlcjtmb3IodmFyIGk9MDtpPG4ubGVuZ3RoO2krKylpZihuW2ldJiZvLl9fX2N4YV9jYW5fY2F0Y2gobltpXSxyLGUpKXJldHVybiBlPUZbZT4+Ml0sdC5hZGp1c3RlZD1lLDB8KFp0KG5baV0pLGUpO3JldHVybiBlPUZbZT4+Ml0sMHwoWnQociksZSl9dmFyIG1lPXtFUEVSTToxLEVOT0VOVDoyLEVTUkNIOjMsRUlOVFI6NCxFSU86NSxFTlhJTzo2LEUyQklHOjcsRU5PRVhFQzo4LEVCQURGOjksRUNISUxEOjEwLEVBR0FJTjoxMSxFV09VTERCTE9DSzoxMSxFTk9NRU06MTIsRUFDQ0VTOjEzLEVGQVVMVDoxNCxFTk9UQkxLOjE1LEVCVVNZOjE2LEVFWElTVDoxNyxFWERFVjoxOCxFTk9ERVY6MTksRU5PVERJUjoyMCxFSVNESVI6MjEsRUlOVkFMOjIyLEVORklMRToyMyxFTUZJTEU6MjQsRU5PVFRZOjI1LEVUWFRCU1k6MjYsRUZCSUc6MjcsRU5PU1BDOjI4LEVTUElQRToyOSxFUk9GUzozMCxFTUxJTks6MzEsRVBJUEU6MzIsRURPTTozMyxFUkFOR0U6MzQsRU5PTVNHOjQyLEVJRFJNOjQzLEVDSFJORzo0NCxFTDJOU1lOQzo0NSxFTDNITFQ6NDYsRUwzUlNUOjQ3LEVMTlJORzo0OCxFVU5BVENIOjQ5LEVOT0NTSTo1MCxFTDJITFQ6NTEsRURFQURMSzozNSxFTk9MQ0s6MzcsRUJBREU6NTIsRUJBRFI6NTMsRVhGVUxMOjU0LEVOT0FOTzo1NSxFQkFEUlFDOjU2LEVCQURTTFQ6NTcsRURFQURMT0NLOjM1LEVCRk9OVDo1OSxFTk9TVFI6NjAsRU5PREFUQTo2MSxFVElNRTo2MixFTk9TUjo2MyxFTk9ORVQ6NjQsRU5PUEtHOjY1LEVSRU1PVEU6NjYsRU5PTElOSzo2NyxFQURWOjY4LEVTUk1OVDo2OSxFQ09NTTo3MCxFUFJPVE86NzEsRU1VTFRJSE9QOjcyLEVET1RET1Q6NzMsRUJBRE1TRzo3NCxFTk9UVU5JUTo3NixFQkFERkQ6NzcsRVJFTUNIRzo3OCxFTElCQUNDOjc5LEVMSUJCQUQ6ODAsRUxJQlNDTjo4MSxFTElCTUFYOjgyLEVMSUJFWEVDOjgzLEVOT1NZUzozOCxFTk9URU1QVFk6MzksRU5BTUVUT09MT05HOjM2LEVMT09QOjQwLEVPUE5PVFNVUFA6OTUsRVBGTk9TVVBQT1JUOjk2LEVDT05OUkVTRVQ6MTA0LEVOT0JVRlM6MTA1LEVBRk5PU1VQUE9SVDo5NyxFUFJPVE9UWVBFOjkxLEVOT1RTT0NLOjg4LEVOT1BST1RPT1BUOjkyLEVTSFVURE9XTjoxMDgsRUNPTk5SRUZVU0VEOjExMSxFQUREUklOVVNFOjk4LEVDT05OQUJPUlRFRDoxMDMsRU5FVFVOUkVBQ0g6MTAxLEVORVRET1dOOjEwMCxFVElNRURPVVQ6MTEwLEVIT1NURE9XTjoxMTIsRUhPU1RVTlJFQUNIOjExMyxFSU5QUk9HUkVTUzoxMTUsRUFMUkVBRFk6MTE0LEVERVNUQUREUlJFUTo4OSxFTVNHU0laRTo5MCxFUFJPVE9OT1NVUFBPUlQ6OTMsRVNPQ0tUTk9TVVBQT1JUOjk0LEVBRERSTk9UQVZBSUw6OTksRU5FVFJFU0VUOjEwMixFSVNDT05OOjEwNixFTk9UQ09OTjoxMDcsRVRPT01BTllSRUZTOjEwOSxFVVNFUlM6ODcsRURRVU9UOjEyMixFU1RBTEU6MTE2LEVOT1RTVVA6OTUsRU5PTUVESVVNOjEyMyxFSUxTRVE6ODQsRU9WRVJGTE9XOjc1LEVDQU5DRUxFRDoxMjUsRU5PVFJFQ09WRVJBQkxFOjEzMSxFT1dORVJERUFEOjEzMCxFU1RSUElQRTo4Nn07ZnVuY3Rpb24geWUoZSl7cmV0dXJuIG8uX19fZXJybm9fbG9jYXRpb24mJihGW28uX19fZXJybm9fbG9jYXRpb24oKT4+Ml09ZSksZX12YXIgRWU9ezA6IlN1Y2Nlc3MiLDE6Ik5vdCBzdXBlci11c2VyIiwyOiJObyBzdWNoIGZpbGUgb3IgZGlyZWN0b3J5IiwzOiJObyBzdWNoIHByb2Nlc3MiLDQ6IkludGVycnVwdGVkIHN5c3RlbSBjYWxsIiw1OiJJL08gZXJyb3IiLDY6Ik5vIHN1Y2ggZGV2aWNlIG9yIGFkZHJlc3MiLDc6IkFyZyBsaXN0IHRvbyBsb25nIiw4OiJFeGVjIGZvcm1hdCBlcnJvciIsOToiQmFkIGZpbGUgbnVtYmVyIiwxMDoiTm8gY2hpbGRyZW4iLDExOiJObyBtb3JlIHByb2Nlc3NlcyIsMTI6Ik5vdCBlbm91Z2ggY29yZSIsMTM6IlBlcm1pc3Npb24gZGVuaWVkIiwxNDoiQmFkIGFkZHJlc3MiLDE1OiJCbG9jayBkZXZpY2UgcmVxdWlyZWQiLDE2OiJNb3VudCBkZXZpY2UgYnVzeSIsMTc6IkZpbGUgZXhpc3RzIiwxODoiQ3Jvc3MtZGV2aWNlIGxpbmsiLDE5OiJObyBzdWNoIGRldmljZSIsMjA6Ik5vdCBhIGRpcmVjdG9yeSIsMjE6IklzIGEgZGlyZWN0b3J5IiwyMjoiSW52YWxpZCBhcmd1bWVudCIsMjM6IlRvbyBtYW55IG9wZW4gZmlsZXMgaW4gc3lzdGVtIiwyNDoiVG9vIG1hbnkgb3BlbiBmaWxlcyIsMjU6Ik5vdCBhIHR5cGV3cml0ZXIiLDI2OiJUZXh0IGZpbGUgYnVzeSIsMjc6IkZpbGUgdG9vIGxhcmdlIiwyODoiTm8gc3BhY2UgbGVmdCBvbiBkZXZpY2UiLDI5OiJJbGxlZ2FsIHNlZWsiLDMwOiJSZWFkIG9ubHkgZmlsZSBzeXN0ZW0iLDMxOiJUb28gbWFueSBsaW5rcyIsMzI6IkJyb2tlbiBwaXBlIiwzMzoiTWF0aCBhcmcgb3V0IG9mIGRvbWFpbiBvZiBmdW5jIiwzNDoiTWF0aCByZXN1bHQgbm90IHJlcHJlc2VudGFibGUiLDM1OiJGaWxlIGxvY2tpbmcgZGVhZGxvY2sgZXJyb3IiLDM2OiJGaWxlIG9yIHBhdGggbmFtZSB0b28gbG9uZyIsMzc6Ik5vIHJlY29yZCBsb2NrcyBhdmFpbGFibGUiLDM4OiJGdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQiLDM5OiJEaXJlY3Rvcnkgbm90IGVtcHR5Iiw0MDoiVG9vIG1hbnkgc3ltYm9saWMgbGlua3MiLDQyOiJObyBtZXNzYWdlIG9mIGRlc2lyZWQgdHlwZSIsNDM6IklkZW50aWZpZXIgcmVtb3ZlZCIsNDQ6IkNoYW5uZWwgbnVtYmVyIG91dCBvZiByYW5nZSIsNDU6IkxldmVsIDIgbm90IHN5bmNocm9uaXplZCIsNDY6IkxldmVsIDMgaGFsdGVkIiw0NzoiTGV2ZWwgMyByZXNldCIsNDg6IkxpbmsgbnVtYmVyIG91dCBvZiByYW5nZSIsNDk6IlByb3RvY29sIGRyaXZlciBub3QgYXR0YWNoZWQiLDUwOiJObyBDU0kgc3RydWN0dXJlIGF2YWlsYWJsZSIsNTE6IkxldmVsIDIgaGFsdGVkIiw1MjoiSW52YWxpZCBleGNoYW5nZSIsNTM6IkludmFsaWQgcmVxdWVzdCBkZXNjcmlwdG9yIiw1NDoiRXhjaGFuZ2UgZnVsbCIsNTU6Ik5vIGFub2RlIiw1NjoiSW52YWxpZCByZXF1ZXN0IGNvZGUiLDU3OiJJbnZhbGlkIHNsb3QiLDU5OiJCYWQgZm9udCBmaWxlIGZtdCIsNjA6IkRldmljZSBub3QgYSBzdHJlYW0iLDYxOiJObyBkYXRhIChmb3Igbm8gZGVsYXkgaW8pIiw2MjoiVGltZXIgZXhwaXJlZCIsNjM6Ik91dCBvZiBzdHJlYW1zIHJlc291cmNlcyIsNjQ6Ik1hY2hpbmUgaXMgbm90IG9uIHRoZSBuZXR3b3JrIiw2NToiUGFja2FnZSBub3QgaW5zdGFsbGVkIiw2NjoiVGhlIG9iamVjdCBpcyByZW1vdGUiLDY3OiJUaGUgbGluayBoYXMgYmVlbiBzZXZlcmVkIiw2ODoiQWR2ZXJ0aXNlIGVycm9yIiw2OToiU3Jtb3VudCBlcnJvciIsNzA6IkNvbW11bmljYXRpb24gZXJyb3Igb24gc2VuZCIsNzE6IlByb3RvY29sIGVycm9yIiw3MjoiTXVsdGlob3AgYXR0ZW1wdGVkIiw3MzoiQ3Jvc3MgbW91bnQgcG9pbnQgKG5vdCByZWFsbHkgZXJyb3IpIiw3NDoiVHJ5aW5nIHRvIHJlYWQgdW5yZWFkYWJsZSBtZXNzYWdlIiw3NToiVmFsdWUgdG9vIGxhcmdlIGZvciBkZWZpbmVkIGRhdGEgdHlwZSIsNzY6IkdpdmVuIGxvZy4gbmFtZSBub3QgdW5pcXVlIiw3NzoiZi5kLiBpbnZhbGlkIGZvciB0aGlzIG9wZXJhdGlvbiIsNzg6IlJlbW90ZSBhZGRyZXNzIGNoYW5nZWQiLDc5OiJDYW4gICBhY2Nlc3MgYSBuZWVkZWQgc2hhcmVkIGxpYiIsODA6IkFjY2Vzc2luZyBhIGNvcnJ1cHRlZCBzaGFyZWQgbGliIiw4MToiLmxpYiBzZWN0aW9uIGluIGEub3V0IGNvcnJ1cHRlZCIsODI6IkF0dGVtcHRpbmcgdG8gbGluayBpbiB0b28gbWFueSBsaWJzIiw4MzoiQXR0ZW1wdGluZyB0byBleGVjIGEgc2hhcmVkIGxpYnJhcnkiLDg0OiJJbGxlZ2FsIGJ5dGUgc2VxdWVuY2UiLDg2OiJTdHJlYW1zIHBpcGUgZXJyb3IiLDg3OiJUb28gbWFueSB1c2VycyIsODg6IlNvY2tldCBvcGVyYXRpb24gb24gbm9uLXNvY2tldCIsODk6IkRlc3RpbmF0aW9uIGFkZHJlc3MgcmVxdWlyZWQiLDkwOiJNZXNzYWdlIHRvbyBsb25nIiw5MToiUHJvdG9jb2wgd3JvbmcgdHlwZSBmb3Igc29ja2V0Iiw5MjoiUHJvdG9jb2wgbm90IGF2YWlsYWJsZSIsOTM6IlVua25vd24gcHJvdG9jb2wiLDk0OiJTb2NrZXQgdHlwZSBub3Qgc3VwcG9ydGVkIiw5NToiTm90IHN1cHBvcnRlZCIsOTY6IlByb3RvY29sIGZhbWlseSBub3Qgc3VwcG9ydGVkIiw5NzoiQWRkcmVzcyBmYW1pbHkgbm90IHN1cHBvcnRlZCBieSBwcm90b2NvbCBmYW1pbHkiLDk4OiJBZGRyZXNzIGFscmVhZHkgaW4gdXNlIiw5OToiQWRkcmVzcyBub3QgYXZhaWxhYmxlIiwxMDA6Ik5ldHdvcmsgaW50ZXJmYWNlIGlzIG5vdCBjb25maWd1cmVkIiwxMDE6Ik5ldHdvcmsgaXMgdW5yZWFjaGFibGUiLDEwMjoiQ29ubmVjdGlvbiByZXNldCBieSBuZXR3b3JrIiwxMDM6IkNvbm5lY3Rpb24gYWJvcnRlZCIsMTA0OiJDb25uZWN0aW9uIHJlc2V0IGJ5IHBlZXIiLDEwNToiTm8gYnVmZmVyIHNwYWNlIGF2YWlsYWJsZSIsMTA2OiJTb2NrZXQgaXMgYWxyZWFkeSBjb25uZWN0ZWQiLDEwNzoiU29ja2V0IGlzIG5vdCBjb25uZWN0ZWQiLDEwODoiQ2FuJ3Qgc2VuZCBhZnRlciBzb2NrZXQgc2h1dGRvd24iLDEwOToiVG9vIG1hbnkgcmVmZXJlbmNlcyIsMTEwOiJDb25uZWN0aW9uIHRpbWVkIG91dCIsMTExOiJDb25uZWN0aW9uIHJlZnVzZWQiLDExMjoiSG9zdCBpcyBkb3duIiwxMTM6Ikhvc3QgaXMgdW5yZWFjaGFibGUiLDExNDoiU29ja2V0IGFscmVhZHkgY29ubmVjdGVkIiwxMTU6IkNvbm5lY3Rpb24gYWxyZWFkeSBpbiBwcm9ncmVzcyIsMTE2OiJTdGFsZSBmaWxlIGhhbmRsZSIsMTIyOiJRdW90YSBleGNlZWRlZCIsMTIzOiJObyBtZWRpdW0gKGluIHRhcGUgZHJpdmUpIiwxMjU6Ik9wZXJhdGlvbiBjYW5jZWxlZCIsMTMwOiJQcmV2aW91cyBvd25lciBkaWVkIiwxMzE6IlN0YXRlIG5vdCByZWNvdmVyYWJsZSJ9LGdlPXtzcGxpdFBhdGg6ZnVuY3Rpb24oZSl7cmV0dXJuL14oXC8/fCkoW1xzXFNdKj8pKCg/OlwuezEsMn18W15cL10rP3wpKFwuW14uXC9dKnwpKSg/OltcL10qKSQvLmV4ZWMoZSkuc2xpY2UoMSl9LG5vcm1hbGl6ZUFycmF5OmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPTAsbj1lLmxlbmd0aC0xO24+PTA7bi0tKXt2YXIgbz1lW25dOyIuIj09PW8/ZS5zcGxpY2UobiwxKToiLi4iPT09bz8oZS5zcGxpY2UobiwxKSxyKyspOnImJihlLnNwbGljZShuLDEpLHItLSl9aWYodClmb3IoO3I7ci0tKWUudW5zaGlmdCgiLi4iKTtyZXR1cm4gZX0sbm9ybWFsaXplOmZ1bmN0aW9uKGUpe3ZhciB0PSIvIj09PWUuY2hhckF0KDApLHI9Ii8iPT09ZS5zdWJzdHIoLTEpO3JldHVybihlPWdlLm5vcm1hbGl6ZUFycmF5KGUuc3BsaXQoIi8iKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhdCkuam9pbigiLyIpKXx8dHx8KGU9Ii4iKSxlJiZyJiYoZSs9Ii8iKSwodD8iLyI6IiIpK2V9LGRpcm5hbWU6ZnVuY3Rpb24oZSl7dmFyIHQ9Z2Uuc3BsaXRQYXRoKGUpLHI9dFswXSxuPXRbMV07cmV0dXJuIHJ8fG4/KG4mJihuPW4uc3Vic3RyKDAsbi5sZW5ndGgtMSkpLHIrbik6Ii4ifSxiYXNlbmFtZTpmdW5jdGlvbihlKXtpZigiLyI9PT1lKXJldHVybiIvIjt2YXIgdD1lLmxhc3RJbmRleE9mKCIvIik7cmV0dXJuLTE9PT10P2U6ZS5zdWJzdHIodCsxKX0sZXh0bmFtZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2Uuc3BsaXRQYXRoKGUpWzNdfSxqb2luOmZ1bmN0aW9uKCl7dmFyIGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApO3JldHVybiBnZS5ub3JtYWxpemUoZS5qb2luKCIvIikpfSxqb2luMjpmdW5jdGlvbihlLHQpe3JldHVybiBnZS5ub3JtYWxpemUoZSsiLyIrdCl9LHJlc29sdmU6ZnVuY3Rpb24oKXtmb3IodmFyIGU9IiIsdD0hMSxyPWFyZ3VtZW50cy5sZW5ndGgtMTtyPj0tMSYmIXQ7ci0tKXt2YXIgbj1yPj0wP2FyZ3VtZW50c1tyXTpUZS5jd2QoKTtpZigic3RyaW5nIiE9dHlwZW9mIG4pdGhyb3cgbmV3IFR5cGVFcnJvcigiQXJndW1lbnRzIHRvIHBhdGgucmVzb2x2ZSBtdXN0IGJlIHN0cmluZ3MiKTtpZighbilyZXR1cm4iIjtlPW4rIi8iK2UsdD0iLyI9PT1uLmNoYXJBdCgwKX1yZXR1cm4odD8iLyI6IiIpKyhlPWdlLm5vcm1hbGl6ZUFycmF5KGUuc3BsaXQoIi8iKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhdCkuam9pbigiLyIpKXx8Ii4ifSxyZWxhdGl2ZTpmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIHIoZSl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aCYmIiI9PT1lW3RdO3QrKyk7Zm9yKHZhciByPWUubGVuZ3RoLTE7cj49MCYmIiI9PT1lW3JdO3ItLSk7cmV0dXJuIHQ+cj9bXTplLnNsaWNlKHQsci10KzEpfWU9Z2UucmVzb2x2ZShlKS5zdWJzdHIoMSksdD1nZS5yZXNvbHZlKHQpLnN1YnN0cigxKTtmb3IodmFyIG49cihlLnNwbGl0KCIvIikpLG89cih0LnNwbGl0KCIvIikpLGk9TWF0aC5taW4obi5sZW5ndGgsby5sZW5ndGgpLGE9aSxzPTA7czxpO3MrKylpZihuW3NdIT09b1tzXSl7YT1zO2JyZWFrfXZhciB1PVtdO2ZvcihzPWE7czxuLmxlbmd0aDtzKyspdS5wdXNoKCIuLiIpO3JldHVybih1PXUuY29uY2F0KG8uc2xpY2UoYSkpKS5qb2luKCIvIil9fSx2ZT17dHR5czpbXSxpbml0OmZ1bmN0aW9uKCl7fSxzaHV0ZG93bjpmdW5jdGlvbigpe30scmVnaXN0ZXI6ZnVuY3Rpb24oZSx0KXt2ZS50dHlzW2VdPXtpbnB1dDpbXSxvdXRwdXQ6W10sb3BzOnR9LFRlLnJlZ2lzdGVyRGV2aWNlKGUsdmUuc3RyZWFtX29wcyl9LHN0cmVhbV9vcHM6e29wZW46ZnVuY3Rpb24oZSl7dmFyIHQ9dmUudHR5c1tlLm5vZGUucmRldl07aWYoIXQpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PREVWKTtlLnR0eT10LGUuc2Vla2FibGU9ITF9LGNsb3NlOmZ1bmN0aW9uKGUpe2UudHR5Lm9wcy5mbHVzaChlLnR0eSl9LGZsdXNoOmZ1bmN0aW9uKGUpe2UudHR5Lm9wcy5mbHVzaChlLnR0eSl9LHJlYWQ6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighZS50dHl8fCFlLnR0eS5vcHMuZ2V0X2NoYXIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5YSU8pO2Zvcih2YXIgaT0wLGE9MDthPG47YSsrKXt2YXIgczt0cnl7cz1lLnR0eS5vcHMuZ2V0X2NoYXIoZS50dHkpfWNhdGNoKGUpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTyl9aWYodm9pZCAwPT09cyYmMD09PWkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUFHQUlOKTtpZihudWxsPT1zKWJyZWFrO2krKyx0W3IrYV09c31yZXR1cm4gaSYmKGUubm9kZS50aW1lc3RhbXA9RGF0ZS5ub3coKSksaX0sd3JpdGU6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighZS50dHl8fCFlLnR0eS5vcHMucHV0X2NoYXIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5YSU8pO2Zvcih2YXIgaT0wO2k8bjtpKyspdHJ5e2UudHR5Lm9wcy5wdXRfY2hhcihlLnR0eSx0W3IraV0pfWNhdGNoKGUpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTyl9cmV0dXJuIG4mJihlLm5vZGUudGltZXN0YW1wPURhdGUubm93KCkpLGl9fSxkZWZhdWx0X3R0eV9vcHM6e2dldF9jaGFyOmZ1bmN0aW9uKGUpe2lmKCFlLmlucHV0Lmxlbmd0aCl7dmFyIHQ9bnVsbDtpZihsKXt2YXIgcj1uZXcgQnVmZmVyKDI1Niksbj0wLG89IndpbjMyIiE9cHJvY2Vzcy5wbGF0Zm9ybSxpPXByb2Nlc3Muc3RkaW4uZmQ7aWYobyl7dmFyIGE9ITE7dHJ5e2k9ZnMub3BlblN5bmMoIi9kZXYvc3RkaW4iLCJyIiksYT0hMH1jYXRjaChlKXt9fXRyeXtuPWZzLnJlYWRTeW5jKGksciwwLDI1NixudWxsKX1jYXRjaChlKXtpZigtMT09ZS50b1N0cmluZygpLmluZGV4T2YoIkVPRiIpKXRocm93IGU7bj0wfWEmJmZzLmNsb3NlU3luYyhpKSx0PW4+MD9yLnNsaWNlKDAsbikudG9TdHJpbmcoInV0Zi04Iik6bnVsbH1lbHNlInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJiJmdW5jdGlvbiI9PXR5cGVvZiB3aW5kb3cucHJvbXB0P251bGwhPT0odD13aW5kb3cucHJvbXB0KCJJbnB1dDogIikpJiYodCs9IlxuIik6ImZ1bmN0aW9uIj09dHlwZW9mIHJlYWRsaW5lJiZudWxsIT09KHQ9cmVhZGxpbmUoKSkmJih0Kz0iXG4iKTtpZighdClyZXR1cm4gbnVsbDtlLmlucHV0PSR0KHQsITApfXJldHVybiBlLmlucHV0LnNoaWZ0KCl9LHB1dF9jaGFyOmZ1bmN0aW9uKGUsdCl7bnVsbD09PXR8fDEwPT09dD8oby5wcmludChfKGUub3V0cHV0LDApKSxlLm91dHB1dD1bXSk6MCE9dCYmZS5vdXRwdXQucHVzaCh0KX0sZmx1c2g6ZnVuY3Rpb24oZSl7ZS5vdXRwdXQmJmUub3V0cHV0Lmxlbmd0aD4wJiYoby5wcmludChfKGUub3V0cHV0LDApKSxlLm91dHB1dD1bXSl9fSxkZWZhdWx0X3R0eTFfb3BzOntwdXRfY2hhcjpmdW5jdGlvbihlLHQpe251bGw9PT10fHwxMD09PXQ/KG8ucHJpbnRFcnIoXyhlLm91dHB1dCwwKSksZS5vdXRwdXQ9W10pOjAhPXQmJmUub3V0cHV0LnB1c2godCl9LGZsdXNoOmZ1bmN0aW9uKGUpe2Uub3V0cHV0JiZlLm91dHB1dC5sZW5ndGg+MCYmKG8ucHJpbnRFcnIoXyhlLm91dHB1dCwwKSksZS5vdXRwdXQ9W10pfX19LHdlPXtvcHNfdGFibGU6bnVsbCxtb3VudDpmdW5jdGlvbihlKXtyZXR1cm4gd2UuY3JlYXRlTm9kZShudWxsLCIvIiwxNjg5NSwwKX0sY3JlYXRlTm9kZTpmdW5jdGlvbihlLHQscixuKXtpZihUZS5pc0Jsa2RldihyKXx8VGUuaXNGSUZPKHIpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKTt3ZS5vcHNfdGFibGV8fCh3ZS5vcHNfdGFibGU9e2Rpcjp7bm9kZTp7Z2V0YXR0cjp3ZS5ub2RlX29wcy5nZXRhdHRyLHNldGF0dHI6d2Uubm9kZV9vcHMuc2V0YXR0cixsb29rdXA6d2Uubm9kZV9vcHMubG9va3VwLG1rbm9kOndlLm5vZGVfb3BzLm1rbm9kLHJlbmFtZTp3ZS5ub2RlX29wcy5yZW5hbWUsdW5saW5rOndlLm5vZGVfb3BzLnVubGluayxybWRpcjp3ZS5ub2RlX29wcy5ybWRpcixyZWFkZGlyOndlLm5vZGVfb3BzLnJlYWRkaXIsc3ltbGluazp3ZS5ub2RlX29wcy5zeW1saW5rfSxzdHJlYW06e2xsc2Vlazp3ZS5zdHJlYW1fb3BzLmxsc2Vla319LGZpbGU6e25vZGU6e2dldGF0dHI6d2Uubm9kZV9vcHMuZ2V0YXR0cixzZXRhdHRyOndlLm5vZGVfb3BzLnNldGF0dHJ9LHN0cmVhbTp7bGxzZWVrOndlLnN0cmVhbV9vcHMubGxzZWVrLHJlYWQ6d2Uuc3RyZWFtX29wcy5yZWFkLHdyaXRlOndlLnN0cmVhbV9vcHMud3JpdGUsYWxsb2NhdGU6d2Uuc3RyZWFtX29wcy5hbGxvY2F0ZSxtbWFwOndlLnN0cmVhbV9vcHMubW1hcCxtc3luYzp3ZS5zdHJlYW1fb3BzLm1zeW5jfX0sbGluazp7bm9kZTp7Z2V0YXR0cjp3ZS5ub2RlX29wcy5nZXRhdHRyLHNldGF0dHI6d2Uubm9kZV9vcHMuc2V0YXR0cixyZWFkbGluazp3ZS5ub2RlX29wcy5yZWFkbGlua30sc3RyZWFtOnt9fSxjaHJkZXY6e25vZGU6e2dldGF0dHI6d2Uubm9kZV9vcHMuZ2V0YXR0cixzZXRhdHRyOndlLm5vZGVfb3BzLnNldGF0dHJ9LHN0cmVhbTpUZS5jaHJkZXZfc3RyZWFtX29wc319KTt2YXIgbz1UZS5jcmVhdGVOb2RlKGUsdCxyLG4pO3JldHVybiBUZS5pc0RpcihvLm1vZGUpPyhvLm5vZGVfb3BzPXdlLm9wc190YWJsZS5kaXIubm9kZSxvLnN0cmVhbV9vcHM9d2Uub3BzX3RhYmxlLmRpci5zdHJlYW0sby5jb250ZW50cz17fSk6VGUuaXNGaWxlKG8ubW9kZSk/KG8ubm9kZV9vcHM9d2Uub3BzX3RhYmxlLmZpbGUubm9kZSxvLnN0cmVhbV9vcHM9d2Uub3BzX3RhYmxlLmZpbGUuc3RyZWFtLG8udXNlZEJ5dGVzPTAsby5jb250ZW50cz1udWxsKTpUZS5pc0xpbmsoby5tb2RlKT8oby5ub2RlX29wcz13ZS5vcHNfdGFibGUubGluay5ub2RlLG8uc3RyZWFtX29wcz13ZS5vcHNfdGFibGUubGluay5zdHJlYW0pOlRlLmlzQ2hyZGV2KG8ubW9kZSkmJihvLm5vZGVfb3BzPXdlLm9wc190YWJsZS5jaHJkZXYubm9kZSxvLnN0cmVhbV9vcHM9d2Uub3BzX3RhYmxlLmNocmRldi5zdHJlYW0pLG8udGltZXN0YW1wPURhdGUubm93KCksZSYmKGUuY29udGVudHNbdF09byksb30sZ2V0RmlsZURhdGFBc1JlZ3VsYXJBcnJheTpmdW5jdGlvbihlKXtpZihlLmNvbnRlbnRzJiZlLmNvbnRlbnRzLnN1YmFycmF5KXtmb3IodmFyIHQ9W10scj0wO3I8ZS51c2VkQnl0ZXM7KytyKXQucHVzaChlLmNvbnRlbnRzW3JdKTtyZXR1cm4gdH1yZXR1cm4gZS5jb250ZW50c30sZ2V0RmlsZURhdGFBc1R5cGVkQXJyYXk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY29udGVudHM/ZS5jb250ZW50cy5zdWJhcnJheT9lLmNvbnRlbnRzLnN1YmFycmF5KDAsZS51c2VkQnl0ZXMpOm5ldyBVaW50OEFycmF5KGUuY29udGVudHMpOm5ldyBVaW50OEFycmF5fSxleHBhbmRGaWxlU3RvcmFnZTpmdW5jdGlvbihlLHQpe2lmKGUuY29udGVudHMmJmUuY29udGVudHMuc3ViYXJyYXkmJnQ+ZS5jb250ZW50cy5sZW5ndGgmJihlLmNvbnRlbnRzPXdlLmdldEZpbGVEYXRhQXNSZWd1bGFyQXJyYXkoZSksZS51c2VkQnl0ZXM9ZS5jb250ZW50cy5sZW5ndGgpLCFlLmNvbnRlbnRzfHxlLmNvbnRlbnRzLnN1YmFycmF5KXt2YXIgcj1lLmNvbnRlbnRzP2UuY29udGVudHMubGVuZ3RoOjA7aWYocj49dClyZXR1cm47dD1NYXRoLm1heCh0LHIqKHI8MTA0ODU3Nj8yOjEuMTI1KXwwKSwwIT1yJiYodD1NYXRoLm1heCh0LDI1NikpO3ZhciBuPWUuY29udGVudHM7cmV0dXJuIGUuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkodCksdm9pZChlLnVzZWRCeXRlcz4wJiZlLmNvbnRlbnRzLnNldChuLnN1YmFycmF5KDAsZS51c2VkQnl0ZXMpLDApKX1mb3IoIWUuY29udGVudHMmJnQ+MCYmKGUuY29udGVudHM9W10pO2UuY29udGVudHMubGVuZ3RoPHQ7KWUuY29udGVudHMucHVzaCgwKX0scmVzaXplRmlsZVN0b3JhZ2U6ZnVuY3Rpb24oZSx0KXtpZihlLnVzZWRCeXRlcyE9dCl7aWYoMD09dClyZXR1cm4gZS5jb250ZW50cz1udWxsLHZvaWQoZS51c2VkQnl0ZXM9MCk7aWYoIWUuY29udGVudHN8fGUuY29udGVudHMuc3ViYXJyYXkpe3ZhciByPWUuY29udGVudHM7cmV0dXJuIGUuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5QnVmZmVyKHQpKSxyJiZlLmNvbnRlbnRzLnNldChyLnN1YmFycmF5KDAsTWF0aC5taW4odCxlLnVzZWRCeXRlcykpKSx2b2lkKGUudXNlZEJ5dGVzPXQpfWlmKGUuY29udGVudHN8fChlLmNvbnRlbnRzPVtdKSxlLmNvbnRlbnRzLmxlbmd0aD50KWUuY29udGVudHMubGVuZ3RoPXQ7ZWxzZSBmb3IoO2UuY29udGVudHMubGVuZ3RoPHQ7KWUuY29udGVudHMucHVzaCgwKTtlLnVzZWRCeXRlcz10fX0sbm9kZV9vcHM6e2dldGF0dHI6ZnVuY3Rpb24oZSl7dmFyIHQ9e307cmV0dXJuIHQuZGV2PVRlLmlzQ2hyZGV2KGUubW9kZSk/ZS5pZDoxLHQuaW5vPWUuaWQsdC5tb2RlPWUubW9kZSx0Lm5saW5rPTEsdC51aWQ9MCx0LmdpZD0wLHQucmRldj1lLnJkZXYsVGUuaXNEaXIoZS5tb2RlKT90LnNpemU9NDA5NjpUZS5pc0ZpbGUoZS5tb2RlKT90LnNpemU9ZS51c2VkQnl0ZXM6VGUuaXNMaW5rKGUubW9kZSk/dC5zaXplPWUubGluay5sZW5ndGg6dC5zaXplPTAsdC5hdGltZT1uZXcgRGF0ZShlLnRpbWVzdGFtcCksdC5tdGltZT1uZXcgRGF0ZShlLnRpbWVzdGFtcCksdC5jdGltZT1uZXcgRGF0ZShlLnRpbWVzdGFtcCksdC5ibGtzaXplPTQwOTYsdC5ibG9ja3M9TWF0aC5jZWlsKHQuc2l6ZS90LmJsa3NpemUpLHR9LHNldGF0dHI6ZnVuY3Rpb24oZSx0KXt2b2lkIDAhPT10Lm1vZGUmJihlLm1vZGU9dC5tb2RlKSx2b2lkIDAhPT10LnRpbWVzdGFtcCYmKGUudGltZXN0YW1wPXQudGltZXN0YW1wKSx2b2lkIDAhPT10LnNpemUmJndlLnJlc2l6ZUZpbGVTdG9yYWdlKGUsdC5zaXplKX0sbG9va3VwOmZ1bmN0aW9uKGUsdCl7dGhyb3cgVGUuZ2VuZXJpY0Vycm9yc1ttZS5FTk9FTlRdfSxta25vZDpmdW5jdGlvbihlLHQscixuKXtyZXR1cm4gd2UuY3JlYXRlTm9kZShlLHQscixuKX0scmVuYW1lOmZ1bmN0aW9uKGUsdCxyKXtpZihUZS5pc0RpcihlLm1vZGUpKXt2YXIgbjt0cnl7bj1UZS5sb29rdXBOb2RlKHQscil9Y2F0Y2goZSl7fWlmKG4pZm9yKHZhciBvIGluIG4uY29udGVudHMpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PVEVNUFRZKX1kZWxldGUgZS5wYXJlbnQuY29udGVudHNbZS5uYW1lXSxlLm5hbWU9cix0LmNvbnRlbnRzW3JdPWUsZS5wYXJlbnQ9dH0sdW5saW5rOmZ1bmN0aW9uKGUsdCl7ZGVsZXRlIGUuY29udGVudHNbdF19LHJtZGlyOmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUubG9va3VwTm9kZShlLHQpO2Zvcih2YXIgbiBpbiByLmNvbnRlbnRzKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RFTVBUWSk7ZGVsZXRlIGUuY29udGVudHNbdF19LHJlYWRkaXI6ZnVuY3Rpb24oZSl7dmFyIHQ9WyIuIiwiLi4iXTtmb3IodmFyIHIgaW4gZS5jb250ZW50cyllLmNvbnRlbnRzLmhhc093blByb3BlcnR5KHIpJiZ0LnB1c2gocik7cmV0dXJuIHR9LHN5bWxpbms6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXdlLmNyZWF0ZU5vZGUoZSx0LDQxNDcxLDApO3JldHVybiBuLmxpbms9cixufSxyZWFkbGluazpmdW5jdGlvbihlKXtpZighVGUuaXNMaW5rKGUubW9kZSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtyZXR1cm4gZS5saW5rfX0sc3RyZWFtX29wczp7cmVhZDpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWUubm9kZS5jb250ZW50cztpZihvPj1lLm5vZGUudXNlZEJ5dGVzKXJldHVybiAwO3ZhciBhPU1hdGgubWluKGUubm9kZS51c2VkQnl0ZXMtbyxuKTtpZih5KGE+PTApLGE+OCYmaS5zdWJhcnJheSl0LnNldChpLnN1YmFycmF5KG8sbythKSxyKTtlbHNlIGZvcih2YXIgcz0wO3M8YTtzKyspdFtyK3NdPWlbbytzXTtyZXR1cm4gYX0sd3JpdGU6ZnVuY3Rpb24oZSx0LHIsbixvLGkpe2lmKCFuKXJldHVybiAwO3ZhciBhPWUubm9kZTtpZihhLnRpbWVzdGFtcD1EYXRlLm5vdygpLHQuc3ViYXJyYXkmJighYS5jb250ZW50c3x8YS5jb250ZW50cy5zdWJhcnJheSkpe2lmKGkpcmV0dXJuIGEuY29udGVudHM9dC5zdWJhcnJheShyLHIrbiksYS51c2VkQnl0ZXM9bixuO2lmKDA9PT1hLnVzZWRCeXRlcyYmMD09PW8pcmV0dXJuIGEuY29udGVudHM9bmV3IFVpbnQ4QXJyYXkodC5zdWJhcnJheShyLHIrbikpLGEudXNlZEJ5dGVzPW4sbjtpZihvK248PWEudXNlZEJ5dGVzKXJldHVybiBhLmNvbnRlbnRzLnNldCh0LnN1YmFycmF5KHIscituKSxvKSxufWlmKHdlLmV4cGFuZEZpbGVTdG9yYWdlKGEsbytuKSxhLmNvbnRlbnRzLnN1YmFycmF5JiZ0LnN1YmFycmF5KWEuY29udGVudHMuc2V0KHQuc3ViYXJyYXkocixyK24pLG8pO2Vsc2UgZm9yKHZhciBzPTA7czxuO3MrKylhLmNvbnRlbnRzW28rc109dFtyK3NdO3JldHVybiBhLnVzZWRCeXRlcz1NYXRoLm1heChhLnVzZWRCeXRlcyxvK24pLG59LGxsc2VlazpmdW5jdGlvbihlLHQscil7dmFyIG49dDtpZigxPT09cj9uKz1lLnBvc2l0aW9uOjI9PT1yJiZUZS5pc0ZpbGUoZS5ub2RlLm1vZGUpJiYobis9ZS5ub2RlLnVzZWRCeXRlcyksbjwwKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7cmV0dXJuIG59LGFsbG9jYXRlOmZ1bmN0aW9uKGUsdCxyKXt3ZS5leHBhbmRGaWxlU3RvcmFnZShlLm5vZGUsdCtyKSxlLm5vZGUudXNlZEJ5dGVzPU1hdGgubWF4KGUubm9kZS51c2VkQnl0ZXMsdCtyKX0sbW1hcDpmdW5jdGlvbihlLHQscixuLG8saSxhKXtpZighVGUuaXNGaWxlKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9ERVYpO3ZhciBzLHUsYz1lLm5vZGUuY29udGVudHM7aWYoMiZhfHxjLmJ1ZmZlciE9PXQmJmMuYnVmZmVyIT09dC5idWZmZXIpe2lmKChvPjB8fG8rbjxlLm5vZGUudXNlZEJ5dGVzKSYmKGM9Yy5zdWJhcnJheT9jLnN1YmFycmF5KG8sbytuKTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjLG8sbytuKSksdT0hMCwhKHM9SnQobikpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT01FTSk7dC5zZXQoYyxzKX1lbHNlIHU9ITEscz1jLmJ5dGVPZmZzZXQ7cmV0dXJue3B0cjpzLGFsbG9jYXRlZDp1fX0sbXN5bmM6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighVGUuaXNGaWxlKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9ERVYpO2lmKDImbylyZXR1cm4gMDt3ZS5zdHJlYW1fb3BzLndyaXRlKGUsdCwwLG4sciwhMSk7cmV0dXJuIDB9fX0sX2U9e2Riczp7fSxpbmRleGVkREI6ZnVuY3Rpb24oKXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGluZGV4ZWREQilyZXR1cm4gaW5kZXhlZERCO3ZhciBlPW51bGw7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiB3aW5kb3cmJihlPXdpbmRvdy5pbmRleGVkREJ8fHdpbmRvdy5tb3pJbmRleGVkREJ8fHdpbmRvdy53ZWJraXRJbmRleGVkREJ8fHdpbmRvdy5tc0luZGV4ZWREQikseShlLCJJREJGUyB1c2VkLCBidXQgaW5kZXhlZERCIG5vdCBzdXBwb3J0ZWQiKSxlfSxEQl9WRVJTSU9OOjIxLERCX1NUT1JFX05BTUU6IkZJTEVfREFUQSIsbW91bnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlLm1vdW50LmFwcGx5KG51bGwsYXJndW1lbnRzKX0sc3luY2ZzOmZ1bmN0aW9uKGUsdCxyKXtfZS5nZXRMb2NhbFNldChlLChmdW5jdGlvbihuLG8pe2lmKG4pcmV0dXJuIHIobik7X2UuZ2V0UmVtb3RlU2V0KGUsKGZ1bmN0aW9uKGUsbil7aWYoZSlyZXR1cm4gcihlKTt2YXIgaT10P246byxhPXQ/bzpuO19lLnJlY29uY2lsZShpLGEscil9KSl9KSl9LGdldERCOmZ1bmN0aW9uKGUsdCl7dmFyIHIsbj1fZS5kYnNbZV07aWYobilyZXR1cm4gdChudWxsLG4pO3RyeXtyPV9lLmluZGV4ZWREQigpLm9wZW4oZSxfZS5EQl9WRVJTSU9OKX1jYXRjaChlKXtyZXR1cm4gdChlKX1pZighcilyZXR1cm4gdCgiVW5hYmxlIHRvIGNvbm5lY3QgdG8gSW5kZXhlZERCIik7ci5vbnVwZ3JhZGVuZWVkZWQ9ZnVuY3Rpb24oZSl7dmFyIHQscj1lLnRhcmdldC5yZXN1bHQsbj1lLnRhcmdldC50cmFuc2FjdGlvbjsodD1yLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoX2UuREJfU1RPUkVfTkFNRSk/bi5vYmplY3RTdG9yZShfZS5EQl9TVE9SRV9OQU1FKTpyLmNyZWF0ZU9iamVjdFN0b3JlKF9lLkRCX1NUT1JFX05BTUUpKS5pbmRleE5hbWVzLmNvbnRhaW5zKCJ0aW1lc3RhbXAiKXx8dC5jcmVhdGVJbmRleCgidGltZXN0YW1wIiwidGltZXN0YW1wIix7dW5pcXVlOiExfSl9LHIub25zdWNjZXNzPWZ1bmN0aW9uKCl7bj1yLnJlc3VsdCxfZS5kYnNbZV09bix0KG51bGwsbil9LHIub25lcnJvcj1mdW5jdGlvbihlKXt0KHRoaXMuZXJyb3IpLGUucHJldmVudERlZmF1bHQoKX19LGdldExvY2FsU2V0OmZ1bmN0aW9uKGUsdCl7dmFyIHI9e307ZnVuY3Rpb24gbihlKXtyZXR1cm4iLiIhPT1lJiYiLi4iIT09ZX1mdW5jdGlvbiBvKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZ2Uuam9pbjIoZSx0KX19Zm9yKHZhciBpPVRlLnJlYWRkaXIoZS5tb3VudHBvaW50KS5maWx0ZXIobikubWFwKG8oZS5tb3VudHBvaW50KSk7aS5sZW5ndGg7KXt2YXIgYSxzPWkucG9wKCk7dHJ5e2E9VGUuc3RhdChzKX1jYXRjaChlKXtyZXR1cm4gdChlKX1UZS5pc0RpcihhLm1vZGUpJiZpLnB1c2guYXBwbHkoaSxUZS5yZWFkZGlyKHMpLmZpbHRlcihuKS5tYXAobyhzKSkpLHJbc109e3RpbWVzdGFtcDphLm10aW1lfX1yZXR1cm4gdChudWxsLHt0eXBlOiJsb2NhbCIsZW50cmllczpyfSl9LGdldFJlbW90ZVNldDpmdW5jdGlvbihlLHQpe3ZhciByPXt9O19lLmdldERCKGUubW91bnRwb2ludCwoZnVuY3Rpb24oZSxuKXtpZihlKXJldHVybiB0KGUpO3RyeXt2YXIgbz1uLnRyYW5zYWN0aW9uKFtfZS5EQl9TVE9SRV9OQU1FXSwicmVhZG9ubHkiKTtvLm9uZXJyb3I9ZnVuY3Rpb24oZSl7dCh0aGlzLmVycm9yKSxlLnByZXZlbnREZWZhdWx0KCl9LG8ub2JqZWN0U3RvcmUoX2UuREJfU1RPUkVfTkFNRSkuaW5kZXgoInRpbWVzdGFtcCIpLm9wZW5LZXlDdXJzb3IoKS5vbnN1Y2Nlc3M9ZnVuY3Rpb24oZSl7dmFyIG89ZS50YXJnZXQucmVzdWx0O2lmKCFvKXJldHVybiB0KG51bGwse3R5cGU6InJlbW90ZSIsZGI6bixlbnRyaWVzOnJ9KTtyW28ucHJpbWFyeUtleV09e3RpbWVzdGFtcDpvLmtleX0sby5jb250aW51ZSgpfX1jYXRjaChlKXtyZXR1cm4gdChlKX19KSl9LGxvYWRMb2NhbEVudHJ5OmZ1bmN0aW9uKGUsdCl7dmFyIHIsbjt0cnl7bj1UZS5sb29rdXBQYXRoKGUpLm5vZGUscj1UZS5zdGF0KGUpfWNhdGNoKGUpe3JldHVybiB0KGUpfXJldHVybiBUZS5pc0RpcihyLm1vZGUpP3QobnVsbCx7dGltZXN0YW1wOnIubXRpbWUsbW9kZTpyLm1vZGV9KTpUZS5pc0ZpbGUoci5tb2RlKT8obi5jb250ZW50cz13ZS5nZXRGaWxlRGF0YUFzVHlwZWRBcnJheShuKSx0KG51bGwse3RpbWVzdGFtcDpyLm10aW1lLG1vZGU6ci5tb2RlLGNvbnRlbnRzOm4uY29udGVudHN9KSk6dChuZXcgRXJyb3IoIm5vZGUgdHlwZSBub3Qgc3VwcG9ydGVkIikpfSxzdG9yZUxvY2FsRW50cnk6ZnVuY3Rpb24oZSx0LHIpe3RyeXtpZihUZS5pc0Rpcih0Lm1vZGUpKVRlLm1rZGlyKGUsdC5tb2RlKTtlbHNle2lmKCFUZS5pc0ZpbGUodC5tb2RlKSlyZXR1cm4gcihuZXcgRXJyb3IoIm5vZGUgdHlwZSBub3Qgc3VwcG9ydGVkIikpO1RlLndyaXRlRmlsZShlLHQuY29udGVudHMse2Nhbk93bjohMH0pfVRlLmNobW9kKGUsdC5tb2RlKSxUZS51dGltZShlLHQudGltZXN0YW1wLHQudGltZXN0YW1wKX1jYXRjaChlKXtyZXR1cm4gcihlKX1yKG51bGwpfSxyZW1vdmVMb2NhbEVudHJ5OmZ1bmN0aW9uKGUsdCl7dHJ5e1RlLmxvb2t1cFBhdGgoZSk7dmFyIHI9VGUuc3RhdChlKTtUZS5pc0RpcihyLm1vZGUpP1RlLnJtZGlyKGUpOlRlLmlzRmlsZShyLm1vZGUpJiZUZS51bmxpbmsoZSl9Y2F0Y2goZSl7cmV0dXJuIHQoZSl9dChudWxsKX0sbG9hZFJlbW90ZUVudHJ5OmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj1lLmdldCh0KTtuLm9uc3VjY2Vzcz1mdW5jdGlvbihlKXtyKG51bGwsZS50YXJnZXQucmVzdWx0KX0sbi5vbmVycm9yPWZ1bmN0aW9uKGUpe3IodGhpcy5lcnJvciksZS5wcmV2ZW50RGVmYXVsdCgpfX0sc3RvcmVSZW1vdGVFbnRyeTpmdW5jdGlvbihlLHQscixuKXt2YXIgbz1lLnB1dChyLHQpO28ub25zdWNjZXNzPWZ1bmN0aW9uKCl7bihudWxsKX0sby5vbmVycm9yPWZ1bmN0aW9uKGUpe24odGhpcy5lcnJvciksZS5wcmV2ZW50RGVmYXVsdCgpfX0scmVtb3ZlUmVtb3RlRW50cnk6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUuZGVsZXRlKHQpO24ub25zdWNjZXNzPWZ1bmN0aW9uKCl7cihudWxsKX0sbi5vbmVycm9yPWZ1bmN0aW9uKGUpe3IodGhpcy5lcnJvciksZS5wcmV2ZW50RGVmYXVsdCgpfX0scmVjb25jaWxlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbj0wLG89W107T2JqZWN0LmtleXMoZS5lbnRyaWVzKS5mb3JFYWNoKChmdW5jdGlvbihyKXt2YXIgaT1lLmVudHJpZXNbcl0sYT10LmVudHJpZXNbcl07KCFhfHxpLnRpbWVzdGFtcD5hLnRpbWVzdGFtcCkmJihvLnB1c2gociksbisrKX0pKTt2YXIgaT1bXTtpZihPYmplY3Qua2V5cyh0LmVudHJpZXMpLmZvckVhY2goKGZ1bmN0aW9uKHIpe3QuZW50cmllc1tyXTtlLmVudHJpZXNbcl18fChpLnB1c2gociksbisrKX0pKSwhbilyZXR1cm4gcihudWxsKTt2YXIgYT0wLHM9KCJyZW1vdGUiPT09ZS50eXBlP2UuZGI6dC5kYikudHJhbnNhY3Rpb24oW19lLkRCX1NUT1JFX05BTUVdLCJyZWFkd3JpdGUiKSx1PXMub2JqZWN0U3RvcmUoX2UuREJfU1RPUkVfTkFNRSk7ZnVuY3Rpb24gYyhlKXtyZXR1cm4gZT9jLmVycm9yZWQ/dm9pZCAwOihjLmVycm9yZWQ9ITAscihlKSk6KythPj1uP3IobnVsbCk6dm9pZCAwfXMub25lcnJvcj1mdW5jdGlvbihlKXtjKHRoaXMuZXJyb3IpLGUucHJldmVudERlZmF1bHQoKX0sby5zb3J0KCkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ImxvY2FsIj09PXQudHlwZT9fZS5sb2FkUmVtb3RlRW50cnkodSxlLChmdW5jdGlvbih0LHIpe2lmKHQpcmV0dXJuIGModCk7X2Uuc3RvcmVMb2NhbEVudHJ5KGUscixjKX0pKTpfZS5sb2FkTG9jYWxFbnRyeShlLChmdW5jdGlvbih0LHIpe2lmKHQpcmV0dXJuIGModCk7X2Uuc3RvcmVSZW1vdGVFbnRyeSh1LGUscixjKX0pKX0pKSxpLnNvcnQoKS5yZXZlcnNlKCkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ImxvY2FsIj09PXQudHlwZT9fZS5yZW1vdmVMb2NhbEVudHJ5KGUsYyk6X2UucmVtb3ZlUmVtb3RlRW50cnkodSxlLGMpfSkpfX0sYmU9e2lzV2luZG93czohMSxzdGF0aWNJbml0OmZ1bmN0aW9uKCl7YmUuaXNXaW5kb3dzPSEhcHJvY2Vzcy5wbGF0Zm9ybS5tYXRjaCgvXndpbi8pO3ZhciBlPXByb2Nlc3MuYmluZGluZygiY29uc3RhbnRzIik7ZS5mcyYmKGU9ZS5mcyksYmUuZmxhZ3NGb3JOb2RlTWFwPXsxMDI0OmUuT19BUFBFTkQsNjQ6ZS5PX0NSRUFULDEyODplLk9fRVhDTCwwOmUuT19SRE9OTFksMjplLk9fUkRXUiw0MDk2OmUuT19TWU5DLDUxMjplLk9fVFJVTkMsMTplLk9fV1JPTkxZfX0sYnVmZmVyRnJvbTpmdW5jdGlvbihlKXtyZXR1cm4gQnVmZmVyLmFsbG9jP0J1ZmZlci5mcm9tKGUpOm5ldyBCdWZmZXIoZSl9LG1vdW50OmZ1bmN0aW9uKGUpe3JldHVybiB5KGwpLGJlLmNyZWF0ZU5vZGUobnVsbCwiLyIsYmUuZ2V0TW9kZShlLm9wdHMucm9vdCksMCl9LGNyZWF0ZU5vZGU6ZnVuY3Rpb24oZSx0LHIsbil7aWYoIVRlLmlzRGlyKHIpJiYhVGUuaXNGaWxlKHIpJiYhVGUuaXNMaW5rKHIpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIG89VGUuY3JlYXRlTm9kZShlLHQscik7cmV0dXJuIG8ubm9kZV9vcHM9YmUubm9kZV9vcHMsby5zdHJlYW1fb3BzPWJlLnN0cmVhbV9vcHMsb30sZ2V0TW9kZTpmdW5jdGlvbihlKXt2YXIgdDt0cnl7dD1mcy5sc3RhdFN5bmMoZSksYmUuaXNXaW5kb3dzJiYodC5tb2RlPXQubW9kZXwoMjkyJnQubW9kZSk+PjIpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX1yZXR1cm4gdC5tb2RlfSxyZWFsUGF0aDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9W107ZS5wYXJlbnQhPT1lOyl0LnB1c2goZS5uYW1lKSxlPWUucGFyZW50O3JldHVybiB0LnB1c2goZS5tb3VudC5vcHRzLnJvb3QpLHQucmV2ZXJzZSgpLGdlLmpvaW4uYXBwbHkobnVsbCx0KX0sZmxhZ3NGb3JOb2RlOmZ1bmN0aW9uKGUpe2UmPS0yMDk3MTUzLGUmPS0yMDQ5LGUmPS0zMjc2OSxlJj0tNTI0Mjg5O3ZhciB0PTA7Zm9yKHZhciByIGluIGJlLmZsYWdzRm9yTm9kZU1hcCllJnImJih0fD1iZS5mbGFnc0Zvck5vZGVNYXBbcl0sZV49cik7aWYoZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO3JldHVybiB0fSxub2RlX29wczp7Z2V0YXR0cjpmdW5jdGlvbihlKXt2YXIgdCxyPWJlLnJlYWxQYXRoKGUpO3RyeXt0PWZzLmxzdGF0U3luYyhyKX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9cmV0dXJuIGJlLmlzV2luZG93cyYmIXQuYmxrc2l6ZSYmKHQuYmxrc2l6ZT00MDk2KSxiZS5pc1dpbmRvd3MmJiF0LmJsb2NrcyYmKHQuYmxvY2tzPSh0LnNpemUrdC5ibGtzaXplLTEpL3QuYmxrc2l6ZXwwKSx7ZGV2OnQuZGV2LGlubzp0Lmlubyxtb2RlOnQubW9kZSxubGluazp0Lm5saW5rLHVpZDp0LnVpZCxnaWQ6dC5naWQscmRldjp0LnJkZXYsc2l6ZTp0LnNpemUsYXRpbWU6dC5hdGltZSxtdGltZTp0Lm10aW1lLGN0aW1lOnQuY3RpbWUsYmxrc2l6ZTp0LmJsa3NpemUsYmxvY2tzOnQuYmxvY2tzfX0sc2V0YXR0cjpmdW5jdGlvbihlLHQpe3ZhciByPWJlLnJlYWxQYXRoKGUpO3RyeXtpZih2b2lkIDAhPT10Lm1vZGUmJihmcy5jaG1vZFN5bmMocix0Lm1vZGUpLGUubW9kZT10Lm1vZGUpLHZvaWQgMCE9PXQudGltZXN0YW1wKXt2YXIgbj1uZXcgRGF0ZSh0LnRpbWVzdGFtcCk7ZnMudXRpbWVzU3luYyhyLG4sbil9dm9pZCAwIT09dC5zaXplJiZmcy50cnVuY2F0ZVN5bmMocix0LnNpemUpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LGxvb2t1cDpmdW5jdGlvbihlLHQpe3ZhciByPWdlLmpvaW4yKGJlLnJlYWxQYXRoKGUpLHQpLG49YmUuZ2V0TW9kZShyKTtyZXR1cm4gYmUuY3JlYXRlTm9kZShlLHQsbil9LG1rbm9kOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPWJlLmNyZWF0ZU5vZGUoZSx0LHIsbiksaT1iZS5yZWFsUGF0aChvKTt0cnl7VGUuaXNEaXIoby5tb2RlKT9mcy5ta2RpclN5bmMoaSxvLm1vZGUpOmZzLndyaXRlRmlsZVN5bmMoaSwiIix7bW9kZTpvLm1vZGV9KX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9cmV0dXJuIG99LHJlbmFtZTpmdW5jdGlvbihlLHQscil7dmFyIG49YmUucmVhbFBhdGgoZSksbz1nZS5qb2luMihiZS5yZWFsUGF0aCh0KSxyKTt0cnl7ZnMucmVuYW1lU3luYyhuLG8pfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LHVubGluazpmdW5jdGlvbihlLHQpe3ZhciByPWdlLmpvaW4yKGJlLnJlYWxQYXRoKGUpLHQpO3RyeXtmcy51bmxpbmtTeW5jKHIpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LHJtZGlyOmZ1bmN0aW9uKGUsdCl7dmFyIHI9Z2Uuam9pbjIoYmUucmVhbFBhdGgoZSksdCk7dHJ5e2ZzLnJtZGlyU3luYyhyKX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9fSxyZWFkZGlyOmZ1bmN0aW9uKGUpe3ZhciB0PWJlLnJlYWxQYXRoKGUpO3RyeXtyZXR1cm4gZnMucmVhZGRpclN5bmModCl9Y2F0Y2goZSl7aWYoIWUuY29kZSl0aHJvdyBlO3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lW2UuY29kZV0pfX0sc3ltbGluazpmdW5jdGlvbihlLHQscil7dmFyIG49Z2Uuam9pbjIoYmUucmVhbFBhdGgoZSksdCk7dHJ5e2ZzLnN5bWxpbmtTeW5jKHIsbil9Y2F0Y2goZSl7aWYoIWUuY29kZSl0aHJvdyBlO3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lW2UuY29kZV0pfX0scmVhZGxpbms6ZnVuY3Rpb24oZSl7dmFyIHQ9YmUucmVhbFBhdGgoZSk7dHJ5e3JldHVybiB0PWZzLnJlYWRsaW5rU3luYyh0KSx0PU5PREVKU19QQVRILnJlbGF0aXZlKE5PREVKU19QQVRILnJlc29sdmUoZS5tb3VudC5vcHRzLnJvb3QpLHQpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19fSxzdHJlYW1fb3BzOntvcGVuOmZ1bmN0aW9uKGUpe3ZhciB0PWJlLnJlYWxQYXRoKGUubm9kZSk7dHJ5e1RlLmlzRmlsZShlLm5vZGUubW9kZSkmJihlLm5mZD1mcy5vcGVuU3luYyh0LGJlLmZsYWdzRm9yTm9kZShlLmZsYWdzKSkpfWNhdGNoKGUpe2lmKCFlLmNvZGUpdGhyb3cgZTt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LGNsb3NlOmZ1bmN0aW9uKGUpe3RyeXtUZS5pc0ZpbGUoZS5ub2RlLm1vZGUpJiZlLm5mZCYmZnMuY2xvc2VTeW5jKGUubmZkKX1jYXRjaChlKXtpZighZS5jb2RlKXRocm93IGU7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9fSxyZWFkOmZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYoMD09PW4pcmV0dXJuIDA7dHJ5e3JldHVybiBmcy5yZWFkU3luYyhlLm5mZCxiZS5idWZmZXJGcm9tKHQuYnVmZmVyKSxyLG4sbyl9Y2F0Y2goZSl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWVbZS5jb2RlXSl9fSx3cml0ZTpmdW5jdGlvbihlLHQscixuLG8pe3RyeXtyZXR1cm4gZnMud3JpdGVTeW5jKGUubmZkLGJlLmJ1ZmZlckZyb20odC5idWZmZXIpLHIsbixvKX1jYXRjaChlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX19LGxsc2VlazpmdW5jdGlvbihlLHQscil7dmFyIG49dDtpZigxPT09ciluKz1lLnBvc2l0aW9uO2Vsc2UgaWYoMj09PXImJlRlLmlzRmlsZShlLm5vZGUubW9kZSkpdHJ5e24rPWZzLmZzdGF0U3luYyhlLm5mZCkuc2l6ZX1jYXRjaChlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZVtlLmNvZGVdKX1pZihuPDApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtyZXR1cm4gbn19fSxBZT17RElSX01PREU6MTY4OTUsRklMRV9NT0RFOjMzMjc5LHJlYWRlcjpudWxsLG1vdW50OmZ1bmN0aW9uKGUpe3koYyksQWUucmVhZGVyfHwoQWUucmVhZGVyPW5ldyBGaWxlUmVhZGVyU3luYyk7dmFyIHQ9QWUuY3JlYXRlTm9kZShudWxsLCIvIixBZS5ESVJfTU9ERSwwKSxyPXt9O2Z1bmN0aW9uIG4oZSl7Zm9yKHZhciBuPWUuc3BsaXQoIi8iKSxvPXQsaT0wO2k8bi5sZW5ndGgtMTtpKyspe3ZhciBhPW4uc2xpY2UoMCxpKzEpLmpvaW4oIi8iKTtyW2FdfHwoclthXT1BZS5jcmVhdGVOb2RlKG8sbltpXSxBZS5ESVJfTU9ERSwwKSksbz1yW2FdfXJldHVybiBvfWZ1bmN0aW9uIG8oZSl7dmFyIHQ9ZS5zcGxpdCgiLyIpO3JldHVybiB0W3QubGVuZ3RoLTFdfXJldHVybiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGUub3B0cy5maWxlc3x8W10sKGZ1bmN0aW9uKGUpe0FlLmNyZWF0ZU5vZGUobihlLm5hbWUpLG8oZS5uYW1lKSxBZS5GSUxFX01PREUsMCxlLGUubGFzdE1vZGlmaWVkRGF0ZSl9KSksKGUub3B0cy5ibG9ic3x8W10pLmZvckVhY2goKGZ1bmN0aW9uKGUpe0FlLmNyZWF0ZU5vZGUobihlLm5hbWUpLG8oZS5uYW1lKSxBZS5GSUxFX01PREUsMCxlLmRhdGEpfSkpLChlLm9wdHMucGFja2FnZXN8fFtdKS5mb3JFYWNoKChmdW5jdGlvbihlKXtlLm1ldGFkYXRhLmZpbGVzLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciByPXQuZmlsZW5hbWUuc3Vic3RyKDEpO0FlLmNyZWF0ZU5vZGUobihyKSxvKHIpLEFlLkZJTEVfTU9ERSwwLGUuYmxvYi5zbGljZSh0LnN0YXJ0LHQuZW5kKSl9KSl9KSksdH0sY3JlYXRlTm9kZTpmdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGE9VGUuY3JlYXRlTm9kZShlLHQscik7cmV0dXJuIGEubW9kZT1yLGEubm9kZV9vcHM9QWUubm9kZV9vcHMsYS5zdHJlYW1fb3BzPUFlLnN0cmVhbV9vcHMsYS50aW1lc3RhbXA9KGl8fG5ldyBEYXRlKS5nZXRUaW1lKCkseShBZS5GSUxFX01PREUhPT1BZS5ESVJfTU9ERSkscj09PUFlLkZJTEVfTU9ERT8oYS5zaXplPW8uc2l6ZSxhLmNvbnRlbnRzPW8pOihhLnNpemU9NDA5NixhLmNvbnRlbnRzPXt9KSxlJiYoZS5jb250ZW50c1t0XT1hKSxhfSxub2RlX29wczp7Z2V0YXR0cjpmdW5jdGlvbihlKXtyZXR1cm57ZGV2OjEsaW5vOnZvaWQgMCxtb2RlOmUubW9kZSxubGluazoxLHVpZDowLGdpZDowLHJkZXY6dm9pZCAwLHNpemU6ZS5zaXplLGF0aW1lOm5ldyBEYXRlKGUudGltZXN0YW1wKSxtdGltZTpuZXcgRGF0ZShlLnRpbWVzdGFtcCksY3RpbWU6bmV3IERhdGUoZS50aW1lc3RhbXApLGJsa3NpemU6NDA5NixibG9ja3M6TWF0aC5jZWlsKGUuc2l6ZS80MDk2KX19LHNldGF0dHI6ZnVuY3Rpb24oZSx0KXt2b2lkIDAhPT10Lm1vZGUmJihlLm1vZGU9dC5tb2RlKSx2b2lkIDAhPT10LnRpbWVzdGFtcCYmKGUudGltZXN0YW1wPXQudGltZXN0YW1wKX0sbG9va3VwOmZ1bmN0aW9uKGUsdCl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKX0sbWtub2Q6ZnVuY3Rpb24oZSx0LHIsbil7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pfSxyZW5hbWU6ZnVuY3Rpb24oZSx0LHIpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKX0sdW5saW5rOmZ1bmN0aW9uKGUsdCl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pfSxybWRpcjpmdW5jdGlvbihlLHQpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKX0scmVhZGRpcjpmdW5jdGlvbihlKXt2YXIgdD1bIi4iLCIuLiJdO2Zvcih2YXIgciBpbiBlLmNvbnRlbnRzKWUuY29udGVudHMuaGFzT3duUHJvcGVydHkocikmJnQucHVzaChyKTtyZXR1cm4gdH0sc3ltbGluazpmdW5jdGlvbihlLHQscil7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pfSxyZWFkbGluazpmdW5jdGlvbihlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSl9fSxzdHJlYW1fb3BzOntyZWFkOmZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYobz49ZS5ub2RlLnNpemUpcmV0dXJuIDA7dmFyIGk9ZS5ub2RlLmNvbnRlbnRzLnNsaWNlKG8sbytuKSxhPUFlLnJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihpKTtyZXR1cm4gdC5zZXQobmV3IFVpbnQ4QXJyYXkoYSksciksaS5zaXplfSx3cml0ZTpmdW5jdGlvbihlLHQscixuLG8pe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTyl9LGxsc2VlazpmdW5jdGlvbihlLHQscil7dmFyIG49dDtpZigxPT09cj9uKz1lLnBvc2l0aW9uOjI9PT1yJiZUZS5pc0ZpbGUoZS5ub2RlLm1vZGUpJiYobis9ZS5ub2RlLnNpemUpLG48MCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO3JldHVybiBufX19O0wrPTE2LEwrPTE2O3ZhciBUZT17cm9vdDpudWxsLG1vdW50czpbXSxkZXZpY2VzOnt9LHN0cmVhbXM6W10sbmV4dElub2RlOjEsbmFtZVRhYmxlOm51bGwsY3VycmVudFBhdGg6Ii8iLGluaXRpYWxpemVkOiExLGlnbm9yZVBlcm1pc3Npb25zOiEwLHRyYWNraW5nRGVsZWdhdGU6e30sdHJhY2tpbmc6e29wZW5GbGFnczp7UkVBRDoxLFdSSVRFOjJ9fSxFcnJub0Vycm9yOm51bGwsZ2VuZXJpY0Vycm9yczp7fSxmaWxlc3lzdGVtczpudWxsLHN5bmNGU1JlcXVlc3RzOjAsaGFuZGxlRlNFcnJvcjpmdW5jdGlvbihlKXtpZighKGUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yKSl0aHJvdyBlKyIgOiAiK1AoKTtyZXR1cm4geWUoZS5lcnJubyl9LGxvb2t1cFBhdGg6ZnVuY3Rpb24oZSx0KXtpZih0PXR8fHt9LCEoZT1nZS5yZXNvbHZlKFRlLmN3ZCgpLGUpKSlyZXR1cm57cGF0aDoiIixub2RlOm51bGx9O3ZhciByPXtmb2xsb3dfbW91bnQ6ITAscmVjdXJzZV9jb3VudDowfTtmb3IodmFyIG4gaW4gcil2b2lkIDA9PT10W25dJiYodFtuXT1yW25dKTtpZih0LnJlY3Vyc2VfY291bnQ+OCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTE9PUCk7Zm9yKHZhciBvPWdlLm5vcm1hbGl6ZUFycmF5KGUuc3BsaXQoIi8iKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiEhZX0pKSwhMSksaT1UZS5yb290LGE9Ii8iLHM9MDtzPG8ubGVuZ3RoO3MrKyl7dmFyIHU9cz09PW8ubGVuZ3RoLTE7aWYodSYmdC5wYXJlbnQpYnJlYWs7aWYoaT1UZS5sb29rdXBOb2RlKGksb1tzXSksYT1nZS5qb2luMihhLG9bc10pLFRlLmlzTW91bnRwb2ludChpKSYmKCF1fHx1JiZ0LmZvbGxvd19tb3VudCkmJihpPWkubW91bnRlZC5yb290KSwhdXx8dC5mb2xsb3cpZm9yKHZhciBjPTA7VGUuaXNMaW5rKGkubW9kZSk7KXt2YXIgbD1UZS5yZWFkbGluayhhKTtpZihhPWdlLnJlc29sdmUoZ2UuZGlybmFtZShhKSxsKSxpPVRlLmxvb2t1cFBhdGgoYSx7cmVjdXJzZV9jb3VudDp0LnJlY3Vyc2VfY291bnR9KS5ub2RlLGMrKz40MCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTE9PUCl9fXJldHVybntwYXRoOmEsbm9kZTppfX0sZ2V0UGF0aDpmdW5jdGlvbihlKXtmb3IodmFyIHQ7Oyl7aWYoVGUuaXNSb290KGUpKXt2YXIgcj1lLm1vdW50Lm1vdW50cG9pbnQ7cmV0dXJuIHQ/Ii8iIT09cltyLmxlbmd0aC0xXT9yKyIvIit0OnIrdDpyfXQ9dD9lLm5hbWUrIi8iK3Q6ZS5uYW1lLGU9ZS5wYXJlbnR9fSxoYXNoTmFtZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj0wLG49MDtuPHQubGVuZ3RoO24rKylyPShyPDw1KS1yK3QuY2hhckNvZGVBdChuKXwwO3JldHVybihlK3I+Pj4wKSVUZS5uYW1lVGFibGUubGVuZ3RofSxoYXNoQWRkTm9kZTpmdW5jdGlvbihlKXt2YXIgdD1UZS5oYXNoTmFtZShlLnBhcmVudC5pZCxlLm5hbWUpO2UubmFtZV9uZXh0PVRlLm5hbWVUYWJsZVt0XSxUZS5uYW1lVGFibGVbdF09ZX0saGFzaFJlbW92ZU5vZGU6ZnVuY3Rpb24oZSl7dmFyIHQ9VGUuaGFzaE5hbWUoZS5wYXJlbnQuaWQsZS5uYW1lKTtpZihUZS5uYW1lVGFibGVbdF09PT1lKVRlLm5hbWVUYWJsZVt0XT1lLm5hbWVfbmV4dDtlbHNlIGZvcih2YXIgcj1UZS5uYW1lVGFibGVbdF07cjspe2lmKHIubmFtZV9uZXh0PT09ZSl7ci5uYW1lX25leHQ9ZS5uYW1lX25leHQ7YnJlYWt9cj1yLm5hbWVfbmV4dH19LGxvb2t1cE5vZGU6ZnVuY3Rpb24oZSx0KXt2YXIgcj1UZS5tYXlMb29rdXAoZSk7aWYocil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihyLGUpO2Zvcih2YXIgbj1UZS5oYXNoTmFtZShlLmlkLHQpLG89VGUubmFtZVRhYmxlW25dO287bz1vLm5hbWVfbmV4dCl7dmFyIGk9by5uYW1lO2lmKG8ucGFyZW50LmlkPT09ZS5pZCYmaT09PXQpcmV0dXJuIG99cmV0dXJuIFRlLmxvb2t1cChlLHQpfSxjcmVhdGVOb2RlOmZ1bmN0aW9uKGUsdCxyLG4pe2lmKCFUZS5GU05vZGUpe1RlLkZTTm9kZT1mdW5jdGlvbihlLHQscixuKXtlfHwoZT10aGlzKSx0aGlzLnBhcmVudD1lLHRoaXMubW91bnQ9ZS5tb3VudCx0aGlzLm1vdW50ZWQ9bnVsbCx0aGlzLmlkPVRlLm5leHRJbm9kZSsrLHRoaXMubmFtZT10LHRoaXMubW9kZT1yLHRoaXMubm9kZV9vcHM9e30sdGhpcy5zdHJlYW1fb3BzPXt9LHRoaXMucmRldj1ufSxUZS5GU05vZGUucHJvdG90eXBlPXt9O09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFRlLkZTTm9kZS5wcm90b3R5cGUse3JlYWQ6e2dldDpmdW5jdGlvbigpe3JldHVybiAzNjU9PSgzNjUmdGhpcy5tb2RlKX0sc2V0OmZ1bmN0aW9uKGUpe2U/dGhpcy5tb2RlfD0zNjU6dGhpcy5tb2RlJj0tMzY2fX0sd3JpdGU6e2dldDpmdW5jdGlvbigpe3JldHVybiAxNDY9PSgxNDYmdGhpcy5tb2RlKX0sc2V0OmZ1bmN0aW9uKGUpe2U/dGhpcy5tb2RlfD0xNDY6dGhpcy5tb2RlJj0tMTQ3fX0saXNGb2xkZXI6e2dldDpmdW5jdGlvbigpe3JldHVybiBUZS5pc0Rpcih0aGlzLm1vZGUpfX0saXNEZXZpY2U6e2dldDpmdW5jdGlvbigpe3JldHVybiBUZS5pc0NocmRldih0aGlzLm1vZGUpfX19KX12YXIgbz1uZXcgVGUuRlNOb2RlKGUsdCxyLG4pO3JldHVybiBUZS5oYXNoQWRkTm9kZShvKSxvfSxkZXN0cm95Tm9kZTpmdW5jdGlvbihlKXtUZS5oYXNoUmVtb3ZlTm9kZShlKX0saXNSb290OmZ1bmN0aW9uKGUpe3JldHVybiBlPT09ZS5wYXJlbnR9LGlzTW91bnRwb2ludDpmdW5jdGlvbihlKXtyZXR1cm4hIWUubW91bnRlZH0saXNGaWxlOmZ1bmN0aW9uKGUpe3JldHVybiAzMjc2OD09KDYxNDQwJmUpfSxpc0RpcjpmdW5jdGlvbihlKXtyZXR1cm4gMTYzODQ9PSg2MTQ0MCZlKX0saXNMaW5rOmZ1bmN0aW9uKGUpe3JldHVybiA0MDk2MD09KDYxNDQwJmUpfSxpc0NocmRldjpmdW5jdGlvbihlKXtyZXR1cm4gODE5Mj09KDYxNDQwJmUpfSxpc0Jsa2RldjpmdW5jdGlvbihlKXtyZXR1cm4gMjQ1NzY9PSg2MTQ0MCZlKX0saXNGSUZPOmZ1bmN0aW9uKGUpe3JldHVybiA0MDk2PT0oNjE0NDAmZSl9LGlzU29ja2V0OmZ1bmN0aW9uKGUpe3JldHVybiA0OTE1Mj09KDQ5MTUyJmUpfSxmbGFnTW9kZXM6e3I6MCxyczoxMDUyNjcyLCJyKyI6Mix3OjU3Nyx3eDo3MDUseHc6NzA1LCJ3KyI6NTc4LCJ3eCsiOjcwNiwieHcrIjo3MDYsYToxMDg5LGF4OjEyMTcseGE6MTIxNywiYSsiOjEwOTAsImF4KyI6MTIxOCwieGErIjoxMjE4fSxtb2RlU3RyaW5nVG9GbGFnczpmdW5jdGlvbihlKXt2YXIgdD1UZS5mbGFnTW9kZXNbZV07aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gZmlsZSBvcGVuIG1vZGU6ICIrZSk7cmV0dXJuIHR9LGZsYWdzVG9QZXJtaXNzaW9uU3RyaW5nOmZ1bmN0aW9uKGUpe3ZhciB0PVsiciIsInciLCJydyJdWzMmZV07cmV0dXJuIDUxMiZlJiYodCs9InciKSx0fSxub2RlUGVybWlzc2lvbnM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gVGUuaWdub3JlUGVybWlzc2lvbnN8fCgtMT09PXQuaW5kZXhPZigiciIpfHwyOTImZS5tb2RlKSYmKC0xPT09dC5pbmRleE9mKCJ3Iil8fDE0NiZlLm1vZGUpJiYoLTE9PT10LmluZGV4T2YoIngiKXx8NzMmZS5tb2RlKT8wOm1lLkVBQ0NFU30sbWF5TG9va3VwOmZ1bmN0aW9uKGUpe3ZhciB0PVRlLm5vZGVQZXJtaXNzaW9ucyhlLCJ4Iik7cmV0dXJuIHR8fChlLm5vZGVfb3BzLmxvb2t1cD8wOm1lLkVBQ0NFUyl9LG1heUNyZWF0ZTpmdW5jdGlvbihlLHQpe3RyeXtUZS5sb29rdXBOb2RlKGUsdCk7cmV0dXJuIG1lLkVFWElTVH1jYXRjaChlKXt9cmV0dXJuIFRlLm5vZGVQZXJtaXNzaW9ucyhlLCJ3eCIpfSxtYXlEZWxldGU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuO3RyeXtuPVRlLmxvb2t1cE5vZGUoZSx0KX1jYXRjaChlKXtyZXR1cm4gZS5lcnJub312YXIgbz1UZS5ub2RlUGVybWlzc2lvbnMoZSwid3giKTtpZihvKXJldHVybiBvO2lmKHIpe2lmKCFUZS5pc0RpcihuLm1vZGUpKXJldHVybiBtZS5FTk9URElSO2lmKFRlLmlzUm9vdChuKXx8VGUuZ2V0UGF0aChuKT09PVRlLmN3ZCgpKXJldHVybiBtZS5FQlVTWX1lbHNlIGlmKFRlLmlzRGlyKG4ubW9kZSkpcmV0dXJuIG1lLkVJU0RJUjtyZXR1cm4gMH0sbWF5T3BlbjpmdW5jdGlvbihlLHQpe3JldHVybiBlP1RlLmlzTGluayhlLm1vZGUpP21lLkVMT09QOlRlLmlzRGlyKGUubW9kZSkmJigiciIhPT1UZS5mbGFnc1RvUGVybWlzc2lvblN0cmluZyh0KXx8NTEyJnQpP21lLkVJU0RJUjpUZS5ub2RlUGVybWlzc2lvbnMoZSxUZS5mbGFnc1RvUGVybWlzc2lvblN0cmluZyh0KSk6bWUuRU5PRU5UfSxNQVhfT1BFTl9GRFM6NDA5NixuZXh0ZmQ6ZnVuY3Rpb24oZSx0KXtlPWV8fDAsdD10fHxUZS5NQVhfT1BFTl9GRFM7Zm9yKHZhciByPWU7cjw9dDtyKyspaWYoIVRlLnN0cmVhbXNbcl0pcmV0dXJuIHI7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU1GSUxFKX0sZ2V0U3RyZWFtOmZ1bmN0aW9uKGUpe3JldHVybiBUZS5zdHJlYW1zW2VdfSxjcmVhdGVTdHJlYW06ZnVuY3Rpb24oZSx0LHIpe1RlLkZTU3RyZWFtfHwoVGUuRlNTdHJlYW09ZnVuY3Rpb24oKXt9LFRlLkZTU3RyZWFtLnByb3RvdHlwZT17fSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhUZS5GU1N0cmVhbS5wcm90b3R5cGUse29iamVjdDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubm9kZX0sc2V0OmZ1bmN0aW9uKGUpe3RoaXMubm9kZT1lfX0saXNSZWFkOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMSE9KDIwOTcxNTUmdGhpcy5mbGFncyl9fSxpc1dyaXRlOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMCE9KDIwOTcxNTUmdGhpcy5mbGFncyl9fSxpc0FwcGVuZDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDEwMjQmdGhpcy5mbGFnc319fSkpO3ZhciBuPW5ldyBUZS5GU1N0cmVhbTtmb3IodmFyIG8gaW4gZSluW29dPWVbb107ZT1uO3ZhciBpPVRlLm5leHRmZCh0LHIpO3JldHVybiBlLmZkPWksVGUuc3RyZWFtc1tpXT1lLGV9LGNsb3NlU3RyZWFtOmZ1bmN0aW9uKGUpe1RlLnN0cmVhbXNbZV09bnVsbH0sY2hyZGV2X3N0cmVhbV9vcHM6e29wZW46ZnVuY3Rpb24oZSl7dmFyIHQ9VGUuZ2V0RGV2aWNlKGUubm9kZS5yZGV2KTtlLnN0cmVhbV9vcHM9dC5zdHJlYW1fb3BzLGUuc3RyZWFtX29wcy5vcGVuJiZlLnN0cmVhbV9vcHMub3BlbihlKX0sbGxzZWVrOmZ1bmN0aW9uKCl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVNQSVBFKX19LG1ham9yOmZ1bmN0aW9uKGUpe3JldHVybiBlPj44fSxtaW5vcjpmdW5jdGlvbihlKXtyZXR1cm4gMjU1JmV9LG1ha2VkZXY6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZTw8OHx0fSxyZWdpc3RlckRldmljZTpmdW5jdGlvbihlLHQpe1RlLmRldmljZXNbZV09e3N0cmVhbV9vcHM6dH19LGdldERldmljZTpmdW5jdGlvbihlKXtyZXR1cm4gVGUuZGV2aWNlc1tlXX0sZ2V0TW91bnRzOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxyPVtlXTtyLmxlbmd0aDspe3ZhciBuPXIucG9wKCk7dC5wdXNoKG4pLHIucHVzaC5hcHBseShyLG4ubW91bnRzKX1yZXR1cm4gdH0sc3luY2ZzOmZ1bmN0aW9uKGUsdCl7ImZ1bmN0aW9uIj09dHlwZW9mIGUmJih0PWUsZT0hMSksVGUuc3luY0ZTUmVxdWVzdHMrKyxUZS5zeW5jRlNSZXF1ZXN0cz4xJiZjb25zb2xlLmxvZygid2FybmluZzogIitUZS5zeW5jRlNSZXF1ZXN0cysiIEZTLnN5bmNmcyBvcGVyYXRpb25zIGluIGZsaWdodCBhdCBvbmNlLCBwcm9iYWJseSBqdXN0IGRvaW5nIGV4dHJhIHdvcmsiKTt2YXIgcj1UZS5nZXRNb3VudHMoVGUucm9vdC5tb3VudCksbj0wO2Z1bmN0aW9uIG8oZSl7cmV0dXJuIHkoVGUuc3luY0ZTUmVxdWVzdHM+MCksVGUuc3luY0ZTUmVxdWVzdHMtLSx0KGUpfWZ1bmN0aW9uIGkoZSl7aWYoZSlyZXR1cm4gaS5lcnJvcmVkP3ZvaWQgMDooaS5lcnJvcmVkPSEwLG8oZSkpOysrbj49ci5sZW5ndGgmJm8obnVsbCl9ci5mb3JFYWNoKChmdW5jdGlvbih0KXtpZighdC50eXBlLnN5bmNmcylyZXR1cm4gaShudWxsKTt0LnR5cGUuc3luY2ZzKHQsZSxpKX0pKX0sbW91bnQ6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG89Ii8iPT09cixpPSFyO2lmKG8mJlRlLnJvb3QpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJVU1kpO2lmKCFvJiYhaSl7dmFyIGE9VGUubG9va3VwUGF0aChyLHtmb2xsb3dfbW91bnQ6ITF9KTtpZihyPWEucGF0aCxuPWEubm9kZSxUZS5pc01vdW50cG9pbnQobikpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJVU1kpO2lmKCFUZS5pc0RpcihuLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RESVIpfXZhciBzPXt0eXBlOmUsb3B0czp0LG1vdW50cG9pbnQ6cixtb3VudHM6W119LHU9ZS5tb3VudChzKTtyZXR1cm4gdS5tb3VudD1zLHMucm9vdD11LG8/VGUucm9vdD11Om4mJihuLm1vdW50ZWQ9cyxuLm1vdW50JiZuLm1vdW50Lm1vdW50cy5wdXNoKHMpKSx1fSx1bm1vdW50OmZ1bmN0aW9uKGUpe3ZhciB0PVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93X21vdW50OiExfSk7aWYoIVRlLmlzTW91bnRwb2ludCh0Lm5vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIHI9dC5ub2RlLG49ci5tb3VudGVkLG89VGUuZ2V0TW91bnRzKG4pO09iamVjdC5rZXlzKFRlLm5hbWVUYWJsZSkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PVRlLm5hbWVUYWJsZVtlXTt0Oyl7dmFyIHI9dC5uYW1lX25leHQ7LTEhPT1vLmluZGV4T2YodC5tb3VudCkmJlRlLmRlc3Ryb3lOb2RlKHQpLHQ9cn19KSksci5tb3VudGVkPW51bGw7dmFyIGk9ci5tb3VudC5tb3VudHMuaW5kZXhPZihuKTt5KC0xIT09aSksci5tb3VudC5tb3VudHMuc3BsaWNlKGksMSl9LGxvb2t1cDpmdW5jdGlvbihlLHQpe3JldHVybiBlLm5vZGVfb3BzLmxvb2t1cChlLHQpfSxta25vZDpmdW5jdGlvbihlLHQscil7dmFyIG49VGUubG9va3VwUGF0aChlLHtwYXJlbnQ6ITB9KS5ub2RlLG89Z2UuYmFzZW5hbWUoZSk7aWYoIW98fCIuIj09PW98fCIuLiI9PT1vKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIGk9VGUubWF5Q3JlYXRlKG4sbyk7aWYoaSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihpKTtpZighbi5ub2RlX29wcy5ta25vZCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7cmV0dXJuIG4ubm9kZV9vcHMubWtub2QobixvLHQscil9LGNyZWF0ZTpmdW5jdGlvbihlLHQpe3JldHVybiB0PXZvaWQgMCE9PXQ/dDo0MzgsdCY9NDA5NSx0fD0zMjc2OCxUZS5ta25vZChlLHQsMCl9LG1rZGlyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ9dm9pZCAwIT09dD90OjUxMSx0Jj0xMDIzLHR8PTE2Mzg0LFRlLm1rbm9kKGUsdCwwKX0sbWtkaXJUcmVlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPWUuc3BsaXQoIi8iKSxuPSIiLG89MDtvPHIubGVuZ3RoOysrbylpZihyW29dKXtuKz0iLyIrcltvXTt0cnl7VGUubWtkaXIobix0KX1jYXRjaChlKXtpZihlLmVycm5vIT1tZS5FRVhJU1QpdGhyb3cgZX19fSxta2RldjpmdW5jdGlvbihlLHQscil7cmV0dXJuIHZvaWQgMD09PXImJihyPXQsdD00MzgpLHR8PTgxOTIsVGUubWtub2QoZSx0LHIpfSxzeW1saW5rOmZ1bmN0aW9uKGUsdCl7aWYoIWdlLnJlc29sdmUoZSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTt2YXIgcj1UZS5sb29rdXBQYXRoKHQse3BhcmVudDohMH0pLm5vZGU7aWYoIXIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTt2YXIgbj1nZS5iYXNlbmFtZSh0KSxvPVRlLm1heUNyZWF0ZShyLG4pO2lmKG8pdGhyb3cgbmV3IFRlLkVycm5vRXJyb3Iobyk7aWYoIXIubm9kZV9vcHMuc3ltbGluayl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7cmV0dXJuIHIubm9kZV9vcHMuc3ltbGluayhyLG4sZSl9LHJlbmFtZTpmdW5jdGlvbihlLHQpe3ZhciByLG4sbz1nZS5kaXJuYW1lKGUpLGk9Z2UuZGlybmFtZSh0KSxhPWdlLmJhc2VuYW1lKGUpLHM9Z2UuYmFzZW5hbWUodCk7dHJ5e3I9VGUubG9va3VwUGF0aChlLHtwYXJlbnQ6ITB9KS5ub2RlLG49VGUubG9va3VwUGF0aCh0LHtwYXJlbnQ6ITB9KS5ub2RlfWNhdGNoKGUpe3Rocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCVVNZKX1pZighcnx8IW4pdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTtpZihyLm1vdW50IT09bi5tb3VudCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FWERFVik7dmFyIHUsYz1UZS5sb29rdXBOb2RlKHIsYSksbD1nZS5yZWxhdGl2ZShlLGkpO2lmKCIuIiE9PWwuY2hhckF0KDApKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7aWYoIi4iIT09KGw9Z2UucmVsYXRpdmUodCxvKSkuY2hhckF0KDApKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RFTVBUWSk7dHJ5e3U9VGUubG9va3VwTm9kZShuLHMpfWNhdGNoKGUpe31pZihjIT09dSl7dmFyIGY9VGUuaXNEaXIoYy5tb2RlKSxkPVRlLm1heURlbGV0ZShyLGEsZik7aWYoZCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihkKTtpZihkPXU/VGUubWF5RGVsZXRlKG4scyxmKTpUZS5tYXlDcmVhdGUobixzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihkKTtpZighci5ub2RlX29wcy5yZW5hbWUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pO2lmKFRlLmlzTW91bnRwb2ludChjKXx8dSYmVGUuaXNNb3VudHBvaW50KHUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCVVNZKTtpZihuIT09ciYmKGQ9VGUubm9kZVBlcm1pc3Npb25zKHIsInciKSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IoZCk7dHJ5e1RlLnRyYWNraW5nRGVsZWdhdGUud2lsbE1vdmVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLndpbGxNb3ZlUGF0aChlLHQpfWNhdGNoKHIpe2NvbnNvbGUubG9nKCJGUy50cmFja2luZ0RlbGVnYXRlWyd3aWxsTW92ZVBhdGgnXSgnIitlKyInLCAnIit0KyInKSB0aHJldyBhbiBleGNlcHRpb246ICIrci5tZXNzYWdlKX1UZS5oYXNoUmVtb3ZlTm9kZShjKTt0cnl7ci5ub2RlX29wcy5yZW5hbWUoYyxuLHMpfWNhdGNoKGUpe3Rocm93IGV9ZmluYWxseXtUZS5oYXNoQWRkTm9kZShjKX10cnl7VGUudHJhY2tpbmdEZWxlZ2F0ZS5vbk1vdmVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLm9uTW92ZVBhdGgoZSx0KX1jYXRjaChyKXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnb25Nb3ZlUGF0aCddKCciK2UrIicsICciK3QrIicpIHRocmV3IGFuIGV4Y2VwdGlvbjogIityLm1lc3NhZ2UpfX19LHJtZGlyOmZ1bmN0aW9uKGUpe3ZhciB0PVRlLmxvb2t1cFBhdGgoZSx7cGFyZW50OiEwfSkubm9kZSxyPWdlLmJhc2VuYW1lKGUpLG49VGUubG9va3VwTm9kZSh0LHIpLG89VGUubWF5RGVsZXRlKHQsciwhMCk7aWYobyl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihvKTtpZighdC5ub2RlX29wcy5ybWRpcil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7aWYoVGUuaXNNb3VudHBvaW50KG4pKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCVVNZKTt0cnl7VGUudHJhY2tpbmdEZWxlZ2F0ZS53aWxsRGVsZXRlUGF0aCYmVGUudHJhY2tpbmdEZWxlZ2F0ZS53aWxsRGVsZXRlUGF0aChlKX1jYXRjaCh0KXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnd2lsbERlbGV0ZVBhdGgnXSgnIitlKyInKSB0aHJldyBhbiBleGNlcHRpb246ICIrdC5tZXNzYWdlKX10Lm5vZGVfb3BzLnJtZGlyKHQsciksVGUuZGVzdHJveU5vZGUobik7dHJ5e1RlLnRyYWNraW5nRGVsZWdhdGUub25EZWxldGVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLm9uRGVsZXRlUGF0aChlKX1jYXRjaCh0KXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnb25EZWxldGVQYXRoJ10oJyIrZSsiJykgdGhyZXcgYW4gZXhjZXB0aW9uOiAiK3QubWVzc2FnZSl9fSxyZWFkZGlyOmZ1bmN0aW9uKGUpe3ZhciB0PVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiEwfSkubm9kZTtpZighdC5ub2RlX29wcy5yZWFkZGlyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RESVIpO3JldHVybiB0Lm5vZGVfb3BzLnJlYWRkaXIodCl9LHVubGluazpmdW5jdGlvbihlKXt2YXIgdD1UZS5sb29rdXBQYXRoKGUse3BhcmVudDohMH0pLm5vZGUscj1nZS5iYXNlbmFtZShlKSxuPVRlLmxvb2t1cE5vZGUodCxyKSxvPVRlLm1heURlbGV0ZSh0LHIsITEpO2lmKG8pdGhyb3cgbmV3IFRlLkVycm5vRXJyb3Iobyk7aWYoIXQubm9kZV9vcHMudW5saW5rKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKTtpZihUZS5pc01vdW50cG9pbnQobikpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJVU1kpO3RyeXtUZS50cmFja2luZ0RlbGVnYXRlLndpbGxEZWxldGVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLndpbGxEZWxldGVQYXRoKGUpfWNhdGNoKHQpe2NvbnNvbGUubG9nKCJGUy50cmFja2luZ0RlbGVnYXRlWyd3aWxsRGVsZXRlUGF0aCddKCciK2UrIicpIHRocmV3IGFuIGV4Y2VwdGlvbjogIit0Lm1lc3NhZ2UpfXQubm9kZV9vcHMudW5saW5rKHQsciksVGUuZGVzdHJveU5vZGUobik7dHJ5e1RlLnRyYWNraW5nRGVsZWdhdGUub25EZWxldGVQYXRoJiZUZS50cmFja2luZ0RlbGVnYXRlLm9uRGVsZXRlUGF0aChlKX1jYXRjaCh0KXtjb25zb2xlLmxvZygiRlMudHJhY2tpbmdEZWxlZ2F0ZVsnb25EZWxldGVQYXRoJ10oJyIrZSsiJykgdGhyZXcgYW4gZXhjZXB0aW9uOiAiK3QubWVzc2FnZSl9fSxyZWFkbGluazpmdW5jdGlvbihlKXt2YXIgdD1UZS5sb29rdXBQYXRoKGUpLm5vZGU7aWYoIXQpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PRU5UKTtpZighdC5ub2RlX29wcy5yZWFkbGluayl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO3JldHVybiBnZS5yZXNvbHZlKFRlLmdldFBhdGgodC5wYXJlbnQpLHQubm9kZV9vcHMucmVhZGxpbmsodCkpfSxzdGF0OmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6IXR9KS5ub2RlO2lmKCFyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT0VOVCk7aWYoIXIubm9kZV9vcHMuZ2V0YXR0cil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7cmV0dXJuIHIubm9kZV9vcHMuZ2V0YXR0cihyKX0sbHN0YXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFRlLnN0YXQoZSwhMCl9LGNobW9kOmZ1bmN0aW9uKGUsdCxyKXt2YXIgbjsic3RyaW5nIj09dHlwZW9mIGU/bj1UZS5sb29rdXBQYXRoKGUse2ZvbGxvdzohcn0pLm5vZGU6bj1lO2lmKCFuLm5vZGVfb3BzLnNldGF0dHIpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVBFUk0pO24ubm9kZV9vcHMuc2V0YXR0cihuLHttb2RlOjQwOTUmdHwtNDA5NiZuLm1vZGUsdGltZXN0YW1wOkRhdGUubm93KCl9KX0sbGNobW9kOmZ1bmN0aW9uKGUsdCl7VGUuY2htb2QoZSx0LCEwKX0sZmNobW9kOmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUuZ2V0U3RyZWFtKGUpO2lmKCFyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtUZS5jaG1vZChyLm5vZGUsdCl9LGNob3duOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvOyJzdHJpbmciPT10eXBlb2YgZT9vPVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiFufSkubm9kZTpvPWU7aWYoIW8ubm9kZV9vcHMuc2V0YXR0cil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FUEVSTSk7by5ub2RlX29wcy5zZXRhdHRyKG8se3RpbWVzdGFtcDpEYXRlLm5vdygpfSl9LGxjaG93bjpmdW5jdGlvbihlLHQscil7VGUuY2hvd24oZSx0LHIsITApfSxmY2hvd246ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPVRlLmdldFN0cmVhbShlKTtpZighbil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7VGUuY2hvd24obi5ub2RlLHQscil9LHRydW5jYXRlOmZ1bmN0aW9uKGUsdCl7aWYodDwwKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIHI7InN0cmluZyI9PXR5cGVvZiBlP3I9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6ITB9KS5ub2RlOnI9ZTtpZighci5ub2RlX29wcy5zZXRhdHRyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVQRVJNKTtpZihUZS5pc0RpcihyLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJU0RJUik7aWYoIVRlLmlzRmlsZShyLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIG49VGUubm9kZVBlcm1pc3Npb25zKHIsInciKTtpZihuKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG4pO3Iubm9kZV9vcHMuc2V0YXR0cihyLHtzaXplOnQsdGltZXN0YW1wOkRhdGUubm93KCl9KX0sZnRydW5jYXRlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9VGUuZ2V0U3RyZWFtKGUpO2lmKCFyKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZigwPT0oMjA5NzE1NSZyLmZsYWdzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO1RlLnRydW5jYXRlKHIubm9kZSx0KX0sdXRpbWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPVRlLmxvb2t1cFBhdGgoZSx7Zm9sbG93OiEwfSkubm9kZTtuLm5vZGVfb3BzLnNldGF0dHIobix7dGltZXN0YW1wOk1hdGgubWF4KHQscil9KX0sb3BlbjpmdW5jdGlvbihlLHQscixuLGkpe2lmKCIiPT09ZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9FTlQpO3ZhciBhO2lmKHI9dm9pZCAwPT09cj80Mzg6cixyPTY0Jih0PSJzdHJpbmciPT10eXBlb2YgdD9UZS5tb2RlU3RyaW5nVG9GbGFncyh0KTp0KT80MDk1JnJ8MzI3Njg6MCwib2JqZWN0Ij09dHlwZW9mIGUpYT1lO2Vsc2V7ZT1nZS5ub3JtYWxpemUoZSk7dHJ5e2E9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6ISgxMzEwNzImdCl9KS5ub2RlfWNhdGNoKGUpe319dmFyIHM9ITE7aWYoNjQmdClpZihhKXtpZigxMjgmdCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FRVhJU1QpfWVsc2UgYT1UZS5ta25vZChlLHIsMCkscz0hMDtpZighYSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9FTlQpO2lmKFRlLmlzQ2hyZGV2KGEubW9kZSkmJih0Jj0tNTEzKSw2NTUzNiZ0JiYhVGUuaXNEaXIoYS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9URElSKTtpZighcyl7dmFyIHU9VGUubWF5T3BlbihhLHQpO2lmKHUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IodSl9NTEyJnQmJlRlLnRydW5jYXRlKGEsMCksdCY9LTY0MTt2YXIgYz1UZS5jcmVhdGVTdHJlYW0oe25vZGU6YSxwYXRoOlRlLmdldFBhdGgoYSksZmxhZ3M6dCxzZWVrYWJsZTohMCxwb3NpdGlvbjowLHN0cmVhbV9vcHM6YS5zdHJlYW1fb3BzLHVuZ290dGVuOltdLGVycm9yOiExfSxuLGkpO2Muc3RyZWFtX29wcy5vcGVuJiZjLnN0cmVhbV9vcHMub3BlbihjKSwhby5sb2dSZWFkRmlsZXN8fDEmdHx8KFRlLnJlYWRGaWxlc3x8KFRlLnJlYWRGaWxlcz17fSksZSBpbiBUZS5yZWFkRmlsZXN8fChUZS5yZWFkRmlsZXNbZV09MSxvLnByaW50RXJyKCJyZWFkIGZpbGU6ICIrZSkpKTt0cnl7aWYoVGUudHJhY2tpbmdEZWxlZ2F0ZS5vbk9wZW5GaWxlKXt2YXIgbD0wOzEhPSgyMDk3MTU1JnQpJiYobHw9VGUudHJhY2tpbmcub3BlbkZsYWdzLlJFQUQpLDAhPSgyMDk3MTU1JnQpJiYobHw9VGUudHJhY2tpbmcub3BlbkZsYWdzLldSSVRFKSxUZS50cmFja2luZ0RlbGVnYXRlLm9uT3BlbkZpbGUoZSxsKX19Y2F0Y2godCl7Y29uc29sZS5sb2coIkZTLnRyYWNraW5nRGVsZWdhdGVbJ29uT3BlbkZpbGUnXSgnIitlKyInLCBmbGFncykgdGhyZXcgYW4gZXhjZXB0aW9uOiAiK3QubWVzc2FnZSl9cmV0dXJuIGN9LGNsb3NlOmZ1bmN0aW9uKGUpe2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtlLmdldGRlbnRzJiYoZS5nZXRkZW50cz1udWxsKTt0cnl7ZS5zdHJlYW1fb3BzLmNsb3NlJiZlLnN0cmVhbV9vcHMuY2xvc2UoZSl9Y2F0Y2goZSl7dGhyb3cgZX1maW5hbGx5e1RlLmNsb3NlU3RyZWFtKGUuZmQpfWUuZmQ9bnVsbH0saXNDbG9zZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PT1lLmZkfSxsbHNlZWs6ZnVuY3Rpb24oZSx0LHIpe2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZighZS5zZWVrYWJsZXx8IWUuc3RyZWFtX29wcy5sbHNlZWspdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRVNQSVBFKTtyZXR1cm4gZS5wb3NpdGlvbj1lLnN0cmVhbV9vcHMubGxzZWVrKGUsdCxyKSxlLnVuZ290dGVuPVtdLGUucG9zaXRpb259LHJlYWQ6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZihuPDB8fG88MCl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU5WQUwpO2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZigxPT0oMjA5NzE1NSZlLmZsYWdzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7aWYoVGUuaXNEaXIoZS5ub2RlLm1vZGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJU0RJUik7aWYoIWUuc3RyZWFtX29wcy5yZWFkKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVJTlZBTCk7dmFyIGk9dm9pZCAwIT09bztpZihpKXtpZighZS5zZWVrYWJsZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FU1BJUEUpfWVsc2Ugbz1lLnBvc2l0aW9uO3ZhciBhPWUuc3RyZWFtX29wcy5yZWFkKGUsdCxyLG4sbyk7cmV0dXJuIGl8fChlLnBvc2l0aW9uKz1hKSxhfSx3cml0ZTpmdW5jdGlvbihlLHQscixuLG8saSl7aWYobjwwfHxvPDApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtpZihUZS5pc0Nsb3NlZChlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7aWYoMD09KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJBREYpO2lmKFRlLmlzRGlyKGUubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSVNESVIpO2lmKCFlLnN0cmVhbV9vcHMud3JpdGUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTsxMDI0JmUuZmxhZ3MmJlRlLmxsc2VlayhlLDAsMik7dmFyIGE9dm9pZCAwIT09bztpZihhKXtpZighZS5zZWVrYWJsZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FU1BJUEUpfWVsc2Ugbz1lLnBvc2l0aW9uO3ZhciBzPWUuc3RyZWFtX29wcy53cml0ZShlLHQscixuLG8saSk7YXx8KGUucG9zaXRpb24rPXMpO3RyeXtlLnBhdGgmJlRlLnRyYWNraW5nRGVsZWdhdGUub25Xcml0ZVRvRmlsZSYmVGUudHJhY2tpbmdEZWxlZ2F0ZS5vbldyaXRlVG9GaWxlKGUucGF0aCl9Y2F0Y2goZSl7Y29uc29sZS5sb2coIkZTLnRyYWNraW5nRGVsZWdhdGVbJ29uV3JpdGVUb0ZpbGUnXSgnIitwYXRoKyInKSB0aHJldyBhbiBleGNlcHRpb246ICIrZS5tZXNzYWdlKX1yZXR1cm4gc30sYWxsb2NhdGU6ZnVuY3Rpb24oZSx0LHIpe2lmKFRlLmlzQ2xvc2VkKGUpKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVCQURGKTtpZih0PDB8fHI8PTApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlOVkFMKTtpZigwPT0oMjA5NzE1NSZlLmZsYWdzKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7aWYoIVRlLmlzRmlsZShlLm5vZGUubW9kZSkmJiFUZS5pc0RpcihlLm5vZGUubW9kZSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PREVWKTtpZighZS5zdHJlYW1fb3BzLmFsbG9jYXRlKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVPUE5PVFNVUFApO2Uuc3RyZWFtX29wcy5hbGxvY2F0ZShlLHQscil9LG1tYXA6ZnVuY3Rpb24oZSx0LHIsbixvLGksYSl7aWYoMT09KDIwOTcxNTUmZS5mbGFncykpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUFDQ0VTKTtpZighZS5zdHJlYW1fb3BzLm1tYXApdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRU5PREVWKTtyZXR1cm4gZS5zdHJlYW1fb3BzLm1tYXAoZSx0LHIsbixvLGksYSl9LG1zeW5jOmZ1bmN0aW9uKGUsdCxyLG4sbyl7cmV0dXJuIGUmJmUuc3RyZWFtX29wcy5tc3luYz9lLnN0cmVhbV9vcHMubXN5bmMoZSx0LHIsbixvKTowfSxtdW5tYXA6ZnVuY3Rpb24oZSl7cmV0dXJuIDB9LGlvY3RsOmZ1bmN0aW9uKGUsdCxyKXtpZighZS5zdHJlYW1fb3BzLmlvY3RsKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT1RUWSk7cmV0dXJuIGUuc3RyZWFtX29wcy5pb2N0bChlLHQscil9LHJlYWRGaWxlOmZ1bmN0aW9uKGUsdCl7aWYoKHQ9dHx8e30pLmZsYWdzPXQuZmxhZ3N8fCJyIix0LmVuY29kaW5nPXQuZW5jb2Rpbmd8fCJiaW5hcnkiLCJ1dGY4IiE9PXQuZW5jb2RpbmcmJiJiaW5hcnkiIT09dC5lbmNvZGluZyl0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZW5jb2RpbmcgdHlwZSAiJyt0LmVuY29kaW5nKyciJyk7dmFyIHIsbj1UZS5vcGVuKGUsdC5mbGFncyksbz1UZS5zdGF0KGUpLnNpemUsaT1uZXcgVWludDhBcnJheShvKTtyZXR1cm4gVGUucmVhZChuLGksMCxvLDApLCJ1dGY4Ij09PXQuZW5jb2Rpbmc/cj1fKGksMCk6ImJpbmFyeSI9PT10LmVuY29kaW5nJiYocj1pKSxUZS5jbG9zZShuKSxyfSx3cml0ZUZpbGU6ZnVuY3Rpb24oZSx0LHIpeyhyPXJ8fHt9KS5mbGFncz1yLmZsYWdzfHwidyI7dmFyIG49VGUub3BlbihlLHIuZmxhZ3Msci5tb2RlKTtpZigic3RyaW5nIj09dHlwZW9mIHQpe3ZhciBvPW5ldyBVaW50OEFycmF5KFModCkrMSksaT1BKHQsbywwLG8ubGVuZ3RoKTtUZS53cml0ZShuLG8sMCxpLHZvaWQgMCxyLmNhbk93bil9ZWxzZXtpZighQXJyYXlCdWZmZXIuaXNWaWV3KHQpKXRocm93IG5ldyBFcnJvcigiVW5zdXBwb3J0ZWQgZGF0YSB0eXBlIik7VGUud3JpdGUobix0LDAsdC5ieXRlTGVuZ3RoLHZvaWQgMCxyLmNhbk93bil9VGUuY2xvc2Uobil9LGN3ZDpmdW5jdGlvbigpe3JldHVybiBUZS5jdXJyZW50UGF0aH0sY2hkaXI6ZnVuY3Rpb24oZSl7dmFyIHQ9VGUubG9va3VwUGF0aChlLHtmb2xsb3c6ITB9KTtpZihudWxsPT09dC5ub2RlKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG1lLkVOT0VOVCk7aWYoIVRlLmlzRGlyKHQubm9kZS5tb2RlKSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FTk9URElSKTt2YXIgcj1UZS5ub2RlUGVybWlzc2lvbnModC5ub2RlLCJ4Iik7aWYocil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihyKTtUZS5jdXJyZW50UGF0aD10LnBhdGh9LGNyZWF0ZURlZmF1bHREaXJlY3RvcmllczpmdW5jdGlvbigpe1RlLm1rZGlyKCIvdG1wIiksVGUubWtkaXIoIi9ob21lIiksVGUubWtkaXIoIi9ob21lL3dlYl91c2VyIil9LGNyZWF0ZURlZmF1bHREZXZpY2VzOmZ1bmN0aW9uKCl7dmFyIGU7aWYoVGUubWtkaXIoIi9kZXYiKSxUZS5yZWdpc3RlckRldmljZShUZS5tYWtlZGV2KDEsMykse3JlYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gMH0sd3JpdGU6ZnVuY3Rpb24oZSx0LHIsbixvKXtyZXR1cm4gbn19KSxUZS5ta2RldigiL2Rldi9udWxsIixUZS5tYWtlZGV2KDEsMykpLHZlLnJlZ2lzdGVyKFRlLm1ha2VkZXYoNSwwKSx2ZS5kZWZhdWx0X3R0eV9vcHMpLHZlLnJlZ2lzdGVyKFRlLm1ha2VkZXYoNiwwKSx2ZS5kZWZhdWx0X3R0eTFfb3BzKSxUZS5ta2RldigiL2Rldi90dHkiLFRlLm1ha2VkZXYoNSwwKSksVGUubWtkZXYoIi9kZXYvdHR5MSIsVGUubWFrZWRldig2LDApKSwidW5kZWZpbmVkIiE9dHlwZW9mIGNyeXB0byl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoMSk7ZT1mdW5jdGlvbigpe3JldHVybiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHQpLHRbMF19fWVsc2UgZT1sP2Z1bmN0aW9uKCl7cmV0dXJuIHJlcXVpcmUoImNyeXB0byIpLnJhbmRvbUJ5dGVzKDEpWzBdfTpmdW5jdGlvbigpe3JldHVybiAyNTYqTWF0aC5yYW5kb20oKXwwfTtUZS5jcmVhdGVEZXZpY2UoIi9kZXYiLCJyYW5kb20iLGUpLFRlLmNyZWF0ZURldmljZSgiL2RldiIsInVyYW5kb20iLGUpLFRlLm1rZGlyKCIvZGV2L3NobSIpLFRlLm1rZGlyKCIvZGV2L3NobS90bXAiKX0sY3JlYXRlU3BlY2lhbERpcmVjdG9yaWVzOmZ1bmN0aW9uKCl7VGUubWtkaXIoIi9wcm9jIiksVGUubWtkaXIoIi9wcm9jL3NlbGYiKSxUZS5ta2RpcigiL3Byb2Mvc2VsZi9mZCIpLFRlLm1vdW50KHttb3VudDpmdW5jdGlvbigpe3ZhciBlPVRlLmNyZWF0ZU5vZGUoIi9wcm9jL3NlbGYiLCJmZCIsMTY4OTUsNzMpO3JldHVybiBlLm5vZGVfb3BzPXtsb29rdXA6ZnVuY3Rpb24oZSx0KXt2YXIgcj0rdCxuPVRlLmdldFN0cmVhbShyKTtpZighbil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7dmFyIG89e3BhcmVudDpudWxsLG1vdW50Onttb3VudHBvaW50OiJmYWtlIn0sbm9kZV9vcHM6e3JlYWRsaW5rOmZ1bmN0aW9uKCl7cmV0dXJuIG4ucGF0aH19fTtyZXR1cm4gby5wYXJlbnQ9byxvfX0sZX19LHt9LCIvcHJvYy9zZWxmL2ZkIil9LGNyZWF0ZVN0YW5kYXJkU3RyZWFtczpmdW5jdGlvbigpe28uc3RkaW4/VGUuY3JlYXRlRGV2aWNlKCIvZGV2Iiwic3RkaW4iLG8uc3RkaW4pOlRlLnN5bWxpbmsoIi9kZXYvdHR5IiwiL2Rldi9zdGRpbiIpLG8uc3Rkb3V0P1RlLmNyZWF0ZURldmljZSgiL2RldiIsInN0ZG91dCIsbnVsbCxvLnN0ZG91dCk6VGUuc3ltbGluaygiL2Rldi90dHkiLCIvZGV2L3N0ZG91dCIpLG8uc3RkZXJyP1RlLmNyZWF0ZURldmljZSgiL2RldiIsInN0ZGVyciIsbnVsbCxvLnN0ZGVycik6VGUuc3ltbGluaygiL2Rldi90dHkxIiwiL2Rldi9zdGRlcnIiKTt2YXIgZT1UZS5vcGVuKCIvZGV2L3N0ZGluIiwiciIpO3koMD09PWUuZmQsImludmFsaWQgaGFuZGxlIGZvciBzdGRpbiAoIitlLmZkKyIpIik7dmFyIHQ9VGUub3BlbigiL2Rldi9zdGRvdXQiLCJ3Iik7eSgxPT09dC5mZCwiaW52YWxpZCBoYW5kbGUgZm9yIHN0ZG91dCAoIit0LmZkKyIpIik7dmFyIHI9VGUub3BlbigiL2Rldi9zdGRlcnIiLCJ3Iik7eSgyPT09ci5mZCwiaW52YWxpZCBoYW5kbGUgZm9yIHN0ZGVyciAoIityLmZkKyIpIil9LGVuc3VyZUVycm5vRXJyb3I6ZnVuY3Rpb24oKXtUZS5FcnJub0Vycm9yfHwoVGUuRXJybm9FcnJvcj1mdW5jdGlvbihlLHQpe3RoaXMubm9kZT10LHRoaXMuc2V0RXJybm89ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIHRoaXMuZXJybm89ZSxtZSlpZihtZVt0XT09PWUpe3RoaXMuY29kZT10O2JyZWFrfX0sdGhpcy5zZXRFcnJubyhlKSx0aGlzLm1lc3NhZ2U9RWVbZV0sdGhpcy5zdGFjayYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsInN0YWNrIix7dmFsdWU6KG5ldyBFcnJvcikuc3RhY2ssd3JpdGFibGU6ITB9KX0sVGUuRXJybm9FcnJvci5wcm90b3R5cGU9bmV3IEVycm9yLFRlLkVycm5vRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yPVRlLkVycm5vRXJyb3IsW21lLkVOT0VOVF0uZm9yRWFjaCgoZnVuY3Rpb24oZSl7VGUuZ2VuZXJpY0Vycm9yc1tlXT1uZXcgVGUuRXJybm9FcnJvcihlKSxUZS5nZW5lcmljRXJyb3JzW2VdLnN0YWNrPSI8Z2VuZXJpYyBlcnJvciwgbm8gc3RhY2s+In0pKSl9LHN0YXRpY0luaXQ6ZnVuY3Rpb24oKXtUZS5lbnN1cmVFcnJub0Vycm9yKCksVGUubmFtZVRhYmxlPW5ldyBBcnJheSg0MDk2KSxUZS5tb3VudCh3ZSx7fSwiLyIpLFRlLmNyZWF0ZURlZmF1bHREaXJlY3RvcmllcygpLFRlLmNyZWF0ZURlZmF1bHREZXZpY2VzKCksVGUuY3JlYXRlU3BlY2lhbERpcmVjdG9yaWVzKCksVGUuZmlsZXN5c3RlbXM9e01FTUZTOndlLElEQkZTOl9lLE5PREVGUzpiZSxXT1JLRVJGUzpBZX19LGluaXQ6ZnVuY3Rpb24oZSx0LHIpe3koIVRlLmluaXQuaW5pdGlhbGl6ZWQsIkZTLmluaXQgd2FzIHByZXZpb3VzbHkgY2FsbGVkLiBJZiB5b3Ugd2FudCB0byBpbml0aWFsaXplIGxhdGVyIHdpdGggY3VzdG9tIHBhcmFtZXRlcnMsIHJlbW92ZSBhbnkgZWFybGllciBjYWxscyAobm90ZSB0aGF0IG9uZSBpcyBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIHRoZSBnZW5lcmF0ZWQgY29kZSkiKSxUZS5pbml0LmluaXRpYWxpemVkPSEwLFRlLmVuc3VyZUVycm5vRXJyb3IoKSxvLnN0ZGluPWV8fG8uc3RkaW4sby5zdGRvdXQ9dHx8by5zdGRvdXQsby5zdGRlcnI9cnx8by5zdGRlcnIsVGUuY3JlYXRlU3RhbmRhcmRTdHJlYW1zKCl9LHF1aXQ6ZnVuY3Rpb24oKXtUZS5pbml0LmluaXRpYWxpemVkPSExO3ZhciBlPW8uX2ZmbHVzaDtlJiZlKDApO2Zvcih2YXIgdD0wO3Q8VGUuc3RyZWFtcy5sZW5ndGg7dCsrKXt2YXIgcj1UZS5zdHJlYW1zW3RdO3ImJlRlLmNsb3NlKHIpfX0sZ2V0TW9kZTpmdW5jdGlvbihlLHQpe3ZhciByPTA7cmV0dXJuIGUmJihyfD0zNjUpLHQmJihyfD0xNDYpLHJ9LGpvaW5QYXRoOmZ1bmN0aW9uKGUsdCl7dmFyIHI9Z2Uuam9pbi5hcHBseShudWxsLGUpO3JldHVybiB0JiYiLyI9PXJbMF0mJihyPXIuc3Vic3RyKDEpKSxyfSxhYnNvbHV0ZVBhdGg6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZ2UucmVzb2x2ZSh0LGUpfSxzdGFuZGFyZGl6ZVBhdGg6ZnVuY3Rpb24oZSl7cmV0dXJuIGdlLm5vcm1hbGl6ZShlKX0sZmluZE9iamVjdDpmdW5jdGlvbihlLHQpe3ZhciByPVRlLmFuYWx5emVQYXRoKGUsdCk7cmV0dXJuIHIuZXhpc3RzP3Iub2JqZWN0Oih5ZShyLmVycm9yKSxudWxsKX0sYW5hbHl6ZVBhdGg6ZnVuY3Rpb24oZSx0KXt0cnl7ZT0obj1UZS5sb29rdXBQYXRoKGUse2ZvbGxvdzohdH0pKS5wYXRofWNhdGNoKGUpe312YXIgcj17aXNSb290OiExLGV4aXN0czohMSxlcnJvcjowLG5hbWU6bnVsbCxwYXRoOm51bGwsb2JqZWN0Om51bGwscGFyZW50RXhpc3RzOiExLHBhcmVudFBhdGg6bnVsbCxwYXJlbnRPYmplY3Q6bnVsbH07dHJ5e3ZhciBuPVRlLmxvb2t1cFBhdGgoZSx7cGFyZW50OiEwfSk7ci5wYXJlbnRFeGlzdHM9ITAsci5wYXJlbnRQYXRoPW4ucGF0aCxyLnBhcmVudE9iamVjdD1uLm5vZGUsci5uYW1lPWdlLmJhc2VuYW1lKGUpLG49VGUubG9va3VwUGF0aChlLHtmb2xsb3c6IXR9KSxyLmV4aXN0cz0hMCxyLnBhdGg9bi5wYXRoLHIub2JqZWN0PW4ubm9kZSxyLm5hbWU9bi5ub2RlLm5hbWUsci5pc1Jvb3Q9Ii8iPT09bi5wYXRofWNhdGNoKGUpe3IuZXJyb3I9ZS5lcnJub31yZXR1cm4gcn0sY3JlYXRlRm9sZGVyOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCksaT1UZS5nZXRNb2RlKHIsbik7cmV0dXJuIFRlLm1rZGlyKG8saSl9LGNyZWF0ZVBhdGg6ZnVuY3Rpb24oZSx0LHIsbil7ZT0ic3RyaW5nIj09dHlwZW9mIGU/ZTpUZS5nZXRQYXRoKGUpO2Zvcih2YXIgbz10LnNwbGl0KCIvIikucmV2ZXJzZSgpO28ubGVuZ3RoOyl7dmFyIGk9by5wb3AoKTtpZihpKXt2YXIgYT1nZS5qb2luMihlLGkpO3RyeXtUZS5ta2RpcihhKX1jYXRjaChlKXt9ZT1hfX1yZXR1cm4gYX0sY3JlYXRlRmlsZTpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCksYT1UZS5nZXRNb2RlKG4sbyk7cmV0dXJuIFRlLmNyZWF0ZShpLGEpfSxjcmVhdGVEYXRhRmlsZTpmdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGE9dD9nZS5qb2luMigic3RyaW5nIj09dHlwZW9mIGU/ZTpUZS5nZXRQYXRoKGUpLHQpOmUscz1UZS5nZXRNb2RlKG4sbyksdT1UZS5jcmVhdGUoYSxzKTtpZihyKXtpZigic3RyaW5nIj09dHlwZW9mIHIpe2Zvcih2YXIgYz1uZXcgQXJyYXkoci5sZW5ndGgpLGw9MCxmPXIubGVuZ3RoO2w8ZjsrK2wpY1tsXT1yLmNoYXJDb2RlQXQobCk7cj1jfVRlLmNobW9kKHUsMTQ2fHMpO3ZhciBkPVRlLm9wZW4odSwidyIpO1RlLndyaXRlKGQsciwwLHIubGVuZ3RoLDAsaSksVGUuY2xvc2UoZCksVGUuY2htb2QodSxzKX1yZXR1cm4gdX0sY3JlYXRlRGV2aWNlOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCksaT1UZS5nZXRNb2RlKCEhciwhIW4pO1RlLmNyZWF0ZURldmljZS5tYWpvcnx8KFRlLmNyZWF0ZURldmljZS5tYWpvcj02NCk7dmFyIGE9VGUubWFrZWRldihUZS5jcmVhdGVEZXZpY2UubWFqb3IrKywwKTtyZXR1cm4gVGUucmVnaXN0ZXJEZXZpY2UoYSx7b3BlbjpmdW5jdGlvbihlKXtlLnNlZWthYmxlPSExfSxjbG9zZTpmdW5jdGlvbihlKXtuJiZuLmJ1ZmZlciYmbi5idWZmZXIubGVuZ3RoJiZuKDEwKX0scmVhZDpmdW5jdGlvbihlLHQsbixvLGkpe2Zvcih2YXIgYT0wLHM9MDtzPG87cysrKXt2YXIgdTt0cnl7dT1yKCl9Y2F0Y2goZSl7dGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlPKX1pZih2b2lkIDA9PT11JiYwPT09YSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQUdBSU4pO2lmKG51bGw9PXUpYnJlYWs7YSsrLHRbbitzXT11fXJldHVybiBhJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxhfSx3cml0ZTpmdW5jdGlvbihlLHQscixvLGkpe2Zvcih2YXIgYT0wO2E8bzthKyspdHJ5e24odFtyK2FdKX1jYXRjaChlKXt0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU8pfXJldHVybiBvJiYoZS5ub2RlLnRpbWVzdGFtcD1EYXRlLm5vdygpKSxhfX0pLFRlLm1rZGV2KG8saSxhKX0sY3JlYXRlTGluazpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWdlLmpvaW4yKCJzdHJpbmciPT10eXBlb2YgZT9lOlRlLmdldFBhdGgoZSksdCk7cmV0dXJuIFRlLnN5bWxpbmsocixpKX0sZm9yY2VMb2FkRmlsZTpmdW5jdGlvbihlKXtpZihlLmlzRGV2aWNlfHxlLmlzRm9sZGVyfHxlLmxpbmt8fGUuY29udGVudHMpcmV0dXJuITA7dmFyIHQ9ITA7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBYTUxIdHRwUmVxdWVzdCl0aHJvdyBuZXcgRXJyb3IoIkxhenkgbG9hZGluZyBzaG91bGQgaGF2ZSBiZWVuIHBlcmZvcm1lZCAoY29udGVudHMgc2V0KSBpbiBjcmVhdGVMYXp5RmlsZSwgYnV0IGl0IHdhcyBub3QuIExhenkgbG9hZGluZyBvbmx5IHdvcmtzIGluIHdlYiB3b3JrZXJzLiBVc2UgLS1lbWJlZC1maWxlIG9yIC0tcHJlbG9hZC1maWxlIGluIGVtY2Mgb24gdGhlIG1haW4gdGhyZWFkLiIpO2lmKCFvLnJlYWQpdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgbG9hZCB3aXRob3V0IHJlYWQoKSBvciBYTUxIdHRwUmVxdWVzdC4iKTt0cnl7ZS5jb250ZW50cz0kdChvLnJlYWQoZS51cmwpLCEwKSxlLnVzZWRCeXRlcz1lLmNvbnRlbnRzLmxlbmd0aH1jYXRjaChlKXt0PSExfXJldHVybiB0fHx5ZShtZS5FSU8pLHR9LGNyZWF0ZUxhenlGaWxlOmZ1bmN0aW9uKGUsdCxyLG4sbyl7ZnVuY3Rpb24gaSgpe3RoaXMubGVuZ3RoS25vd249ITEsdGhpcy5jaHVua3M9W119aWYoaS5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGUpe2lmKCEoZT50aGlzLmxlbmd0aC0xfHxlPDApKXt2YXIgdD1lJXRoaXMuY2h1bmtTaXplLHI9ZS90aGlzLmNodW5rU2l6ZXwwO3JldHVybiB0aGlzLmdldHRlcihyKVt0XX19LGkucHJvdG90eXBlLnNldERhdGFHZXR0ZXI9ZnVuY3Rpb24oZSl7dGhpcy5nZXR0ZXI9ZX0saS5wcm90b3R5cGUuY2FjaGVMZW5ndGg9ZnVuY3Rpb24oKXt2YXIgZT1uZXcgWE1MSHR0cFJlcXVlc3Q7aWYoZS5vcGVuKCJIRUFEIixyLCExKSxlLnNlbmQobnVsbCksIShlLnN0YXR1cz49MjAwJiZlLnN0YXR1czwzMDB8fDMwND09PWUuc3RhdHVzKSl0aHJvdyBuZXcgRXJyb3IoIkNvdWxkbid0IGxvYWQgIityKyIuIFN0YXR1czogIitlLnN0YXR1cyk7dmFyIHQsbj1OdW1iZXIoZS5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1sZW5ndGgiKSksbz0odD1lLmdldFJlc3BvbnNlSGVhZGVyKCJBY2NlcHQtUmFuZ2VzIikpJiYiYnl0ZXMiPT09dCxpPSh0PWUuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtRW5jb2RpbmciKSkmJiJnemlwIj09PXQsYT0xMDQ4NTc2O298fChhPW4pO3ZhciBzPXRoaXM7cy5zZXREYXRhR2V0dGVyKChmdW5jdGlvbihlKXt2YXIgdD1lKmEsbz0oZSsxKSphLTE7aWYobz1NYXRoLm1pbihvLG4tMSksdm9pZCAwPT09cy5jaHVua3NbZV0mJihzLmNodW5rc1tlXT1mdW5jdGlvbihlLHQpe2lmKGU+dCl0aHJvdyBuZXcgRXJyb3IoImludmFsaWQgcmFuZ2UgKCIrZSsiLCAiK3QrIikgb3Igbm8gYnl0ZXMgcmVxdWVzdGVkISIpO2lmKHQ+bi0xKXRocm93IG5ldyBFcnJvcigib25seSAiK24rIiBieXRlcyBhdmFpbGFibGUhIHByb2dyYW1tZXIgZXJyb3IhIik7dmFyIG89bmV3IFhNTEh0dHBSZXF1ZXN0O2lmKG8ub3BlbigiR0VUIixyLCExKSxuIT09YSYmby5zZXRSZXF1ZXN0SGVhZGVyKCJSYW5nZSIsImJ5dGVzPSIrZSsiLSIrdCksInVuZGVmaW5lZCIhPXR5cGVvZiBVaW50OEFycmF5JiYoby5yZXNwb25zZVR5cGU9ImFycmF5YnVmZmVyIiksby5vdmVycmlkZU1pbWVUeXBlJiZvLm92ZXJyaWRlTWltZVR5cGUoInRleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWQiKSxvLnNlbmQobnVsbCksIShvLnN0YXR1cz49MjAwJiZvLnN0YXR1czwzMDB8fDMwND09PW8uc3RhdHVzKSl0aHJvdyBuZXcgRXJyb3IoIkNvdWxkbid0IGxvYWQgIityKyIuIFN0YXR1czogIitvLnN0YXR1cyk7cmV0dXJuIHZvaWQgMCE9PW8ucmVzcG9uc2U/bmV3IFVpbnQ4QXJyYXkoby5yZXNwb25zZXx8W10pOiR0KG8ucmVzcG9uc2VUZXh0fHwiIiwhMCl9KHQsbykpLHZvaWQgMD09PXMuY2h1bmtzW2VdKXRocm93IG5ldyBFcnJvcigiZG9YSFIgZmFpbGVkISIpO3JldHVybiBzLmNodW5rc1tlXX0pKSwhaSYmbnx8KGE9bj0xLG49dGhpcy5nZXR0ZXIoMCkubGVuZ3RoLGE9bixjb25zb2xlLmxvZygiTGF6eUZpbGVzIG9uIGd6aXAgZm9yY2VzIGRvd25sb2FkIG9mIHRoZSB3aG9sZSBmaWxlIHdoZW4gbGVuZ3RoIGlzIGFjY2Vzc2VkIikpLHRoaXMuX2xlbmd0aD1uLHRoaXMuX2NodW5rU2l6ZT1hLHRoaXMubGVuZ3RoS25vd249ITB9LCJ1bmRlZmluZWQiIT10eXBlb2YgWE1MSHR0cFJlcXVlc3Qpe2lmKCFjKXRocm93IkNhbm5vdCBkbyBzeW5jaHJvbm91cyBiaW5hcnkgWEhScyBvdXRzaWRlIHdlYndvcmtlcnMgaW4gbW9kZXJuIGJyb3dzZXJzLiBVc2UgLS1lbWJlZC1maWxlIG9yIC0tcHJlbG9hZC1maWxlIGluIGVtY2MiO3ZhciBhPW5ldyBpO09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGEse2xlbmd0aDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RoS25vd258fHRoaXMuY2FjaGVMZW5ndGgoKSx0aGlzLl9sZW5ndGh9fSxjaHVua1NpemU6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aEtub3dufHx0aGlzLmNhY2hlTGVuZ3RoKCksdGhpcy5fY2h1bmtTaXplfX19KTt2YXIgcz17aXNEZXZpY2U6ITEsY29udGVudHM6YX19ZWxzZSBzPXtpc0RldmljZTohMSx1cmw6cn07dmFyIHU9VGUuY3JlYXRlRmlsZShlLHQscyxuLG8pO3MuY29udGVudHM/dS5jb250ZW50cz1zLmNvbnRlbnRzOnMudXJsJiYodS5jb250ZW50cz1udWxsLHUudXJsPXMudXJsKSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyh1LHt1c2VkQnl0ZXM6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRlbnRzLmxlbmd0aH19fSk7dmFyIGw9e307cmV0dXJuIE9iamVjdC5rZXlzKHUuc3RyZWFtX29wcykuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9dS5zdHJlYW1fb3BzW2VdO2xbZV09ZnVuY3Rpb24oKXtpZighVGUuZm9yY2VMb2FkRmlsZSh1KSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FSU8pO3JldHVybiB0LmFwcGx5KG51bGwsYXJndW1lbnRzKX19KSksbC5yZWFkPWZ1bmN0aW9uKGUsdCxyLG4sbyl7aWYoIVRlLmZvcmNlTG9hZEZpbGUodSkpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUlPKTt2YXIgaT1lLm5vZGUuY29udGVudHM7aWYobz49aS5sZW5ndGgpcmV0dXJuIDA7dmFyIGE9TWF0aC5taW4oaS5sZW5ndGgtbyxuKTtpZih5KGE+PTApLGkuc2xpY2UpZm9yKHZhciBzPTA7czxhO3MrKyl0W3Irc109aVtvK3NdO2Vsc2UgZm9yKHM9MDtzPGE7cysrKXRbcitzXT1pLmdldChvK3MpO3JldHVybiBhfSx1LnN0cmVhbV9vcHM9bCx1fSxjcmVhdGVQcmVsb2FkZWRGaWxlOmZ1bmN0aW9uKGUsdCxyLG4saSxhLHMsdSxjLGwpe0Jyb3dzZXIuaW5pdCgpO3ZhciBmPXQ/Z2UucmVzb2x2ZShnZS5qb2luMihlLHQpKTplO2Z1bmN0aW9uIGQocil7ZnVuY3Rpb24gZChyKXtsJiZsKCksdXx8VGUuY3JlYXRlRGF0YUZpbGUoZSx0LHIsbixpLGMpLGEmJmEoKSxsZSgpfXZhciBoPSExO28ucHJlbG9hZFBsdWdpbnMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aHx8ZS5jYW5IYW5kbGUoZikmJihlLmhhbmRsZShyLGYsZCwoZnVuY3Rpb24oKXtzJiZzKCksbGUoKX0pKSxoPSEwKX0pKSxofHxkKHIpfWNlKCksInN0cmluZyI9PXR5cGVvZiByP0Jyb3dzZXIuYXN5bmNMb2FkKHIsKGZ1bmN0aW9uKGUpe2QoZSl9KSxzKTpkKHIpfSxpbmRleGVkREI6ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LmluZGV4ZWREQnx8d2luZG93Lm1vekluZGV4ZWREQnx8d2luZG93LndlYmtpdEluZGV4ZWREQnx8d2luZG93Lm1zSW5kZXhlZERCfSxEQl9OQU1FOmZ1bmN0aW9uKCl7cmV0dXJuIkVNX0ZTXyIrd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lfSxEQl9WRVJTSU9OOjIwLERCX1NUT1JFX05BTUU6IkZJTEVfREFUQSIsc2F2ZUZpbGVzVG9EQjpmdW5jdGlvbihlLHQscil7dD10fHxmdW5jdGlvbigpe30scj1yfHxmdW5jdGlvbigpe307dmFyIG49VGUuaW5kZXhlZERCKCk7dHJ5e3ZhciBvPW4ub3BlbihUZS5EQl9OQU1FKCksVGUuREJfVkVSU0lPTil9Y2F0Y2goZSl7cmV0dXJuIHIoZSl9by5vbnVwZ3JhZGVuZWVkZWQ9ZnVuY3Rpb24oKXtjb25zb2xlLmxvZygiY3JlYXRpbmcgZGIiKSxvLnJlc3VsdC5jcmVhdGVPYmplY3RTdG9yZShUZS5EQl9TVE9SRV9OQU1FKX0sby5vbnN1Y2Nlc3M9ZnVuY3Rpb24oKXt2YXIgbj1vLnJlc3VsdC50cmFuc2FjdGlvbihbVGUuREJfU1RPUkVfTkFNRV0sInJlYWR3cml0ZSIpLGk9bi5vYmplY3RTdG9yZShUZS5EQl9TVE9SRV9OQU1FKSxhPTAscz0wLHU9ZS5sZW5ndGg7ZnVuY3Rpb24gYygpezA9PXM/dCgpOnIoKX1lLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWkucHV0KFRlLmFuYWx5emVQYXRoKGUpLm9iamVjdC5jb250ZW50cyxlKTt0Lm9uc3VjY2Vzcz1mdW5jdGlvbigpeysrYStzPT11JiZjKCl9LHQub25lcnJvcj1mdW5jdGlvbigpe3MrKyxhK3M9PXUmJmMoKX19KSksbi5vbmVycm9yPXJ9LG8ub25lcnJvcj1yfSxsb2FkRmlsZXNGcm9tREI6ZnVuY3Rpb24oZSx0LHIpe3Q9dHx8ZnVuY3Rpb24oKXt9LHI9cnx8ZnVuY3Rpb24oKXt9O3ZhciBuPVRlLmluZGV4ZWREQigpO3RyeXt2YXIgbz1uLm9wZW4oVGUuREJfTkFNRSgpLFRlLkRCX1ZFUlNJT04pfWNhdGNoKGUpe3JldHVybiByKGUpfW8ub251cGdyYWRlbmVlZGVkPXIsby5vbnN1Y2Nlc3M9ZnVuY3Rpb24oKXt2YXIgbj1vLnJlc3VsdDt0cnl7dmFyIGk9bi50cmFuc2FjdGlvbihbVGUuREJfU1RPUkVfTkFNRV0sInJlYWRvbmx5Iil9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgcihlKX12YXIgYT1pLm9iamVjdFN0b3JlKFRlLkRCX1NUT1JFX05BTUUpLHM9MCx1PTAsYz1lLmxlbmd0aDtmdW5jdGlvbiBsKCl7MD09dT90KCk6cigpfWUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9YS5nZXQoZSk7dC5vbnN1Y2Nlc3M9ZnVuY3Rpb24oKXtUZS5hbmFseXplUGF0aChlKS5leGlzdHMmJlRlLnVubGluayhlKSxUZS5jcmVhdGVEYXRhRmlsZShnZS5kaXJuYW1lKGUpLGdlLmJhc2VuYW1lKGUpLHQucmVzdWx0LCEwLCEwLCEwKSwrK3MrdT09YyYmbCgpfSx0Lm9uZXJyb3I9ZnVuY3Rpb24oKXt1Kysscyt1PT1jJiZsKCl9fSkpLGkub25lcnJvcj1yfSxvLm9uZXJyb3I9cn19LFNlPXtERUZBVUxUX1BPTExNQVNLOjUsbWFwcGluZ3M6e30sdW1hc2s6NTExLGNhbGN1bGF0ZUF0OmZ1bmN0aW9uKGUsdCl7aWYoIi8iIT09dFswXSl7dmFyIHI7aWYoLTEwMD09PWUpcj1UZS5jd2QoKTtlbHNle3ZhciBuPVRlLmdldFN0cmVhbShlKTtpZighbil0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7cj1uLnBhdGh9dD1nZS5qb2luMihyLHQpfXJldHVybiB0fSxkb1N0YXQ6ZnVuY3Rpb24oZSx0LHIpe3RyeXt2YXIgbj1lKHQpfWNhdGNoKGUpe2lmKGUmJmUubm9kZSYmZ2Uubm9ybWFsaXplKHQpIT09Z2Uubm9ybWFsaXplKFRlLmdldFBhdGgoZS5ub2RlKSkpcmV0dXJuLW1lLkVOT1RESVI7dGhyb3cgZX1yZXR1cm4gRltyPj4yXT1uLmRldixGW3IrND4+Ml09MCxGW3IrOD4+Ml09bi5pbm8sRltyKzEyPj4yXT1uLm1vZGUsRltyKzE2Pj4yXT1uLm5saW5rLEZbcisyMD4+Ml09bi51aWQsRltyKzI0Pj4yXT1uLmdpZCxGW3IrMjg+PjJdPW4ucmRldixGW3IrMzI+PjJdPTAsRltyKzM2Pj4yXT1uLnNpemUsRltyKzQwPj4yXT00MDk2LEZbcis0ND4+Ml09bi5ibG9ja3MsRltyKzQ4Pj4yXT1uLmF0aW1lLmdldFRpbWUoKS8xZTN8MCxGW3IrNTI+PjJdPTAsRltyKzU2Pj4yXT1uLm10aW1lLmdldFRpbWUoKS8xZTN8MCxGW3IrNjA+PjJdPTAsRltyKzY0Pj4yXT1uLmN0aW1lLmdldFRpbWUoKS8xZTN8MCxGW3IrNjg+PjJdPTAsRltyKzcyPj4yXT1uLmlubywwfSxkb01zeW5jOmZ1bmN0aW9uKGUsdCxyLG4pe3ZhciBvPW5ldyBVaW50OEFycmF5KE8uc3ViYXJyYXkoZSxlK3IpKTtUZS5tc3luYyh0LG8sMCxyLG4pfSxkb01rZGlyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIi8iPT09KGU9Z2Uubm9ybWFsaXplKGUpKVtlLmxlbmd0aC0xXSYmKGU9ZS5zdWJzdHIoMCxlLmxlbmd0aC0xKSksVGUubWtkaXIoZSx0LDApLDB9LGRvTWtub2Q6ZnVuY3Rpb24oZSx0LHIpe3N3aXRjaCg2MTQ0MCZ0KXtjYXNlIDMyNzY4OmNhc2UgODE5MjpjYXNlIDI0NTc2OmNhc2UgNDA5NjpjYXNlIDQ5MTUyOmJyZWFrO2RlZmF1bHQ6cmV0dXJuLW1lLkVJTlZBTH1yZXR1cm4gVGUubWtub2QoZSx0LHIpLDB9LGRvUmVhZGxpbms6ZnVuY3Rpb24oZSx0LHIpe2lmKHI8PTApcmV0dXJuLW1lLkVJTlZBTDt2YXIgbj1UZS5yZWFkbGluayhlKSxvPU1hdGgubWluKHIsUyhuKSksaT1SW3Qrb107cmV0dXJuIFQobix0LHIrMSksUlt0K29dPWksb30sZG9BY2Nlc3M6ZnVuY3Rpb24oZSx0KXtpZigtOCZ0KXJldHVybi1tZS5FSU5WQUw7dmFyIHI7cj1UZS5sb29rdXBQYXRoKGUse2ZvbGxvdzohMH0pLm5vZGU7dmFyIG49IiI7cmV0dXJuIDQmdCYmKG4rPSJyIiksMiZ0JiYobis9InciKSwxJnQmJihuKz0ieCIpLG4mJlRlLm5vZGVQZXJtaXNzaW9ucyhyLG4pPy1tZS5FQUNDRVM6MH0sZG9EdXA6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuPVRlLmdldFN0cmVhbShyKTtyZXR1cm4gbiYmVGUuY2xvc2UobiksVGUub3BlbihlLHQsMCxyLHIpLmZkfSxkb1JlYWR2OmZ1bmN0aW9uKGUsdCxyLG4pe2Zvcih2YXIgbz0wLGk9MDtpPHI7aSsrKXt2YXIgYT1GW3QrOCppPj4yXSxzPUZbdCsoOCppKzQpPj4yXSx1PVRlLnJlYWQoZSxSLGEscyxuKTtpZih1PDApcmV0dXJuLTE7aWYobys9dSx1PHMpYnJlYWt9cmV0dXJuIG99LGRvV3JpdGV2OmZ1bmN0aW9uKGUsdCxyLG4pe2Zvcih2YXIgbz0wLGk9MDtpPHI7aSsrKXt2YXIgYT1GW3QrOCppPj4yXSxzPUZbdCsoOCppKzQpPj4yXSx1PVRlLndyaXRlKGUsUixhLHMsbik7aWYodTwwKXJldHVybi0xO28rPXV9cmV0dXJuIG99LHZhcmFyZ3M6MCxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFNlLnZhcmFyZ3MrPTQsRltTZS52YXJhcmdzLTQ+PjJdfSxnZXRTdHI6ZnVuY3Rpb24oKXtyZXR1cm4gdihTZS5nZXQoKSl9LGdldFN0cmVhbUZyb21GRDpmdW5jdGlvbigpe3ZhciBlPVRlLmdldFN0cmVhbShTZS5nZXQoKSk7aWYoIWUpdGhyb3cgbmV3IFRlLkVycm5vRXJyb3IobWUuRUJBREYpO3JldHVybiBlfSxnZXRTb2NrZXRGcm9tRkQ6ZnVuY3Rpb24oKXt2YXIgZT1TT0NLRlMuZ2V0U29ja2V0KFNlLmdldCgpKTtpZighZSl0aHJvdyBuZXcgVGUuRXJybm9FcnJvcihtZS5FQkFERik7cmV0dXJuIGV9LGdldFNvY2tldEFkZHJlc3M6ZnVuY3Rpb24oZSl7dmFyIHQ9U2UuZ2V0KCkscj1TZS5nZXQoKTtpZihlJiYwPT09dClyZXR1cm4gbnVsbDt2YXIgbj1fX3JlYWRfc29ja2FkZHIodCxyKTtpZihuLmVycm5vKXRocm93IG5ldyBUZS5FcnJub0Vycm9yKG4uZXJybm8pO3JldHVybiBuLmFkZHI9RE5TLmxvb2t1cF9hZGRyKG4uYWRkcil8fG4uYWRkcixufSxnZXQ2NDpmdW5jdGlvbigpe3ZhciBlPVNlLmdldCgpLHQ9U2UuZ2V0KCk7cmV0dXJuIHkoZT49MD8wPT09dDotMT09PXQpLGV9LGdldFplcm86ZnVuY3Rpb24oKXt5KDA9PT1TZS5nZXQoKSl9fTt2YXIga2U9NDI7dmFyIFBlPXt9O2Z1bmN0aW9uIERlKGUpe2Zvcig7ZS5sZW5ndGg7KXt2YXIgdD1lLnBvcCgpO2UucG9wKCkodCl9fWZ1bmN0aW9uIFJlKGUpe3JldHVybiB0aGlzLmZyb21XaXJlVHlwZShNW2U+PjJdKX12YXIgT2U9e30sQ2U9e30sTmU9e307ZnVuY3Rpb24gRmUoZSl7aWYodm9pZCAwPT09ZSlyZXR1cm4iX3Vua25vd24iO3ZhciB0PShlPWUucmVwbGFjZSgvW15hLXpBLVowLTlfXS9nLCIkIikpLmNoYXJDb2RlQXQoMCk7cmV0dXJuIHQ+PTQ4JiZ0PD01Nz8iXyIrZTplfWZ1bmN0aW9uIE1lKGUsdCl7cmV0dXJuIGU9RmUoZSksbmV3IEZ1bmN0aW9uKCJib2R5IiwicmV0dXJuIGZ1bmN0aW9uICIrZSsnKCkge1xuICAgICJ1c2Ugc3RyaWN0IjsgICAgcmV0dXJuIGJvZHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG4nKSh0KX1mdW5jdGlvbiBJZShlLHQpe3ZhciByPU1lKHQsKGZ1bmN0aW9uKGUpe3RoaXMubmFtZT10LHRoaXMubWVzc2FnZT1lO3ZhciByPW5ldyBFcnJvcihlKS5zdGFjazt2b2lkIDAhPT1yJiYodGhpcy5zdGFjaz10aGlzLnRvU3RyaW5nKCkrIlxuIityLnJlcGxhY2UoL15FcnJvcig6W15cbl0qKT9cbi8sIiIpKX0pKTtyZXR1cm4gci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlLnByb3RvdHlwZSksci5wcm90b3R5cGUuY29uc3RydWN0b3I9cixyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT10aGlzLm1lc3NhZ2U/dGhpcy5uYW1lOnRoaXMubmFtZSsiOiAiK3RoaXMubWVzc2FnZX0scn12YXIgQmU9dm9pZCAwO2Z1bmN0aW9uIExlKGUpe3Rocm93IG5ldyBCZShlKX1mdW5jdGlvbiB4ZShlLHQscil7ZnVuY3Rpb24gbih0KXt2YXIgbj1yKHQpO24ubGVuZ3RoIT09ZS5sZW5ndGgmJkxlKCJNaXNtYXRjaGVkIHR5cGUgY29udmVydGVyIGNvdW50Iik7Zm9yKHZhciBvPTA7bzxlLmxlbmd0aDsrK28pWWUoZVtvXSxuW29dKX1lLmZvckVhY2goKGZ1bmN0aW9uKGUpe05lW2VdPXR9KSk7dmFyIG89bmV3IEFycmF5KHQubGVuZ3RoKSxpPVtdLGE9MDt0LmZvckVhY2goKGZ1bmN0aW9uKGUsdCl7Q2UuaGFzT3duUHJvcGVydHkoZSk/b1t0XT1DZVtlXTooaS5wdXNoKGUpLE9lLmhhc093blByb3BlcnR5KGUpfHwoT2VbZV09W10pLE9lW2VdLnB1c2goKGZ1bmN0aW9uKCl7b1t0XT1DZVtlXSwrK2E9PT1pLmxlbmd0aCYmbihvKX0pKSl9KSksMD09PWkubGVuZ3RoJiZuKG8pfWZ1bmN0aW9uIGplKGUpe3N3aXRjaChlKXtjYXNlIDE6cmV0dXJuIDA7Y2FzZSAyOnJldHVybiAxO2Nhc2UgNDpyZXR1cm4gMjtjYXNlIDg6cmV0dXJuIDM7ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKCJVbmtub3duIHR5cGUgc2l6ZTogIitlKX19dmFyIFVlPXZvaWQgMDtmdW5jdGlvbiB6ZShlKXtmb3IodmFyIHQ9IiIscj1lO09bcl07KXQrPVVlW09bcisrXV07cmV0dXJuIHR9dmFyICRlPXZvaWQgMDtmdW5jdGlvbiBXZShlKXt0aHJvdyBuZXcgJGUoZSl9ZnVuY3Rpb24gWWUoZSx0LHIpe2lmKHI9cnx8e30sISgiYXJnUGFja0FkdmFuY2UiaW4gdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigicmVnaXN0ZXJUeXBlIHJlZ2lzdGVyZWRJbnN0YW5jZSByZXF1aXJlcyBhcmdQYWNrQWR2YW5jZSIpO3ZhciBuPXQubmFtZTtpZihlfHxXZSgndHlwZSAiJytuKyciIG11c3QgaGF2ZSBhIHBvc2l0aXZlIGludGVnZXIgdHlwZWlkIHBvaW50ZXInKSxDZS5oYXNPd25Qcm9wZXJ0eShlKSl7aWYoci5pZ25vcmVEdXBsaWNhdGVSZWdpc3RyYXRpb25zKXJldHVybjtXZSgiQ2Fubm90IHJlZ2lzdGVyIHR5cGUgJyIrbisiJyB0d2ljZSIpfWlmKENlW2VdPXQsZGVsZXRlIE5lW2VdLE9lLmhhc093blByb3BlcnR5KGUpKXt2YXIgbz1PZVtlXTtkZWxldGUgT2VbZV0sby5mb3JFYWNoKChmdW5jdGlvbihlKXtlKCl9KSl9fWZ1bmN0aW9uIFZlKGUpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGV0KSlyZXR1cm4hMTtpZighKGUgaW5zdGFuY2VvZiBldCkpcmV0dXJuITE7Zm9yKHZhciB0PXRoaXMuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3Mscj10aGlzLiQkLnB0cixuPWUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3Msbz1lLiQkLnB0cjt0LmJhc2VDbGFzczspcj10LnVwY2FzdChyKSx0PXQuYmFzZUNsYXNzO2Zvcig7bi5iYXNlQ2xhc3M7KW89bi51cGNhc3Qobyksbj1uLmJhc2VDbGFzcztyZXR1cm4gdD09PW4mJnI9PT1vfWZ1bmN0aW9uIEhlKGUpe1dlKGUuJCQucHRyVHlwZS5yZWdpc3RlcmVkQ2xhc3MubmFtZSsiIGluc3RhbmNlIGFscmVhZHkgZGVsZXRlZCIpfWZ1bmN0aW9uIEdlKCl7aWYodGhpcy4kJC5wdHJ8fEhlKHRoaXMpLHRoaXMuJCQucHJlc2VydmVQb2ludGVyT25EZWxldGUpcmV0dXJuIHRoaXMuJCQuY291bnQudmFsdWUrPTEsdGhpczt2YXIgZSx0PU9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLHskJDp7dmFsdWU6KGU9dGhpcy4kJCx7Y291bnQ6ZS5jb3VudCxkZWxldGVTY2hlZHVsZWQ6ZS5kZWxldGVTY2hlZHVsZWQscHJlc2VydmVQb2ludGVyT25EZWxldGU6ZS5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSxwdHI6ZS5wdHIscHRyVHlwZTplLnB0clR5cGUsc21hcnRQdHI6ZS5zbWFydFB0cixzbWFydFB0clR5cGU6ZS5zbWFydFB0clR5cGV9KX19KTtyZXR1cm4gdC4kJC5jb3VudC52YWx1ZSs9MSx0LiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSx0fWZ1bmN0aW9uIHFlKCl7dmFyIGU7dGhpcy4kJC5wdHJ8fEhlKHRoaXMpLHRoaXMuJCQuZGVsZXRlU2NoZWR1bGVkJiYhdGhpcy4kJC5wcmVzZXJ2ZVBvaW50ZXJPbkRlbGV0ZSYmV2UoIk9iamVjdCBhbHJlYWR5IHNjaGVkdWxlZCBmb3IgZGVsZXRpb24iKSx0aGlzLiQkLmNvdW50LnZhbHVlLT0xLDA9PT10aGlzLiQkLmNvdW50LnZhbHVlJiYoKGU9dGhpcy4kJCkuc21hcnRQdHI/ZS5zbWFydFB0clR5cGUucmF3RGVzdHJ1Y3RvcihlLnNtYXJ0UHRyKTplLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzLnJhd0Rlc3RydWN0b3IoZS5wdHIpKSx0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlfHwodGhpcy4kJC5zbWFydFB0cj12b2lkIDAsdGhpcy4kJC5wdHI9dm9pZCAwKX1mdW5jdGlvbiBYZSgpe3JldHVybiF0aGlzLiQkLnB0cn12YXIgS2U9dm9pZCAwLEplPVtdO2Z1bmN0aW9uIFplKCl7Zm9yKDtKZS5sZW5ndGg7KXt2YXIgZT1KZS5wb3AoKTtlLiQkLmRlbGV0ZVNjaGVkdWxlZD0hMSxlLmRlbGV0ZSgpfX1mdW5jdGlvbiBRZSgpe3JldHVybiB0aGlzLiQkLnB0cnx8SGUodGhpcyksdGhpcy4kJC5kZWxldGVTY2hlZHVsZWQmJiF0aGlzLiQkLnByZXNlcnZlUG9pbnRlck9uRGVsZXRlJiZXZSgiT2JqZWN0IGFscmVhZHkgc2NoZWR1bGVkIGZvciBkZWxldGlvbiIpLEplLnB1c2godGhpcyksMT09PUplLmxlbmd0aCYmS2UmJktlKFplKSx0aGlzLiQkLmRlbGV0ZVNjaGVkdWxlZD0hMCx0aGlzfWZ1bmN0aW9uIGV0KCl7fXZhciB0dD17fTtmdW5jdGlvbiBydChlLHQscil7aWYodm9pZCAwPT09ZVt0XS5vdmVybG9hZFRhYmxlKXt2YXIgbj1lW3RdO2VbdF09ZnVuY3Rpb24oKXtyZXR1cm4gZVt0XS5vdmVybG9hZFRhYmxlLmhhc093blByb3BlcnR5KGFyZ3VtZW50cy5sZW5ndGgpfHxXZSgiRnVuY3Rpb24gJyIrcisiJyBjYWxsZWQgd2l0aCBhbiBpbnZhbGlkIG51bWJlciBvZiBhcmd1bWVudHMgKCIrYXJndW1lbnRzLmxlbmd0aCsiKSAtIGV4cGVjdHMgb25lIG9mICgiK2VbdF0ub3ZlcmxvYWRUYWJsZSsiKSEiKSxlW3RdLm92ZXJsb2FkVGFibGVbYXJndW1lbnRzLmxlbmd0aF0uYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlW3RdLm92ZXJsb2FkVGFibGU9W10sZVt0XS5vdmVybG9hZFRhYmxlW24uYXJnQ291bnRdPW59fWZ1bmN0aW9uIG50KGUsdCxyLG4sbyxpLGEscyl7dGhpcy5uYW1lPWUsdGhpcy5jb25zdHJ1Y3Rvcj10LHRoaXMuaW5zdGFuY2VQcm90b3R5cGU9cix0aGlzLnJhd0Rlc3RydWN0b3I9bix0aGlzLmJhc2VDbGFzcz1vLHRoaXMuZ2V0QWN0dWFsVHlwZT1pLHRoaXMudXBjYXN0PWEsdGhpcy5kb3duY2FzdD1zLHRoaXMucHVyZVZpcnR1YWxGdW5jdGlvbnM9W119ZnVuY3Rpb24gb3QoZSx0LHIpe2Zvcig7dCE9PXI7KXQudXBjYXN0fHxXZSgiRXhwZWN0ZWQgbnVsbCBvciBpbnN0YW5jZSBvZiAiK3IubmFtZSsiLCBnb3QgYW4gaW5zdGFuY2Ugb2YgIit0Lm5hbWUpLGU9dC51cGNhc3QoZSksdD10LmJhc2VDbGFzcztyZXR1cm4gZX1mdW5jdGlvbiBpdChlLHQpe2lmKG51bGw9PT10KXJldHVybiB0aGlzLmlzUmVmZXJlbmNlJiZXZSgibnVsbCBpcyBub3QgYSB2YWxpZCAiK3RoaXMubmFtZSksMDt0LiQkfHxXZSgnQ2Fubm90IHBhc3MgIicrT3QodCkrJyIgYXMgYSAnK3RoaXMubmFtZSksdC4kJC5wdHJ8fFdlKCJDYW5ub3QgcGFzcyBkZWxldGVkIG9iamVjdCBhcyBhIHBvaW50ZXIgb2YgdHlwZSAiK3RoaXMubmFtZSk7dmFyIHI9dC4kJC5wdHJUeXBlLnJlZ2lzdGVyZWRDbGFzcztyZXR1cm4gb3QodC4kJC5wdHIscix0aGlzLnJlZ2lzdGVyZWRDbGFzcyl9ZnVuY3Rpb24gYXQoZSx0KXt2YXIgcjtpZihudWxsPT09dClyZXR1cm4gdGhpcy5pc1JlZmVyZW5jZSYmV2UoIm51bGwgaXMgbm90IGEgdmFsaWQgIit0aGlzLm5hbWUpLHRoaXMuaXNTbWFydFBvaW50ZXI/KHI9dGhpcy5yYXdDb25zdHJ1Y3RvcigpLG51bGwhPT1lJiZlLnB1c2godGhpcy5yYXdEZXN0cnVjdG9yLHIpLHIpOjA7dC4kJHx8V2UoJ0Nhbm5vdCBwYXNzICInK090KHQpKyciIGFzIGEgJyt0aGlzLm5hbWUpLHQuJCQucHRyfHxXZSgiQ2Fubm90IHBhc3MgZGVsZXRlZCBvYmplY3QgYXMgYSBwb2ludGVyIG9mIHR5cGUgIit0aGlzLm5hbWUpLCF0aGlzLmlzQ29uc3QmJnQuJCQucHRyVHlwZS5pc0NvbnN0JiZXZSgiQ2Fubm90IGNvbnZlcnQgYXJndW1lbnQgb2YgdHlwZSAiKyh0LiQkLnNtYXJ0UHRyVHlwZT90LiQkLnNtYXJ0UHRyVHlwZS5uYW1lOnQuJCQucHRyVHlwZS5uYW1lKSsiIHRvIHBhcmFtZXRlciB0eXBlICIrdGhpcy5uYW1lKTt2YXIgbj10LiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzO2lmKHI9b3QodC4kJC5wdHIsbix0aGlzLnJlZ2lzdGVyZWRDbGFzcyksdGhpcy5pc1NtYXJ0UG9pbnRlcilzd2l0Y2godm9pZCAwPT09dC4kJC5zbWFydFB0ciYmV2UoIlBhc3NpbmcgcmF3IHBvaW50ZXIgdG8gc21hcnQgcG9pbnRlciBpcyBpbGxlZ2FsIiksdGhpcy5zaGFyaW5nUG9saWN5KXtjYXNlIDA6dC4kJC5zbWFydFB0clR5cGU9PT10aGlzP3I9dC4kJC5zbWFydFB0cjpXZSgiQ2Fubm90IGNvbnZlcnQgYXJndW1lbnQgb2YgdHlwZSAiKyh0LiQkLnNtYXJ0UHRyVHlwZT90LiQkLnNtYXJ0UHRyVHlwZS5uYW1lOnQuJCQucHRyVHlwZS5uYW1lKSsiIHRvIHBhcmFtZXRlciB0eXBlICIrdGhpcy5uYW1lKTticmVhaztjYXNlIDE6cj10LiQkLnNtYXJ0UHRyO2JyZWFrO2Nhc2UgMjppZih0LiQkLnNtYXJ0UHRyVHlwZT09PXRoaXMpcj10LiQkLnNtYXJ0UHRyO2Vsc2V7dmFyIG89dC5jbG9uZSgpO3I9dGhpcy5yYXdTaGFyZShyLFJ0KChmdW5jdGlvbigpe28uZGVsZXRlKCl9KSkpLG51bGwhPT1lJiZlLnB1c2godGhpcy5yYXdEZXN0cnVjdG9yLHIpfWJyZWFrO2RlZmF1bHQ6V2UoIlVuc3VwcG9ydGluZyBzaGFyaW5nIHBvbGljeSIpfXJldHVybiByfWZ1bmN0aW9uIHN0KGUsdCl7aWYobnVsbD09PXQpcmV0dXJuIHRoaXMuaXNSZWZlcmVuY2UmJldlKCJudWxsIGlzIG5vdCBhIHZhbGlkICIrdGhpcy5uYW1lKSwwO3QuJCR8fFdlKCdDYW5ub3QgcGFzcyAiJytPdCh0KSsnIiBhcyBhICcrdGhpcy5uYW1lKSx0LiQkLnB0cnx8V2UoIkNhbm5vdCBwYXNzIGRlbGV0ZWQgb2JqZWN0IGFzIGEgcG9pbnRlciBvZiB0eXBlICIrdGhpcy5uYW1lKSx0LiQkLnB0clR5cGUuaXNDb25zdCYmV2UoIkNhbm5vdCBjb252ZXJ0IGFyZ3VtZW50IG9mIHR5cGUgIit0LiQkLnB0clR5cGUubmFtZSsiIHRvIHBhcmFtZXRlciB0eXBlICIrdGhpcy5uYW1lKTt2YXIgcj10LiQkLnB0clR5cGUucmVnaXN0ZXJlZENsYXNzO3JldHVybiBvdCh0LiQkLnB0cixyLHRoaXMucmVnaXN0ZXJlZENsYXNzKX1mdW5jdGlvbiB1dChlKXtyZXR1cm4gdGhpcy5yYXdHZXRQb2ludGVlJiYoZT10aGlzLnJhd0dldFBvaW50ZWUoZSkpLGV9ZnVuY3Rpb24gY3QoZSl7dGhpcy5yYXdEZXN0cnVjdG9yJiZ0aGlzLnJhd0Rlc3RydWN0b3IoZSl9ZnVuY3Rpb24gbHQoZSl7bnVsbCE9PWUmJmUuZGVsZXRlKCl9ZnVuY3Rpb24gZnQoKXtyZXR1cm4gT2JqZWN0LmtleXMocHQpLmxlbmd0aH1mdW5jdGlvbiBkdCgpe3ZhciBlPVtdO2Zvcih2YXIgdCBpbiBwdClwdC5oYXNPd25Qcm9wZXJ0eSh0KSYmZS5wdXNoKHB0W3RdKTtyZXR1cm4gZX1mdW5jdGlvbiBodChlKXtLZT1lLEplLmxlbmd0aCYmS2UmJktlKFplKX12YXIgcHQ9e307ZnVuY3Rpb24gbXQoZSx0KXtyZXR1cm4gdD1mdW5jdGlvbihlLHQpe2Zvcih2b2lkIDA9PT10JiZXZSgicHRyIHNob3VsZCBub3QgYmUgdW5kZWZpbmVkIik7ZS5iYXNlQ2xhc3M7KXQ9ZS51cGNhc3QodCksZT1lLmJhc2VDbGFzcztyZXR1cm4gdH0oZSx0KSxwdFt0XX1mdW5jdGlvbiB5dChlLHQpe3JldHVybiB0LnB0clR5cGUmJnQucHRyfHxMZSgibWFrZUNsYXNzSGFuZGxlIHJlcXVpcmVzIHB0ciBhbmQgcHRyVHlwZSIpLCEhdC5zbWFydFB0clR5cGUhPT0hIXQuc21hcnRQdHImJkxlKCJCb3RoIHNtYXJ0UHRyVHlwZSBhbmQgc21hcnRQdHIgbXVzdCBiZSBzcGVjaWZpZWQiKSx0LmNvdW50PXt2YWx1ZToxfSxPYmplY3QuY3JlYXRlKGUseyQkOnt2YWx1ZTp0fX0pfWZ1bmN0aW9uIEV0KGUpe3ZhciB0PXRoaXMuZ2V0UG9pbnRlZShlKTtpZighdClyZXR1cm4gdGhpcy5kZXN0cnVjdG9yKGUpLG51bGw7dmFyIHI9bXQodGhpcy5yZWdpc3RlcmVkQ2xhc3MsdCk7aWYodm9pZCAwIT09cil7aWYoMD09PXIuJCQuY291bnQudmFsdWUpcmV0dXJuIHIuJCQucHRyPXQsci4kJC5zbWFydFB0cj1lLHIuY2xvbmUoKTt2YXIgbj1yLmNsb25lKCk7cmV0dXJuIHRoaXMuZGVzdHJ1Y3RvcihlKSxufWZ1bmN0aW9uIG8oKXtyZXR1cm4gdGhpcy5pc1NtYXJ0UG9pbnRlcj95dCh0aGlzLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0aGlzLnBvaW50ZWVUeXBlLHB0cjp0LHNtYXJ0UHRyVHlwZTp0aGlzLHNtYXJ0UHRyOmV9KTp5dCh0aGlzLnJlZ2lzdGVyZWRDbGFzcy5pbnN0YW5jZVByb3RvdHlwZSx7cHRyVHlwZTp0aGlzLHB0cjplfSl9dmFyIGksYT10aGlzLnJlZ2lzdGVyZWRDbGFzcy5nZXRBY3R1YWxUeXBlKHQpLHM9dHRbYV07aWYoIXMpcmV0dXJuIG8uY2FsbCh0aGlzKTtpPXRoaXMuaXNDb25zdD9zLmNvbnN0UG9pbnRlclR5cGU6cy5wb2ludGVyVHlwZTt2YXIgdT1mdW5jdGlvbiBlKHQscixuKXtpZihyPT09bilyZXR1cm4gdDtpZih2b2lkIDA9PT1uLmJhc2VDbGFzcylyZXR1cm4gbnVsbDt2YXIgbz1lKHQscixuLmJhc2VDbGFzcyk7cmV0dXJuIG51bGw9PT1vP251bGw6bi5kb3duY2FzdChvKX0odCx0aGlzLnJlZ2lzdGVyZWRDbGFzcyxpLnJlZ2lzdGVyZWRDbGFzcyk7cmV0dXJuIG51bGw9PT11P28uY2FsbCh0aGlzKTp0aGlzLmlzU21hcnRQb2ludGVyP3l0KGkucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHtwdHJUeXBlOmkscHRyOnUsc21hcnRQdHJUeXBlOnRoaXMsc21hcnRQdHI6ZX0pOnl0KGkucmVnaXN0ZXJlZENsYXNzLmluc3RhbmNlUHJvdG90eXBlLHtwdHJUeXBlOmkscHRyOnV9KX1mdW5jdGlvbiBndChlLHQscixuLG8saSxhLHMsdSxjLGwpe3RoaXMubmFtZT1lLHRoaXMucmVnaXN0ZXJlZENsYXNzPXQsdGhpcy5pc1JlZmVyZW5jZT1yLHRoaXMuaXNDb25zdD1uLHRoaXMuaXNTbWFydFBvaW50ZXI9byx0aGlzLnBvaW50ZWVUeXBlPWksdGhpcy5zaGFyaW5nUG9saWN5PWEsdGhpcy5yYXdHZXRQb2ludGVlPXMsdGhpcy5yYXdDb25zdHJ1Y3Rvcj11LHRoaXMucmF3U2hhcmU9Yyx0aGlzLnJhd0Rlc3RydWN0b3I9bCxvfHx2b2lkIDAhPT10LmJhc2VDbGFzcz90aGlzLnRvV2lyZVR5cGU9YXQ6bj8odGhpcy50b1dpcmVUeXBlPWl0LHRoaXMuZGVzdHJ1Y3RvckZ1bmN0aW9uPW51bGwpOih0aGlzLnRvV2lyZVR5cGU9c3QsdGhpcy5kZXN0cnVjdG9yRnVuY3Rpb249bnVsbCl9ZnVuY3Rpb24gdnQoZSx0KXt2YXIgcjtpZihlPXplKGUpLHZvaWQgMCE9PW9bIkZVTkNUSU9OX1RBQkxFXyIrZV0pcj1vWyJGVU5DVElPTl9UQUJMRV8iK2VdW3RdO2Vsc2UgaWYoInVuZGVmaW5lZCIhPXR5cGVvZiBGVU5DVElPTl9UQUJMRSlyPUZVTkNUSU9OX1RBQkxFW3RdO2Vsc2V7dmFyIG49by5hc21bImR5bkNhbGxfIitlXTt2b2lkIDA9PT1uJiZ2b2lkIDA9PT0obj1vLmFzbVsiZHluQ2FsbF8iK2UucmVwbGFjZSgvZi9nLCJkIildKSYmV2UoIk5vIGR5bkNhbGwgaW52b2tlciBmb3Igc2lnbmF0dXJlOiAiK2UpLHI9ZnVuY3Rpb24ocil7Zm9yKHZhciBuPVtdLG89MTtvPGUubGVuZ3RoOysrbyluLnB1c2goImEiK28pO3ZhciBpPSJyZXR1cm4gZnVuY3Rpb24gIisoImR5bkNhbGxfIitlKyJfIit0KSsiKCIrbi5qb2luKCIsICIpKyIpIHtcbiI7cmV0dXJuIGkrPSIgICAgcmV0dXJuIGR5bkNhbGwocmF3RnVuY3Rpb24iKyhuLmxlbmd0aD8iLCAiOiIiKStuLmpvaW4oIiwgIikrIik7XG4iLGkrPSJ9O1xuIixuZXcgRnVuY3Rpb24oImR5bkNhbGwiLCJyYXdGdW5jdGlvbiIsaSkocix0KX0obil9cmV0dXJuImZ1bmN0aW9uIiE9dHlwZW9mIHImJldlKCJ1bmtub3duIGZ1bmN0aW9uIHBvaW50ZXIgd2l0aCBzaWduYXR1cmUgIitlKyI6ICIrdCkscn12YXIgd3Q9dm9pZCAwO2Z1bmN0aW9uIF90KGUpe3ZhciB0PXF0KGUpLHI9emUodCk7cmV0dXJuIEt0KHQpLHJ9ZnVuY3Rpb24gYnQoZSx0KXt2YXIgcj1bXSxuPXt9O3Rocm93IHQuZm9yRWFjaCgoZnVuY3Rpb24gZSh0KXtuW3RdfHxDZVt0XXx8KE5lW3RdP05lW3RdLmZvckVhY2goZSk6KHIucHVzaCh0KSxuW3RdPSEwKSl9KSksbmV3IHd0KGUrIjogIityLm1hcChfdCkuam9pbihbIiwgIl0pKX1mdW5jdGlvbiBBdChlLHQpe2Zvcih2YXIgcj1bXSxuPTA7bjxlO24rKylyLnB1c2goRlsodD4+Mikrbl0pO3JldHVybiByfWZ1bmN0aW9uIFR0KGUsdCxyLG4sbyl7dmFyIGk9dC5sZW5ndGg7aTwyJiZXZSgiYXJnVHlwZXMgYXJyYXkgc2l6ZSBtaXNtYXRjaCEgTXVzdCBhdCBsZWFzdCBnZXQgcmV0dXJuIHZhbHVlIGFuZCAndGhpcycgdHlwZXMhIik7Zm9yKHZhciBhPW51bGwhPT10WzFdJiZudWxsIT09cixzPSExLHU9MTt1PHQubGVuZ3RoOysrdSlpZihudWxsIT09dFt1XSYmdm9pZCAwPT09dFt1XS5kZXN0cnVjdG9yRnVuY3Rpb24pe3M9ITA7YnJlYWt9dmFyIGM9InZvaWQiIT09dFswXS5uYW1lLGw9IiIsZj0iIjtmb3IodT0wO3U8aS0yOysrdSlsKz0oMCE9PXU/IiwgIjoiIikrImFyZyIrdSxmKz0oMCE9PXU/IiwgIjoiIikrImFyZyIrdSsiV2lyZWQiO3ZhciBkPSJyZXR1cm4gZnVuY3Rpb24gIitGZShlKSsiKCIrbCsiKSB7XG5pZiAoYXJndW1lbnRzLmxlbmd0aCAhPT0gIisoaS0yKSsiKSB7XG50aHJvd0JpbmRpbmdFcnJvcignZnVuY3Rpb24gIitlKyIgY2FsbGVkIHdpdGggJyArIGFyZ3VtZW50cy5sZW5ndGggKyAnIGFyZ3VtZW50cywgZXhwZWN0ZWQgIisoaS0yKSsiIGFyZ3MhJyk7XG59XG4iO3MmJihkKz0idmFyIGRlc3RydWN0b3JzID0gW107XG4iKTt2YXIgaD1zPyJkZXN0cnVjdG9ycyI6Im51bGwiLHA9WyJ0aHJvd0JpbmRpbmdFcnJvciIsImludm9rZXIiLCJmbiIsInJ1bkRlc3RydWN0b3JzIiwicmV0VHlwZSIsImNsYXNzUGFyYW0iXSxtPVtXZSxuLG8sRGUsdFswXSx0WzFdXTthJiYoZCs9InZhciB0aGlzV2lyZWQgPSBjbGFzc1BhcmFtLnRvV2lyZVR5cGUoIitoKyIsIHRoaXMpO1xuIik7Zm9yKHU9MDt1PGktMjsrK3UpZCs9InZhciBhcmciK3UrIldpcmVkID0gYXJnVHlwZSIrdSsiLnRvV2lyZVR5cGUoIitoKyIsIGFyZyIrdSsiKTsgLy8gIit0W3UrMl0ubmFtZSsiXG4iLHAucHVzaCgiYXJnVHlwZSIrdSksbS5wdXNoKHRbdSsyXSk7aWYoYSYmKGY9InRoaXNXaXJlZCIrKGYubGVuZ3RoPjA/IiwgIjoiIikrZiksZCs9KGM/InZhciBydiA9ICI6IiIpKyJpbnZva2VyKGZuIisoZi5sZW5ndGg+MD8iLCAiOiIiKStmKyIpO1xuIixzKWQrPSJydW5EZXN0cnVjdG9ycyhkZXN0cnVjdG9ycyk7XG4iO2Vsc2UgZm9yKHU9YT8xOjI7dTx0Lmxlbmd0aDsrK3Upe3ZhciB5PTE9PT11PyJ0aGlzV2lyZWQiOiJhcmciKyh1LTIpKyJXaXJlZCI7bnVsbCE9PXRbdV0uZGVzdHJ1Y3RvckZ1bmN0aW9uJiYoZCs9eSsiX2R0b3IoIit5KyIpOyAvLyAiK3RbdV0ubmFtZSsiXG4iLHAucHVzaCh5KyJfZHRvciIpLG0ucHVzaCh0W3VdLmRlc3RydWN0b3JGdW5jdGlvbikpfXJldHVybiBjJiYoZCs9InZhciByZXQgPSByZXRUeXBlLmZyb21XaXJlVHlwZShydik7XG5yZXR1cm4gcmV0O1xuIiksZCs9In1cbiIscC5wdXNoKGQpLGZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgRnVuY3Rpb24pKXRocm93IG5ldyBUeXBlRXJyb3IoIm5ld18gY2FsbGVkIHdpdGggY29uc3RydWN0b3IgdHlwZSAiK3R5cGVvZiBlKyIgd2hpY2ggaXMgbm90IGEgZnVuY3Rpb24iKTt2YXIgcj1NZShlLm5hbWV8fCJ1bmtub3duRnVuY3Rpb25OYW1lIiwoZnVuY3Rpb24oKXt9KSk7ci5wcm90b3R5cGU9ZS5wcm90b3R5cGU7dmFyIG49bmV3IHIsbz1lLmFwcGx5KG4sdCk7cmV0dXJuIG8gaW5zdGFuY2VvZiBPYmplY3Q/bzpufShGdW5jdGlvbixwKS5hcHBseShudWxsLG0pfXZhciBTdD1bXSxrdD1be30se3ZhbHVlOnZvaWQgMH0se3ZhbHVlOm51bGx9LHt2YWx1ZTohMH0se3ZhbHVlOiExfV07ZnVuY3Rpb24gUHQoKXtmb3IodmFyIGU9MCx0PTU7dDxrdC5sZW5ndGg7Kyt0KXZvaWQgMCE9PWt0W3RdJiYrK2U7cmV0dXJuIGV9ZnVuY3Rpb24gRHQoKXtmb3IodmFyIGU9NTtlPGt0Lmxlbmd0aDsrK2UpaWYodm9pZCAwIT09a3RbZV0pcmV0dXJuIGt0W2VdO3JldHVybiBudWxsfWZ1bmN0aW9uIFJ0KGUpe3N3aXRjaChlKXtjYXNlIHZvaWQgMDpyZXR1cm4gMTtjYXNlIG51bGw6cmV0dXJuIDI7Y2FzZSEwOnJldHVybiAzO2Nhc2UhMTpyZXR1cm4gNDtkZWZhdWx0OnZhciB0PVN0Lmxlbmd0aD9TdC5wb3AoKTprdC5sZW5ndGg7cmV0dXJuIGt0W3RdPXtyZWZjb3VudDoxLHZhbHVlOmV9LHR9fWZ1bmN0aW9uIE90KGUpe2lmKG51bGw9PT1lKXJldHVybiJudWxsIjt2YXIgdD10eXBlb2YgZTtyZXR1cm4ib2JqZWN0Ij09PXR8fCJhcnJheSI9PT10fHwiZnVuY3Rpb24iPT09dD9lLnRvU3RyaW5nKCk6IiIrZX1mdW5jdGlvbiBDdChlLHQpe3N3aXRjaCh0KXtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmZyb21XaXJlVHlwZShJW2U+PjJdKX07Y2FzZSAzOnJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5mcm9tV2lyZVR5cGUoQltlPj4zXSl9O2RlZmF1bHQ6dGhyb3cgbmV3IFR5cGVFcnJvcigiVW5rbm93biBmbG9hdCB0eXBlOiAiK2UpfX1mdW5jdGlvbiBOdChlLHQscil7c3dpdGNoKHQpe2Nhc2UgMDpyZXR1cm4gcj9mdW5jdGlvbihlKXtyZXR1cm4gUltlXX06ZnVuY3Rpb24oZSl7cmV0dXJuIE9bZV19O2Nhc2UgMTpyZXR1cm4gcj9mdW5jdGlvbihlKXtyZXR1cm4gQ1tlPj4xXX06ZnVuY3Rpb24oZSl7cmV0dXJuIE5bZT4+MV19O2Nhc2UgMjpyZXR1cm4gcj9mdW5jdGlvbihlKXtyZXR1cm4gRltlPj4yXX06ZnVuY3Rpb24oZSl7cmV0dXJuIE1bZT4+Ml19O2RlZmF1bHQ6dGhyb3cgbmV3IFR5cGVFcnJvcigiVW5rbm93biBpbnRlZ2VyIHR5cGU6ICIrZSl9fXZhciBGdD1MKz0xNjt2YXIgTXQ9e307dmFyIEl0PUwrPTE2O0wrPTQ4O2coJHQoIkdNVCIpLCJpOCIsMik7dmFyIEJ0PUwsTHQ9TCs9MTYseHQ9TCs9MTY7ZnVuY3Rpb24ganQoKXtpZighanQuY2FsbGVkKXtqdC5jYWxsZWQ9ITAsRlt4dD4+Ml09NjAqKG5ldyBEYXRlKS5nZXRUaW1lem9uZU9mZnNldCgpO3ZhciBlPW5ldyBEYXRlKDJlMywwLDEpLHQ9bmV3IERhdGUoMmUzLDYsMSk7RltMdD4+Ml09TnVtYmVyKGUuZ2V0VGltZXpvbmVPZmZzZXQoKSE9dC5nZXRUaW1lem9uZU9mZnNldCgpKTt2YXIgcj1hKGUpLG49YSh0KSxvPWcoJHQociksImk4IiwwKSxpPWcoJHQobiksImk4IiwwKTt0LmdldFRpbWV6b25lT2Zmc2V0KCk8ZS5nZXRUaW1lem9uZU9mZnNldCgpPyhGW0J0Pj4yXT1vLEZbQnQrND4+Ml09aSk6KEZbQnQ+PjJdPWksRltCdCs0Pj4yXT1vKX1mdW5jdGlvbiBhKGUpe3ZhciB0PWUudG9UaW1lU3RyaW5nKCkubWF0Y2goL1woKFtBLVphLXogXSspXCkkLyk7cmV0dXJuIHQ/dFsxXToiR01UIn19TCs9MTY7dmFyIFV0PXt9O3ZhciB6dD0xO2Z1bmN0aW9uICR0KGUsdCxyKXt2YXIgbj1yPjA/cjpTKGUpKzEsbz1uZXcgQXJyYXkobiksaT1BKGUsbywwLG8ubGVuZ3RoKTtyZXR1cm4gdCYmKG8ubGVuZ3RoPWkpLG99VGUuc3RhdGljSW5pdCgpLEoudW5zaGlmdCgoZnVuY3Rpb24oKXtvLm5vRlNJbml0fHxUZS5pbml0LmluaXRpYWxpemVkfHxUZS5pbml0KCl9KSksWi5wdXNoKChmdW5jdGlvbigpe1RlLmlnbm9yZVBlcm1pc3Npb25zPSExfSkpLFEucHVzaCgoZnVuY3Rpb24oKXtUZS5xdWl0KCl9KSksSi51bnNoaWZ0KChmdW5jdGlvbigpe3ZlLmluaXQoKX0pKSxRLnB1c2goKGZ1bmN0aW9uKCl7dmUuc2h1dGRvd24oKX0pKSxCZT1vLkludGVybmFsRXJyb3I9SWUoRXJyb3IsIkludGVybmFsRXJyb3IiKSxmdW5jdGlvbigpe2Zvcih2YXIgZT1uZXcgQXJyYXkoMjU2KSx0PTA7dDwyNTY7Kyt0KWVbdF09U3RyaW5nLmZyb21DaGFyQ29kZSh0KTtVZT1lfSgpLCRlPW8uQmluZGluZ0Vycm9yPUllKEVycm9yLCJCaW5kaW5nRXJyb3IiKSxldC5wcm90b3R5cGUuaXNBbGlhc09mPVZlLGV0LnByb3RvdHlwZS5jbG9uZT1HZSxldC5wcm90b3R5cGUuZGVsZXRlPXFlLGV0LnByb3RvdHlwZS5pc0RlbGV0ZWQ9WGUsZXQucHJvdG90eXBlLmRlbGV0ZUxhdGVyPVFlLGd0LnByb3RvdHlwZS5nZXRQb2ludGVlPXV0LGd0LnByb3RvdHlwZS5kZXN0cnVjdG9yPWN0LGd0LnByb3RvdHlwZS5hcmdQYWNrQWR2YW5jZT04LGd0LnByb3RvdHlwZS5yZWFkVmFsdWVGcm9tUG9pbnRlcj1SZSxndC5wcm90b3R5cGUuZGVsZXRlT2JqZWN0PWx0LGd0LnByb3RvdHlwZS5mcm9tV2lyZVR5cGU9RXQsby5nZXRJbmhlcml0ZWRJbnN0YW5jZUNvdW50PWZ0LG8uZ2V0TGl2ZUluaGVyaXRlZEluc3RhbmNlcz1kdCxvLmZsdXNoUGVuZGluZ0RlbGV0ZXM9WmUsby5zZXREZWxheUZ1bmN0aW9uPWh0LHd0PW8uVW5ib3VuZFR5cGVFcnJvcj1JZShFcnJvciwiVW5ib3VuZFR5cGVFcnJvciIpLG8uY291bnRfZW12YWxfaGFuZGxlcz1QdCxvLmdldF9maXJzdF9lbXZhbD1EdCxmdW5jdGlvbiBlKHQpe3ZhciByLG47ZS5jYWxsZWQ/KG49RltGdD4+Ml0scj1GW24+PjJdKTooZS5jYWxsZWQ9ITAsTXQuVVNFUj1NdC5MT0dOQU1FPSJ3ZWJfdXNlciIsTXQuUEFUSD0iLyIsTXQuUFdEPSIvIixNdC5IT01FPSIvaG9tZS93ZWJfdXNlciIsTXQuTEFORz0iQy5VVEYtOCIsTXQuXz1vLnRoaXNQcm9ncmFtLHI9ZigxMDI0KSxuPWYoMjU2KSxGW24+PjJdPXIsRltGdD4+Ml09bik7dmFyIGk9W10sYT0wO2Zvcih2YXIgcyBpbiB0KWlmKCJzdHJpbmciPT10eXBlb2YgdFtzXSl7dmFyIHU9cysiPSIrdFtzXTtpLnB1c2godSksYSs9dS5sZW5ndGh9aWYoYT4xMDI0KXRocm93IG5ldyBFcnJvcigiRW52aXJvbm1lbnQgc2l6ZSBleGNlZWRlZCBUT1RBTF9FTlZfU0laRSEiKTtmb3IodmFyIGM9MDtjPGkubGVuZ3RoO2MrKyl7cmUodT1pW2NdLHIpLEZbbis0KmM+PjJdPXIscis9dS5sZW5ndGgrMX1GW24rNCppLmxlbmd0aD4+Ml09MH0oTXQpLCQ9Zig0KSxqPVU9aChMKSx6PWgoaitHKSxGWyQ+PjJdPXoseD0hMCxvLndhc21UYWJsZVNpemU9MzE2LG8ud2FzbU1heFRhYmxlU2l6ZT0zMTYsby5hc21HbG9iYWxBcmc9e30sby5hc21MaWJyYXJ5QXJnPXthYm9ydDpycixlbmxhcmdlTWVtb3J5OkgsZ2V0VG90YWxNZW1vcnk6ZnVuY3Rpb24oKXtyZXR1cm4gcX0sYWJvcnRPbkNhbm5vdEdyb3dNZW1vcnk6ZnVuY3Rpb24oKXtycigiQ2Fubm90IGVubGFyZ2UgbWVtb3J5IGFycmF5cy4gRWl0aGVyICgxKSBjb21waWxlIHdpdGggIC1zIFRPVEFMX01FTU9SWT1YICB3aXRoIFggaGlnaGVyIHRoYW4gdGhlIGN1cnJlbnQgdmFsdWUgIitxKyIsICgyKSBjb21waWxlIHdpdGggIC1zIEFMTE9XX01FTU9SWV9HUk9XVEg9MSAgd2hpY2ggYWxsb3dzIGluY3JlYXNpbmcgdGhlIHNpemUgYXQgcnVudGltZSwgb3IgKDMpIGlmIHlvdSB3YW50IG1hbGxvYyB0byByZXR1cm4gTlVMTCAoMCkgaW5zdGVhZCBvZiB0aGlzIGFib3J0LCBjb21waWxlIHdpdGggIC1zIEFCT1JUSU5HX01BTExPQz0wICIpfSxpbnZva2VfaTpmdW5jdGlvbihlKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9pKGUpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9paTpmdW5jdGlvbihlLHQpe3RyeXtyZXR1cm4gby5keW5DYWxsX2lpKGUsdCl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX2lpaTpmdW5jdGlvbihlLHQscil7dHJ5e3JldHVybiBvLmR5bkNhbGxfaWlpKGUsdCxyKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfaWlpaTpmdW5jdGlvbihlLHQscixuKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9paWlpKGUsdCxyLG4pfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9paWlpaTpmdW5jdGlvbihlLHQscixuLGkpe3RyeXtyZXR1cm4gby5keW5DYWxsX2lpaWlpKGUsdCxyLG4saSl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX2lpaWlpaWk6ZnVuY3Rpb24oZSx0LHIsbixpLGEscyl7dHJ5e3JldHVybiBvLmR5bkNhbGxfaWlpaWlpaShlLHQscixuLGksYSxzKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfaWlpaWlpaWlpaTpmdW5jdGlvbihlLHQscixuLGksYSxzLHUsYyxsKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9paWlpaWlpaWlpKGUsdCxyLG4saSxhLHMsdSxjLGwpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9paWlpaWlqaWk6ZnVuY3Rpb24oZSx0LHIsbixpLGEscyx1LGMsbCl7dHJ5e3JldHVybiBvLmR5bkNhbGxfaWlpaWlpamlpKGUsdCxyLG4saSxhLHMsdSxjLGwpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV9pamo6ZnVuY3Rpb24oZSx0LHIsbixpKXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9pamooZSx0LHIsbixpKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2Vfamk6ZnVuY3Rpb24oZSx0KXt0cnl7cmV0dXJuIG8uZHluQ2FsbF9qaShlLHQpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92OmZ1bmN0aW9uKGUpe3RyeXtvLmR5bkNhbGxfdihlKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2Vfdmk6ZnVuY3Rpb24oZSx0KXt0cnl7by5keW5DYWxsX3ZpKGUsdCl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3ZpaTpmdW5jdGlvbihlLHQscil7dHJ5e28uZHluQ2FsbF92aWkoZSx0LHIpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92aWlpOmZ1bmN0aW9uKGUsdCxyLG4pe3RyeXtvLmR5bkNhbGxfdmlpaShlLHQscixuKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfdmlpaWk6ZnVuY3Rpb24oZSx0LHIsbixpKXt0cnl7by5keW5DYWxsX3ZpaWlpKGUsdCxyLG4saSl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3ZpaWlpaTpmdW5jdGlvbihlLHQscixuLGksYSl7dHJ5e28uZHluQ2FsbF92aWlpaWkoZSx0LHIsbixpLGEpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92aWlpaWlpOmZ1bmN0aW9uKGUsdCxyLG4saSxhLHMpe3RyeXtvLmR5bkNhbGxfdmlpaWlpaShlLHQscixuLGksYSxzKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxpbnZva2VfdmlpaWlpaWlpaTpmdW5jdGlvbihlLHQscixuLGksYSxzLHUsYyxsKXt0cnl7by5keW5DYWxsX3ZpaWlpaWlpaWkoZSx0LHIsbixpLGEscyx1LGMsbCl9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3ZpaWlpaWlpaWlpOmZ1bmN0aW9uKGUsdCxyLG4saSxhLHMsdSxjLGwsZil7dHJ5e28uZHluQ2FsbF92aWlpaWlpaWlpaShlLHQscixuLGksYSxzLHUsYyxsLGYpfWNhdGNoKGUpe2lmKCJudW1iZXIiIT10eXBlb2YgZSYmImxvbmdqbXAiIT09ZSl0aHJvdyBlO28uc2V0VGhyZXcoMSwwKX19LGludm9rZV92aWo6ZnVuY3Rpb24oZSx0LHIsbil7dHJ5e28uZHluQ2FsbF92aWooZSx0LHIsbil9Y2F0Y2goZSl7aWYoIm51bWJlciIhPXR5cGVvZiBlJiYibG9uZ2ptcCIhPT1lKXRocm93IGU7by5zZXRUaHJldygxLDApfX0saW52b2tlX3Zpamk6ZnVuY3Rpb24oZSx0LHIsbixpKXt0cnl7by5keW5DYWxsX3ZpamkoZSx0LHIsbixpKX1jYXRjaChlKXtpZigibnVtYmVyIiE9dHlwZW9mIGUmJiJsb25nam1wIiE9PWUpdGhyb3cgZTtvLnNldFRocmV3KDEsMCl9fSxfX19jeGFfYWxsb2NhdGVfZXhjZXB0aW9uOmZ1bmN0aW9uKGUpe3JldHVybiBKdChlKX0sX19fY3hhX2JlZ2luX2NhdGNoOmZ1bmN0aW9uKGUpe3ZhciB0PWRlLmluZm9zW2VdO3JldHVybiB0JiYhdC5jYXVnaHQmJih0LmNhdWdodD0hMCksdCYmKHQucmV0aHJvd249ITEpLGRlLmNhdWdodC5wdXNoKGUpLGRlLmFkZFJlZihkZS5kZUFkanVzdChlKSksZX0sX19fY3hhX2VuZF9jYXRjaDpmdW5jdGlvbigpe28uc2V0VGhyZXcoMCk7dmFyIGU9ZGUuY2F1Z2h0LnBvcCgpO2UmJihkZS5kZWNSZWYoZGUuZGVBZGp1c3QoZSkpLGRlLmxhc3Q9MCl9LF9fX2N4YV9maW5kX21hdGNoaW5nX2NhdGNoXzI6ZnVuY3Rpb24oKXtyZXR1cm4gcGUuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfX19jeGFfZmluZF9tYXRjaGluZ19jYXRjaF8zOmZ1bmN0aW9uKCl7cmV0dXJuIHBlLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX19fY3hhX2ZpbmRfbWF0Y2hpbmdfY2F0Y2hfNDpmdW5jdGlvbigpe3JldHVybiBwZS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9fX2N4YV9mcmVlX2V4Y2VwdGlvbjpoZSxfX19jeGFfdGhyb3c6ZnVuY3Rpb24oZSx0LHIpe3Rocm93IGRlLmluZm9zW2VdPXtwdHI6ZSxhZGp1c3RlZDplLHR5cGU6dCxkZXN0cnVjdG9yOnIscmVmY291bnQ6MCxjYXVnaHQ6ITEscmV0aHJvd246ITF9LGRlLmxhc3Q9ZSxlfSxfX19sb2NrOmZ1bmN0aW9uKCl7fSxfX19tYXBfZmlsZTpmdW5jdGlvbihlLHQpe3JldHVybiB5ZShtZS5FUEVSTSksLTF9LF9fX3Jlc3VtZUV4Y2VwdGlvbjpmdW5jdGlvbihlKXt0aHJvdyBkZS5sYXN0fHwoZGUubGFzdD1lKSxlfSxfX19zZXRFcnJObzp5ZSxfX19zeXNjYWxsMTQwOmZ1bmN0aW9uKGUsdCl7U2UudmFyYXJncz10O3RyeXt2YXIgcj1TZS5nZXRTdHJlYW1Gcm9tRkQoKSxuPShTZS5nZXQoKSxTZS5nZXQoKSksbz1TZS5nZXQoKSxpPVNlLmdldCgpLGE9bjtyZXR1cm4gVGUubGxzZWVrKHIsYSxpKSxGW28+PjJdPXIucG9zaXRpb24sci5nZXRkZW50cyYmMD09PWEmJjA9PT1pJiYoci5nZXRkZW50cz1udWxsKSwwfWNhdGNoKGUpe3JldHVybiB2b2lkIDAhPT1UZSYmZSBpbnN0YW5jZW9mIFRlLkVycm5vRXJyb3J8fHJyKGUpLC1lLmVycm5vfX0sX19fc3lzY2FsbDE0NTpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0U3RyZWFtRnJvbUZEKCksbj1TZS5nZXQoKSxvPVNlLmdldCgpO3JldHVybiBTZS5kb1JlYWR2KHIsbixvKX1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGwxNDY6ZnVuY3Rpb24oZSx0KXtTZS52YXJhcmdzPXQ7dHJ5e3ZhciByPVNlLmdldFN0cmVhbUZyb21GRCgpLG49U2UuZ2V0KCksbz1TZS5nZXQoKTtyZXR1cm4gU2UuZG9Xcml0ZXYocixuLG8pfWNhdGNoKGUpe3JldHVybiB2b2lkIDAhPT1UZSYmZSBpbnN0YW5jZW9mIFRlLkVycm5vRXJyb3J8fHJyKGUpLC1lLmVycm5vfX0sX19fc3lzY2FsbDE4MzpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0KCksbj1TZS5nZXQoKTtpZigwPT09bilyZXR1cm4tbWUuRUlOVkFMO3ZhciBvPVRlLmN3ZCgpO3JldHVybiBuPFMobykrMT8tbWUuRVJBTkdFOihUKG8scixuKSxyKX1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGwxOTg6ZnVuY3Rpb24oZSx0KXtTZS52YXJhcmdzPXQ7dHJ5e3ZhciByPVNlLmdldFN0cigpLG49U2UuZ2V0KCksbz1TZS5nZXQoKTtyZXR1cm4gVGUuY2hvd24ocixuLG8pLDB9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgMCE9PVRlJiZlIGluc3RhbmNlb2YgVGUuRXJybm9FcnJvcnx8cnIoZSksLWUuZXJybm99fSxfX19zeXNjYWxsMjA6ZnVuY3Rpb24oZSx0KXtTZS52YXJhcmdzPXQ7dHJ5e3JldHVybiBrZX1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGw2OmZ1bmN0aW9uKGUsdCl7U2UudmFyYXJncz10O3RyeXt2YXIgcj1TZS5nZXRTdHJlYW1Gcm9tRkQoKTtyZXR1cm4gVGUuY2xvc2UociksMH1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGw2MDpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0KCksbj1TZS51bWFzaztyZXR1cm4gU2UudW1hc2s9cixufWNhdGNoKGUpe3JldHVybiB2b2lkIDAhPT1UZSYmZSBpbnN0YW5jZW9mIFRlLkVycm5vRXJyb3J8fHJyKGUpLC1lLmVycm5vfX0sX19fc3lzY2FsbDgzOmZ1bmN0aW9uKGUsdCl7U2UudmFyYXJncz10O3RyeXt2YXIgcj1TZS5nZXRTdHIoKSxuPVNlLmdldFN0cigpO3JldHVybiBUZS5zeW1saW5rKHIsbiksMH1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3N5c2NhbGw5MTpmdW5jdGlvbihlLHQpe1NlLnZhcmFyZ3M9dDt0cnl7dmFyIHI9U2UuZ2V0KCksbj1TZS5nZXQoKSxvPVNlLm1hcHBpbmdzW3JdO2lmKCFvKXJldHVybiAwO2lmKG49PT1vLmxlbil7dmFyIGk9VGUuZ2V0U3RyZWFtKG8uZmQpO1NlLmRvTXN5bmMocixpLG4sby5mbGFncyksVGUubXVubWFwKGkpLFNlLm1hcHBpbmdzW3JdPW51bGwsby5hbGxvY2F0ZWQmJkt0KG8ubWFsbG9jKX1yZXR1cm4gMH1jYXRjaChlKXtyZXR1cm4gdm9pZCAwIT09VGUmJmUgaW5zdGFuY2VvZiBUZS5FcnJub0Vycm9yfHxycihlKSwtZS5lcnJub319LF9fX3VubG9jazpmdW5jdGlvbigpe30sX19lbWJpbmRfZmluYWxpemVfdmFsdWVfb2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0PVBlW2VdO2RlbGV0ZSBQZVtlXTt2YXIgcj10LnJhd0NvbnN0cnVjdG9yLG49dC5yYXdEZXN0cnVjdG9yLG89dC5maWVsZHM7eGUoW2VdLG8ubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXR0ZXJSZXR1cm5UeXBlfSkpLmNvbmNhdChvLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2V0dGVyQXJndW1lbnRUeXBlfSkpKSwoZnVuY3Rpb24oZSl7dmFyIGk9e307cmV0dXJuIG8uZm9yRWFjaCgoZnVuY3Rpb24odCxyKXt2YXIgbj10LmZpZWxkTmFtZSxhPWVbcl0scz10LmdldHRlcix1PXQuZ2V0dGVyQ29udGV4dCxjPWVbcitvLmxlbmd0aF0sbD10LnNldHRlcixmPXQuc2V0dGVyQ29udGV4dDtpW25dPXtyZWFkOmZ1bmN0aW9uKGUpe3JldHVybiBhLmZyb21XaXJlVHlwZShzKHUsZSkpfSx3cml0ZTpmdW5jdGlvbihlLHQpe3ZhciByPVtdO2woZixlLGMudG9XaXJlVHlwZShyLHQpKSxEZShyKX19fSkpLFt7bmFtZTp0Lm5hbWUsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKGUpe3ZhciB0PXt9O2Zvcih2YXIgciBpbiBpKXRbcl09aVtyXS5yZWFkKGUpO3JldHVybiBuKGUpLHR9LHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG8gaW4gaSlpZighKG8gaW4gdCkpdGhyb3cgbmV3IFR5cGVFcnJvcigiTWlzc2luZyBmaWVsZCIpO3ZhciBhPXIoKTtmb3IobyBpbiBpKWlbb10ud3JpdGUoYSx0W29dKTtyZXR1cm4gbnVsbCE9PWUmJmUucHVzaChuLGEpLGF9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6UmUsZGVzdHJ1Y3RvckZ1bmN0aW9uOm59XX0pKX0sX19lbWJpbmRfcmVnaXN0ZXJfYm9vbDpmdW5jdGlvbihlLHQscixuLG8pe3ZhciBpPWplKHIpO1llKGUse25hbWU6dD16ZSh0KSxmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7cmV0dXJuISFlfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/bjpvfSxhcmdQYWNrQWR2YW5jZTo4LHJlYWRWYWx1ZUZyb21Qb2ludGVyOmZ1bmN0aW9uKGUpe3ZhciBuO2lmKDE9PT1yKW49UjtlbHNlIGlmKDI9PT1yKW49QztlbHNle2lmKDQhPT1yKXRocm93IG5ldyBUeXBlRXJyb3IoIlVua25vd24gYm9vbGVhbiB0eXBlIHNpemU6ICIrdCk7bj1GfXJldHVybiB0aGlzLmZyb21XaXJlVHlwZShuW2U+PmldKX0sZGVzdHJ1Y3RvckZ1bmN0aW9uOm51bGx9KX0sX19lbWJpbmRfcmVnaXN0ZXJfY2xhc3M6ZnVuY3Rpb24oZSx0LHIsbixpLGEscyx1LGMsbCxmLGQsaCl7Zj16ZShmKSxhPXZ0KGksYSksdSYmKHU9dnQocyx1KSksbCYmKGw9dnQoYyxsKSksaD12dChkLGgpO3ZhciBwPUZlKGYpOyFmdW5jdGlvbihlLHQscil7by5oYXNPd25Qcm9wZXJ0eShlKT8oKHZvaWQgMD09PXJ8fHZvaWQgMCE9PW9bZV0ub3ZlcmxvYWRUYWJsZSYmdm9pZCAwIT09b1tlXS5vdmVybG9hZFRhYmxlW3JdKSYmV2UoIkNhbm5vdCByZWdpc3RlciBwdWJsaWMgbmFtZSAnIitlKyInIHR3aWNlIikscnQobyxlLGUpLG8uaGFzT3duUHJvcGVydHkocikmJldlKCJDYW5ub3QgcmVnaXN0ZXIgbXVsdGlwbGUgb3ZlcmxvYWRzIG9mIGEgZnVuY3Rpb24gd2l0aCB0aGUgc2FtZSBudW1iZXIgb2YgYXJndW1lbnRzICgiK3IrIikhIiksb1tlXS5vdmVybG9hZFRhYmxlW3JdPXQpOihvW2VdPXQsdm9pZCAwIT09ciYmKG9bZV0ubnVtQXJndW1lbnRzPXIpKX0ocCwoZnVuY3Rpb24oKXtidCgiQ2Fubm90IGNvbnN0cnVjdCAiK2YrIiBkdWUgdG8gdW5ib3VuZCB0eXBlcyIsW25dKX0pKSx4ZShbZSx0LHJdLG4/W25dOltdLChmdW5jdGlvbih0KXt2YXIgcixpO3Q9dFswXSxpPW4/KHI9dC5yZWdpc3RlcmVkQ2xhc3MpLmluc3RhbmNlUHJvdG90eXBlOmV0LnByb3RvdHlwZTt2YXIgcz1NZShwLChmdW5jdGlvbigpe2lmKE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKSE9PWMpdGhyb3cgbmV3ICRlKCJVc2UgJ25ldycgdG8gY29uc3RydWN0ICIrZik7aWYodm9pZCAwPT09ZC5jb25zdHJ1Y3Rvcl9ib2R5KXRocm93IG5ldyAkZShmKyIgaGFzIG5vIGFjY2Vzc2libGUgY29uc3RydWN0b3IiKTt2YXIgZT1kLmNvbnN0cnVjdG9yX2JvZHlbYXJndW1lbnRzLmxlbmd0aF07aWYodm9pZCAwPT09ZSl0aHJvdyBuZXcgJGUoIlRyaWVkIHRvIGludm9rZSBjdG9yIG9mICIrZisiIHdpdGggaW52YWxpZCBudW1iZXIgb2YgcGFyYW1ldGVycyAoIithcmd1bWVudHMubGVuZ3RoKyIpIC0gZXhwZWN0ZWQgKCIrT2JqZWN0LmtleXMoZC5jb25zdHJ1Y3Rvcl9ib2R5KS50b1N0cmluZygpKyIpIHBhcmFtZXRlcnMgaW5zdGVhZCEiKTtyZXR1cm4gZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KSksYz1PYmplY3QuY3JlYXRlKGkse2NvbnN0cnVjdG9yOnt2YWx1ZTpzfX0pO3MucHJvdG90eXBlPWM7dmFyIGQ9bmV3IG50KGYscyxjLGgscixhLHUsbCksbT1uZXcgZ3QoZixkLCEwLCExLCExKSx5PW5ldyBndChmKyIqIixkLCExLCExLCExKSxFPW5ldyBndChmKyIgY29uc3QqIixkLCExLCEwLCExKTtyZXR1cm4gdHRbZV09e3BvaW50ZXJUeXBlOnksY29uc3RQb2ludGVyVHlwZTpFfSxmdW5jdGlvbihlLHQscil7by5oYXNPd25Qcm9wZXJ0eShlKXx8TGUoIlJlcGxhY2luZyBub25leGlzdGFudCBwdWJsaWMgc3ltYm9sIiksdm9pZCAwIT09b1tlXS5vdmVybG9hZFRhYmxlJiZ2b2lkIDAhPT1yP29bZV0ub3ZlcmxvYWRUYWJsZVtyXT10OihvW2VdPXQsb1tlXS5hcmdDb3VudD1yKX0ocCxzKSxbbSx5LEVdfSkpfSxfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19jb25zdHJ1Y3RvcjpmdW5jdGlvbihlLHQscixuLG8saSl7dmFyIGE9QXQodCxyKTtvPXZ0KG4sbykseGUoW10sW2VdLChmdW5jdGlvbihlKXt2YXIgcj0iY29uc3RydWN0b3IgIisoZT1lWzBdKS5uYW1lO2lmKHZvaWQgMD09PWUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHkmJihlLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5PVtdKSx2b2lkIDAhPT1lLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5W3QtMV0pdGhyb3cgbmV3ICRlKCJDYW5ub3QgcmVnaXN0ZXIgbXVsdGlwbGUgY29uc3RydWN0b3JzIHdpdGggaWRlbnRpY2FsIG51bWJlciBvZiBwYXJhbWV0ZXJzICgiKyh0LTEpKyIpIGZvciBjbGFzcyAnIitlLm5hbWUrIichIE92ZXJsb2FkIHJlc29sdXRpb24gaXMgY3VycmVudGx5IG9ubHkgcGVyZm9ybWVkIHVzaW5nIHRoZSBwYXJhbWV0ZXIgY291bnQsIG5vdCBhY3R1YWwgdHlwZSBpbmZvISIpO3JldHVybiBlLnJlZ2lzdGVyZWRDbGFzcy5jb25zdHJ1Y3Rvcl9ib2R5W3QtMV09ZnVuY3Rpb24oKXtidCgiQ2Fubm90IGNvbnN0cnVjdCAiK2UubmFtZSsiIGR1ZSB0byB1bmJvdW5kIHR5cGVzIixhKX0seGUoW10sYSwoZnVuY3Rpb24obil7cmV0dXJuIGUucmVnaXN0ZXJlZENsYXNzLmNvbnN0cnVjdG9yX2JvZHlbdC0xXT1mdW5jdGlvbigpe2FyZ3VtZW50cy5sZW5ndGghPT10LTEmJldlKHIrIiBjYWxsZWQgd2l0aCAiK2FyZ3VtZW50cy5sZW5ndGgrIiBhcmd1bWVudHMsIGV4cGVjdGVkICIrKHQtMSkpO3ZhciBlPVtdLGE9bmV3IEFycmF5KHQpO2FbMF09aTtmb3IodmFyIHM9MTtzPHQ7KytzKWFbc109bltzXS50b1dpcmVUeXBlKGUsYXJndW1lbnRzW3MtMV0pO3ZhciB1PW8uYXBwbHkobnVsbCxhKTtyZXR1cm4gRGUoZSksblswXS5mcm9tV2lyZVR5cGUodSl9LFtdfSkpLFtdfSkpfSxfX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19mdW5jdGlvbjpmdW5jdGlvbihlLHQscixuLG8saSxhLHMpe3ZhciB1PUF0KHIsbik7dD16ZSh0KSxpPXZ0KG8saSkseGUoW10sW2VdLChmdW5jdGlvbihlKXt2YXIgbj0oZT1lWzBdKS5uYW1lKyIuIit0O2Z1bmN0aW9uIG8oKXtidCgiQ2Fubm90IGNhbGwgIituKyIgZHVlIHRvIHVuYm91bmQgdHlwZXMiLHUpfXMmJmUucmVnaXN0ZXJlZENsYXNzLnB1cmVWaXJ0dWFsRnVuY3Rpb25zLnB1c2godCk7dmFyIGM9ZS5yZWdpc3RlcmVkQ2xhc3MuaW5zdGFuY2VQcm90b3R5cGUsbD1jW3RdO3JldHVybiB2b2lkIDA9PT1sfHx2b2lkIDA9PT1sLm92ZXJsb2FkVGFibGUmJmwuY2xhc3NOYW1lIT09ZS5uYW1lJiZsLmFyZ0NvdW50PT09ci0yPyhvLmFyZ0NvdW50PXItMixvLmNsYXNzTmFtZT1lLm5hbWUsY1t0XT1vKToocnQoYyx0LG4pLGNbdF0ub3ZlcmxvYWRUYWJsZVtyLTJdPW8pLHhlKFtdLHUsKGZ1bmN0aW9uKG8pe3ZhciBzPVR0KG4sbyxlLGksYSk7cmV0dXJuIHZvaWQgMD09PWNbdF0ub3ZlcmxvYWRUYWJsZT8ocy5hcmdDb3VudD1yLTIsY1t0XT1zKTpjW3RdLm92ZXJsb2FkVGFibGVbci0yXT1zLFtdfSkpLFtdfSkpfSxfX2VtYmluZF9yZWdpc3Rlcl9lbXZhbDpmdW5jdGlvbihlLHQpe1llKGUse25hbWU6dD16ZSh0KSxmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7dmFyIHQ9a3RbZV0udmFsdWU7cmV0dXJuIGZ1bmN0aW9uKGUpe2U+NCYmMD09LS1rdFtlXS5yZWZjb3VudCYmKGt0W2VdPXZvaWQgMCxTdC5wdXNoKGUpKX0oZSksdH0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe3JldHVybiBSdCh0KX0sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpSZSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9mbG9hdDpmdW5jdGlvbihlLHQscil7dmFyIG49amUocik7WWUoZSx7bmFtZTp0PXplKHQpLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gZX0sdG9XaXJlVHlwZTpmdW5jdGlvbihlLHQpe2lmKCJudW1iZXIiIT10eXBlb2YgdCYmImJvb2xlYW4iIT10eXBlb2YgdCl0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCAiJytPdCh0KSsnIiB0byAnK3RoaXMubmFtZSk7cmV0dXJuIHR9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6Q3QodCxuKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9pbnRlZ2VyOmZ1bmN0aW9uKGUsdCxyLG4sbyl7dD16ZSh0KSwtMT09PW8mJihvPTQyOTQ5NjcyOTUpO3ZhciBpPWplKHIpLGE9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9O2lmKDA9PT1uKXt2YXIgcz0zMi04KnI7YT1mdW5jdGlvbihlKXtyZXR1cm4gZTw8cz4+PnN9fXZhciB1PS0xIT10LmluZGV4T2YoInVuc2lnbmVkIik7WWUoZSx7bmFtZTp0LGZyb21XaXJlVHlwZTphLHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSxyKXtpZigibnVtYmVyIiE9dHlwZW9mIHImJiJib29sZWFuIiE9dHlwZW9mIHIpdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgIicrT3QocikrJyIgdG8gJyt0aGlzLm5hbWUpO2lmKHI8bnx8cj5vKXRocm93IG5ldyBUeXBlRXJyb3IoJ1Bhc3NpbmcgYSBudW1iZXIgIicrT3QocikrJyIgZnJvbSBKUyBzaWRlIHRvIEMvQysrIHNpZGUgdG8gYW4gYXJndW1lbnQgb2YgdHlwZSAiJyt0KyciLCB3aGljaCBpcyBvdXRzaWRlIHRoZSB2YWxpZCByYW5nZSBbJytuKyIsICIrbysiXSEiKTtyZXR1cm4gdT9yPj4+MDowfHJ9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6TnQodCxpLDAhPT1uKSxkZXN0cnVjdG9yRnVuY3Rpb246bnVsbH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9tZW1vcnlfdmlldzpmdW5jdGlvbihlLHQscil7dmFyIG49W0ludDhBcnJheSxVaW50OEFycmF5LEludDE2QXJyYXksVWludDE2QXJyYXksSW50MzJBcnJheSxVaW50MzJBcnJheSxGbG9hdDMyQXJyYXksRmxvYXQ2NEFycmF5XVt0XTtmdW5jdGlvbiBvKGUpe3ZhciB0PU0scj10W2U+Pj0yXSxvPXRbZSsxXTtyZXR1cm4gbmV3IG4odC5idWZmZXIsbyxyKX1ZZShlLHtuYW1lOnI9emUociksZnJvbVdpcmVUeXBlOm8sYXJnUGFja0FkdmFuY2U6OCxyZWFkVmFsdWVGcm9tUG9pbnRlcjpvfSx7aWdub3JlRHVwbGljYXRlUmVnaXN0cmF0aW9uczohMH0pfSxfX2VtYmluZF9yZWdpc3Rlcl9zdGRfc3RyaW5nOmZ1bmN0aW9uKGUsdCl7WWUoZSx7bmFtZTp0PXplKHQpLGZyb21XaXJlVHlwZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9TVtlPj4yXSxyPW5ldyBBcnJheSh0KSxuPTA7bjx0OysrbilyW25dPVN0cmluZy5mcm9tQ2hhckNvZGUoT1tlKzQrbl0pO3JldHVybiBLdChlKSxyLmpvaW4oIiIpfSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gcihlLHQpe3JldHVybiBlW3RdfXZhciBuO3QgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmKHQ9bmV3IFVpbnQ4QXJyYXkodCkpLHQgaW5zdGFuY2VvZiBVaW50OEFycmF5fHx0IGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQ4QXJyYXk/bj1yOiJzdHJpbmciPT10eXBlb2YgdD9uPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUuY2hhckNvZGVBdCh0KX06V2UoIkNhbm5vdCBwYXNzIG5vbi1zdHJpbmcgdG8gc3RkOjpzdHJpbmciKTt2YXIgbz10Lmxlbmd0aCxpPUp0KDQrbyk7TVtpPj4yXT1vO2Zvcih2YXIgYT0wO2E8bzsrK2Epe3ZhciBzPW4odCxhKTtzPjI1NSYmKEt0KGkpLFdlKCJTdHJpbmcgaGFzIFVURi0xNiBjb2RlIHVuaXRzIHRoYXQgZG8gbm90IGZpdCBpbiA4IGJpdHMiKSksT1tpKzQrYV09c31yZXR1cm4gbnVsbCE9PWUmJmUucHVzaChLdCxpKSxpfSxhcmdQYWNrQWR2YW5jZTo4LHJlYWRWYWx1ZUZyb21Qb2ludGVyOlJlLGRlc3RydWN0b3JGdW5jdGlvbjpmdW5jdGlvbihlKXtLdChlKX19KX0sX19lbWJpbmRfcmVnaXN0ZXJfc3RkX3dzdHJpbmc6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG87cj16ZShyKSwyPT09dD8obj1mdW5jdGlvbigpe3JldHVybiBOfSxvPTEpOjQ9PT10JiYobj1mdW5jdGlvbigpe3JldHVybiBNfSxvPTIpLFllKGUse25hbWU6cixmcm9tV2lyZVR5cGU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PW4oKSxyPU1bZT4+Ml0saT1uZXcgQXJyYXkociksYT1lKzQ+Pm8scz0wO3M8cjsrK3MpaVtzXT1TdHJpbmcuZnJvbUNoYXJDb2RlKHRbYStzXSk7cmV0dXJuIEt0KGUpLGkuam9pbigiIil9LHRvV2lyZVR5cGU6ZnVuY3Rpb24oZSxyKXt2YXIgaT1uKCksYT1yLmxlbmd0aCxzPUp0KDQrYSp0KTtNW3M+PjJdPWE7Zm9yKHZhciB1PXMrND4+byxjPTA7YzxhOysrYylpW3UrY109ci5jaGFyQ29kZUF0KGMpO3JldHVybiBudWxsIT09ZSYmZS5wdXNoKEt0LHMpLHN9LGFyZ1BhY2tBZHZhbmNlOjgscmVhZFZhbHVlRnJvbVBvaW50ZXI6UmUsZGVzdHJ1Y3RvckZ1bmN0aW9uOmZ1bmN0aW9uKGUpe0t0KGUpfX0pfSxfX2VtYmluZF9yZWdpc3Rlcl92YWx1ZV9vYmplY3Q6ZnVuY3Rpb24oZSx0LHIsbixvLGkpe1BlW2VdPXtuYW1lOnplKHQpLHJhd0NvbnN0cnVjdG9yOnZ0KHIsbikscmF3RGVzdHJ1Y3Rvcjp2dChvLGkpLGZpZWxkczpbXX19LF9fZW1iaW5kX3JlZ2lzdGVyX3ZhbHVlX29iamVjdF9maWVsZDpmdW5jdGlvbihlLHQscixuLG8saSxhLHMsdSxjKXtQZVtlXS5maWVsZHMucHVzaCh7ZmllbGROYW1lOnplKHQpLGdldHRlclJldHVyblR5cGU6cixnZXR0ZXI6dnQobixvKSxnZXR0ZXJDb250ZXh0Omksc2V0dGVyQXJndW1lbnRUeXBlOmEsc2V0dGVyOnZ0KHMsdSksc2V0dGVyQ29udGV4dDpjfSl9LF9fZW1iaW5kX3JlZ2lzdGVyX3ZvaWQ6ZnVuY3Rpb24oZSx0KXtZZShlLHtpc1ZvaWQ6ITAsbmFtZTp0PXplKHQpLGFyZ1BhY2tBZHZhbmNlOjAsZnJvbVdpcmVUeXBlOmZ1bmN0aW9uKCl7fSx0b1dpcmVUeXBlOmZ1bmN0aW9uKGUsdCl7fX0pfSxfYWJvcnQ6ZnVuY3Rpb24oKXtvLmFib3J0KCl9LF9lbXNjcmlwdGVuX21lbWNweV9iaWc6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBPLnNldChPLnN1YmFycmF5KHQsdCtyKSxlKSxlfSxfZ2V0ZW52OmZ1bmN0aW9uIGUodCl7cmV0dXJuIDA9PT10PzA6KHQ9dih0KSxNdC5oYXNPd25Qcm9wZXJ0eSh0KT8oZS5yZXQmJkt0KGUucmV0KSxlLnJldD0ocj1NdFt0XSxuPVMocikrMSwobz1KdChuKSkmJkEocixSLG8sbiksbykpOjApO3ZhciByLG4sb30sX2dldGdybmFtOmZ1bmN0aW9uKCl7by5wcmludEVycigibWlzc2luZyBmdW5jdGlvbjogZ2V0Z3JuYW0iKSxycigtMSl9LF9nZXRwd25hbTpmdW5jdGlvbigpe3Rocm93ImdldHB3bmFtOiBUT0RPIn0sX2pzQ2xvc2U6ZnVuY3Rpb24oKXtyZXR1cm4gYS5jbG9zZS5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9qc0NyZWF0ZTpmdW5jdGlvbihlKXtyZXR1cm4gYS5jcmVhdGUuY2FsbChudWxsLGsoZSkpfSxfanNPcGVuOmZ1bmN0aW9uKGUpe3JldHVybiBhLm9wZW4uY2FsbChudWxsLGsoZSkpfSxfanNSZWFkOmZ1bmN0aW9uKCl7cmV0dXJuIGEucmVhZC5hcHBseShudWxsLGFyZ3VtZW50cyl9LF9qc1NlZWs6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBhLnNlZWsuY2FsbChudWxsLGUsdCxiKHIpKX0sX2pzVGVsbDpmdW5jdGlvbigpe3JldHVybiBhLnRlbGwuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxfanNXcml0ZTpmdW5jdGlvbigpe3JldHVybiBhLndyaXRlLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sX2xsdm1fZWhfdHlwZWlkX2ZvcjpmdW5jdGlvbihlKXtyZXR1cm4gZX0sX2xvY2FsdGltZTpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oZSx0KXtqdCgpO3ZhciByPW5ldyBEYXRlKDFlMypGW2U+PjJdKTtGW3Q+PjJdPXIuZ2V0U2Vjb25kcygpLEZbdCs0Pj4yXT1yLmdldE1pbnV0ZXMoKSxGW3QrOD4+Ml09ci5nZXRIb3VycygpLEZbdCsxMj4+Ml09ci5nZXREYXRlKCksRlt0KzE2Pj4yXT1yLmdldE1vbnRoKCksRlt0KzIwPj4yXT1yLmdldEZ1bGxZZWFyKCktMTkwMCxGW3QrMjQ+PjJdPXIuZ2V0RGF5KCk7dmFyIG49bmV3IERhdGUoci5nZXRGdWxsWWVhcigpLDAsMSksbz0oci5nZXRUaW1lKCktbi5nZXRUaW1lKCkpLzg2NGU1fDA7Rlt0KzI4Pj4yXT1vLEZbdCszNj4+Ml09LTYwKnIuZ2V0VGltZXpvbmVPZmZzZXQoKTt2YXIgaT1uZXcgRGF0ZSgyZTMsNiwxKS5nZXRUaW1lem9uZU9mZnNldCgpLGE9bi5nZXRUaW1lem9uZU9mZnNldCgpLHM9MHwoaSE9YSYmci5nZXRUaW1lem9uZU9mZnNldCgpPT1NYXRoLm1pbihhLGkpKTtGW3QrMzI+PjJdPXM7dmFyIHU9RltCdCsocz80OjApPj4yXTtyZXR1cm4gRlt0KzQwPj4yXT11LHR9KGUsSXQpfSxfbWt0aW1lOmZ1bmN0aW9uKGUpe2p0KCk7dmFyIHQ9bmV3IERhdGUoRltlKzIwPj4yXSsxOTAwLEZbZSsxNj4+Ml0sRltlKzEyPj4yXSxGW2UrOD4+Ml0sRltlKzQ+PjJdLEZbZT4+Ml0sMCkscj1GW2UrMzI+PjJdLG49dC5nZXRUaW1lem9uZU9mZnNldCgpLG89bmV3IERhdGUodC5nZXRGdWxsWWVhcigpLDAsMSksaT1uZXcgRGF0ZSgyZTMsNiwxKS5nZXRUaW1lem9uZU9mZnNldCgpLGE9by5nZXRUaW1lem9uZU9mZnNldCgpLHM9TWF0aC5taW4oYSxpKTtpZihyPDApRltlKzMyPj4yXT1OdW1iZXIoaSE9YSYmcz09bik7ZWxzZSBpZihyPjAhPShzPT1uKSl7dmFyIHU9TWF0aC5tYXgoYSxpKSxjPXI+MD9zOnU7dC5zZXRUaW1lKHQuZ2V0VGltZSgpKzZlNCooYy1uKSl9RltlKzI0Pj4yXT10LmdldERheSgpO3ZhciBsPSh0LmdldFRpbWUoKS1vLmdldFRpbWUoKSkvODY0ZTV8MDtyZXR1cm4gRltlKzI4Pj4yXT1sLHQuZ2V0VGltZSgpLzFlM3wwfSxfcHRocmVhZF9nZXRzcGVjaWZpYzpmdW5jdGlvbihlKXtyZXR1cm4gVXRbZV18fDB9LF9wdGhyZWFkX2tleV9jcmVhdGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gMD09ZT9tZS5FSU5WQUw6KEZbZT4+Ml09enQsVXRbenRdPTAsenQrKywwKX0sX3B0aHJlYWRfb25jZTpmdW5jdGlvbiBlKHQscil7ZS5zZWVufHwoZS5zZWVuPXt9KSx0IGluIGUuc2Vlbnx8KG8uZHluQ2FsbF92KHIpLGUuc2Vlblt0XT0xKX0sX3B0aHJlYWRfc2V0c3BlY2lmaWM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSBpbiBVdD8oVXRbZV09dCwwKTptZS5FSU5WQUx9LF90aW1lOmZ1bmN0aW9uKGUpe3ZhciB0PURhdGUubm93KCkvMWUzfDA7cmV0dXJuIGUmJihGW2U+PjJdPXQpLHR9LERZTkFNSUNUT1BfUFRSOiQsU1RBQ0tUT1A6VX07dmFyIFd0PW8uYXNtKG8uYXNtR2xvYmFsQXJnLG8uYXNtTGlicmFyeUFyZyxEKTtvLmFzbT1XdDt2YXIgWXQ9by5fX0dMT0JBTF9fc3ViX0lfYmluZF9jcHA9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uX19HTE9CQUxfX3N1Yl9JX2JpbmRfY3BwLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sVnQ9by5fX0dMT0JBTF9fc3ViX0lfYnJpZGdlX2NwcD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fX0dMT0JBTF9fc3ViX0lfYnJpZGdlX2NwcC5hcHBseShudWxsLGFyZ3VtZW50cyl9LEh0PW8uX19HTE9CQUxfX3N1Yl9JX2NyY19jcHA9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uX19HTE9CQUxfX3N1Yl9JX2NyY19jcHAuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxHdD1vLl9fR0xPQkFMX19zdWJfSV9nbG9iYWxfY3BwPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9fR0xPQkFMX19zdWJfSV9nbG9iYWxfY3BwLmFwcGx5KG51bGwsYXJndW1lbnRzKX0scXQ9KG8uX19fY3hhX2Nhbl9jYXRjaD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fX19jeGFfY2FuX2NhdGNoLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5fX19jeGFfaXNfcG9pbnRlcl90eXBlPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9fX2N4YV9pc19wb2ludGVyX3R5cGUuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLl9fX2Vycm5vX2xvY2F0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9fX2Vycm5vX2xvY2F0aW9uLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5fX19nZXRUeXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fX19nZXRUeXBlTmFtZS5hcHBseShudWxsLGFyZ3VtZW50cyl9KSxYdD1vLl9lbXNjcmlwdGVuX3JlcGxhY2VfbWVtb3J5PWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLl9lbXNjcmlwdGVuX3JlcGxhY2VfbWVtb3J5LmFwcGx5KG51bGwsYXJndW1lbnRzKX0sS3Q9by5fZnJlZT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fZnJlZS5hcHBseShudWxsLGFyZ3VtZW50cyl9LEp0PW8uX21hbGxvYz1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5fbWFsbG9jLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sWnQ9by5zZXRUZW1wUmV0MD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5zZXRUZW1wUmV0MC5hcHBseShudWxsLGFyZ3VtZW50cyl9LFF0PShvLnNldFRocmV3PWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLnNldFRocmV3LmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5zdGFja0FsbG9jPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLnN0YWNrQWxsb2MuYXBwbHkobnVsbCxhcmd1bWVudHMpfSk7by5keW5DYWxsX2RpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2RpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9pPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5keW5DYWxsX2lpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpaWlpLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5keW5DYWxsX2lpaWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX2lpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaWlpPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWlpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaWlpaWlpPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWlpaWlpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF9paWlpaWlqaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF9paWlpaWlqaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfaWpqPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfaWpqLmFwcGx5KG51bGwsYXJndW1lbnRzKX0sby5keW5DYWxsX2ppPWZ1bmN0aW9uKCl7cmV0dXJuIG8uYXNtLmR5bkNhbGxfamkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdj1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3YuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF92aWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpZD1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWQuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF92aWlpaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWlpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWlpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWlpaWlpaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpaWlpaWlpaWkuYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlpaWlpaWlpaWk9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWlpaWlpaWlpaS5hcHBseShudWxsLGFyZ3VtZW50cyl9LG8uZHluQ2FsbF92aWo9ZnVuY3Rpb24oKXtyZXR1cm4gby5hc20uZHluQ2FsbF92aWouYXBwbHkobnVsbCxhcmd1bWVudHMpfSxvLmR5bkNhbGxfdmlqaT1mdW5jdGlvbigpe3JldHVybiBvLmFzbS5keW5DYWxsX3ZpamkuYXBwbHkobnVsbCxhcmd1bWVudHMpfTtmdW5jdGlvbiBlcihlKXt0aGlzLm5hbWU9IkV4aXRTdGF0dXMiLHRoaXMubWVzc2FnZT0iUHJvZ3JhbSB0ZXJtaW5hdGVkIHdpdGggZXhpdCgiK2UrIikiLHRoaXMuc3RhdHVzPWV9ZnVuY3Rpb24gdHIoZSl7ZnVuY3Rpb24gdCgpe28uY2FsbGVkUnVufHwoby5jYWxsZWRSdW49ITAsbXx8KHRlfHwodGU9ITAsWChKKSksWChaKSxvLm9uUnVudGltZUluaXRpYWxpemVkJiZvLm9uUnVudGltZUluaXRpYWxpemVkKCksZnVuY3Rpb24oKXtpZihvLnBvc3RSdW4pZm9yKCJmdW5jdGlvbiI9PXR5cGVvZiBvLnBvc3RSdW4mJihvLnBvc3RSdW49W28ucG9zdFJ1bl0pO28ucG9zdFJ1bi5sZW5ndGg7KWU9by5wb3N0UnVuLnNoaWZ0KCksZWUudW5zaGlmdChlKTt2YXIgZTtYKGVlKX0oKSkpfXNlPjB8fCghZnVuY3Rpb24oKXtpZihvLnByZVJ1bilmb3IoImZ1bmN0aW9uIj09dHlwZW9mIG8ucHJlUnVuJiYoby5wcmVSdW49W28ucHJlUnVuXSk7by5wcmVSdW4ubGVuZ3RoOyllPW8ucHJlUnVuLnNoaWZ0KCksSy51bnNoaWZ0KGUpO3ZhciBlO1goSyl9KCksc2U+MHx8by5jYWxsZWRSdW58fChvLnNldFN0YXR1cz8oby5zZXRTdGF0dXMoIlJ1bm5pbmcuLi4iKSxzZXRUaW1lb3V0KChmdW5jdGlvbigpe3NldFRpbWVvdXQoKGZ1bmN0aW9uKCl7by5zZXRTdGF0dXMoIiIpfSksMSksdCgpfSksMSkpOnQoKSkpfWZ1bmN0aW9uIHJyKGUpe3Rocm93IG8ub25BYm9ydCYmby5vbkFib3J0KGUpLHZvaWQgMCE9PWU/KG8ucHJpbnQoZSksby5wcmludEVycihlKSxlPUpTT04uc3RyaW5naWZ5KGUpKTplPSIiLG09ITAsImFib3J0KCIrZSsiKS4gQnVpbGQgd2l0aCAtcyBBU1NFUlRJT05TPTEgZm9yIG1vcmUgaW5mby4ifWlmKG8uYXNtPVd0LGVyLnByb3RvdHlwZT1uZXcgRXJyb3IsZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yPWVyLHVlPWZ1bmN0aW9uIGUoKXtvLmNhbGxlZFJ1bnx8dHIoKSxvLmNhbGxlZFJ1bnx8KHVlPWUpfSxvLnJ1bj10cixvLmV4aXQ9ZnVuY3Rpb24oZSx0KXt0JiZvLm5vRXhpdFJ1bnRpbWUmJjA9PT1lfHwoby5ub0V4aXRSdW50aW1lfHwobT0hMCxVPXZvaWQgMCxYKFEpLG8ub25FeGl0JiZvLm9uRXhpdChlKSksbCYmcHJvY2Vzcy5leGl0KGUpLG8ucXVpdChlLG5ldyBlcihlKSkpfSxvLmFib3J0PXJyLG8ucHJlSW5pdClmb3IoImZ1bmN0aW9uIj09dHlwZW9mIG8ucHJlSW5pdCYmKG8ucHJlSW5pdD1bby5wcmVJbml0XSk7by5wcmVJbml0Lmxlbmd0aD4wOylvLnByZUluaXQucG9wKCkoKTtyZXR1cm4gby5ub0V4aXRSdW50aW1lPSEwLHRyKCksdH07ZnVuY3Rpb24gaSh7cmVzb3VyY2VJZDplLHVybDp0fSl7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihlLG8pe2lmKCFyKXRocm93IG5ldyBFcnJvcigidW5wYWNrQnJpZGdlIG5vdCBkZXRlY3RlZCIpO2lmKCFuKXRocm93IG5ldyBFcnJvcigidW5wYWNrIG5vdCBkZXRlY3RlZCIpOyhmdW5jdGlvbihlKXtyZXR1cm4gZmV0Y2gobmV3IFJlcXVlc3QoZSkpLnRoZW4oZT0+e2lmKGUub2spcmV0dXJuIGUuYXJyYXlCdWZmZXIoKTt0aHJvdyBuZXcgRXJyb3IoIjQwNCBFcnJvcjogRmlsZSBub3QgZm91bmQuIil9KS50aGVuKGU9PnIuY3JlYXRlRXh0cmFjdG9yRnJvbURhdGEoZSkpfSkodCkudGhlbih0PT57ZSh0LmV4dHJhY3RBbGwoKSl9LGU9PntvKGUpfSl9KSl9ZnVuY3Rpb24gYShlLHQpe2NvbnN0W3Isbl09dDtpZigiRkFJTCI9PXIuc3RhdGUpe2NvbnN0IHQ9e3R5cGU6IkVSUk9SIixyZWFzb246ci5yZWFzb24sbXNnOnIubXNnLHJlc291cmNlSWQ6ZS5kYXRhLnJlc291cmNlSWQsdXJsOmUuZGF0YS51cmx9O3JldHVybiB2b2lkIHNlbGYucG9zdE1lc3NhZ2UodCl9Y29uc3Qgbz17dHlwZToiRklOSVNIRUQiLHJlc291cmNlSWQ6ZS5kYXRhLnJlc291cmNlSWQsZW50cmllczp7fX0saT1bXTtpZihuJiZuLmZpbGVzKWZvcihjb25zdCBlIG9mIG4uZmlsZXMpby5lbnRyaWVzW2UuZmlsZUhlYWRlci5uYW1lXT1lLmV4dHJhY3RbMV0saS5wdXNoKGUuZXh0cmFjdFsxXS5idWZmZXIpO3NlbGYucG9zdE1lc3NhZ2UobyxpKX1vbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7aWYoImluaXQiPT1lLmRhdGEudHlwZSluPW8oZS5kYXRhLndhc21VcmwpLG4ub25SdW50aW1lSW5pdGlhbGl6ZWQ9KCk9PnBvc3RNZXNzYWdlKHt0eXBlOiJXQVNNX0xPQURFRCJ9KTtlbHNlIGlmKCJmZXRjaCI9PWUuZGF0YS50eXBlKWkoZS5kYXRhKS50aGVuKHQ9PnthKGUsdCl9LHQ9Pntjb25zdCByPXt0eXBlOiJFUlJPUiIscmVzb3VyY2VJZDplLmRhdGEucmVzb3VyY2VJZCx1cmw6ZS5kYXRhLnVybH07c2VsZi5wb3N0TWVzc2FnZShyKX0pO2Vsc2UgaWYoInVucGFjayI9PWUuZGF0YS50eXBlKXtjb25zdHtidWZmZXI6dH09ZS5kYXRhO2lmKCFyKXRocm93IG5ldyBFcnJvcigidW5wYWNrQnJpZGdlIG5vdCBkZXRlY3RlZCIpO2lmKCFuKXRocm93IG5ldyBFcnJvcigidW5wYWNrIG5vdCBkZXRlY3RlZCIpO2NvbnN0IG89ci5jcmVhdGVFeHRyYWN0b3JGcm9tRGF0YSh0KS5leHRyYWN0QWxsKCk7YShlLG8pfX07Cgo=",null,!1);function me$1(t){return t&&"object"==typeof t&&!Array.isArray(t)}function ue$1(t,...e){if(!e.length)return t;const i=e.shift();if(me$1(t)&&me$1(i))for(const n in i)me$1(i[n])?(t[n]||Object.assign(t,{[n]:{}}),ue$1(t[n],i[n])):Object.assign(t,{[n]:i[n]});return ue$1(t,...e)}const be$1=new class{constructor(){let t;this.loaded=new C$1,this.progressIncremented=new C$1,this.allResourcesLoaded=new C$1,this.fileUpdated=new C$1,this.__totalWork=0,this.__totalWorkByCategory={},this.__doneWork=0,this.__doneWorkByCategory={},this.__resourceRegisterCallbacks={},this.__callbacks={},this.__resources={},this.__resourcesTreeEntities={},this.__resourcesTree={children:{}},this.__workers=[],this.__nextWorker=0;const e=document.getElementsByTagName("script");for(let i=0;i<e.length;i++){const n=e[i];if(n.src.includes("zea-engine")){const e=n.src.split("/");e.pop(),e.pop(),t=e.join("/");break}}t||(t="https://unpkg.com/@zeainc/zea-engine@0.1.3"),this.wasmUrl=t+"/public-resources/unpack.wasm",this.addResourceURL("ZeaEngine/Vive.vla",t+"/public-resources/Vive.vla"),this.addResourceURL("ZeaEngine/Oculus.vla",t+"/public-resources/Oculus.vla")}getRootFolder(){return this.__resourcesTree}registerResourceCallback(t,e){this.__resourceRegisterCallbacks[t]=e;for(const i in this.__resources){const n=this.__resources[i];n.name.includes(t)&&e(n)}}__applyCallbacks(t){const e=t=>{for(const e in this.__resourceRegisterCallbacks)t.name.includes(e)&&this.__resourceRegisterCallbacks[e](t)};for(const i in t){const n=t[i];n.url&&e(n)}}__buildTree(t){const e=i=>{if(this.__resourcesTreeEntities[i])return;const n=t[i];n.id=i,"folder"!==n.type&&"dependency"!==n.type||(n.children={}),n.parent&&(this.__resourcesTreeEntities[n.parent]||e(n.parent)),(n.parent?this.__resourcesTreeEntities[n.parent]:this.__resourcesTree).children[n.name]=n,this.__resourcesTreeEntities[i]=n};for(const i in t)e(i)}setResources(t){this.__resources=Object.assign(this.__resources,t),this.__buildTree(t),this.__applyCallbacks(t)}addResourceURL(t,e){const i=t.split("/"),n=i.pop();if(!e){let n=window.location.href.split("#")[0];n=n.split("?")[0],(n.endsWith(".html")||n.endsWith(".html"))&&(n=n.substring(0,n.lastIndexOf("/"))+"/");const s=n;if("."==i[0])i.shift();else if(".."==i[0]){item=item.substring(3);const t=s.split("/");t.pop(),t.pop(),s=t.join("/")+"/"}e=s+t}let s;const o={};for(const l of i){const t=m$3(l);t in this.__resources||(this.__resources[t]={name:l,type:"folder",parent:s},o[t]=this.__resources[t]),s=t}const r=m$3(n),a={name:n,url:e,parent:s,id:r};this.__resources[r]=a,o[r]=a,this.__buildTree(o),this.__applyCallbacks(o)}updateFile(t){const e=!(t.id in this.__resources);if(this.__resources[t.id]=t,e){console.log("New file added");const e={};e[t.id]=t,this.__buildTree(e)}this.fileUpdated.emit(t.id)}freeData(t){}__getWorker(){return this.__nextWorker=(this.__nextWorker+1)%3,null==this.__workers[this.__nextWorker]&&(this.__workers[this.__nextWorker]=(()=>new Promise(t=>{const e=new ce$1;e.postMessage({type:"init",wasmUrl:this.wasmUrl}),e.onmessage=i=>{if("WASM_LOADED"===i.data.type)t(e);else if("FINISHED"===i.data.type)this.addWorkDone(i.data.resourceId,1),this.__onFinishedReceiveFileData(i.data);else if("ERROR"===i.data.type){const t=i.data,e=this.__resources[t.resourceId];console.error("Unable to load Resource:",e?e.name:t.resourceId," With url:",t.url)}}}))()),this.__workers[this.__nextWorker]}__terminateWorkers(){for(const t of this.__workers)t.terminate();this.__workers=[]}getFilepath(t){let e=this.__resources[t];const i=[e.name];for(;e.parent;)e=this.__resources[e.parent],i.splice(0,0,e.name);return i.join("/")}resourceAvailable(t){return t.indexOf(".")>0?(console.warn("Deprecation warning for resourceAvailable. Value should be a file id, not a path."),null!=this.resolveFilepath(t)):t in this.__resources}getFile(t){return this.__resources[t]}resolveFilePathToId(t){if(!t)return void console.warn("Invalid file path:",t);const e=this.resolveFilepath(t);return e?e.id:void 0}resolveFilepath(t){const e=t.split("/");"."!=e[0]&&""!=e[0]||e.shift();let i=this.__resourcesTree;for(const n of e){if(!(n in i.children))return console.warn("Unable to resolve key:"+n+" of path:"+t),null;i=i.children[n]}return i}resolveFile(t){return console.warn("Deprecation warning for resolveFile. Use resolveFilepath."),this.resolveFilepath(t)}resolveURL(t){console.warn("Deprecation warning for resolveURL. Use resolveFilepath.");const e=this.resolveFilepath(t);if(e)return e.url}addWork(t,e){this.__totalWork+=e,this.progressIncremented.emit(this.__doneWork/this.__totalWork*100)}addWorkDone(t,e){if(this.__doneWork+=e,this.progressIncremented.emit(this.__doneWork/this.__totalWork*100),this.__doneWork>this.__totalWork)throw new Error("Mismatch between work loaded and work done.");this.__doneWork==this.__totalWork&&this.allResourcesLoaded.emit()}loadResource(t,e,i=!0){const n=this.getFile(t);if(!n)throw new Error("Invalid resource Id:'"+t+"' not found in Resources:"+JSON.stringify(this.__resources,null,2));this.loadUrl(t,n.url,e,i)}loadURL(t,e,i,n=!0){return console.warn("Please call loadUrl instead,"),this.loadUrl(t,e,i,n)}loadUrl(t,e,i,n=!0){n&&this.addWork(t,3),t in this.__callbacks||(this.__callbacks[t]=[]),this.__callbacks[t].push(i),fetch(e).then(t=>function(t){if(!t.ok)throw new Error(`HTTP ${t.status} - ${t.statusText}`);return t}(t)&&t.arrayBuffer()).then(e=>{this.__getWorker().then(i=>{i.postMessage({type:"unpack",resourceId:t,buffer:e})})})}unpackBuffer(t,e,i,n=!0){return new Promise(s=>{n&&this.addWork(t,3),t in this.__callbacks||(this.__callbacks[t]=[]),i&&this.__callbacks[t].push(i),this.__callbacks[t].push(t=>{s(t)}),this.__getWorker().then(i=>{i.postMessage({type:"unpack",resourceId:t,buffer:e},[e])})})}__onFinishedReceiveFileData(t){const e=t.resourceId;this.addWorkDone(e,1);const i=this.__callbacks[e];if(i){for(const e of i)e(t.entries);delete this.__callbacks[e]}this.loaded.emit(e),this.addWorkDone(e,1)}suspend(){this.__terminateWorkers()}traverse(t){const e=t=>{for(const e in t.children)i(t.children[e])},i=i=>{if(0==t(i))return!1;i.children&&e(i)};e(this.__resourcesTree)}};class pe$1{constructor(t){if(t){const e=t.split("-"),i=e[0].split(".");this.major=parseInt(i[0]),this.minor=parseInt(i[1]),this.patch=parseInt(i[2]),2==e.length&&(this.branch=e[1])}else this.major=0,this.minor=0,this.patch=0}equals(t){return!(this.patch==t[2]&&this.minor==t[1]&&this.major==t[0])}lessThan(t){return!(this.major>=t[0]||this.minor>=t[1]||this.patch>=t[2])}greaterThan(t){return this.major>t[0]||this.minor>t[1]||this.patch>t[2]}greaterOrEqualThan(t){return!(this.major<t[0]||!(this.major>t[0])&&(this.minor<t[1]||!(this.minor>t[1])&&this.patch<t[2]))}}class ge$1{constructor(t,e=0,i=!0){this.__data=t,this.__byteOffset=e,this.__dataView=new DataView(this.__data),this.__isMobileDevice=i,this.utf8decoder=new TextDecoder}get isMobileDevice(){return this.__isMobileDevice}get data(){return this.__data}get byteLength(){return this.__dataView.byteLength}get remainingByteLength(){return this.__dataView.byteLength-this.__byteOffset}pos(){return this.__byteOffset}seek(t){this.__byteOffset=t}advance(t){this.__byteOffset+=t}loadUInt8(){const t=this.__dataView.getUint8(this.__byteOffset);return this.__byteOffset+=1,t}loadUInt16(){const t=this.__dataView.getUint16(this.__byteOffset,!0);return this.__byteOffset+=2,t}loadUInt32(){const t=this.__dataView.getUint32(this.__byteOffset,!0);return this.__byteOffset+=4,t}loadSInt32(){const t=this.__dataView.getInt32(this.__byteOffset,!0);return this.__byteOffset+=4,t}loadFloat16(){const t=this.loadUInt16();return Math.decode16BitFloat(t)}loadUFloat16(){const t=this.loadFloat16();return t<0?2048-t:t}loadFloat16From2xUInt8(){const t=this.__dataView.getFloat16(this.__byteOffset,!0);return this.__byteOffset+=2,t}loadUInt32From2xUFloat16(){return this.loadUFloat16()+4096*this.loadUFloat16()}loadSInt32From2xFloat16(){return this.loadFloat16()+2048*this.loadFloat16()}loadFloat32(){const t=this.__dataView.getFloat32(this.__byteOffset,!0);return this.__byteOffset+=4,t}loadUInt8Array(t,e=!1){null==t&&(t=this.loadUInt32());const i=new Uint8Array(this.__data,this.__byteOffset,t);return this.__byteOffset+=t,i}loadUInt16Array(t,e=!1){if(null==t&&(t=this.loadUInt32()),0==t)return new Uint16Array;let i;if(this.readPadd(2),this.__isMobileDevice){i=new Uint16Array(t);for(let e=0;e<t;e++)i[e]=this.__dataView.getUint16(this.__byteOffset,!0),this.__byteOffset+=2}else i=new Uint16Array(this.__data,this.__byteOffset,t),this.__byteOffset+=2*t;return i}loadUInt32Array(t,e=!1){if(null==t&&(t=this.loadUInt32()),0==t)return new Uint32Array;let i;if(this.readPadd(4),this.__isMobileDevice){i=new Uint32Array(t);for(let e=0;e<t;e++)i[e]=this.__dataView.getUint32(this.__byteOffset,!0),this.__byteOffset+=4}else i=new Uint32Array(this.__data,this.__byteOffset,t),this.__byteOffset+=4*t;return i}loadFloat32Array(t,e=!1){if(null==t&&(t=this.loadUInt32()),0==t)return new Float32Array;let i;if(this.readPadd(4),this.__isMobileDevice){i=new Float32Array(t);for(let e=0;e<t;e++)i[e]=this.__dataView.getFloat32(this.__byteOffset,!0),this.__byteOffset+=4}else i=new Float32Array(this.__data,this.__byteOffset,t),this.__byteOffset+=4*t;return i}loadStr(){const t=this.loadUInt32(),e=new Uint8Array(this.__data,this.__byteOffset,t);return this.__byteOffset+=t,this.utf8decoder.decode(e)}loadStrArray(){const t=this.loadUInt32(),e=[];for(let i=0;i<t;i++)e[i]=this.loadStr();return e}loadSInt32Vec2(){const t=this.loadSInt32(),e=this.loadSInt32();return new _$1(t,e)}loadUInt32Vec2(){const t=this.loadUInt32(),e=this.loadUInt32();return new _$1(t,e)}loadFloat16Vec2(){const t=this.loadFloat16(),e=this.loadFloat16();return new _$1(t,e)}loadFloat32Vec2(){const t=this.loadFloat32(),e=this.loadFloat32();return new _$1(t,e)}loadFloat16Vec3(){const t=this.loadFloat16(),e=this.loadFloat16(),i=this.loadFloat16();return new Z$1(t,e,i)}loadFloat32Vec3(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32();return new Z$1(t,e,i)}loadFloat16Quat(){const t=this.loadFloat16(),e=this.loadFloat16(),i=this.loadFloat16(),n=this.loadFloat16();return new R$1(t,e,i,n)}loadFloat32Quat(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32(),n=this.loadFloat32();return new R$1(t,e,i,n)}loadRGBFloat32Color(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32();return new y$3(t,e,i)}loadRGBAFloat32Color(){const t=this.loadFloat32(),e=this.loadFloat32(),i=this.loadFloat32(),n=this.loadFloat32();return new y$3(t,e,i,n)}loadRGBUInt8Color(){const t=this.loadUInt8(),e=this.loadUInt8(),i=this.loadUInt8();return new y$3(t/255,e/255,i/255)}loadRGBAUInt8Color(){const t=this.loadUInt8(),e=this.loadUInt8(),i=this.loadUInt8(),n=this.loadUInt8();return new y$3(t/255,e/255,i/255,n/255)}loadBox2(){return new W$1(this.loadFloat32Vec2(),this.loadFloat32Vec2())}loadBox3(){return new v$1(this.loadFloat32Vec3(),this.loadFloat32Vec3())}readPadd(t){const e=this.__byteOffset%t;0!=e&&(this.__byteOffset+=t-e)}}class _e$1{constructor(t=0){this.__data=new ArrayBuffer(t),this.__byteOffset=0,this.__reserved=t,this.__dataView=new DataView(this.__data)}pos(){return this.__byteOffset}seek(t){this.__byteOffset=t}seekEnd(){this.__byteOffset=this.__reserved}getBuffer(){return this.__data.byteLength==this.__byteOffset?this.__data:new Uint8Array(this.__data).slice(0,this.__byteOffset).buffer}__grow(){const t=2*(this.__reserved>0?this.__reserved:1),e=new ArrayBuffer(t),i=new Uint8Array(e),n=new Uint8Array(this.__data);i.set(n),this.__data=e,this.__dataView=new DataView(this.__data),this.__reserved=t}__reserve(t){this.__byteOffset+t>this.__reserved&&this.__grow()}__offset(t){this.__byteOffset+=t,this.__byteOffset>this.__reserved&&this.__grow()}writeUInt8(t){this.__reserve(1),this.__dataView.setUint8(this.__byteOffset,t),this.__offset(1)}writeUInt16(t){this.__reserve(2),this.__dataView.setUint16(this.__byteOffset,t,!0),this.__offset(2)}writeUInt32(t){this.__reserve(4),this.__dataView.setUint32(this.__byteOffset,t,!0),this.__offset(4)}writeSInt32(t){this.__reserve(4),this.__dataView.setInt32(this.__byteOffset,t,!0),this.__offset(4)}writeFloat16(t){const e=Math.encode16BitFloat(t);this.writeUInt16(e)}writeFloat32(t){this.__reserve(4),this.__dataView.setFloat32(this.__byteOffset,t,!0),this.__offset(4)}writeUInt8Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeUInt8(t[n])}writeUInt16Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(2*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeUInt16(t[n])}writeUInt32Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(4*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeUInt32(t[n])}writeFloat32Array(t,e=!0){const i=t.size?t.size:t.length;this.__reserve(4*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeFloat32(t[n])}writeStr(t,e=!0){const i=value.length;this.__reserve(4*i+(e?4:0)),e&&this.writeUInt32(i);for(let n=0;n<i;n++)this.writeFloat32(value.charCodeAt(n))}writeSInt32Vec2(t){this.writeSInt32(t.x),this.writeSInt32(t.y)}writeUInt32Vec2(t){this.writeUInt32(t.x),this.writeUInt32(t.y)}writeFloat16Vec2(t){this.writeFloat16(t.x),this.writeFloat16(t.y)}writeFloat32Vec2(t){this.writeFloat32(t.x),this.writeFloat32(t.y)}writeFloat16Vec3(t){this.writeFloat16(t.x),this.writeFloat16(t.y),this.writeFloat16(t.z)}writeFloat32Vec3(t){this.writeFloat32(t.x),this.writeFloat32(t.y),this.writeFloat32(t.z)}writeFloat16Quat(t){this.writeFloat16(t.x),this.writeFloat16(t.y),this.writeFloat16(t.z),this.writeFloat16(t.w)}writeFloat32Quat(t){this.writeFloat32(t.x),this.writeFloat32(t.y),this.writeFloat32(t.z),this.writeFloat32(t.w)}writeRGBFloat32Color(t){this.writeFloat32(t.r),this.writeFloat32(t.g),this.writeFloat32(t.b)}writeRGBAFloat32Color(t){this.writeFloat32(t.r),this.writeFloat32(t.g),this.writeFloat32(t.b),this.writeFloat32(t.a)}writeRGBUInt8Color(t){this.writeUInt8(t.r),this.writeUInt8(t.g),this.writeUInt8(t.b)}writeRGBAUInt8Color(t){this.writeUInt8(t.r),this.writeUInt8(t.g),this.writeUInt8(t.b),this.writeUInt8(t.a)}writeBox2(t){this.writeFloat32Vec2(t.p0),this.writeFloat32Vec2(t.p1)}writeBox3(t){this.writeFloat32Vec3(t.p0),this.writeFloat32Vec3(t.p1)}writePadd(t){const e=t-this.__byteOffset;this.__reserve(e),this.__offset(e)}writeAlignment(t){const e=this.__byteOffset%t;0!=e&&(this.__reserve(t-e),this.__offset(t-e))}}class Ze$1 extends Q$1{constructor(t,e=0,i,n){super(t,e,"Number"),i&&!Array.isArray(i)&&console.error("Range value must be an array of 2 numbers."),this.__range=i,this.__step=n}setValue(t,e){e==E$1.USER_SETVALUE&&(this.__range&&(t=Math.clamp(t,this.__range[0],this.__range[1])),this.__step&&(t=Math.round(t/this.__step)*this.__step)),super.setValue(t,e)}getValue(t){return super.getValue(t)}getRange(){return this.__range}setRange(t){return this.__range=t,this}getStep(){return this.__step}setStep(t){return this.__step=t,this}toJSON(t,e){const i=super.toJSON(t,e);return this.__range&&(i.range=this.__range),this.__step&&(i.step=this.__step),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.range&&(this.__range=t.range),t.step&&(this.__step=t.step)}readBinary(t,e){const i=t.loadFloat32();this.setValue(i,E$1.DATA_LOAD)}clone(t){const e=new Ze$1(this.__name,this.__value);return e.__range=this.__range,e.__step=this.__step,e}}J$1.registerClass("NumberParameter",Ze$1),J$1.registerClass("Property_SInt32",Ze$1),J$1.registerClass("Property_UInt32",Ze$1),J$1.registerClass("Property_Float32",Ze$1);class Ge$1 extends Ze$1{constructor(t,e,i){super(t,e,[0,i.length],1),this.choices=i}getChoices(){return this.choices}setValue(t,e){super.setValue("string"==typeof t?this.choices.indexOf(t):t,e)}}class Xe$1 extends Q$1{constructor(t,e){super(t,e,"Boolean")}clone(t){return new Xe$1(this.__name,this.__value)}}J$1.registerClass("BooleanParameter",Xe$1);class ye$1 extends Q$1{constructor(t,e,i){super(t,e||new _$1,"Vec2"),this.__range=i}getRange(){return this.__range}__setRange(t){this.__range=t,this.rangeChanged.emit()}clone(t){return new ye$1(this.__name,this.__value.clone())}}class fe$1 extends Q$1{constructor(t,e,i){super(t,e||new Z$1,"Vec3")}clone(t){return new fe$1(this.__name,this.__value.clone())}}class Ve$1 extends Q$1{constructor(t,e){super(t,e||new G$1,"Vec4")}clone(t){return new Ve$1(this.__name,this.__value.clone())}}class Ie$1 extends Q$1{constructor(t,e){super(t,e||new y$3,"Color")}readBinary(t,e){const i=t.loadRGBAFloat32Color();i.applyGamma(2.2),this.setValue(i,E$1.DATA_LOAD)}clone(t){return new Ie$1(this.__name,this.__value.clone())}}J$1.registerClass("ColorParameter",Ie$1);class Re$1 extends Q$1{constructor(t,e){super(t,e||new V$1,"Mat3")}clone(t){return new Re$1(this.__name,this.__value.clone())}}class xe$1 extends Q$1{constructor(t,e){super(t,e||new I$1,"Mat4")}clone(t){return new xe$1(this.__name,this.__value.clone())}}class Se$1 extends Q$1{constructor(t,e){super(t,e||new S$1,"Xfo")}clone(t){return new Se$1(this.__name,this.__value.clone())}}class We$1 extends Q$1{constructor(t,e){super(t,e,"BaseImage"),this.valueParameterValueChanged=new C$1}toJSON(t,e){const i=super.toJSON(t,e);return this.__value&&(i.imageType=J$1.getClassName(this.__value)),i}fromJSON(t,e,i){return t.imageType&&(this.__value=J$1.constructClass(t.imageType)),super.fromJSON(t,e,i)}clone(t){return new We$1(this.__name,this.__value)}}class Le$1 extends Q$1{constructor(t,e=""){super(t,e,"String"),this.multiLine=!1}setMultiLine(t){this.multiLine=t}getMultiLine(){return this.multiLine}readBinary(t,e){const i=t.loadStr();this.setValue(i,E$1.DATA_LOAD)}clone(t){return new Le$1(this.__name,this.__value)}}J$1.registerClass("StringParameter",Le$1),J$1.registerClass("Property_String",Le$1);class ve$1 extends Le$1{constructor(t,e=""){super(t,e,"String"),this.lang="js"}setLanguage(t){this.lang=t}getLanguage(){return this.lang}clone(t){return new ve$1(this.__name,this.__value)}}J$1.registerClass("CodeParameter",ve$1);class Fe$1 extends Q$1{constructor(t,e){super(t,"","FilePath"),this.fileUpdated=new C$1,e&&this.setSupportedExts(e)}setSupportedExts(t){this.__reextensions=new RegExp("\\.("+t+")$","i")}getFilepath(){return this.__file?be$1.getFilepath(this.__file.id):""}setFilepath(t,e){const i=be$1.resolveFilePathToId(t);i?this.setValue(i,e):console.warn("Resource unavailable:"+t)}getFilename(){if(this.__file)return this.__file.name}getExt(){const t=this.getFilename(),e=t.lastIndexOf(".");if(-1!=e)return t.substring(e).toLowerCase()}getStem(){const t=this.getFilename();if(t){const e=t.split(".");return 2==e.length?e[0]:t}}getFileFolder(){if(this.__file)return this.__file.parent?be$1.getFile(this.__file.parent):be$1.getRootFolder()}getFileFolderPath(){const t=this.getFilepath();if(t)return t.substring(0,t.lastIndexOf("/"))+"/"}getFile(){return this.__file}getFileDesc(){return this.__file}setUrl(t,e,i=E$1.USER_SETVALUE){const n=t.split("/");e||(e=n[n.length-1]),this.__value=e,this.__file={id:t,name:e,url:t},i!=E$1.USER_SETVALUE&&i!=E$1.REMOTEUSER_SETVALUE||(this.__flags|=H$1.USER_EDITED),this.valueChanged.emit(i)}getUrl(){return this.__file?this.__file.url:void 0}setDirty(t){throw new Error("Cannot drive a filepath param from an oporator")}setValue(t,e=E$1.USER_SETVALUE){if(null==t)throw new Error("Invalid value for setValue.");if(t.indexOf(".")>0)return console.warn("Deprecation warning for setValue. setValue should now only take a file id, not a path."),this.setFilepath(t,e);if(t==this.__value)return;const i=t;if(!be$1.resourceAvailable(i))return void console.warn("Resource unavailable:"+i);const n=be$1.getFile(i);if(this.__reextensions&&!this.__reextensions.test(n.name))return console.warn("Unsupported file type:"+n.name),!1;this.__value=t,this.__file=n,be$1.fileUpdated.connect(t=>{t==this.__value&&(this.__file=be$1.getFile(this.__value),this.fileUpdated.emit())}),e==E$1.USER_SETVALUE&&(this.__flags|=H$1.USER_EDITED),this.valueChanged.emit(e)}toJSON(t,e){if(0==(this.__flags&H$1.USER_EDITED))return;const i={};return this.__file&&(i.value=this.__file.id,i.filepath=be$1.getFilepath(this.__file.id)),i}fromJSON(t,e,i){if(t.value){if(t.value.indexOf(".")>0)return void this.setFilepath(t.value,E$1.DATA_LOAD);if(be$1.resourceAvailable(t.value))return this.setValue(t.value,E$1.DATA_LOAD),void(this.__flags|=H$1.USER_EDITED)}if(t.filepath){const e=be$1.resolveFilePathToId(t.filepath);if(e)return void this.setValue(e,E$1.DATA_LOAD);console.warn("Resource unavailable:"+t.filepath)}}clone(t){const e=new Fe$1(this.__name);return e.__file=this.__file,e}destroy(){super.destroy()}}class Te$1 extends Q$1{constructor(t,e){super(t,[]),this.__dataType=e,this.elementAdded=new C$1,this.elementRemoved=new C$1}__filter(t){return!0}getCount(){return this.__value.length}getElement(t){return this.__value[t]}setElement(t,e){this.__value[t]=e,this.valueChanged.emit(E$1.USER_SETVALUE)}addElement(t){if(null==t)t=new this.__dataType;else if(!this.__filter(t))return;return this.__value.push(t),this.__flags|=H$1.USER_EDITED,this.elementAdded.emit(t,this.__value.length-1),this.valueChanged.emit(E$1.USER_SETVALUE),t}removeElement(t){const e=this.__value[t];this.__value.splice(t,1),this.__flags|=H$1.USER_EDITED,this.elementRemoved.emit(e,t),this.valueChanged.emit(E$1.USER_SETVALUE)}insertElement(t,e){this.__filter(e)&&(this.__value.splice(t,0,e),this.__flags|=H$1.USER_EDITED,this.elementAdded.emit(e,t),this.valueChanged.emit(E$1.USER_SETVALUE))}toJSON(t,e){if(0==(this.__flags&H$1.USER_EDITED))return;const i=[];for(const n of this.__value)i.push("string"==typeof this.__dataType?n:n.toJSON(t,e));return{items:i}}fromJSON(t,e,i){if(null!=t.items){this.__flags|=H$1.USER_EDITED,this.__value=[];for(let i=0;i<t.items.length;i++){let n;"string"==typeof this.__dataType?n=t.items[i]:(n=new this.__dataType,n.fromJSON(t.items[i],e)),this.__value.push(n),this.elementAdded.emit(n,this.__value.length-1)}this.valueChanged.emit(E$1.DATA_LOAD)}else console.warn("Invalid Parameter JSON")}clone(t){const e=this.__value.slice(0),i=new Te$1(this.__name,this.__dataType);return i.setValue(e),i}destroy(){for(let t=0;t<this.__value.length;t++)this.__value[t]instanceof Q$1&&this.__value[t].destroy(),this.removeElement(t)}}class Me$1 extends Q$1{constructor(t){super(t,{},"Struct"),this.__members=[]}_addMember(t){return this.__value[t.getName()]=t.getValue(),t.valueChanged.connect(()=>{this.__value[t.getName()]=t.getValue()}),this.__members.push(t),this.__flags|=H$1.USER_EDITED,this.valueChanged.emit(),t}getParameter(t){for(const e of this.__members)if(e.getName()==t)return e}getMember(t){return this.getParameter(t)}getMemberNames(){const t=[];for(let e=0;e<this.__members.length;e++){const i=this.__members[e];null!=i&&(t[e]=i.getName())}return t}toJSON(t,e){if(0==(this.__flags&H$1.USER_EDITED))return;const i=[];for(const n of this.__members)i.push(n.toJSON(t,e));return{members:i}}fromJSON(t,e,i){if(null!=t.members){this.__flags|=H$1.USER_EDITED;for(let i=0;i<t.members.length;i++)t.members[i]&&this.__members[i].fromJSON(t.members[i],e)}else console.warn("Invalid Parameter JSON")}destroy(){super.destroy();for(const t of this.__members)t.destroy()}}class Ce$1 extends Q$1{constructor(t,e){super(t,void 0,"TreeItem"),this.__filterFn=e,this.treeItemGlobalXfoChanged=new C$1}setOwner(t){this.__owner=t}getOwner(){return this.__owner}setFilterFn(){this.__filterFn=filterFn}getFilterFn(){return this.__filterFn}setValue(t,e=E$1.USER_SETVALUE){if(this.__filterFn&&!this.__filterFn(t))return!1;this.__value!==t&&(this.__value&&this.__value.globalXfoChanged.disconnect(this.treeItemGlobalXfoChanged.emit),this.__value=t,this.__value&&this.__value.globalXfoChanged.connect(this.treeItemGlobalXfoChanged.emit),e!=E$1.USER_SETVALUE&&e!=E$1.REMOTEUSER_SETVALUE||(this.__flags|=H$1.USER_EDITED),this.valueChanged.emit(e))}toJSON(t,e){if(0!=(this.__flags&H$1.USER_EDITED))return{value:t.makeRelative(this.__value.getPath())}}fromJSON(t,e,i){null!=t.value?(e.resolvePath(t.value,t=>{this.setValue(t)},()=>{console.warn("Unable to resolve tree item parameter value:"+pj.paramPath)}),this.__flags|=H$1.USER_EDITED):console.warn("Invalid Parameter JSON")}clone(t){return new Ce$1(this.__name,this.__filterFn)}destroy(){this.__value&&this.__value.parameterValueChanged.disconnect(this.valueParameterValueChanged.emit)}}class Ne$1 extends Q$1{constructor(t,e){super(t,void 0,"BaseItem"),this.__items=new Set,this.__filterFn=e,this.itemAdded=new C$1,this.itemRemoved=new C$1}setFilterFn(t){this.__filterFn=t}getFilterFn(){return this.__filterFn}getItem(t){return Array.from(this.__items)[t]}addItem(t,e=!0){if(this.__filterFn&&!this.__filterFn(t))return console.warn("ItemSet __filterFn rejecting item:",t.getPath()),!1;this.__items.add(t);const i=Array.from(this.__items).indexOf(t);return this.itemAdded.emit(t,i),e&&this.valueChanged.emit(),i}addItems(t,e=!0){t.forEach(t=>this.addItem(t,!1)),e&&this.valueChanged.emit()}removeItem(t,e=!0){const i=Array.from(this.__items)[t];return this.__items.delete(i),this.itemRemoved.emit(i,t),e&&this.valueChanged.emit(),i}setItems(t,e=!0){for(let i=this.__items.length-1;i>=0;i--){const e=this.__items[i];t.has(e)||this.removeItem(e,!1)}for(const i of t)this.__items.has(i)||this.addItem(i,!1);e&&this.valueChanged.emit()}clearItems(t=!0){this.__items.clear(),t&&this.valueChanged.emit()}getNumItems(){return Array.from(this.__items).length}getValue(){return this.__items}toJSON(t,e){return{}}fromJSON(t,e,i){}clone(t){return new Ne$1(this.__name,this.__filterFn)}}class Ye$1 extends Q$1{constructor(t,e){super(t,void 0,e.getDataType()),this.setSourceParameter(e)}setSourceParameter(t){this.sourceParameter=t,this.sourceParameter.valueChanged.connect(this.__proxyValueChanged.bind(this))}__proxyValueChanged(t){this.valueChanged.emit(t)}getDataType(){return this.sourceParameter.getDataType()}setValue(t,e){}getValue(t){return this.sourceParameter.getValue(t)}toJSON(t,e){const i=super.toJSON(t,e);return this.sourceParameter&&(i.sourceParameter=this.sourceParameter.getPath()),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.sourceParameter&&e.resolvePath(t.sourceParameter,t=>{this.setSourceParameter(t)},()=>{console.warn("Error loading Proxy Param: '"+this.getName()+"'. Unable to connect to:"+t.sourceParameter)}),t.range&&(this.sourceParameter=t.range),t.step&&(this.__step=t.step)}clone(t,e){const i=new Ye$1(this.__name,this.__value);return this.sourceParameter&&this.connectToClonedSourceParam(e),i}connectToClonedSourceParam(t){t.resolveClonedItem(this.sourceParameter,t=>{clonedParam.setSourceParameter(t)},()=>{console.warn("Error cloning Proxy Param: '"+this.getName()+"'. Unable to connect to:"+j.sourceParameter)})}}J$1.registerClass("ProxyParameter",Ye$1);class Ke$1 extends Q$1{constructor(t,e){super(t,void 0,"Geometry"),this.boundingBoxDirtied=new C$1,this.setValue(e)}setValue(t,e=E$1.USER_SETVALUE){this.__value!==t&&(this.__value&&this.__value.boundingBoxDirtied.disconnect(this.boundingBoxDirtied.emit),this.__value=t,this.__value&&this.__value.boundingBoxDirtied.connect(this.boundingBoxDirtied.emit),e!=E$1.USER_SETVALUE&&e!=E$1.REMOTEUSER_SETVALUE||(this.__flags|=H$1.USER_EDITED),e!=E$1.OPERATOR_SETVALUE&&this.valueChanged.emit(e))}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){return super.fromJSON(t,e,i)}clone(t){return new Ke$1(this.__name,this.__value)}destroy(){this.__value&&this.__value.boundingBoxDirtied.disconnect(this.boundingBoxDirtied.emit)}}class we$1 extends te$1{constructor(t){super(t),this.width=0,this.height=0,this.format="RGB",this.type="UNSIGNED_BYTE",this.addParameter(new Xe$1("AlphaFromLuminance",!1)),this.addParameter(new Xe$1("Invert",!1)),this.addParameter(new Xe$1("FlipY",!1)),this.updated=this.parameterValueChanged,this.loaded=new C$1(!0)}isLoaded(){return!0}getMapping(){return this.__mapping}setMapping(t){this.__mapping=t}isStream(){return!1}isStreamAtlas(){return this.__streamAtlas}getParams(){return{type:this.type,format:this.format,width:this.width,height:this.height,flipY:this.getParameter("FlipY").getValue(),invert:this.getParameter("Invert").getValue(),alphaFromLuminance:this.getParameter("AlphaFromLuminance").getValue()}}}class ze$1 extends Ze$1{constructor(t,e,i){super(t,e,i),this.textureConnected=new C$1,this.textureDisconnected=new C$1}getImage(){return this.__image}setImage(t,e=0){const i=()=>{this.textureDisconnected.emit()};t?(null!=this.__image&&this.__image!==t&&i(),this.__image=t,this.textureConnected.emit(),this.valueChanged.emit(e)):null!=this.__image&&(i(),this.__image=void 0,this.textureDisconnected.emit())}setValue(t){t instanceof we$1?this.setImage(t):(null!=this.__image&&this.setImage(void 0),super.setValue(t))}readBinary(t,e){super.readBinary(t,e);const i=t.loadStr();""!=i&&(console.log("Load Texture"),this.setImage(e.materialLibrary.getImage(i)))}clone(t){return new ze$1(this.__name,this.__value.clone())}}J$1.registerClass("MaterialFloatParam",ze$1);class Ue$1 extends Ie$1{constructor(t,e){super(t,e),this.textureConnected=new C$1,this.textureDisconnected=new C$1,this.__imageUpdated=this.__imageUpdated.bind(this)}getImage(){return this.__image}__imageUpdated(){this.valueChanged.emit()}setImage(t,e=0){const i=()=>{this.__image.loaded.disconnect(this.__imageUpdated),this.__image.updated.disconnect(this.__imageUpdated),this.__image=null,this.textureDisconnected.emit()};t?(null!=this.__image&&this.__image!==t&&i(),this.__image=t,this.__image.updated.connect(this.__imageUpdated),this.textureConnected.emit(),this.valueChanged.emit(e)):null!=this.__image&&(i(),this.__image=void 0,this.textureDisconnected.emit())}setValue(t){t instanceof we$1?this.setImage(t):(null!=this.__image&&this.setImage(void 0),super.setValue(t))}readBinary(t,e){super.readBinary(t,e);const i=t.loadStr();""!=i&&this.setImage(e.materialLibrary.getImage(i))}clone(t){return new Ue$1(this.__name,this.__value.clone())}}J$1.registerClass("MaterialColorParam",Ue$1);const Je$1=(t,e,i,n)=>"boolean"==typeof e||!1===e||!0===e?new Q$1(t,e,"Boolean"):"string"==typeof e?new Q$1(t,e,"String"):Number.isNumeric(e)?n?new ze$1(t,e,i):new Ze$1(t,e,i):e instanceof _$1?new ye$1(t,e):e instanceof Z$1?new fe$1(t,e):e instanceof y$3?n?new Ue$1(t,e):new Ie$1(t,e):new Q$1(t,e);class Pe$1 extends te$1{constructor(t,e){super(t),this.shaderNameChanged=new C$1,this.visibleInGeomDataBuffer=!0,e&&this.setShaderName(e)}getShaderName(){return this.__shaderName}setShaderName(t){if(this.__shaderName==t)return;const e=J$1.getClass(t);if(!e)throw new Error("Error setting Shader. Shader not found:"+t);const i=e.getParamDeclarations(),n={};for(const s of i){let t=this.getParameter(s.name);t||(t=this.addParameter(Je$1(s.name,s.defaultValue,s.range,0!=s.texturable))),n[s.name]=!0}for(const s of this.__params)n[s.getName()]||this.removeParameter(s.getName());this.__shaderName=t,this.shaderNameChanged.emit(this.__shaderName)}removeAllTextures(){for(const t of this.__params)t.getImage&&t.getImage()&&t.setImage(void 0)}getParamTextures(){const t={};for(const e of this.__params)e.getImage&&e.getImage()&&(t[e.getName()]=e.getImage());return t}__makeParameterTexturable(t){makeParameterTexturable(t)}isTransparent(){const t=this.getParameter("Opacity");if(t&&(t.getValue()<.99||t.getImage()))return!0;const e=this.getParameter("BaseColor");return!(!e||!e.getImage()||"RGBA"!=e.getImage().format)}getShaderClass(){return J$1.getClass(this.getShaderName())}modifyParams(t,e){e&&this.setShaderName(e);for(const i in t){const e=this.getParameter(i);e&&(t[i]instanceof Q$1?this.replaceParameter(t[i]):e.setValue(t[i]))}}toJSON(t,e=0){return super.toJSON(t,e)}fromJSON(t,e={},i=0){t.shader?(this.setShaderName(t.shader),super.fromJSON(t,e,i)):console.warn("Invalid Material JSON")}readBinary(t,e){let i=t.loadStr();if("StandardMaterial"==i&&(i="StandardSurfaceShader"),"TransparentMaterial"==i&&(i="TransparentSurfaceShader"),this.setShaderName(i),e.versions["zea-engine"].lessThan([0,0,3])){this.setName(t.loadStr());const i=t.loadUInt32();for(let s=0;s<i;s++){const i=(n=t.loadStr()).charAt(0).toUpperCase()+n.slice(1);let s;"MaterialColorParam"==t.loadStr()?(s=t.loadRGBAFloat32Color(),s.applyGamma(2.2)):s=t.loadFloat32();const o=t.loadStr();let r=this.getParameter(i);r?r.setValue(s):r=this.addParameter(Je$1(i,s)),""!=o&&r.setImage&&(e.materialLibrary.hasImage(o)?r.setImage(e.materialLibrary.getImage(o)):console.warn("Missing Texture:"+o))}}else super.readBinary(t,e);var n}clone(t){const e=new Pe$1;return e.copyFrom(this,t),e}copyFrom(t,e){super.copyFrom(t,e),this.setShaderName(t.getShaderName());for(const i of t.getParameters()){const e=t.getParameter(i.getName());i.getImage||this.__makeParameterTexturable(e)}}destroy(){this.removeAllTextures(),super.destroy()}}class Ee$1 extends we$1{constructor(t){super(),null==t&&(t=this.constructor.name),this.__name=t,this.format="RGBA",this.type="UNSIGNED_BYTE",this.__loaded=!1,this.width=1,this.height=1}isLoaded(){return this.__loaded}getName(){return this.__name}isStream(){return!1}setData(t,e,i){this.width=t,this.height=e,this.__data=i,this.__loaded?this.updated.emit():(this.__loaded=!0,this.loaded.emit())}getParams(){const t=super.getParams();return t.data=this.__data,t}}function He$1(t){this.data=t,this.pos=0}function ke$1(t){this.stream=new He$1(t),this.output={}}J$1.registerClass("DataImage2D",Ee$1),J$1.registerClass("DataImage",Ee$1),He$1.prototype.readByte=function(){return this.data[this.pos++]},He$1.prototype.peekByte=function(){return this.data[this.pos]},He$1.prototype.readBytes=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.readByte();return e},He$1.prototype.peekBytes=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.data[this.pos+i];return e},He$1.prototype.readString=function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},He$1.prototype.readBitArray=function(){for(var t=[],e=this.readByte(),i=7;i>=0;i--)t.push(!!(e&1<<i));return t},He$1.prototype.readUnsigned=function(t){var e=this.readBytes(2);return t?(e[1]<<8)+e[0]:(e[0]<<8)+e[1]},ke$1.prototype.parse=function(t){return this.parseParts(this.output,t),this.output},ke$1.prototype.parseParts=function(t,e){for(var i=0;i<e.length;i++)this.parsePart(t,e[i])},ke$1.prototype.parsePart=function(t,e){var i,n=e.label;if(!e.requires||e.requires(this.stream,this.output,t))if(e.loop){for(var s=[];e.loop(this.stream);){var o={};this.parseParts(o,e.parts),s.push(o)}t[n]=s}else e.parts?(this.parseParts(i={},e.parts),t[n]=i):e.parser?(i=e.parser(this.stream,this.output,t),e.skip||(t[n]=i)):e.bits&&(t[n]=this.parseBits(e.bits))},ke$1.prototype.parseBits=function(t){var e={},i=this.stream.readBitArray();for(var n in t){var s=t[n];e[n]=s.length?i.slice(s.index,s.index+s.length).reduce((function(t,e){return 2*t+e}),0):i[s.index]}return e};var Be$1=function(){return function(t){return t.readByte()}},De$1=function(t){return function(e){return e.readBytes(t)}},Oe$1=function(t){return function(e){return e.readString(t)}},Qe$1=function(t){return function(e){return e.readUnsigned(t)}},Ae$1=function(t,e){return function(i,n,s){for(var o=e(i,n,s),r=new Array(o),a=0;a<o;a++)r[a]=i.readBytes(t);return r}},je$1={label:"blocks",parser:function(t){for(var e=[],i=t.readByte();0!==i;i=t.readByte())e=e.concat(t.readBytes(i));return e}},qe$1={label:"gce",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&249===e[1]},parts:[{label:"codes",parser:De$1(2),skip:!0},{label:"byteSize",parser:Be$1()},{label:"extras",bits:{future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}}},{label:"delay",parser:Qe$1(!0)},{label:"transparentColorIndex",parser:Be$1()},{label:"terminator",parser:Be$1(),skip:!0}]},$e$1={label:"image",requires:function(t){return 44===t.peekByte()},parts:[{label:"code",parser:Be$1(),skip:!0},{label:"descriptor",parts:[{label:"left",parser:Qe$1(!0)},{label:"top",parser:Qe$1(!0)},{label:"width",parser:Qe$1(!0)},{label:"height",parser:Qe$1(!0)},{label:"lct",bits:{exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}}}]},{label:"lct",requires:function(t,e,i){return i.descriptor.lct.exists},parser:Ae$1(3,(function(t,e,i){return Math.pow(2,i.descriptor.lct.size+1)}))},{label:"data",parts:[{label:"minCodeSize",parser:Be$1()},je$1]}]},et$1={label:"text",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&1===e[1]},parts:[{label:"codes",parser:De$1(2),skip:!0},{label:"blockSize",parser:Be$1()},{label:"preData",parser:function(t,e,i){return t.readBytes(i.text.blockSize)}},je$1]},tt$1={label:"frames",parts:[qe$1,{label:"application",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&255===e[1]},parts:[{label:"codes",parser:De$1(2),skip:!0},{label:"blockSize",parser:Be$1()},{label:"id",parser:function(t,e,i){return t.readString(i.blockSize)}},je$1]},{label:"comment",requires:function(t){var e=t.peekBytes(2);return 33===e[0]&&254===e[1]},parts:[{label:"codes",parser:De$1(2),skip:!0},je$1]},$e$1,et$1],loop:function(t){var e=t.peekByte();return 33===e||44===e}},it$1=[{label:"header",parts:[{label:"signature",parser:Oe$1(3)},{label:"version",parser:Oe$1(3)}]},{label:"lsd",parts:[{label:"width",parser:Qe$1(!0)},{label:"height",parser:Qe$1(!0)},{label:"gct",bits:{exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}}},{label:"backgroundColorIndex",parser:Be$1()},{label:"pixelAspectRatio",parser:Be$1()}]},{label:"gct",requires:function(t,e){return e.lsd.gct.exists},parser:Ae$1(3,(function(t,e){return Math.pow(2,e.lsd.gct.size+1)}))},tt$1];function st$1(t){var e=new ke$1(new Uint8Array(t));this.raw=e.parse(it$1),this.raw.hasImages=!1;for(var i=0;i<this.raw.frames.length;i++)if(this.raw.frames[i].image){this.raw.hasImages=!0;break}}st$1.prototype.decompressFrame=function(t,e){if(t>=this.raw.frames.length)return null;var i=this.raw.frames[t];if(i.image){var n=function(t,e,i){var n,s,o,r,a,l,c,h,d,u,m,p,b,f,g,y,v=i,Z=new Array(i),x=new Array(4096),G=new Array(4096),X=new Array(4097);for(a=1+(s=1<<(p=t)),n=s+2,c=-1,o=(1<<(r=p+1))-1,d=0;d<s;d++)x[d]=0,G[d]=d;for(m=h=b=f=y=g=0,u=0;u<v;){if(0===f){if(h<r){m+=e[g]<<h,h+=8,g++;continue}if(d=m&o,m>>=r,h-=r,d>n||d==a)break;if(d==s){o=(1<<(r=p+1))-1,n=s+2,c=-1;continue}if(-1==c){X[f++]=G[d],c=d,b=d;continue}for(l=d,d==n&&(X[f++]=b,d=c);d>s;)X[f++]=G[d],d=x[d];X[f++]=b=255&G[d],n<4096&&(x[n]=c,G[n]=b,0==(++n&o)&&n<4096&&(r++,o+=n)),c=l}f--,Z[y++]=X[f],u++}for(u=y;u<v;u++)Z[u]=0;return Z}(i.image.data.minCodeSize,i.image.data.blocks,i.image.descriptor.width*i.image.descriptor.height);i.image.descriptor.lct.interlaced&&(n=function(t,e){for(var i=new Array(t.length),n=t.length/e,s=function(n,s){var o=t.slice(s*e,(s+1)*e);i.splice.apply(i,[n*e,e].concat(o))},o=[0,4,2,1],r=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=o[l];c<n;c+=r[l])s(c,a),a++;return i}(n,i.image.descriptor.width));var s={pixels:n,dims:{top:i.image.descriptor.top,left:i.image.descriptor.left,width:i.image.descriptor.width,height:i.image.descriptor.height}};return s.colorTable=i.image.descriptor.lct&&i.image.descriptor.lct.exists?i.image.lct:this.raw.gct,i.gce&&(s.delay=10*(i.gce.delay||10),s.disposalType=i.gce.extras.disposal,i.gce.extras.transparentColorGiven&&(s.transparentIndex=i.gce.transparentColorIndex)),e&&(s.patch=function(t){for(var e=t.pixels.length,i=new Uint8ClampedArray(4*e),n=0;n<e;n++){var s=4*n,o=t.pixels[n],r=t.colorTable[o];i[s]=r[0],i[s+1]=r[1],i[s+2]=r[2],i[s+3]=o!==t.transparentIndex?255:0}return i}(s)),s}return null},st$1.prototype.decompressFrames=function(t){for(var e=[],i=0;i<this.raw.frames.length;i++)this.raw.frames[i].image&&e.push(this.decompressFrame(i,t));return e};const nt$1={},lt$1={},rt$1=-1!==navigator.userAgent.indexOf("Chrome");class ot$1 extends we$1{constructor(t,e="",i={}){e.constructor==Object&&(i=e),null!=t&&-1!=t.lastIndexOf(".")&&(console.warn("Deprecated signature. Please provide a name and filepath to the image constructor"),t=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("."))),super(t,i),this.__loaded=!1;const n=this.addParameter(new Fe$1("FilePath"));n.valueChanged.connect(()=>{if(this.loaded.untoggle(),""==this.getName()){const t=n.getStem(),e=t.substring(t.length-1);isNaN(e)?this.setName(t):this.setName(t.substring(0,t.length-1))}const t=n.getFileDesc();t&&this.__loadData(t)}),e&&""!=e&&n.setFilepath(e)}static __imageDataLibrary(){return nt$1}static registerLoader(t,e){lt$1[t]=e}static constructLoader(t,e){for(const i of lt$1)if(new RegExp("\\.("+i+")$","i").test(t.name)){const n=new lt$1[i](e);if(n)return n.getParameter("FilePath").setValue(t.id),n}}__loadData(t){const e=this.getParameter("FilePath").getExt();if(".jpg"==e||".png"==e||".webp"==e)this.__loadLDRImage(t,e);else if(".mp4"==e||".ogg"==e)this.__loadLDRVideo(t);else if(".vlh"==e)this.__loadVLH(t);else if(".gif"==e)this.__loadGIF(t);else{if(".svg"!=e)throw new Error("Unsupported file type. Check the ext:"+t);console.warn("SVG Image not yet supported")}}__loadLDRImage(t,e){let i;".jpg"==e?this.format="RGB":".png"==e&&(this.format="RGBA"),this.type="UNSIGNED_BYTE";const n=()=>{this.getDOMElement=()=>i,this.width=i.width,this.height=i.height,this.__data=i,this.__loaded=!0,this.loaded.emit()};if(t.id in nt$1)i=nt$1[t.id],i.complete?n():i.addEventListener("load",n);else{be$1.addWork(t.id,1);const e=this.addParameter(new Ze$1("PreferredSize",-1));let s=t.url;if(t.assets&&Object.keys(t.assets).length>0){const i={maxSize:t$1.gpuDesc.maxTextureSize},n=e.getValue();-1==n?t.assets.reduce&&(i.prefSize=t.assets.reduce.w):i.prefSize=n;const o=function(t,e){if(e=e.filter(t=>null!==t),rt$1){const t=e.filter(t=>"webp"===t.format);t.length>1&&(e=t)}else e=e.filter(t=>"webp"!==t.format);if(t.maxSize&&(e=e.filter(e=>e.w<=t.maxSize)),t.filter){const i=e.filter(e=>-1!==e.url.indexOf(t.filter));i.length>1&&(e=i)}if(t.prefSize&&(e=e.map(e=>Object.assign({score:Math.abs(t.prefSize-e.w)},e))).sort((t,e)=>t.score>e.score?1:t.score<e.score?-1:0),e.length>0)return e[0]}(i,Object.values(t.assets));o&&(console.log("Selected image:"+t.name+" format:"+o.format+" :"+o.w+"x"+o.h+" url:"+o.url),s=o.url)}else console.warn("Images not processed for this file:"+t.name);i=new Image,i.crossOrigin="anonymous",i.src=s,i.addEventListener("load",n),i.addEventListener("load",()=>{be$1.addWorkDone(t.id,1)}),nt$1[t.id]=i}}__removeVideoParams(){this.getParameterIndex("spatializeAudio")&&(this.removeParameter(this.getParameterIndex("Loop")),this.removeParameter(this.getParameterIndex("spatializeAudio")),this.removeParameter(this.getParameterIndex("Gain")),this.removeParameter(this.getParameterIndex("refDistance")),this.removeParameter(this.getParameterIndex("maxDistance")),this.removeParameter(this.getParameterIndex("rolloffFactor")),this.removeParameter(this.getParameterIndex("coneInnerAngle")),this.removeParameter(this.getParameterIndex("coneOuterAngle")),this.removeParameter(this.getParameterIndex("coneOuterGain")))}__loadLDRVideo(t){this.format="RGB",this.type="UNSIGNED_BYTE",be$1.addWork(t.id,1);const e=this.addParameter(new Xe$1("Mute",!0)),i=this.addParameter(new Xe$1("Loop",!0)),n=document.createElement("video");n.style.display="none",n.preload="auto",n.crossOrigin="anonymous",this.getAudioSource=()=>n,document.body.appendChild(n),n.addEventListener("loadedmetadata",()=>{n.muted=e.getValue(),e.valueChanged.connect(()=>{n.muted=e.getValue()}),n.loop=i.getValue(),i.valueChanged.connect(()=>{n.loop=i.getValue()}),this.width=n.videoHeight,this.height=n.videoWidth,this.__data=n,this.__loaded=!0,be$1.addWorkDone(t.id,1),this.loaded.emit(n),n.play().then(()=>{let t=0;const e=()=>{if(n.paused||n.ended)return;const i=Math.floor(29.97*n.currentTime);t!=i&&(this.updated.emit(),t=i),setTimeout(e,20)};e()},t=>{console.log("Autoplay was prevented.",t,t.message)})},!1),n.src=t.url}__loadVLH(t){this.type="FLOAT";let e=new y$3(1,1,1,1);this.setHDRTint=t=>{e=t},this.getHDRTint=()=>e,be$1.loadUrl(t.id,t.url,t=>{let e,i;for(const o in t)o.endsWith(".jpg")?e=t[o]:o.endsWith(".bin")&&(i=t[o]);const n=new Blob([e.buffer]),s=new Image;s.onload=()=>{this.width=s.width,this.height=s.height,this.__data={ldr:s,cdm:i},this.__loaded?this.updated.emit():(this.__loaded=!0,this.loaded.emit())},s.src=URL.createObjectURL(n)})}__loadGIF(t){let e,i,n;this.format="RGBA",this.type="UNSIGNED_BYTE",this.__streamAtlas=!0,this.addParameter(new Ve$1("StreamAtlasDesc",new G$1)),this.addParameter(new Ze$1("StreamAtlasIndex",0)),this.getParameter("StreamAtlasIndex").setRange([0,1]),this.getFrameDelay=()=>20,this.play=()=>{n.then(()=>{e=!0,i&&i()})},this.stop=()=>{e=!1},t.id in nt$1?n=nt$1[t.id]:(n=new Promise((e,i)=>{if(be$1.addWork(t.id,1),t.assets&&t.assets.atlas){const i=new Image;return i.crossOrigin="anonymous",i.src=t.assets.atlas.url,void i.addEventListener("load",()=>{e({width:t.assets.atlas.width,height:t.assets.atlas.height,atlasSize:t.assets.atlas.atlasSize,frameDelays:t.assets.atlas.frameDelays,frameRange:[0,t.assets.atlas.frameDelays.length],imageData:i}),be$1.addWorkDone(t.id,1)})}re$2(t.url,i=>{console.warn("Unpacking Gif client side:"+t.name);const n=performance.now(),s=new st$1(i).decompressFrames(!0),o=Math.sqrt(s.length),r=[o,o];Math.fract(o)>0&&(r[0]=Math.floor(r[0]+1),r[1]=Math.fract(o)>.5?Math.floor(r[1]+1):Math.floor(r[1]));const a=s[0].dims.width,l=s[0].dims.height,c=document.createElement("canvas"),h=c.getContext("2d"),d=document.createElement("canvas"),u=d.getContext("2d");d.width=a,d.height=l;const m=document.createElement("canvas"),p=m.getContext("2d");let b;m.width=r[0]*a,m.height=r[1]*l;const f=[],g=(t,e)=>{const i=t.dims;f.push(t.delay/10),b&&i.width==b.width&&i.height==b.height||(c.width=i.width,c.height=i.height,b=h.createImageData(i.width,i.height)),b.data.set(t.patch),h.putImageData(b,0,0),2==t.disposalType&&u.clearRect(0,0,d.width,d.height),u.drawImage(c,i.left,i.top),p.drawImage(d,e%r[0]*a,Math.floor(e/r[0])*l)};for(let t=0;t<s.length;t++)g(s[t],t);be$1.addWorkDone(t.id,1);const y=p.getImageData(0,0,m.width,m.height),v=performance.now()-n;console.log(`Decode GIF '${t.name}' time:`+v),e({width:m.width,height:m.height,atlasSize:r,frameRange:[0,s.length],frameDelays:f,imageData:y})},e=>{console.warn("Unable to Load URL:"+e+":"+t.url),i()})}),nt$1[t.id]=n),n.then(t=>{this.width=t.width,this.height=t.height,this.getParameter("StreamAtlasDesc").setValue(new G$1(t.atlasSize[0],t.atlasSize[1],0,0)),this.getParameter("StreamAtlasIndex").setRange(t.frameRange),this.__data=t.imageData,this.getFrameDelay=e=>10*t.frameDelays[e];const n=this.getParameter("StreamAtlasIndex"),s=n.getRange()[1];let o=0;i=()=>{n.setValue(o),e&&setTimeout(i,this.getFrameDelay(o)),o=(o+1)%s},e&&i(),this.__loaded=!0,this.loaded.emit()})}getFilepath(){return this.getParameter("FilePath").getValue()}isStream(){return!1}isLoaded(){return this.__loaded}getParams(){const t=super.getParams();return this.__loaded&&(t.data=this.__data),t}toJSON(t,e){}fromJSON(t,e,i){}readBinary(t,e){this.setName(t.loadStr());let i=t.loadStr();if("string"==typeof i&&""!=i){if(e.lod>=0){const t=i.lastIndexOf(".");if(-1!=t){const n=i.substring(0,t)+e.lod+i.substring(t);be$1.resolveFilepath(n)&&(i=n)}}this.getParameter("FilePath").setFilepath(i)}}}class dt$1 extends ot$1{constructor(t,e={}){console.warn("FileImage2D is becoming deprecated in favor of simple FileImage"),super(t,e)}}J$1.registerClass("FileImage2D",ot$1),J$1.registerClass("FileImage",ot$1);const ht$1=-1!==navigator.userAgent.indexOf("Chrome");class ct$1 extends ot$1{constructor(t,e,i){super(t,e,i),this.type="UNSIGNED_BYTE",this.addParameter(new Ze$1("PreferredSize",-1)),this.__crossOrigin="anonymous"}setCrossOrigin(t){this.__crossOrigin=t}__loadData(t){".png"==this.getParameter("FilePath").getExt()&&(this.format="RGBA");let e=t.url;if(t.assets&&Object.keys(t.assets).length>0){const i={maxSize:t$1.gpuDesc.maxTextureSize},n=this.getParameter("PreferredSize").getValue();-1==n?t.assets.reduce&&(i.prefSize=t.assets.reduce.w):i.prefSize=n;const s=function(t,e){if(e=e.filter(t=>null!==t),ht$1){const t=e.filter(t=>"webp"===t.format);t.length>1&&(e=t)}else e=e.filter(t=>"webp"!==t.format);if(t.maxSize&&(e=e.filter(e=>e.w<=t.maxSize)),t.filter){const i=e.filter(e=>-1!==e.url.indexOf(t.filter));i.length>1&&(e=i)}if(t.prefSize&&(e=e.map(e=>Object.assign({score:Math.abs(t.prefSize-e.w)},e))).sort((t,e)=>t.score>e.score?1:t.score<e.score?-1:0),e.length>0)return e[0]}(i,Object.values(t.assets));s&&(console.log("Selected image:"+t.name+" format:"+s.format+" :"+s.w+"x"+s.h+" url:"+s.url),e=s.url)}else console.warn("Images not processed for this file:"+t.name);this.setImageURL(e,"RGB")}setImageURL(t,e="RGB"){if(!e){const i=t.lastIndexOf(".");-1!=i&&".png"==t.substring(i).toLowerCase()&&(e="RGBA")}let i;this.format=e,this.__loaded=!1;const n=()=>{this.getDOMElement=()=>i,this.width=i.width,this.height=i.height,this.__data=i,this.__loaded=!0,this.loaded.emit()},s=ot$1.__imageDataLibrary();t in s?(i=s[t],i.complete?n():i.addEventListener("load",n)):(i=new Image,i.crossOrigin=this.__crossOrigin,i.src=t,i.addEventListener("load",n),s[t]=i)}}ot$1.registerLoader("jpg|jpeg|png",ct$1),J$1.registerClass("LDRImage",ct$1);class mt$1 extends ot$1{constructor(t,e,i){super(t,e,i),this.format="RGB",this.type="UNSIGNED_BYTE",this.addParameter(new Xe$1("Mute",!1)),this.addParameter(new Xe$1("Loop",!0)),this.addParameter(new Ze$1("Gain",2)).setRange([0,5]),this.addParameter(new Xe$1("SpatializeAudio",!0)),this.addParameter(new Ze$1("refDistance",2)),this.addParameter(new Ze$1("maxDistance",1e4)),this.addParameter(new Ze$1("rolloffFactor",1)),this.addParameter(new Ze$1("coneInnerAngle",360)),this.addParameter(new Ze$1("coneOuterAngle",0)),this.addParameter(new Ze$1("coneOuterGain",1))}__loadData(t){be$1.addWork(t.id,1);const e=document.createElement("video");e.style.display="none",e.preload="auto",e.crossOrigin="anonymous",this.getAudioSource=()=>e,document.body.appendChild(e),e.addEventListener("loadedmetadata",()=>{const i=this.getParameter("Mute");e.muted=i.getValue(),i.valueChanged.connect(()=>{e.muted=i.getValue()});const n=this.getParameter("Loop");e.loop=n.getValue(),n.valueChanged.connect(()=>{e.loop=n.getValue()}),this.width=e.videoHeight,this.height=e.videoWidth,this.__data=e,this.__loaded=!0,be$1.addWorkDone(t.id,1),this.loaded.emit(e);let s=0;const o=()=>{if(e.paused||e.ended)return;const t=Math.floor(29.97*e.currentTime);s!=t&&(this.updated.emit(),s=t),setTimeout(o,20)};o()},!1),e.src=t.url;const i=e.play();void 0!==i&&i.then(()=>{console.log("Autoplay started!")}).catch(()=>{console.log("Autoplay was prevented.")})}}ot$1.registerLoader("mp4|ogg",mt$1),J$1.registerClass("LDRVideo",mt$1);class ut$1 extends ot$1{constructor(t,e="",i={}){super(t,e,i),this.format="RGBA",this.type="UNSIGNED_BYTE",this.__streamAtlas=!0,this.getParameter("FilePath").setSupportedExts("gif"),this.addParameter(new Ve$1("StreamAtlasDesc")),this.addParameter(new Ze$1("StreamAtlasIndex",0));const n=this.getParameter("StreamAtlasIndex");let s;n.setRange([0,1]);let o=0;const r=t=>{n.setValue(o),s&&setTimeout(()=>r(t),this.getFrameDelay(o)),o=(o+1)%t};this.play=()=>{this.__resourcePromise.then(()=>{s=!0;const t=n.getRange()[1];r(t)})},this.stop=()=>{s=!1}}getFrameDelay(t){return 10*this.__unpackedData.frameDelays[t]}__loadData(t){const e=ot$1.__imageDataLibrary();t.id in e?this.__resourcePromise=e[t.id]:(this.__resourcePromise=new Promise((e,i)=>{if(be$1.addWork(t.id,1),t.assets&&t.assets.atlas){const i=new Image;return i.crossOrigin="anonymous",i.src=t.assets.atlas.url,void i.addEventListener("load",()=>{e({width:t.assets.atlas.width,height:t.assets.atlas.height,atlasSize:t.assets.atlas.atlasSize,frameDelays:t.assets.atlas.frameDelays,frameRange:[0,t.assets.atlas.frameDelays.length],imageData:i}),be$1.addWorkDone(t.id,1)})}re$2(t.url,i=>{console.warn("Unpacking Gif client side:"+t.name);const n=performance.now(),s=new st$1(i).decompressFrames(!0),o=Math.sqrt(s.length),r=[o,o];Math.fract(o)>0&&(r[0]=Math.floor(r[0]+1),r[1]=Math.fract(o)>.5?Math.floor(r[1]+1):Math.floor(r[1]));const a=s[0].dims.width,l=s[0].dims.height,c=document.createElement("canvas"),h=c.getContext("2d"),d=document.createElement("canvas"),u=d.getContext("2d");d.width=a,d.height=l;const m=document.createElement("canvas"),p=m.getContext("2d");let b;m.width=r[0]*a,m.height=r[1]*l;const f=[],g=(t,e)=>{const i=t.dims;f.push(t.delay/10),b&&i.width==b.width&&i.height==b.height||(c.width=i.width,c.height=i.height,b=h.createImageData(i.width,i.height)),b.data.set(t.patch),h.putImageData(b,0,0),2==t.disposalType&&u.clearRect(0,0,d.width,d.height),u.drawImage(c,i.left,i.top),p.drawImage(d,e%r[0]*a,Math.floor(e/r[0])*l)};for(let t=0;t<s.length;t++)g(s[t],t);be$1.addWorkDone(t.id,1);const y=p.getImageData(0,0,m.width,m.height),v=performance.now()-n;console.log(`Decode GIF '${t.name}' time:`+v),e({width:m.width,height:m.height,atlasSize:r,frameRange:[0,s.length],frameDelays:f,imageData:y})},e=>{console.warn("Unable to Load URL:"+e+":"+t.url),i()})}),e[t.id]=this.__resourcePromise),this.__resourcePromise.then(t=>{this.width=t.width,this.height=t.height,this.getParameter("StreamAtlasDesc").setValue(new G$1(t.atlasSize[0],t.atlasSize[1],0,0)),this.getParameter("StreamAtlasIndex").setRange(t.frameRange),this.__unpackedData=t,this.__data=t.imageData,this.__loaded=!0,this.loaded.emit()})}}ot$1.registerLoader("gif",ut$1),J$1.registerClass("GIFImage",ut$1);class bt$1 extends we$1{constructor(t,e={}){let i;null!=t&&-1!=t.lastIndexOf(".")&&(i=t,t=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf("."))),super(t,e),this.__loaded=!1,this.__exposure=1,this.__ambientLightFactor=0,this.__hdrtint=new y$3(1,1,1,1),this.__stream="stream"in e&&e.stream,this.type="FLOAT";const n=this.addParameter(new Fe$1("FilePath"));n.valueChanged.connect(()=>{if(this.loaded.untoggle(),""==this.getName()){const t=n.getStem(),e=t.substring(t.length-1);isNaN(e)?this.setName(t):this.setName(t.substring(0,t.length-1))}const t=n.getValue(),e=n.getFile();this.__loadVLH(t,e)}),i&&this.getParameter("FilePath").setFilepath(i)}getDOMElement(){return this.__domElement}getResourcePath(){return this.getParameter("FilePath").getValue()}__decodeData(t){const e=t.cdm,i=new Blob([t.ldr.buffer]),n=new Image;n.onload=()=>{this.width=n.width,this.height=n.height,this.__data={ldr:n,cdm:e},this.__loaded?this.updated.emit():(this.__loaded=!0,this.loaded.emit())},n.src=URL.createObjectURL(i)}__loadVLH(t,e){this.type="FLOAT",be$1.loadUrl(t,e.url,t=>{if(!t.ldr||!t.cdm)for(const e in t)e.endsWith(".jpg")?(t.ldr=t[e],delete t[e]):e.endsWith(".bin")&&(t.cdm=t[e],delete t[e]);this.__decodeData(t)})}isStream(){return!1}isLoaded(){return this.__loaded}getParams(){const t=super.getParams();return this.__loaded&&(t.data=this.__data,t.exposure=this.__exposure),t}setHDRTint(t){this.__hdrtint=t}getHDRTint(){return this.__hdrtint}toJSON(t,e){}fromJSON(t,e,i){}readBinary(t,e){this.setName(t.loadStr());const i=t.loadStr();if("string"==typeof i&&""!=i){if(e.lod>=0){const t=i.lastIndexOf(".");if(-1!=t){const n=i.substring(0,t)+e.lod+i.substring(t);be$1.resourceAvailable(n)&&(i=n)}}this.getParameter("FilePath").setValue(i)}}}J$1.registerClass("VLHImage",bt$1);const pt$1=1,gt$1=2,_t$1=(t,e)=>e<t?0:1;function Zt$1(t){return t.dot(new _$1(1,1))}function Gt$1(t){return new _$1(Math.abs(t.x),Math.abs(t.y))}function Xt$1(t,e){return new _$1(Math.max(t.x,e),Math.max(t.y,e))}function yt$1(t){const e=function(t){return new Z$1(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))}(t),i=function(t){return new Z$1(2*_t$1(0,t.x)-1,2*_t$1(0,t.y)-1,2*_t$1(0,t.z)-1)}(t),n=new _$1(e.x,e.y);let s=Xt$1(n,1e-20);const o=Math.atan2(s.x,s.y)/Math.HALF_PI;s=Xt$1(new _$1(e.z,n.length()),1e-20);const r=Math.atan2(s.y,s.x)/Math.HALF_PI;let a=new _$1(i.x*o,i.y*(1-o));if(a.scaleInPlace(r),t.z<0){const t=new _$1(a.y,a.x),e=new _$1(i.x,i.y);a=e.subtract(Gt$1(t).multiply(e))}return a.scale(.5).add(new _$1(.5,.5))}function ft$1(t){const e=function(t){return new _$1(2*_t$1(0,t.x)-1,2*_t$1(0,t.y)-1)}(t=t.scale(2).subtract(new _$1(1,1))),i=Zt$1(Gt$1(t)),n=i*Math.PI*.5;if(n<=0)return new Z$1(0,0,1);if(Math.abs(n-Math.PI)<1e-6)return new Z$1(0,0,-1);i>1&&(t=Gt$1(_$1(t.y,t.x)).negate().add(new _$1(1,1)).multiply(e),i=Zt$1(Gt$1(t)));const s=Math.abs(t.x)/i*Math.HALF_PI,o=Math.sin(s),r=Math.cos(s),a=Math.sin(n),l=Math.cos(n);return new Z$1(o*e.x*a,r*e.y*a,l)}class Vt$1 extends bt$1{constructor(t,e={}){super(t,e),this.mapping=gt$1}__decodeData(t){super.__decodeData(t);const e=t.samples;e&&(this.__sampleSets=window.TextDecoder?JSON.parse(new TextDecoder("utf-8").decode(e)):JSON.parse(K$1(e)),this.__sampleSets.luminanceThumbnail&&(this.__thumbSize=Math.sqrt(this.__sampleSets.luminanceThumbnail.length)))}getSampleSets(){return this.__sampleSets}uvToDir(t){switch(this.mapping){case pt$1:return function(t){const e=Math.PI*(2*t-1),i=void 0*Math.PI;return new Z$1(sin(i)*sin(e),-sin(i)*cos(e),cos(i))}(t);case gt$1:return ft$1(t)}}dirToUv(t){switch(this.mapping){case pt$1:return function(t){const e=Math.acos(t.z),i=Math.atan2(t.x,-t.y);return new _$1((1+i/Math.PI)/2,e/Math.PI)}(t);case gt$1:return yt$1(t)}}uvToLuminance(t){const e=Math.floor(t.y*this.__thumbSize)*this.__thumbSize+Math.floor(t.x*this.__thumbSize);return this.__sampleSets.luminanceThumbnail[e]}dirToLuminance(t){return this.uvToLuminance(this.dirToUv(t))}}J$1.registerClass("EnvMap",Vt$1);const It$1=new class{constructor(){this.__labelLibraries={},this.labelLibraryLoaded=new C$1;const t=function(){const t=window.navigator,e=["language","browserLanguage","systemLanguage","userLanguage"];let i,n;if(Array.isArray(t.languages))for(i=0;i<t.languages.length;i++)if(n=t.languages[i],n&&n.length)return n;for(i=0;i<e.length;i++)if(n=t[e[i]],n&&n.length)return n;return null}();t.startsWith("en")?this.__language="En":t.startsWith("es")?this.__language="Es":t.startsWith("fr")?this.__language="Fr":(t.startsWith("gb")||t.startsWith("de"))&&(this.__language="Gb"),this.__foundLabelLibraries={},be$1.registerResourceCallback(".labels",t=>{const e=t.name.split(".")[0];this.__foundLabelLibraries[e]=t,se$1(t.url,t=>{this.__labelLibraries[e]=JSON.parse(t),this.labelLibraryLoaded.emit(e)})}),window.XLSX&&be$1.registerResourceCallback(".xlsx",t=>{const e=t.name.split(".")[0];this.__foundLabelLibraries[e]=t,re$2(t.url,t=>{const i=new Uint8Array(t),n=XLSX.read(i,{type:"array"}),s={};n.SheetNames.forEach((function(t){XLSX.utils.sheet_to_row_object_array(n.Sheets[t]).forEach((function(t){const e=t.Identifier;delete t.Identifier,s[e]=t}))})),this.__labelLibraries[e]=s,this.labelLibraryLoaded.emit(e)})})}isLibraryFound(t){return t in this.__foundLabelLibraries}isLibraryLoaded(t){return t in this.__labelLibraries}getLabelText(t,e){const i=this.__labelLibraries[t];if(!i)throw new Error("LabelLibrary: '"+t+"' not found in LabelManager. Found: ["+Object.keys(this.__labelLibraries)+"]");const n=i[e];if(!n)throw new Error("Label: '"+e+"' not found in LabelLibrary: '"+t+"'. Found: ["+Object.keys(i)+"]");const s=n[this.__language];if(!s){if(n.En)return n.En;throw new Error("labelText: '"+language+"' not found in Label. Found: ["+Object.keys(n)+"]")}return s}setLabelText(t,e,i){let n=this.__labelLibraries[t];n||(n={},this.__labelLibraries[t]=n);let s=n[e];s||(s={},n[e]=s),s[this.__language]=i}setLanguage(t){this.__language=t}};class Rt$1 extends Ee$1{constructor(t,e){super(t),this.__canvasElem=document.createElement("canvas");const i=this.addParameter(new Le$1("library"));this.addParameter(new Le$1("text","")),this.addParameter(new Ie$1("fontColor",new y$3(0,0,0))),this.addParameter(new Ze$1("margin",11)),this.addParameter(new Ze$1("borderWidth",2)),this.addParameter(new Ze$1("borderRadius",11)),this.addParameter(new Xe$1("outline",!1)),this.addParameter(new Xe$1("outlineColor",new y$3(0,0,0))),this.addParameter(new Xe$1("background",!0)),this.addParameter(new Ie$1("backgroundColor",new y$3("#FBC02D"))),this.addParameter(new Xe$1("fillBackground",!0)),this.addParameter(new Xe$1("strokeBackgroundOutline",!0)),this.addParameter(new Ze$1("fontSize",22)),this.addParameter(new Le$1("font","Helvetica")),this.nameChanged.connect(()=>{this.loadLabelData()}),e&&i.setValue(e),this.__requestedRerender=!1,this.__needsRender=!1,this.labelRendered=new C$1,this.loadLabelData()}__parameterValueChanged(t,e){this.__requestedRerender||(this.__requestedRerender=!0,this.loadLabelData())}loadLabelData(){Promise.all([(()=>new Promise(t=>{const e=this.getParameter("library").getValue();if(""==e)return void t();if(!It$1.isLibraryFound(e))return console.warn("Label Libary not found:",e),void t();const i=()=>{try{const t=this.getName(),i=It$1.getLabelText(e,t);this.getParameter("text").setValue(i)}catch(t){console.warn(t)}t()};It$1.isLibraryLoaded(e)?i():It$1.labelLibraryLoaded.connect(t=>{t==e&&i()})}))(),(()=>new Promise(t=>{if(null!=document.fonts){const e=this.getParameter("font").getValue(),i=this.getParameter("fontSize").getValue();document.fonts.load(i+'px "'+e+'"').then(()=>{t()})}else t()}))()]).then(()=>{this.__requestedRerender=!1,this.__needsRender=!0,this.__loaded?this.updated.emit():(this.__loaded=!0,this.loaded.emit())})}renderLabelToImage(){const t=this.__canvasElem.getContext("2d",{alpha:!0});let e=this.getParameter("text").getValue();""==e&&(e=this.getName());const i=this.getParameter("font").getValue(),n=this.getParameter("fontColor").getValue(),s=this.getParameter("fontSize").getValue(),o=this.getParameter("margin").getValue(),r=this.getParameter("borderWidth").getValue(),a=this.getParameter("borderRadius").getValue(),l=this.getParameter("outline").getValue(),c=this.getParameter("outlineColor").getValue(),h=this.getParameter("background").getValue(),d=this.getParameter("backgroundColor").getValue(),u=this.getParameter("fillBackground").getValue(),m=this.getParameter("strokeBackgroundOutline").getValue(),p=o+r,b=e.split("\n");t.font=s+'px "'+i+'"';let f=0;b.forEach(e=>{f=Math.max(t.measureText(e).width,f)});const g=s;this.width=Math.ceil(f+2*p),this.height=Math.ceil(g*b.length+2*p),t.canvas.width=this.width,t.canvas.height=this.height,this.__canvasElem.width=this.width,this.__canvasElem.height=this.height,t.fillStyle="rgba(0, 0, 0, 0.0)",t.fillRect(0,0,this.width,this.height),h&&(t.fillStyle=d.toHex(),t.strokeStyle=c.toHex(),function(t,e,i,n,s,o,r,a,l){if(void 0===a&&(a=!0),void 0===o&&(o=5),"number"==typeof o)o={tl:o,tr:o,br:o,bl:o};else{const t={tl:0,tr:0,br:0,bl:0};for(const e in t)o[e]=o[e]||t[e]}t.beginPath(),t.moveTo(e+o.tl,i),t.lineTo(e+n-o.tr,i),t.quadraticCurveTo(e+n,i,e+n,i+o.tr),t.lineTo(e+n,i+s-o.br),t.quadraticCurveTo(e+n,i+s,e+n-o.br,i+s),t.lineTo(e+o.bl,i+s),t.quadraticCurveTo(e,i+s,e,i+s-o.bl),t.lineTo(e,i+o.tl),t.quadraticCurveTo(e,i,e+o.tl,i),t.closePath(),r&&t.fill(),a&&(t.lineWidth=l,t.stroke())}(t,r,r,this.width-2*r,this.height-2*r,a,u,m,r)),t.font=s+'px "'+i+'"',t.textAlign="left",t.fillStyle=n.toHex(),t.textBaseline="hanging",b.forEach((e,i)=>{t.fillText(e,p,p+i*g)}),l&&(t.strokeStyle=c.toHex(),t.lineWidth=1.5,t.strokeText(e,p,p)),this.__data=t.getImageData(0,0,this.width,this.height),this.__needsRender=!1,this.labelRendered.emit({width:this.width,height:this.height,data:this.__data})}getParams(){return this.__needsRender&&this.renderLabelToImage(),super.getParams()}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__getLabelText()}}J$1.registerClass("Label",Rt$1);class xt$1 extends we$1{constructor(){super(),this.__loaded=!1}connectWebcam(t,e,i=!1){const n={width:t,height:e,frameRate:{ideal:60,max:60}};n.facingMode=i?{exact:"environment"}:{facingMode:"user"};const s=document.createElement("video");s.style.display="none",s.preload="auto",s.crossOrigin="anonymous",document.body.appendChild(s),navigator.mediaDevices.getUserMedia({audio:!1,video:n}).then(t=>{s.srcObject=t,s.onloadedmetadata=()=>{s.play(),this.width=s.videoWidth,this.height=s.videoHeight,console.log("Webcam:["+this.width+", "+this.height+"]"),this.__data=s,this.__loaded=!0,this.loaded.emit(s);let t=0;const e=()=>{if(s.paused||s.ended)return;const i=Math.floor(60*s.currentTime);t!=i&&(this.updated.emit(),t=i),setTimeout(e,20)};e()}}).catch((function(){}))}setVideoStream(t){this.__loaded=!1,this.width=t.videoWidth,this.height=t.videoHeight,this.start(),this.__data=t,this.__loaded=!0,this.loaded.emit(t)}stop(){clearInterval(this.__intervalId)}start(){this.__intervalId=setInterval(()=>{this.updated.emit()},20)}isLoaded(){return this.__loaded}getParams(){return{type:this.type,format:this.format,width:this.width,height:this.height,data:this.__data,flipY:this.getParameter("FlipY").getValue()}}}J$1.registerClass("VideoStreamImage2D",xt$1);class St$1{constructor(t="MaterialLibrary"){this.__name=t,this.lod=0,t$1.isMobileDevice&&(this.lod=1),this.loaded=new C$1,this.clear()}clear(){this.__images={},this.__materials={Default:new Pe$1("Default","SimpleSurfaceShader")}}getPath(){return[this.__name]}getNumMaterials(){return Object.keys(this.__materials).length}getMaterials(){return Object.values(this.__materials)}getMaterialNames(){const t=[];for(const e in this.__materials)t.push(e);return t}hasMaterial(t){return t in this.__materials}addMaterial(t){t.setOwner(this),this.__materials[t.getName()]=t}getMaterial(t,e=!0){const i=this.__materials[t];if(!i&&e)throw new Error("Material:"+t+" not found in library:"+this.getMaterialNames());return i}hasImage(t){return t in this.__images}addImage(t){t.setOwner(this),this.__images[t.getName()]=t}getImage(t,e=!0){const i=this.__images[t];if(!i&&e)throw new Error("Image:"+t+" not found in library:"+this.getImageNames());return i}getImageNames(){const t=[];for(const e in this.__images)t.push(e);return t}load(t){const e=new XMLHttpRequest;e.open("GET",t,!0),e.ontimeout=()=>{throw new Error("The request for "+t+" timed out.")},e.onload=()=>{4===e.readyState&&(200===e.status?this.fromJSON(JSON.parse(e.responseText)):console.warn(e.statusText))},e.send(null)}toJSON(t={},e=0){return{numMaterials:this.geoms.length()}}fromJSON(t,e={},i=0){e.lod=this.lod;for(const n in t.textures)new ot$1(n).fromJSON(t.textures[n]),this.__images[n]=texture;for(const n in t.materials){const e=new Pe$1(n);e.fromJSON(t.materials[n]),this.addMaterial(e)}}readBinary(t,e={}){this.name=t.loadStr(),e.lod=this.lod,e.materialLibrary=this;const i=t.loadUInt32();for(let s=0;s<i;s++){const i=t.loadStr(),n=J$1.constructClass(i,void 0);n.readBinary(t,e),this.__images[n.getName()]=n}const n=t.loadUInt32();if(n>0){const i=t.loadUInt32Array(n);for(let s=0;s<n;s++){const n=new Pe$1("");t.seek(i[s]),n.readBinary(t,e,this.__images),this.addMaterial(n)}}this.loaded.emit()}toString(){return JSON.stringify(this.toJSON(),null,2)}}const Wt$1=new class{constructor(){this.__materialLibraries={},this.materialLibraryLoaded=new C$1,be$1.registerResourceCallback(".matlib",t=>{se$1(t.url,e=>{const i=t.name.split(".")[0],n=JSON.parse(e),s=new St$1(i);s.fromJSON(n),this.__materialLibraries[i]=s,this.materialLibraryLoaded.emit(s)})})}getMaterialLibraryNames(){const t=[];for(const e in this.__materialLibraries)t.push(e);return t}hasMaterialLibrary(t){return t in this.__materialLibraries}getMaterialLibrary(t){const e=this.__materialLibraries[t];return e||console.warn("MaterialLibrary:"+t+" not found in MaterialLibraryManager. Found: ["+this.getMaterialLibraryNames()+"]"),e}resolveMaterialFromPath(t){const e=this.getMaterialLibrary(t[0]);if(e)return e.getMaterial(t[1])}};class Lt$1 extends Q$1{constructor(t,e){super(t,e,"Material"),this.valueParameterValueChanged=new C$1}setValue(t,e=E$1.USER_SETVALUE){this.__value!==t&&(this.__value&&this.__value.parameterValueChanged.disconnect(this.valueParameterValueChanged.emit),this.__value=t,this.__value&&this.__value.parameterValueChanged.connect(this.valueParameterValueChanged.emit),e!=E$1.USER_SETVALUE&&e!=E$1.REMOTEUSER_SETVALUE||(this.__flags|=H$1.USER_EDITED),e!=E$1.OPERATOR_SETVALUE&&this.valueChanged.emit(e))}toJSON(t,e){if(0!=(this.__flags&H$1.USER_EDITED))return{value:this.__value.getPath()}}fromJSON(t,e,i){if(null==t.value)return void console.warn("Invalid Parameter JSON");const n=Wt$1.resolveMaterialFromPath(t.value);n&&this.setValue(n),this.__flags|=H$1.USER_EDITED}clone(t){return new Lt$1(this.__name,this.__value)}destroy(){this.__value&&this.__value.parameterValueChanged.disconnect(this.valueParameterValueChanged.emit)}}class vt$1{constructor(t,e,i){if(this.__dataType=t,this.normalized=!1,null!=t.numElements)this.__dimension=this.__dataType.numElements();else switch(t){case 6:case 4:case 5:this.__dimension=1;break;default:throw new Error("Invalid data type for attribute:"+t)}var n;this.__defaultElementValue=null!=i?i:Number.MAX_VALUE,(n=e)&&void 0!==n.byteLength?this.__data=e:(this.__data=new Float32Array(e*this.__dimension),this.initRange(0))}resize(t){const e=this.__data.length,i=t*this.__dimension,n=new Float32Array(i);for(let s=0;s<Math.min(this.__data.length,i);s++)n[s]=this.__data[s];this.__data.length<i&&(this.__data=n),this.initRange(e)}initRange(t){for(let e=t;e<this.__data.length;e++)this.__data[e]=this.__defaultElementValue}getCount(){return this.__data.length/this.__dimension}get length(){return this.__data.length/this.__dimension}get dataType(){return this.__dataType}get data(){return this.__data}set data(t){this.__data=t}get numElements(){return this.__dimension}getFloat32Value(t){return this.__data[t]}setFloat32Value(t,e){this.__data[t]=e}getValueRef(t){const e=this.__dimension;if(t>=this.__data.length/e)throw new Error("Invalid vertex index:"+t+". Num Vertices:"+this.__data.length/3);return this.__dataType.createFromFloat32Buffer(this.__data.buffer,t*e)}setValue(t,e){const i=this.__dimension;if(t>=this.__data.length/i)throw new Error("Invalid vertex index:"+t+". Num Vertices:"+this.__data.length/3);this.__dataType.createFromFloat32Buffer(this.__data.buffer,t*i).setFromOther(e)}toJSON(t,e){return{data:Array.from(this.__data),dataType:g$1.getTypeName(this.__dataType),defaultValue:this.__defaultElementValue,length:this.__data.length/this.__dimension}}fromJSON(t){this.__data=Float32Array.from(t.data)}toString(){return JSON.stringify(this.toJSON(),null,2)}}class Tt extends q$1{constructor(){super(),this.__boundingBox=new v$1,this.__boundingBoxDirty=!0,this.__vertexAttributes=new Map,this.__metaData=new Map,this.addVertexAttribute("positions",Z$1,0),this.boundingBoxDirtied=new C$1,this.geomDataChanged=new C$1,this.geomDataTopologyChanged=new C$1}setDebugName(t){this.__name=t}addVertexAttribute(t,e,i){let n;var s;return n=(s=i)&&void 0!==s.byteLength?new vt$1(e,i):new vt$1(e,null!=this.vertices?this.vertices.length:0,i),this.__vertexAttributes.set(t,n),n}hasVertexAttribute(t){return this.__vertexAttributes.has(t)}getVertexAttribute(t){return this.__vertexAttributes.get(t)}getVertexAttributes(t){const e={};for(const[i,n]of this.__vertexAttributes.entries())e[i]=n;return e}get vertices(){return this.__vertexAttributes.get("positions")}numVertices(){return this.vertices.length}getNumVertices(){return this.vertices.length}setNumVertices(t){this.__vertexAttributes.forEach(e=>e.resize(t))}getVertex(t){return Z$1.createFromFloat32Buffer(this.vertices.data.buffer,3*t)}setVertex(t,e){return Z$1.createFromFloat32Buffer(this.vertices.data.buffer,3*t).setFromOther(e)}moveVertices(t){const e=this.vertices;for(let i=0;i<e.length;i++)e.getValueRef(i).addInPlace(t);this.setBoundingBoxDirty()}transformVertices(t){const e=this.vertices;for(let i=0;i<e.length;i++){const n=e.getValueRef(i),s=t.transformVec3(n);n.set(s.x,s.y,s.z)}this.setBoundingBoxDirty()}get boundingBox(){return this.__boundingBoxDirty&&this.updateBoundingBox(),this.__boundingBox}setBoundingBoxDirty(){this.__boundingBoxDirty=!0,this.boundingBoxDirtied.emit()}updateBoundingBox(){const t=this.vertices,e=new v$1,i=t.length;for(let n=0;n<i;n++)e.addPoint(t.getValueRef(n));this.__boundingBox=e,this.__boundingBoxDirty=!1}getMetadata(t){return this.__metaData.get(t)}hasMetadata(t){return this.__metaData.has(t)}setMetadata(t,e){this.__metaData.set(t,e)}deleteMetadata(t){this.__metaData.delete(t)}genBuffers(t){const e={};for(const[i,n]of this.__vertexAttributes)e[i]={values:n.data,count:n.size,dataType:n.dataType,normalized:n.normalized};return{numVertices:this.numVertices(),attrBuffers:e}}freeBuffers(){}loadBaseGeomBinary(t){this.name=t.loadStr();const e=t.loadUInt8();this.debugColor=t.loadRGBFloat32Color();const i=t.loadUInt32();this.__boundingBox.set(t.loadFloat32Vec3(),t.loadFloat32Vec3()),this.setNumVertices(i);const n=this.vertices;let s,o;2&e&&(s=this.getVertexAttribute("normals"),s||(s=this.addVertexAttribute("normals",Z$1,0))),4&e&&(o=this.getVertexAttribute("texCoords"),o||(o=this.addVertexAttribute("texCoords",_$1,0)));const r=(t,e,i,s)=>{for(let o=t[0];o<t[1];o++){const t=new Z$1(s[3*o+0]/255,s[3*o+1]/255,s[3*o+2]/255);t.multiplyInPlace(i),t.addInPlace(e),n.setValue(o,t)}},a=(t,e,i,n)=>{i.isNull()&&i.set(1,1,1);for(let o=t[0];o<t[1];o++){const t=new Z$1(n[3*o+0]/255,n[3*o+1]/255,n[3*o+2]/255);t.multiplyInPlace(i),t.addInPlace(e),t.normalizeInPlace(),s.setValue(o,t)}},l=(t,e,i,n)=>{for(let s=t[0];s<t[1];s++){const t=new _$1(n[2*s+0]/255,n[2*s+1]/255);t.multiplyInPlace(i),t.addInPlace(e),o.setValue(s,t)}},c=t.loadUInt32();if(1==c){{const e=this.__boundingBox,n=t.loadUInt8Array(3*i);r([0,i],e.p0,e.diagonal(),n)}if(s){const e=new v$1(t.loadFloat32Vec3(),t.loadFloat32Vec3()),n=t.loadUInt8Array(3*i);a([0,i],e.p0,e.diagonal(),n),s.loadSplitValues(t)}if(o){const e=new W$1(t.loadFloat32Vec2(),t.loadFloat32Vec2()),n=t.loadUInt8Array(2*i);l([0,i],e.p0,e.diagonal(),n),o.loadSplitValues(t)}}else{const e=[];let n=0;for(let i=0;i<c;i++){const i=t.loadUInt32(),r={range:[n,n+i],bbox:new v$1(t.loadFloat32Vec3(),t.loadFloat32Vec3())};s&&(r.normalsRange=new v$1(t.loadFloat32Vec3(),t.loadFloat32Vec3())),o&&(r.texCoordsRange=new W$1(t.loadFloat32Vec2(),t.loadFloat32Vec2())),e.push(r),n+=i}const h=t.loadUInt8Array(3*i);let d,u;s&&(d=t.loadUInt8Array(3*i)),o&&(u=t.loadUInt8Array(2*i));for(let t=0;t<c;t++){{const i=e[t].bbox;r(e[t].range,i.p0,i.diagonal(),h)}if(s){const i=e[t].normalsRange;a(e[t].range,i.p0,i.diagonal(),d)}if(o){const i=e[t].texCoordsRange;l(e[t].range,i.p0,i.diagonal(),u)}}s&&s.loadSplitValues(t),o&&o.loadSplitValues(t)}}toJSON(t,e){let i=super.toJSON(t,e);if(i||(i={}),i.type=J$1.getClassName(this),!(1024&e)){const n={};for(const[i,s]of this.__vertexAttributes.entries())n[i]=s.toJSON(t,e);i.vertexAttributes=n}return i}fromJSON(t,e,i){super.fromJSON(t,e,i);for(const n in t.vertexAttributes){let e=this.__vertexAttributes.get(n);const i=t.vertexAttributes[n];if(!e){const t=g$1.getType(i.dataType);e=new VertexAttribute(this,t,0,i.defaultScalarValue),this.__vertexAttributes.set(n,e)}e.fromJSON(i)}}toString(){return JSON.stringify(this.toJSON(),null,2)}}class Mt$1 extends vt$1{constructor(t,e,i,n){super(e,i,n),this.__geom=t,this.__splits={},this.__splitValues=[]}getFaceVertexValueRef(t,e){const i=this.__geom.getFaceVertexIndex(t,e);return i in this.__splits&&t in this.__splits[i]?this.__splitValues[this.__splits[i][t]]:this.getValueRef(i)}setFaceVertexValue(t,e,i){const n=this.__geom.getFaceVertexIndex(t,e);this.setFaceVertexValue_ByVertexIndex(t,n,i)}setFaceVertexValue_ByVertexIndex(t,e,i){const n=this.getValueRef(e);if(n.isValid())if(n.approxEqual(i));else{if(e in this.__splits){const n=this.__splits[e];for(const e in n){const s=n[e];if(this.__splitValues[s].approxEqual(i))return void(n[t]=s)}if(t in this.__splits[e])return void this.__splitValues[this.__splits[e][t]].setFromOther(i)}else this.__splits[e]={};this.__splits[e][t]=this.__splitValues.length,this.__splitValues.push(i)}else n.setFromOther(i)}setSplitVertexValue(t,e,i){if(t in this.__splits||(this.__splits[t]={}),e in this.__splits[t]){if(this.__splitValues[this.__splits[t][e]].approxEqual(i))return;console.warn("Face Vertex Already Split with different value")}this.__splits[t][e]=this.__splitValues.length,this.__splitValues.push(i)}setSplitVertexValues(t,e,i){t in this.__splits||(this.__splits[t]={});const n=this.__splitValues.length;this.__splitValues.push(i);for(const s of e)this.__splits[t][s]=n}getSplits(){return this.__splits}getSplitCount(){let t=0;for(const e in this.__splits)t+=Object.keys(this.__splits[e]).length;return t}generateSplitValues(t,e){if(0==e)return this.__data;const i=this.length,n=this.length+e,s=this.__dataType.numElements?this.__dataType.numElements():1,o=new Float32Array(n*s);for(let r=0;r<this.__data.length;r++)o[r]=this.__data[r];for(const r in t){const e=t[r];for(const t in e){const n=i+e[t];if(r in this.__splits&&t in this.__splits[r]){const e=this.__splits[r][t];6==this.__dataType?o[n*s]=this.__splitValues[e]:this.__dataType.createFromFloat32Buffer(o.buffer,n*s).setFromOther(this.__splitValues[e])}else{const t=parseInt(r);for(let e=0;e<s;e++)t*s+e>this.__data.length&&console.log("Error remapping src:"+t*s+e),n*s+e>o.length&&console.log("Error remapping tgt:"+n*s+e),o[n*s+e]=this.__data[t*s+e]}}}return o}toJSON(t,e){const i=super.toJSON(t,e);return i.splits=this.__splits,i.splitValues=this.__splitValues,i}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__splits=t.splits,this.__splitValues=[];for(const n of t.splitValues)this.__splitValues.push(this.__dataType.createFromJSON(n))}loadSplitValues(t){const e=t.loadUInt32Array();if(0==e.length)return;let i=0,n=0;for(;;){const t=e[i++],s=e[i++],o={};for(let r=0;r<s;r++){const t=e[i++],s=e[i++];o[t]=s,s>=n&&(n=s+1)}if(this.__splits[t]=o,i>=e.length)break}const s=this.__numFloat32Elements,o=t.loadFloat32Array(n*s);this.__splitValues=[];for(let r=0;r<n;r++){const t=this.__dataType.createFromFloat32Array(o.slice(r*s,r*s+s));this.__splitValues.push(t)}}}class Ct$1 extends Tt{constructor(){super()}loadBin(t){this.name=t.loadStr();const e=t.loadUInt32();this.__boundingBox.set(t.loadFloat32Vec3(),t.loadFloat32Vec3()),this.setNumVertices(e);const i=this.vertices;if(e<256){const n=this.__boundingBox.toMat4(),s=t.loadUInt8Array(3*e);for(let t=0;t<e;t++){const e=new Vec3(s[3*t+0]/255,s[3*t+1]/255,s[3*t+2]/255);i.setValue(t,n.transformVec3(e))}}else{const n=t.loadUInt32(),s=[];for(let e=0;e<n;e++){const e=t.loadUInt32Vec2(),i=t.loadFloat32Vec3(),n=t.loadFloat32Vec3();s.push({range:e,bbox:new Box3(i,n)})}const o=t.loadUInt8Array(3*e);for(let t=0;t<n;t++){const e=s[t].bbox.toMat4();for(let n=s[t].range.x;n<s[t].range.y;n++){const t=new Vec3(o[3*n+0]/255,o[3*n+1]/255,o[3*n+2]/255);i.setValue(n,e.transformVec3(t))}}}}readBinary(t,e){super.loadBaseGeomBinary(t),this.geomDataChanged.emit()}}class Nt$1 extends Tt{constructor(){super(),this.__indices=new Uint32Array,this.__segmentAttributes=new Map,this.lineThickness=0}getIndices(){return this.__indices}getNumSegments(){return this.__indices.length/2}setNumSegments(t){const e=new Uint32Array(2*t);this.__indices=e}setSegment(t,e,i){if(t>=this.__indices.length/2)throw new Error("Invalid line index:"+t+". Num Segments:"+this.__indices.length/2);this.__indices[2*t+0]=e,this.__indices[2*t+1]=i}getSegmentVertexIndex(t,e){if(t<this.numLines)return this.__indices[2*t+e]}addSegmentAttribute(t,e,i){const n=new Attribute(e,null!=i?i:this.polygonCount);return this.__segmentAttributes.set(t,n),n}hasSegmentAttribute(t){return this.__segmentAttributes.has(t)}getSegmentAttribute(t){return this.__segmentAttributes.get(t)}genBuffers(){const t=super.genBuffers();let e;return t.numVertices<Math.pow(2,8)?(e=new Uint8Array(this.__indices.length),this.__indices.forEach((t,i)=>{e[i]=t})):t.numVertices<Math.pow(2,16)?(e=new Uint16Array(this.__indices.length),this.__indices.forEach((t,i)=>{e[i]=t})):e=this.__indices,t.indices=e,t}readBinary(t,e){super.loadBaseGeomBinary(t),this.setNumSegments(t.loadUInt32());const i=t.loadUInt8();1==i?this.__indices=t.loadUInt8Array():2==i?this.__indices=t.loadUInt16Array():4==i&&(this.__indices=t.loadUInt32Array()),this.geomDataChanged.emit()}toJSON(t,e){const i=super.toJSON(t,e);return 1024&e||(i.indices=Array.from(this.__indices)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__indices=Uint32Array.from(t.indices)}}class Yt$1 extends Tt{constructor(){super(),this.init()}init(){this.__faceCounts=[],this.__faceVertexCounts=new Uint8Array,this.__faceOffsets=new Uint32Array,this.__faceVertexIndices=new Uint32Array,this.__numPopulatedFaceVertexIndices=0,this.__faceAttributes=new Map,this.__edgeAttributes=new Map,this.__logTopologyWarnings=!1,this.edgeVerts=void 0,this.vertexEdges=void 0,this.numEdges=0,this.edgeFlags=new Uint32Array,this.edgeAngles=new Float32Array}getFaceVertexIndices(){return this.__faceVertexIndices}getFaceCounts(){return this.__faceCounts}clear(){this.__faceVertexIndices=void 0,this.__faceCounts=[],this.__numPopulatedFaceVertexIndices=0}setFaceCounts(t){if(this.__numPopulatedFaceVertexIndices)throw new Error("Cannot set face counts on a mesh that is already populated. Please call 'clear' before re-building the mesh.");this.__faceCounts=t;let e=0,i=0,n=3;for(const s of this.__faceCounts)e+=s,i+=s*n,n++;this.__faceVertexCounts=new Uint8Array(e),this.__faceOffsets=new Uint32Array(e),this.__faceVertexIndices=new Uint32Array(i);for(const s of this.__faceAttributes)s.resize(e)}setFaceVertexIndices(t){const e=Array.prototype.slice.call(arguments,1),i=this.__numPopulatedFaceVertexIndices;for(let n=0;n<e.length;n++)this.__faceVertexIndices[i+n]=e[n];this.__faceVertexCounts[t]=e.length-3,this.__faceOffsets[t]=i,this.__numPopulatedFaceVertexIndices+=e.length}getFaceVertexIndices(t){const e=[],i=this.__faceOffsets[t],n=this.__faceVertexCounts[t]+3;for(let s=0;s<n;s++)e.push(this.__faceVertexIndices[i+s]);return e}getFaceVertexIndex(t,e){return this.__faceVertexIndices[this.__faceOffsets[t]+e]}getNumFaces(){return this.__faceVertexCounts.length}addVertexAttribute(t,e,i){const n=new Mt$1(this,e,null!=this.vertices?this.vertices.length:0,i);return this.__vertexAttributes.set(t,n),n}addFaceAttribute(t,e,i){const n=new vt$1(e,null!=i?i:this.getNumFaces());return this.__faceAttributes.set(t,n),n}hasFaceAttribute(t){return this.__faceAttributes.has(t)}getFaceAttribute(t){return this.__faceAttributes.get(t)}addEdgeAttribute(t,e,i){const n=new vt$1(e,null!=i?i:this.getNumEdges());return this.__edgeAttributes.set(t,n),n}hasEdgeAttribute(t){return this.__edgeAttributes.has(t)}getEdgeAttribute(t){return this.__edgeAttributes.get(t)}genTopologyInfo(){const t={};this.vertexEdges=[],this.edgeFaces=[],this.edgeVerts=[],this.faceEdges=[],this.numEdges=0;const e=(e,i)=>{let n=e,s=i;if(s<n){const t=n;n=s,s=t}const o=n+">"+s;if(o in t)return t[o];const r=this.vertices.getValueRef(n),a=this.vertices.getValueRef(s).subtract(r),l={edgeIndex:this.edgeFaces.length/2,edgeVec:a};return t[o]=l,this.edgeFaces.push(-1),this.edgeFaces.push(-1),this.edgeVerts.push(n),this.edgeVerts.push(s),this.numEdges++,l},i=(t,i,n)=>{const s=e(t,i).edgeIndex;if(i<t){const t=2*s+0;this.__logTopologyWarnings&&-1!=this.edgeFaces[t]&&console.warn("Edge poly 0 already set. Mesh is non-manifold."),this.edgeFaces[t]=n}else{const t=2*s+1;this.__logTopologyWarnings&&-1!=this.edgeFaces[t]&&console.warn("Edge poly 1 already set. Mesh is non-manifold."),this.edgeFaces[t]=n}n in this.faceEdges||(this.faceEdges[n]=[]),this.faceEdges[n].push(s),null==this.vertexEdges[t]&&(this.vertexEdges[t]=new Set),null==this.vertexEdges[i]&&(this.vertexEdges[i]=new Set),this.vertexEdges[t].add(s),this.vertexEdges[i].add(s)},n=this.getNumFaces();for(let s=0;s<n;s++){const t=this.getFaceVertexIndices(s);for(let e=0;e<t.length;e++)i(t[e],t[(e+1)%t.length],s)}}computeFaceNormals(){const t=this.vertices,e=this.addFaceAttribute("normals",Z$1),i=this.getNumFaces();for(let n=0;n<i;n++){const i=this.getFaceVertexIndices(n),s=t.getValueRef(i[0]);let o=t.getValueRef(i[1]);const r=new Z$1;for(let e=2;e<i.length;e++){const n=t.getValueRef(i[e]),a=o.subtract(s),l=n.subtract(s);r.addInPlace(a.cross(l).normalize()),o=n}r.lengthSquared(),e.setValue(n,r.normalize())}}generateEdgeFlags(){null==this.vertexEdges&&this.genTopologyInfo(),this.hasFaceAttribute("normals")||this.computeFaceNormals();const t=this.vertices,e=this.getFaceAttribute("normals");this.edgeVecs=[],this.edgeAngles=new Float32Array(this.numEdges);for(let i=0;i<this.edgeFaces.length;i+=2){const n=this.edgeVerts[i],s=t.getValueRef(this.edgeVerts[i+1]).subtract(t.getValueRef(n));s.normalizeInPlace(),this.edgeVecs.push(s);const o=this.edgeFaces[i],r=this.edgeFaces[i+1];if(-1==o||-1==r){this.edgeAngles[i/2]=2*Math.PI;continue}const a=e.getValueRef(o),l=e.getValueRef(r);this.edgeAngles[i/2]=a.angleTo(l)}}computeVertexNormals(t=1){this.generateEdgeFlags();const e=this.getFaceAttribute("normals"),i=this.addVertexAttribute("normals",Z$1),n=e.data.buffer,s=t=>new Z$1(n,12*t),o=i.data,r=(t,e)=>{o[3*t+0]=e.x,o[3*t+1]=e.y,o[3*t+2]=e.z},a=(t,e)=>{let i,n;const s=this.faceEdges[t];for(const o of s)(this.edgeVerts[2*o]==e||this.edgeVerts[2*o+1]==e)&&(i?n=this.edgeVecs[o]:i=this.edgeVecs[o]);return[i,n]};for(let l=0;l<this.vertexEdges.length;l++){if(null==this.vertexEdges[l])continue;const e=this.vertexEdges[l],n=[],o=t=>{let e=!1;for(const i of n)if(e=-1!=i.indexOf(t),e)break;e||n.push([t])};for(const i of e){const e=this.edgeFaces[2*i],s=this.edgeFaces[2*i+1];if(-1!=e&&-1==s&&this.edgeAngles[i]<t){let t=-1,i=-1;for(let o=0;o<n.length;o++)-1==t&&-1!=n[o].indexOf(e)&&(t=o),-1==i&&-1!=n[o].indexOf(s)&&(i=o);-1==t&&-1==i?n.push([e,s]):-1!=t&&-1!=i?t!=i&&(n[t]=n[t].concat(n[i]),n.splice(i,1)):(-1==t&&n[i].push(e),-1==i&&n[t].push(s))}else-1!=e&&o(e),-1!=s&&o(s)}n.sort((t,e)=>t.length<e.length?1:t.length>e.length?-1:0);let c=!0;for(const t of n){const e=new Z$1;for(const i of t){const t=a(i,l),n=t[0].angleTo(t[1]);e.addInPlace(s(i).scale(n))}e.normalizeInPlace(),c?(r(l,e),c=!1):i.setSplitVertexValues(l,t,e)}}return i}computeNumTriangles(){let t=3,e=0;for(const i of this.__faceCounts)e+=i*(t-2),t++;return e}generateTriangulatedIndices(t,e,i){const n=this.computeNumTriangles();let s;s=t<Math.pow(2,8)?new Uint8Array(3*n):t<Math.pow(2,16)?new Uint16Array(3*n):new Uint32Array(3*n);let o=0;const r=function(t,n){t in i&&n in i[t]&&(t=e+i[t][n]),s[o]=t,o++},a=this.getNumFaces();for(let l=0;l<a;l++){const t=this.getFaceVertexIndices(l);for(let e=0;e<t.length;e++)e>=3&&(r(t[0],l),r(t[e-1],l)),r(t[e],l)}return s}computeHardEdgesIndices(t=1){const e=[],i=t=>{e.push(this.edgeVerts[t]),e.push(this.edgeVerts[t+1])};for(let n=0;n<this.edgeFlags.length;n+=2)this.edgeAngles[n/2]>t&&i(n);return e}getWireframeIndices(){return indices}genBuffers(t){const e={};let i=0;for(const[,l]of this.__vertexAttributes){const t=l.getSplits();for(const n in t){n in e||(e[n]={});const s=t[n];for(const t in s){const s=parseInt(t);s in e[n]||(e[n][s]=i,i++)}}}const n=this.vertices.length,s=n+i;let o;t&&0==t.includeIndices||(o=this.generateTriangulatedIndices(s,n,e));const r={};for(const[l,c]of this.__vertexAttributes){let t;t=0==i?c.data:c.generateSplitValues(e,i);const n=c.numElements;r[l]={values:t,count:t.length/n,dimension:n,normalized:"normals"==l,dataType:c.dataType}}const a={numVertices:this.numVertices(),numRenderVerts:s,indices:o,attrBuffers:r};if(t&&t.includeVertexNeighbors){null==this.vertexEdges&&this.genTopologyInfo();let t=0;for(let o=0;o<this.vertexEdges.length;o++)this.vertexEdges[o]&&(t+=this.vertexEdges[o].size);const e=new Uint32Array(2*this.vertexEdges.length+t),i=t=>{for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<e;n++){const s=t[n];if(-1!=i[0]&&i[0]==s[1]){e!=n+1&&(t.splice(e,1),t.splice(n+1,0,i));break}if(-1!=i[1]&&i[1]==s[0]){t.splice(e,1),t.splice(n,0,i);break}}}},n=t=>{if(!(-1!=t[0][0]&&-1!=t[t.length-1][1]||-1==t[0][0]&&-1==t[t.length-1][1]))throw new Error("If fan starts with -1, it must also end with -1");for(let e=0;e<t.length;e++){const i=t[e];if((-1==i[0]||-1==i[1])&&0!=e&&e!=t.length-1)throw new Error("-1 only allowed at the beginning and end of a fan.");if(-1!=i[0]){let n=e-1;if(n<0&&(n+=t.length),i[0]!=t[n][1])throw new Error("Faces are not sequential")}if(-1!=i[1]&&i[1]!=t[(e+1)%t.length][0])throw new Error("Faces are not sequential")}};let s=2*this.vertexEdges.length;for(let o=0;o<this.vertexEdges.length;o++){if(null==this.vertexEdges[o])continue;const t=this.vertexEdges[o],r=[];for(const e of t){const t=this.edgeVerts[2*e],i=this.edgeVerts[2*e+1];let n,s=this.edgeFaces[2*e],a=this.edgeFaces[2*e+1];if(t==o)n=i;else{if(i!=o)throw new Error("Invalid topology");{n=t;const e=s;s=a,a=e}}r.push([s,a,n])}i(r),n(r);let a=0;(-1!=r[0][0]||-1!=r[r.length-1][1])&&(a+=1),e[2*o]=s,e[2*o+1]=t.size+(a<<8);for(const i of r)e[s]=i[2],s++}a.vertexNeighbors=e}return a}freeBuffers(){super.freeBuffers(),this.init()}readBinary(t,e){super.loadBaseGeomBinary(t),this.setFaceCounts(t.loadUInt32Array()),this.__faceVertexCounts=t.loadUInt8Array(this.__faceVertexCounts.length);const i=t.loadSInt32Vec2(),n=t.loadUInt8();let s;1==n?s=t.loadUInt8Array():2==n?s=t.loadUInt16Array():4==n&&(s=t.loadUInt32Array());const o=this.getNumFaces();let r=0,a=0;for(let c=0;c<o;c++){const t=this.__faceVertexCounts[c]+3;this.__faceOffsets[c]=r;for(let e=0;e<t;e++){const t=r+e,n=s[t]+i.x;if(0==c)this.__faceVertexIndices[t]=n;else{let i=this.__faceOffsets[c-1];i+=e<a?e:a-1,this.__faceVertexIndices[t]=this.__faceVertexIndices[i]+n}}r+=t,a=t}this.__numPopulatedFaceVertexIndices=r;const l=t.loadUInt32();if(l>0){const e=this.vertices,i=this.addVertexAttribute("lightmapCoords",_$1);for(let n=0;n<l;n++){const n=new S$1(t.loadFloat32Vec3(),t.loadFloat32Quat()),s=t.loadFloat32(),o=t.loadFloat32Vec2(),r=t.loadSInt32Vec2(),a=t.loadUInt8();let l;l=1==a?t.loadUInt8Array():2==a?t.loadUInt16Array():t.loadUInt32Array();let c=0;for(const t of l){let a=t+r.x;a+=c,c=a;const l=this.getFaceVertexIndices(a);for(const t of l){const r=e.getValueRef(t),l=n.transformVec3(r),c=new _$1(l.x,l.z);c.scaleInPlace(s),c.addInPlace(o),i.setFaceVertexValue_ByVertexIndex(a,t,c)}}}}this.hasVertexAttribute("normals")||this.computeVertexNormals(),this.geomDataChanged.emit()}toJSON(t,e){const i=super.toJSON(t,e);return 1024&e||(i.faceCounts=Array.from(this.__faceCounts),i.faceVertexIndices=Array.from(this.__faceVertexIndices)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.faceCounts&&(this.__faceCounts=Uint32Array.from(t.faceCounts)),t.faceVertexIndices&&(this.__faceVertexIndices=Uint32Array.from(t.faceVertexIndices))}}class Kt$1 extends U$1{constructor(t){if(super(),this.name=t.name,this.__buffers=t.geomBuffers,this.__buffers.attrBuffers)for(const e in this.__buffers.attrBuffers){const t=this.__buffers.attrBuffers[e],i=g$1.getType(t.dataType);t.dataType=i}this.boundingBox=new v$1,this.boundingBox.p0.__data=t.bbox.p0.__data,this.boundingBox.p1.__data=t.bbox.p1.__data,this.__metaData=new Map,this.boundingBoxDirtied=new C$1,this.geomDataChanged=new C$1,this.geomDataTopologyChanged=new C$1}genBuffers(){return this.__buffers}freeBuffers(){if(this.__buffers.indices&&delete this.__buffers.indices,this.__buffers.attrBuffers){for(const t in this.__buffers.attrBuffers)delete this.__buffers.attrBuffers[t];delete this.__buffers.attrBuffers}}getMetadata(t){return this.__metaData.get(t)}hasMetadata(t){return this.__metaData.has(t)}setMetadata(t,e){this.__metaData.set(t,e)}}class wt$1 extends Kt$1{constructor(t){super(t)}}class zt$1 extends Kt$1{constructor(t){super(t)}}class Ut$1 extends Kt$1{constructor(t){super(t)}}class Jt$1 extends Ct$1{constructor(t=1,e=1,i=1,n=1,s=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__x=t,this.__y=e,this.__xDivisions=i,this.__yDivisions=n,s&&this.addVertexAttribute("texCoords",_$1),this.__rebuild()}get x(){return console.warn("getter is deprectated. Please use 'getX'"),this.getX()}set x(t){console.warn("getter is deprectated. Please use 'setX'"),this.setX(t)}get y(){return console.warn("getter is deprectated. Please use 'getY'"),this.getY()}set y(t){console.warn("getter is deprectated. Please use 'setY'"),this.setY(t)}getX(){return this.__x}setX(t){this.__x=t,this.__resize()}getY(){return this.__y}setY(t){this.__y=t,this.__resize()}setSize(t,e){this.__x=t,this.__y=e,this.__resize()}__rebuild(){this.setNumVertices(this.__xDivisions*this.__yDivisions);const t=this.getVertexAttribute("texCoords");if(t)for(let e=0;e<this.__yDivisions;e++){const i=e/(this.__yDivisions-1);for(let n=0;n<this.__xDivisions;n++){const s=n/(this.__xDivisions-1);t.getValueRef(e*this.__xDivisions+n).set(s,i)}}this.__resize()}__resize(){for(let t=0;t<this.__yDivisions;t++){const e=(t/(this.__yDivisions-1)-.5)*this.__y;for(let i=0;i<this.__xDivisions;i++){const n=(i/(this.__xDivisions-1)-.5)*this.__x;this.getVertex(t*this.__xDivisions+i).set(n,e,0)}}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t.xDivisions=this.__xDivisions,t.yDivisions=this.__yDivisions,t}}class Pt$1 extends Nt$1{constructor(t=1,e=1){if(super(),isNaN(t)||isNaN(e))throw new Error("Invalid geom args");this.__x=this.addParameter(new Ze$1("x",t)),this.__x.valueChanged.connect(this.__resize.bind(this)),this.__y=this.addParameter(new Ze$1("y",e)),this.__y.valueChanged.connect(this.__resize.bind(this)),this.__rebuild()}get x(){return this.__x.getValue()}set x(t){this.__x.setValue(t)}get y(){return this.__y.getValue()}set y(t){this.__y.setValue(t)}setSize(t,e){this.__x.setValue(t,-1),this.__y.setValue(e,-1),this.__resize()}__rebuild(){this.setNumVertices(4),this.setNumSegments(4),this.setSegment(0,0,1),this.setSegment(1,1,2),this.setSegment(2,2,3),this.setSegment(3,3,0),this.__resize(-1),this.geomDataTopologyChanged.emit()}__resize(t){const e=this.__x.getValue(),i=this.__y.getValue();this.getVertex(0).set(-.5*e,-.5*i,0),this.getVertex(1).set(.5*e,-.5*i,0),this.getVertex(2).set(.5*e,.5*i,0),this.getVertex(3).set(-.5*e,.5*i,0),this.setBoundingBoxDirty(),-1!=t&&this.geomDataChanged.emit()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t}}J$1.registerClass("Rect",Pt$1);class Et$1 extends Nt$1{constructor(t=1,e=2*Math.PI,i=32){if(super(),isNaN(t)||isNaN(i))throw new Error("Invalid geom args");this.__radius=this.addParameter(new Ze$1("Radius",t)),this.__angle=this.addParameter(new Ze$1("Angle",e)),this.__numSegments=this.addParameter(new Ze$1("NumSegments",i>=3?i:3,[3,200],1)),this.__radius.valueChanged.connect(this.__resize.bind(this)),this.__angle.valueChanged.connect(this.__rebuild.bind(this)),this.__numSegments.valueChanged.connect(this.__rebuild.bind(this)),this.__rebuild()}__rebuild(){const t=this.__numSegments.getValue();this.setNumVertices(t);const e=this.__angle.getValue()<2*Math.PI;this.setNumSegments(e?t-1:t);for(let i=0;i<(e?t-1:t);i++)this.setSegment(i,i,(i+1)%t);this.__resize(-1),this.geomDataTopologyChanged.emit()}__resize(t){const e=this.__radius.getValue(),i=this.__numSegments.getValue(),n=this.__angle.getValue()/i;for(let s=0;s<i;s++)this.getVertex(s).set(Math.cos(n*s)*e,Math.sin(n*s)*e,0);this.setBoundingBoxDirty(),-1!=t&&this.geomDataChanged.emit()}}J$1.registerClass("Circle",Et$1);class Ht$1 extends Nt$1{constructor(t=1){if(super(),isNaN(t))throw new Error("Invalid geom args");this.__sizeParam=this.addParameter(new Ze$1("size",t)),this.__rebuild(),this.__sizeParam.valueChanged.connect(()=>{this.__resize()})}get size(){return this.__size}set size(t){this.__size=t,this.__resize()}__rebuild(){this.setNumVertices(6),this.setNumSegments(3),this.setSegment(0,0,1),this.setSegment(1,2,3),this.setSegment(2,4,5),this.__resize()}__resize(){const t=this.__sizeParam.getValue();this.getVertex(0).set(-.5*t,0,0),this.getVertex(1).set(.5*t,0,0),this.getVertex(2).set(0,.5*t,0),this.getVertex(3).set(0,-.5*t,0),this.getVertex(4).set(0,0,.5*t),this.getVertex(5).set(0,0,-.5*t),this.setBoundingBoxDirty()}}J$1.registerClass("Cross",Ht$1);class kt$1 extends Nt$1{constructor(t=1,e=1,i=1,n=!1){super(),this.__x=this.addParameter(new Ze$1("x",t)),this.__x.valueChanged.connect(this.__resize.bind(this)),this.__y=this.addParameter(new Ze$1("y",e)),this.__y.valueChanged.connect(this.__resize.bind(this)),this.__z=this.addParameter(new Ze$1("z",i)),this.__z.valueChanged.connect(this.__resize.bind(this)),this.__baseZAtZero=this.addParameter(new Ze$1("BaseZAtZero",n)),this.__baseZAtZero.valueChanged.connect(this.__rebuild.bind(this)),this.__rebuild()}__rebuild(){this.setNumVertices(8),this.setNumSegments(12),this.setSegment(0,0,1),this.setSegment(1,1,2),this.setSegment(2,2,3),this.setSegment(3,3,0),this.setSegment(4,4,5),this.setSegment(5,5,6),this.setSegment(6,6,7),this.setSegment(7,7,4),this.setSegment(8,0,4),this.setSegment(9,1,5),this.setSegment(10,2,6),this.setSegment(11,3,7),this.__resize(-1),this.geomDataTopologyChanged.emit()}__resize(t){const e=this.__x.getValue(),i=this.__y.getValue(),n=this.__z.getValue(),s=this.__baseZAtZero.getValue();let o=.5;s&&(o=1),this.getVertex(0).set(.5*e,-.5*i,o*n),this.getVertex(1).set(.5*e,.5*i,o*n),this.getVertex(2).set(-.5*e,.5*i,o*n),this.getVertex(3).set(-.5*e,-.5*i,o*n),o=-.5,s&&(o=0),this.getVertex(4).set(.5*e,-.5*i,o*n),this.getVertex(5).set(.5*e,.5*i,o*n),this.getVertex(6).set(-.5*e,.5*i,o*n),this.getVertex(7).set(-.5*e,-.5*i,o*n),this.setBoundingBoxDirty(),-1!=t&&this.geomDataChanged.emit()}toJSON(){const t=super.toJSON();return t.size=this.__size,t}}J$1.registerClass("LinesCuboid",kt$1);class Bt$1 extends Nt$1{constructor(t=1,e=1,i=10,n=10,s=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__xParam=this.addParameter(new Ze$1("x",t)),this.__yParam=this.addParameter(new Ze$1("y",e)),this.__xDivisionsParam=this.addParameter(new Ze$1("xDivisions",i)),this.__yDivisionsParam=this.addParameter(new Ze$1("yDivisions",n)),this.__skipCenterLinesParam=this.addParameter(new Xe$1("skipCenterLines",s)),this.__rebuild()}get sizeX(){return this.__x}set sizeX(t){this.__x=t,this.__resize()}get sizeY(){return this.__y}set sizeY(t){this.__y=t,this.__resize()}get divisionsX(){return this.__xDivisions}set divisionsX(t){this.__xDivisions=t,this.__rebuild()}get divisionsY(){return this.__yDivisions}set divisionsY(t){this.__yDivisions=t,this.__rebuild()}setSize(t,e){this.__x=t,this.__y=e,this.__resize()}__rebuild(){const t=this.__xDivisionsParam.getValue(),e=this.__yDivisionsParam.getValue(),i=this.__skipCenterLinesParam.getValue()&&t%2==0&&e%2==0;this.setNumVertices(2*(t+e+2-(i?1:0))),this.setNumSegments(t+e+2-(i?1:0));let n=0;for(let s=0;s<=t;s++)i&&s==t/2||(this.setSegment(n,2*n,2*n+1),n++);for(let s=0;s<=e;s++)i&&s==t/2||(this.setSegment(n,2*n,2*n+1),n++);this.__resize()}__resize(){const t=this.__xDivisionsParam.getValue(),e=this.__yDivisionsParam.getValue(),i=this.__xParam.getValue(),n=this.__yParam.getValue(),s=this.__skipCenterLinesParam.getValue()&&t%2==0&&e%2==0;let o=0;for(let r=0;r<=t;r++){if(s&&r==t/2)continue;const e=2*o+1,a=(r/t-.5)*i;this.getVertex(2*o).set(a,-.5*n,0),this.getVertex(e).set(a,.5*n,0),o++}for(let r=0;r<=e;r++){if(s&&r==t/2)continue;const a=2*o+1,l=(r/e-.5)*n;this.getVertex(2*o).set(-.5*i,l,0),this.getVertex(a).set(.5*i,l,0),o++}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.z=this.__y,t.xDivisions=this.__xDivisions,t.yDivisions=this.__yDivisions,t}}J$1.registerClass("Grid",Bt$1);class Dt$1 extends Yt$1{constructor(t=.5,e=1,i=32,n=!0){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze$1("radius",t)),this.__heightParam=this.addParameter(new Ze$1("height",e)),this.__detailParam=this.addParameter(new Ze$1("detail",i>=3?i:3,[3,200],1)),this.__capParam=this.addParameter(new Xe$1("cap",n)),this.addVertexAttribute("texCoords",_$1),this.addVertexAttribute("normals",Z$1),this.__rebuild();const s=()=>{this.__resize()},o=()=>{this.__rebuild()};this.__radiusParam.valueChanged.connect(s),this.__heightParam.valueChanged.connect(s),this.__detailParam.valueChanged.connect(o),this.__capParam.valueChanged.connect(o)}get radius(){return this.__radiusParam.getValue()}set radius(t){this.__radiusParam.setValue(t),this.__resize()}get height(){return this.__heightParam.getValue()}set height(t){this.__heightParam.setValue(t),this.__resize()}get detail(){return this.__detailParam.getValue()}set detail(t){this.__detailParam.setValue(t),this.__rebuild()}get cap(){return this.__capParam.getValue()}set cap(t){this.__capParam.setValue(t),this.__rebuild()}__rebuild(){this.clear();const t=this.__detailParam.getValue(),e=this.__radiusParam.getValue(),i=this.__heightParam.getValue(),n=this.__capParam.getValue();let s=t+1;n&&(s+=1),this.setNumVertices(s);const o=t,r=t+1;this.getVertex(o).set(0,0,i);for(let u=0;u<t;u++){const i=u/t*2*Math.PI;this.getVertex(u).set(e*Math.cos(i),e*Math.sin(i),0)}n&&this.getVertex(r).set(0,0,0),this.setFaceCounts([t+(n?t:0)]);for(let u=0;u<t;u++)this.setFaceVertexIndices(u,(u+1)%t,u,o);if(n)for(let u=0;u<t;u++)this.setFaceVertexIndices(t+u,u,(u+1)%t,r);const a=this.getVertexAttribute("normals");let l;const c=i;Math.abs(i)<1e-12&&(l=i<0?-1e-12:1e-12),l=e/c;let h=0;for(let u=0;u<t;u++){const e=(u+1)/t*2*Math.PI,i=u/t*2*Math.PI,n=.5*(e+i);a.setFaceVertexValue(h,0,new Z$1(Math.cos(e),l,Math.sin(e)).normalize()),a.setFaceVertexValue(h,1,new Z$1(Math.cos(i),l,Math.sin(i)).normalize()),a.setFaceVertexValue(h,2,new Z$1(Math.cos(n),l,Math.sin(n)).normalize()),h++}if(n){const e=new Z$1(0,-1,0);for(let i=0;i<t;i++)a.setFaceVertexValue(h,0,e),a.setFaceVertexValue(h,1,e),a.setFaceVertexValue(h,2,e),h++}const d=this.getVertexAttribute("texCoords");h=0;for(let u=0;u<t;u++)d.setFaceVertexValue(h,0,new _$1((u+1)/t,0)),d.setFaceVertexValue(h,1,new _$1(u/t,0)),d.setFaceVertexValue(h,2,new _$1((u+.5)/t,1));if(n)for(let u=0;u<t;u++)d.setFaceVertexValue(h,0,new _$1(u/t,0)),d.setFaceVertexValue(h,1,new _$1((u+1)/t,0)),d.setFaceVertexValue(h,2,new _$1((u+.5)/t,1)),h++;this.setBoundingBoxDirty()}__resize(){const t=this.__detailParam.getValue(),e=this.__radiusParam.getValue(),i=this.__heightParam.getValue(),n=(this.__capParam.getValue(),t),s=t+1;this.getVertex(n).set(0,0,i);for(let o=0;o<t;o++){const i=o/t*2*Math.PI;this.getVertex(o).set(e*Math.cos(i),e*Math.sin(i),0)}this.__cap&&this.getVertex(s).set(0,0,0),this.setBoundingBoxDirty()}}J$1.registerClass("Cone",Dt$1);class Ot$1 extends Yt$1{constructor(t=1,e=1,i=1,n=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__xParam=this.addParameter(new Ze$1("x",t)),this.__yParam=this.addParameter(new Ze$1("y",e)),this.__zParam=this.addParameter(new Ze$1("z",i)),this.__baseZAtZeroParam=this.addParameter(new Xe$1("baseZAtZero",n)),this.setFaceCounts([0,6]),this.setFaceVertexIndices(0,0,1,2,3),this.setFaceVertexIndices(1,7,6,5,4),this.setFaceVertexIndices(2,1,0,4,5),this.setFaceVertexIndices(3,3,2,6,7),this.setFaceVertexIndices(4,0,3,7,4),this.setFaceVertexIndices(5,2,1,5,6),this.setNumVertices(8),this.addVertexAttribute("texCoords",_$1),this.addVertexAttribute("normals",Z$1),this.__rebuild();const s=()=>{this.__resize()};this.__xParam.valueChanged.connect(s),this.__yParam.valueChanged.connect(s),this.__zParam.valueChanged.connect(s),this.__baseZAtZeroParam.valueChanged.connect(s)}setSize(t,e,i){this.__xParam.setValue(t),this.__yParam.setValue(e),this.__zParam.setValue(i)}setBaseSize(t,e){this.__xParam.setValue(t),this.__yParam.setValue(e)}__rebuild(){const t=this.getVertexAttribute("normals");for(let i=0;i<6;i++){let e;switch(i){case 0:e=new Z$1(0,0,1);break;case 1:e=new Z$1(0,0,-1);break;case 2:e=new Z$1(1,0,0);break;case 3:e=new Z$1(-1,0,0);break;case 4:e=new Z$1(0,1,0);break;case 5:e=new Z$1(0,-1,0)}t.setFaceVertexValue(i,0,e),t.setFaceVertexValue(i,1,e),t.setFaceVertexValue(i,2,e),t.setFaceVertexValue(i,3,e)}const e=this.getVertexAttribute("texCoords");for(let i=0;i<6;i++)e.setFaceVertexValue(i,0,new _$1(0,0)),e.setFaceVertexValue(i,1,new _$1(1,0)),e.setFaceVertexValue(i,2,new _$1(1,1)),e.setFaceVertexValue(i,3,new _$1(0,1));this.__resize()}__resize(t){const e=this.__xParam.getValue(),i=this.__yParam.getValue(),n=this.__zParam.getValue(),s=this.__baseZAtZeroParam.getValue();let o=.5;s&&(o=1),this.getVertex(0).set(.5*e,-.5*i,o*n),this.getVertex(1).set(.5*e,.5*i,o*n),this.getVertex(2).set(-.5*e,.5*i,o*n),this.getVertex(3).set(-.5*e,-.5*i,o*n),o=-.5,s&&(o=0),this.getVertex(4).set(.5*e,-.5*i,o*n),this.getVertex(5).set(.5*e,.5*i,o*n),this.getVertex(6).set(-.5*e,.5*i,o*n),this.getVertex(7).set(-.5*e,-.5*i,o*n),this.setBoundingBoxDirty(),this.geomDataChanged.emit()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t.z=this.__z,t}}J$1.registerClass("Cuboid",Ot$1);class Qt$1 extends Yt$1{constructor(t=.5,e=1,i=32,n=2,s=!0,o=!1){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze$1("radius",t)),this.__heightParam=this.addParameter(new Ze$1("height",e)),this.__sidesParam=this.addParameter(new Ze$1("sides",i>=3?i:3,[3,200],1)),this.__loopsParam=this.addParameter(new Ze$1("loops",n>=2?n:2,[1,200],1)),this.__capsParam=this.addParameter(new Xe$1("caps",s)),this.__baseZAtZeroParam=this.addParameter(new Xe$1("baseZAtZero",o)),this.addVertexAttribute("texCoords",_$1),this.addVertexAttribute("normals",Z$1),this.__rebuild();const r=()=>{this.__resize()},a=()=>{this.__rebuild()};this.__radiusParam.valueChanged.connect(r),this.__heightParam.valueChanged.connect(r),this.__sidesParam.valueChanged.connect(a),this.__loopsParam.valueChanged.connect(a),this.__capsParam.valueChanged.connect(a),this.__baseZAtZeroParam.valueChanged.connect(r)}__rebuild(){this.clear(),this.__radiusParam.getValue();const t=this.__sidesParam.getValue(),e=this.__loopsParam.getValue(),i=(this.__heightParam.getValue(),this.__capsParam.getValue());this.__baseZAtZeroParam.getValue();let n=t*e;i&&(n+=2),this.setNumVertices(n),this.setFaceCounts(i?[2*t,t]:[0,t]);let s=0;for(let a=0;a<e-1;a++)for(let e=0;e<t;e++)this.setFaceVertexIndices(s++,t*a+(e+1)%t,t*a+e,t*(a+1)+e,t*(a+1)+(e+1)%t);if(i){for(let e=0;e<t;e++)this.setFaceVertexIndices(s++,n-1,e,(e+1)%t);for(let i=0;i<t;i++)this.setFaceVertexIndices(s++,t*(e-1)+i,n-2,t*(e-1)+(i+1)%t)}const o=this.getVertexAttribute("normals");s=0;for(let a=0;a<e-1;a++)for(let e=0;e<t;e++){let i=e/t*2*Math.PI;const n=new Z$1(Math.sin(i),Math.cos(i),0);o.setFaceVertexValue(s,0,n),o.setFaceVertexValue(s,1,n),i=(e+1)/t*2*Math.PI;const r=new Z$1(Math.sin(i),Math.cos(i),0);o.setFaceVertexValue(s,2,r),o.setFaceVertexValue(s,3,r),s++}if(i){const e=new Z$1(0,0,-1);for(let i=0;i<t;i++)o.setFaceVertexValue(s,0,e),o.setFaceVertexValue(s,1,e),o.setFaceVertexValue(s,2,e),s++;e.set(0,0,1);for(let i=0;i<t;i++)o.setFaceVertexValue(s,0,e),o.setFaceVertexValue(s,1,e),o.setFaceVertexValue(s,2,e),s++}const r=this.getVertexAttribute("texCoords");s=0;for(let a=0;a<t;a++)r.setFaceVertexValue(s,0,new _$1((a+1)/t,0)),r.setFaceVertexValue(s,2,new _$1((a+1)/t,1)),r.setFaceVertexValue(s,1,new _$1(a/t,0)),r.setFaceVertexValue(s,3,new _$1(a/t,1)),s++;if(i){for(let e=0;e<t;e++)r.setFaceVertexValue(s,0,new _$1(e/t,0)),r.setFaceVertexValue(s,1,new _$1((e+1)/t,0)),r.setFaceVertexValue(s,2,new _$1((e+.5)/t,1)),s++;for(let e=0;e<t;e++)r.setFaceVertexValue(s,0,new _$1(e/t,0)),r.setFaceVertexValue(s,1,new _$1((e+1)/t,0)),r.setFaceVertexValue(s,2,new _$1((e+.5)/t,1)),s++}this.geomDataTopologyChanged.emit(),this.__resize()}__resize(){const t=this.__sidesParam.getValue(),e=this.__loopsParam.getValue(),i=this.__radiusParam.getValue(),n=this.__heightParam.getValue(),s=this.__capsParam.getValue(),o=this.__baseZAtZeroParam.getValue();let r=t*e;s&&(r+=2);let a=0,l=.5;o&&(l=0);for(let c=0;c<e;c++){const s=c/(e-1)*n-n*l;for(let e=0;e<t;e++){const n=e/t*2*Math.PI;this.getVertex(a).set(Math.sin(n)*i,Math.cos(n)*i,s),a++}}s&&(this.getVertex(r-1).set(0,0,n*(o?0:-.5)),this.getVertex(r-2).set(0,0,n*(o?1:.5))),this.setBoundingBoxDirty(),this.geomDataChanged.emit()}}J$1.registerClass("Cylinder",Qt$1);class At$1 extends Yt$1{constructor(t=.5,e=32){if(super(),isNaN(t)||isNaN(e))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze$1("radius",t)),this.__sidesParam=this.addParameter(new Ze$1("sides",e>=3?e:3,[3,200],1)),this.addVertexAttribute("texCoords",_$1),this.addVertexAttribute("normals",Z$1),this.__rebuild()}get radius(){return this.__radius}set radius(t){this.__radius=t,this.__resize()}set sides(t){this.__sides=t>=3?t:3,this.__rebuild()}__rebuild(){const t=this.__sidesParam.getValue();this.setNumVertices(t+1),this.setFaceCounts([t]),this.getVertex(0).set(0,0,0);for(let s=0;s<t;s++)this.setFaceVertexIndices(s,0,s%t+1,(s+1)%t+1);const e=this.getVertexAttribute("normals"),i=new Z$1(0,0,1);e.setValue(0,i);for(let s=0;s<t;s++)e.setValue(s+1,i);const n=this.getVertexAttribute("texCoords");n.getValueRef(0).set(.5,.5);for(let s=0;s<t;s++){const e=s/t*2*Math.PI;n.getValueRef(s+1).set(.5*Math.sin(e)+.5,.5*Math.cos(e)+.5)}this.setBoundingBoxDirty(),this.__resize()}__resize(){const t=this.__sidesParam.getValue(),e=this.__radiusParam.getValue();for(let i=0;i<t;i++){const n=i/t*2*Math.PI;this.getVertex(i+1).set(Math.sin(n)*e,Math.cos(n)*e,0)}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.radius=this.__radius,t}}J$1.registerClass("Disc",At$1);class jt$1 extends Yt$1{constructor(t=1,e=1,i=1,n=1,s=!0,o=!0){if(super(),isNaN(t)||isNaN(e)||isNaN(i)||isNaN(n))throw new Error("Invalid geom args");this.__sizeXParam=this.addParameter(new Ze$1("SizeX",t)),this.__sizeYParam=this.addParameter(new Ze$1("SizeY",e)),this.__detailXParam=this.addParameter(new Ze$1("DetailX",i)),this.__detailYParam=this.addParameter(new Ze$1("DetailY",n)),s&&this.addVertexAttribute("normals",Z$1),o&&this.addVertexAttribute("texCoords",_$1),this.__rebuild(),this.__sizeXParam.valueChanged.connect(this.__resize.bind(this)),this.__sizeYParam.valueChanged.connect(this.__resize.bind(this)),this.__detailXParam.valueChanged.connect(this.__rebuild.bind(this)),this.__detailYParam.valueChanged.connect(this.__rebuild.bind(this))}__rebuild(){const t=this.__detailXParam.getValue(),e=this.__detailYParam.getValue();this.setNumVertices((t+1)*(e+1)),this.setFaceCounts([0,t*e]);let i=0;for(let r=0;r<e;r++)for(let e=0;e<t;e++)this.setFaceVertexIndices(i,(t+1)*(r+1)+e,(t+1)*(r+1)+(e+1),(t+1)*r+(e+1),(t+1)*r+e),i+=1;let n=0;const s=this.getVertexAttribute("normals");if(s)for(let r=0;r<=e;r++)for(let e=0;e<=t;e++)s.getValueRef(n).set(0,0,1),n++;n=0;const o=this.getVertexAttribute("texCoords");if(o)for(let r=0;r<=e;r++){const i=r/e;for(let e=0;e<=t;e++){const s=e/t;o.getValueRef(n).set(s,i),n++}}this.__resize(!1),this.geomDataTopologyChanged.emit()}__resize(t=!0){const e=this.__sizeXParam.getValue(),i=this.__sizeYParam.getValue(),n=this.__detailXParam.getValue(),s=this.__detailYParam.getValue();let o=0;for(let r=0;r<=s;r++){const t=(r/s-.5)*i;for(let i=0;i<=n;i++){const s=(i/n-.5)*e;this.getVertex(o).set(s,t,0),o++}}this.setBoundingBoxDirty(),t&&this.geomDataChanged.emit()}}class qt$1 extends Yt$1{constructor(t=1,e=12,i=12){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__radiusParam=this.addParameter(new Ze$1("radius",t)),this.__sidesParam=this.addParameter(new Ze$1("sides",e>=3?e:3,[3,200],1)),this.__loopsParam=this.addParameter(new Ze$1("loops",i>=3?i:3,[3,200],1)),this.addVertexAttribute("texCoords",_$1),this.addVertexAttribute("normals",Z$1),this.__rebuild();const n=()=>{this.__rebuild()};this.__radiusParam.valueChanged.connect(()=>{this.__resize()}),this.__sidesParam.valueChanged.connect(n),this.__loopsParam.valueChanged.connect(n)}__rebuild(){const t=this.__radiusParam.getValue(),e=this.__sidesParam.getValue(),i=this.__loopsParam.getValue(),n=2+e*i,s=2*e,o=e*i;this.setNumVertices(n),this.setFaceCounts([s,o]);const r=this.getVertexAttribute("normals"),a=new Z$1(0,0,1);let l=0;this.getVertex(l).set(0,0,t),r.getValueRef(l).set(0,0,1),l++;for(let d=0;d<i;d++){const n=(d+1)/(i+1)*Math.PI;for(let i=0;i<e;i++){const s=i/e*2*Math.PI;a.set(Math.sin(n)*Math.cos(s),Math.sin(n)*Math.sin(s),Math.cos(n)),this.getVertex(l).setFromOther(a.scale(t)),r.getValueRef(l).setFromOther(a),l++}}this.getVertex(l).set(0,0,-t),r.getValueRef(l).set(0,0,-1),l++;const c=this.getVertexAttribute("texCoords");let h=0;for(let d=0;d<e;d++){this.setFaceVertexIndices(h,0,(d+1)%e+1,d+1);const t=new _$1(.5,0),n=new _$1(1-(d+1)/e,0),s=new _$1(1-d/e,1/(i+1));c.setFaceVertexValue(h,0,t),c.setFaceVertexValue(h,1,n),c.setFaceVertexValue(h,2,s),h++}for(let d=0;d<e;d++){this.setFaceVertexIndices(h,n-1,e*(i-1)+d+1,e*(i-1)+(d+1)%e+1);const t=new _$1(1-d/e,i/(i+1)),s=new _$1(1-(d+1)/e,i/(i+1)),o=new _$1(.5,1);c.setFaceVertexValue(h,0,t),c.setFaceVertexValue(h,1,s),c.setFaceVertexValue(h,2,o),h++}for(let d=0;d<i-1;d++)for(let t=0;t<e;t++)this.setFaceVertexIndices(h,e*d+t+1,e*d+(t+1)%e+1,e*(d+1)+(t+1)%e+1,e*(d+1)+t+1),c.setFaceVertexValue(h,0,new _$1(d/i,t/i)),c.setFaceVertexValue(h,1,new _$1(d/i,(t+1)/i)),c.setFaceVertexValue(h,2,new _$1((d+1)/i,(t+1)/i)),c.setFaceVertexValue(h,3,new _$1((d+1)/i,t/i)),h++;this.setBoundingBoxDirty(),this.geomDataTopologyChanged.emit()}__resize(){const t=this.__radiusParam.getValue(),e=this.__sidesParam.getValue(),i=this.__loopsParam.getValue();let n=0;const s=new Z$1(0,0,1);this.getVertex(n).set(0,0,t),n++;for(let o=0;o<i;o++){const r=(o+1)/(i+1)*Math.PI;for(let i=0;i<e;i++){const o=i/e*2*Math.PI;s.set(Math.sin(r)*Math.cos(o),Math.sin(r)*Math.sin(o),Math.cos(r)),this.getVertex(n).setFromOther(s.scale(t)),n++}}this.getVertex(n).set(0,0,-t),n++,this.setBoundingBoxDirty(),this.geomDataChanged.emit()}}J$1.registerClass("Sphere",qt$1);class $t$1 extends Yt$1{constructor(t=.5,e=1,i=32){if(super(),isNaN(t)||isNaN(e)||isNaN(i))throw new Error("Invalid geom args");this.__innerRadius=t,this.__outerRadius=e,this.__detail=i>=3?i:3,this.addVertexAttribute("texCoords",_$1),this.addVertexAttribute("normals",Z$1),this.__rebuild()}get innerRadius(){return this.__innerRadius}set innerRadius(t){this.__innerRadius=t,this.__resize()}get outerRadius(){return this.__outerRadius}set outerRadius(t){this.__outerRadius=t,this.__resize()}get detail(){return this.__detail}set detail(t){this.__detail=t>=3?t:3,this.__rebuild()}__rebuild(){const t=this.__detail,e=2*this.__detail;this.setNumVertices(t*e),this.setFaceCounts([0,t*e]);const i=this.getVertexAttribute("normals");let n=0;for(let r=0;r<e;r++){const s=r/e*2*Math.PI,o=Math.cos(s),a=Math.sin(s);for(let e=0;e<t;e++){const s=e/t*2*Math.PI,r=Math.sin(s),l=Math.cos(s),c=this.__outerRadius+l*this.__innerRadius;this.getVertex(n).set(o*c,a*c,this.__innerRadius*r),i.getValueRef(n).set(o*l,a*l,r),n++}}const s=this.getVertexAttribute("texCoords");let o=0;for(let r=0;r<e;r++)for(let i=0;i<t;i++){const n=(r+1)%e,a=(i+1)%t;this.setFaceVertexIndices(o,t*r+i,t*r+a,t*n+a,t*n+i),s.setFaceVertexValue(o,0,new _$1(r/e,i/e)),s.setFaceVertexValue(o,1,new _$1(r/e,(i+1)/e)),s.setFaceVertexValue(o,2,new _$1((r+1)/e,(i+1)/e)),s.setFaceVertexValue(o,3,new _$1((r+1)/e,i/e)),o++}this.setBoundingBoxDirty()}__resize(){const t=this.__detail,e=2*this.__detail;for(let i=0;i<e;i++){const n=i/e*2*Math.PI,s=Math.cos(n),o=Math.sin(n);for(let e=0;e<t;e++){const i=e/t*2*Math.PI,n=Math.sin(i),r=Math.cos(i),a=this.__outerRadius+r*this.__innerRadius;this.getVertex(0).set(s*a,o*a,this.__innerRadius*n),index++}}this.setBoundingBoxDirty()}toJSON(){const t=super.toJSON();return t.x=this.__x,t.y=this.__y,t.z=this.__z,t}}const ea$1={SAVE_FLAG_SKIP_CHILDREN:1},ta$1={LOAD_FLAG_LOADING_BIN_TREE_VALUES:16},aa$1={CLONE_FLAG_INSTANCED_TREE:1};class ia$1 extends te$1{constructor(t){super(t),this.__visibleCounter=1,this.__visible=!0,this.__highlightMapping={},this.__highlights=[],this.__childItems=[],this.__childItemsSignalIds=[],this.__childItemsMapping={},this.mouseDown=new C$1,this.mouseUp=new C$1,this.mouseMove=new C$1,this.mouseEnter=new C$1,this.mouseLeave=new C$1,this.__visibleParam=this.addParameter(new Xe$1("Visible",!0)),this.__localXfoParam=this.addParameter(new Se$1("LocalXfo",new S$1)),this.__globalXfoParam=this.addParameter(new Se$1("GlobalXfo",new S$1)),this.__boundingBoxParam=this.addParameter(new Q$1("BoundingBox",new v$1)),this.parentChanged=this.ownerChanged,this.childAdded=new C$1,this.childRemoved=new C$1,this.highlightChanged=new C$1,this.visibilityChanged=new C$1,this.localXfoChanged=this.__localXfoParam.valueChanged,this.globalXfoChanged=this.__globalXfoParam.valueChanged,this.boundingChanged=this.__boundingBoxParam.valueChanged,this._cleanGlobalXfo=this._cleanGlobalXfo.bind(this),this._setGlobalXfoDirty=this._setGlobalXfoDirty.bind(this),this._setBoundingBoxDirty=this._setBoundingBoxDirty.bind(this),this._cleanBoundingBox=this._cleanBoundingBox.bind(this),this.__localXfoParam.valueChanged.connect(this._setGlobalXfoDirty);const e=()=>{const t=this.__globalXfoParam.getValue();return void 0!==this.__ownerItem?this.__ownerItem.getGlobalXfo().inverse().multiply(t):t};this.__globalXfoParam.valueChanged.connect(t=>{t!=E$1.OPERATOR_DIRTIED&&this.__localXfoParam.setDirty(e),this._setBoundingBoxDirty()}),this.__visibleParam.valueChanged.connect(()=>{this.__visibleCounter+=this.__visibleParam.getValue()?1:-1,this.__updateVisiblity()})}static get SaveFlags(){return ea$1}static get LoadFlags(){return ta$1}static get CloneFlags(){return aa$1}static getSelectionOutlineColor(){return selectionOutlineColor}static setSelectionOutlineColor(t){selectionOutlineColor=t}static getBranchSelectionOutlineColor(){return branchSelectionOutlineColor}static setBranchSelectionOutlineColor(t){branchSelectionOutlineColor=t}_childFlagsChanged(t){0!=(t&H$1.USER_EDITED)&&this.setFlag($$1.USER_EDITED)}setFlag(t){super.setFlag(t),this.__ownerItem&&this.__ownerItem._childFlagsChanged(t)}setOwner(t){if(this.__ownerItem){this.__ownerItem.globalXfoChanged.disconnect(this._setGlobalXfoDirty),this.__ownerItem.getVisible()||this.__visibleCounter++;const t=this.__ownerItem.getChildIndex(this);t>=0&&this.__ownerItem.__unbindChild(t,this)}super.setOwner(t),this._setGlobalXfoDirty(),this.__ownerItem&&(this.setSelectable(this.__ownerItem.getSelectable(),!0),this.__ownerItem.getVisible()||this.__visibleCounter--,this.__ownerItem.globalXfoChanged.connect(this._setGlobalXfoDirty)),this.__updateVisiblity()}__updatePath(){super.__updatePath();for(const t of this.__childItems)t&&t.__updatePath()}getParentItem(){return this.getOwner()}setParentItem(t){this.setOwner(t)}getLocalXfo(){return this.__localXfoParam.getValue()}setLocalXfo(t,e){this.__localXfoParam.setValue(t,e)}getGlobalXfo(t){return this.__globalXfoParam.getValue(t)}setGlobalXfo(t,e){const i=this.getOwner();if(i){const n=i.getGlobalXfo().inverse().multiply(t);this.__localXfoParam.setValue(n,e)}else this.__globalXfoParam.setValue(t,e)}_cleanGlobalXfo(t){const e=this.getParentItem(),i=this.__localXfoParam.getValue();return void 0!==e?e.getGlobalXfo().multiply(i):i}_setGlobalXfoDirty(){this.__globalXfoParam.setDirty(this._cleanGlobalXfo)}getVisible(){return this.__visibleCounter>0}setVisible(t){this.__visibleParam.setValue(t)}propagateVisiblity(t){this.__visibleCounter+=t,this.__updateVisiblity()}__updateVisiblity(){const t=this.__visibleCounter>0;if(t!=this.__visible){this.__visible=t;for(const t of this.__childItems)t instanceof ia$1&&t.propagateVisiblity(this.__visible?1:-1);return this.visibilityChanged.emit(t),!0}return!1}addHighlight(t,e,i=!1){if(t in this.__highlightMapping){const e=this.__highlights.indexOf(t);this.__highlights.splice(e,1)}this.__highlights.push(t),this.__highlightMapping[t]=e,this.highlightChanged.emit(),i&&this.__childItems.forEach(n=>{n instanceof ia$1&&n.addHighlight(t,e,i)})}removeHighlight(t,e=!1){if(t in this.__highlightMapping){const e=this.__highlights.indexOf(t);this.__highlights.splice(e,1),delete this.__highlightMapping[t],this.highlightChanged.emit()}e&&this.__childItems.forEach(i=>{i instanceof ia$1&&i.removeHighlight(t,e)})}getHighlight(){if(this.__highlights.length>0)return this.__highlightMapping[this.__highlights[this.__highlights.length-1]]}isHighlighted(){return this.__highlights.length>0}get boundingBox(){return console.warn("getter is deprectated. Please use 'getBoundingBox'"),this.getBoundingBox()}getBoundingBox(){return this.__boundingBoxParam.getValue()}_cleanBoundingBox(t){return t.reset(),this.__childItems.forEach(e=>{e instanceof ia$1&&e.getVisible()&&!e.testFlag($$1.IGNORE_BBOX)&&t.addBox3(e.getBoundingBox())}),t}_childBBoxChanged(){this._setBoundingBoxDirty()}_setBoundingBoxDirty(){this.__boundingBoxParam&&this.__boundingBoxParam.setDirty(this._cleanBoundingBox)}getChildren(){return this.__childItems}numChildren(){return console.warn("Deprecated method. Please use getNumChildren"),this.__childItems.length}getNumChildren(){return this.__childItems.length}generateUniqueName(t){if(!(t in this.__childItemsMapping))return t;let e=1;t.length>4&&!Number.isNaN(parseInt(t.substring(t.length-4)))?e=parseInt(t.substr(t.length-4)):t.length>3&&!Number.isNaN(parseInt(t.substring(t.length-3)))?e=parseInt(t.substr(t.length-3)):t.length>2&&!Number.isNaN(parseInt(t.substring(t.length-2)))&&(e=parseInt(t.substr(t.length-2)));const i=[];for(const s of this.__childItems)s&&i.push(s.getName());let n=t;for(;;){let s=""+e;for(;s.length<2;)s="0"+s;if(n=t+s,-1==i.indexOf(n))break;e++}return n}__updateMapping(t){for(let e=t;e<this.__childItems.length;e++)this.__childItemsMapping[this.__childItems[e].getName()]=e}insertChild(t,e,i=!1,n=!0){if(t.getName()in this.__childItemsMapping){if(!n)throw new Error("Item '"+t.getName()+"' is already a child of :"+this.getPath());t.setName(this.generateUniqueName(t.getName()))}if(!(t instanceof te$1))throw new Error("Object is is not a tree item :"+t.constructor.name);const s={};let o;return s.nameChangedId=t.nameChanged.connect((t,e)=>{const i=this.__childItemsMapping[e];delete this.__childItemsMapping[e],this.__childItemsMapping[t]=i}),t instanceof ia$1&&(i&&(o=this.getGlobalXfo().inverse().multiply(t.getGlobalXfo())),s.bboxChangedId=t.boundingChanged.connect(()=>{this._setBoundingBoxDirty()}),s.visChangedId=t.visibilityChanged.connect(this._setBoundingBoxDirty)),this.__childItems.splice(e,0,t),this.__childItemsSignalIds.splice(e,0,s),this.__childItemsMapping[t.getName()]=e,this.__updateMapping(e),t.setOwner(this),t instanceof ia$1&&(i&&t.setLocalXfo(o),this._setBoundingBoxDirty()),t.testFlag($$1.USER_EDITED)&&this.setFlag($$1.USER_EDITED),this.childAdded.emit(t,e),t}addChild(t,e=!0,i=!0){const n=this.__childItems.length;return this.insertChild(t,n,e,i),n}getChild(t){return this.__childItems[t]}getChildByName(t){const e=this.__childItemsMapping[t];return null!=e?this.__childItems[e]:null}getChildNames(){const t=[];for(let e=0;e<this.__childItems.length;e++){const i=this.__childItems[e];null!=i&&(t[e]=i.getName())}return t}__unbindChild(t,e){const i=this.__childItemsSignalIds[t];e.nameChanged.disconnectId(i.nameChangedId),e instanceof ia$1&&(e.boundingChanged.disconnectId(i.bboxChangedId),e.visibilityChanged.disconnectId(i.visChangedId)),this.__childItems.splice(t,1),this.__childItemsSignalIds.splice(t,1),delete this.__childItemsMapping[e.getName()],this.__updateMapping(t),e instanceof ia$1&&this._setBoundingBoxDirty(),this.childRemoved.emit(e,t)}removeChild(t){const e=this.__childItems[t];e&&(this.__unbindChild(t,e),e.setOwner(void 0))}removeChildByName(t){const e=this.__childItemsMapping[t];return null!=e?this.removeChild(e):null}removeChildByHandle(t){console.warn("Deprecated method. Please use removeChild");const e=this.__childItems.indexOf(t);if(-1==e)throw new Error("Error in removeChildByHandle. Child not found:"+t.getName());this.removeChild(e)}removeAllChildren(){let t=this.__childItems.length;for(;t--;)this.removeChild(t);this._setBoundingBoxDirty()}getChildIndex(t){return this.__childItems.indexOf(t)}indexOfChild(t){return console.warn("Deprecated method. Please use getChildIndex"),this.getChildIndex(t)}resolvePath(t,e=0){if("string"==typeof t&&(t=t.split("/")),0==e)if("."==t[0]||t[0]==this.__name)e++;else if(".."==t[0])return this.__ownerItem.resolvePath(t,e+1);if(e==t.length)return this;const i=this.getChildByName(t[e]);return null==i?this.getParameter(t[e])||null:i.resolvePath(t,e+1)}traverse(t,e=!0){const i=(t,e)=>{const i=t.getChildren();for(const s of i)s&&n(s,e+1)},n=(e,n)=>{if(0==t(e,n))return!1;i(e,n)};e?n(this,1):i(this,0)}onMouseDown(t){this.mouseDown.emit(t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseDown(t)}onMouseUp(t){this.mouseUp.emit(t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseUp(t)}onMouseMove(t){this.mouseMove.emit(t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseMove(t)}onMouseEnter(t){this.mouseEnter.emit(t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseEnter(t)}onMouseLeave(t){this.mouseLeave.emit(t),t.propagating&&this.__ownerItem&&this.__ownerItem.onMouseLeave(t)}onWheel(t){t.propagating&&this.__ownerItem&&this.__ownerItem.onWheel(t)}toJSON(t,e){if(!this.testFlag($$1.USER_EDITED))return;const i=super.toJSON(t,e);if(!(e&ea$1.SAVE_FLAG_SKIP_CHILDREN)){const n={};for(const i of this.__childItems)if(i){const s=i.toJSON(t,e);s&&(n[i.getName()]=s)}Object.keys(n).length>0&&(i?i.children=n:i={name:this.__name,children:n})}return i}fromJSON(t,e,i){if(super.fromJSON(t,e,i),e.numTreeItems++,this.setFlag($$1.USER_EDITED),null!=t.children){const n=t.children;if(Array.isArray(n))for(const t of n){let n=this.getChildByName(t.name);n?n.fromJSON(t,e,i):t.type&&(n=J$1.constructClass(t.type),n&&(n.fromJSON(t,e,i),this.addChild(n,!1,!1)))}else for(const t in n){const s=n[t];let o=this.getChildByName(t);o?o.fromJSON(s,e,i):s.type&&(o=J$1.constructClass(s.type),o&&(o.fromJSON(s,e,i),this.addChild(o,!1,!1)))}}}readBinary(t,e){super.readBinary(t,e),e.numTreeItems++;const i=t.loadUInt8();if(4&i){const e=new S$1;e.tr=t.loadFloat32Vec3(),e.ori=t.loadFloat32Quat(),e.sc.set(t.loadFloat32()),this.__localXfoParam.setValue(e,E$1.DATA_LOAD)}8&i&&this.__boundingBoxParam.setValue(new v$1(t.loadFloat32Vec3(),t.loadFloat32Vec3()),E$1.DATA_LOAD);const n=t.loadUInt32();if(n>0){const i=t.loadUInt32Array(n);for(let s=0;s<n;s++){t.seek(i[s]);let n=t.loadStr();if(n.startsWith("N")&&n.endsWith("E")){const t=n.indexOf("podium");-1!=t&&(n=parseInt(n[t+7])?n.substring(t+8,n.length-1):n.substring(t+7,n.length-1)),-1!=n.indexOf("livenurbs")&&(n=n.substring(n.indexOf("CAD"),n.length-1))}const o=J$1.constructClass(n);if(o)t.seek(i[s]),o.readBinary(t,e),o.setFlag($$1.BIN_NODE),this.addChild(o,!1,!1);else{const e=t.loadStr();console.warn("Unable to construct child:"+e+" of type:"+n)}}}}clone(t){const e=new ia$1;return e.copyFrom(this,t),e}copyFrom(t,e){super.copyFrom(t,e),t.getChildren().forEach(t=>{t&&this.addChild(t.clone(e),!1,!1)})}destroy(){this.removeAllChildren(),super.destroy()}}J$1.registerClass("TreeItem",ia$1);class sa$1 extends ia$1{constructor(t){super(t)}setSrcTree(t,e){if(this.__srcTree=t,0==this.__srcTree.getNumChildren()){const t=this.__srcTree.clone(e);t.setLocalXfo(new S$1,E$1.DATA_LOAD),this.addChild(t,!1)}else this.__srcTree.getChildren().forEach(t=>{const i=t.clone(e);this.addChild(i,!1)})}getSrcTree(){return this.__srcTree}readBinary(t,e={}){super.readBinary(t,e);const i=t.loadStrArray();e.resolvePath(i,t=>{this.setSrcTree(t,e)})}toJSON(t={},e=0){return super.toJSON(t,e)}fromJSON(t,e={},i=0,n){}}J$1.registerClass("InstanceItem",sa$1);class na$1 extends ia$1{constructor(t){super(t),this.__loaded=!1,this.audioSourceCreated=new C$1;const e=this.addParameter(new Fe$1("FilePath"));let i,n;const s=()=>{i=window.ZeaAudioaudioCtx.createBufferSource(),i.buffer=n,i.loop=l.getValue(),i.muted=a.getValue(),i.start(0),this.audioSourceCreated.emit(i)};e.valueChanged.connect(()=>{const t=new XMLHttpRequest;t.open("GET",e.getURL(),!0),t.responseType="arraybuffer",t.onload=()=>{window.ZeaAudioaudioCtx.decodeAudioData(t.response,t=>{n=t,this.__loaded=!0,this.loaded.emit(!0),o.getValue()&&s()},t=>{console.log("Error with decoding audio data"+t.err)})},t.send()});const o=this.addParameter(new Xe$1("Autoplay",!1)),r=this.addParameter(new Ze$1("PlayState",0));r.valueChanged.connect(t=>{if(t!=E$1.CUSTOM)switch(r.getValue()){case 0:this.__loaded&&i&&(i.stop(0),i=void 0);break;case 1:this.__loaded&&s()}}),this.isPlaying=()=>0!=r.getValue(),this.play=()=>{r.setValue(1,E$1.CUSTOM)},this.stop=()=>{r.setValue(0,E$1.CUSTOM)},this.pause=()=>{r.setValue(0,E$1.CUSTOM)},this.getAudioSource=()=>i;const a=this.addParameter(new Xe$1("Mute",!1));this.addParameter(new Ze$1("Gain",1)).setRange([0,5]);const l=this.addParameter(new Xe$1("Loop",!1));this.addParameter(new Xe$1("SpatializeAudio",!0)),this.addParameter(new Ze$1("refDistance",2)),this.addParameter(new Ze$1("maxDistance",1e4)),this.addParameter(new Ze$1("rolloffFactor",1)),this.addParameter(new Ze$1("coneInnerAngle",360)),this.addParameter(new Ze$1("coneOuterAngle",0)),this.addParameter(new Ze$1("coneOuterGain",1)),a.valueChanged.connect(()=>{i&&(i.muted=a.getValue())}),l.valueChanged.connect(()=>{i&&(i.loop=l.getValue())}),this.mute=t=>{a.setValue(t,E$1.CUSTOM)},this.loaded=new C$1(!0),this.loaded.setToggled(!1)}isLoaded(){return this.__loaded}setAudioStream(){this.__loaded=!0,this.loaded.emit(),this.audioSourceCreated.emit(audioSource)}}class la$1 extends na$1{constructor(t){}}class ra$1 extends ia$1{constructor(t){super(t),this.overlay=!1,this.__cutAway=!1,this.__cutAwayVector=!1,this.__cutAwayDist=!1,this.cutAwayChanged=new C$1,this.__layers=[]}setOverlay(t){this.overlay=t}isOverlay(){return this.overlay}addLayer(t){this.__layers.push(t)}getLayers(){return this.__layers}isCutawayEnabled(){return this.__cutAway}setCutawayEnabled(t){this.__cutAway=t,this.cutAwayChanged.emit()}getCutVector(){return this.__cutAwayVector}setCutVector(t){this.__cutAwayVector=t,this.cutAwayChanged.emit()}getCutDist(){return this.__cutAwayDist}setCutDist(t){this.__cutAwayDist=t,this.cutAwayChanged.emit()}readBinary(t,e){if(super.readBinary(t,e),e.versions["zea-engine"].greaterOrEqualThan([0,0,4])){const i=t.loadStr();let n=e.assetItem.getMaterialLibrary().getMaterial(i,!1);if(n||(n=new Pe$1(i,"SimpleSurfaceShader"),n.getParameter("BaseColor").setValue(y$3.random(.25),E$1.DATA_LOAD),e.assetItem.getMaterialLibrary().addMaterial(n)),this.setMaterial(n,E$1.DATA_LOAD),this.__layers=t.loadStrArray(),this.__layers.length>0)for(const t of this.__layers)e.addGeomToLayer(this,t)}}}class oa$1 extends ra$1{constructor(t,e,i){super(t),this.__geomParam=this.insertParameter(new Ke$1("Geometry"),0),this.__geomParam.valueChanged.connect(this._setBoundingBoxDirty.bind(this)),this.__geomParam.boundingBoxDirtied.connect(this._setBoundingBoxDirty.bind(this)),this.__materialParam=this.insertParameter(new Lt$1("Material"),1),this.__paramMapping.material=this.getParameterIndex(this.__materialParam),this.__lightmapCoordOffset=new _$1,this.__geomOffsetXfoParam=this.addParameter(new Se$1("GeomOffsetXfo")),this.__geomMatParam=this.addParameter(new xe$1("GeomMat")),this.__cleanGeomMat=this.__cleanGeomMat.bind(this),this.__globalXfoParam.valueChanged.connect(()=>{this.__geomMatParam.setDirty(this.__cleanGeomMat)}),this.__geomOffsetXfoParam.valueChanged.connect(()=>{this.__geomMatParam.setDirty(this.__cleanGeomMat)}),this.geomXfoChanged=this.__geomMatParam.valueChanged,this.materialAssigned=this.__materialParam.valueChanged,this.geomAssigned=this.__geomParam.valueChanged,e&&this.setGeometry(e,E$1.DATA_LOAD),i&&this.setMaterial(i,E$1.DATA_LOAD)}__cleanGeomMat(){const t=this.__globalXfoParam.getValue().toMat4(),e=this.__geomOffsetXfoParam.getValue().toMat4();return t.multiply(e)}getGeometry(){return this.__geomParam.getValue()}setGeometry(t,e){this.__geomParam.setValue(t,e)}getGeom(){return console.warn("getGeom is deprectated. Please use 'getGeometry'"),this.getGeometry()}setGeom(t){return console.warn("setGeom is deprectated. Please use 'setGeometry'"),this.setGeometry(t)}getMaterial(){return this.__materialParam.getValue()}setMaterial(t,e){this.__materialParam.setValue(t,e)}_cleanBoundingBox(t){t=super._cleanBoundingBox(t);const e=this.getGeometry();return e&&t.addBox3(e.boundingBox,this.getGeomMat4()),t}getGeomOffsetXfo(){return this.__geomOffsetXfoParam.getValue()}setGeomOffsetXfo(t){this.__geomOffsetXfoParam.setValue(t)}getGeomMat4(){return this.__geomMatParam.getValue()}getLightmapName(){return this.__lightmapName}getLightmapCoordsOffset(){return this.__lightmapCoordOffset}applyAssetLightmapSettings(t,e){this.__lightmap=t,this.__lightmapCoordOffset.addInPlace(e)}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e){super.fromJSON(t,e),e.numGeomItems++}readBinary(t,e){super.readBinary(t,e),e.numGeomItems++,this.__lightmapName=e.assetItem.getName();const i=t.loadUInt8(),n=t.loadUInt32(),s=e.assetItem.getGeometryLibrary(),o=s.getGeom(n);if(o)this.setGeometry(o,E$1.DATA_LOAD);else{this.geomIndex=n;const t=t=>{if(n>=t[0]&&n<t[1]){const t=s.getGeom(n);t?this.setGeometry(t,E$1.DATA_LOAD):console.warn("Geom not loaded:",this.getName()),s.rangeLoaded.disconnectId(e)}},e=s.rangeLoaded.connect(t)}if(4&i&&this.__geomOffsetXfoParam.setValue(new S$1(t.loadFloat32Vec3(),t.loadFloat32Quat(),t.loadFloat32Vec3())),e.versions["zea-engine"].lessThan([0,0,4]))if(8&i){const i=e.assetItem.getMaterialLibrary(),n=t.loadStr();let s=i.getMaterial(n);s||(console.warn("Geom :'"+this.name+"' Material not found:"+n),s=i.getMaterial("Default")),this.setMaterial(s,E$1.DATA_LOAD)}else this.setMaterial(e.assetItem.getMaterialLibrary().getMaterial("Default"),E$1.DATA_LOAD);this.__lightmapCoordOffset=t.loadFloat32Vec2()}toString(){return JSON.stringify(this.toJSON(),null,2)}clone(t){const e=new oa$1;return e.copyFrom(this,t),e}copyFrom(t,e){if(super.copyFrom(t,e),this.__lightmapCoordOffset=t.__lightmapCoordOffset,!t.getGeometry()&&-1!=t.geomIndex){const i=e.assetItem.getGeometryLibrary(),n=t.geomIndex,s=t=>{if(n>=t[0]&&n<t[1]){const t=i.getGeom(n);t?this.setGeometry(t,E$1.DATA_LOAD):console.warn("Geom not loaded:",this.getName()),i.rangeLoaded.disconnectId(o)}},o=i.rangeLoaded.connect(s)}this.__geomMatParam.setDirty(this.__cleanGeomMat)}destroy(){super.destroy()}}J$1.registerClass("GeomItem",oa$1);const da$1={manual:0,first:1,average:2,globalOri:3};class ha$1 extends ia$1{constructor(t){super(t),this.setFlag($$1.USER_EDITED),this.calculatingGroupXfo=!1,this.dirty=!1,this.invGroupXfo=void 0,this.__initialXfos=[],this.__signalIndices=[];let e=0;this.__itemsParam=this.insertParameter(new Ne$1("Items",t=>t instanceof ia$1),e++),this.__itemsParam.itemAdded.connect((t,e)=>{this.__bindItem(t,e)}),this.__itemsParam.itemRemoved.connect((t,e)=>{this.__unbindItem(t,e)}),this.__itemsParam.valueChanged.connect(()=>{this.calcGroupXfo(),this._setBoundingBoxDirty()}),this.__initialXfoModeParam=this.insertParameter(new Ge$1("InitialXfoMode",da$1.average,["manual","first","average","global"]),e++),this.__initialXfoModeParam.valueChanged.connect(()=>{this.calcGroupXfo()}),this.__highlightedParam=this.insertParameter(new Xe$1("Highlighted",!1),e++),this.__highlightedParam.valueChanged.connect(()=>{this.__updateHighlight()}),this.__updateHighlight=this.__updateHighlight.bind(this),this.insertParameter(new Ie$1("HighlightColor",new y$3(.5,.5,1)),e++).valueChanged.connect(this.__updateHighlight),this.insertParameter(new Ze$1("HighlightFill",0,[0,1]),e++).valueChanged.connect(this.__updateHighlight),this.__materialParam=this.insertParameter(new Lt$1("Material"),e++),this.__materialParam.valueChanged.connect(()=>{this.__updateMaterial()}),this.__updateCutaway=this.__updateCutaway.bind(this),this.insertParameter(new Xe$1("CutAwayEnabled",!1),e++).valueChanged.connect(this.__updateCutaway),this.insertParameter(new fe$1("CutVector",new Z$1(1,0,0)),e++).valueChanged.connect(this.__updateCutaway),this.insertParameter(new Ze$1("CutDist",0),e++).valueChanged.connect(this.__updateCutaway),this.__globalXfoParam.valueChanged.connect(()=>{this.calculatingGroupXfo||this._propagateDirtyXfoToItems()})}static get INITIAL_XFO_MODES(){return da$1}__updateVisiblity(){if(super.__updateVisiblity()){const t=this.getVisible();return Array.from(this.__itemsParam.getValue()).forEach(e=>{e instanceof ia$1&&e.propagateVisiblity(t?1:-1)}),!0}return!1}__updateHighlight(){let t,e=!1;(this.getParameter("Highlighted").getValue()||this.isSelected())&&(e=!0,t=this.getParameter("HighlightColor").getValue(),t.a=this.getParameter("HighlightFill").getValue());const i="groupItemHighlight"+this.getId();Array.from(this.__itemsParam.getValue()).forEach(n=>{n instanceof ia$1&&(e?n.addHighlight(i,t,!0):n.removeHighlight(i,!0))})}setSelected(t){super.setSelected(t),this.__updateHighlight()}_setGlobalXfoDirty(){super._setGlobalXfoDirty()}calcGroupXfo(){const t=Array.from(this.__itemsParam.getValue());if(0==t.length)return new S$1;this.calculatingGroupXfo=!0;const e=this.__initialXfoModeParam.getValue();let i;if(e==da$1.manual)return this.invGroupXfo=this.getGlobalXfo().inverse(),void(this.calculatingGroupXfo=!1);if(e==da$1.first)i=this.__initialXfos[0];else if(e==da$1.average){i=new S$1,i.ori.set(0,0,0,0);let e=0;t.forEach((t,n)=>{t instanceof ia$1&&(i.tr.addInPlace(this.__initialXfos[n].tr),i.ori.addInPlace(this.__initialXfos[n].ori),e++)}),i.tr.scaleInPlace(1/e),i.ori.normalizeInPlace()}else{if(e!=da$1.globalOri)throw new Error("Invalid mode.");{i=new S$1;let e=0;t.forEach((t,n)=>{t instanceof ia$1&&(i.tr.addInPlace(this.__initialXfos[n].tr),e++)}),i.tr.scaleInPlace(1/e)}}this.setGlobalXfo(i,E$1.GENERATED_VALUE);const n=this.getGlobalXfo();this.invGroupXfo=n.inverse(),this.calculatingGroupXfo=!1}_propagateDirtyXfoToItems(){if(this.calculatingGroupXfo)return;const t=Array.from(this.__itemsParam.getValue());if(!this.calculatingGroupXfo&&t.length>0&&this.invGroupXfo&&!this.dirty){let e;this.dirty=!0,this.propagatingXfoToItems=!0;const i=(t,i)=>{const n=t.getParameter("GlobalXfo");n.setDirty(()=>{if(!e){const t=this.__globalXfoParam.getValue();e=t.multiply(this.invGroupXfo),this.dirty=!1}const t=e.multiply(i);n.setClean(t)})};t.forEach((t,e)=>{t instanceof ia$1&&i(t,this.__initialXfos[e])}),this.propagatingXfoToItems=!1}}__updateMaterial(){const t=this.getParameter("Material").getValue();Array.from(this.__itemsParam.getValue()).forEach(e=>{e.traverse(e=>{if(e instanceof ia$1&&e.hasParameter("Material")){const i=e.getParameter("Material");if(t){const e=i.getValue();e!=t&&(i.__backupMaterial=e,i.setValue(t,E$1.GENERATED_VALUE))}else i.__backupMaterial&&i.setValue(i.__backupMaterial,E$1.GENERATED_VALUE)}},!1)})}__updateCutaway(){const t=this.getParameter("CutAwayEnabled").getValue(),e=this.getParameter("CutVector").getValue(),i=this.getParameter("CutDist").getValue();Array.from(this.__itemsParam.getValue()).forEach(n=>{n.traverse(n=>{n instanceof ra$1&&(n.setCutawayEnabled(t),n.setCutVector(e),n.setCutDist(i))},!0)})}setPaths(t){this.clearItems(!1);const e=this.getOwner();if(null==e)return void console.warn("Group does not have an owner and so cannot resolve paths:",this.getName());const i=[];t.forEach(t=>{const n=e.resolvePath(t);n?i.push(n):console.warn("Path does not resolve to an Item:",t," group:",this.getName())}),this.setItems(i)}resolveItems(t){this.setPaths(t)}__bindItem(t,e){if(!(t instanceof ia$1))return;const i={};i.mouseDownIndex=t.mouseDown.connect(t=>{this.onMouseDown(t)}),i.mouseUpIndex=t.mouseUp.connect(t=>{this.onMouseUp(t)}),i.mouseMoveIndex=t.mouseMove.connect(t=>{this.onMouseMove(t)}),i.mouseEnterIndex=t.mouseEnter.connect(t=>{this.onMouseEnter(t)}),i.mouseLeaveIndex=t.mouseLeave.connect(t=>{this.onMouseLeave(t)});const n=this.getParameter("Material").getValue();if(n&&t.traverse(t=>{if(t instanceof ia$1&&t.hasParameter("Material")){const e=t.getParameter("Material");if(n){const t=e.getValue();t!=n&&(e.__backupMaterial=t,e.setValue(n,E$1.GENERATED_VALUE))}}},!0),t instanceof ia$1&&this.getParameter("Highlighted").getValue()){const e=this.getParameter("HighlightColor").getValue();e.a=this.getParameter("HighlightFill").getValue(),t.addHighlight("groupItemHighlight"+this.getId(),e,!0)}const s=this.getParameter("CutAwayEnabled").getValue();if(s){const e=this.getParameter("CutVector").getValue(),i=this.getParameter("CutDist").getValue();t.traverse(t=>{t instanceof ra$1&&(t.setCutawayEnabled(s),t.setCutVector(e),t.setCutDist(i))},!0)}this.getVisible()||t.propagateVisiblity(-1);const o=()=>{const t=this.__initialXfoModeParam.getValue();t==da$1.first&&0==e?this.calcGroupXfo():t!=da$1.average&&t!=da$1.globalOri||this.calcGroupXfo()};i.globalXfoChangedIndex=t.globalXfoChanged.connect(()=>{this.propagatingXfoToItems||(this.__initialXfos[e]=t.getGlobalXfo(),o())}),this.__initialXfos[e]=t.getGlobalXfo(),i.bboxChangedIndex=t.boundingChanged.connect(this._setBoundingBoxDirty),this.__signalIndices[e]=i,o()}__unbindItem(t,e){if(!(t instanceof ia$1))return;t.removeHighlight("branchselected"+this.getId(),!0),this.getParameter("Highlighted").getValue()&&t.removeHighlight("groupItemHighlight"+this.getId(),!0),this.getVisible()||t.propagateVisiblity(1),t.traverse(t=>{t instanceof ra$1&&t.setCutawayEnabled(!1)},!0);const i=this.__signalIndices[e];t.mouseDown.disconnectId(i.mouseDownIndex),t.mouseUp.disconnectId(i.mouseUpIndex),t.mouseMove.disconnectId(i.mouseMoveIndex),t.mouseEnter.disconnectId(i.mouseEnterIndex),t.mouseLeave.disconnectId(i.mouseLeaveIndex),t.globalXfoChanged.disconnectId(i.globalXfoChangedIndex),t.boundingChanged.disconnectId(i.bboxChangedIndex),this.__signalIndices.splice(e,1),this.__initialXfos.splice(e,1)}addItem(t,e=!0){t?this.__itemsParam.addItem(t,e):console.warn("Error adding item to group. Item is null")}removeItem(t,e=!0){this.__itemsParam.removeItem(t,e)}clearItems(t=!0){const e=Array.from(this.__itemsParam.getValue());for(let i=e.length-1;i>=0;i--)this.__unbindItem(e[i],i);this.__signalIndices=[],this.__initialXfos=[],this.__itemsParam.clearItems(t)}getItems(){return this.__itemsParam.getValue()}setItems(t){this.clearItems(!1),this.__itemsParam.setItems(t)}_cleanBoundingBox(t){const e=super._cleanBoundingBox(t);return Array.from(this.__itemsParam.getValue()).forEach(t=>{t instanceof ia$1&&t.getVisible()&&!t.testFlag($$1.IGNORE_BBOX)&&e.addBox3(t.getBoundingBox())}),e}onMouseDown(t){super.onMouseDown(t)}onMouseUp(t){super.onMouseUp(t)}onMouseMove(t){super.onMouseMove(t)}toJSON(t,e){const i=super.toJSON(t,e),n=Array.from(this.__itemsParam.getValue()),s=[];return n.forEach(e=>{const i=e.getPath();s.push(t?t.makeRelative(i):i)}),i.treeItems=s,i}fromJSON(t,e,i){if(super.fromJSON(t,e,i),this.setFlag($$1.USER_EDITED),!t.treeItems)return void console.warn("Invalid Parameter JSON");let n=t.treeItems.length;const s=t=>{e.resolvePath(t,t=>{this.addItem(t),n--,0==n&&(this.calculatingGroupXfo=!0,this.calcGroupXfo(),this.calculatingGroupXfo=!1)},()=>{console.warn("Group: '"+this.getName()+"'. Unable to load item:"+t)})};for(const o of t.treeItems)s(o)}clone(t){const e=new ha$1;return e.copyFrom(this,t),e}copyFrom(t,e){super.copyFrom(t,e)}destroy(){super.destroy()}}J$1.registerClass("Group",ha$1);var ca$1=he$1("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpjb25zdCB0PU1hdGguUEkvMTgwO01hdGguSEFMRl9QST0uNSpNYXRoLlBJLE1hdGguVFdPX1BJPTIqTWF0aC5QSTtNYXRoLnJhZFRvRGVnPWZ1bmN0aW9uKGUpe3JldHVybiBlL3R9LE1hdGguZGVnVG9SYWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGUqdH0sTnVtYmVyLmlzTnVtZXJpYz10PT4haXNOYU4ocGFyc2VGbG9hdCh0KSkmJmlzRmluaXRlKHQpLFN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnJlcGxhY2UobmV3IFJlZ0V4cCh0LCJnIiksZSl9O2Z1bmN0aW9uIGUodCxlPTAscz01KXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkodCwoZnVuY3Rpb24odCxlKXtyZXR1cm4gZSYmZS50b0ZpeGVkP051bWJlcihlLnRvRml4ZWQocykpOmV9KSxlKX1TdHJpbmcucHJvdG90eXBlLmhhc2g9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCl7bGV0IGUscyxhLGk9MDtpZigwPT09dC5sZW5ndGgpcmV0dXJuIGk7Zm9yKGU9MCxhPXQubGVuZ3RoO2U8YTtlKyspcz10LmNoYXJDb2RlQXQoZSksaT0oaTw8NSktaStzLGl8PTA7cmV0dXJuIE1hdGguYWJzKGkpfSh0aGlzKX0sU3RyaW5nLnByb3RvdHlwZS50cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzK3xccyskL2csIiIpfSxTdHJpbmcucHJvdG90eXBlLmx0cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzKy8sIiIpfSxTdHJpbmcucHJvdG90eXBlLnJ0cmltPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucmVwbGFjZSgvXHMrJC8sIiIpfSxTdHJpbmcucHJvdG90eXBlLmxwYWQ9ZnVuY3Rpb24odCxlKXtsZXQgcz10aGlzO2Zvcig7cy5sZW5ndGg8ZTspcz10K3M7cmV0dXJuIHN9LFN0cmluZy5wcm90b3R5cGUucnBhZD1mdW5jdGlvbih0LGUpe2xldCBzPXRoaXM7Zm9yKDtzLmxlbmd0aDxlOylzKz10O3JldHVybiBzfSxNYXRoLnJhbmRvbUludD1mdW5jdGlvbih0LGUpe3JldHVybiB0PU1hdGguY2VpbCh0KSxlPU1hdGguZmxvb3IoZSksTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihlLXQpKSt0fSxNYXRoLmxlcnA9KHQsZSxzKT0+dCtzKihlLXQpLE1hdGguY2xhbXA9ZnVuY3Rpb24odCxlLHMpe3JldHVybiBNYXRoLm1pbihNYXRoLm1heCh0LGUpLHMpfSxNYXRoLm5lYXJlc3RQb3cyPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnBvdygyLE1hdGgucm91bmQoTWF0aC5sb2codCkvTWF0aC5sb2coMikpKX0sTWF0aC5uZWFyZXN0UG93MTA9ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGgucG93KDEwLE1hdGgucm91bmQoTWF0aC5sb2cxMCh0KS9NYXRoLmxvZzEwKDEwKSkpfSxNYXRoLm5leHRQb3cyPWZ1bmN0aW9uKHQpe2xldCBlPTA7Zm9yKDt0PjA7KWUrKyx0Pj49MTtyZXR1cm4gMTw8ZX0sTWF0aC5mcmFjdD1mdW5jdGlvbih0KXtyZXR1cm4gMD09dD8wOnQ8MD90Pi0xPy10Oi10JU1hdGguZmxvb3IoLXQpOnQ8MT90OnQlTWF0aC5mbG9vcih0KX0sTWF0aC5yZW1hcD1mdW5jdGlvbih0LGUscyxhLGkpe3JldHVybiBhKyh0LWUpLyhzLWUpKihpLWEpfSxNYXRoLmNvbnZlcnRGbG9hdDMyQXJyYXlUb1VJbnQxNkFycmF5PWZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IFVpbnQxNkFycmF5KHQubGVuZ3RoKSxzPW5ldyBJbnQzMkFycmF5KHQuYnVmZmVyKSxhPXQ9PntsZXQgZT10Pj4xNiYzMjc2OCxzPXQ+PjEyJjIwNDc7Y29uc3QgYT10Pj4yMyYyNTU7cmV0dXJuIGE8MTAzP2U6YT4xNDI/KGV8PTMxNzQ0LGV8PSgyNTU9PWE/MDoxKSYmODM4ODYwNyZ0LGUpOmE8MTEzPyhzfD0yMDQ4LGV8PShzPj4xMTQtYSkrKHM+PjExMy1hJjEpLGUpOihlfD1hLTExMjw8MTB8cz4+MSxlKz0xJnMsZSl9O2ZvcihsZXQgaT0wO2k8dC5sZW5ndGg7aSsrKWVbaV09YShzW2ldKTtyZXR1cm4gZX0sTWF0aC5kZWNvZGUxNkJpdEZsb2F0RnJvbTJ4VUludDg9dD0+e2NvbnN0IGU9dFswXSxzPSgxMjAmZSk+PjM7bGV0IGE9MD09cz8wOjIwNDg7Y29uc3QgaT1hKygoNyZlKTw8OCkrdFsxXTtyZXR1cm4gYT0wPT1zPzE6MCwoMTI4JmU/MTotMSkqaSpNYXRoLnBvdygyLHMrYS0xNil9LE1hdGguZW5jb2RlMTZCaXRGbG9hdEludG8yeFVJbnQ4PXQ9PntjfHwoYz1uZXcgVWludDhBcnJheSgyKSk7Y29uc3QgZT10Pj0wPzEyODowO3Q9TWF0aC5hYnModCk7bGV0IHMsYT0xNSxpPTEwMjQ7Zm9yKGxldCBlPTE1O2U+MDtlLS0pdDxpJiYoaS89MixhLS0pO3M9MD09YT90L2kvMjoodC1pKS9pO2NvbnN0IHI9TWF0aC5yb3VuZCgyMDQ4KnMpLG49ci8yNTYsaD1yLTI1NipuO3JldHVybiBjWzBdPWUrOCphK24sY1sxXT1oLHQ+PTIwNDgmJihjWzBdPTI1NSksY30sTWF0aC5lbmNvZGUxNkJpdEZsb2F0PXQ9Pntjb25zdCBlPW5ldyBGbG9hdDMyQXJyYXkoMSk7ZVswXT10O3JldHVybih0PT57bGV0IGU9dD4+MTYmMzI3Njgscz10Pj4xMiYyMDQ3O2NvbnN0IGE9dD4+MjMmMjU1O3JldHVybiBhPDEwMz9lOmE+MTQyPyhlfD0zMTc0NCxlfD0oMjU1PT1hPzA6MSkmJjgzODg2MDcmdCxlKTphPDExMz8oc3w9MjA0OCxlfD0ocz4+MTE0LWEpKyhzPj4xMTMtYSYxKSxlKTooZXw9YS0xMTI8PDEwfHM+PjEsZSs9MSZzLGUpfSkobmV3IEludDMyQXJyYXkoZS5idWZmZXIpWzBdKX0sTWF0aC5kZWNvZGUxNkJpdEZsb2F0PXQ9Pntjb25zdCBlPSgzMjc2OCZ0KT4+MTUscz0oMzE3NDQmdCk+PjEwLGE9MTAyMyZ0O3JldHVybiAwPT1zPyhlPy0xOjEpKk1hdGgucG93KDIsLTE0KSooYS9NYXRoLnBvdygyLDEwKSk6MzE9PXM/YT9OYU46MS8wKihlPy0xOjEpOihlPy0xOjEpKk1hdGgucG93KDIscy0xNSkqKDErYS9NYXRoLnBvdygyLDEwKSl9LE1hdGguc21vb3RoU3RlcD0odCxlLHMpPT57Y29uc3QgYT1NYXRoLmNsYW1wKChzLXQpLyhlLXQpLDAsMSk7cmV0dXJuIGEqYSooMy0yKmEpfSxNYXRoLmxpblN0ZXA9KHQsZSxzKT0+TWF0aC5jbGFtcCgocy10KS8oZS10KSwwLDEpO2NsYXNzIHN7aXNWYWxpZCgpe2Zvcihjb25zdCB0IG9mIHRoaXMuX19kYXRhKWlmKHQ9PTEvMHx8aXNOYU4odCkpcmV0dXJuITE7cmV0dXJuITB9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZSl7dGhyb3cgbmV3IEVycm9yKCJOb3QgeWV0IGltcGxlbWVudGVkIGZvciB0aGlzIHR5cGU6Iit0aGlzLmNvbnN0cnVjdG9yLm5hbWUpfXN0YXRpYyBudW1FbGVtZW50cygpe3Rocm93IG5ldyBFcnJvcigiTm90IHlldCBpbXBsZW1lbnRlZCBmb3IgdGhpcyB0eXBlOiIrdGhpcy5jb25zdHJ1Y3Rvci5uYW1lKX1hc0FycmF5KCl7cmV0dXJuIHRoaXMuX19kYXRhfXRvU3RyaW5nKCl7cmV0dXJuIGUodGhpcy50b0pTT04oKSl9fWNvbnN0IGE9bmV3IGNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5fX3R5cGVzPXt9LHRoaXMuX19uYW1lcz17fSx0aGlzLnJlZ2lzdGVyVHlwZSgiU0ludDMyIiw1KSx0aGlzLnJlZ2lzdGVyVHlwZSgiVUludDMyIiw0KSx0aGlzLnJlZ2lzdGVyVHlwZSgiRmxvYXQzMiIsNil9cmVnaXN0ZXJUeXBlKHQsZSl7dGhpcy5fX3R5cGVzW3RdPWUsZS5uYW1lP3RoaXMuX19uYW1lc1tlLm5hbWVdPXQ6dGhpcy5fX25hbWVzW2VdPXR9Z2V0VHlwZSh0KXtyZXR1cm4gdGhpcy5fX3R5cGVzW3RdfWdldFR5cGVOYW1lKHQpe2lmKHRoaXMuX19uYW1lc1t0XSlyZXR1cm4gdGhpcy5fX25hbWVzW3RdO2lmKHRoaXMuX19uYW1lc1t0Lm5hbWVdKXJldHVybiB0aGlzLl9fbmFtZXNbdC5uYW1lXTt0aHJvdyB0fX07Y2xhc3MgaSBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0wLGU9MCl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHx0IGluc3RhbmNlb2YgVWludDMyQXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQzMkFycmF5KXRoaXMuX19kYXRhPXQ7ZWxzZSBpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsMil9ZWxzZSBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHQ/KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMiksdGhpcy5mcm9tSlNPTih0KSk6KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMiksdGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lKX1nZXQgeCgpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgeCh0KXt0aGlzLl9fZGF0YVswXT10fWdldCB5KCl7cmV0dXJuIHRoaXMuX19kYXRhWzFdfXNldCB5KHQpe3RoaXMuX19kYXRhWzFdPXR9c2V0KHQsZSl7dGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lfXNldEZyb21PdGhlcih0KXt0aGlzLng9dC54LHRoaXMueT10Lnl9ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueX1ub3RFcXVhbHModCl7cmV0dXJuIHRoaXMueCE9dC54JiZ0aGlzLnkhPXQueX1hcHByb3hFcXVhbCh0LGU9TnVtYmVyLkVQU0lMT04pe3JldHVybiBNYXRoLmFicyh0aGlzLngtdC54KTxlJiZNYXRoLmFicyh0aGlzLnktdC55KTxlfWFkZCh0KXtyZXR1cm4gbmV3IGkodGhpcy54K3QueCx0aGlzLnkrdC55KX1hZGRJblBsYWNlKHQpe3RoaXMueCs9dC54LHRoaXMueSs9dC55fXN1YnRyYWN0KHQpe3JldHVybiBuZXcgaSh0aGlzLngtdC54LHRoaXMueS10LnkpfXN1YnRyYWN0SW5QbGFjZSh0KXtyZXR1cm4gdGhpcy54LT10LngsdGhpcy55LT10LnksdGhpc31zY2FsZSh0KXtyZXR1cm4gbmV3IGkodGhpcy54KnQsdGhpcy55KnQpfXNjYWxlSW5QbGFjZSh0KXt0aGlzLngqPXQsdGhpcy55Kj10fWludmVydCgpe3JldHVybiBuZXcgaSgxL3RoaXMueCwxL3RoaXMueSl9aW52ZXJ0SW5QbGFjZSgpe3JldHVybiB0aGlzLng9MS90aGlzLngsdGhpcy55PTEvdGhpcy55LHRoaXN9bXVsdGlwbHkodCl7cmV0dXJuIG5ldyBpKHRoaXMueCp0LngsdGhpcy55KnQueSl9bXVsdGlwbHlJblBsYWNlKHQpe3RoaXMueCo9dC54LHRoaXMueSo9dC55fWxlbmd0aFNxdWFyZWQoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV07cmV0dXJuIHQqdCtlKmV9bGVuZ3RoKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLmxlbmd0aFNxdWFyZWQoKSl9ZGlzdGFuY2VUbyh0KXtjb25zdCBlPXRoaXMuX19kYXRhWzBdLXQueCxzPXRoaXMuX19kYXRhWzFdLXQueTtyZXR1cm4gTWF0aC5zcXJ0KGUqZStzKnMpfW5vcm1hbGl6ZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXTtsZXQgcz10KnQrZSplO3JldHVybiBzPE51bWJlci5FUFNJTE9OP25ldyBpOihzPTEvTWF0aC5zcXJ0KHMpLG5ldyBpKHQqcyxlKnMpKX1ub3JtYWxpemVJblBsYWNlKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdO2xldCBzPXQqdCtlKmU7czxOdW1iZXIuRVBTSUxPTnx8KHM9MS9NYXRoLnNxcnQocyksdGhpcy5zZXQodCpzLGUqcykpfWRvdCh0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55fWNyb3NzKHQpe3JldHVybiB0aGlzLngqdC55LXRoaXMueSp0Lnh9YW5nbGVUbyh0KXtjb25zdCBlPXRoaXMubm9ybWFsaXplKCkuZG90KHQubm9ybWFsaXplKCkpO3JldHVybiBlPjE/MDplPC0xP01hdGguUEk6TWF0aC5hY29zKGUpfXNpZ25lZEFuZ2xlVG8odCl7Y29uc3QgZT10aGlzLmFuZ2xlVG8odCk7cmV0dXJuIHRoaXMuY3Jvc3ModCk8MD8tZTplfXJvdGF0ZSh0KXtjb25zdCBlPU1hdGguY29zKHQpLHM9TWF0aC5zaW4odCk7cmV0dXJuIG5ldyBpKHRoaXMueCplLXRoaXMueSpzLHRoaXMueCpzK3RoaXMueSplKX1sZXJwKHQsZSl7Y29uc3Qgcz10aGlzLngsYT10aGlzLnk7cmV0dXJuIG5ldyBpKHMrZSoodC54LXMpLGErZSoodC55LWEpKX1zZXRSYW5kb21EaXIodD0xKXtjb25zdCBlPTIqTWF0aC5yYW5kb20oKSpNYXRoLlBJO3JldHVybiB0aGlzLl9fZGF0YVswXT1NYXRoLmNvcyhlKSp6U2NhbGUsdGhpcy5fX2RhdGFbMV09TWF0aC5zaW4oZSkqelNjYWxlLHRoaXN9c2V0UmFuZG9tKHQ9MSl7cmV0dXJuIHRoaXMuX19kYXRhWzBdPU1hdGgucmFuZG9tKCkqdCx0aGlzLl9fZGF0YVsxXT1NYXRoLnJhbmRvbSgpKnQsdGhpc31jbG9uZSgpe3JldHVybiBuZXcgaSh0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSl9YXNBcnJheSgpe3JldHVybiB0aGlzLl9fZGF0YX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgaSguLi50KX1zdGF0aWMgY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodCxlPTApe3JldHVybiBuZXcgaSh0LDQqZSl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQXJyYXkodCl7cmV0dXJuIG5ldyBpKHQpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiAyfXRvSlNPTigpe3JldHVybnt4OnRoaXMueCx5OnRoaXMueX19ZnJvbUpTT04odCl7dGhpcy54PXQueCx0aGlzLnk9dC55fX1hLnJlZ2lzdGVyVHlwZSgiVmVjMiIsaSk7Y2xhc3MgciBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0wLGU9MCxzPTApe2lmKHN1cGVyKCksdCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheXx8dCBpbnN0YW5jZW9mIFVpbnQzMkFycmF5KXRoaXMuX19kYXRhPXQ7ZWxzZSBpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsMyl9ZWxzZSBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHQ/KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMyksdGhpcy5mcm9tSlNPTih0KSk6KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMyksdGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lLHRoaXMuX19kYXRhWzJdPXMpfWdldCB4KCl7cmV0dXJuIHRoaXMuX19kYXRhWzBdfXNldCB4KHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IHkoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IHkodCl7dGhpcy5fX2RhdGFbMV09dH1nZXQgeigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgeih0KXt0aGlzLl9fZGF0YVsyXT10fWdldCB4eSgpe3JldHVybiBuZXcgaSh0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSl9Z2V0IHl6KCl7cmV0dXJuIG5ldyBpKHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdKX1zZXQodCxlLHMpe3RoaXMueD10LHRoaXMueT12b2lkIDAhPT1lP2U6dCx0aGlzLno9dm9pZCAwIT09cz9zOnR9c2V0RGF0YUFycmF5KHQpe3RoaXMuX19kYXRhPXR9c2V0RnJvbU90aGVyKHQpe3RoaXMueD10LngsdGhpcy55PXQueSx0aGlzLno9dC56fWlzTnVsbCgpe3JldHVybiBNYXRoLmFicyh0aGlzLngpPE51bWJlci5FUFNJTE9OJiZNYXRoLmFicyh0aGlzLnkpPE51bWJlci5FUFNJTE9OJiZNYXRoLmFicyh0aGlzLnopPE51bWJlci5FUFNJTE9OfWlzMTExKCl7cmV0dXJuIE1hdGguYWJzKDEtdGhpcy54KTxOdW1iZXIuRVBTSUxPTiYmTWF0aC5hYnMoMS10aGlzLnkpPE51bWJlci5FUFNJTE9OJiZNYXRoLmFicygxLXRoaXMueik8TnVtYmVyLkVQU0lMT059ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueSYmdGhpcy56PT10Lnp9bm90RXF1YWxzKHQpe3JldHVybiB0aGlzLnghPXQueCYmdGhpcy55IT10LnkmJnRoaXMueiE9dC56fWFwcHJveEVxdWFsKHQsZT1OdW1iZXIuRVBTSUxPTil7cmV0dXJuIE1hdGguYWJzKHRoaXMueC10LngpPGUmJk1hdGguYWJzKHRoaXMueS10LnkpPGUmJk1hdGguYWJzKHRoaXMuei10LnopPGV9YWRkKHQpe3JldHVybiBuZXcgcih0aGlzLngrdC54LHRoaXMueSt0LnksdGhpcy56K3Queil9YWRkSW5QbGFjZSh0KXt0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzLnorPXQuen1zdWJ0cmFjdCh0KXtyZXR1cm4gbmV3IHIodGhpcy54LXQueCx0aGlzLnktdC55LHRoaXMuei10LnopfXN1YnRyYWN0SW5QbGFjZSh0KXt0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQuen1tdWx0aXBseSh0KXtyZXR1cm4gbmV3IHIodGhpcy54KnQueCx0aGlzLnkqdC55LHRoaXMueip0LnopfW11bHRpcGx5SW5QbGFjZSh0KXt0aGlzLngqPXQueCx0aGlzLnkqPXQueSx0aGlzLnoqPXQuen1kaXZpZGUodCl7cmV0dXJuIG5ldyByKHRoaXMueC90LngsdGhpcy55L3QueSx0aGlzLnovdC56KX1kaXZpZGVJblBsYWNlKHQpe3RoaXMueC89dC54LHRoaXMueS89dC55LHRoaXMuei89dC56fXNjYWxlKHQpe3JldHVybiBuZXcgcih0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCl9c2NhbGVJblBsYWNlKHQpe3RoaXMueCo9dCx0aGlzLnkqPXQsdGhpcy56Kj10fW5lZ2F0ZSgpe3JldHVybiBuZXcgcigtdGhpcy54LC10aGlzLnksLXRoaXMueil9aW52ZXJzZSgpe3JldHVybiBuZXcgcigxL3RoaXMueCwxL3RoaXMueSwxL3RoaXMueil9bGVuZ3RoU3F1YXJlZCgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdO3JldHVybiB0KnQrZSplK3Mqc31sZW5ndGgoKXtyZXR1cm4gTWF0aC5zcXJ0KHRoaXMubGVuZ3RoU3F1YXJlZCgpKX1kaXN0YW5jZVRvKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0tdC54LHM9dGhpcy5fX2RhdGFbMV0tdC55LGE9dGhpcy5fX2RhdGFbMl0tdC56O3JldHVybiBNYXRoLnNxcnQoZSplK3MqcythKmEpfW5vcm1hbGl6ZSgpe2xldCB0PXRoaXMuX19kYXRhWzBdKnRoaXMuX19kYXRhWzBdK3RoaXMuX19kYXRhWzFdKnRoaXMuX19kYXRhWzFdK3RoaXMuX19kYXRhWzJdKnRoaXMuX19kYXRhWzJdO3JldHVybiB0PE51bWJlci5FUFNJTE9OP25ldyByOih0PTEvTWF0aC5zcXJ0KHQpLG5ldyByKHRoaXMuX19kYXRhWzBdKnQsdGhpcy5fX2RhdGFbMV0qdCx0aGlzLl9fZGF0YVsyXSp0KSl9bm9ybWFsaXplSW5QbGFjZSgpe2xldCB0PXRoaXMuX19kYXRhWzBdKnRoaXMuX19kYXRhWzBdK3RoaXMuX19kYXRhWzFdKnRoaXMuX19kYXRhWzFdK3RoaXMuX19kYXRhWzJdKnRoaXMuX19kYXRhWzJdO2lmKHQ8TnVtYmVyLkVQU0lMT04pcmV0dXJuO3Q9TWF0aC5zcXJ0KHQpO2NvbnN0IGU9MS90O3JldHVybiB0aGlzLl9fZGF0YVswXSo9ZSx0aGlzLl9fZGF0YVsxXSo9ZSx0aGlzLl9fZGF0YVsyXSo9ZSx0fXJlc2l6ZSh0KXtjb25zdCBlPXRoaXMuX19kYXRhWzBdKnRoaXMuX19kYXRhWzBdK3RoaXMuX19kYXRhWzFdKnRoaXMuX19kYXRhWzFdK3RoaXMuX19kYXRhWzJdKnRoaXMuX19kYXRhWzJdO2lmKGU8TnVtYmVyLkVQU0lMT04pcmV0dXJuO2NvbnN0IHM9dC9NYXRoLnNxcnQoZSk7cmV0dXJuIG5ldyByKHRoaXMuX19kYXRhWzBdKnMsdGhpcy5fX2RhdGFbMV0qcyx0aGlzLl9fZGF0YVsyXSpzKX1yZXNpemVJblBsYWNlKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0qdGhpcy5fX2RhdGFbMF0rdGhpcy5fX2RhdGFbMV0qdGhpcy5fX2RhdGFbMV0rdGhpcy5fX2RhdGFbMl0qdGhpcy5fX2RhdGFbMl07aWYoZTxOdW1iZXIuRVBTSUxPTilyZXR1cm47Y29uc3Qgcz10L01hdGguc3FydChlKTt0aGlzLl9fZGF0YVswXSo9cyx0aGlzLl9fZGF0YVsxXSo9cyx0aGlzLl9fZGF0YVsyXSo9c31kb3QodCl7cmV0dXJuIHRoaXMueCp0LngrdGhpcy55KnQueSt0aGlzLnoqdC56fWNyb3NzKHQpe2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dC54LG49dC55LGg9dC56O3JldHVybiBuZXcgcihzKmgtYSpuLGEqaS1lKmgsZSpuLXMqaSl9YW5nbGVUbyh0KXtjb25zdCBlPXRoaXMuZG90KHQpO3JldHVybiBlPjE/MDpNYXRoLmFjb3MoZSl9bGVycCh0LGUpe2NvbnN0IHM9dGhpcy54LGE9dGhpcy55LGk9dGhpcy56O3JldHVybiBuZXcgcihzK2UqKHQueC1zKSxhK2UqKHQueS1hKSxpK2UqKHQuei1pKSl9YWJzKCl7cmV0dXJuIG5ldyByKE1hdGguYWJzKHRoaXMueCksTWF0aC5hYnModGhpcy55KSxNYXRoLmFicyh0aGlzLnopKX1zZXRSYW5kb21EaXIodD0xKXtjb25zdCBlPTIqTWF0aC5yYW5kb20oKSpNYXRoLlBJLHM9MipNYXRoLnJhbmRvbSgpLTEsYT1NYXRoLnNxcnQoMS1zKnMpKnQ7cmV0dXJuIHRoaXMuX19kYXRhWzBdPU1hdGguY29zKGUpKmEsdGhpcy5fX2RhdGFbMV09TWF0aC5zaW4oZSkqYSx0aGlzLl9fZGF0YVsyXT1zKnQsdGhpc31zZXRSYW5kb20odD0xKXtyZXR1cm4gdGhpcy5fX2RhdGFbMF09KE1hdGgucmFuZG9tKCktLjUpKnQsdGhpcy5fX2RhdGFbMV09KE1hdGgucmFuZG9tKCktLjUpKnQsdGhpcy5fX2RhdGFbMl09KE1hdGgucmFuZG9tKCktLjUpKnQsdGhpc31jbG9uZSgpe3JldHVybiBuZXcgcih0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVsyXSl9YXNBcnJheSgpe3JldHVybiB0aGlzLl9fZGF0YX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgciguLi50KX1zdGF0aWMgY3JlYXRlRnJvbUpTT04odCl7Y29uc3QgZT1uZXcgcjtyZXR1cm4gZS5mcm9tSlNPTih0KSxlfXN0YXRpYyBjcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0LGU9MCl7cmV0dXJuIG5ldyByKHQsNCplKX1zdGF0aWMgY3JlYXRlRnJvbUZsb2F0MzJBcnJheSh0KXtyZXR1cm4gbmV3IHIodCl9c3RhdGljIG51bUVsZW1lbnRzKCl7cmV0dXJuIDN9dG9KU09OKCl7cmV0dXJue3g6dGhpcy54LHk6dGhpcy55LHo6dGhpcy56fX1mcm9tSlNPTih0KXt0aGlzLng9dC54LHRoaXMueT10LnksdGhpcy56PXQuen19YS5yZWdpc3RlclR5cGUoIlZlYzMiLHIpO2NsYXNzIG4gZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQ9MCxlPTAscz0wLGE9MCl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHQ/KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoNCksdGhpcy5mcm9tSlNPTih0KSk6KHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoNCksdGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lLHRoaXMuX19kYXRhWzJdPXMsdGhpcy5fX2RhdGFbM109YSl9Z2V0IHgoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMF19c2V0IHgodCl7dGhpcy5fX2RhdGFbMF09dH1nZXQgeSgpe3JldHVybiB0aGlzLl9fZGF0YVsxXX1zZXQgeSh0KXt0aGlzLl9fZGF0YVsxXT10fWdldCB6KCl7cmV0dXJuIHRoaXMuX19kYXRhWzJdfXNldCB6KHQpe3RoaXMuX19kYXRhWzJdPXR9Z2V0IHQoKXtyZXR1cm4gdGhpcy5fX2RhdGFbM119c2V0IHQodCl7dGhpcy5fX2RhdGFbM109dH1nZXQgeHl6KCl7cmV0dXJuIG5ldyByKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdKX1zZXQodCxlLHMsYSl7dGhpcy54PXQsdGhpcy55PWUsdGhpcy56PXMsdGhpcy50PWF9c2V0RnJvbU90aGVyKHQpe3RoaXMueD10LngsdGhpcy55PXQueSx0aGlzLno9dC56LHRoaXMudD10LnR9ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueSYmdGhpcy56PT10LnomJnRoaXMudD09dC50fW5vdEVxdWFscyh0KXtyZXR1cm4gdGhpcy54IT10LngmJnRoaXMueSE9dC55JiZ0aGlzLnohPXQueiYmdGhpcy50IT10LnR9YXBwcm94RXF1YWwodCxlPU51bWJlci5FUFNJTE9OKXtyZXR1cm4gTWF0aC5hYnModGhpcy54LXQueCk8ZSYmTWF0aC5hYnModGhpcy55LXQueSk8ZSYmTWF0aC5hYnModGhpcy56LXQueik8ZSYmTWF0aC5hYnModGhpcy50LXQudCk8ZX1hZGQodCl7cmV0dXJuIG5ldyBuKHRoaXMueCt0LngsdGhpcy55K3QueSx0aGlzLnordC56LHRoaXMudCt0LnQpfWFkZEluUGxhY2UodCl7dGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpcy56Kz10LnosdGhpcy50Kz10LnR9c3VidHJhY3QodCl7cmV0dXJuIG5ldyBuKHRoaXMueC10LngsdGhpcy55LXQueSx0aGlzLnotdC56LHRoaXMudC10LnQpfXN1YnRyYWN0SW5QbGFjZSh0KXt0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQueix0aGlzLnQtPXQudH1tdWx0aXBseSh0KXtyZXR1cm4gbmV3IG4odGhpcy54KnQueCx0aGlzLnkqdC55LHRoaXMueip0LnosdGhpcy50KnQudCl9bXVsdGlwbHlJblBsYWNlKHQpe3RoaXMueCo9dC54LHRoaXMueSo9dC55LHRoaXMueio9dC56LHRoaXMudCo9dC50fWRpdmlkZSh0KXtyZXR1cm4gbmV3IG4odGhpcy54L3QueCx0aGlzLnkvdC55LHRoaXMuei90LnosdGhpcy50L3QudCl9ZGl2aWRlSW5QbGFjZSh0KXt0aGlzLngvPXQueCx0aGlzLnkvPXQueSx0aGlzLnovPXQueix0aGlzLnQvPXQudH1zY2FsZSh0KXtyZXR1cm4gbmV3IG4odGhpcy54KnQsdGhpcy55KnQsdGhpcy56KnQsdGhpcy50KnQpfXNjYWxlSW5QbGFjZSh0KXt0aGlzLnNldCh0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCx0aGlzLnQqdCl9bGVuZ3RoKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdLHM9dGhpcy5fX2RhdGFbMl0sYT10aGlzLl9fZGF0YVsyXTtyZXR1cm4gTWF0aC5zcXJ0KHQqdCtlKmUrcypzK2EqYSl9bGVuZ3RoU3F1YXJlZCgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM107cmV0dXJuIHQqdCtlKmUrcypzK2EqYX1ub3JtYWxpemUoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdO2xldCBpPXQqdCtlKmUrcypzK2EqYTtyZXR1cm4gaTxOdW1iZXIuRVBTSUxPTj9uZXcgbjooaT0xL01hdGguc3FydChpKSxuZXcgbih0KmksZSppLHMqaSkpfW5vcm1hbGl6ZUluUGxhY2UoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdO2xldCBpPXQqdCtlKmUrcypzK2EqYTtpPE51bWJlci5FUFNJTE9OfHwoaT0xL01hdGguc3FydChpKSx0aGlzLnNldCh0KmksZSppLHMqaSxhKmkpKX1kb3QodCl7cmV0dXJuIHRoaXMueCp0LngrdGhpcy55KnQueSt0aGlzLnoqdC56K3RoaXMudCpiLnR9Y3Jvc3ModCl7Y29uc3QgZT10aGlzLngscz10aGlzLnksYT10aGlzLnosaT10aGlzLnQscj10LngsaD10Lnksbz10LnosXz10LnQ7cmV0dXJuIG5ldyBuKHMqby1hKmgsYSpfLWkqbyxpKnItZSpfLGUqaC1zKnIpfWFuZ2xlVG8odCl7Y29uc3QgZT10aGlzLm5vcm1hbGl6ZSgpLHM9dC5ub3JtYWxpemUoKSxhPWUuZG90KHMpO3JldHVybiBhPjE/MDpNYXRoLmFjb3MoYSl9bGVycCh0LGUpe2NvbnN0IHM9dGhpcy54LGE9dGhpcy55LGk9dGhpcy56O3JldHVybiBhdD10aGlzLnQsbmV3IG4ocytlKih0LngtcyksYStlKih0LnktYSksaStlKih0LnotaSksYXQrZSoodC50LWF0KSl9cmFuZG9tKHQ9MSl7Y29uc3QgZT0yKmdsTWF0cml4LlJBTkRPTSgpKk1hdGguUEkscz0yKmdsTWF0cml4LlJBTkRPTSgpLTEsYT1NYXRoLnNxcnQoMS1zKnMpKnQ7cmV0dXJuIG91dFswXT1NYXRoLmNvcyhlKSphLG91dFsxXT1NYXRoLnNpbihlKSphLG91dFsyXT1zKnQsb3V0fWNsb25lKCl7cmV0dXJuIG5ldyBuKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzNdKX10b1ZlYzMoKXtyZXR1cm4gbmV3IHIodGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl0pfWFzQXJyYXkoKXtyZXR1cm4gdGhpcy5fX2RhdGF9c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IHIoLi4udCl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IG4odCw0KmUpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiA0fXRvSlNPTigpe3JldHVybnt4OnRoaXMueCx5OnRoaXMueSx6OnRoaXMueix0OnRoaXMudH19fWEucmVnaXN0ZXJUeXBlKCJWZWM0IixuKTtjbGFzcyBoIGV4dGVuZHMgc3tjb25zdHJ1Y3Rvcih0PTAsZT0wLHM9MCxhPTI1NSl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgVWludDhBcnJheSl0aGlzLl9fZGF0YT10O2Vsc2UgaWYodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXtjb25zdCBzPXQsYT1lO3RoaXMuX19kYXRhPW5ldyBVaW50OEFycmF5KHMsYSw0KX1lbHNlIHRoaXMuX19kYXRhPW5ldyBVaW50OEFycmF5KDQpLCJzdHJpbmciPT10eXBlb2YgdD90LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tQ1NTQ29sb3JOYW1lKHQpOih0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hKX1nZXQgcigpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgcih0KXt0aGlzLl9fZGF0YVswXT10fWdldCBnKCl7cmV0dXJuIHRoaXMuX19kYXRhWzFdfXNldCBnKHQpe3RoaXMuX19kYXRhWzFdPXR9Z2V0IGIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMl19c2V0IGIodCl7dGhpcy5fX2RhdGFbMl09dH1nZXQgYSgpe3JldHVybiB0aGlzLl9fZGF0YVszXX1zZXQgYSh0KXt0aGlzLl9fZGF0YVszXT10fXNldCh0LGUscyxhPTI1NSl7dGhpcy5yPXQsdGhpcy5nPWUsdGhpcy5iPXMsdGhpcy5hPWF9c2V0RnJvbU90aGVyKHQpe3RoaXMucj10LnIsdGhpcy5nPXQuZyx0aGlzLmI9dC5iLHRoaXMuYT10LmF9c2V0RnJvbUFycmF5KHQpe3RoaXMucj10WzBdLHRoaXMuZz10WzFdLHRoaXMuYj10WzJdLHRoaXMuYT00PT10Lmxlbmd0aD90WzNdOjF9c2V0RnJvbUhleCh0KXtjb25zdCBlPWZ1bmN0aW9uKHQpe2NvbnN0IGU9L14jPyhbYS1mXGRdezJ9KShbYS1mXGRdezJ9KShbYS1mXGRdezJ9KSQvaS5leGVjKHQpO3JldHVybiBlP3tyOnBhcnNlSW50KGVbMV0sMTYpLGc6cGFyc2VJbnQoZVsyXSwxNiksYjpwYXJzZUludChlWzNdLDE2KX06bnVsbH0odCk7ZT90aGlzLnNldChlLnIsZS5nLGUuYik6Y29uc29sZS53YXJuKCJJbnZhbGlkIGhleCBjb2RlOiIrdCl9c2V0RnJvbUNTU0NvbG9yTmFtZSh0KXt0LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tSGV4KCh0PT57Y29uc3QgZT17YWxpY2VibHVlOiIjZjBmOGZmIixhbnRpcXVld2hpdGU6IiNmYWViZDciLGFxdWE6IiMwMGZmZmYiLGFxdWFtYXJpbmU6IiM3ZmZmZDQiLGF6dXJlOiIjZjBmZmZmIixiZWlnZToiI2Y1ZjVkYyIsYmlzcXVlOiIjZmZlNGM0IixibGFjazoiIzAwMDAwMCIsYmxhbmNoZWRhbG1vbmQ6IiNmZmViY2QiLGJsdWU6IiMwMDAwZmYiLGJsdWV2aW9sZXQ6IiM4YTJiZTIiLGJyb3duOiIjYTUyYTJhIixidXJseXdvb2Q6IiNkZWI4ODciLGNhZGV0Ymx1ZToiIzVmOWVhMCIsY2hhcnRyZXVzZToiIzdmZmYwMCIsY2hvY29sYXRlOiIjZDI2OTFlIixjb3JhbDoiI2ZmN2Y1MCIsY29ybmZsb3dlcmJsdWU6IiM2NDk1ZWQiLGNvcm5zaWxrOiIjZmZmOGRjIixjcmltc29uOiIjZGMxNDNjIixjeWFuOiIjMDBmZmZmIixkYXJrYmx1ZToiIzAwMDA4YiIsZGFya2N5YW46IiMwMDhiOGIiLGRhcmtnb2xkZW5yb2Q6IiNiODg2MGIiLGRhcmtncmF5OiIjYTlhOWE5IixkYXJrZ3JlZW46IiMwMDY0MDAiLGRhcmtraGFraToiI2JkYjc2YiIsZGFya21hZ2VudGE6IiM4YjAwOGIiLGRhcmtvbGl2ZWdyZWVuOiIjNTU2YjJmIixkYXJrb3JhbmdlOiIjZmY4YzAwIixkYXJrb3JjaGlkOiIjOTkzMmNjIixkYXJrcmVkOiIjOGIwMDAwIixkYXJrc2FsbW9uOiIjZTk5NjdhIixkYXJrc2VhZ3JlZW46IiM4ZmJjOGYiLGRhcmtzbGF0ZWJsdWU6IiM0ODNkOGIiLGRhcmtzbGF0ZWdyYXk6IiMyZjRmNGYiLGRhcmt0dXJxdW9pc2U6IiMwMGNlZDEiLGRhcmt2aW9sZXQ6IiM5NDAwZDMiLGRlZXBwaW5rOiIjZmYxNDkzIixkZWVwc2t5Ymx1ZToiIzAwYmZmZiIsZGltZ3JheToiIzY5Njk2OSIsZG9kZ2VyYmx1ZToiIzFlOTBmZiIsZmlyZWJyaWNrOiIjYjIyMjIyIixmbG9yYWx3aGl0ZToiI2ZmZmFmMCIsZm9yZXN0Z3JlZW46IiMyMjhiMjIiLGZ1Y2hzaWE6IiNmZjAwZmYiLGdhaW5zYm9ybzoiI2RjZGNkYyIsZ2hvc3R3aGl0ZToiI2Y4ZjhmZiIsZ29sZDoiI2ZmZDcwMCIsZ29sZGVucm9kOiIjZGFhNTIwIixncmF5OiIjODA4MDgwIixncmVlbjoiIzAwODAwMCIsZ3JlZW55ZWxsb3c6IiNhZGZmMmYiLGhvbmV5ZGV3OiIjZjBmZmYwIixob3RwaW5rOiIjZmY2OWI0IiwiaW5kaWFucmVkICI6IiNjZDVjNWMiLGluZGlnbzoiIzRiMDA4MiIsaXZvcnk6IiNmZmZmZjAiLGtoYWtpOiIjZjBlNjhjIixsYXZlbmRlcjoiI2U2ZTZmYSIsbGF2ZW5kZXJibHVzaDoiI2ZmZjBmNSIsbGF3bmdyZWVuOiIjN2NmYzAwIixsZW1vbmNoaWZmb246IiNmZmZhY2QiLGxpZ2h0Ymx1ZToiI2FkZDhlNiIsbGlnaHRjb3JhbDoiI2YwODA4MCIsbGlnaHRjeWFuOiIjZTBmZmZmIixsaWdodGdvbGRlbnJvZHllbGxvdzoiI2ZhZmFkMiIsbGlnaHRncmV5OiIjZDNkM2QzIixsaWdodGdyZWVuOiIjOTBlZTkwIixsaWdodHBpbms6IiNmZmI2YzEiLGxpZ2h0c2FsbW9uOiIjZmZhMDdhIixsaWdodHNlYWdyZWVuOiIjMjBiMmFhIixsaWdodHNreWJsdWU6IiM4N2NlZmEiLGxpZ2h0c2xhdGVncmF5OiIjNzc4ODk5IixsaWdodHN0ZWVsYmx1ZToiI2IwYzRkZSIsbGlnaHR5ZWxsb3c6IiNmZmZmZTAiLGxpbWU6IiMwMGZmMDAiLGxpbWVncmVlbjoiIzMyY2QzMiIsbGluZW46IiNmYWYwZTYiLG1hZ2VudGE6IiNmZjAwZmYiLG1hcm9vbjoiIzgwMDAwMCIsbWVkaXVtYXF1YW1hcmluZToiIzY2Y2RhYSIsbWVkaXVtYmx1ZToiIzAwMDBjZCIsbWVkaXVtb3JjaGlkOiIjYmE1NWQzIixtZWRpdW1wdXJwbGU6IiM5MzcwZDgiLG1lZGl1bXNlYWdyZWVuOiIjM2NiMzcxIixtZWRpdW1zbGF0ZWJsdWU6IiM3YjY4ZWUiLG1lZGl1bXNwcmluZ2dyZWVuOiIjMDBmYTlhIixtZWRpdW10dXJxdW9pc2U6IiM0OGQxY2MiLG1lZGl1bXZpb2xldHJlZDoiI2M3MTU4NSIsbWlkbmlnaHRibHVlOiIjMTkxOTcwIixtaW50Y3JlYW06IiNmNWZmZmEiLG1pc3R5cm9zZToiI2ZmZTRlMSIsbW9jY2FzaW46IiNmZmU0YjUiLG5hdmFqb3doaXRlOiIjZmZkZWFkIixuYXZ5OiIjMDAwMDgwIixvbGRsYWNlOiIjZmRmNWU2IixvbGl2ZToiIzgwODAwMCIsb2xpdmVkcmFiOiIjNmI4ZTIzIixvcmFuZ2U6IiNmZmE1MDAiLG9yYW5nZXJlZDoiI2ZmNDUwMCIsb3JjaGlkOiIjZGE3MGQ2IixwYWxlZ29sZGVucm9kOiIjZWVlOGFhIixwYWxlZ3JlZW46IiM5OGZiOTgiLHBhbGV0dXJxdW9pc2U6IiNhZmVlZWUiLHBhbGV2aW9sZXRyZWQ6IiNkODcwOTMiLHBhcGF5YXdoaXA6IiNmZmVmZDUiLHBlYWNocHVmZjoiI2ZmZGFiOSIscGVydToiI2NkODUzZiIscGluazoiI2ZmYzBjYiIscGx1bToiI2RkYTBkZCIscG93ZGVyYmx1ZToiI2IwZTBlNiIscHVycGxlOiIjODAwMDgwIixyZWJlY2NhcHVycGxlOiIjNjYzMzk5IixyZWQ6IiNmZjAwMDAiLHJvc3licm93bjoiI2JjOGY4ZiIscm95YWxibHVlOiIjNDE2OWUxIixzYWRkbGVicm93bjoiIzhiNDUxMyIsc2FsbW9uOiIjZmE4MDcyIixzYW5keWJyb3duOiIjZjRhNDYwIixzZWFncmVlbjoiIzJlOGI1NyIsc2Vhc2hlbGw6IiNmZmY1ZWUiLHNpZW5uYToiI2EwNTIyZCIsc2lsdmVyOiIjYzBjMGMwIixza3libHVlOiIjODdjZWViIixzbGF0ZWJsdWU6IiM2YTVhY2QiLHNsYXRlZ3JheToiIzcwODA5MCIsc25vdzoiI2ZmZmFmYSIsc3ByaW5nZ3JlZW46IiMwMGZmN2YiLHN0ZWVsYmx1ZToiIzQ2ODJiNCIsdGFuOiIjZDJiNDhjIix0ZWFsOiIjMDA4MDgwIix0aGlzdGxlOiIjZDhiZmQ4Iix0b21hdG86IiNmZjYzNDciLHR1cnF1b2lzZToiIzQwZTBkMCIsdmlvbGV0OiIjZWU4MmVlIix3aGVhdDoiI2Y1ZGViMyIsd2hpdGU6IiNmZmZmZmYiLHdoaXRlc21va2U6IiNmNWY1ZjUiLHllbGxvdzoiI2ZmZmYwMCIseWVsbG93Z3JlZW46IiM5YWNkMzIifTtyZXR1cm4gdm9pZCAwIT09ZVt0LnRvTG93ZXJDYXNlKCldJiZlW3QudG9Mb3dlckNhc2UoKV19KSh0KSl9dG9IZXgoKXtmdW5jdGlvbiB0KHQpe2NvbnN0IGU9dC50b1N0cmluZygxNik7cmV0dXJuIDE9PWUubGVuZ3RoPyIwIitlOmV9cmV0dXJuIiMiK3QodGhpcy5yKSt0KHRoaXMuZykrdCh0aGlzLmIpfWVxdWFsKHQpe3JldHVybiB0aGlzLnI9PXQuciYmdGhpcy5nPT10LmcmJnRoaXMuYj09dC5iJiZ0aGlzLmE9PXQuYX1ub3RlcXVhbHModCl7cmV0dXJuIHRoaXMuciE9dC5yJiZ0aGlzLmchPXQuZyYmdGhpcy5iIT10LmImJnRoaXMuYSE9dC5hfWFwcHJveEVxdWFsKHQsZT1OdW1iZXIuRVBTSUxPTil7cmV0dXJuIE1hdGguYWJzKHRoaXMuci10LnIpPGUmJk1hdGguYWJzKHRoaXMuZy10LmcpPGUmJk1hdGguYWJzKHRoaXMuYi10LmIpPGUmJk1hdGguYWJzKHRoaXMuYS10LmEpPGV9YWRkKHQpe3JldHVybiBuZXcgaCh0aGlzLnIrdC5yLHRoaXMuZyt0LmcsdGhpcy5iK3QuYix0aGlzLmErdC5hKX1zdWJ0cmFjdCh0KXtyZXR1cm4gbmV3IGgodGhpcy5yLXQucix0aGlzLmctdC5nLHRoaXMuYi10LmIsdGhpcy5hLXQuYSl9c2NhbGUodCl7cmV0dXJuIG5ldyBoKHRoaXMucip0LHRoaXMuZyp0LHRoaXMuYip0LHRoaXMuYSp0KX1zY2FsZUluUGxhY2UodCl7dGhpcy5yKj10LHRoaXMuZyo9dCx0aGlzLmIqPXQsdGhpcy5hKj10fWFwcGx5R2FtbWEodCl7dGhpcy5zZXQoTWF0aC5wb3codGhpcy5yLHQpLE1hdGgucG93KHRoaXMuZyx0KSxNYXRoLnBvdyh0aGlzLmIsdCksdGhpcy5hKX10b0xpbmVhcih0PTIuMil7cmV0dXJuIG5ldyBoKE1hdGgucG93KHRoaXMucix0KSxNYXRoLnBvdyh0aGlzLmcsdCksTWF0aC5wb3codGhpcy5iLHQpLHRoaXMuYSl9dG9HYW1tYSh0PTIuMil7cmV0dXJuIG5ldyBoKE1hdGgucG93KHRoaXMuciwxL3QpLE1hdGgucG93KHRoaXMuZywxL3QpLE1hdGgucG93KHRoaXMuYiwxL3QpLHRoaXMuYSl9bHVtaW5hbmNlKCl7cmV0dXJuLjIxMjYqdGhpcy5yKy43MTUyKnRoaXMuZysuMDcyMip0aGlzLmJ9bGVycCh0LGUpe2NvbnN0IHM9dGhpcy5yLGE9dGhpcy5nLGk9dGhpcy5iLHI9dGhpcy5hO3JldHVybiBuZXcgaChzK2UqKHQuci1zKSxhK2UqKHQuZy1hKSxpK2UqKHQuYi1pKSxyK2UqKHQuYS1yKSl9c3RhdGljIHJhbmRvbSh0PTAsZT0hMSl7cmV0dXJuIHQ+MD9uZXcgaCh0K01hdGgucmFuZG9tKCkqKDEtdCksdCtNYXRoLnJhbmRvbSgpKigxLXQpLHQrTWF0aC5yYW5kb20oKSooMS10KSxlP3QrTWF0aC5yYW5kb20oKSooMS10KToxKTp0PDA/bmV3IGgoTWF0aC5yYW5kb20oKSooMSt0KSxNYXRoLnJhbmRvbSgpKigxK3QpLE1hdGgucmFuZG9tKCkqKDErdCksZT9NYXRoLnJhbmRvbSgpKigxK3QpOjEpOm5ldyBoKE1hdGgucmFuZG9tKCksTWF0aC5yYW5kb20oKSxNYXRoLnJhbmRvbSgpLGU/TWF0aC5yYW5kb20oKToxKX1jbG9uZSgpe3JldHVybiBuZXcgaCh0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVsyXSx0aGlzLl9fZGF0YVszXSl9YXNBcnJheSgpe3JldHVybiB0aGlzLl9fZGF0YX1hczNDb21wb25lbnRBcnJheSgpe3JldHVyblt0aGlzLl9fZGF0YVswXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVsyXV19c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IGgoLi4udCl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IGgodCw0KmUpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiA0fXRvSlNPTigpe3JldHVybntyOnRoaXMucixnOnRoaXMuZyxiOnRoaXMuYixhOnRoaXMuYX19ZnJvbUpTT04odCl7dGhpcy5yPXQucix0aGlzLmc9dC5nLHRoaXMuYj10LmIsdGhpcy5hPXQuYX10b0NTU1N0cmluZygpe3JldHVybiJyZ2JhKCIrTWF0aC5yb3VuZCgyNTUqdGhpcy5yKSsiLCAiK01hdGgucm91bmQoMjU1KnRoaXMuZykrIiwgIitNYXRoLnJvdW5kKDI1NSp0aGlzLmIpKyIsICIrdGhpcy5hKyIpIn19YS5yZWdpc3RlclR5cGUoIlJHQkEiLGgpO2NsYXNzIG8gZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQ9MCxlPTAscz0wLGE9MSl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXRoaXMuX19kYXRhPXQ7ZWxzZSBpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSB0aGlzLl9fZGF0YT1uZXcgRmxvYXQzMkFycmF5KDQpLCJzdHJpbmciPT10eXBlb2YgdD90LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tQ1NTQ29sb3JOYW1lKHQpOih0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hKX1nZXQgcigpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgcih0KXt0aGlzLl9fZGF0YVswXT10fWdldCBnKCl7cmV0dXJuIHRoaXMuX19kYXRhWzFdfXNldCBnKHQpe3RoaXMuX19kYXRhWzFdPXR9Z2V0IGIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMl19c2V0IGIodCl7dGhpcy5fX2RhdGFbMl09dH1nZXQgYSgpe3JldHVybiB0aGlzLl9fZGF0YVszXX1zZXQgYSh0KXt0aGlzLl9fZGF0YVszXT10fXNldCh0LGUscyxhPTEpe3RoaXMucj10LHRoaXMuZz1lLHRoaXMuYj1zLHRoaXMuYT1hfXNldEZyb21PdGhlcih0KXt0aGlzLnI9dC5yLHRoaXMuZz10LmcsdGhpcy5iPXQuYix0aGlzLmE9dC5hfXNldEZyb21TY2FsYXJBcnJheSh0KXt0aGlzLnI9dFswXSx0aGlzLmc9dFsxXSx0aGlzLmI9dFsyXSx0aGlzLmE9ND09dC5sZW5ndGg/dFszXToxfWdldEFzUkdCQXJyYXkoKXtyZXR1cm5bMjU1KnRoaXMuciwyNTUqdGhpcy5nLDI1NSp0aGlzLmJdfWdldEFzUkdCRGljdCgpe3JldHVybntyOjI1NSp0aGlzLnIsZzoyNTUqdGhpcy5nLGI6MjU1KnRoaXMuYn19c2V0RnJvbVJHQih0LGUscyxhKXt0aGlzLnI9dC8yNTUsdGhpcy5nPWUvMjU1LHRoaXMuYj1zLzI1NSx0aGlzLmE9YT9hLzI1NToxfXNldEZyb21SR0JBcnJheSh0KXt0aGlzLnI9dFswXS8yNTUsdGhpcy5nPXRbMV0vMjU1LHRoaXMuYj10WzJdLzI1NSx0aGlzLmE9ND09dC5sZW5ndGg/dFszXS8yNTU6MX1zZXRGcm9tUkdCRGljdCh0KXt0aGlzLnI9dC5yLzI1NSx0aGlzLmc9dC5nLzI1NSx0aGlzLmI9dC5iLzI1NSx0aGlzLmE9ND09dC5hP3QuYS8yNTU6MX1zZXRGcm9tSGV4KHQpe2NvbnN0IGU9ZnVuY3Rpb24odCl7Y29uc3QgZT0vXiM/KFthLWZcZF17Mn0pKFthLWZcZF17Mn0pKFthLWZcZF17Mn0pJC9pLmV4ZWModCk7cmV0dXJuIGU/e3I6cGFyc2VJbnQoZVsxXSwxNiksZzpwYXJzZUludChlWzJdLDE2KSxiOnBhcnNlSW50KGVbM10sMTYpfTpudWxsfSh0KTtlP3RoaXMuc2V0RnJvbVJHQihlLnIsZS5nLGUuYik6Y29uc29sZS53YXJuKCJJbnZhbGlkIGhleCBjb2RlOiIrdCl9c2V0RnJvbUNTU0NvbG9yTmFtZSh0KXt0LnN0YXJ0c1dpdGgoIiMiKT90aGlzLnNldEZyb21IZXgodCk6dGhpcy5zZXRGcm9tSGV4KCh0PT57Y29uc3QgZT17YWxpY2VibHVlOiIjZjBmOGZmIixhbnRpcXVld2hpdGU6IiNmYWViZDciLGFxdWE6IiMwMGZmZmYiLGFxdWFtYXJpbmU6IiM3ZmZmZDQiLGF6dXJlOiIjZjBmZmZmIixiZWlnZToiI2Y1ZjVkYyIsYmlzcXVlOiIjZmZlNGM0IixibGFjazoiIzAwMDAwMCIsYmxhbmNoZWRhbG1vbmQ6IiNmZmViY2QiLGJsdWU6IiMwMDAwZmYiLGJsdWV2aW9sZXQ6IiM4YTJiZTIiLGJyb3duOiIjYTUyYTJhIixidXJseXdvb2Q6IiNkZWI4ODciLGNhZGV0Ymx1ZToiIzVmOWVhMCIsY2hhcnRyZXVzZToiIzdmZmYwMCIsY2hvY29sYXRlOiIjZDI2OTFlIixjb3JhbDoiI2ZmN2Y1MCIsY29ybmZsb3dlcmJsdWU6IiM2NDk1ZWQiLGNvcm5zaWxrOiIjZmZmOGRjIixjcmltc29uOiIjZGMxNDNjIixjeWFuOiIjMDBmZmZmIixkYXJrYmx1ZToiIzAwMDA4YiIsZGFya2N5YW46IiMwMDhiOGIiLGRhcmtnb2xkZW5yb2Q6IiNiODg2MGIiLGRhcmtncmF5OiIjYTlhOWE5IixkYXJrZ3JlZW46IiMwMDY0MDAiLGRhcmtraGFraToiI2JkYjc2YiIsZGFya21hZ2VudGE6IiM4YjAwOGIiLGRhcmtvbGl2ZWdyZWVuOiIjNTU2YjJmIixkYXJrb3JhbmdlOiIjZmY4YzAwIixkYXJrb3JjaGlkOiIjOTkzMmNjIixkYXJrcmVkOiIjOGIwMDAwIixkYXJrc2FsbW9uOiIjZTk5NjdhIixkYXJrc2VhZ3JlZW46IiM4ZmJjOGYiLGRhcmtzbGF0ZWJsdWU6IiM0ODNkOGIiLGRhcmtzbGF0ZWdyYXk6IiMyZjRmNGYiLGRhcmt0dXJxdW9pc2U6IiMwMGNlZDEiLGRhcmt2aW9sZXQ6IiM5NDAwZDMiLGRlZXBwaW5rOiIjZmYxNDkzIixkZWVwc2t5Ymx1ZToiIzAwYmZmZiIsZGltZ3JheToiIzY5Njk2OSIsZG9kZ2VyYmx1ZToiIzFlOTBmZiIsZmlyZWJyaWNrOiIjYjIyMjIyIixmbG9yYWx3aGl0ZToiI2ZmZmFmMCIsZm9yZXN0Z3JlZW46IiMyMjhiMjIiLGZ1Y2hzaWE6IiNmZjAwZmYiLGdhaW5zYm9ybzoiI2RjZGNkYyIsZ2hvc3R3aGl0ZToiI2Y4ZjhmZiIsZ29sZDoiI2ZmZDcwMCIsZ29sZGVucm9kOiIjZGFhNTIwIixncmF5OiIjODA4MDgwIixncmVlbjoiIzAwODAwMCIsZ3JlZW55ZWxsb3c6IiNhZGZmMmYiLGhvbmV5ZGV3OiIjZjBmZmYwIixob3RwaW5rOiIjZmY2OWI0IiwiaW5kaWFucmVkICI6IiNjZDVjNWMiLGluZGlnbzoiIzRiMDA4MiIsaXZvcnk6IiNmZmZmZjAiLGtoYWtpOiIjZjBlNjhjIixsYXZlbmRlcjoiI2U2ZTZmYSIsbGF2ZW5kZXJibHVzaDoiI2ZmZjBmNSIsbGF3bmdyZWVuOiIjN2NmYzAwIixsZW1vbmNoaWZmb246IiNmZmZhY2QiLGxpZ2h0Ymx1ZToiI2FkZDhlNiIsbGlnaHRjb3JhbDoiI2YwODA4MCIsbGlnaHRjeWFuOiIjZTBmZmZmIixsaWdodGdvbGRlbnJvZHllbGxvdzoiI2ZhZmFkMiIsbGlnaHRncmV5OiIjZDNkM2QzIixsaWdodGdyZWVuOiIjOTBlZTkwIixsaWdodHBpbms6IiNmZmI2YzEiLGxpZ2h0c2FsbW9uOiIjZmZhMDdhIixsaWdodHNlYWdyZWVuOiIjMjBiMmFhIixsaWdodHNreWJsdWU6IiM4N2NlZmEiLGxpZ2h0c2xhdGVncmF5OiIjNzc4ODk5IixsaWdodHN0ZWVsYmx1ZToiI2IwYzRkZSIsbGlnaHR5ZWxsb3c6IiNmZmZmZTAiLGxpbWU6IiMwMGZmMDAiLGxpbWVncmVlbjoiIzMyY2QzMiIsbGluZW46IiNmYWYwZTYiLG1hZ2VudGE6IiNmZjAwZmYiLG1hcm9vbjoiIzgwMDAwMCIsbWVkaXVtYXF1YW1hcmluZToiIzY2Y2RhYSIsbWVkaXVtYmx1ZToiIzAwMDBjZCIsbWVkaXVtb3JjaGlkOiIjYmE1NWQzIixtZWRpdW1wdXJwbGU6IiM5MzcwZDgiLG1lZGl1bXNlYWdyZWVuOiIjM2NiMzcxIixtZWRpdW1zbGF0ZWJsdWU6IiM3YjY4ZWUiLG1lZGl1bXNwcmluZ2dyZWVuOiIjMDBmYTlhIixtZWRpdW10dXJxdW9pc2U6IiM0OGQxY2MiLG1lZGl1bXZpb2xldHJlZDoiI2M3MTU4NSIsbWlkbmlnaHRibHVlOiIjMTkxOTcwIixtaW50Y3JlYW06IiNmNWZmZmEiLG1pc3R5cm9zZToiI2ZmZTRlMSIsbW9jY2FzaW46IiNmZmU0YjUiLG5hdmFqb3doaXRlOiIjZmZkZWFkIixuYXZ5OiIjMDAwMDgwIixvbGRsYWNlOiIjZmRmNWU2IixvbGl2ZToiIzgwODAwMCIsb2xpdmVkcmFiOiIjNmI4ZTIzIixvcmFuZ2U6IiNmZmE1MDAiLG9yYW5nZXJlZDoiI2ZmNDUwMCIsb3JjaGlkOiIjZGE3MGQ2IixwYWxlZ29sZGVucm9kOiIjZWVlOGFhIixwYWxlZ3JlZW46IiM5OGZiOTgiLHBhbGV0dXJxdW9pc2U6IiNhZmVlZWUiLHBhbGV2aW9sZXRyZWQ6IiNkODcwOTMiLHBhcGF5YXdoaXA6IiNmZmVmZDUiLHBlYWNocHVmZjoiI2ZmZGFiOSIscGVydToiI2NkODUzZiIscGluazoiI2ZmYzBjYiIscGx1bToiI2RkYTBkZCIscG93ZGVyYmx1ZToiI2IwZTBlNiIscHVycGxlOiIjODAwMDgwIixyZWJlY2NhcHVycGxlOiIjNjYzMzk5IixyZWQ6IiNmZjAwMDAiLHJvc3licm93bjoiI2JjOGY4ZiIscm95YWxibHVlOiIjNDE2OWUxIixzYWRkbGVicm93bjoiIzhiNDUxMyIsc2FsbW9uOiIjZmE4MDcyIixzYW5keWJyb3duOiIjZjRhNDYwIixzZWFncmVlbjoiIzJlOGI1NyIsc2Vhc2hlbGw6IiNmZmY1ZWUiLHNpZW5uYToiI2EwNTIyZCIsc2lsdmVyOiIjYzBjMGMwIixza3libHVlOiIjODdjZWViIixzbGF0ZWJsdWU6IiM2YTVhY2QiLHNsYXRlZ3JheToiIzcwODA5MCIsc25vdzoiI2ZmZmFmYSIsc3ByaW5nZ3JlZW46IiMwMGZmN2YiLHN0ZWVsYmx1ZToiIzQ2ODJiNCIsdGFuOiIjZDJiNDhjIix0ZWFsOiIjMDA4MDgwIix0aGlzdGxlOiIjZDhiZmQ4Iix0b21hdG86IiNmZjYzNDciLHR1cnF1b2lzZToiIzQwZTBkMCIsdmlvbGV0OiIjZWU4MmVlIix3aGVhdDoiI2Y1ZGViMyIsd2hpdGU6IiNmZmZmZmYiLHdoaXRlc21va2U6IiNmNWY1ZjUiLHllbGxvdzoiI2ZmZmYwMCIseWVsbG93Z3JlZW46IiM5YWNkMzIifTtyZXR1cm4gdm9pZCAwIT09ZVt0LnRvTG93ZXJDYXNlKCldJiZlW3QudG9Mb3dlckNhc2UoKV19KSh0KSl9dG9IZXgoKXtmdW5jdGlvbiB0KHQpe2NvbnN0IGU9TWF0aC5yb3VuZCgyNTUqdCkudG9TdHJpbmcoMTYpO3JldHVybiAxPT1lLmxlbmd0aD8iMCIrZTplfXJldHVybiIjIit0KHRoaXMucikrdCh0aGlzLmcpK3QodGhpcy5iKX1lcXVhbCh0KXtyZXR1cm4gdGhpcy5yPT10LnImJnRoaXMuZz09dC5nJiZ0aGlzLmI9PXQuYiYmdGhpcy5hPT10LmF9bm90ZXF1YWxzKHQpe3JldHVybiB0aGlzLnIhPXQuciYmdGhpcy5nIT10LmcmJnRoaXMuYiE9dC5iJiZ0aGlzLmEhPXQuYX1hcHByb3hFcXVhbCh0LGU9TnVtYmVyLkVQU0lMT04pe3JldHVybiBNYXRoLmFicyh0aGlzLnItdC5yKTxlJiZNYXRoLmFicyh0aGlzLmctdC5nKTxlJiZNYXRoLmFicyh0aGlzLmItdC5iKTxlJiZNYXRoLmFicyh0aGlzLmEtdC5hKTxlfWFkZCh0KXtyZXR1cm4gbmV3IG8odGhpcy5yK3Qucix0aGlzLmcrdC5nLHRoaXMuYit0LmIsdGhpcy5hK3QuYSl9c3VidHJhY3QodCl7cmV0dXJuIG5ldyBvKHRoaXMuci10LnIsdGhpcy5nLXQuZyx0aGlzLmItdC5iLHRoaXMuYS10LmEpfXNjYWxlKHQpe3JldHVybiBuZXcgbyh0aGlzLnIqdCx0aGlzLmcqdCx0aGlzLmIqdCx0aGlzLmEqdCl9c2NhbGVJblBsYWNlKHQpe3RoaXMucio9dCx0aGlzLmcqPXQsdGhpcy5iKj10LHRoaXMuYSo9dH1hcHBseUdhbW1hKHQpe3RoaXMuc2V0KE1hdGgucG93KHRoaXMucix0KSxNYXRoLnBvdyh0aGlzLmcsdCksTWF0aC5wb3codGhpcy5iLHQpLHRoaXMuYSl9dG9MaW5lYXIodD0yLjIpe3JldHVybiBuZXcgbyhNYXRoLnBvdyh0aGlzLnIsdCksTWF0aC5wb3codGhpcy5nLHQpLE1hdGgucG93KHRoaXMuYix0KSx0aGlzLmEpfXRvR2FtbWEodD0yLjIpe3JldHVybiBuZXcgbyhNYXRoLnBvdyh0aGlzLnIsMS90KSxNYXRoLnBvdyh0aGlzLmcsMS90KSxNYXRoLnBvdyh0aGlzLmIsMS90KSx0aGlzLmEpfWx1bWluYW5jZSgpe3JldHVybi4yMTI2KnRoaXMucisuNzE1Mip0aGlzLmcrLjA3MjIqdGhpcy5ifWxlcnAodCxlKXtjb25zdCBzPXRoaXMucixhPXRoaXMuZyxpPXRoaXMuYixyPXRoaXMuYTtyZXR1cm4gbmV3IG8ocytlKih0LnItcyksYStlKih0LmctYSksaStlKih0LmItaSkscitlKih0LmEtcikpfXN0YXRpYyByYW5kb20odD0wLGU9ITEpe3JldHVybiB0PjA/bmV3IG8odCtNYXRoLnJhbmRvbSgpKigxLXQpLHQrTWF0aC5yYW5kb20oKSooMS10KSx0K01hdGgucmFuZG9tKCkqKDEtdCksZT90K01hdGgucmFuZG9tKCkqKDEtdCk6MSk6dDwwP25ldyBvKE1hdGgucmFuZG9tKCkqKDErdCksTWF0aC5yYW5kb20oKSooMSt0KSxNYXRoLnJhbmRvbSgpKigxK3QpLGU/TWF0aC5yYW5kb20oKSooMSt0KToxKTpuZXcgbyhNYXRoLnJhbmRvbSgpLE1hdGgucmFuZG9tKCksTWF0aC5yYW5kb20oKSxlP01hdGgucmFuZG9tKCk6MSl9Y2xvbmUoKXtyZXR1cm4gbmV3IG8odGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbM10pfWFzQXJyYXkoKXtyZXR1cm4gdGhpcy5fX2RhdGF9YXMzQ29tcG9uZW50QXJyYXkoKXtyZXR1cm5bdGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl1dfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBvKC4uLnQpfXN0YXRpYyBjcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0LGU9MCl7cmV0dXJuIG5ldyBvKHQsNCplKX1zdGF0aWMgbnVtRWxlbWVudHMoKXtyZXR1cm4gNH10b0pTT04oKXtyZXR1cm57cjp0aGlzLnIsZzp0aGlzLmcsYjp0aGlzLmIsYTp0aGlzLmF9fWZyb21KU09OKHQpe3RoaXMucj10LnIsdGhpcy5nPXQuZyx0aGlzLmI9dC5iLHRoaXMuYT10LmF9dG9DU1NTdHJpbmcoKXtyZXR1cm4icmdiYSgiK01hdGgucm91bmQoMjU1KnRoaXMucikrIiwgIitNYXRoLnJvdW5kKDI1NSp0aGlzLmcpKyIsICIrTWF0aC5yb3VuZCgyNTUqdGhpcy5iKSsiLCAiK3RoaXMuYSsiKSJ9fWEucmVnaXN0ZXJUeXBlKCJDb2xvciIsbyk7Y2xhc3MgXyBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0wLGU9MCxzPTAsYT0wKXtpZihzdXBlcigpLGlzTmFOKGEpKXN3aXRjaChhKXtjYXNlIlhZWiI6dGhpcy5vcmRlcj0wO2JyZWFrO2Nhc2UiWVpYIjp0aGlzLm9yZGVyPTE7YnJlYWs7Y2FzZSJaWFkiOnRoaXMub3JkZXI9MjticmVhaztjYXNlIlhaWSI6dGhpcy5vcmRlcj0zO2JyZWFrO2Nhc2UiWllYIjp0aGlzLm9yZGVyPTQ7YnJlYWs7Y2FzZSJZWFoiOnRoaXMub3JkZXI9NTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiSW52YWxpZCBFdWxlciBBbmdsZXMgT3JkZXI6IithKX1lbHNlIHRoaXMub3JkZXI9YTtpZih0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSB0aGlzLl9fZGF0YT1uZXcgRmxvYXQzMkFycmF5KDMpLHRoaXMuX19kYXRhWzBdPXQsdGhpcy5fX2RhdGFbMV09ZSx0aGlzLl9fZGF0YVsyXT1zfWdldCB4KCl7cmV0dXJuIHRoaXMuX19kYXRhWzBdfXNldCB4KHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IHkoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IHkodCl7dGhpcy5fX2RhdGFbMV09dH1nZXQgeigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgeih0KXt0aGlzLl9fZGF0YVsyXT10fXNldCh0LGUscyl7dGhpcy5fX2RhdGFbMF09dCx0aGlzLl9fZGF0YVsxXT1lLHRoaXMuX19kYXRhWzJdPXN9fWEucmVnaXN0ZXJUeXBlKCJFdWxlckFuZ2xlcyIsXyk7Y2xhc3MgZCBleHRlbmRzIHN7Y29uc3RydWN0b3IodD0xLGU9MCxzPTAsYT0wLGk9MSxyPTAsbj0wLGg9MCxvPTEpe2lmKHN1cGVyKCksdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXtjb25zdCBzPXQsYT1lO3RoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkocyxhLDkpfWVsc2UgdGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheSg5KSx0aGlzLnNldCh0LGUscyxhLGkscixuLGgsbyl9Z2V0IG0wMCgpe3JldHVybiB0aGlzLl9fZGF0YVswXX1zZXQgbTAwKHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IG0wMSgpe3JldHVybiB0aGlzLl9fZGF0YVsxXX1zZXQgbTAxKHQpe3RoaXMuX19kYXRhWzFdPXR9Z2V0IG0wMigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgbTAyKHQpe3RoaXMuX19kYXRhWzJdPXR9Z2V0IG0xMCgpe3JldHVybiB0aGlzLl9fZGF0YVszXX1zZXQgbTEwKHQpe3RoaXMuX19kYXRhWzNdPXR9Z2V0IG0xMSgpe3JldHVybiB0aGlzLl9fZGF0YVs0XX1zZXQgbTExKHQpe3RoaXMuX19kYXRhWzRdPXR9Z2V0IG0xMigpe3JldHVybiB0aGlzLl9fZGF0YVs1XX1zZXQgbTEyKHQpe3RoaXMuX19kYXRhWzVdPXR9Z2V0IG0yMCgpe3JldHVybiB0aGlzLl9fZGF0YVs2XX1zZXQgbTIwKHQpe3RoaXMuX19kYXRhWzZdPXR9Z2V0IG0yMSgpe3JldHVybiB0aGlzLl9fZGF0YVs3XX1zZXQgbTIxKHQpe3RoaXMuX19kYXRhWzddPXR9Z2V0IG0yMigpe3JldHVybiB0aGlzLl9fZGF0YVs4XX1zZXQgbTIyKHQpe3RoaXMuX19kYXRhWzhdPXR9Z2V0IHhBeGlzKCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLDApfXNldCB4QXhpcyh0KXt0aGlzLnhBeGlzLnNldCh0LngsdC55LHQueil9Z2V0IHlBeGlzKCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLDMpfXNldCB5QXhpcyh0KXt0aGlzLnlBeGlzLnNldCh0LngsdC55LHQueil9Z2V0IHpBeGlzKCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLDYpfXNldCB6QXhpcyh0KXt0aGlzLnpBeGlzLnNldCh0LngsdC55LHQueil9c2V0KHQ9MSxlPTAscz0wLGE9MCxpPTEscj0wLG49MCxoPTAsbz0xKXt0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hLHRoaXMuX19kYXRhWzRdPWksdGhpcy5fX2RhdGFbNV09cix0aGlzLl9fZGF0YVs2XT1uLHRoaXMuX19kYXRhWzddPWgsdGhpcy5fX2RhdGFbOF09b31zZXRJZGVudGl0eSgpe3RoaXMuc2V0KCl9c2V0RnJvbU1hdCh0KXt0aGlzLl9fZGF0YVswXT10Lm0wMCx0aGlzLl9fZGF0YVsxXT10Lm0wMSx0aGlzLl9fZGF0YVsyXT10Lm0wMix0aGlzLl9fZGF0YVszXT10Lm0xMCx0aGlzLl9fZGF0YVs0XT10Lm0xMSx0aGlzLl9fZGF0YVs1XT10Lm0xMix0aGlzLl9fZGF0YVs2XT10Lm0yMCx0aGlzLl9fZGF0YVs3XT10Lm0yMSx0aGlzLl9fZGF0YVs4XT10Lm0yMn1zZXRGcm9tRGlyZWN0aW9uQW5kVXB2ZWN0b3IodCxlKXtjb25zdCBzPXQsYT1zLmxlbmd0aCgpO2lmKGE8TnVtYmVyLkVQU0lMT04pcmV0dXJuIHZvaWQgdGhpcy5zZXRJZGVudGl0eSgpO3Muc2NhbGVJblBsYWNlKDEvYSk7Y29uc3QgaT1lLmNyb3NzKHMpLHI9aS5sZW5ndGgoKTtyPk51bWJlci5FUFNJTE9OJiZpLnNjYWxlSW5QbGFjZSgxL3IpO2NvbnN0IG49cy5jcm9zcyhpKSxoPW4ubGVuZ3RoKCk7aD5OdW1iZXIuRVBTSUxPTiYmbi5zY2FsZUluUGxhY2UoMS9oKSx0aGlzLnNldChpLngsaS55LGkueixuLngsbi55LG4ueixzLngscy55LHMueil9aW52ZXJzZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM10saT10aGlzLl9fZGF0YVs0XSxyPXRoaXMuX19kYXRhWzVdLG49dGhpcy5fX2RhdGFbNl0saD10aGlzLl9fZGF0YVs3XSxvPXRoaXMuX19kYXRhWzhdLF89byppLXIqaCxsPS1vKmErcipuLGM9aCphLWkqbix1PXQqXytlKmwrcypjO3JldHVybiB1Pyh1PTEvdSxuZXcgZChfKnUsKC1vKmUrcypoKSp1LChyKmUtcyppKSp1LGwqdSwobyp0LXMqbikqdSwoLXIqdCtzKmEpKnUsYyp1LCgtaCp0K2UqbikqdSwoaSp0LWUqYSkqdSkpOihjb25zb2xlLndhcm4oIlVuYWJsZSB0byBpbnZlcnQgTWF0MyIpLG51bGwpfWludmVydEluUGxhY2UoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdLGk9dGhpcy5fX2RhdGFbNF0scj10aGlzLl9fZGF0YVs1XSxuPXRoaXMuX19kYXRhWzZdLGg9dGhpcy5fX2RhdGFbN10sbz10aGlzLl9fZGF0YVs4XSxfPW8qaS1yKmgsZD0tbyphK3IqbixsPWgqYS1pKm4sYz10Kl8rZSpkK3MqbDtyZXR1cm4gYz8oYz0xL2MsdGhpcy5zZXQoXypjLCgtbyplK3MqaCkqYywociplLXMqaSkqYyxkKmMsKG8qdC1zKm4pKmMsKC1yKnQrcyphKSpjLGwqYywoLWgqdCtlKm4pKmMsKGkqdC1lKmEpKmMpLCEwKTooY29uc29sZS53YXJuKCJVbmFibGUgdG8gaW52ZXJ0IE1hdDMiKSwhMSl9dHJhbnNwb3NlKCl7cmV0dXJuIGQodGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbM10sdGhpcy5fX2RhdGFbNl0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbNF0sdGhpcy5fX2RhdGFbN10sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbNV0sdGhpcy5fX2RhdGFbOF0pfXRyYW5zcG9zZUluUGxhY2UoKXtjb25zdCB0PXRoaXMuX19kYXRhWzFdLGU9dGhpcy5fX2RhdGFbMl0scz10aGlzLl9fZGF0YVs1XTt0aGlzLl9fZGF0YVsxXT10aGlzLl9fZGF0YVszXSx0aGlzLl9fZGF0YVsyXT10aGlzLl9fZGF0YVs2XSx0aGlzLl9fZGF0YVszXT10LHRoaXMuX19kYXRhWzVdPXRoaXMuX19kYXRhWzddLHRoaXMuX19kYXRhWzZdPWUsdGhpcy5fX2RhdGFbN109c310cmFuc2Zvcm1WZWMzKHQpe3JldHVybiBuZXcgcih0aGlzLl9fZGF0YVswXSp0LngrdGhpcy5fX2RhdGFbMV0qdC55K3RoaXMuX19kYXRhWzJdKnQueix0aGlzLl9fZGF0YVszXSp0LngrdGhpcy5fX2RhdGFbNF0qdC55K3RoaXMuX19kYXRhWzVdKnQueix0aGlzLl9fZGF0YVs2XSp0LngrdGhpcy5fX2RhdGFbN10qdC55K3RoaXMuX19kYXRhWzhdKnQueil9Y2xvbmUoKXtyZXR1cm4gbmV3IGQodGhpcy5fX2RhdGFbMF0sdGhpcy5fX2RhdGFbMV0sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbM10sdGhpcy5fX2RhdGFbNF0sdGhpcy5fX2RhdGFbNV0sdGhpcy5fX2RhdGFbNl0sdGhpcy5fX2RhdGFbN10sdGhpcy5fX2RhdGFbOF0sdGhpcy5fX2RhdGFbOV0pfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBkKC4uLnQpfXN0YXRpYyBjcmVhdGVGcm9tRmxvYXQzMkJ1ZmZlcih0LGU9MCl7cmV0dXJuIG5ldyBkKHQsNCplKX10b0pTT04oKXtyZXR1cm4gdGhpcy5fX2RhdGF9ZnJvbUpTT04odCl7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheSh0KX10b1N0cmluZygpe3JldHVybiB0aGlzLnRvSlNPTigpLnRvU3RyaW5nKCl9fWEucmVnaXN0ZXJUeXBlKCJNYXQzIixkKTtjbGFzcyBsIGV4dGVuZHMgc3tjb25zdHJ1Y3Rvcih0PTEsZT0wLHM9MCxhPTAsaT0wLHI9MSxuPTAsaD0wLG89MCxfPTAsZD0xLGw9MCxjPTAsdT0wLGY9MCxtPTEpe2lmKHN1cGVyKCksdCBpbnN0YW5jZW9mIEZsb2F0MzJBcnJheSl0aGlzLl9fZGF0YT10O2Vsc2UgaWYodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKXtjb25zdCBzPXQsYT1lO3RoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkocyxhLDE2KX1lbHNlIHRoaXMuX19kYXRhPW5ldyBGbG9hdDMyQXJyYXkoMTYpLHRoaXMuc2V0KHQsZSxzLGEsaSxyLG4saCxvLF8sZCxsLGMsdSxmLG0pfWdldCBtMDAoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMF19c2V0IG0wMCh0KXt0aGlzLl9fZGF0YVswXT10fWdldCBtMDEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IG0wMSh0KXt0aGlzLl9fZGF0YVsxXT10fWdldCBtMDIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMl19c2V0IG0wMih0KXt0aGlzLl9fZGF0YVsyXT10fWdldCBtMDMoKXtyZXR1cm4gdGhpcy5fX2RhdGFbM119c2V0IG0wMyh0KXt0aGlzLl9fZGF0YVszXT10fWdldCBtMTAoKXtyZXR1cm4gdGhpcy5fX2RhdGFbNF19c2V0IG0xMCh0KXt0aGlzLl9fZGF0YVs0XT10fWdldCBtMTEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbNV19c2V0IG0xMSh0KXt0aGlzLl9fZGF0YVs1XT10fWdldCBtMTIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbNl19c2V0IG0xMih0KXt0aGlzLl9fZGF0YVs2XT10fWdldCBtMTMoKXtyZXR1cm4gdGhpcy5fX2RhdGFbN119c2V0IG0xMyh0KXt0aGlzLl9fZGF0YVs3XT10fWdldCBtMjAoKXtyZXR1cm4gdGhpcy5fX2RhdGFbOF19c2V0IG0yMCh0KXt0aGlzLl9fZGF0YVs4XT10fWdldCBtMjEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbOV19c2V0IG0yMSh0KXt0aGlzLl9fZGF0YVs5XT10fWdldCBtMjIoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMTBdfXNldCBtMjIodCl7dGhpcy5fX2RhdGFbMTBdPXR9Z2V0IG0yMygpe3JldHVybiB0aGlzLl9fZGF0YVsxMV19c2V0IG0yMyh0KXt0aGlzLl9fZGF0YVsxMV09dH1nZXQgbTMwKCl7cmV0dXJuIHRoaXMuX19kYXRhWzEyXX1zZXQgbTMwKHQpe3RoaXMuX19kYXRhWzEyXT10fWdldCBtMzEoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMTNdfXNldCBtMzEodCl7dGhpcy5fX2RhdGFbMTNdPXR9Z2V0IG0zMigpe3JldHVybiB0aGlzLl9fZGF0YVsxNF19c2V0IG0zMih0KXt0aGlzLl9fZGF0YVsxNF09dH1nZXQgbTMzKCl7cmV0dXJuIHRoaXMuX19kYXRhWzE1XX1zZXQgbTMzKHQpe3RoaXMuX19kYXRhWzE1XT10fWdldCB4QXhpcygpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciwwKX1zZXQgeEF4aXModCl7dGhpcy54QXhpcy5zZXQodC54LHQueSx0LnopfWdldCB5QXhpcygpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciw0KX1zZXQgeUF4aXModCl7dGhpcy55QXhpcy5zZXQodC54LHQueSx0LnopfWdldCB6QXhpcygpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciw4KX1zZXQgekF4aXModCl7dGhpcy56QXhpcy5zZXQodC54LHQueSx0LnopfWdldCB0cmFuc2xhdGlvbigpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlciwxMil9c2V0IHRyYW5zbGF0aW9uKHQpe3RoaXMudHJhbnNsYXRpb24uc2V0KHQueCx0LnksdC56KX1zZXQodD0xLGU9MCxzPTAsYT0wLGk9MCxyPTEsbj0wLGg9MCxvPTAsXz0wLGQ9MSxsPTAsYz0wLHU9MCxmPTAsbT0xKXt0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hLHRoaXMuX19kYXRhWzRdPWksdGhpcy5fX2RhdGFbNV09cix0aGlzLl9fZGF0YVs2XT1uLHRoaXMuX19kYXRhWzddPWgsdGhpcy5fX2RhdGFbOF09byx0aGlzLl9fZGF0YVs5XT1fLHRoaXMuX19kYXRhWzEwXT1kLHRoaXMuX19kYXRhWzExXT1sLHRoaXMuX19kYXRhWzEyXT1jLHRoaXMuX19kYXRhWzEzXT11LHRoaXMuX19kYXRhWzE0XT1mLHRoaXMuX19kYXRhWzE1XT1tfXNldElkZW50aXR5KCl7dGhpcy5zZXQoKX1zZXREYXRhQXJyYXkodCl7dGhpcy5fX2RhdGE9dH1zZXRGcm9tTWF0NCh0KXt0aGlzLl9fZGF0YVswXT10Lm0wMCx0aGlzLl9fZGF0YVsxXT10Lm0wMSx0aGlzLl9fZGF0YVsyXT10Lm0wMix0aGlzLl9fZGF0YVszXT10Lm0wMyx0aGlzLl9fZGF0YVs0XT10Lm0xMCx0aGlzLl9fZGF0YVs1XT10Lm0xMSx0aGlzLl9fZGF0YVs2XT10Lm0xMix0aGlzLl9fZGF0YVs3XT10Lm0xMyx0aGlzLl9fZGF0YVs4XT10Lm0yMCx0aGlzLl9fZGF0YVs5XT10Lm0yMSx0aGlzLl9fZGF0YVsxMF09dC5tMjIsdGhpcy5fX2RhdGFbMTFdPXQubTIzLHRoaXMuX19kYXRhWzEyXT10Lm0zMCx0aGlzLl9fZGF0YVsxM109dC5tMzEsdGhpcy5fX2RhdGFbMTRdPXQubTMyLHRoaXMuX19kYXRhWzE1XT10Lm0zM310b01hdDModCl7cmV0dXJuIG5ldyBkKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzRdLHRoaXMuX19kYXRhWzVdLHRoaXMuX19kYXRhWzZdLHRoaXMuX19kYXRhWzhdLHRoaXMuX19kYXRhWzldLHRoaXMuX19kYXRhWzEwXSl9dHJhbnNwb3NlSW5QbGFjZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMV0sZT10aGlzLl9fZGF0YVsyXSxzPXRoaXMuX19kYXRhWzNdLGE9dGhpcy5fX2RhdGFbNl0saT10aGlzLl9fZGF0YVs3XSxyPXRoaXMuX19kYXRhWzExXTt0aGlzLl9fZGF0YVsxXT10aGlzLl9fZGF0YVs0XSx0aGlzLl9fZGF0YVsyXT10aGlzLl9fZGF0YVs4XSx0aGlzLl9fZGF0YVszXT10aGlzLl9fZGF0YVsxMl0sdGhpcy5fX2RhdGFbNF09dCx0aGlzLl9fZGF0YVs2XT10aGlzLl9fZGF0YVs5XSx0aGlzLl9fZGF0YVs3XT10aGlzLl9fZGF0YVsxM10sdGhpcy5fX2RhdGFbOF09ZSx0aGlzLl9fZGF0YVs5XT1hLHRoaXMuX19kYXRhWzExXT10aGlzLl9fZGF0YVsxNF0sdGhpcy5fX2RhdGFbMTJdPXMsdGhpcy5fX2RhdGFbMTNdPWksdGhpcy5fX2RhdGFbMTRdPXJ9dHJhbnNwb3NlKCl7cmV0dXJuIG5ldyBsKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzRdLHRoaXMuX19kYXRhWzhdLHRoaXMuX19kYXRhWzEyXSx0aGlzLl9fZGF0YVsxXSx0aGlzLl9fZGF0YVs1XSx0aGlzLl9fZGF0YVs5XSx0aGlzLl9fZGF0YVsxM10sdGhpcy5fX2RhdGFbMl0sdGhpcy5fX2RhdGFbNl0sdGhpcy5fX2RhdGFbMTBdLHRoaXMuX19kYXRhWzE0XSx0aGlzLl9fZGF0YVszXSx0aGlzLl9fZGF0YVs3XSx0aGlzLl9fZGF0YVsxMV0sdGhpcy5fX2RhdGFbMTVdKX1pbnZlcnNlKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdLHM9dGhpcy5fX2RhdGFbMl0sYT10aGlzLl9fZGF0YVszXSxpPXRoaXMuX19kYXRhWzRdLHI9dGhpcy5fX2RhdGFbNV0sbj10aGlzLl9fZGF0YVs2XSxoPXRoaXMuX19kYXRhWzddLG89dGhpcy5fX2RhdGFbOF0sXz10aGlzLl9fZGF0YVs5XSxkPXRoaXMuX19kYXRhWzEwXSxjPXRoaXMuX19kYXRhWzExXSx1PXRoaXMuX19kYXRhWzEyXSxmPXRoaXMuX19kYXRhWzEzXSxtPXRoaXMuX19kYXRhWzE0XSxnPXRoaXMuX19kYXRhWzE1XSx5PXQqci1lKmkscD10Km4tcyppLGI9dCpoLWEqaSx4PWUqbi1zKnIsdz1lKmgtYSpyLEk9cypoLWEqbixOPW8qZi1fKnUsRj1vKm0tZCp1LHo9bypnLWMqdSxWPV8qbS1kKmYsTT1fKmctYypmLEE9ZCpnLWMqbTtsZXQgUz15KkEtcCpNK2IqVit4KnotdypGK0kqTjtyZXR1cm4gUz8oUz0xL1MsbmV3IGwoKHIqQS1uKk0raCpWKSpTLChzKk0tZSpBLWEqVikqUywoZipJLW0qdytnKngpKlMsKGQqdy1fKkktYyp4KSpTLChuKnotaSpBLWgqRikqUywodCpBLXMqeithKkYpKlMsKG0qYi11KkktZypwKSpTLChvKkktZCpiK2MqcCkqUywoaSpNLXIqeitoKk4pKlMsKGUqei10Kk0tYSpOKSpTLCh1KnctZipiK2cqeSkqUywoXypiLW8qdy1jKnkpKlMsKHIqRi1pKlYtbipOKSpTLCh0KlYtZSpGK3MqTikqUywoZipwLXUqeC1tKnkpKlMsKG8qeC1fKnArZCp5KSpTKSk6KGNvbnNvbGUud2FybigiVW5hYmxlIHRvIGludmVydCBNYXQ0IiksbnVsbCl9aW52ZXJ0SW5QbGFjZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM10saT10aGlzLl9fZGF0YVs0XSxyPXRoaXMuX19kYXRhWzVdLG49dGhpcy5fX2RhdGFbNl0saD10aGlzLl9fZGF0YVs3XSxvPXRoaXMuX19kYXRhWzhdLF89dGhpcy5fX2RhdGFbOV0sZD10aGlzLl9fZGF0YVsxMF0sbD10aGlzLl9fZGF0YVsxMV0sYz10aGlzLl9fZGF0YVsxMl0sdT10aGlzLl9fZGF0YVsxM10sZj10aGlzLl9fZGF0YVsxNF0sbT10aGlzLl9fZGF0YVsxNV0sZz10KnItZSppLHk9dCpuLXMqaSxwPXQqaC1hKmksYj1lKm4tcypyLHg9ZSpoLWEqcix3PXMqaC1hKm4sST1vKnUtXypjLE49bypmLWQqYyxGPW8qbS1sKmMsej1fKmYtZCp1LFY9XyptLWwqdSxNPWQqbS1sKmY7bGV0IEE9ZypNLXkqVitwKnorYipGLXgqTit3Kkk7cmV0dXJuIEE/KEE9MS9BLHRoaXMuc2V0KChyKk0tbipWK2gqeikqQSwocypWLWUqTS1hKnopKkEsKHUqdy1mKngrbSpiKSpBLChkKngtXyp3LWwqYikqQSwobipGLWkqTS1oKk4pKkEsKHQqTS1zKkYrYSpOKSpBLChmKnAtYyp3LW0qeSkqQSwobyp3LWQqcCtsKnkpKkEsKGkqVi1yKkYraCpJKSpBLChlKkYtdCpWLWEqSSkqQSwoYyp4LXUqcCttKmcpKkEsKF8qcC1vKngtbCpnKSpBLChyKk4taSp6LW4qSSkqQSwodCp6LWUqTitzKkkpKkEsKHUqeS1jKmItZipnKSpBLChvKmItXyp5K2QqZykqQSksITApOihjb25zb2xlLndhcm4oIlVuYWJsZSB0byBpbnZlcnQgTWF0NCIpLCExKX1zZXRJbnZlcnNlKHQpe2NvbnN0IGU9dC5fX2RhdGFbMF0scz10Ll9fZGF0YVsxXSxhPXQuX19kYXRhWzJdLGk9dC5fX2RhdGFbM10scj10Ll9fZGF0YVs0XSxuPXQuX19kYXRhWzVdLGg9dC5fX2RhdGFbNl0sbz10Ll9fZGF0YVs3XSxfPXQuX19kYXRhWzhdLGQ9dC5fX2RhdGFbOV0sbD10Ll9fZGF0YVsxMF0sYz10Ll9fZGF0YVsxMV0sdT10Ll9fZGF0YVsxMl0sZj10Ll9fZGF0YVsxM10sbT10Ll9fZGF0YVsxNF0sZz10Ll9fZGF0YVsxNV0seT1lKm4tcypyLHA9ZSpoLWEqcixiPWUqby1pKnIseD1zKmgtYSpuLHc9cypvLWkqbixJPWEqby1pKmgsTj1fKmYtZCp1LEY9XyptLWwqdSx6PV8qZy1jKnUsVj1kKm0tbCpmLE09ZCpnLWMqZixBPWwqZy1jKm07bGV0IFM9eSpBLXAqTStiKlYreCp6LXcqRitJKk47aWYoIVMpdGhyb3cgbmV3IEVycm9yKCJVbmFibGUgdG8gaW52ZXJ0IE1hdDQiKTtTPTEvUyx0aGlzLnNldCgobipBLWgqTStvKlYpKlMsKGEqTS1zKkEtaSpWKSpTLChmKkktbSp3K2cqeCkqUywobCp3LWQqSS1jKngpKlMsKGgqei1yKkEtbypGKSpTLChlKkEtYSp6K2kqRikqUywobSpiLXUqSS1nKnApKlMsKF8qSS1sKmIrYypwKSpTLChyKk0tbip6K28qTikqUywocyp6LWUqTS1pKk4pKlMsKHUqdy1mKmIrZyp5KSpTLChkKmItXyp3LWMqeSkqUywobipGLXIqVi1oKk4pKlMsKGUqVi1zKkYrYSpOKSpTLChmKnAtdSp4LW0qeSkqUywoXyp4LWQqcCtsKnkpKlMpfW11bHRpcGx5KHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0scz10aGlzLl9fZGF0YVsxXSxhPXRoaXMuX19kYXRhWzJdLGk9dGhpcy5fX2RhdGFbM10scj10aGlzLl9fZGF0YVs0XSxuPXRoaXMuX19kYXRhWzVdLGg9dGhpcy5fX2RhdGFbNl0sbz10aGlzLl9fZGF0YVs3XSxfPXRoaXMuX19kYXRhWzhdLGQ9dGhpcy5fX2RhdGFbOV0sYz10aGlzLl9fZGF0YVsxMF0sdT10aGlzLl9fZGF0YVsxMV0sZj10aGlzLl9fZGF0YVsxMl0sbT10aGlzLl9fZGF0YVsxM10sZz10aGlzLl9fZGF0YVsxNF0seT10aGlzLl9fZGF0YVsxNV0scD10LmFzQXJyYXkoKTtsZXQgYj1wWzBdLHg9cFsxXSx3PXBbMl0sST1wWzNdO2NvbnN0IE49bmV3IGw7cmV0dXJuIE4ubTAwPWIqZSt4KnIrdypfK0kqZixOLm0wMT1iKnMreCpuK3cqZCtJKm0sTi5tMDI9YiphK3gqaCt3KmMrSSpnLE4ubTAzPWIqaSt4Km8rdyp1K0kqeSxiPXBbNF0seD1wWzVdLHc9cFs2XSxJPXBbN10sTi5tMTA9YiplK3gqcit3Kl8rSSpmLE4ubTExPWIqcyt4Km4rdypkK0kqbSxOLm0xMj1iKmEreCpoK3cqYytJKmcsTi5tMTM9YippK3gqbyt3KnUrSSp5LGI9cFs4XSx4PXBbOV0sdz1wWzEwXSxJPXBbMTFdLE4ubTIwPWIqZSt4KnIrdypfK0kqZixOLm0yMT1iKnMreCpuK3cqZCtJKm0sTi5tMjI9YiphK3gqaCt3KmMrSSpnLE4ubTIzPWIqaSt4Km8rdyp1K0kqeSxiPXBbMTJdLHg9cFsxM10sdz1wWzE0XSxJPXBbMTVdLE4ubTMwPWIqZSt4KnIrdypfK0kqZixOLm0zMT1iKnMreCpuK3cqZCtJKm0sTi5tMzI9YiphK3gqaCt3KmMrSSpnLE4ubTMzPWIqaSt4Km8rdyp1K0kqeSxOfW11bHRpcGx5SW5QbGFjZSh0KXtjb25zdCBlPXRoaXMuYXNBcnJheSgpLHM9ZVswXSxhPWVbMV0saT1lWzJdLHI9ZVszXSxuPWVbNF0saD1lWzVdLG89ZVs2XSxfPWVbN10sZD1lWzhdLGw9ZVs5XSxjPWVbMTBdLHU9ZVsxMV0sZj1lWzEyXSxtPWVbMTNdLGc9ZVsxNF0seT1lWzE1XSxwPXQuYXNBcnJheSgpO2xldCBiPXBbMF0seD1wWzFdLHc9cFsyXSxJPXBbM107cmV0dXJuIHRoaXMubTAwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0wMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMDI9YippK3gqbyt3KmMrSSpnLHRoaXMubTAzPWIqcit4Kl8rdyp1K0kqeSxiPXBbNF0seD1wWzVdLHc9cFs2XSxJPXBbN10sdGhpcy5tMTA9YipzK3gqbit3KmQrSSpmLHRoaXMubTExPWIqYSt4KmgrdypsK0kqbSx0aGlzLm0xMj1iKmkreCpvK3cqYytJKmcsdGhpcy5tMTM9YipyK3gqXyt3KnUrSSp5LGI9cFs4XSx4PXBbOV0sdz1wWzEwXSxJPXBbMTFdLHRoaXMubTIwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0yMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMjI9YippK3gqbyt3KmMrSSpnLHRoaXMubTIzPWIqcit4Kl8rdyp1K0kqeSxiPXBbMTJdLHg9cFsxM10sdz1wWzE0XSxJPXBbMTVdLHRoaXMubTMwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0zMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMzI9YippK3gqbyt3KmMrSSpnLHRoaXMubTMzPWIqcit4Kl8rdyp1K0kqeSx0aGlzfXBvc3RtdWx0aXBseUluUGxhY2UodCl7Y29uc3QgZT10LmFzQXJyYXkoKSxzPWVbMF0sYT1lWzFdLGk9ZVsyXSxyPWVbM10sbj1lWzRdLGg9ZVs1XSxvPWVbNl0sXz1lWzddLGQ9ZVs4XSxsPWVbOV0sYz1lWzEwXSx1PWVbMTFdLGY9ZVsxMl0sbT1lWzEzXSxnPWVbMTRdLHk9ZVsxNV0scD10aGlzLmFzQXJyYXkoKTtsZXQgYj1wWzBdLHg9cFsxXSx3PXBbMl0sST1wWzNdO3JldHVybiB0aGlzLm0wMD1iKnMreCpuK3cqZCtJKmYsdGhpcy5tMDE9YiphK3gqaCt3KmwrSSptLHRoaXMubTAyPWIqaSt4Km8rdypjK0kqZyx0aGlzLm0wMz1iKnIreCpfK3cqdStJKnksYj1wWzRdLHg9cFs1XSx3PXBbNl0sST1wWzddLHRoaXMubTEwPWIqcyt4Km4rdypkK0kqZix0aGlzLm0xMT1iKmEreCpoK3cqbCtJKm0sdGhpcy5tMTI9YippK3gqbyt3KmMrSSpnLHRoaXMubTEzPWIqcit4Kl8rdyp1K0kqeSxiPXBbOF0seD1wWzldLHc9cFsxMF0sST1wWzExXSx0aGlzLm0yMD1iKnMreCpuK3cqZCtJKmYsdGhpcy5tMjE9YiphK3gqaCt3KmwrSSptLHRoaXMubTIyPWIqaSt4Km8rdypjK0kqZyx0aGlzLm0yMz1iKnIreCpfK3cqdStJKnksYj1wWzEyXSx4PXBbMTNdLHc9cFsxNF0sST1wWzE1XSx0aGlzLm0zMD1iKnMreCpuK3cqZCtJKmYsdGhpcy5tMzE9YiphK3gqaCt3KmwrSSptLHRoaXMubTMyPWIqaSt4Km8rdypjK0kqZyx0aGlzLm0zMz1iKnIreCpfK3cqdStJKnksdGhpc310cmFuc2xhdGVJblBsYWNlKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGEscz10LngsYT10LnksaT10Lno7cmV0dXJuIGVbMTJdPWVbMF0qcytlWzRdKmErZVs4XSppK2VbMTJdLGVbMTNdPWVbMV0qcytlWzVdKmErZVs5XSppK2VbMTNdLGVbMTRdPWVbMl0qcytlWzZdKmErZVsxMF0qaStlWzE0XSxlWzE1XT1lWzNdKnMrZVs3XSphK2VbMTFdKmkrZVsxNV0sdGhpc31zZXRMb29rQXQodCxlLHMpe2NvbnN0IGE9dC5zdWJ0cmFjdChlKSxpPWEubGVuZ3RoKCk7aWYoaTxOdW1iZXIuRVBTSUxPTilyZXR1cm4gdm9pZCB0aGlzLnNldElkZW50aXR5KCk7YS5zY2FsZUluUGxhY2UoMS9pKTtjb25zdCByPXMuY3Jvc3MoYSksbj1yLmxlbmd0aCgpO24+TnVtYmVyLkVQU0lMT04mJnIuc2NhbGVJblBsYWNlKDEvbik7Y29uc3QgaD1hLmNyb3NzKHIpLG89aC5sZW5ndGgoKTtvPk51bWJlci5FUFNJTE9OJiZoLnNjYWxlSW5QbGFjZSgxL28pLHRoaXMuc2V0KHIueCxyLnksci56LDAsaC54LGgueSxoLnosMCxhLngsYS55LGEueiwwLHQueCx0LnksdC56LDEpfXNldFJvdGF0aW9uKHQsZSl7Y29uc3Qgcz10Lmxlbmd0aCgpO2lmKE1hdGguYWJzKHMpPE51bWJlci5FUFNJTE9OKXJldHVybiBudWxsO2NvbnN0IGE9dC54L3MsaT10LnkvcyxyPXQuei9zLG49TWF0aC5zaW4oZSksaD1NYXRoLmNvcyhlKSxvPTEtaCxfPXRoaXMuX19kYXRhO3JldHVybiBfWzBdPWEqYSpvK2gsX1sxXT1pKmEqbytyKm4sX1syXT1yKmEqby1pKm4sX1szXT0wLF9bNF09YSppKm8tcipuLF9bNV09aSppKm8raCxfWzZdPXIqaSpvK2EqbixfWzddPTAsX1s4XT1hKnIqbytpKm4sX1s5XT1pKnIqby1hKm4sX1sxMF09cipyKm8raCxfWzExXT0wLF9bMTJdPTAsX1sxM109MCxfWzE0XT0wLF9bMTVdPTEsdGhpc31zZXRYUm90YXRpb24odCl7Y29uc3QgZT1NYXRoLnNpbih0KSxzPU1hdGguY29zKHQpLGE9dGhpcy5fX2RhdGE7cmV0dXJuIGFbMF09MSxhWzFdPTAsYVsyXT0wLGFbM109MCxhWzRdPTAsYVs1XT1zLGFbNl09ZSxhWzddPTAsYVs4XT0wLGFbOV09LWUsYVsxMF09cyxhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsdGhpc31zZXRZUm90YXRpb24odCl7Y29uc3QgZT1NYXRoLnNpbih0KSxzPU1hdGguY29zKHQpLGE9dGhpcy5fX2RhdGE7cmV0dXJuIGFbMF09cyxhWzFdPTAsYVsyXT0tZSxhWzNdPTAsYVs0XT0wLGFbNV09MSxhWzZdPTAsYVs3XT0wLGFbOF09ZSxhWzldPTAsYVsxMF09cyxhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsdGhpc31zZXRaUm90YXRpb24odCl7Y29uc3QgZT1NYXRoLnNpbih0KSxzPU1hdGguY29zKHQpLGE9dGhpcy5fX2RhdGE7cmV0dXJuIGFbMF09cyxhWzFdPWUsYVsyXT0wLGFbM109MCxhWzRdPS1lLGFbNV09cyxhWzZdPTAsYVs3XT0wLGFbOF09MCxhWzldPTAsYVsxMF09MSxhWzExXT0wLGFbMTJdPTAsYVsxM109MCxhWzE0XT0wLGFbMTVdPTEsdGhpc310cmFuc2Zvcm1WZWM0KHQpe2NvbnN0IGU9dGhpcy5fX2RhdGEscz10LngsYT10LnksaT10Lnoscj10LnQ7cmV0dXJuIG5ldyBWZWM0KGVbMF0qcytlWzRdKmErZVs4XSppK2VbMTJdKnIsZVsxXSpzK2VbNV0qYStlWzldKmkrZVsxM10qcixlWzJdKnMrZVs2XSphK2VbMTBdKmkrZVsxNF0qcixlWzNdKnMrZVs3XSphK2VbMTFdKmkrZVsxNV0qcil9dHJhbnNmb3JtVmVjMyh0KXtjb25zdCBlPXRoaXMuX19kYXRhLHM9dC54LGE9dC55LGk9dC56O3JldHVybiBuZXcgcihlWzBdKnMrZVs0XSphK2VbOF0qaStlWzEyXSxlWzFdKnMrZVs1XSphK2VbOV0qaStlWzEzXSxlWzJdKnMrZVs2XSphK2VbMTBdKmkrZVsxNF0pfXJvdGF0ZVZlYzModCl7Y29uc3QgZT10aGlzLl9fZGF0YSxzPXQueCxhPXQueSxpPXQuejtyZXR1cm4gbmV3IHIoZVswXSpzK2VbNF0qYStlWzhdKmksZVsxXSpzK2VbNV0qYStlWzldKmksZVsyXSpzK2VbNl0qYStlWzEwXSppKX1zZXRQZXJzcGVjdGl2ZU1hdHJpeCh0LGUscyxhKXtjb25zdCBpPU1hdGgudGFuKC41Kk1hdGguUEktLjUqdCkscj0xLyhzLWEpO3RoaXMuc2V0KGkvZSwwLDAsMCwwLGksMCwwLDAsMCwocythKSpyLC0xLDAsMCxzKmEqcioyLDApfXNldE9ydGhvZ3JhcGhpY01hdHJpeCh0LGUscyxhLGkscil7Y29uc3Qgbj0xLyh0LWUpLGg9MS8ocy1hKSxvPTEvKGktcik7dGhpcy5zZXQoLTIqbiwwLDAsMCwwLC0yKmgsMCwwLDAsMCwyKm8sMCwodCtlKSpuLChhK3MpKmgsKHIraSkqbywxKX1zZXRTY2FsZSh0LGUscyl7dCBpbnN0YW5jZW9mIHI/dGhpcy5zZXQodC54LDAsMCwwLDAsdC55LDAsMCwwLDAsdC56LDAsMCwwLDAsMSk6dGhpcy5zZXQodCwwLDAsMCwwLGUsMCwwLDAsMCxzLDAsMCwwLDAsMSl9c2V0RnJvbU1hdDN4NEFycmF5KHQpe3RoaXMuc2V0KHRbMF0sdFsxXSx0WzJdLDAsdFszXSx0WzRdLHRbNV0sMCx0WzZdLHRbN10sdFs4XSwwLHRbOV0sdFsxMF0sdFsxMV0sMSl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IGwodCw0KmUpfWNsb25lKCl7cmV0dXJuIG5ldyBsKHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzNdLHRoaXMuX19kYXRhWzRdLHRoaXMuX19kYXRhWzVdLHRoaXMuX19kYXRhWzZdLHRoaXMuX19kYXRhWzddLHRoaXMuX19kYXRhWzhdLHRoaXMuX19kYXRhWzldLHRoaXMuX19kYXRhWzEwXSx0aGlzLl9fZGF0YVsxMV0sdGhpcy5fX2RhdGFbMTJdLHRoaXMuX19kYXRhWzEzXSx0aGlzLl9fZGF0YVsxNF0sdGhpcy5fX2RhdGFbMTVdKX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgbCguLi50KX10b0pTT04oKXtyZXR1cm4gdGhpcy5fX2RhdGF9ZnJvbUpTT04odCl7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheSh0KX19YS5yZWdpc3RlclR5cGUoIk1hdDQiLGwpO2NsYXNzIHUgZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQ9MCxlPTAscz0wLGE9MSl7aWYoc3VwZXIoKSx0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpe2NvbnN0IHM9dCxhPWU7dGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShzLGEsNCl9ZWxzZSBpZih0aGlzLl9fZGF0YT1uZXcgRmxvYXQzMkFycmF5KDQpLCJvYmplY3QiPT10eXBlb2YgdCl7dGhpcy5fX2RhdGFbMF09MCx0aGlzLl9fZGF0YVsxXT0wLHRoaXMuX19kYXRhWzJdPTAsdGhpcy5fX2RhdGFbM109MTtmb3IoY29uc3QgZSBpbiB0KUFycmF5LmlzQXJyYXkodFtlXSk/dGhpc1tlXS5jYWxsKHRoaXMsLi4udFtlXSk6dGhpc1tlXS5jYWxsKHRoaXMsdFtlXSl9ZWxzZSB0aGlzLl9fZGF0YVswXT10LHRoaXMuX19kYXRhWzFdPWUsdGhpcy5fX2RhdGFbMl09cyx0aGlzLl9fZGF0YVszXT1hfWdldCB4KCl7cmV0dXJuIHRoaXMuX19kYXRhWzBdfXNldCB4KHQpe3RoaXMuX19kYXRhWzBdPXR9Z2V0IHkoKXtyZXR1cm4gdGhpcy5fX2RhdGFbMV19c2V0IHkodCl7dGhpcy5fX2RhdGFbMV09dH1nZXQgeigpe3JldHVybiB0aGlzLl9fZGF0YVsyXX1zZXQgeih0KXt0aGlzLl9fZGF0YVsyXT10fWdldCB3KCl7cmV0dXJuIHRoaXMuX19kYXRhWzNdfXNldCB3KHQpe3RoaXMuX19kYXRhWzNdPXR9c2V0KHQsZSxzLGEpe3RoaXMuX19kYXRhWzBdPXQsdGhpcy5fX2RhdGFbMV09ZSx0aGlzLl9fZGF0YVsyXT1zLHRoaXMuX19kYXRhWzNdPWF9c2V0RGF0YUFycmF5KHQpe3RoaXMuX19kYXRhPXR9c2V0RnJvbU90aGVyKHQpe3RoaXMuX19kYXRhWzBdPXQueCx0aGlzLl9fZGF0YVsxXT10LnksdGhpcy5fX2RhdGFbMl09dC56LHRoaXMuX19kYXRhWzNdPXQud31zZXRGcm9tRXVsZXJBbmdsZXModCl7Y29uc3QgZT1uZXcgcjtzd2l0Y2godC5vcmRlcil7Y2FzZSAwOmUuc2V0KHQueCwtdC55LHQueik7YnJlYWs7Y2FzZSAxOmUuc2V0KHQueSwtdC56LHQueCk7YnJlYWs7Y2FzZSAyOmUuc2V0KHQueiwtdC54LHQueSk7YnJlYWs7Y2FzZSAzOmUuc2V0KHQueCx0LnosdC55KTticmVhaztjYXNlIDQ6ZS5zZXQodC56LHQueSx0LngpO2JyZWFrO2Nhc2UgNTplLnNldCh0LnksdC54LHQueik7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInNkcnR5Iil9Y29uc3Qgcz0uNSplLngsYT0uNSplLnksaT0uNSplLnosbj1NYXRoLmNvcyhzKSxoPU1hdGguY29zKGEpLG89TWF0aC5jb3MoaSksXz1NYXRoLnNpbihzKSxkPU1hdGguc2luKGEpLGw9TWF0aC5zaW4oaSksYz1uKm8sdT1uKmwsZj1fKm8sbT1fKmwsZz1oKmYtZCp1LHk9aCptK2QqYyxwPWgqdS1kKmY7c3dpdGNoKHRoaXMudz1oKmMrZCptLHQub3JkZXIpe2Nhc2UgMDp0aGlzLng9Zyx0aGlzLnk9LXksdGhpcy56PXA7YnJlYWs7Y2FzZSAxOnRoaXMueD1wLHRoaXMueT1nLHRoaXMuej0teTticmVhaztjYXNlIDI6dGhpcy54PS15LHRoaXMueT1wLHRoaXMuej1nO2JyZWFrO2Nhc2UgMzp0aGlzLng9Zyx0aGlzLnk9cCx0aGlzLno9eTticmVhaztjYXNlIDQ6dGhpcy54PXAsdGhpcy55PXksdGhpcy56PWc7YnJlYWs7Y2FzZSA1OnRoaXMueD15LHRoaXMueT1nLHRoaXMuej1wO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJzZHJ0eSIpfX10b0V1bGVyQW5nbGVzKHQpe2NvbnN0IGU9bmV3IHI7c3dpdGNoKHQpe2Nhc2UgMDplLnNldCh0aGlzLnosdGhpcy54LHRoaXMueSk7YnJlYWs7Y2FzZSAxOmUuc2V0KHRoaXMueCx0aGlzLnksdGhpcy56KTticmVhaztjYXNlIDI6ZS5zZXQodGhpcy55LHRoaXMueix0aGlzLngpO2JyZWFrO2Nhc2UgMzplLnNldCh0aGlzLnksLXRoaXMueCx0aGlzLnopO2JyZWFrO2Nhc2UgNDplLnNldCh0aGlzLngsLXRoaXMueix0aGlzLnkpO2JyZWFrO2Nhc2UgNTplLnNldCh0aGlzLnosLXRoaXMueSx0aGlzLngpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHJvdGF0aW9uIG9yZGVyOiIrdCl9Y29uc3Qgcz1uZXcgcixhPWUueCplLnkrZS56KnRoaXMudztpZihhPi40OTk5OSlzLnk9MipNYXRoLmF0YW4yKGUueCx0aGlzLncpLHMuej0uNSpNYXRoLlBJLHMueD0wO2Vsc2UgaWYoYTwtLjQ5OTk5KXMueT0tMipNYXRoLmF0YW4yKGUueCx0aGlzLncpLHMuej0tLjUqTWF0aC5QSSxzLng9MDtlbHNle2NvbnN0IHQ9ZS54KmUueCxpPWUueSplLnkscj1lLnoqZS56O3MueT1NYXRoLmF0YW4yKDIqZS55KnRoaXMudy0yKmUueCplLnosMS0yKmktMipyKSxzLno9TWF0aC5hc2luKDIqYSkscy54PU1hdGguYXRhbjIoMiplLngqdGhpcy53LTIqZS55KmUueiwxLTIqdC0yKnIpfXN3aXRjaCh0KXtjYXNlIDA6cmV0dXJuIG5ldyBfKHMueSxzLnoscy54LHQpO2Nhc2UgMTpyZXR1cm4gbmV3IF8ocy54LHMueSxzLnosdCk7Y2FzZSAyOnJldHVybiBuZXcgXyhzLnoscy54LHMueSx0KTtjYXNlIDM6cmV0dXJuIG5ldyBfKC1zLnkscy54LHMueix0KTtjYXNlIDQ6cmV0dXJuIG5ldyBfKHMueCxzLnosLXMueSx0KTtjYXNlIDU6cmV0dXJuIG5ldyBfKHMueiwtcy55LHMueCx0KX19c2V0RnJvbUF4aXNBbmRBbmdsZSh0LGUpe2NvbnN0IHM9ZS8yLGE9dC5ub3JtYWxpemUoKS5zY2FsZShNYXRoLnNpbihzKSk7dGhpcy5zZXQoYS54LGEueSxhLnosTWF0aC5jb3MocykpfXNldEZyb21EaXJlY3Rpb25BbmRVcHZlY3Rvcih0LGUpe2NvbnN0IHM9bmV3IGQ7cy5zZXRGcm9tRGlyZWN0aW9uQW5kVXB2ZWN0b3IodCxlKSx0aGlzLnNldEZyb21NYXQzKHMpfXNldEZyb20yVmVjdG9ycyh0LGUpe3Qubm9ybWFsaXplKCksZS5ub3JtYWxpemUoKTtjb25zdCBzPXQuY3Jvc3MoZSksYT10LmRvdChlKSxpPU1hdGguc3FydCgyKigxK2EpKTt0aGlzLnNldChzLngvaSxzLnkvaSxzLnovaSxpLzIpLHRoaXMubm9ybWFsaXplSW5QbGFjZSgpfXNldEZyb21NYXQzKHQpe2NvbnN0IGU9dC5fX2RhdGFbMF0rdC5fX2RhdGFbNF0rdC5fX2RhdGFbOF07bGV0IHM7aWYoZT4wKXM9TWF0aC5zcXJ0KGUrMSksdGhpcy5fX2RhdGFbM109LjUqcyxzPS41L3MsdGhpcy5fX2RhdGFbMF09KHQuX19kYXRhWzVdLXQuX19kYXRhWzddKSpzLHRoaXMuX19kYXRhWzFdPSh0Ll9fZGF0YVs2XS10Ll9fZGF0YVsyXSkqcyx0aGlzLl9fZGF0YVsyXT0odC5fX2RhdGFbMV0tdC5fX2RhdGFbM10pKnM7ZWxzZXtsZXQgZT0wO3QuX19kYXRhWzRdPnQuX19kYXRhWzBdJiYoZT0xKSx0Ll9fZGF0YVs4XT50Ll9fZGF0YVszKmUrZV0mJihlPTIpO2NvbnN0IGE9KGUrMSklMyxpPShlKzIpJTM7cz1NYXRoLnNxcnQodC5fX2RhdGFbMyplK2VdLXQuX19kYXRhWzMqYSthXS10Ll9fZGF0YVszKmkraV0rMSksdGhpcy5fX2RhdGFbZV09LjUqcyxzPS41L3MsdGhpcy5fX2RhdGFbM109KHQuX19kYXRhWzMqYStpXS10Ll9fZGF0YVszKmkrYV0pKnMsdGhpcy5fX2RhdGFbYV09KHQuX19kYXRhWzMqYStlXSt0Ll9fZGF0YVszKmUrYV0pKnMsdGhpcy5fX2RhdGFbaV09KHQuX19kYXRhWzMqaStlXSt0Ll9fZGF0YVszKmUraV0pKnN9dGhpcy5ub3JtYWxpemVJblBsYWNlKCl9c2V0RnJvbU1hdDQodCl7Y29uc3QgZT10Ll9fZGF0YVswXSt0Ll9fZGF0YVs1XSt0Ll9fZGF0YVsxMF07bGV0IHM7aWYoZT4wKXM9TWF0aC5zcXJ0KGUrMSksdGhpcy5fX2RhdGFbM109LjUqcyxzPS41L3MsdGhpcy5fX2RhdGFbMF09KHQuX19kYXRhWzZdLXQuX19kYXRhWzldKSpzLHRoaXMuX19kYXRhWzFdPSh0Ll9fZGF0YVs4XS10Ll9fZGF0YVsyXSkqcyx0aGlzLl9fZGF0YVsyXT0odC5fX2RhdGFbMV0tdC5fX2RhdGFbNF0pKnM7ZWxzZXtsZXQgZT0wO3QuX19kYXRhWzVdPnQuX19kYXRhWzBdJiYoZT0xKSx0Ll9fZGF0YVsxMF0+dC5fX2RhdGFbNCplK2VdJiYoZT0yKTtjb25zdCBhPShlKzEpJTMsaT0oZSsyKSUzO3M9TWF0aC5zcXJ0KHQuX19kYXRhWzQqZStlXS10Ll9fZGF0YVs0KmErYV0tdC5fX2RhdGFbNCppK2ldKzEpLHRoaXMuX19kYXRhW2VdPS41KnMscz0uNS9zLHRoaXMuX19kYXRhWzNdPSh0Ll9fZGF0YVs0KmEraV0tdC5fX2RhdGFbNCppK2FdKSpzLHRoaXMuX19kYXRhW2FdPSh0Ll9fZGF0YVs0KmErZV0rdC5fX2RhdGFbNCplK2FdKSpzLHRoaXMuX19kYXRhW2ldPSh0Ll9fZGF0YVs0KmkrZV0rdC5fX2RhdGFbNCplK2ldKSpzfXRoaXMubm9ybWFsaXplSW5QbGFjZSgpfWlzSWRlbnRpdHkoKXtyZXR1cm4gdGhpcy5nZXRBbmdsZSgpPE51bWJlci5FUFNJTE9OfWdldEFuZ2xlKCl7cmV0dXJuIDIqTWF0aC5hY29zKHRoaXMudyl9ZXF1YWwodCl7cmV0dXJuIHRoaXMueD09dC54JiZ0aGlzLnk9PXQueSYmdGhpcy56PT10LnomJnRoaXMudz09dC53fW5vdGVxdWFscyh0KXtyZXR1cm4gdGhpcy54IT10LngmJnRoaXMueSE9dC55JiZ0aGlzLnohPXQueiYmdGhpcy53IT10Lnd9YXBwcm94RXF1YWwodCxlPU51bWJlci5FUFNJTE9OKXtyZXR1cm4gTWF0aC5hYnModGhpcy54LXQueCk8ZSYmTWF0aC5hYnModGhpcy55LXQueSk8ZSYmTWF0aC5hYnModGhpcy56LXQueik8ZSYmTWF0aC5hYnModGhpcy53LXQudyk8ZX1hZGQodCl7cmV0dXJuIG5ldyB1KHRoaXMueCt0LngsdGhpcy55K3QueSx0aGlzLnordC56LHRoaXMudyt0LncpfWFkZEluUGxhY2UodCl7dGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpcy56Kz10LnosdGhpcy53Kz10Lnd9c3VidHJhY3QodCl7cmV0dXJuIG5ldyB1KHRoaXMueC10LngsdGhpcy55LXQueSx0aGlzLnotdC56LHRoaXMudy10LncpfXNjYWxlKHQpe3JldHVybiBuZXcgdSh0aGlzLngqdCx0aGlzLnkqdCx0aGlzLnoqdCx0aGlzLncqdCl9c2NhbGVJblBsYWNlKHQpe3RoaXMueCo9dCx0aGlzLnkqPXQsdGhpcy56Kj10LHRoaXMudyo9dH1sZW5ndGgoKXtjb25zdCB0PXRoaXMuX19kYXRhWzBdLGU9dGhpcy5fX2RhdGFbMV0scz10aGlzLl9fZGF0YVsyXSxhPXRoaXMuX19kYXRhWzNdO3JldHVybiBNYXRoLnNxcnQodCp0K2UqZStzKnMrYSphKX1sZW5ndGhTcXVhcmVkKCl7Y29uc3QgdD10aGlzLl9fZGF0YVswXSxlPXRoaXMuX19kYXRhWzFdLHM9dGhpcy5fX2RhdGFbMl0sYT10aGlzLl9fZGF0YVszXTtyZXR1cm4gdCp0K2UqZStzKnMrYSphfW5vcm1hbGl6ZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM107bGV0IGk9dCp0K2UqZStzKnMrYSphO3JldHVybiBpPE51bWJlci5FUFNJTE9OP25ldyB1OihpPTEvTWF0aC5zcXJ0KGkpLG5ldyB1KHQqaSxlKmkscyppKSl9bm9ybWFsaXplSW5QbGFjZSgpe2NvbnN0IHQ9dGhpcy5fX2RhdGFbMF0sZT10aGlzLl9fZGF0YVsxXSxzPXRoaXMuX19kYXRhWzJdLGE9dGhpcy5fX2RhdGFbM107bGV0IGk9dCp0K2UqZStzKnMrYSphO2k8TnVtYmVyLkVQU0lMT058fChpPTEvTWF0aC5zcXJ0KGkpLHRoaXMuc2V0KHQqaSxlKmkscyppLGEqaSkpfWRvdCh0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55K3RoaXMueip0LnordGhpcy53KnQud31jcm9zcyh0KXtjb25zdCBlPXRoaXMueCxzPXRoaXMueSxhPXRoaXMueixpPXRoaXMudyxyPXQueCxuPXQueSxoPXQueixvPXQudztyZXR1cm4gbmV3IHUocypoLWEqbixhKm8taSpoLGkqci1lKm8sZSpuLXMqcil9Y29uanVnYXRlKCl7cmV0dXJuIG5ldyB1KC10aGlzLngsLXRoaXMueSwtdGhpcy56LHRoaXMudyl9aW52ZXJzZSgpe3JldHVybiB0aGlzLmNvbmp1Z2F0ZSgpfWFsaWduV2l0aCh0KXt0aGlzLmRvdCh0KTwwJiZ0aGlzLnNldCgtdGhpcy54LC10aGlzLnksLXRoaXMueiwtdGhpcy53KX1tdWx0aXBseSh0KXtjb25zdCBlPXRoaXMuX19kYXRhWzBdLHM9dGhpcy5fX2RhdGFbMV0sYT10aGlzLl9fZGF0YVsyXSxpPXRoaXMuX19kYXRhWzNdLHI9dC5fX2RhdGFbMF0sbj10Ll9fZGF0YVsxXSxoPXQuX19kYXRhWzJdLG89dC5fX2RhdGFbM107cmV0dXJuIG5ldyB1KGUqbytpKnIrcypoLWEqbixzKm8raSpuK2Eqci1lKmgsYSpvK2kqaCtlKm4tcypyLGkqby1lKnItcypuLWEqaCl9bXVsdGlwbHlJblBsYWNlKHQpe2NvbnN0IGU9dGhpcy5fX2RhdGFbMF0scz10aGlzLl9fZGF0YVsxXSxhPXRoaXMuX19kYXRhWzJdLGk9dGhpcy5fX2RhdGFbM10scj10Ll9fZGF0YVswXSxuPXQuX19kYXRhWzFdLGg9dC5fX2RhdGFbMl0sbz10Ll9fZGF0YVszXTt0aGlzLnNldChlKm8raSpyK3MqaC1hKm4scypvK2kqbithKnItZSpoLGEqbytpKmgrZSpuLXMqcixpKm8tZSpyLXMqbi1hKmgpfXJvdGF0ZVZlYzModCl7Y29uc3QgZT1uZXcgdSh0LngsdC55LHQueiwwKSxzPXRoaXMubXVsdGlwbHkoZSkubXVsdGlwbHkodGhpcy5jb25qdWdhdGUoKSk7cmV0dXJuIG5ldyByKHMueCxzLnkscy56KX1yb3RhdGVYKHQpe3QqPS41O2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dGhpcy53LHI9TWF0aC5zaW4odCksbj1NYXRoLmNvcyh0KTt0aGlzLng9ZSpuK2kqcix0aGlzLnk9cypuK2Eqcix0aGlzLno9YSpuLXMqcix0aGlzLnc9aSpuLWUqcn1yb3RhdGVZKHQpe3QqPS41O2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dGhpcy53LHI9TWF0aC5zaW4odCksbj1NYXRoLmNvcyh0KTt0aGlzLng9ZSpuLWEqcix0aGlzLnk9cypuK2kqcix0aGlzLno9YSpuK2Uqcix0aGlzLnc9aSpuLXMqcn1yb3RhdGVaKHQpe3QqPS41O2NvbnN0IGU9dGhpcy54LHM9dGhpcy55LGE9dGhpcy56LGk9dGhpcy53LHI9TWF0aC5zaW4odCksbj1NYXRoLmNvcyh0KTt0aGlzLng9ZSpuK3Mqcix0aGlzLnk9cypuLWUqcix0aGlzLno9YSpuK2kqcix0aGlzLnc9aSpuLWEqcn10b01hdDMoKXtjb25zdCB0PXRoaXMueCxlPXRoaXMueSxzPXRoaXMueixhPXRoaXMudyxpPXQrdCxyPWUrZSxuPXMrcyxoPXQqaSxvPWUqaSxfPWUqcixsPXMqaSxjPXMqcix1PXMqbixmPWEqaSxtPWEqcixnPWEqbix5PW5ldyBkO3JldHVybiB5Ll9fZGF0YVswXT0xLV8tdSx5Ll9fZGF0YVszXT1vLWcseS5fX2RhdGFbNl09bCttLHkuX19kYXRhWzFdPW8rZyx5Ll9fZGF0YVs0XT0xLWgtdSx5Ll9fZGF0YVs3XT1jLWYseS5fX2RhdGFbMl09bC1tLHkuX19kYXRhWzVdPWMrZix5Ll9fZGF0YVs4XT0xLWgtXyx5fWdldFhheGlzKCl7Y29uc3QgdD10aGlzLngqdGhpcy55LGU9dGhpcy54KnRoaXMueixzPXRoaXMueSp0aGlzLnksYT10aGlzLnkqdGhpcy53LGk9dGhpcy56KnRoaXMueixuPXRoaXMueip0aGlzLnc7cmV0dXJuIG5ldyByKDEtMiooaStzKSwyKih0K24pLDIqKGUtYSkpfWdldFlheGlzKCl7Y29uc3QgdD10aGlzLngqdGhpcy54LGU9dGhpcy54KnRoaXMueSxzPXRoaXMueCp0aGlzLncsYT10aGlzLnkqdGhpcy56LGk9dGhpcy56KnRoaXMueixuPXRoaXMueip0aGlzLnc7cmV0dXJuIG5ldyByKDIqKGUtbiksMS0yKihpK3QpLDIqKGErcykpfWdldFpheGlzKCl7Y29uc3QgdD10aGlzLngqdGhpcy54LGU9dGhpcy54KnRoaXMueixzPXRoaXMueCp0aGlzLncsYT10aGlzLnkqdGhpcy55LGk9dGhpcy55KnRoaXMueixuPXRoaXMueSp0aGlzLnc7bmV3IHI7cmV0dXJuIG5ldyByKDIqKG4rZSksMiooaS1zKSwxLTIqKGErdCkpfW1pcnJvcih0KXtzd2l0Y2godCl7Y2FzZSAwOnJldHVybiBuZXcgdSh0aGlzLnosdGhpcy53LHRoaXMueCx0aGlzLnkpO2Nhc2UgMTpyZXR1cm4gbmV3IHUoLXRoaXMudyx0aGlzLnosdGhpcy55LC10aGlzLngpO2Nhc2UgMjpyZXR1cm4gbmV3IHUodGhpcy54LHRoaXMueSx0aGlzLnosLXRoaXMudyl9fXRvTWF0NCgpe2NvbnN0IHQ9dGhpcy54LGU9dGhpcy55LHM9dGhpcy56LGE9dGhpcy53LGk9dCt0LHI9ZStlLG49cytzLGg9dCppLG89ZSppLF89ZSpyLGQ9cyppLGM9cypyLHU9cypuLGY9YSppLG09YSpyLGc9YSpuLHk9bmV3IGw7cmV0dXJuIHkuX19kYXRhWzBdPTEtXy11LHkuX19kYXRhWzRdPW8tZyx5Ll9fZGF0YVs4XT1kK20seS5fX2RhdGFbMV09bytnLHkuX19kYXRhWzVdPTEtaC11LHkuX19kYXRhWzldPWMtZix5Ll9fZGF0YVsyXT1kLW0seS5fX2RhdGFbNl09YytmLHkuX19kYXRhWzEwXT0xLWgtXyx5fWxlcnAodCxlKXtjb25zdCBzPW5ldyB1KHRoaXMueCtlKih0LngtdGhpcy54KSx0aGlzLnkrZSoodC55LXRoaXMueSksdGhpcy56K2UqKHQuei10aGlzLnopLHRoaXMudytlKih0LnctdGhpcy53KSk7cmV0dXJuIHMubm9ybWFsaXplSW5QbGFjZSgpLHN9c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IHUoLi4udCl9c3RhdGljIGNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHQsZT0wKXtyZXR1cm4gbmV3IHUodCw0KmUpfXN0YXRpYyBudW1FbGVtZW50cygpe3JldHVybiA0fWNsb25lKCl7cmV0dXJuIG5ldyB1KHRoaXMuX19kYXRhWzBdLHRoaXMuX19kYXRhWzFdLHRoaXMuX19kYXRhWzJdLHRoaXMuX19kYXRhWzNdKX10b0pTT04oKXtyZXR1cm57eDp0aGlzLngseTp0aGlzLnksejp0aGlzLnosdzp0aGlzLnd9fWZyb21KU09OKHQpe3RoaXMuX19kYXRhWzBdPXQueCx0aGlzLl9fZGF0YVsxXT10LnksdGhpcy5fX2RhdGFbMl09dC56LHRoaXMuX19kYXRhWzNdPXQudyx0aGlzLm5vcm1hbGl6ZUluUGxhY2UoKX19YS5yZWdpc3RlclR5cGUoIlF1YXQiLHUpO2NsYXNzIGZ7Y29uc3RydWN0b3IodCxlKXt0aGlzLnN0YXJ0PXQgaW5zdGFuY2VvZiByP3Q6bmV3IHIsdGhpcy5kaXI9ZSBpbnN0YW5jZW9mIHI/ZTpuZXcgcn1jbG9zZXN0UG9pbnQodCl7Y29uc3QgZT10LnN1YnRyYWN0KHRoaXMuc3RhcnQpLmRvdCh0aGlzLmRpcik7aWYoZTxOdW1iZXIuRVBTSUxPTilyZXR1cm4gdGhpcy5zdGFydDtjb25zdCBzPWUvdGhpcy5kaXIuZG90KHRoaXMuZGlyKTtyZXR1cm4gdGhpcy5zdGFydC5hZGQodGhpcy5kaXIuc2NhbGUocykpfXBvaW50QXREaXN0KHQpe3JldHVybiB0aGlzLnN0YXJ0LmFkZCh0aGlzLmRpci5zY2FsZSh0KSl9aW50ZXJzZWN0UmF5VmVjdG9yKHQpe2NvbnN0IGU9dGhpcy5kaXIscz10LmRpcixhPXRoaXMuc3RhcnQuc3VidHJhY3QodC5zdGFydCksaT1lLmRvdChlKSxyPWUuZG90KHMpLG49cy5kb3QocyksaD1lLmRvdChhKSxvPXMuZG90KGEpO2lmKDA9PWkmJjA9PW4pcmV0dXJuIHRoaXMuc3RhcnQuZGlzdGFuY2VUbyh0LnN0YXJ0KTtpZigwPT1pKXJldHVybiB0LmNsb3Nlc3RQb2ludCh0aGlzLnN0YXJ0KTtpZigwPT1uKXJldHVybiB0aGlzLmNsb3Nlc3RQb2ludCh0LnN0YXJ0KTtjb25zdCBfPWkqbi1yKnI7bGV0IGQsbDtyZXR1cm4gXzwuMDAxPyhkPTAsbD1yPm4/aC9yOm8vbik6KGQ9KHIqby1uKmgpL18sbD0oaSpvLXIqaCkvXyksW2QsbF19aW50ZXJzZWN0UmF5UGxhbmUodCl7Y29uc3QgZT10aGlzLnN0YXJ0LnN1YnRyYWN0KHQuc3RhcnQpLHM9dC5kaXIuZG90KHRoaXMuZGlyKSxhPS10LmRpci5kb3QoZSk7aWYoTWF0aC5hYnMocyk8TnVtYmVyLlBSRUNJU0lPTilyZXR1cm4tMTtjb25zdCBpPWEvcztyZXR1cm4gaTwtTnVtYmVyLlBSRUNJU0lPTj8tMTppfWNsb25lKCl7cmV0dXJuIG5ldyBmKHRoaXMuc3RhcnQuY2xvbmUoKSx0aGlzLmRpci5jbG9uZSgpKX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgZiguLi50KX10b0pTT04oKXtyZXR1cm57c3RhcnQ6dGhpcy5zdGFydCxkaXI6dGhpcy5kaXJ9fWZyb21KU09OKHQpe3RoaXMuc3RhcnQuZnJvbUpTT04odC5zdGFydCksdGhpcy5kaXIuZnJvbUpTT04odC5kaXIpfXRvU3RyaW5nKCl7cmV0dXJuIGUodGhpcy50b0pTT04oKSl9fWEucmVnaXN0ZXJUeXBlKCJSYXkiLGYpO25ldyByKDEsMSwxKTtjbGFzcyBte2NvbnN0cnVjdG9yKHQsZSxzKXtpZih0IGluc3RhbmNlb2YgRmxvYXQzMkFycmF5KXRoaXMuc2V0RnJvbUZsb2F0MzJBcnJheSh0KTtlbHNle2lmKHQgaW5zdGFuY2VvZiByKXRoaXMudHI9dDtlbHNle2lmKHQgaW5zdGFuY2VvZiB1JiZudWxsPT1lJiZudWxsPT1zKXJldHVybiB0aGlzLnRyPW5ldyByLHRoaXMub3JpPXQsdm9pZCh0aGlzLnNjPW5ldyByKDEsMSwxKSk7dGhpcy50cj1uZXcgcn10aGlzLm9yaT1lIGluc3RhbmNlb2YgdT9lOm5ldyB1LHRoaXMuc2M9cyBpbnN0YW5jZW9mIHI/czpuZXcgcigxLDEsMSl9fXNldCh0LGUscyl7dGhpcy50cj10LHRoaXMub3JpPWUscyBpbnN0YW5jZW9mIHImJih0aGlzLnNjPXMpfXNldEZyb21PdGhlcih0KXt0aGlzLnRyPXQudHIsdGhpcy5vcmk9dC5vcmksdGhpcy5zYz10LnNjfWlzSWRlbnRpdHkoKXtyZXR1cm4gdGhpcy50ci5pc051bGwoKSYmdGhpcy5vcmkuaXNJZGVudGl0eSgpJiZ0aGlzLnNjLmlzMTExKCl9c2V0TG9va0F0KHQsZSxzKXtjb25zdCBhPXQuc3VidHJhY3QoZSk7aWYoYS5sZW5ndGgoKTxOdW1iZXIuRVBTSUxPTil0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgZGlyIik7dGhpcy5vcmkuc2V0RnJvbURpcmVjdGlvbkFuZFVwdmVjdG9yKGEscyksdGhpcy50cj10fW11bHRpcGx5KHQpe2xldCBlPXRoaXMuc2M7cmV0dXJuIHRoaXMuc2MueD09dGhpcy5zYy55JiZ0aGlzLnNjLng9PXRoaXMuc2Muenx8KGU9dC5vcmkucm90YXRlVmVjMyh0aGlzLnNjKSxNYXRoLnNpZ24oZS54KSE9TWF0aC5zaWduKHRoaXMuc2MueCkmJihlLng9LWUueCksTWF0aC5zaWduKGUueSkhPU1hdGguc2lnbih0aGlzLnNjLnkpJiYoZS55PS1lLnkpLE1hdGguc2lnbihlLnopIT1NYXRoLnNpZ24odGhpcy5zYy56KSYmKGUuej0tZS56KSksbmV3IG0odGhpcy50ci5hZGQodGhpcy5vcmkucm90YXRlVmVjMyhlLm11bHRpcGx5KHQudHIpKSksdGhpcy5vcmkubXVsdGlwbHkodC5vcmkpLGUubXVsdGlwbHkodC5zYykpfWludmVyc2UoKXtjb25zdCB0PW5ldyBtO3JldHVybiB0Lm9yaT10aGlzLm9yaS5pbnZlcnNlKCksdGhpcy5zYy54IT10aGlzLnNjLnl8fHRoaXMuc2MueCE9dGhpcy5zYy56Pyh0LnNjPXQub3JpLnJvdGF0ZVZlYzModGhpcy5zYyksTWF0aC5zaWduKHQuc2MueCkhPU1hdGguc2lnbih0aGlzLnNjLngpJiYodC5zYy54PS10LnNjLngpLE1hdGguc2lnbih0LnNjLnkpIT1NYXRoLnNpZ24odGhpcy5zYy55KSYmKHQuc2MueT0tdC5zYy55KSxNYXRoLnNpZ24odC5zYy56KSE9TWF0aC5zaWduKHRoaXMuc2MueikmJih0LnNjLno9LXQuc2MueikpOnQuc2M9dGhpcy5zYy5pbnZlcnNlKCksdC50cj10Lm9yaS5yb3RhdGVWZWMzKHRoaXMudHIubmVnYXRlKCkubXVsdGlwbHkodC5zYykpLHR9dHJhbnNmb3JtVmVjMyh0KXtyZXR1cm4gdGhpcy50ci5hZGQodGhpcy5vcmkucm90YXRlVmVjMyh0aGlzLnNjLm11bHRpcGx5KHQpKSl9dG9NYXQ0KCl7Y29uc3QgdD1uZXcgbCh0aGlzLnNjLngsMCwwLDAsMCx0aGlzLnNjLnksMCwwLDAsMCx0aGlzLnNjLnosMCwwLDAsMCwxKSxlPXRoaXMub3JpLnRvTWF0NCgpLHM9bmV3IGw7cmV0dXJuIHMudHJhbnNsYXRpb249dGhpcy50cixzLm11bHRpcGx5KGUpLm11bHRpcGx5KHQpfWZyb21NYXQ0KHQpe3RoaXMudHI9dC50cmFuc2xhdGlvbix0aGlzLm9yaS5zZXRGcm9tTWF0NCh0KX1zZXRGcm9tRmxvYXQzMkFycmF5KHQpe2lmKDc9PXQubGVuZ3RoKXJldHVybiB0aGlzLnRyPW5ldyByKHQuYnVmZmVyLHQuYnl0ZU9mZnNldCksdGhpcy5vcmk9bmV3IHUodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzEyKSx2b2lkKHRoaXMuc2M9bmV3IHIoMSwxLDEpKTtpZig4IT10Lmxlbmd0aClyZXR1cm4gMTA9PXQubGVuZ3RoPyh0aGlzLnRyPW5ldyByKHQuYnVmZmVyLHQuYnl0ZU9mZnNldCksdGhpcy5vcmk9bmV3IHUodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzEyKSx2b2lkKHRoaXMuc2M9bmV3IHIodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzIxKSkpOnZvaWQgMDt7dGhpcy50cj1uZXcgcih0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQpLHRoaXMub3JpPW5ldyB1KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCsxMik7Y29uc3QgZT10WzddO3RoaXMuc2M9bmV3IHIoZSxlLGUpfX1jbG9uZSgpe3JldHVybiBuZXcgbSh0aGlzLnRyLmNsb25lKCksdGhpcy5vcmkuY2xvbmUoKSx0aGlzLnNjLmNsb25lKCkpfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBtKC4uLnQpfXRvSlNPTigpe2NvbnN0IHQ9e3RyOnRoaXMudHIudG9KU09OKCksb3JpOnRoaXMub3JpLnRvSlNPTigpfTtyZXR1cm4gdGhpcy5zYy5pczExMSgpfHwodC5zYz10aGlzLnNjLnRvSlNPTigpKSx0fWZyb21KU09OKHQpe3RoaXMudHIuZnJvbUpTT04odC50ciksdGhpcy5vcmkuZnJvbUpTT04odC5vcmkpLHQuc2MmJnRoaXMuc2MuZnJvbUpTT04odC5zYyl9dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX19YS5yZWdpc3RlclR5cGUoIlhmbyIsbSk7Y2xhc3MgZ3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMucDA9dCBpbnN0YW5jZW9mIGk/dDpuZXcgaShOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSx0aGlzLnAxPWUgaW5zdGFuY2VvZiBpP2U6bmV3IGkoTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLE51bWJlci5ORUdBVElWRV9JTkZJTklUWSl9c2V0KHQsZSl7dGhpcy5wMD10LHRoaXMucDE9ZX1yZXNldCgpe3RoaXMucDAueD1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksdGhpcy5wMS54PU51bWJlci5ORUdBVElWRV9JTkZJTklUWSx0aGlzLnAwLnk9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLHRoaXMucDEueT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFl9aXNWYWxpZCgpe3JldHVybiB0aGlzLnAwLnghPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdGhpcy5wMS54IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJnRoaXMucDAueSE9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZJiZ0aGlzLnAxLnkhPU51bWJlci5ORUdBVElWRV9JTkZJTklUWX1hZGRQb2ludCh0KXsodGhpcy5wMC54PT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl8fHQueDx0aGlzLnAwLngpJiYodGhpcy5wMC54PXQueCksKHRoaXMucDAueT09TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZfHx0Lnk8dGhpcy5wMC55KSYmKHRoaXMucDAueT10LnkpLCh0aGlzLnAxLnk9PU51bWJlci5ORUdBVElWRV9JTkZJTklUWXx8dC54PnRoaXMucDEueCkmJih0aGlzLnAxLng9dC54KSwodGhpcy5wMS55PT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFl8fHQueT50aGlzLnAxLnkpJiYodGhpcy5wMS55PXQueSl9c2l6ZSgpe3JldHVybiB0aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApfWRpYWdvbmFsKCl7cmV0dXJuIHRoaXMucDEuc3VidHJhY3QodGhpcy5wMCl9Y2VudGVyKCl7Y29uc3QgdD10aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApO3JldHVybiB0LnNjYWxlSW5QbGFjZSguNSksdC5hZGRJblBsYWNlKHRoaXMucDApLHR9c3RhdGljIGNyZWF0ZSguLi50KXtyZXR1cm4gbmV3IGcoLi4udCl9dG9KU09OKCl7cmV0dXJue3AwOnRoaXMucDAudG9KU09OKCkscDE6dGhpcy5wMS50b0pTT04oKX19dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX19YS5yZWdpc3RlclR5cGUoIkJveDIiLGcpO2NsYXNzIHkgZXh0ZW5kcyBze2NvbnN0cnVjdG9yKHQsZT0wKXtzdXBlcigpLHRoaXMucG9zPXQgaW5zdGFuY2VvZiByP3Q6bmV3IHIsdGhpcy5yYWRpdXM9ZX1jbG9uZSgpe3JldHVybiBuZXcgU3BoZXJlKHRoaXMucG9zLmNsb25lKCksdGhpcy5yYWRpdXMpfWludGVyc2VjdHNCb3godCl7cmV0dXJuIHQuaW50ZXJzZWN0c1NwaGVyZSh0aGlzKX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgU3BoZXJlKC4uLnQpfXRvSlNPTigpe3JldHVybntwb3M6dGhpcy5wb3MudG9KU09OKCkscmFkaXVzOnRoaXMucmFkaXVzfX10b1N0cmluZygpe3JldHVybiBlKHRoaXMudG9KU09OKCkpfX1hLnJlZ2lzdGVyVHlwZSgiU3BoZXJlVHlwZSIseSk7Y2xhc3MgcHtjb25zdHJ1Y3Rvcih0LGUpe3QgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/dGhpcy5zZXRGcm9tRmxvYXQzMkFycmF5KHQpOih0aGlzLnAwPXQgaW5zdGFuY2VvZiByP3Q6bmV3IHIoTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLE51bWJlci5QT1NJVElWRV9JTkZJTklUWSxOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpLHRoaXMucDE9ZSBpbnN0YW5jZW9mIHI/ZTpuZXcgcihOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLE51bWJlci5ORUdBVElWRV9JTkZJTklUWSkpfWdldCBtaW4oKXtyZXR1cm4gdGhpcy5wMH1nZXQgbWF4KCl7cmV0dXJuIHRoaXMucDF9c2V0KHQsZSl7dGhpcy5wMD10LHRoaXMucDE9ZX1yZXNldCgpe3RoaXMucDAueD1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksdGhpcy5wMS54PU51bWJlci5ORUdBVElWRV9JTkZJTklUWSx0aGlzLnAwLnk9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLHRoaXMucDEueT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFksdGhpcy5wMC56PU51bWJlci5QT1NJVElWRV9JTkZJTklUWSx0aGlzLnAxLno9TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZfWlzVmFsaWQoKXtyZXR1cm4gdGhpcy5wMC54IT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkmJnRoaXMucDEueCE9TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZJiZ0aGlzLnAwLnkhPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdGhpcy5wMS55IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJnRoaXMucDAueiE9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZJiZ0aGlzLnAxLnohPU51bWJlci5ORUdBVElWRV9JTkZJTklUWX1hZGRQb2ludCh0KXt0LnghPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdC54IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJih0Lng8dGhpcy5wMC54JiYodGhpcy5wMC54PXQueCksdC54PnRoaXMucDEueCYmKHRoaXMucDEueD10LngpKSx0LnkhPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdC55IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJih0Lnk8dGhpcy5wMC55JiYodGhpcy5wMC55PXQueSksdC55PnRoaXMucDEueSYmKHRoaXMucDEueT10LnkpKSx0LnohPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSYmdC56IT1OdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkmJih0Lno8dGhpcy5wMC56JiYodGhpcy5wMC56PXQueiksdC56PnRoaXMucDEueiYmKHRoaXMucDEuej10LnopKX1hZGRCb3gzKHQsZSl7ZT8odGhpcy5hZGRQb2ludChlLnRyYW5zZm9ybVZlYzModC5wMCkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDAueCx0LnAwLnksdC5wMS56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDAueCx0LnAxLnksdC5wMC56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDEueCx0LnAwLnksdC5wMC56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDAueCx0LnAxLnksdC5wMS56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDEueCx0LnAwLnksdC5wMS56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKG5ldyByKHQucDEueCx0LnAxLnksdC5wMC56KSkpLHRoaXMuYWRkUG9pbnQoZS50cmFuc2Zvcm1WZWMzKHQucDEpKSk6KHRoaXMuYWRkUG9pbnQodC5wMCksdGhpcy5hZGRQb2ludCh0LnAxKSl9c2l6ZSgpe3JldHVybiB0aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApfWRpYWdvbmFsKCl7cmV0dXJuIHRoaXMucDEuc3VidHJhY3QodGhpcy5wMCl9Y2VudGVyKCl7Y29uc3QgdD10aGlzLnAxLnN1YnRyYWN0KHRoaXMucDApO3JldHVybiB0LnNjYWxlSW5QbGFjZSguNSksdC5hZGRJblBsYWNlKHRoaXMucDApLHR9dG9NYXQ0KCl7Y29uc3QgdD10aGlzLnAxLngtdGhpcy5wMC54LGU9dGhpcy5wMS55LXRoaXMucDAueSxzPXRoaXMucDEuei10aGlzLnAwLno7cmV0dXJuIG5ldyBsKHQsMCwwLDAsMCxlLDAsMCwwLDAscywwLHRoaXMucDAueCx0aGlzLnAwLnksdGhpcy5wMC56LDEpfWdldEJvdW5kaW5nU3BoZXJlKCl7cmV0dXJuIG5ldyB5KHRoaXMuY2VudGVyKCksLjUqdGhpcy5kaWFnb25hbCgpLmxlbmd0aCgpKX1pbnRlcnNlY3RzQm94KHQpe3JldHVybiEodC5tYXgueDx0aGlzLm1pbi54fHx0Lm1pbi54PnRoaXMubWF4Lnh8fHQubWF4Lnk8dGhpcy5taW4ueXx8dC5taW4ueT50aGlzLm1heC55fHx0Lm1heC56PHRoaXMubWluLnp8fHQubWluLno+dGhpcy5tYXgueil9aW50ZXJzZWN0c1NwaGVyZSh0KXtyZXR1cm4gY2xvc2VzdFBvaW50LmRpc3RhbmNlVG9TcXVhcmVkKHQuY2VudGVyKTw9dC5yYWRpdXMqdC5yYWRpdXN9aW50ZXJzZWN0c1BsYW5lKHQpe2xldCBlLHM7cmV0dXJuIHQubm9ybWFsLng+MD8oZT10Lm5vcm1hbC54KnRoaXMubWluLngscz10Lm5vcm1hbC54KnRoaXMubWF4LngpOihlPXQubm9ybWFsLngqdGhpcy5tYXgueCxzPXQubm9ybWFsLngqdGhpcy5taW4ueCksdC5ub3JtYWwueT4wPyhlKz10Lm5vcm1hbC55KnRoaXMubWluLnkscys9dC5ub3JtYWwueSp0aGlzLm1heC55KTooZSs9dC5ub3JtYWwueSp0aGlzLm1heC55LHMrPXQubm9ybWFsLnkqdGhpcy5taW4ueSksdC5ub3JtYWwuej4wPyhlKz10Lm5vcm1hbC56KnRoaXMubWluLnoscys9dC5ub3JtYWwueip0aGlzLm1heC56KTooZSs9dC5ub3JtYWwueip0aGlzLm1heC56LHMrPXQubm9ybWFsLnoqdGhpcy5taW4ueiksZTw9LXQuY29uc3RhbnQmJnM+PS10LmNvbnN0YW50fWNsb25lKCl7cmV0dXJuIG5ldyBwKHRoaXMucDAuY2xvbmUoKSx0aGlzLnAxLmNsb25lKCkpfXN0YXRpYyBjcmVhdGUoLi4udCl7cmV0dXJuIG5ldyBwKC4uLnQpfXN0YXRpYyBzaXplSW5CeXRlcygpe3JldHVybiAyNH10b0pTT04oKXtyZXR1cm57cDA6dGhpcy5wMC50b0pTT04oKSxwMTp0aGlzLnAxLnRvSlNPTigpfX1mcm9tSlNPTih0KXt0aGlzLnAwLmZyb21KU09OKHQucDApLHRoaXMucDEuZnJvbUpTT04odC5wMSl9bG9hZEJpbih0LGUpe3RoaXMucDAubG9hZEJpbih0LGUpLHRoaXMucDAubG9hZEJpbih0LGUrMTIpfXNldEZyb21GbG9hdDMyQXJyYXkodCl7dGhpcy5wMD1uZXcgcih0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQpLHRoaXMucDE9bmV3IHIodC5idWZmZXIsdC5ieXRlT2Zmc2V0KzEyKX10b1N0cmluZygpe3JldHVybiBlKHRoaXMudG9KU09OKCkpfX1hLnJlZ2lzdGVyVHlwZSgiQm94MyIscCk7Y2xhc3MgeCBleHRlbmRzIHN7Y29uc3RydWN0b3IodCxlPTApe3N1cGVyKCksdGhpcy5ub3JtYWw9dCBpbnN0YW5jZW9mIHI/dDpuZXcgcix0aGlzLnc9ZX1zZXQodCxlLHMsYSl7dGhpcy5ub3JtYWwuc2V0KHQsZSxzKSx0aGlzLnc9YX1kaXZpZGVTY2FsYXIodCl7dGhpcy5ub3JtYWwuc2NhbGVJblBsYWNlKDEvdCksdGhpcy53Lz10fWRpc3RhbmNlVG9Qb2ludCh0KXtyZXR1cm4gdC5kb3QodGhpcy5ub3JtYWwpK3RoaXMud31ub3JtYWxpemVJblBsYWNlKCl7Y29uc3QgdD0xL3RoaXMubm9ybWFsLmxlbmd0aCgpO3RoaXMubm9ybWFsLnNjYWxlSW5QbGFjZSh0KSx0aGlzLncqPXR9Y2xvbmUoKXtyZXR1cm4gbmV3IFBsYW5lKHRoaXMubm9ybWFsLmNsb25lKCksdGhpcy53KX1zdGF0aWMgY3JlYXRlKC4uLnQpe3JldHVybiBuZXcgUGxhbmUoLi4udCl9dG9KU09OKCl7cmV0dXJue25vcm1hbDp0aGlzLm5vcm1hbC50b0pTT04oKSx3OnRoaXMud319dG9TdHJpbmcoKXtyZXR1cm4gZSh0aGlzLnRvSlNPTigpKX19YS5yZWdpc3RlclR5cGUoIlBsYW5lVHlwZSIseCk7YS5yZWdpc3RlclR5cGUoIkZydXN0dW0iLGNsYXNze2NvbnN0cnVjdG9yKHQsZSxzLGEsaSxyKXt0aGlzLnBsYW5lcz1bdHx8bmV3IHgsZXx8bmV3IHgsc3x8bmV3IHgsYXx8bmV3IHgsaXx8bmV3IHgscnx8bmV3IHhdfXNldEZyb21NYXRyaXgodCl7Y29uc3QgZT10LHM9dGhpcy5wbGFuZXM7c1swXS5zZXQoZS5tMDMtZS5tMDAsZS5tMTMtZS5tMTAsZS5tMjMtZS5tMjAsZS5tMzMtZS5tMzApLHNbMV0uc2V0KGUubTAzK2UubTAwLGUubTEzK2UubTEwLGUubTIzK2UubTIwLGUubTMzK2UubTMwKSxzWzJdLnNldChlLm0wMytlLm0wMSxlLm0xMytlLm0xMSxlLm0yMytlLm0yMSxlLm0zMytlLm0zMSksc1szXS5zZXQoZS5tMDMtZS5tMDEsZS5tMTMtZS5tMTEsZS5tMjMtZS5tMjEsZS5tMzMtZS5tMzEpLHNbNF0uc2V0KGUubTAzLWUubTAyLGUubTEzLWUubTEyLGUubTIzLWUubTIyLGUubTMzLWUubTMyKSxzWzVdLnNldChlLm0wMytlLm0wMixlLm0xMytlLm0xMixlLm0yMytlLm0yMixlLm0zMytlLm0zMikscy5mb3JFYWNoKHQ9PnQubm9ybWFsaXplSW5QbGFjZSgpKX1pbnRlcnNlY3RzQm94KHQpe2NvbnN0IGU9bmV3IHIscz10aGlzLnBsYW5lcyx7bWluOmEsbWF4Oml9PXQ7Zm9yKGxldCB0PTA7dDw2O3QrKyl7Y29uc3Qgcj1zW3RdO2lmKGUueD1yLm5vcm1hbC54PjA/aS54OmEueCxlLnk9ci5ub3JtYWwueT4wP2kueTphLnksZS56PXIubm9ybWFsLno+MD9pLno6YS56LHIuZGlzdGFuY2VUb1BvaW50KGUpPDApcmV0dXJuITF9cmV0dXJuITB9dG9KU09OKCl7cmV0dXJue3AwOnRoaXMucDAudG9KU09OKCkscDE6dGhpcy5wMS50b0pTT04oKSxwMjp0aGlzLnAyLnRvSlNPTigpLHAzOnRoaXMucDMudG9KU09OKCkscDQ6dGhpcy5wNC50b0pTT04oKSxwNTp0aGlzLnA1LnRvSlNPTigpfX1mcm9tSlNPTih0KXt0aGlzLnAwLmZyb21KU09OKHQucDApLHRoaXMucDEuZnJvbUpTT04odC5wMSksdGhpcy5wMi5mcm9tSlNPTih0LnAyKSx0aGlzLnAzLmZyb21KU09OKHQucDMpLHRoaXMucDQuZnJvbUpTT04odC5wNCksdGhpcy5wNS5mcm9tSlNPTih0LnA1KX10b1N0cmluZygpe3JldHVybiBlKHRoaXMudG9KU09OKCkpfX0pO2NsYXNzIHd7Y29uc3RydWN0b3IodD0hMSl7dGhpcy5fX3Nsb3RzPVtdLHRoaXMuX190b2dnbGVkU2lnbmFsPXQsdGhpcy5fX3RvZ2dsZWQ9ITEsdGhpcy5fX2RhdGE9bnVsbCx0aGlzLmNvbm5lY3Q9dGhpcy5jb25uZWN0LmJpbmQodGhpcyksdGhpcy5kaXNjb25uZWN0PXRoaXMuZGlzY29ubmVjdC5iaW5kKHRoaXMpLHRoaXMuZW1pdD10aGlzLmVtaXQuYmluZCh0aGlzKX1jb25uZWN0KHQpe2lmKG51bGw9PXQpdGhyb3cgbmV3IEVycm9yKCJhIGZ1bmN0aW9uIGNhbGxiYWNrIG11c3QgYmUgcGFzc2VkIHRvIFNpZ25hbC5jb25uZWN0Iik7aWYoLTEhPXRoaXMuX19zbG90cy5pbmRleE9mKHQpKXJldHVybiB2b2lkIGNvbnNvbGUud2FybigiZm4gJyIrdC5uYW1lKyInIGFscmVhZHkgY29ubmVjdGVkIHRvIFNpZ25hbC4iKTtjb25zdCBlPXRoaXMuX19zbG90cy5sZW5ndGg7cmV0dXJuIHRoaXMuX19zbG90c1tlXT10LHRoaXMuX190b2dnbGVkU2lnbmFsJiZ0aGlzLl9fdG9nZ2xlZCYmKHRoaXMuX19kYXRhP3QoLi4udGhpcy5fX2RhdGEpOnQoKSksZX1kaXNjb25uZWN0KHQpe2lmKG51bGw9PXQpdGhyb3cgbmV3IEVycm9yKCJhIGZ1bmN0aW9uIGNhbGxiYWNrIG11c3QgYmUgcGFzc2VkIHRvIFNpZ25hbC5kaXNjb25uZWN0Iik7Y29uc3QgZT1bXTtpZih0aGlzLl9fc2xvdHMuZm9yRWFjaCgoZnVuY3Rpb24ocyxhKXtzPT09dCYmZS5wdXNoKGEpfSkpLDAhPWUubGVuZ3RoKWZvcihjb25zdCB0IG9mIGUpdGhpcy5fX3Nsb3RzW3RdPXZvaWQgMDtlbHNlIGNvbnNvbGUud2FybigiY2FsbGJhY2sgOiIrdC5uYW1lKyIgd2FzIG5vdCBjb25uZWN0ZWQgdG8gdGhpcyBzaWduYWw6Iit0aGlzLl9fbmFtZSl9ZGlzY29ubmVjdElkKHQpe2lmKCF0aGlzLl9fc2xvdHNbdF0pdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIElEIik7dGhpcy5fX3Nsb3RzW3RdPXZvaWQgMH1lbWl0KC4uLnQpe3RoaXMuX190b2dnbGVkU2lnbmFsJiYodGhpcy5fX3RvZ2dsZWQ/Y29uc29sZS53YXJuKCJUb2dnbGVkIHNpZ25hbHMgc2hvdWxkIG9ubHkgYmUgZmlyZWQgb25jZSwgb3IgdW50b2dnbGVkIGJlZm9yZSByZS1maXJpbmcuLiIpOih0aGlzLl9fdG9nZ2xlZD0hMCx0aGlzLl9fZGF0YT10KSk7Y29uc3QgZT10aGlzLl9fc2xvdHMubGVuZ3RoO2ZvcihsZXQgcz0wO3M8ZTtzKyspe2NvbnN0IGU9dGhpcy5fX3Nsb3RzW3NdO2UmJmUoLi4udCl9fWlzVG9nZ2xlZCgpe3JldHVybiB0aGlzLl9fdG9nZ2xlZH1zZXRUb2dnbGVkKHQpe3RoaXMuX190b2dnbGVkPXQsdGhpcy5fX2RhdGE9dm9pZCAwfWdldE51bUNvbm5lY3Rpb25zKCl7cmV0dXJuIHRoaXMuX19zbG90cy5sZW5ndGh9dW50b2dnbGUoKXt0aGlzLl9fdG9nZ2xlZD0hMSx0aGlzLl9fZGF0YT12b2lkIDB9fWNvbnN0IEk9bmV3IGNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5fX3JlZ2lzdGVyZWRDbGFzc2VzPXt9LHRoaXMuX19jbGFzc05hbWVzPXt9LHRoaXMuX19jbGFzc0xpc3Q9W119cmVnaXN0ZXJDbGFzcyh0LGUpe3RoaXMuX19yZWdpc3RlcmVkQ2xhc3Nlc1t0XT17Y2xzOmUsY2FsbGJhY2tzOltdfTtjb25zdCBzPXRoaXMuX19jbGFzc0xpc3QubGVuZ3RoO3RoaXMuX19jbGFzc0xpc3QucHVzaChlKSx0aGlzLl9fY2xhc3NOYW1lc1tzXT10fWdldENsYXNzKHQpe2lmKHRoaXMuX19yZWdpc3RlcmVkQ2xhc3Nlc1t0XSlyZXR1cm4gdGhpcy5fX3JlZ2lzdGVyZWRDbGFzc2VzW3RdLmNsc31nZXRDbGFzc05hbWUodCl7Y29uc3QgZT10aGlzLl9fY2xhc3NMaXN0LmluZGV4T2YodC5jb25zdHJ1Y3Rvcik7cmV0dXJuIHRoaXMuX19jbGFzc05hbWVzW2VdP3RoaXMuX19jbGFzc05hbWVzW2VdOihjb25zb2xlLndhcm4oIkNsYXNzIG5vdCByZWdpc3RlcmVkOiIsdC5jb25zdHJ1Y3Rvci5uYW1lKSx0LmNvbnN0cnVjdG9yLm5hbWUpfWNvbnN0cnVjdENsYXNzKHQpe2NvbnN0IGU9dGhpcy5fX3JlZ2lzdGVyZWRDbGFzc2VzW3RdO2lmKCFlKXJldHVybiBjb25zb2xlLndhcm4oIkZhY3Rvcnkgbm90IHJlZ2lzdGVyZWQ6Iit0KSxudWxsO3RoaXMuX19jb25zdHJ1Y3Rpbmc9ITA7Y29uc3Qgcz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSksYT1uZXcgZS5jbHMoLi4ucyk7cmV0dXJuIHRoaXMuX19jb25zdHJ1Y3Rpbmc9ITEsYX19LE49MyxGPTI7bGV0IHo9MDtjbGFzcyBWe2NvbnN0cnVjdG9yKHQsZSxzKXtpZih0aGlzLl9fZGF0YVR5cGU9dCx0aGlzLm5vcm1hbGl6ZWQ9ITEsbnVsbCE9dC5udW1FbGVtZW50cyl0aGlzLl9fZGltZW5zaW9uPXRoaXMuX19kYXRhVHlwZS5udW1FbGVtZW50cygpO2Vsc2Ugc3dpdGNoKHQpe2Nhc2UgNjpjYXNlIDQ6Y2FzZSA1OnRoaXMuX19kaW1lbnNpb249MTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcigiSW52YWxpZCBkYXRhIHR5cGUgZm9yIGF0dHJpYnV0ZToiK3QpfXZhciBhO3RoaXMuX19kZWZhdWx0RWxlbWVudFZhbHVlPW51bGwhPXM/czpOdW1iZXIuTUFYX1ZBTFVFLChhPWUpJiZ2b2lkIDAhPT1hLmJ5dGVMZW5ndGg/dGhpcy5fX2RhdGE9ZToodGhpcy5fX2RhdGE9bmV3IEZsb2F0MzJBcnJheShlKnRoaXMuX19kaW1lbnNpb24pLHRoaXMuaW5pdFJhbmdlKDApKX1yZXNpemUodCl7Y29uc3QgZT10aGlzLl9fZGF0YS5sZW5ndGgscz10KnRoaXMuX19kaW1lbnNpb24sYT1uZXcgRmxvYXQzMkFycmF5KHMpO2ZvcihsZXQgdD0wO3Q8TWF0aC5taW4odGhpcy5fX2RhdGEubGVuZ3RoLHMpO3QrKylhW3RdPXRoaXMuX19kYXRhW3RdO3RoaXMuX19kYXRhLmxlbmd0aDxzJiYodGhpcy5fX2RhdGE9YSksdGhpcy5pbml0UmFuZ2UoZSl9aW5pdFJhbmdlKHQpe2ZvcihsZXQgZT10O2U8dGhpcy5fX2RhdGEubGVuZ3RoO2UrKyl0aGlzLl9fZGF0YVtlXT10aGlzLl9fZGVmYXVsdEVsZW1lbnRWYWx1ZX1nZXRDb3VudCgpe3JldHVybiB0aGlzLl9fZGF0YS5sZW5ndGgvdGhpcy5fX2RpbWVuc2lvbn1nZXQgbGVuZ3RoKCl7cmV0dXJuIHRoaXMuX19kYXRhLmxlbmd0aC90aGlzLl9fZGltZW5zaW9ufWdldCBkYXRhVHlwZSgpe3JldHVybiB0aGlzLl9fZGF0YVR5cGV9Z2V0IGRhdGEoKXtyZXR1cm4gdGhpcy5fX2RhdGF9c2V0IGRhdGEodCl7dGhpcy5fX2RhdGE9dH1nZXQgbnVtRWxlbWVudHMoKXtyZXR1cm4gdGhpcy5fX2RpbWVuc2lvbn1nZXRGbG9hdDMyVmFsdWUodCl7cmV0dXJuIHRoaXMuX19kYXRhW3RdfXNldEZsb2F0MzJWYWx1ZSh0LGUpe3RoaXMuX19kYXRhW3RdPWV9Z2V0VmFsdWVSZWYodCl7Y29uc3QgZT10aGlzLl9fZGltZW5zaW9uO2lmKHQ+PXRoaXMuX19kYXRhLmxlbmd0aC9lKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCB2ZXJ0ZXggaW5kZXg6Iit0KyIuIE51bSBWZXJ0aWNlczoiK3RoaXMuX19kYXRhLmxlbmd0aC8zKTtyZXR1cm4gdGhpcy5fX2RhdGFUeXBlLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMuX19kYXRhLmJ1ZmZlcix0KmUpfXNldFZhbHVlKHQsZSl7Y29uc3Qgcz10aGlzLl9fZGltZW5zaW9uO2lmKHQ+PXRoaXMuX19kYXRhLmxlbmd0aC9zKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCB2ZXJ0ZXggaW5kZXg6Iit0KyIuIE51bSBWZXJ0aWNlczoiK3RoaXMuX19kYXRhLmxlbmd0aC8zKTt0aGlzLl9fZGF0YVR5cGUuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy5fX2RhdGEuYnVmZmVyLHQqcykuc2V0RnJvbU90aGVyKGUpfXRvSlNPTih0LGUpe3JldHVybntkYXRhOkFycmF5LmZyb20odGhpcy5fX2RhdGEpLGRhdGFUeXBlOmEuZ2V0VHlwZU5hbWUodGhpcy5fX2RhdGFUeXBlKSxkZWZhdWx0VmFsdWU6dGhpcy5fX2RlZmF1bHRFbGVtZW50VmFsdWUsbGVuZ3RoOnRoaXMuX19kYXRhLmxlbmd0aC90aGlzLl9fZGltZW5zaW9ufX1mcm9tSlNPTih0KXt0aGlzLl9fZGF0YT1GbG9hdDMyQXJyYXkuZnJvbSh0LmRhdGEpfXRvU3RyaW5nKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCksbnVsbCwyKX19Y2xhc3MgTSBleHRlbmRzIGNsYXNze2NvbnN0cnVjdG9yKCl7dGhpcy5fX2lkPSsreix0aGlzLl9fcGFyYW1zPVtdLHRoaXMuX19wYXJhbU1hcHBpbmc9e30sdGhpcy5fX3BhcmFtU2lnbmFsSWRzPXt9LHRoaXMucGFyYW1ldGVyQWRkZWQ9bmV3IHcsdGhpcy5wYXJhbWV0ZXJSZW1vdmVkPW5ldyB3LHRoaXMucGFyYW1ldGVyVmFsdWVDaGFuZ2VkPW5ldyB3fWdldElkKCl7cmV0dXJuIHRoaXMuX19pZH1udW1QYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX19wYXJhbXMubGVuZ3RofWdldFBhcmFtZXRlcnMoKXtyZXR1cm4gdGhpcy5fX3BhcmFtc31nZXRQYXJhbWV0ZXJJbmRleCh0KXtyZXR1cm4gdGhpcy5fX3BhcmFtTWFwcGluZ1t0XX1nZXRQYXJhbWV0ZXJCeUluZGV4KHQpe3JldHVybiB0aGlzLl9fcGFyYW1zW3RdfWhhc1BhcmFtZXRlcih0KXtyZXR1cm4gdCBpbiB0aGlzLl9fcGFyYW1NYXBwaW5nfWdldFBhcmFtZXRlcih0KXtjb25zdCBlPXRoaXMuX19wYXJhbU1hcHBpbmdbdF07cmV0dXJuLTE9PWU/bnVsbDp0aGlzLl9fcGFyYW1zW2VdfV9fcGFyYW1ldGVyVmFsdWVDaGFuZ2VkKHQsZSl7dGhpcy5wYXJhbWV0ZXJWYWx1ZUNoYW5nZWQuZW1pdCh0LGUpfWFkZFBhcmFtZXRlcih0KXtjb25zdCBlPXQuZ2V0TmFtZSgpO3JldHVybiBudWxsIT10aGlzLl9fcGFyYW1NYXBwaW5nW2VdJiYoY29uc29sZS53YXJuKCJSZXBsYWNpbmcgUGFyYW1ldGVyOiIrZSksdGhpcy5yZW1vdmVQYXJhbWV0ZXIoZSkpLHRoaXMuX19wYXJhbVNpZ25hbElkc1tlXT10LnZhbHVlQ2hhbmdlZC5jb25uZWN0KGU9PnRoaXMuX19wYXJhbWV0ZXJWYWx1ZUNoYW5nZWQodCxlKSksdGhpcy5fX3BhcmFtcy5wdXNoKHQpLHRoaXMuX19wYXJhbU1hcHBpbmdbZV09dGhpcy5fX3BhcmFtcy5sZW5ndGgtMSx0aGlzLnBhcmFtZXRlckFkZGVkLmVtaXQoZSksdH1pbnNlcnRQYXJhbWV0ZXIodCxlKXtjb25zdCBzPXQuZ2V0TmFtZSgpO251bGwhPXRoaXMuX19wYXJhbU1hcHBpbmdbc10mJihjb25zb2xlLndhcm4oIlJlcGxhY2luZyBQYXJhbWV0ZXI6IitzKSx0aGlzLnJlbW92ZVBhcmFtZXRlcihzKSksdGhpcy5fX3BhcmFtU2lnbmFsSWRzW3NdPXQudmFsdWVDaGFuZ2VkLmNvbm5lY3QoZT0+dGhpcy5fX3BhcmFtZXRlclZhbHVlQ2hhbmdlZCh0LGUpKSx0aGlzLl9fcGFyYW1zLnNwbGljZShlLDAsdCk7Y29uc3QgYT17fTtmb3IobGV0IHQ9MDt0PHRoaXMuX19wYXJhbXMubGVuZ3RoO3QrKylhW3RoaXMuX19wYXJhbXNbdF0uZ2V0TmFtZSgpXT10O3JldHVybiB0aGlzLl9fcGFyYW1NYXBwaW5nPWEsdGhpcy5wYXJhbWV0ZXJBZGRlZC5lbWl0KHMpLHR9cmVtb3ZlUGFyYW1ldGVyKHQpe251bGw9PXRoaXMuX19wYXJhbU1hcHBpbmdbdF0mJmNvbnNvbGUudGhyb3coIlVuYWJsZSB0byBSZW1vdmUgUGFyYW1ldGVyOiIrdCk7Y29uc3QgZT10aGlzLl9fcGFyYW1NYXBwaW5nW3RdO3RoaXMuX19wYXJhbXNbdGhpcy5fX3BhcmFtTWFwcGluZ1t0XV0udmFsdWVDaGFuZ2VkLmRpc2Nvbm5lY3RJZCh0aGlzLl9fcGFyYW1TaWduYWxJZHNbdF0pLHRoaXMuX19wYXJhbXMuc3BsaWNlKGUsMSk7Y29uc3Qgcz17fTtmb3IobGV0IHQ9MDt0PHRoaXMuX19wYXJhbXMubGVuZ3RoO3QrKylzW3RoaXMuX19wYXJhbXNbdF0uZ2V0TmFtZSgpXT10O3RoaXMuX19wYXJhbU1hcHBpbmc9cyx0aGlzLnBhcmFtZXRlclJlbW92ZWQuZW1pdCh0KX1yZXBsYWNlUGFyYW1ldGVyKHQpe2NvbnN0IGU9dC5nZXROYW1lKCkscz10aGlzLl9fcGFyYW1NYXBwaW5nW2VdO3JldHVybiB0aGlzLl9fcGFyYW1zW3RoaXMuX19wYXJhbU1hcHBpbmdbZV1dLnZhbHVlQ2hhbmdlZC5kaXNjb25uZWN0SWQodGhpcy5fX3BhcmFtU2lnbmFsSWRzW2VdKSx0aGlzLl9fcGFyYW1TaWduYWxJZHNbZV09dC52YWx1ZUNoYW5nZWQuY29ubmVjdChlPT50aGlzLl9fcGFyYW1ldGVyVmFsdWVDaGFuZ2VkKHQsZSkpLHRoaXMuX19wYXJhbXNbc109dCx0fXRvSlNPTih0LGUpe2NvbnN0IHM9e307bGV0IGE9MDtmb3IoY29uc3QgaSBvZiB0aGlzLl9fcGFyYW1zKWlmKGkudGVzdEZsYWcoRikpaWYoaS5udW1SZWZzKCk+MSYmMCE9aS5nZXRSZWZJbmRleCh0aGlzKSlzW2kuZ2V0TmFtZSgpXT17cGFyYW1QYXRoOnQubWFrZVJlbGF0aXZlKGkuZ2V0UGF0aCgpKX0sYSsrO2Vsc2V7Y29uc3Qgcj1pLnRvSlNPTih0LGUpO3ImJihzW2kuZ2V0TmFtZSgpXT1yLGErKyl9aWYoYT4wKXJldHVybntwYXJhbXM6c319ZnJvbUpTT04odCxlLHMpe2lmKHQucGFyYW1zKWZvcihjb25zdCBzIGluIHQucGFyYW1zKXtjb25zdCBhPXQucGFyYW1zW3NdLGk9dGhpcy5nZXRQYXJhbWV0ZXIocyk7aT9hLnBhcmFtUGF0aD9lLnJlc29sdmVQYXRoKGEucGFyYW1QYXRoLHQ9Pnt0aGlzLnJlcGxhY2VQYXJhbWV0ZXIodCl9LHQ9Pntjb25zb2xlLndhcm4oIlVuYWJsZSB0byByZXNvbHZlIHNoYXJlZCBwYXJhbWV0ZXI6IithLnBhcmFtUGF0aCl9KTppLmZyb21KU09OKGEsZSk6Y29uc29sZS53YXJuKCJQYXJhbSBub3QgZm91bmQ6IitzKX19cmVhZEJpbmFyeSh0LGUpe2lmKGUudmVyc2lvbnNbInplYS1lbmdpbmUiXS5ncmVhdGVyT3JFcXVhbFRoYW4oWzAsMCwzXSkpe2NvbnN0IHM9dC5sb2FkVUludDMyKCk7Zm9yKGxldCBhPTA7YTxzO2ErKyl7Y29uc3Qgcz10LmxvYWRTdHIoKSxhPXQubG9hZFN0cigpO2xldCBpPXRoaXMuZ2V0UGFyYW1ldGVyKGEpO2lmKCFpKXtpZihpPUkuY29uc3RydWN0Q2xhc3MocyxhKSwhaSl7Y29uc29sZS5lcnJvcigiVW5hYmxlIHRvIGNvbnN0cnVjdCBwcm9wOiIrYSsiIG9mIHR5cGU6IitzKTtjb250aW51ZX10aGlzLmFkZFBhcmFtZXRlcihpKX1pLnJlYWRCaW5hcnkodCxlKX19fXRvU3RyaW5nKCl7cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCksbnVsbCwyKX1jb3B5RnJvbSh0LGUpe2xldCBzPXQubnVtUGFyYW1ldGVycygpO2Zvcig7cy0tOyl7Y29uc3QgZT10LmdldFBhcmFtZXRlckJ5SW5kZXgocyksYT10aGlzLmdldFBhcmFtZXRlcihlLmdldE5hbWUoKSk7YT9hLnNldFZhbHVlKGUuZ2V0VmFsdWUoKSxOKTp0aGlzLmFkZFBhcmFtZXRlcihlLmNsb25lKCkpfX1kZXN0cm95KCl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fX3BhcmFtcyl0LmRlc3Ryb3koKTtzdXBlci5kZXN0cm95KCl9fXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCksdGhpcy5fX2JvdW5kaW5nQm94PW5ldyBwLHRoaXMuX19ib3VuZGluZ0JveERpcnR5PSEwLHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzPW5ldyBNYXAsdGhpcy5fX21ldGFEYXRhPW5ldyBNYXAsdGhpcy5hZGRWZXJ0ZXhBdHRyaWJ1dGUoInBvc2l0aW9ucyIsciwwKSx0aGlzLmJvdW5kaW5nQm94RGlydGllZD1uZXcgdyx0aGlzLmdlb21EYXRhQ2hhbmdlZD1uZXcgdyx0aGlzLmdlb21EYXRhVG9wb2xvZ3lDaGFuZ2VkPW5ldyB3fXNldERlYnVnTmFtZSh0KXt0aGlzLl9fbmFtZT10fWFkZFZlcnRleEF0dHJpYnV0ZSh0LGUscyl7bGV0IGE7dmFyIGk7cmV0dXJuIGE9KGk9cykmJnZvaWQgMCE9PWkuYnl0ZUxlbmd0aD9uZXcgVihlLHMpOm5ldyBWKGUsbnVsbCE9dGhpcy52ZXJ0aWNlcz90aGlzLnZlcnRpY2VzLmxlbmd0aDowLHMpLHRoaXMuX192ZXJ0ZXhBdHRyaWJ1dGVzLnNldCh0LGEpLGF9aGFzVmVydGV4QXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5oYXModCl9Z2V0VmVydGV4QXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5nZXQodCl9Z2V0VmVydGV4QXR0cmlidXRlcyh0KXtjb25zdCBlPXt9O2Zvcihjb25zdFt0LHNdb2YgdGhpcy5fX3ZlcnRleEF0dHJpYnV0ZXMuZW50cmllcygpKWVbdF09cztyZXR1cm4gZX1nZXQgdmVydGljZXMoKXtyZXR1cm4gdGhpcy5fX3ZlcnRleEF0dHJpYnV0ZXMuZ2V0KCJwb3NpdGlvbnMiKX1udW1WZXJ0aWNlcygpe3JldHVybiB0aGlzLnZlcnRpY2VzLmxlbmd0aH1nZXROdW1WZXJ0aWNlcygpe3JldHVybiB0aGlzLnZlcnRpY2VzLmxlbmd0aH1zZXROdW1WZXJ0aWNlcyh0KXt0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5mb3JFYWNoKGU9PmUucmVzaXplKHQpKX1nZXRWZXJ0ZXgodCl7cmV0dXJuIHIuY3JlYXRlRnJvbUZsb2F0MzJCdWZmZXIodGhpcy52ZXJ0aWNlcy5kYXRhLmJ1ZmZlciwzKnQpfXNldFZlcnRleCh0LGUpe3JldHVybiByLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHRoaXMudmVydGljZXMuZGF0YS5idWZmZXIsMyp0KS5zZXRGcm9tT3RoZXIoZSl9bW92ZVZlcnRpY2VzKHQpe2NvbnN0IGU9dGhpcy52ZXJ0aWNlcztmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKyllLmdldFZhbHVlUmVmKHMpLmFkZEluUGxhY2UodCk7dGhpcy5zZXRCb3VuZGluZ0JveERpcnR5KCl9dHJhbnNmb3JtVmVydGljZXModCl7Y29uc3QgZT10aGlzLnZlcnRpY2VzO2ZvcihsZXQgcz0wO3M8ZS5sZW5ndGg7cysrKXtjb25zdCBhPWUuZ2V0VmFsdWVSZWYocyksaT10LnRyYW5zZm9ybVZlYzMoYSk7YS5zZXQoaS54LGkueSxpLnopfXRoaXMuc2V0Qm91bmRpbmdCb3hEaXJ0eSgpfWdldCBib3VuZGluZ0JveCgpe3JldHVybiB0aGlzLl9fYm91bmRpbmdCb3hEaXJ0eSYmdGhpcy51cGRhdGVCb3VuZGluZ0JveCgpLHRoaXMuX19ib3VuZGluZ0JveH1zZXRCb3VuZGluZ0JveERpcnR5KCl7dGhpcy5fX2JvdW5kaW5nQm94RGlydHk9ITAsdGhpcy5ib3VuZGluZ0JveERpcnRpZWQuZW1pdCgpfXVwZGF0ZUJvdW5kaW5nQm94KCl7Y29uc3QgdD10aGlzLnZlcnRpY2VzLGU9bmV3IHAscz10Lmxlbmd0aDtmb3IobGV0IGE9MDthPHM7YSsrKWUuYWRkUG9pbnQodC5nZXRWYWx1ZVJlZihhKSk7dGhpcy5fX2JvdW5kaW5nQm94PWUsdGhpcy5fX2JvdW5kaW5nQm94RGlydHk9ITF9Z2V0TWV0YWRhdGEodCl7cmV0dXJuIHRoaXMuX19tZXRhRGF0YS5nZXQodCl9aGFzTWV0YWRhdGEodCl7cmV0dXJuIHRoaXMuX19tZXRhRGF0YS5oYXModCl9c2V0TWV0YWRhdGEodCxlKXt0aGlzLl9fbWV0YURhdGEuc2V0KHQsZSl9ZGVsZXRlTWV0YWRhdGEodCl7dGhpcy5fX21ldGFEYXRhLmRlbGV0ZSh0KX1nZW5CdWZmZXJzKHQpe2NvbnN0IGU9e307Zm9yKGNvbnN0W3Qsc11vZiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcyllW3RdPXt2YWx1ZXM6cy5kYXRhLGNvdW50OnMuc2l6ZSxkYXRhVHlwZTpzLmRhdGFUeXBlLG5vcm1hbGl6ZWQ6cy5ub3JtYWxpemVkfTtyZXR1cm57bnVtVmVydGljZXM6dGhpcy5udW1WZXJ0aWNlcygpLGF0dHJCdWZmZXJzOmV9fWZyZWVCdWZmZXJzKCl7fWxvYWRCYXNlR2VvbUJpbmFyeSh0KXt0aGlzLm5hbWU9dC5sb2FkU3RyKCk7Y29uc3QgZT10LmxvYWRVSW50OCgpO3RoaXMuZGVidWdDb2xvcj10LmxvYWRSR0JGbG9hdDMyQ29sb3IoKTtjb25zdCBzPXQubG9hZFVJbnQzMigpO3RoaXMuX19ib3VuZGluZ0JveC5zZXQodC5sb2FkRmxvYXQzMlZlYzMoKSx0LmxvYWRGbG9hdDMyVmVjMygpKSx0aGlzLnNldE51bVZlcnRpY2VzKHMpO2NvbnN0IGE9dGhpcy52ZXJ0aWNlcztsZXQgbixoOzImZSYmKG49dGhpcy5nZXRWZXJ0ZXhBdHRyaWJ1dGUoIm5vcm1hbHMiKSxufHwobj10aGlzLmFkZFZlcnRleEF0dHJpYnV0ZSgibm9ybWFscyIsciwwKSkpLDQmZSYmKGg9dGhpcy5nZXRWZXJ0ZXhBdHRyaWJ1dGUoInRleENvb3JkcyIpLGh8fChoPXRoaXMuYWRkVmVydGV4QXR0cmlidXRlKCJ0ZXhDb29yZHMiLGksMCkpKTtjb25zdCBvPSh0LGUscyxpKT0+e2ZvcihsZXQgbj10WzBdO248dFsxXTtuKyspe2NvbnN0IHQ9bmV3IHIoaVszKm4rMF0vMjU1LGlbMypuKzFdLzI1NSxpWzMqbisyXS8yNTUpO3QubXVsdGlwbHlJblBsYWNlKHMpLHQuYWRkSW5QbGFjZShlKSxhLnNldFZhbHVlKG4sdCl9fSxfPSh0LGUscyxhKT0+e3MuaXNOdWxsKCkmJnMuc2V0KDEsMSwxKTtmb3IobGV0IGk9dFswXTtpPHRbMV07aSsrKXtjb25zdCB0PW5ldyByKGFbMyppKzBdLzI1NSxhWzMqaSsxXS8yNTUsYVszKmkrMl0vMjU1KTt0Lm11bHRpcGx5SW5QbGFjZShzKSx0LmFkZEluUGxhY2UoZSksdC5ub3JtYWxpemVJblBsYWNlKCksbi5zZXRWYWx1ZShpLHQpfX0sZD0odCxlLHMsYSk9Pntmb3IobGV0IHI9dFswXTtyPHRbMV07cisrKXtjb25zdCB0PW5ldyBpKGFbMipyKzBdLzI1NSxhWzIqcisxXS8yNTUpO3QubXVsdGlwbHlJblBsYWNlKHMpLHQuYWRkSW5QbGFjZShlKSxoLnNldFZhbHVlKHIsdCl9fSxsPXQubG9hZFVJbnQzMigpO2lmKDE9PWwpe3tjb25zdCBlPXRoaXMuX19ib3VuZGluZ0JveCxhPXQubG9hZFVJbnQ4QXJyYXkoMypzKTtvKFswLHNdLGUucDAsZS5kaWFnb25hbCgpLGEpfWlmKG4pe2NvbnN0IGU9bmV3IHAodC5sb2FkRmxvYXQzMlZlYzMoKSx0LmxvYWRGbG9hdDMyVmVjMygpKSxhPXQubG9hZFVJbnQ4QXJyYXkoMypzKTtfKFswLHNdLGUucDAsZS5kaWFnb25hbCgpLGEpLG4ubG9hZFNwbGl0VmFsdWVzKHQpfWlmKGgpe2NvbnN0IGU9bmV3IGcodC5sb2FkRmxvYXQzMlZlYzIoKSx0LmxvYWRGbG9hdDMyVmVjMigpKSxhPXQubG9hZFVJbnQ4QXJyYXkoMipzKTtkKFswLHNdLGUucDAsZS5kaWFnb25hbCgpLGEpLGgubG9hZFNwbGl0VmFsdWVzKHQpfX1lbHNle2NvbnN0IGU9W107bGV0IGE9MDtmb3IobGV0IHM9MDtzPGw7cysrKXtjb25zdCBzPXQubG9hZFVJbnQzMigpLGk9e3JhbmdlOlthLGErc10sYmJveDpuZXcgcCh0LmxvYWRGbG9hdDMyVmVjMygpLHQubG9hZEZsb2F0MzJWZWMzKCkpfTtuJiYoaS5ub3JtYWxzUmFuZ2U9bmV3IHAodC5sb2FkRmxvYXQzMlZlYzMoKSx0LmxvYWRGbG9hdDMyVmVjMygpKSksaCYmKGkudGV4Q29vcmRzUmFuZ2U9bmV3IGcodC5sb2FkRmxvYXQzMlZlYzIoKSx0LmxvYWRGbG9hdDMyVmVjMigpKSksZS5wdXNoKGkpLGErPXN9Y29uc3QgaT10LmxvYWRVSW50OEFycmF5KDMqcyk7bGV0IHIsYztuJiYocj10LmxvYWRVSW50OEFycmF5KDMqcykpLGgmJihjPXQubG9hZFVJbnQ4QXJyYXkoMipzKSk7Zm9yKGxldCB0PTA7dDxsO3QrKyl7e2NvbnN0IHM9ZVt0XS5iYm94O28oZVt0XS5yYW5nZSxzLnAwLHMuZGlhZ29uYWwoKSxpKX1pZihuKXtjb25zdCBzPWVbdF0ubm9ybWFsc1JhbmdlO18oZVt0XS5yYW5nZSxzLnAwLHMuZGlhZ29uYWwoKSxyKX1pZihoKXtjb25zdCBzPWVbdF0udGV4Q29vcmRzUmFuZ2U7ZChlW3RdLnJhbmdlLHMucDAscy5kaWFnb25hbCgpLGMpfX1uJiZuLmxvYWRTcGxpdFZhbHVlcyh0KSxoJiZoLmxvYWRTcGxpdFZhbHVlcyh0KX19dG9KU09OKHQsZSl7bGV0IHM9c3VwZXIudG9KU09OKHQsZSk7aWYoc3x8KHM9e30pLHMudHlwZT1JLmdldENsYXNzTmFtZSh0aGlzKSwhKDEwMjQmZSkpe2NvbnN0IGE9e307Zm9yKGNvbnN0W3MsaV1vZiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5lbnRyaWVzKCkpYVtzXT1pLnRvSlNPTih0LGUpO3MudmVydGV4QXR0cmlidXRlcz1hfXJldHVybiBzfWZyb21KU09OKHQsZSxzKXtzdXBlci5mcm9tSlNPTih0LGUscyk7Zm9yKGNvbnN0IGUgaW4gdC52ZXJ0ZXhBdHRyaWJ1dGVzKXtsZXQgcz10aGlzLl9fdmVydGV4QXR0cmlidXRlcy5nZXQoZSk7Y29uc3QgaT10LnZlcnRleEF0dHJpYnV0ZXNbZV07aWYoIXMpe2NvbnN0IHQ9YS5nZXRUeXBlKGkuZGF0YVR5cGUpO3M9bmV3IFZlcnRleEF0dHJpYnV0ZSh0aGlzLHQsMCxpLmRlZmF1bHRTY2FsYXJWYWx1ZSksdGhpcy5fX3ZlcnRleEF0dHJpYnV0ZXMuc2V0KGUscyl9cy5mcm9tSlNPTihpKX19dG9TdHJpbmcoKXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy50b0pTT04oKSxudWxsLDIpfX1jbGFzcyBBIGV4dGVuZHMgTXtjb25zdHJ1Y3Rvcigpe3N1cGVyKCl9bG9hZEJpbih0KXt0aGlzLm5hbWU9dC5sb2FkU3RyKCk7Y29uc3QgZT10LmxvYWRVSW50MzIoKTt0aGlzLl9fYm91bmRpbmdCb3guc2V0KHQubG9hZEZsb2F0MzJWZWMzKCksdC5sb2FkRmxvYXQzMlZlYzMoKSksdGhpcy5zZXROdW1WZXJ0aWNlcyhlKTtjb25zdCBzPXRoaXMudmVydGljZXM7aWYoZTwyNTYpe2NvbnN0IGE9dGhpcy5fX2JvdW5kaW5nQm94LnRvTWF0NCgpLGk9dC5sb2FkVUludDhBcnJheSgzKmUpO2ZvcihsZXQgdD0wO3Q8ZTt0Kyspe2NvbnN0IGU9bmV3IFZlYzMoaVszKnQrMF0vMjU1LGlbMyp0KzFdLzI1NSxpWzMqdCsyXS8yNTUpO3Muc2V0VmFsdWUodCxhLnRyYW5zZm9ybVZlYzMoZSkpfX1lbHNle2NvbnN0IGE9dC5sb2FkVUludDMyKCksaT1bXTtmb3IobGV0IGU9MDtlPGE7ZSsrKXtjb25zdCBlPXQubG9hZFVJbnQzMlZlYzIoKSxzPXQubG9hZEZsb2F0MzJWZWMzKCksYT10LmxvYWRGbG9hdDMyVmVjMygpO2kucHVzaCh7cmFuZ2U6ZSxiYm94Om5ldyBCb3gzKHMsYSl9KX1jb25zdCByPXQubG9hZFVJbnQ4QXJyYXkoMyplKTtmb3IobGV0IHQ9MDt0PGE7dCsrKXtjb25zdCBlPWlbdF0uYmJveC50b01hdDQoKTtmb3IobGV0IGE9aVt0XS5yYW5nZS54O2E8aVt0XS5yYW5nZS55O2ErKyl7Y29uc3QgdD1uZXcgVmVjMyhyWzMqYSswXS8yNTUsclszKmErMV0vMjU1LHJbMyphKzJdLzI1NSk7cy5zZXRWYWx1ZShhLGUudHJhbnNmb3JtVmVjMyh0KSl9fX19cmVhZEJpbmFyeSh0LGUpe3N1cGVyLmxvYWRCYXNlR2VvbUJpbmFyeSh0KSx0aGlzLmdlb21EYXRhQ2hhbmdlZC5lbWl0KCl9fWNsYXNzIFMgZXh0ZW5kcyBNe2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLl9faW5kaWNlcz1uZXcgVWludDMyQXJyYXksdGhpcy5fX3NlZ21lbnRBdHRyaWJ1dGVzPW5ldyBNYXAsdGhpcy5saW5lVGhpY2tuZXNzPTB9Z2V0SW5kaWNlcygpe3JldHVybiB0aGlzLl9faW5kaWNlc31nZXROdW1TZWdtZW50cygpe3JldHVybiB0aGlzLl9faW5kaWNlcy5sZW5ndGgvMn1zZXROdW1TZWdtZW50cyh0KXtjb25zdCBlPW5ldyBVaW50MzJBcnJheSgyKnQpO3RoaXMuX19pbmRpY2VzPWV9c2V0U2VnbWVudCh0LGUscyl7aWYodD49dGhpcy5fX2luZGljZXMubGVuZ3RoLzIpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGxpbmUgaW5kZXg6Iit0KyIuIE51bSBTZWdtZW50czoiK3RoaXMuX19pbmRpY2VzLmxlbmd0aC8yKTt0aGlzLl9faW5kaWNlc1syKnQrMF09ZSx0aGlzLl9faW5kaWNlc1syKnQrMV09c31nZXRTZWdtZW50VmVydGV4SW5kZXgodCxlKXtpZih0PHRoaXMubnVtTGluZXMpcmV0dXJuIHRoaXMuX19pbmRpY2VzWzIqdCtlXX1hZGRTZWdtZW50QXR0cmlidXRlKHQsZSxzKXtjb25zdCBhPW5ldyBBdHRyaWJ1dGUoZSxudWxsIT1zP3M6dGhpcy5wb2x5Z29uQ291bnQpO3JldHVybiB0aGlzLl9fc2VnbWVudEF0dHJpYnV0ZXMuc2V0KHQsYSksYX1oYXNTZWdtZW50QXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fc2VnbWVudEF0dHJpYnV0ZXMuaGFzKHQpfWdldFNlZ21lbnRBdHRyaWJ1dGUodCl7cmV0dXJuIHRoaXMuX19zZWdtZW50QXR0cmlidXRlcy5nZXQodCl9Z2VuQnVmZmVycygpe2NvbnN0IHQ9c3VwZXIuZ2VuQnVmZmVycygpO2xldCBlO3JldHVybiB0Lm51bVZlcnRpY2VzPE1hdGgucG93KDIsOCk/KGU9bmV3IFVpbnQ4QXJyYXkodGhpcy5fX2luZGljZXMubGVuZ3RoKSx0aGlzLl9faW5kaWNlcy5mb3JFYWNoKCh0LHMpPT57ZVtzXT10fSkpOnQubnVtVmVydGljZXM8TWF0aC5wb3coMiwxNik/KGU9bmV3IFVpbnQxNkFycmF5KHRoaXMuX19pbmRpY2VzLmxlbmd0aCksdGhpcy5fX2luZGljZXMuZm9yRWFjaCgodCxzKT0+e2Vbc109dH0pKTplPXRoaXMuX19pbmRpY2VzLHQuaW5kaWNlcz1lLHR9cmVhZEJpbmFyeSh0LGUpe3N1cGVyLmxvYWRCYXNlR2VvbUJpbmFyeSh0KSx0aGlzLnNldE51bVNlZ21lbnRzKHQubG9hZFVJbnQzMigpKTtjb25zdCBzPXQubG9hZFVJbnQ4KCk7MT09cz90aGlzLl9faW5kaWNlcz10LmxvYWRVSW50OEFycmF5KCk6Mj09cz90aGlzLl9faW5kaWNlcz10LmxvYWRVSW50MTZBcnJheSgpOjQ9PXMmJih0aGlzLl9faW5kaWNlcz10LmxvYWRVSW50MzJBcnJheSgpKSx0aGlzLmdlb21EYXRhQ2hhbmdlZC5lbWl0KCl9dG9KU09OKHQsZSl7Y29uc3Qgcz1zdXBlci50b0pTT04odCxlKTtyZXR1cm4gMTAyNCZlfHwocy5pbmRpY2VzPUFycmF5LmZyb20odGhpcy5fX2luZGljZXMpKSxzfWZyb21KU09OKHQsZSxzKXtzdXBlci5mcm9tSlNPTih0LGUscyksdGhpcy5fX2luZGljZXM9VWludDMyQXJyYXkuZnJvbSh0LmluZGljZXMpfX1jbGFzcyBPIGV4dGVuZHMgVntjb25zdHJ1Y3Rvcih0LGUscyxhKXtzdXBlcihlLHMsYSksdGhpcy5fX2dlb209dCx0aGlzLl9fc3BsaXRzPXt9LHRoaXMuX19zcGxpdFZhbHVlcz1bXX1nZXRGYWNlVmVydGV4VmFsdWVSZWYodCxlKXtjb25zdCBzPXRoaXMuX19nZW9tLmdldEZhY2VWZXJ0ZXhJbmRleCh0LGUpO3JldHVybiBzIGluIHRoaXMuX19zcGxpdHMmJnQgaW4gdGhpcy5fX3NwbGl0c1tzXT90aGlzLl9fc3BsaXRWYWx1ZXNbdGhpcy5fX3NwbGl0c1tzXVt0XV06dGhpcy5nZXRWYWx1ZVJlZihzKX1zZXRGYWNlVmVydGV4VmFsdWUodCxlLHMpe2NvbnN0IGE9dGhpcy5fX2dlb20uZ2V0RmFjZVZlcnRleEluZGV4KHQsZSk7dGhpcy5zZXRGYWNlVmVydGV4VmFsdWVfQnlWZXJ0ZXhJbmRleCh0LGEscyl9c2V0RmFjZVZlcnRleFZhbHVlX0J5VmVydGV4SW5kZXgodCxlLHMpe2NvbnN0IGE9dGhpcy5nZXRWYWx1ZVJlZihlKTtpZihhLmlzVmFsaWQoKSlpZihhLmFwcHJveEVxdWFsKHMpKTtlbHNle2lmKGUgaW4gdGhpcy5fX3NwbGl0cyl7Y29uc3QgYT10aGlzLl9fc3BsaXRzW2VdO2Zvcihjb25zdCBlIGluIGEpe2NvbnN0IGk9YVtlXTtpZih0aGlzLl9fc3BsaXRWYWx1ZXNbaV0uYXBwcm94RXF1YWwocykpcmV0dXJuIHZvaWQoYVt0XT1pKX1pZih0IGluIHRoaXMuX19zcGxpdHNbZV0pe3JldHVybiB2b2lkIHRoaXMuX19zcGxpdFZhbHVlc1t0aGlzLl9fc3BsaXRzW2VdW3RdXS5zZXRGcm9tT3RoZXIocyl9fWVsc2UgdGhpcy5fX3NwbGl0c1tlXT17fTt0aGlzLl9fc3BsaXRzW2VdW3RdPXRoaXMuX19zcGxpdFZhbHVlcy5sZW5ndGgsdGhpcy5fX3NwbGl0VmFsdWVzLnB1c2gocyl9ZWxzZSBhLnNldEZyb21PdGhlcihzKX1zZXRTcGxpdFZlcnRleFZhbHVlKHQsZSxzKXtpZih0IGluIHRoaXMuX19zcGxpdHN8fCh0aGlzLl9fc3BsaXRzW3RdPXt9KSxlIGluIHRoaXMuX19zcGxpdHNbdF0pe2lmKHRoaXMuX19zcGxpdFZhbHVlc1t0aGlzLl9fc3BsaXRzW3RdW2VdXS5hcHByb3hFcXVhbChzKSlyZXR1cm47Y29uc29sZS53YXJuKCJGYWNlIFZlcnRleCBBbHJlYWR5IFNwbGl0IHdpdGggZGlmZmVyZW50IHZhbHVlIil9dGhpcy5fX3NwbGl0c1t0XVtlXT10aGlzLl9fc3BsaXRWYWx1ZXMubGVuZ3RoLHRoaXMuX19zcGxpdFZhbHVlcy5wdXNoKHMpfXNldFNwbGl0VmVydGV4VmFsdWVzKHQsZSxzKXt0IGluIHRoaXMuX19zcGxpdHN8fCh0aGlzLl9fc3BsaXRzW3RdPXt9KTtjb25zdCBhPXRoaXMuX19zcGxpdFZhbHVlcy5sZW5ndGg7dGhpcy5fX3NwbGl0VmFsdWVzLnB1c2gocyk7Zm9yKGNvbnN0IHMgb2YgZSl0aGlzLl9fc3BsaXRzW3RdW3NdPWF9Z2V0U3BsaXRzKCl7cmV0dXJuIHRoaXMuX19zcGxpdHN9Z2V0U3BsaXRDb3VudCgpe2xldCB0PTA7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fX3NwbGl0cyl0Kz1PYmplY3Qua2V5cyh0aGlzLl9fc3BsaXRzW2VdKS5sZW5ndGg7cmV0dXJuIHR9Z2VuZXJhdGVTcGxpdFZhbHVlcyh0LGUpe2lmKDA9PWUpcmV0dXJuIHRoaXMuX19kYXRhO2NvbnN0IHM9dGhpcy5sZW5ndGgsYT10aGlzLmxlbmd0aCtlLGk9dGhpcy5fX2RhdGFUeXBlLm51bUVsZW1lbnRzP3RoaXMuX19kYXRhVHlwZS5udW1FbGVtZW50cygpOjEscj1uZXcgRmxvYXQzMkFycmF5KGEqaSk7Zm9yKGxldCB0PTA7dDx0aGlzLl9fZGF0YS5sZW5ndGg7dCsrKXJbdF09dGhpcy5fX2RhdGFbdF07Zm9yKGNvbnN0IGUgaW4gdCl7Y29uc3QgYT10W2VdO2Zvcihjb25zdCB0IGluIGEpe2NvbnN0IG49cythW3RdO2lmKGUgaW4gdGhpcy5fX3NwbGl0cyYmdCBpbiB0aGlzLl9fc3BsaXRzW2VdKXtjb25zdCBzPXRoaXMuX19zcGxpdHNbZV1bdF07Nj09dGhpcy5fX2RhdGFUeXBlP3JbbippXT10aGlzLl9fc3BsaXRWYWx1ZXNbc106dGhpcy5fX2RhdGFUeXBlLmNyZWF0ZUZyb21GbG9hdDMyQnVmZmVyKHIuYnVmZmVyLG4qaSkuc2V0RnJvbU90aGVyKHRoaXMuX19zcGxpdFZhbHVlc1tzXSl9ZWxzZXtjb25zdCB0PXBhcnNlSW50KGUpO2ZvcihsZXQgZT0wO2U8aTtlKyspdCppK2U+dGhpcy5fX2RhdGEubGVuZ3RoJiZjb25zb2xlLmxvZygiRXJyb3IgcmVtYXBwaW5nIHNyYzoiK3QqaStlKSxuKmkrZT5yLmxlbmd0aCYmY29uc29sZS5sb2coIkVycm9yIHJlbWFwcGluZyB0Z3Q6IituKmkrZSkscltuKmkrZV09dGhpcy5fX2RhdGFbdCppK2VdfX19cmV0dXJuIHJ9dG9KU09OKHQsZSl7Y29uc3Qgcz1zdXBlci50b0pTT04odCxlKTtyZXR1cm4gcy5zcGxpdHM9dGhpcy5fX3NwbGl0cyxzLnNwbGl0VmFsdWVzPXRoaXMuX19zcGxpdFZhbHVlcyxzfWZyb21KU09OKHQsZSxzKXtzdXBlci5mcm9tSlNPTih0LGUscyksdGhpcy5fX3NwbGl0cz10LnNwbGl0cyx0aGlzLl9fc3BsaXRWYWx1ZXM9W107Zm9yKGNvbnN0IGUgb2YgdC5zcGxpdFZhbHVlcyl0aGlzLl9fc3BsaXRWYWx1ZXMucHVzaCh0aGlzLl9fZGF0YVR5cGUuY3JlYXRlRnJvbUpTT04oZSkpfWxvYWRTcGxpdFZhbHVlcyh0KXtjb25zdCBlPXQubG9hZFVJbnQzMkFycmF5KCk7aWYoMD09ZS5sZW5ndGgpcmV0dXJuO2xldCBzPTAsYT0wO2Zvcig7Oyl7Y29uc3QgdD1lW3MrK10saT1lW3MrK10scj17fTtmb3IobGV0IHQ9MDt0PGk7dCsrKXtjb25zdCB0PWVbcysrXSxpPWVbcysrXTtyW3RdPWksaT49YSYmKGE9aSsxKX1pZih0aGlzLl9fc3BsaXRzW3RdPXIscz49ZS5sZW5ndGgpYnJlYWt9Y29uc3QgaT10aGlzLl9fbnVtRmxvYXQzMkVsZW1lbnRzLHI9dC5sb2FkRmxvYXQzMkFycmF5KGEqaSk7dGhpcy5fX3NwbGl0VmFsdWVzPVtdO2ZvcihsZXQgdD0wO3Q8YTt0Kyspe2NvbnN0IGU9dGhpcy5fX2RhdGFUeXBlLmNyZWF0ZUZyb21GbG9hdDMyQXJyYXkoci5zbGljZSh0KmksdCppK2kpKTt0aGlzLl9fc3BsaXRWYWx1ZXMucHVzaChlKX19fWNsYXNzIFAgZXh0ZW5kcyBNe2NvbnN0cnVjdG9yKCl7c3VwZXIoKSx0aGlzLmluaXQoKX1pbml0KCl7dGhpcy5fX2ZhY2VDb3VudHM9W10sdGhpcy5fX2ZhY2VWZXJ0ZXhDb3VudHM9bmV3IFVpbnQ4QXJyYXksdGhpcy5fX2ZhY2VPZmZzZXRzPW5ldyBVaW50MzJBcnJheSx0aGlzLl9fZmFjZVZlcnRleEluZGljZXM9bmV3IFVpbnQzMkFycmF5LHRoaXMuX19udW1Qb3B1bGF0ZWRGYWNlVmVydGV4SW5kaWNlcz0wLHRoaXMuX19mYWNlQXR0cmlidXRlcz1uZXcgTWFwLHRoaXMuX19lZGdlQXR0cmlidXRlcz1uZXcgTWFwLHRoaXMuX19sb2dUb3BvbG9neVdhcm5pbmdzPSExLHRoaXMuZWRnZVZlcnRzPXZvaWQgMCx0aGlzLnZlcnRleEVkZ2VzPXZvaWQgMCx0aGlzLm51bUVkZ2VzPTAsdGhpcy5lZGdlRmxhZ3M9bmV3IFVpbnQzMkFycmF5LHRoaXMuZWRnZUFuZ2xlcz1uZXcgRmxvYXQzMkFycmF5fWdldEZhY2VWZXJ0ZXhJbmRpY2VzKCl7cmV0dXJuIHRoaXMuX19mYWNlVmVydGV4SW5kaWNlc31nZXRGYWNlQ291bnRzKCl7cmV0dXJuIHRoaXMuX19mYWNlQ291bnRzfWNsZWFyKCl7dGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzPXZvaWQgMCx0aGlzLl9fZmFjZUNvdW50cz1bXSx0aGlzLl9fbnVtUG9wdWxhdGVkRmFjZVZlcnRleEluZGljZXM9MH1zZXRGYWNlQ291bnRzKHQpe2lmKHRoaXMuX19udW1Qb3B1bGF0ZWRGYWNlVmVydGV4SW5kaWNlcyl0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBzZXQgZmFjZSBjb3VudHMgb24gYSBtZXNoIHRoYXQgaXMgYWxyZWFkeSBwb3B1bGF0ZWQuIFBsZWFzZSBjYWxsICdjbGVhcicgYmVmb3JlIHJlLWJ1aWxkaW5nIHRoZSBtZXNoLiIpO3RoaXMuX19mYWNlQ291bnRzPXQ7bGV0IGU9MCxzPTAsYT0zO2Zvcihjb25zdCB0IG9mIHRoaXMuX19mYWNlQ291bnRzKWUrPXQscys9dCphLGErKzt0aGlzLl9fZmFjZVZlcnRleENvdW50cz1uZXcgVWludDhBcnJheShlKSx0aGlzLl9fZmFjZU9mZnNldHM9bmV3IFVpbnQzMkFycmF5KGUpLHRoaXMuX19mYWNlVmVydGV4SW5kaWNlcz1uZXcgVWludDMyQXJyYXkocyk7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fX2ZhY2VBdHRyaWJ1dGVzKXQucmVzaXplKGUpfXNldEZhY2VWZXJ0ZXhJbmRpY2VzKHQpe2NvbnN0IGU9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLHM9dGhpcy5fX251bVBvcHVsYXRlZEZhY2VWZXJ0ZXhJbmRpY2VzO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXRoaXMuX19mYWNlVmVydGV4SW5kaWNlc1tzK3RdPWVbdF07dGhpcy5fX2ZhY2VWZXJ0ZXhDb3VudHNbdF09ZS5sZW5ndGgtMyx0aGlzLl9fZmFjZU9mZnNldHNbdF09cyx0aGlzLl9fbnVtUG9wdWxhdGVkRmFjZVZlcnRleEluZGljZXMrPWUubGVuZ3RofWdldEZhY2VWZXJ0ZXhJbmRpY2VzKHQpe2NvbnN0IGU9W10scz10aGlzLl9fZmFjZU9mZnNldHNbdF0sYT10aGlzLl9fZmFjZVZlcnRleENvdW50c1t0XSszO2ZvcihsZXQgdD0wO3Q8YTt0KyspZS5wdXNoKHRoaXMuX19mYWNlVmVydGV4SW5kaWNlc1tzK3RdKTtyZXR1cm4gZX1nZXRGYWNlVmVydGV4SW5kZXgodCxlKXtjb25zdCBzPXRoaXMuX19mYWNlT2Zmc2V0c1t0XTtyZXR1cm4gdGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzW3MrZV19Z2V0TnVtRmFjZXMoKXtyZXR1cm4gdGhpcy5fX2ZhY2VWZXJ0ZXhDb3VudHMubGVuZ3RofWFkZFZlcnRleEF0dHJpYnV0ZSh0LGUscyl7Y29uc3QgYT1uZXcgTyh0aGlzLGUsbnVsbCE9dGhpcy52ZXJ0aWNlcz90aGlzLnZlcnRpY2VzLmxlbmd0aDowLHMpO3JldHVybiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcy5zZXQodCxhKSxhfWFkZEZhY2VBdHRyaWJ1dGUodCxlLHMpe2NvbnN0IGE9bmV3IFYoZSxudWxsIT1zP3M6dGhpcy5nZXROdW1GYWNlcygpKTtyZXR1cm4gdGhpcy5fX2ZhY2VBdHRyaWJ1dGVzLnNldCh0LGEpLGF9aGFzRmFjZUF0dHJpYnV0ZSh0KXtyZXR1cm4gdGhpcy5fX2ZhY2VBdHRyaWJ1dGVzLmhhcyh0KX1nZXRGYWNlQXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fZmFjZUF0dHJpYnV0ZXMuZ2V0KHQpfWFkZEVkZ2VBdHRyaWJ1dGUodCxlLHMpe2NvbnN0IGE9bmV3IFYoZSxudWxsIT1zP3M6dGhpcy5nZXROdW1FZGdlcygpKTtyZXR1cm4gdGhpcy5fX2VkZ2VBdHRyaWJ1dGVzLnNldCh0LGEpLGF9aGFzRWRnZUF0dHJpYnV0ZSh0KXtyZXR1cm4gdGhpcy5fX2VkZ2VBdHRyaWJ1dGVzLmhhcyh0KX1nZXRFZGdlQXR0cmlidXRlKHQpe3JldHVybiB0aGlzLl9fZWRnZUF0dHJpYnV0ZXMuZ2V0KHQpfWdlblRvcG9sb2d5SW5mbygpe2NvbnN0IHQ9e307dGhpcy52ZXJ0ZXhFZGdlcz1bXSx0aGlzLmVkZ2VGYWNlcz1bXSx0aGlzLmVkZ2VWZXJ0cz1bXSx0aGlzLmZhY2VFZGdlcz1bXSx0aGlzLm51bUVkZ2VzPTA7Y29uc3QgZT0oZSxzKT0+e2xldCBhPWUsaT1zO2lmKGk8YSl7Y29uc3QgdD1hO2E9aSxpPXR9Y29uc3Qgcj1hKyI+IitpO2lmKHIgaW4gdClyZXR1cm4gdFtyXTtjb25zdCBuPXRoaXMudmVydGljZXMuZ2V0VmFsdWVSZWYoYSksaD10aGlzLnZlcnRpY2VzLmdldFZhbHVlUmVmKGkpLnN1YnRyYWN0KG4pLG89e2VkZ2VJbmRleDp0aGlzLmVkZ2VGYWNlcy5sZW5ndGgvMixlZGdlVmVjOmh9O3JldHVybiB0W3JdPW8sdGhpcy5lZGdlRmFjZXMucHVzaCgtMSksdGhpcy5lZGdlRmFjZXMucHVzaCgtMSksdGhpcy5lZGdlVmVydHMucHVzaChhKSx0aGlzLmVkZ2VWZXJ0cy5wdXNoKGkpLHRoaXMubnVtRWRnZXMrKyxvfSxzPSh0LHMsYSk9Pntjb25zdCBpPWUodCxzKS5lZGdlSW5kZXg7aWYoczx0KXtjb25zdCB0PTIqaSswO3RoaXMuX19sb2dUb3BvbG9neVdhcm5pbmdzJiYtMSE9dGhpcy5lZGdlRmFjZXNbdF0mJmNvbnNvbGUud2FybigiRWRnZSBwb2x5IDAgYWxyZWFkeSBzZXQuIE1lc2ggaXMgbm9uLW1hbmlmb2xkLiIpLHRoaXMuZWRnZUZhY2VzW3RdPWF9ZWxzZXtjb25zdCB0PTIqaSsxO3RoaXMuX19sb2dUb3BvbG9neVdhcm5pbmdzJiYtMSE9dGhpcy5lZGdlRmFjZXNbdF0mJmNvbnNvbGUud2FybigiRWRnZSBwb2x5IDEgYWxyZWFkeSBzZXQuIE1lc2ggaXMgbm9uLW1hbmlmb2xkLiIpLHRoaXMuZWRnZUZhY2VzW3RdPWF9YSBpbiB0aGlzLmZhY2VFZGdlc3x8KHRoaXMuZmFjZUVkZ2VzW2FdPVtdKSx0aGlzLmZhY2VFZGdlc1thXS5wdXNoKGkpLG51bGw9PXRoaXMudmVydGV4RWRnZXNbdF0mJih0aGlzLnZlcnRleEVkZ2VzW3RdPW5ldyBTZXQpLG51bGw9PXRoaXMudmVydGV4RWRnZXNbc10mJih0aGlzLnZlcnRleEVkZ2VzW3NdPW5ldyBTZXQpLHRoaXMudmVydGV4RWRnZXNbdF0uYWRkKGkpLHRoaXMudmVydGV4RWRnZXNbc10uYWRkKGkpfSxhPXRoaXMuZ2V0TnVtRmFjZXMoKTtmb3IobGV0IHQ9MDt0PGE7dCsrKXtjb25zdCBlPXRoaXMuZ2V0RmFjZVZlcnRleEluZGljZXModCk7Zm9yKGxldCBhPTA7YTxlLmxlbmd0aDthKyspe3MoZVthXSxlWyhhKzEpJWUubGVuZ3RoXSx0KX19fWNvbXB1dGVGYWNlTm9ybWFscygpe2NvbnN0IHQ9dGhpcy52ZXJ0aWNlcyxlPXRoaXMuYWRkRmFjZUF0dHJpYnV0ZSgibm9ybWFscyIscikscz10aGlzLmdldE51bUZhY2VzKCk7Zm9yKGxldCBhPTA7YTxzO2ErKyl7Y29uc3Qgcz10aGlzLmdldEZhY2VWZXJ0ZXhJbmRpY2VzKGEpLGk9dC5nZXRWYWx1ZVJlZihzWzBdKTtsZXQgbj10LmdldFZhbHVlUmVmKHNbMV0pO2NvbnN0IGg9bmV3IHI7Zm9yKGxldCBlPTI7ZTxzLmxlbmd0aDtlKyspe2NvbnN0IGE9dC5nZXRWYWx1ZVJlZihzW2VdKSxyPW4uc3VidHJhY3QoaSksbz1hLnN1YnRyYWN0KGkpO2guYWRkSW5QbGFjZShyLmNyb3NzKG8pLm5vcm1hbGl6ZSgpKSxuPWF9aC5sZW5ndGhTcXVhcmVkKCksTnVtYmVyLkVQU0lMT04sZS5zZXRWYWx1ZShhLGgubm9ybWFsaXplKCkpfX1nZW5lcmF0ZUVkZ2VGbGFncygpe251bGw9PXRoaXMudmVydGV4RWRnZXMmJnRoaXMuZ2VuVG9wb2xvZ3lJbmZvKCksdGhpcy5oYXNGYWNlQXR0cmlidXRlKCJub3JtYWxzIil8fHRoaXMuY29tcHV0ZUZhY2VOb3JtYWxzKCk7Y29uc3QgdD10aGlzLnZlcnRpY2VzLGU9dGhpcy5nZXRGYWNlQXR0cmlidXRlKCJub3JtYWxzIik7dGhpcy5lZGdlVmVjcz1bXSx0aGlzLmVkZ2VBbmdsZXM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLm51bUVkZ2VzKTtmb3IobGV0IHM9MDtzPHRoaXMuZWRnZUZhY2VzLmxlbmd0aDtzKz0yKXtjb25zdCBhPXRoaXMuZWRnZVZlcnRzW3NdLGk9dGhpcy5lZGdlVmVydHNbcysxXSxyPXQuZ2V0VmFsdWVSZWYoaSkuc3VidHJhY3QodC5nZXRWYWx1ZVJlZihhKSk7ci5ub3JtYWxpemVJblBsYWNlKCksdGhpcy5lZGdlVmVjcy5wdXNoKHIpO2NvbnN0IG49dGhpcy5lZGdlRmFjZXNbc10saD10aGlzLmVkZ2VGYWNlc1tzKzFdO2lmKC0xPT1ufHwtMT09aCl7dGhpcy5lZGdlQW5nbGVzW3MvMl09MipNYXRoLlBJO2NvbnRpbnVlfWNvbnN0IG89ZS5nZXRWYWx1ZVJlZihuKSxfPWUuZ2V0VmFsdWVSZWYoaCk7dGhpcy5lZGdlQW5nbGVzW3MvMl09by5hbmdsZVRvKF8pfX1jb21wdXRlVmVydGV4Tm9ybWFscyh0PTEpe3RoaXMuZ2VuZXJhdGVFZGdlRmxhZ3MoKTt0aGlzLnZlcnRpY2VzO2NvbnN0IGU9dGhpcy5nZXRGYWNlQXR0cmlidXRlKCJub3JtYWxzIikscz10aGlzLmFkZFZlcnRleEF0dHJpYnV0ZSgibm9ybWFscyIsciksYT1lLmRhdGEuYnVmZmVyLGk9cy5kYXRhLG49KHQsZSk9PntpWzMqdCswXT1lLngsaVszKnQrMV09ZS55LGlbMyp0KzJdPWUuen0saD0odCxlKT0+e2xldCBzLGE7Y29uc3QgaT10aGlzLmZhY2VFZGdlc1t0XTtmb3IoY29uc3QgdCBvZiBpKSh0aGlzLmVkZ2VWZXJ0c1syKnRdPT1lfHx0aGlzLmVkZ2VWZXJ0c1syKnQrMV09PWUpJiYocz9hPXRoaXMuZWRnZVZlY3NbdF06cz10aGlzLmVkZ2VWZWNzW3RdKTtyZXR1cm5bcyxhXX07Zm9yKGxldCBlPTA7ZTx0aGlzLnZlcnRleEVkZ2VzLmxlbmd0aDtlKyspe2lmKG51bGw9PXRoaXMudmVydGV4RWRnZXNbZV0pY29udGludWU7Y29uc3QgaT10aGlzLnZlcnRleEVkZ2VzW2VdLF89W10sZD10PT57bGV0IGU9ITE7Zm9yKGNvbnN0IHMgb2YgXylpZihlPS0xIT1zLmluZGV4T2YodCksZSlicmVhaztlfHxfLnB1c2goW3RdKX07Zm9yKGNvbnN0IGUgb2YgaSl7Y29uc3Qgcz10aGlzLmVkZ2VGYWNlc1syKmVdLGE9dGhpcy5lZGdlRmFjZXNbMiplKzFdO2lmKC0xIT1zJiYtMT09YSYmdGhpcy5lZGdlQW5nbGVzW2VdPHQpe2xldCB0PS0xLGU9LTE7Zm9yKGxldCBpPTA7aTxfLmxlbmd0aDtpKyspLTE9PXQmJi0xIT1fW2ldLmluZGV4T2YocykmJih0PWkpLC0xPT1lJiYtMSE9X1tpXS5pbmRleE9mKGEpJiYoZT1pKTstMT09dCYmLTE9PWU/Xy5wdXNoKFtzLGFdKTotMSE9dCYmLTEhPWU/dCE9ZSYmKF9bdF09X1t0XS5jb25jYXQoX1tlXSksXy5zcGxpY2UoZSwxKSk6KC0xPT10JiZfW2VdLnB1c2gocyksLTE9PWUmJl9bdF0ucHVzaChhKSl9ZWxzZS0xIT1zJiZkKHMpLC0xIT1hJiZkKGEpfV8uc29ydCgodCxlKT0+dC5sZW5ndGg8ZS5sZW5ndGg/MTp0Lmxlbmd0aD5lLmxlbmd0aD8tMTowKTtsZXQgbD0hMDtmb3IoY29uc3QgdCBvZiBfKXtjb25zdCBpPW5ldyByO2Zvcihjb25zdCBzIG9mIHQpe2NvbnN0IHQ9aChzLGUpLG49dFswXS5hbmdsZVRvKHRbMV0pO2kuYWRkSW5QbGFjZSgobz1zLG5ldyByKGEsMTIqbykpLnNjYWxlKG4pKX1pLm5vcm1hbGl6ZUluUGxhY2UoKSxsPyhuKGUsaSksbD0hMSk6cy5zZXRTcGxpdFZlcnRleFZhbHVlcyhlLHQsaSl9fXZhciBvO3JldHVybiBzfWNvbXB1dGVOdW1UcmlhbmdsZXMoKXtsZXQgdD0zLGU9MDtmb3IoY29uc3QgcyBvZiB0aGlzLl9fZmFjZUNvdW50cyllKz1zKih0LTIpLHQrKztyZXR1cm4gZX1nZW5lcmF0ZVRyaWFuZ3VsYXRlZEluZGljZXModCxlLHMpe2NvbnN0IGE9dGhpcy5jb21wdXRlTnVtVHJpYW5nbGVzKCk7bGV0IGk7aT10PE1hdGgucG93KDIsOCk/bmV3IFVpbnQ4QXJyYXkoMyphKTp0PE1hdGgucG93KDIsMTYpP25ldyBVaW50MTZBcnJheSgzKmEpOm5ldyBVaW50MzJBcnJheSgzKmEpO2xldCByPTA7Y29uc3Qgbj1mdW5jdGlvbih0LGEpe3QgaW4gcyYmYSBpbiBzW3RdJiYodD1lK3NbdF1bYV0pLGlbcl09dCxyKyt9LGg9dGhpcy5nZXROdW1GYWNlcygpO2ZvcihsZXQgdD0wO3Q8aDt0Kyspe2NvbnN0IGU9dGhpcy5nZXRGYWNlVmVydGV4SW5kaWNlcyh0KTtmb3IobGV0IHM9MDtzPGUubGVuZ3RoO3MrKylzPj0zJiYobihlWzBdLHQpLG4oZVtzLTFdLHQpKSxuKGVbc10sdCl9cmV0dXJuIGl9Y29tcHV0ZUhhcmRFZGdlc0luZGljZXModD0xKXtjb25zdCBlPVtdLHM9dD0+e2UucHVzaCh0aGlzLmVkZ2VWZXJ0c1t0XSksZS5wdXNoKHRoaXMuZWRnZVZlcnRzW3QrMV0pfTtmb3IobGV0IGU9MDtlPHRoaXMuZWRnZUZsYWdzLmxlbmd0aDtlKz0yKXRoaXMuZWRnZUFuZ2xlc1tlLzJdPnQmJnMoZSk7cmV0dXJuIGV9Z2V0V2lyZWZyYW1lSW5kaWNlcygpe3JldHVybiBpbmRpY2VzfWdlbkJ1ZmZlcnModCl7Y29uc3QgZT17fTtsZXQgcz0wO2Zvcihjb25zdFssdF1vZiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcyl7Y29uc3QgYT10LmdldFNwbGl0cygpO2Zvcihjb25zdCB0IGluIGEpe3QgaW4gZXx8KGVbdF09e30pO2NvbnN0IGk9YVt0XTtmb3IoY29uc3QgYSBpbiBpKXtjb25zdCBpPXBhcnNlSW50KGEpO2kgaW4gZVt0XXx8KGVbdF1baV09cyxzKyspfX19Y29uc3QgYT10aGlzLnZlcnRpY2VzLmxlbmd0aCxpPWErcztsZXQgcjt0JiYwPT10LmluY2x1ZGVJbmRpY2VzfHwocj10aGlzLmdlbmVyYXRlVHJpYW5ndWxhdGVkSW5kaWNlcyhpLGEsZSkpO2NvbnN0IG49e307Zm9yKGNvbnN0W3QsYV1vZiB0aGlzLl9fdmVydGV4QXR0cmlidXRlcyl7bGV0IGk7aT0wPT1zP2EuZGF0YTphLmdlbmVyYXRlU3BsaXRWYWx1ZXMoZSxzKTtjb25zdCByPWEubnVtRWxlbWVudHMsaD1pLmxlbmd0aC9yO25bdF09e3ZhbHVlczppLGNvdW50OmgsZGltZW5zaW9uOnIsbm9ybWFsaXplZDoibm9ybWFscyI9PXQsZGF0YVR5cGU6YS5kYXRhVHlwZX19Y29uc3QgaD17bnVtVmVydGljZXM6dGhpcy5udW1WZXJ0aWNlcygpLG51bVJlbmRlclZlcnRzOmksaW5kaWNlczpyLGF0dHJCdWZmZXJzOm59O2lmKHQmJnQuaW5jbHVkZVZlcnRleE5laWdoYm9ycyl7bnVsbD09dGhpcy52ZXJ0ZXhFZGdlcyYmdGhpcy5nZW5Ub3BvbG9neUluZm8oKTtsZXQgdD0wO2ZvcihsZXQgZT0wO2U8dGhpcy52ZXJ0ZXhFZGdlcy5sZW5ndGg7ZSsrKXRoaXMudmVydGV4RWRnZXNbZV0mJih0Kz10aGlzLnZlcnRleEVkZ2VzW2VdLnNpemUpO2NvbnN0IGU9bmV3IFVpbnQzMkFycmF5KDIqdGhpcy52ZXJ0ZXhFZGdlcy5sZW5ndGgrdCkscz10PT57Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDtlKyspe2NvbnN0IHM9dFtlXTtmb3IobGV0IGE9MDthPGU7YSsrKXtjb25zdCBpPXRbYV07aWYoLTEhPXNbMF0mJnNbMF09PWlbMV0pe2UhPWErMSYmKHQuc3BsaWNlKGUsMSksdC5zcGxpY2UoYSsxLDAscykpO2JyZWFrfWlmKC0xIT1zWzFdJiZzWzFdPT1pWzBdKXt0LnNwbGljZShlLDEpLHQuc3BsaWNlKGEsMCxzKTticmVha319fX0sYT10PT57aWYoISgtMSE9dFswXVswXSYmLTEhPXRbdC5sZW5ndGgtMV1bMV18fC0xPT10WzBdWzBdJiYtMT09dFt0Lmxlbmd0aC0xXVsxXSkpdGhyb3cgbmV3IEVycm9yKCJJZiBmYW4gc3RhcnRzIHdpdGggLTEsIGl0IG11c3QgYWxzbyBlbmQgd2l0aCAtMSIpO2ZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKXtjb25zdCBzPXRbZV07aWYoKC0xPT1zWzBdfHwtMT09c1sxXSkmJjAhPWUmJmUhPXQubGVuZ3RoLTEpdGhyb3cgbmV3IEVycm9yKCItMSBvbmx5IGFsbG93ZWQgYXQgdGhlIGJlZ2lubmluZyBhbmQgZW5kIG9mIGEgZmFuLiIpO2lmKC0xIT1zWzBdKXtsZXQgYT1lLTE7aWYoYTwwJiYoYSs9dC5sZW5ndGgpLHNbMF0hPXRbYV1bMV0pdGhyb3cgbmV3IEVycm9yKCJGYWNlcyBhcmUgbm90IHNlcXVlbnRpYWwiKX1pZigtMSE9c1sxXSl7Y29uc3QgYT0oZSsxKSV0Lmxlbmd0aDtpZihzWzFdIT10W2FdWzBdKXRocm93IG5ldyBFcnJvcigiRmFjZXMgYXJlIG5vdCBzZXF1ZW50aWFsIil9fX07bGV0IGk9Mip0aGlzLnZlcnRleEVkZ2VzLmxlbmd0aDtmb3IobGV0IHQ9MDt0PHRoaXMudmVydGV4RWRnZXMubGVuZ3RoO3QrKyl7aWYobnVsbD09dGhpcy52ZXJ0ZXhFZGdlc1t0XSljb250aW51ZTtjb25zdCByPXRoaXMudmVydGV4RWRnZXNbdF0sbj1bXTtmb3IoY29uc3QgZSBvZiByKXtjb25zdCBzPXRoaXMuZWRnZVZlcnRzWzIqZV0sYT10aGlzLmVkZ2VWZXJ0c1syKmUrMV07bGV0IGkscj10aGlzLmVkZ2VGYWNlc1syKmVdLGg9dGhpcy5lZGdlRmFjZXNbMiplKzFdO2lmKHM9PXQpaT1hO2Vsc2V7aWYoYSE9dCl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgdG9wb2xvZ3kiKTt7aT1zO2NvbnN0IHQ9cjtyPWgsaD10fX1uLnB1c2goW3IsaCxpXSl9cyhuKSxhKG4pO2xldCBoPTA7KC0xIT1uWzBdWzBdfHwtMSE9bltuLmxlbmd0aC0xXVsxXSkmJihoKz0xKSxlWzIqdF09aSxlWzIqdCsxXT1yLnNpemUrKGg8PDgpO2Zvcihjb25zdCB0IG9mIG4pZVtpXT10WzJdLGkrK31oLnZlcnRleE5laWdoYm9ycz1lfXJldHVybiBofWZyZWVCdWZmZXJzKCl7c3VwZXIuZnJlZUJ1ZmZlcnMoKSx0aGlzLmluaXQoKX1yZWFkQmluYXJ5KHQsZSl7c3VwZXIubG9hZEJhc2VHZW9tQmluYXJ5KHQpLHRoaXMuc2V0RmFjZUNvdW50cyh0LmxvYWRVSW50MzJBcnJheSgpKSx0aGlzLl9fZmFjZVZlcnRleENvdW50cz10LmxvYWRVSW50OEFycmF5KHRoaXMuX19mYWNlVmVydGV4Q291bnRzLmxlbmd0aCk7Y29uc3Qgcz10LmxvYWRTSW50MzJWZWMyKCksYT10LmxvYWRVSW50OCgpO2xldCByOzE9PWE/cj10LmxvYWRVSW50OEFycmF5KCk6Mj09YT9yPXQubG9hZFVJbnQxNkFycmF5KCk6ND09YSYmKHI9dC5sb2FkVUludDMyQXJyYXkoKSk7Y29uc3Qgbj10aGlzLmdldE51bUZhY2VzKCk7bGV0IGg9MCxvPTA7Zm9yKGxldCB0PTA7dDxuO3QrKyl7Y29uc3QgZT10aGlzLl9fZmFjZVZlcnRleENvdW50c1t0XSszO3RoaXMuX19mYWNlT2Zmc2V0c1t0XT1oO2ZvcihsZXQgYT0wO2E8ZTthKyspe2NvbnN0IGU9aCthLGk9cltlXStzLng7aWYoMD09dCl0aGlzLl9fZmFjZVZlcnRleEluZGljZXNbZV09aTtlbHNle2xldCBzPXRoaXMuX19mYWNlT2Zmc2V0c1t0LTFdO3MrPWE8bz9hOm8tMSx0aGlzLl9fZmFjZVZlcnRleEluZGljZXNbZV09dGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzW3NdK2l9fWgrPWUsbz1lfXRoaXMuX19udW1Qb3B1bGF0ZWRGYWNlVmVydGV4SW5kaWNlcz1oO2NvbnN0IF89dC5sb2FkVUludDMyKCk7aWYoXz4wKXtjb25zdCBlPXRoaXMudmVydGljZXMscz10aGlzLmFkZFZlcnRleEF0dHJpYnV0ZSgibGlnaHRtYXBDb29yZHMiLGkpO2ZvcihsZXQgYT0wO2E8XzthKyspe2NvbnN0IGE9bmV3IG0odC5sb2FkRmxvYXQzMlZlYzMoKSx0LmxvYWRGbG9hdDMyUXVhdCgpKSxyPXQubG9hZEZsb2F0MzIoKSxuPXQubG9hZEZsb2F0MzJWZWMyKCksaD10LmxvYWRTSW50MzJWZWMyKCksbz10LmxvYWRVSW50OCgpO2xldCBfO189MT09bz90LmxvYWRVSW50OEFycmF5KCk6Mj09bz90LmxvYWRVSW50MTZBcnJheSgpOnQubG9hZFVJbnQzMkFycmF5KCk7bGV0IGQ9MDtmb3IoY29uc3QgdCBvZiBfKXtsZXQgbz10K2gueDtvKz1kLGQ9bztjb25zdCBfPXRoaXMuZ2V0RmFjZVZlcnRleEluZGljZXMobyk7Zm9yKGNvbnN0IHQgb2YgXyl7Y29uc3QgaD1lLmdldFZhbHVlUmVmKHQpLF89YS50cmFuc2Zvcm1WZWMzKGgpLGQ9bmV3IGkoXy54LF8ueik7ZC5zY2FsZUluUGxhY2UociksZC5hZGRJblBsYWNlKG4pLHMuc2V0RmFjZVZlcnRleFZhbHVlX0J5VmVydGV4SW5kZXgobyx0LGQpfX19fXRoaXMuaGFzVmVydGV4QXR0cmlidXRlKCJub3JtYWxzIil8fHRoaXMuY29tcHV0ZVZlcnRleE5vcm1hbHMoKSx0aGlzLmdlb21EYXRhQ2hhbmdlZC5lbWl0KCl9dG9KU09OKHQsZSl7Y29uc3Qgcz1zdXBlci50b0pTT04odCxlKTtyZXR1cm4gMTAyNCZlfHwocy5mYWNlQ291bnRzPUFycmF5LmZyb20odGhpcy5fX2ZhY2VDb3VudHMpLHMuZmFjZVZlcnRleEluZGljZXM9QXJyYXkuZnJvbSh0aGlzLl9fZmFjZVZlcnRleEluZGljZXMpKSxzfWZyb21KU09OKHQsZSxzKXtzdXBlci5mcm9tSlNPTih0LGUscyksdC5mYWNlQ291bnRzJiYodGhpcy5fX2ZhY2VDb3VudHM9VWludDMyQXJyYXkuZnJvbSh0LmZhY2VDb3VudHMpKSx0LmZhY2VWZXJ0ZXhJbmRpY2VzJiYodGhpcy5fX2ZhY2VWZXJ0ZXhJbmRpY2VzPVVpbnQzMkFycmF5LmZyb20odC5mYWNlVmVydGV4SW5kaWNlcykpfX1jbGFzcyBFe2NvbnN0cnVjdG9yKHQsZT0wLHM9ITApe3RoaXMuX19kYXRhPXQsdGhpcy5fX2J5dGVPZmZzZXQ9ZSx0aGlzLl9fZGF0YVZpZXc9bmV3IERhdGFWaWV3KHRoaXMuX19kYXRhKSx0aGlzLl9faXNNb2JpbGVEZXZpY2U9cyx0aGlzLnV0ZjhkZWNvZGVyPW5ldyBUZXh0RGVjb2Rlcn1nZXQgaXNNb2JpbGVEZXZpY2UoKXtyZXR1cm4gdGhpcy5fX2lzTW9iaWxlRGV2aWNlfWdldCBkYXRhKCl7cmV0dXJuIHRoaXMuX19kYXRhfWdldCBieXRlTGVuZ3RoKCl7cmV0dXJuIHRoaXMuX19kYXRhVmlldy5ieXRlTGVuZ3RofWdldCByZW1haW5pbmdCeXRlTGVuZ3RoKCl7cmV0dXJuIHRoaXMuX19kYXRhVmlldy5ieXRlTGVuZ3RoLXRoaXMuX19ieXRlT2Zmc2V0fXBvcygpe3JldHVybiB0aGlzLl9fYnl0ZU9mZnNldH1zZWVrKHQpe3RoaXMuX19ieXRlT2Zmc2V0PXR9YWR2YW5jZSh0KXt0aGlzLl9fYnl0ZU9mZnNldCs9dH1sb2FkVUludDgoKXtjb25zdCB0PXRoaXMuX19kYXRhVmlldy5nZXRVaW50OCh0aGlzLl9fYnl0ZU9mZnNldCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz0xLHR9bG9hZFVJbnQxNigpe2NvbnN0IHQ9dGhpcy5fX2RhdGFWaWV3LmdldFVpbnQxNih0aGlzLl9fYnl0ZU9mZnNldCwhMCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz0yLHR9bG9hZFVJbnQzMigpe2NvbnN0IHQ9dGhpcy5fX2RhdGFWaWV3LmdldFVpbnQzMih0aGlzLl9fYnl0ZU9mZnNldCwhMCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz00LHR9bG9hZFNJbnQzMigpe2NvbnN0IHQ9dGhpcy5fX2RhdGFWaWV3LmdldEludDMyKHRoaXMuX19ieXRlT2Zmc2V0LCEwKTtyZXR1cm4gdGhpcy5fX2J5dGVPZmZzZXQrPTQsdH1sb2FkRmxvYXQxNigpe2NvbnN0IHQ9dGhpcy5sb2FkVUludDE2KCk7cmV0dXJuIE1hdGguZGVjb2RlMTZCaXRGbG9hdCh0KX1sb2FkVUZsb2F0MTYoKXtjb25zdCB0PXRoaXMubG9hZEZsb2F0MTYoKTtyZXR1cm4gdDwwPzIwNDgtdDp0fWxvYWRGbG9hdDE2RnJvbTJ4VUludDgoKXtjb25zdCB0PXRoaXMuX19kYXRhVmlldy5nZXRGbG9hdDE2KHRoaXMuX19ieXRlT2Zmc2V0LCEwKTtyZXR1cm4gdGhpcy5fX2J5dGVPZmZzZXQrPTIsdH1sb2FkVUludDMyRnJvbTJ4VUZsb2F0MTYoKXtyZXR1cm4gdGhpcy5sb2FkVUZsb2F0MTYoKSs0MDk2KnRoaXMubG9hZFVGbG9hdDE2KCl9bG9hZFNJbnQzMkZyb20yeEZsb2F0MTYoKXtyZXR1cm4gdGhpcy5sb2FkRmxvYXQxNigpKzIwNDgqdGhpcy5sb2FkRmxvYXQxNigpfWxvYWRGbG9hdDMyKCl7Y29uc3QgdD10aGlzLl9fZGF0YVZpZXcuZ2V0RmxvYXQzMih0aGlzLl9fYnl0ZU9mZnNldCwhMCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz00LHR9bG9hZFVJbnQ4QXJyYXkodCxlPSExKXtudWxsPT10JiYodD10aGlzLmxvYWRVSW50MzIoKSk7Y29uc3Qgcz1uZXcgVWludDhBcnJheSh0aGlzLl9fZGF0YSx0aGlzLl9fYnl0ZU9mZnNldCx0KTt0aGlzLl9fYnl0ZU9mZnNldCs9dDt0aGlzLl9fYnl0ZU9mZnNldDtyZXR1cm4gc31sb2FkVUludDE2QXJyYXkodCxlPSExKXtpZihudWxsPT10JiYodD10aGlzLmxvYWRVSW50MzIoKSksMD09dClyZXR1cm4gbmV3IFVpbnQxNkFycmF5O2xldCBzO2lmKHRoaXMucmVhZFBhZGQoMiksdGhpcy5fX2lzTW9iaWxlRGV2aWNlKXtzPW5ldyBVaW50MTZBcnJheSh0KTtmb3IobGV0IGU9MDtlPHQ7ZSsrKXNbZV09dGhpcy5fX2RhdGFWaWV3LmdldFVpbnQxNih0aGlzLl9fYnl0ZU9mZnNldCwhMCksdGhpcy5fX2J5dGVPZmZzZXQrPTJ9ZWxzZSBzPW5ldyBVaW50MTZBcnJheSh0aGlzLl9fZGF0YSx0aGlzLl9fYnl0ZU9mZnNldCx0KSx0aGlzLl9fYnl0ZU9mZnNldCs9Mip0O3JldHVybiBzfWxvYWRVSW50MzJBcnJheSh0LGU9ITEpe2lmKG51bGw9PXQmJih0PXRoaXMubG9hZFVJbnQzMigpKSwwPT10KXJldHVybiBuZXcgVWludDMyQXJyYXk7bGV0IHM7aWYodGhpcy5yZWFkUGFkZCg0KSx0aGlzLl9faXNNb2JpbGVEZXZpY2Upe3M9bmV3IFVpbnQzMkFycmF5KHQpO2ZvcihsZXQgZT0wO2U8dDtlKyspc1tlXT10aGlzLl9fZGF0YVZpZXcuZ2V0VWludDMyKHRoaXMuX19ieXRlT2Zmc2V0LCEwKSx0aGlzLl9fYnl0ZU9mZnNldCs9NH1lbHNlIHM9bmV3IFVpbnQzMkFycmF5KHRoaXMuX19kYXRhLHRoaXMuX19ieXRlT2Zmc2V0LHQpLHRoaXMuX19ieXRlT2Zmc2V0Kz00KnQ7cmV0dXJuIHN9bG9hZEZsb2F0MzJBcnJheSh0LGU9ITEpe2lmKG51bGw9PXQmJih0PXRoaXMubG9hZFVJbnQzMigpKSwwPT10KXJldHVybiBuZXcgRmxvYXQzMkFycmF5O2xldCBzO2lmKHRoaXMucmVhZFBhZGQoNCksdGhpcy5fX2lzTW9iaWxlRGV2aWNlKXtzPW5ldyBGbG9hdDMyQXJyYXkodCk7Zm9yKGxldCBlPTA7ZTx0O2UrKylzW2VdPXRoaXMuX19kYXRhVmlldy5nZXRGbG9hdDMyKHRoaXMuX19ieXRlT2Zmc2V0LCEwKSx0aGlzLl9fYnl0ZU9mZnNldCs9NH1lbHNlIHM9bmV3IEZsb2F0MzJBcnJheSh0aGlzLl9fZGF0YSx0aGlzLl9fYnl0ZU9mZnNldCx0KSx0aGlzLl9fYnl0ZU9mZnNldCs9NCp0O3JldHVybiBzfWxvYWRTdHIoKXtjb25zdCB0PXRoaXMubG9hZFVJbnQzMigpLGU9bmV3IFVpbnQ4QXJyYXkodGhpcy5fX2RhdGEsdGhpcy5fX2J5dGVPZmZzZXQsdCk7cmV0dXJuIHRoaXMuX19ieXRlT2Zmc2V0Kz10LHRoaXMudXRmOGRlY29kZXIuZGVjb2RlKGUpfWxvYWRTdHJBcnJheSgpe2NvbnN0IHQ9dGhpcy5sb2FkVUludDMyKCksZT1bXTtmb3IobGV0IHM9MDtzPHQ7cysrKWVbc109dGhpcy5sb2FkU3RyKCk7cmV0dXJuIGV9bG9hZFNJbnQzMlZlYzIoKXtjb25zdCB0PXRoaXMubG9hZFNJbnQzMigpLGU9dGhpcy5sb2FkU0ludDMyKCk7cmV0dXJuIG5ldyBpKHQsZSl9bG9hZFVJbnQzMlZlYzIoKXtjb25zdCB0PXRoaXMubG9hZFVJbnQzMigpLGU9dGhpcy5sb2FkVUludDMyKCk7cmV0dXJuIG5ldyBpKHQsZSl9bG9hZEZsb2F0MTZWZWMyKCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDE2KCksZT10aGlzLmxvYWRGbG9hdDE2KCk7cmV0dXJuIG5ldyBpKHQsZSl9bG9hZEZsb2F0MzJWZWMyKCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDMyKCksZT10aGlzLmxvYWRGbG9hdDMyKCk7cmV0dXJuIG5ldyBpKHQsZSl9bG9hZEZsb2F0MTZWZWMzKCl7Y29uc3QgdD10aGlzLmxvYWRGbG9hdDE2KCksZT10aGlzLmxvYWRGbG9hdDE2KCkscz10aGlzLmxvYWRGbG9hdDE2KCk7cmV0dXJuIG5ldyByKHQsZSxzKX1sb2FkRmxvYXQzMlZlYzMoKXtjb25zdCB0PXRoaXMubG9hZEZsb2F0MzIoKSxlPXRoaXMubG9hZEZsb2F0MzIoKSxzPXRoaXMubG9hZEZsb2F0MzIoKTtyZXR1cm4gbmV3IHIodCxlLHMpfWxvYWRGbG9hdDE2UXVhdCgpe2NvbnN0IHQ9dGhpcy5sb2FkRmxvYXQxNigpLGU9dGhpcy5sb2FkRmxvYXQxNigpLHM9dGhpcy5sb2FkRmxvYXQxNigpLGE9dGhpcy5sb2FkRmxvYXQxNigpO3JldHVybiBuZXcgdSh0LGUscyxhKX1sb2FkRmxvYXQzMlF1YXQoKXtjb25zdCB0PXRoaXMubG9hZEZsb2F0MzIoKSxlPXRoaXMubG9hZEZsb2F0MzIoKSxzPXRoaXMubG9hZEZsb2F0MzIoKSxhPXRoaXMubG9hZEZsb2F0MzIoKTtyZXR1cm4gbmV3IHUodCxlLHMsYSl9bG9hZFJHQkZsb2F0MzJDb2xvcigpe2NvbnN0IHQ9dGhpcy5sb2FkRmxvYXQzMigpLGU9dGhpcy5sb2FkRmxvYXQzMigpLHM9dGhpcy5sb2FkRmxvYXQzMigpO3JldHVybiBuZXcgbyh0LGUscyl9bG9hZFJHQkFGbG9hdDMyQ29sb3IoKXtjb25zdCB0PXRoaXMubG9hZEZsb2F0MzIoKSxlPXRoaXMubG9hZEZsb2F0MzIoKSxzPXRoaXMubG9hZEZsb2F0MzIoKSxhPXRoaXMubG9hZEZsb2F0MzIoKTtyZXR1cm4gbmV3IG8odCxlLHMsYSl9bG9hZFJHQlVJbnQ4Q29sb3IoKXtjb25zdCB0PXRoaXMubG9hZFVJbnQ4KCksZT10aGlzLmxvYWRVSW50OCgpLHM9dGhpcy5sb2FkVUludDgoKTtyZXR1cm4gbmV3IG8odC8yNTUsZS8yNTUscy8yNTUpfWxvYWRSR0JBVUludDhDb2xvcigpe2NvbnN0IHQ9dGhpcy5sb2FkVUludDgoKSxlPXRoaXMubG9hZFVJbnQ4KCkscz10aGlzLmxvYWRVSW50OCgpLGE9dGhpcy5sb2FkVUludDgoKTtyZXR1cm4gbmV3IG8odC8yNTUsZS8yNTUscy8yNTUsYS8yNTUpfWxvYWRCb3gyKCl7cmV0dXJuIG5ldyBnKHRoaXMubG9hZEZsb2F0MzJWZWMyKCksdGhpcy5sb2FkRmxvYXQzMlZlYzIoKSl9bG9hZEJveDMoKXtyZXR1cm4gbmV3IHAodGhpcy5sb2FkRmxvYXQzMlZlYzMoKSx0aGlzLmxvYWRGbG9hdDMyVmVjMygpKX1yZWFkUGFkZCh0KXtjb25zdCBlPXRoaXMuX19ieXRlT2Zmc2V0JXQ7MCE9ZSYmKHRoaXMuX19ieXRlT2Zmc2V0Kz10LWUpfX1jbGFzcyB2e2NvbnN0cnVjdG9yKHQpe2lmKHQpe2NvbnN0IGU9dC5zcGxpdCgiLSIpLHM9ZVswXS5zcGxpdCgiLiIpO3RoaXMubWFqb3I9cGFyc2VJbnQoc1swXSksdGhpcy5taW5vcj1wYXJzZUludChzWzFdKSx0aGlzLnBhdGNoPXBhcnNlSW50KHNbMl0pLDI9PWUubGVuZ3RoJiYodGhpcy5icmFuY2g9ZVsxXSl9ZWxzZSB0aGlzLm1ham9yPTAsdGhpcy5taW5vcj0wLHRoaXMucGF0Y2g9MH1lcXVhbHModCl7cmV0dXJuISh0aGlzLnBhdGNoPT10WzJdJiZ0aGlzLm1pbm9yPT10WzFdJiZ0aGlzLm1ham9yPT10WzBdKX1sZXNzVGhhbih0KXtyZXR1cm4hKHRoaXMubWFqb3I+PXRbMF18fHRoaXMubWlub3I+PXRbMV18fHRoaXMucGF0Y2g+PXRbMl0pfWdyZWF0ZXJUaGFuKHQpe3JldHVybiB0aGlzLm1ham9yPnRbMF18fHRoaXMubWlub3I+dFsxXXx8dGhpcy5wYXRjaD50WzJdfWdyZWF0ZXJPckVxdWFsVGhhbih0KXtyZXR1cm4hKHRoaXMubWFqb3I8dFswXSkmJih0aGlzLm1ham9yPnRbMF18fCEodGhpcy5taW5vcjx0WzFdKSYmKHRoaXMubWlub3I+dFsxXXx8ISh0aGlzLnBhdGNoPHRbMl0pKSl9fXNlbGYub25tZXNzYWdlPWZ1bmN0aW9uKHQpeygodCxlKT0+e2ZvcihsZXQgZSBpbiB0LmNvbnRleHQudmVyc2lvbnMpe2NvbnN0IHM9dC5jb250ZXh0LnZlcnNpb25zW2VdLGE9bmV3IHY7YS5tYWpvcj1zLm1ham9yLGEubWlub3I9cy5taW5vcixhLnBhdGNoPXMucGF0Y2gsYS5icmFuY2g9cy5icmFuY2gsdC5jb250ZXh0LnZlcnNpb25zW2VdPWF9Y29uc3Qgcz1bXSxpPXQudG9jW3QuZ2VvbXNSYW5nZVswXV0scj1bXTtmb3IobGV0IGU9dC5nZW9tc1JhbmdlWzBdO2U8dC5nZW9tc1JhbmdlWzFdO2UrKyl7Y29uc3Qgbj1uZXcgRSh0LmJ1ZmZlclNsaWNlLHQudG9jW2VdLWksdC5pc01vYmlsZURldmljZSksaD1uLmxvYWRTdHIoKSxvPW4ucG9zKCk7bGV0IF87c3dpdGNoKGgpe2Nhc2UiUG9pbnRzIjpfPW5ldyBBO2JyZWFrO2Nhc2UiTGluZXMiOl89bmV3IFM7YnJlYWs7Y2FzZSJNZXNoIjpfPW5ldyBQO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCBHZW9tIHR5cGU6IitoKX10cnl7bi5zZWVrKG8pLF8ucmVhZEJpbmFyeShuLHQuY29udGV4dCl9Y2F0Y2godCl7Y29uc29sZS53YXJuKCJFcnJvciBsb2FkaW5nOiIrXy5uYW1lKyJcbjoiK3QpLHMucHVzaCh7fSk7Y29udGludWV9Y29uc3QgZD1fLmdlbkJ1ZmZlcnModC5nZW5CdWZmZXJzT3B0cyk7ZC5pbmRpY2VzJiZyLnB1c2goZC5pbmRpY2VzLmJ1ZmZlcik7Zm9yKGNvbnN0IHQgaW4gZC5hdHRyQnVmZmVycyl7Y29uc3QgZT1kLmF0dHJCdWZmZXJzW3RdLHM9YS5nZXRUeXBlTmFtZShlLmRhdGFUeXBlKTtlLmRhdGFUeXBlPXMsci5wdXNoKGUudmFsdWVzLmJ1ZmZlcil9ZC52ZXJ0ZXhOZWlnaGJvcnMmJnIucHVzaChkLnZlcnRleE5laWdoYm9ycy5idWZmZXIpLHIucHVzaChfLmJvdW5kaW5nQm94LnAwLl9fZGF0YS5idWZmZXIpLHIucHVzaChfLmJvdW5kaW5nQm94LnAxLl9fZGF0YS5idWZmZXIpLHMucHVzaCh7bmFtZTpfLm5hbWUsdHlwZTpoLGdlb21CdWZmZXJzOmQsYmJveDpfLmJvdW5kaW5nQm94fSl9ZSh7a2V5OnQua2V5LGdlb21JbmRleE9mZnNldDp0Lmdlb21JbmRleE9mZnNldCxnZW9tc1JhbmdlOnQuZ2VvbXNSYW5nZSxnZW9tRGF0YXM6c30scil9KSh0LmRhdGEsKHQsZSk9PntzZWxmLnBvc3RNZXNzYWdlKHQsZSl9KX07Cgo=",null,!1);class ma$1{constructor(){this.rangeLoaded=new C$1,this.streamFileParsed=new C$1,this.loaded=new C$1(!0),this.__streamInfos={},this.__genBuffersOpts={},this.__workers=[],this.__nextWorker=0;for(let t=0;t<3;t++)this.__workers.push(this.__constructWorker());this.clear()}clear(){this.__loaded=0,this.__numGeoms=0,this.geoms=[]}__constructWorker(){const t=new ca$1;return t.onmessage=t=>{this.__recieveGeomDatas(t.data.key,t.data.geomDatas,t.data.geomIndexOffset,t.data.geomsRange)},t}__terminateWorkers(){for(const t of this.__workers)t.terminate();this.__workers=[]}setGenBufferOption(t,e){this.__genBuffersOpts[t]=e}setNumGeoms(t){this.__numGeoms=t}getGeom(t){return t>=this.geoms.length?null:this.geoms[t]}loadUrl(t){re$2(t,t=>{this.loadBin(t)},t=>{console.warn(t)})}readBinaryBuffer(t,e,i){const n=t$1.isMobileDevice,s=new ge$1(e,0,n),o=s.loadUInt32(),r=s.loadUInt32();if(this.__streamInfos[t]={total:o,done:0},0==o)return this.streamFileParsed.emit(1),o;0==this.__numGeoms&&(this.__numGeoms=o);const a=s.loadUInt32Array(o);let l=window.navigator.hardwareConcurrency;l||(l=n?2:4);const c=Math.max(1,Math.floor(o/l+1));let h=0;for(;h<o;){let n,l;h+c>=o?(l=[h,o],n=e.byteLength):(l=[h,h+c],n=a[l[1]]);const d=e.slice(a[h],n);h+=c,this.__workers[this.__nextWorker].postMessage({key:t,toc:a,geomIndexOffset:r,geomsRange:l,isMobileDevice:s.isMobileDevice,bufferSlice:d,genBuffersOpts:this.__genBuffersOpts,context:i},[d]),this.__nextWorker=(this.__nextWorker+1)%this.__workers.length}return o}__recieveGeomDatas(t,e,i,n){const s=i+n[0],o=[s,i+n[1]];for(let l=0;l<e.length;l++){const t=e[l];if(!t.type)continue;let i;switch(t.type){case"Points":i=new wt$1(t);break;case"Lines":i=new zt$1(t);break;case"Mesh":case"Plane":case"Sphere":case"Cone":i=new Ut$1(t);break;default:throw new Error("Unsupported Geom type:"+className)}this.geoms[s+l]=i}this.rangeLoaded.emit(o);const r=o[1]-o[0],a=this.__streamInfos[t];a.done+=r,a.done==a.total&&this.streamFileParsed.emit(1),this.__loaded+=r,this.__loaded==this.__numGeoms&&(this.__terminateWorkers(),this.loaded.emit())}toJSON(){return{numGeoms:this.geoms.length()}}toString(){return JSON.stringify(this.toJSON(),null,2)}}class ua$1 extends ia$1{constructor(t){super(t),this.__geomLibrary=new ma$1,this.__materials=new St$1,this.loaded=new C$1(!0),this.loaded.setToggled(!0)}isLoaded(){return this.loaded.isToggled()}getEngineDataVersion(){return this.__engineDataVersion}getGeometryLibrary(){return this.__geomLibrary}getMaterialLibrary(){return this.__materials}getUnitsConversion(){return this.__unitsScale}readBinary(t,e={}){let i;e.assetItem=this,e.numTreeItems=0,e.numGeomItems=0,e.versions["zea-engine"]||(e.versions["zea-engine"]=new pe$1(t.loadStr())),this.__engineDataVersion=e.versions["zea-engine"],console.log("Loading Engine File version:",e.versions["zea-engine"]);const n={};e.addGeomToLayer=(t,e)=>{if(!n[e]){i||(i=new ia$1("Layers"),this.addChild(i,!1));const t=new ha$1(e);t.propagateXfoToItems=!1,i.addChild(t,!1),n[e]=t}n[e].addItem(t)};const s=()=>{this.__units=t.loadStr();let e=1;switch(this.__units){case"Millimeters":e=.001;break;case"Centimeters":e=.01;break;case"Meters":e=1;break;case"Kilometers":e=1e3;break;case"Inches":e=.0254;break;case"Feet":e=.3048;break;case"Miles":e=1609.34}this.__unitsScale=e;const i=this.getLocalXfo().clone();i.sc.scaleInPlace(e),this.setLocalXfo(i)};e.versions["zea-engine"].greaterThan([0,0,6])&&s(),this.__materials.readBinary(t,e),super.readBinary(t,e),e.versions["zea-engine"].greaterOrEqualThan([0,0,5])&&e.versions["zea-engine"].lessThan([0,0,7])&&s()}toJSON(t={},e=0){return t.makeRelative=t=>{const e=this.getPath(),i=t.slice(0,e.length);for(let s=0;s<i.length-1;s++)if(i[s]!=e[s])return console.warn("Param Path is not relative to the asset. May not be able to be resolved at load time:"+t),t;const n=t.slice(e.length-1);return n[0]=".",n},t.assetItem=this,super.toJSON(t,e)}fromJSON(t,e={},i=0,n){e||(e={}),e.assetItem=this,e.numTreeItems=0,e.numGeomItems=0,null==e.version&&(e.version=0),e.assetItem=this;const s=[];e.resolvePath=(t,e)=>{if(!t)throw new Error("Path not spcecified");const i=this.resolvePath(t);i?e(i):s.push(()=>{const i=this.resolvePath(t);i?e(i):console.warn("Path unable to be resolved:"+t)})},e.addPLCB=t=>s.push(t),super.fromJSON(t,e,i);for(const o of s)o();n&&n()}}J$1.registerClass("AssetItem",ua$1);class ba$1 extends ia$1{constructor(t,e){super(t);const i=this.addParameter(new We$1("Image"));e&&i.setValue(e),this.addParameter(new Ze$1("PixelsPerMeter",1e3)),this.addParameter(new Ze$1("Alpha",1)),this.addParameter(new Ie$1("Color",new y$3(1,1,1))),this.addParameter(new Xe$1("AlignedToCamera",!1))}}J$1.registerClass("BillboardItem",ba$1);class pa$1 extends ia$1{constructor(t){null==t&&(t="Camera"),super(t),this.__isOrthographicParam=this.addParameter(new Xe$1("isOrthographic",!1)),this.__fovParam=this.addParameter(new Ze$1("fov",1)),this.__nearParam=this.addParameter(new Ze$1("near",.1)),this.__farParam=this.addParameter(new Ze$1("far",1e3)),this.__focalDistanceParam=this.addParameter(new Ze$1("focalDistance",5)),this.projectionParamChanged=new C$1,this.movementFinished=new C$1,this.__isOrthographicParam.valueChanged.connect(this.projectionParamChanged.emit),this.__fovParam.valueChanged.connect(this.projectionParamChanged.emit),this.__nearParam.valueChanged.connect(this.projectionParamChanged.emit),this.__farParam.valueChanged.connect(this.projectionParamChanged.emit),this.setPositionAndTarget(new Z$1(3,3,1.75),new Z$1(0,0,1),E$1.GENERATED_VALUE),this.setLensFocalLength("28mm",E$1.GENERATED_VALUE)}getNear(){return this.__nearParam.getValue()}setNear(t){this.__nearParam.setValue(t)}getFar(){return this.__farParam.getValue()}setFar(t){this.__farParam.setValue(t)}getFov(){return this.__fovParam.getValue()}setFov(t){this.__fovParam.setValue(t)}setLensFocalLength(t,e=E$1.USER_SETVALUE){const i={"10mm":100.4,"11mm":95,"12mm":90,"14mm":81.2,"15mm":77.3,"17mm":70.4,"18mm":67.4,"19mm":64.6,"20mm":61.9,"24mm":53.1,"28mm":46.4,"30mm":43.6,"35mm":37.8,"45mm":29.9,"50mm":27,"55mm":24.6,"60mm":22.6,"70mm":19.5,"75mm":18.2,"80mm":17.1,"85mm":16.1,"90mm":15.2,"100mm":13.7,"105mm":13,"120mm":11.4,"125mm":11,"135mm":10.2,"150mm":9.1,"170mm":8.1,"180mm":7.6,"210mm":6.5,"300mm":4.6,"400mm":3.4,"500mm":2.7,"600mm":2.3,"800mm":1.7};!t in i?console.warn("Camera lense focal length not suported:"+t):this.__fovParam.setValue(Math.degToRad(i[t]),e)}getFocalDistance(){return this.__focalDistanceParam.getValue()}setFocalDistance(t,e=E$1.USER_SETVALUE){t<1e-4&&console.error("Never set focal distance to zero"),this.__focalDistanceParam.setValue(t,e),this.__nearParam.setValue(.01*t,e),this.__farParam.setValue(200*t,e)}getIsOrthographic(){return this.__isOrthographicParam.getValue()}setIsOrthographic(t,e=E$1.USER_SETVALUE){this.__isOrthographicParam.setValue(t,e)}setPositionAndTarget(t,e,i=E$1.USER_SETVALUE){this.setFocalDistance(t.distanceTo(e),i);const n=new S$1;n.setLookAt(t,e,new Z$1(0,0,1)),this.setGlobalXfo(n,i)}getTargetPostion(){const t=this.__focalDistanceParam.getValue(),e=this.getGlobalXfo(),i=e.ori.getZaxis();return i.scaleInPlace(-t),i.addInPlace(e.tr),i}frameView(t,e,i=E$1.USER_SETVALUE){const n=new v$1;for(const y of e)n.addBox3(y.getBoundingBox());if(!n.isValid())return void console.warn("Bounding box not valid.");const s=this.__focalDistanceParam.getValue(),o=this.__fovParam.getValue(),r=this.getGlobalXfo().clone(),a=r.ori.getZaxis(),l=a.scale(-s),c=r.tr.add(l),h=n.center().subtract(c);r.tr.addInPlace(h);const d=new v$1;d.addBox3(n,r.inverse()),d.center();const u=o*(t.getWidth()/t.getHeight()),m=d.p1,p=Math.abs(m.x)/Math.tan(.5*u)*1.2,b=Math.abs(m.y)/Math.tan(.5*o)*1.2,f=-.5*(d.p0.z-d.p1.z),g=Math.max(p,b)+f;r.tr.addInPlace(a.scale(g-s)),this.setFocalDistance(g,i),this.setGlobalXfo(r,i),this.movementFinished.emit()}updateProjectionMatrix(t,e){this.__isOrthographicParam.getValue();const i=this.__fovParam.getValue(),n=this.__nearParam.getValue(),s=this.__farParam.getValue();t.setPerspectiveMatrix(i,e,n,s)}}J$1.registerClass("Camera",pa$1);class ga$1 extends te$1{constructor(t){super(t),this.addParameter(new Ie$1("BackgroundColor",new y$3("#808080"))),this.addParameter(new We$1("EnvMap")),this.addParameter(new Xe$1("Display EnvMap",!1)),this.addParameter(new Ze$1("EnvMapLOD",0))}}class _a$1 extends ua$1{constructor(t){super(t),this.loaded.setToggled(!1),this.lightmap=null,this.geomsLoaded=new C$1(!0),this.geomsLoaded.setToggled(!1),this.loaded.setToggled(!1),this.__geomLibrary.loaded.connect(()=>{this.geomsLoaded.emit()}),this.__datafileParam=this.addParameter(new Fe$1("DataFilePath")),this.__datafileParam.valueChanged.connect(()=>{const t=this.__datafileParam.getFileDesc();if(t){if(console.log(t),""==this.getName()){const t=this.__datafileParam.getStem();this.setName(t)}this.geomsLoaded.setToggled(!1),this.loadDataFile(()=>{this.loaded.isToggled()||this.loaded.emit()},()=>{})}}),this.addParameter(new Ie$1("LightmapTint",new y$3(1,1,1,1)))}readBinary(t,e){if(-1!=e.version){const t=new pe$1;t.patch=e.version,e.versions={"zea-mesh":t,"zea-engine":t},e.meshSdk="FBX"}else{const i=t.loadUInt8();if(t.seek(0),10!=i){const i=new pe$1;i.patch=t.loadUInt32(),e.versions={"zea-mesh":i,"zea-engine":i},e.meshSdk="FBX"}else{const i=new pe$1(t.loadStr());e.versions={"zea-mesh":i},e.meshSdk="FBX"}}this.meshfileversion=e.versions["zea-mesh"],this.meshSdk=e.meshSdk,console.log("Loading CAD File version:",e.versions["zea-mesh"]," exported using SDK:",e.meshSdk);const i=t.loadUInt32();return super.readBinary(t,e),e.versions["zea-engine"].lessThan([0,0,5])&&t.seek(t.byteLength-4),this.__geomLibrary.setNumGeoms(t.loadUInt32()),i}loadDataFile(t,e){const i=this.__datafileParam.getFileDesc();if(!i)return void console.warn("VLAAsset data file not found.");const n=this.__datafileParam.getFileFolderPath(),s=this.__datafileParam.getValue(),o=this.__datafileParam.getStem();let r=0;const a=new RegExp("\\.(vla)$","i").test(i.name),l=[],c=i=>{let n,o=-1;if(i.tree2)n=new ge$1(i.tree2.buffer,0,t$1.isMobileDevice);else{const t=i.tree?i.tree:i[Object.keys(i)[0]];n=new ge$1(t.buffer,0,t$1.isMobileDevice),o=0}r=this.readBinary(n,{assetItem:this,version:o}),a||r!=l.length&&console.error("The number of GeomFiles does not match the count given by the VLA file."),t(),0==r&&i.geoms0?(be$1.addWork(s+"geoms",1),this.__geomLibrary.readBinaryBuffer(s,i.geoms0.buffer,{version:o}),e()):(be$1.addWork(s+"geoms",4*r),h())},h=()=>{const t=[];for(let e=0;e<r;e++)if(a){const i=n+o+e+".vlageoms",s=be$1.resolveFilepath(i);if(!s)throw new Error("VLA Geoms file not found:"+i);t.push(d(e,s.url))}else t.push(d(e,l[e].url));Promise.all(t).then(()=>{e&&e()})},d=(t,e)=>new Promise(i=>{be$1.loadUrl(s+t,e,t=>{const e=t[Object.keys(t)[0]];this.__geomLibrary.readBinaryBuffer(s,e.buffer),i()},!1)});if(a)be$1.loadResource(s,c);else if(i.metadata.ConvertFile){let t;i.metadata.ConvertFile.map(e=>{e.filename.endsWith(".vla")?t=e:e.filename.endsWith(".vlageoms")&&l.push(e)}),t?be$1.loadUrl(s,t.url,c):console.warn("ConvertFile metadata contains no vla file.")}this.__geomLibrary.streamFileParsed.connect(t=>{be$1.addWorkDone(s+"geoms",t)})}fromJSON(t,e,i){e||(e={}),e.assetItem=this;const n=()=>{super.fromJSON(t,e,i),i&&i()};if(t.params&&t.params.DataFilePath){this.__datafileLoaded=n;const i=t.params.DataFilePath;delete t.params.DataFilePath,this.__datafileParam.fromJSON(i,e)}else n()}}J$1.registerClass("VLAAsset",_a$1);const Za$1=new y$3("#DCDCDC");class Ga$1{constructor(t){t&&be$1.setResources(t),this.settings=new ga$1("Scene Settings"),this.root=new ia$1("root"),this.root.addChild(this.settings),this.__commonResources={}}getSettings(){return this.settings}getRoot(){return this.root}getResourceLoader(){return be$1}setEnvMap(t){console.warn("Deprecated Function. Please access the Scene Settings object."),this.settings.getParameter("EnvMap").setValue(t)}addAsset(t){console.warn("Deprecated Function. Please access the Scene Root object."),this.root.addChild(t,!1)}setupGrid(t=5,e=50,i=Za$1){const n=new ia$1("Grid"),s=new Pe$1("gridMaterial","LinesShader");s.getParameter("BaseColor").setValue(i);const o=new Bt$1(t,t,e,e,!0);n.addChild(new oa$1("GridItem",o,s),!1);const r=new Nt$1;r.setNumVertices(2),r.setNumSegments(1),r.setSegment(0,0,1),r.getVertex(0).set(-.5*t,0,0),r.getVertex(1).set(.5*t,0,0);const a=new Pe$1("gridXAxisMaterial","LinesShader");a.getParameter("BaseColor").setValue(new y$3(i.luminance(),0,0)),n.addChild(new oa$1("xAxisLine",r,a),!1);const l=new Pe$1("gridZAxisMaterial","LinesShader");l.getParameter("BaseColor").setValue(new y$3(0,i.luminance(),0));const c=new S$1;c.ori.setFromAxisAndAngle(new Z$1(0,0,1),.5*Math.PI);const h=new oa$1("yAxisLine",r,l);return h.setGeomOffsetXfo(c),n.addChild(h,!1),n.setSelectable(!1,!0),n.setFlag($$1.IGNORE_BBOX),n.clearFlag($$1.USER_EDITED),n.setFlag($$1.INVISIBLE),this.root.addChild(n,!1),n}loadCommonAssetResource(t){if(t in this.__commonResources)return this.__commonResources[t];const e=new _a$1;return e.getParameter("DataFilePath").setValue(t),this.__commonResources[t]=e,e}toJSON(t={},e=0){return t.makeRelative=t=>t,{root:this.root.toJSON(t,e)}}fromJSON(t,e={}){const i=[];e.resolvePath=(t,e)=>{if(!t)throw new Error("Path not spcecified");const n=this.root.resolvePath(t);n?e(n):i.push(()=>{const i=this.resolvePath(t);i?e(i):console.warn("Path unable to be resolved:"+t)})},e.addPLCB=t=>i.push(t),e.settings=this.settings,t.root&&this.root.fromJSON(t.root,e);for(const n of i)n()}}class Xa$1 extends ua$1{constructor(t){super(t),this.geomsLoaded=new C$1(!0),this.geomsLoaded.setToggled(!1),this.loaded.setToggled(!1),this.addParameter(new Xe$1("splitObjects",!1)),this.addParameter(new Xe$1("splitGroupsIntoObjects",!1)),this.addParameter(new Xe$1("loadMtlFile",!0)),this.addParameter(new Ze$1("unitsConversion",1)),this.addParameter(new Le$1("defaultShader","")),this.objfileParam=this.addParameter(new Fe$1("ObjFilePath")),this.objfileParam.valueChanged.connect(()=>{this.loaded.untoggle(),this.__loadObj(()=>{this.loaded.emit()},()=>{this.geomsLoaded.emit()})}),this.geomLibrary=new ma$1,this.materials=new St$1}getGeometryLibrary(){return this.geomLibrary}getMaterialLibrary(){return this.materials}__loadObj(t,e){const i=this.objfileParam.getStem(),n=t=>{const e=t.split("\n"),i=/\s+/;let n;const s=function(t){if(3==t.length)return new y$3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]));throw new Error("Unable to parse a color from the following parts:"+t.join("_"))},o=t=>{const e=this.objfileParam.getFileFolder();return new FileImage(t[0],e+t[0])};for(let r=0;r<e.length;r++){let t=e[r].trim();if(t.startsWith("#"))continue;-1!=t.indexOf("#")&&(t=t.substring(0,t.indexOf("#")).trim());const a=t.split(i),l=a.shift(),c=a.join(" ");switch(l){case"newmtl":n=new Pe$1(c),n.setShaderName("StandardSurfaceShader"),this.materials.addMaterial(n);break;case"Kd":n.getParameter("BaseColor").setValue(s(a));break;case"map_Kd":n.getParameter("BaseColor").setValue(o(a));break;case"Ks":const t=(parseFloat(a[0])+parseFloat(a[1])+parseFloat(a[2]))/3;n.roughness=1-t,n.getParameter("Roughness").setValue(1-t),n.getParameter("Reflectance").setValue(t);break;case"map_Ks":n.getParameter("Roughness").setValue(o(a)),n.getParameter("Reflectance").setValue(.2);break;case"d":const e=parseFloat(c);e<1&&(n.setShaderName("TransparentSurfaceShader"),n.getParameter("Opacity").setValue(e));break;case"map_d":n.getParameter("alpha").setValue(parseFloat(a));break;case"map_bump":n.getParameter("normal").setValue(o(a))}}},s=new Y$1;s.incAsyncCount(),s.ready.connect(()=>{d()});const o=t=>new Promise(e=>{se$1(t.url,t=>{be$1.addWorkDone(i,1),n(t),s.decAsyncCount(),be$1.addWorkDone(i,1),e()})}),r=new Array,a=new Array,l=new Array,c={},h=async t=>{const e=t.split("\n"),n=/\s+/;let h=void 0,d=void 0;const u=t=>{let e=0;for(;t in c;)e++,t+=String(e);h={verticesRemapping:{},texCoordsRemapping:{},normalsRemapping:{},vertexIndices:[],texCoordIndices:[],normalIndices:[],numVertices:0,numTexCoords:0,numNormals:0,numTris:0,numQuads:0,material:d},c[t]=h};u(i);const m=this.getParameter("splitGroupsIntoObjects").getValue();for(let p=0;p<e.length;p++){let t=e[p].trim();if(t.startsWith("#"))continue;-1!=t.indexOf("#")&&(t=t.substring(0,t.indexOf("#")).trim());const b=t.split(n),f=b.shift(),g=b.join(" ");switch(f){case"":case"s":continue;case"mtllib":if(!this.getParameter("loadMtlFile").getValue())continue;s.incAsyncCount(),be$1.addWork(i,2);const e=this.objfileParam.getFileFolderPath(),n=be$1.resolveFilepath(e+g);n&&await o(n);break;case"o":u(g);break;case"usemtl":d=g,u(g+Object.keys(c).length);break;case"g":m&&u(b.join("_"));break;case"v":r.push(b.map(t=>parseFloat(t)));break;case"vt":l.push(b.map(t=>parseFloat(t)));break;case"vn":a.push(b.map(t=>parseFloat(t)));break;case"f":{const t=[],e=[],i=[];for(let n=0,s=b.length;n<s;n++){const s=b[n].split("/").map(t=>parseInt(t)-1),o=s[0];let r=h.verticesRemapping[o];null==r&&(r=h.numVertices,h.verticesRemapping[o]=r,h.numVertices++),t.push(r),s.length>1&&!isNaN(s[1])&&e.push(s[1]),s.length>2&&!isNaN(s[2])&&i.push(s[2])}h.vertexIndices.push(t),i.length>0&&h.normalIndices.push(i),e.length>0&&h.texCoordIndices.push(e),3==t.length?h.numTris++:h.numQuads++;break}default:console.warn("Unhandled line:"+t)}}s.decAsyncCount()},d=()=>{for(const t in c)0!=c[t].numVertices&&u(t,c[t]);t(),e()},u=(t,e)=>{const i=e.numVertices,n=new Yt$1(t);n.setFaceCounts([e.numTris,e.numQuads]),n.setNumVertices(i);const s=n.getVertexAttribute("positions"),o=this.getParameter("unitsConversion").getValue();for(const a in e.verticesRemapping)s.getValueRef(e.verticesRemapping[a]).set(r[a][0]*o,r[a][1]*o,r[a][2]*o);let c,h;e.normalIndices.length>0&&(c=n.addVertexAttribute("normals",Z$1)),e.texCoordIndices.length>0&&(h=n.addVertexAttribute("texCoords",_$1));for(let r=0;r<e.vertexIndices.length;r++){if(n.setFaceVertexIndices(r,...e.vertexIndices[r]),c){const t=e.normalIndices[r];for(let e=0;e<t.length;e++){const i=new Z$1(a[t[e]][0],a[t[e]][1],a[t[e]][2]);c.setFaceVertexValue(r,e,i)}}if(h&&e.texCoordIndices.length==e.vertexIndices.length){const t=e.texCoordIndices[r];for(let e=0;e<t.length;e++){const i=new _$1(l[t[e]][0],l[t[e]][1]);h.setFaceVertexValue(r,e,i)}}}const d=new oa$1(t,n);d.selectable=!0;const u=n.boundingBox.center();if(n.moveVertices(u.negate()),d.setLocalXfo(new S$1(u)),null!=e.material&&this.materials.hasMaterial(e.material))d.setMaterial(this.materials.getMaterial(e.material));else{const e=this.getParameter("defaultShader").getValue(),i=new Pe$1(t+"mat");i.setShaderName(""!=e?e:"StandardSurfaceShader");const n=i.getParameter("BaseColor");if(n)n.setValue(y$3.random(.5));else{const t=i.getParameter("Color");t&&t.setValue(y$3.random(.5))}const s=i.getParameter("Roughness");s&&s.setValue(.6);const o=i.getParameter("Reflectance");o&&o.setValue(.2),this.materials.addMaterial(i),d.setMaterial(i)}this.addChild(d,!1)};(()=>{const t=this.objfileParam.getFileDesc(),e=this.objfileParam.getStem();be$1.addWork(e,2),se$1(t.url,t=>{be$1.addWorkDone(e,1),h(t),be$1.addWorkDone(e,1)})})()}}class ya$1 extends te$1{constructor(t){super(t),this.setFlag($$1.USER_EDITED),this.__outputs=[],this.__evalOutput=this.__evalOutput.bind(this),this.postEval=new C$1}setDirty(){for(const t of this.__outputs)t.setDirtyFromOp()}__parameterValueChanged(t,e){this.setDirty()}addOutput(t){return this.__outputs.push(t),t.paramSet.connect(t=>{t.bindOperator(this)}),t}removeOutput(t){t.getParam()&&t.getParam().unbindOperator(this),this.__outputs.splice(this.__outputs.indexOf(t),1)}getNumOutputs(){return this.__outputs.length}getOutputByIndex(t){return this.__outputs[t]}getOutput(t){for(const e of this.__outputs)if(e.getName()==t)return e}__evalOutput(t){for(const e of this.__outputs)e.removeCleanerFn(this.__evalOutput);this.evaluate()}__opInputChanged(){this.setDirty()}evaluate(){throw new Error("Not yet implemented")}toJSON(t,e){const i=super.toJSON(t,e);i.type=J$1.getClassName(this);const n=[];for(const s of this.__outputs)n.push(s.toJSON(t,e));return i.outputs=n,i}fromJSON(t,e,i){if(super.fromJSON(t,e,i),t.outputs){for(let i=0;i<this.__outputs.length;i++)this.__outputs[i].fromJSON(t.outputs[i],e);e.addPLCB(()=>{this.__opInputChanged()})}}detach(){this.__outputs.forEach(t=>t.detach())}reattach(){this.__outputs.forEach(t=>t.reattach())}destroy(){super.destroy(),this.__outputs=[]}}class fa$1{constructor(t,e){this.__name=t,this.__filterFn=e,this._param=void 0,this.detached=!1,this.paramSet=new C$1}getName(){return this.__name}getFilterFn(){return this.__filterFn}isConnected(){return null!=this._param}getParam(){return this._param}setParam(t){this._param=t,this.paramSet.emit()}getValue(t=P$1.OPERATOR_GETVALUE){if(this._param)return this._param.getValue(t)}setValue(t,e=E$1.OPERATOR_SETVALUE){this._param&&this._param.setValue(t,e)}setClean(t){this._param&&this._param.setClean(t)}setDirty(t){this._param&&this._param.setDirty(t)}setDirtyFromOp(){this._param&&this._param.setDirtyFromOp()}removeCleanerFn(t){this._param&&this._param.removeCleanerFn(t)}toJSON(t,e){const i=this._param?this._param.getPath():"";return{type:J$1.getClassName(this),paramPath:t&&t.makeRelative?t.makeRelative(i):i}}fromJSON(t,e,i){t.paramPath&&e.resolvePath(t.paramPath,t=>{this.setParam(t)},()=>{console.warn("Operator Output: '"+this.getName()+"'. Unable to load item:"+t.paramPath)})}detach(){this.detached=!0}reattach(){this.detached=!1}}J$1.registerClass("OperatorOutput",fa$1);class Va$1 extends fa$1{constructor(t){super(t,t=>"Xfo"==t.getDataType())}getInitialValue(){return this._initialParamValue}setParam(t){(()=>{if(this._initialParamValue=t.getValue(),this._initialParamValue.clone&&(this._initialParamValue=this._initialParamValue.clone()),null==this._initialParamValue)throw new Error("WTF?")})(),this._param=t,this.paramSet.emit(t)}}J$1.registerClass("XfoOperatorOutput",Va$1);class Ia$1 extends Me$1{constructor(t){super(t),this.__stageParam=this._addMember(new Ze$1("Stage",0)),this.__axisParam=this._addMember(new fe$1("Axis",new Z$1(1,0,0))),this.__movementParam=this._addMember(new ye$1("MovementTiming",new _$1(0,1),[new _$1(0,0),new _$1(1,1)])),this.__multiplierParam=this._addMember(new Ze$1("Multiplier",1)),this.__output=new Va$1("Part")}getStage(t=E$1.USER_GETVALUE){return this.__stageParam.getValue(t)}setStage(t,e=E$1.USER_SETVALUE){this.__stageParam.setValue(t,e)}getOutput(){return this.__output}evaluate(t,e,i,n,s,o,r,a){if(!this.__output.isConnected())return;const l=this.__stageParam.getValue(),c=this.__movementParam.getValue();let h;if(s){let i=l/n;o&&(i-=.5),h=e*Math.linStep(c.x,c.y,Math.max(0,t-i))}else{let i=1-l/n;o&&(i-=.5),h=e*Math.linStep(c.x,c.y,t)*i}h+=i;let d=this.__axisParam.getValue();const u=this.__multiplierParam.getValue(),m=this.__output.getInitialValue();let p;r?(p=a.multiply(m),d=r.ori.rotateVec3(d),p.tr.addInPlace(d.scale(h*u))):(p=this.__output.getValue(),p.tr=m.tr.add(d.scale(h*u))),this.__output.setClean(p)}toJSON(t,e){const i=super.toJSON(t,e);return i&&(i.output=this.__output.toJSON(t,e)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.output&&this.__output.fromJSON(t.output,e)}}class Ra$1 extends ya$1{constructor(t){super(t),this.__stagesParam=this.addParameter(new Ze$1("Stages",0)),this._explodeParam=this.addParameter(new Ze$1("Explode",0,[0,1])),this._distParam=this.addParameter(new Ze$1("Dist",1)),this._offsetParam=this.addParameter(new Ze$1("Offset",0)),this._cascadeParam=this.addParameter(new Xe$1("Cascade",!1)),this._centeredParam=this.addParameter(new Xe$1("Centered",!1)),this.__parentItemParam=this.addParameter(new Ce$1("RelativeTo")),this.__parentItemParam.valueChanged.connect(()=>{const t=this.__parentItemParam.getValue();this.__invParentSpace=t?t.getGlobalXfo().inverse():void 0}),this.__parentItemParam.treeItemGlobalXfoChanged.connect(()=>{this.setDirty()}),this.__itemsParam=this.addParameter(new Te$1("Parts",Ia$1)),this.__itemsParam.elementAdded.connect((t,e)=>{if(e>0){const i=this.__itemsParam.getElement(e-1).getStage();t.setStage(i+1),this.__stagesParam.setClean(i+2)}else this.__stagesParam.setClean(1);this.addOutput(t.getOutput()),this.setDirty()}),this.__itemsParam.elementRemoved.connect(t=>{this.removeOutput(t.getOutput())}),this.__localXfos=[],this.__parts=[],this.__stages=2}evaluate(){const t=this.__stagesParam.getValue(),e=this._explodeParam.getValue(),i=this._distParam.getValue(),n=this._offsetParam.getValue(),s=this._cascadeParam.getValue(),o=this._centeredParam.getValue(),r=this.__parentItemParam.getValue();let a,l;r&&(a=r.getGlobalXfo(),l=this.__invParentSpace.multiply(a));const c=this.__itemsParam.getValue();for(let h=0;h<c.length;h++)c[h].evaluate(e,i,n,t,s,o,a,l)}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i)}destroy(){clearTimeout(this.__timeoutId),super.destroy()}}J$1.registerClass("ExplodePartsOperator",Ra$1);class xa$1 extends Me$1{constructor(t){super(t),this.__ratioParam=this._addMember(new Ze$1("Ratio",1)),this.__offsetParam=this._addMember(new Ze$1("Offset",0)),this.__axisParam=this._addMember(new fe$1("Axis",new Z$1(1,0,0))),this.__output=new Va$1("Gear")}getOutput(){return this.__output}getRatio(){return this.__ratioParam.getValue()}getOffset(){return this.__offsetParam.getValue()}getAxis(){return this.__axisParam.getValue()}toJSON(t,e){const i=super.toJSON(t,e);return i&&(i.output=this.__output.toJSON(t,e)),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.output&&this.__output.fromJSON(t.output,e)}}class Sa$1 extends ya$1{constructor(t){super(t),this.__revolutionsParam=this.addParameter(new Ze$1("Revolutions",0));const e=this.addParameter(new Ze$1("RPM",0));e.valueChanged.connect(()=>{const t=e.getValue();if(Math.abs(t)>0){if(!this.__timeoutId){const t=()=>{const i=e.getValue(),n=this.__revolutionsParam.getValue();this.__revolutionsParam.setValue(n+i*(1/3e3)),this.__timeoutId=setTimeout(t,20)};t()}}else clearTimeout(this.__timeoutId),this.__timeoutId=void 0}),this.__gearsParam=this.addParameter(new Te$1("Gears",xa$1)),this.__gearsParam.elementAdded.connect(t=>{this.addOutput(t.getOutput())}),this.__gearsParam.elementRemoved.connect((t,e)=>{this.removeOutput(e)}),this.__gears=[]}evaluate(){const t=this.__revolutionsParam.getValue(),e=this.__gearsParam.getValue();for(const i of e){const e=i.getOutput(),n=e.getInitialValue();if(!n)return;const s=t*i.getRatio()+i.getOffset(),o=new R$1;o.setFromAxisAndAngle(i.getAxis(),s*Math.PI*2);const r=e.getValue();r.ori=o.multiply(n.ori),e.setClean(r)}}detach(){super.detach(),this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=null)}reattach(){super.reattach(),this.getParameter("RPM").valueChanged.emit()}destroy(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=null),super.destroy()}}J$1.registerClass("GearsOperator",Sa$1);class Wa$1 extends Me$1{constructor(){super("Piston"),this.__pistonAngleParam=this._addMember(new Ze$1("PistonAngle",0)),this.__camPhaseParam=this._addMember(new Ze$1("CamPhase",0)),this.__camLengthParam=this._addMember(new Ze$1("CamLength",3)),this.__rodLengthParam=this._addMember(new Ze$1("RodLength",3)),this.__rodoutput=new Va$1("Rod"),this.__capoutput=new Va$1("Cap"),this.__pistonAngleParam.valueChanged.connect(this.init.bind(this)),this.__camPhaseParam.valueChanged.connect(this.init.bind(this)),this.__camLengthParam.valueChanged.connect(this.init.bind(this)),this.__rodLengthParam.valueChanged.connect(this.init.bind(this)),this.__bindXfos={}}getRodOutput(){return this.__rodoutput}getCapOutput(){return this.__capoutput}setCrankXfo(t){this.__baseCrankXfo=t,this.init()}init(){if(!this.__baseCrankXfo)return;const t=this.__camPhaseParam.getValue(),e=this.__camLengthParam.getValue(),i=this.__rodLengthParam.getValue(),n=this.__pistonAngleParam.getValue(),s=new Z$1(Math.sin(Math.degToRad(n)),Math.cos(Math.degToRad(n)),0);this.__pistonAxis=this.__baseCrankXfo.ori.rotateVec3(s),this.__camVec=this.__baseCrankXfo.ori.rotateVec3(new Z$1(Math.sin(2*t*Math.PI)*e,Math.cos(2*t*Math.PI)*e,0));const o=2*t*Math.PI,r=Math.sin(o)*e,a=Math.sqrt(i*i-r*r)+Math.cos(o)*e;this.__pistonOffset=a}evaluate(t,e,i){const n=this.__camPhaseParam.getValue(),s=this.__camLengthParam.getValue(),o=this.__rodLengthParam.getValue(),r=2*(n+i)*Math.PI,a=Math.sin(r)*s,l=Math.asin(a/o),c=Math.sqrt(o*o-a*a)+Math.cos(r)*s;if(this.__rodoutput.isConnected()){const i=this.__rodoutput.getInitialValue().clone(),n=this.__rodoutput.getValue(),s=n.tr.subtract(this.__baseCrankXfo.tr).dot(e),o=new R$1;o.setFromAxisAndAngle(e,-l),n.tr=this.__baseCrankXfo.tr.add(t.rotateVec3(this.__camVec)),n.tr.addInPlace(e.scale(s)),n.ori=o.multiply(i.ori),this.__rodoutput.setValue(n)}if(this.__capoutput.isConnected()){const t=this.__capoutput.getInitialValue().clone(),e=this.__capoutput.getValue();e.tr=t.tr.add(this.__pistonAxis.scale(c-this.__pistonOffset)),this.__capoutput.setValue(e)}}setOwner(t){this.__owner=t}getOwner(){return this.__owner}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i)}clone(t){return new Wa$1(this.__name,this.__value)}}class La$1 extends ya$1{constructor(t){super(t),this.__revolutionsParam=this.addParameter(new Ze$1("Revolutions",0,[0,1]));const e=this.addParameter(new Ze$1("RPM",0));e.valueChanged.connect(()=>{let t=e.getValue();if(t>0){if(!this.__timeoutId){const i=()=>{t=e.getValue();const n=this.__revolutionsParam.getValue();this.__revolutionsParam.setValue(n+t*(1/3e3)),this.__timeoutId=setTimeout(i,20)};i()}}else clearTimeout(this.__timeoutId),this.__timeoutId=void 0}),this.__crankOutput=this.addOutput(new Va$1("Crank")),this.__crankOutput.paramSet.connect(this.init.bind(this)),this.__crankAxisParam=this.addParameter(new fe$1("CrankAxis",new Z$1(1,0,0))),this.__crankAxisParam.valueChanged.connect(()=>{this.__baseCrankXfo.ori.setFromDirectionAndUpvector(this.__crankAxisParam.getValue(),new Z$1(0,0,1)),this.init()}),this.__pistonsParam=this.addParameter(new Te$1("Pistons",Wa$1)),this.__pistonsParam.elementAdded.connect(t=>{t.setCrankXfo(this.__baseCrankXfo),this.addOutput(t.getRodOutput()),this.addOutput(t.getCapOutput())}),this.__pistonsParam.elementRemoved.connect(t=>{this.removeOutput(t.getRodOutput()),this.removeOutput(t.getCapOutput())}),this.__baseCrankXfo=new S$1,this.__pistons=[]}setOwner(t){super.setOwner(t)}getCrankOutput(){return this.__crankOutput}init(){const t=this.__pistonsParam.getValue();for(const e of t)e.setCrankXfo(this.__baseCrankXfo);this.__crankOutput.isConnected()&&(this.__crankOffset=this.__baseCrankXfo.inverse().multiply(this.__crankOutput.getInitialValue()))}evaluate(){const t=this.__revolutionsParam.getValue(P$1.OPERATOR_GETVALUE),e=this.__crankAxisParam.getValue(P$1.OPERATOR_GETVALUE),i=new R$1;if(i.setFromAxisAndAngle(e,t*Math.PI*2),this.__crankOutput.isConnected()){const t=this.__crankOutput.getValue();t.ori=i.multiply(this.__crankOutput.getInitialValue().ori),this.__crankOutput.setValue(t)}const n=this.__pistonsParam.getValue(),s=n.length;for(let o=0;o<s;o++)n[o].evaluate(i,e,t);this.postEval.emit(t)}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i),t.crankOutput&&this.__crankOutput.fromJSON(t.crankOutput,e),this.init()}destroy(){clearTimeout(this.__timeoutId),super.destroy()}}J$1.registerClass("PistonOperator",La$1);class va$1 extends ya$1{constructor(t){super(t),this.__inputParam=this.addParameter(new Ze$1("Input")),this.__routesParam=this.addParameter(new Te$1("Routes",Ze$1)),this.__routesParam.elementAdded.connect(t=>{t.setValue(1),this.addOutput(new fa$1("Output"))}),this.__routesParam.elementRemoved.connect((t,e)=>{this.removeOutput(this.getOutputByIndex(e))})}evaluate(){const t=this.__inputParam.getValue(P$1.OPERATOR_GETVALUE),e=this.__routesParam.getValue();let i=this.__outputs.length;for(;i--;)this.__outputs[i].setValue(t*e[i].getValue(P$1.OPERATOR_GETVALUE));this.postEval.emit(t)}toJSON(t,e){return super.toJSON(t,e)}fromJSON(t,e,i){super.fromJSON(t,e,i)}destroy(){super.destroy()}}J$1.registerClass("RouterOperator",va$1);class Fa$1 extends ya$1{constructor(t){super(t),this.addParameter(new Ze$1("Weight",1)),this.addParameter(new Ge$1("Axis",0,["+X Axis","-X Axis","+Y Axis","-Y Axis","+Z Axis","-Z Axis"])),this.addParameter(new Ze$1("Stretch",0)),this.addParameter(new Ze$1("Initial Dist",1)),this.addParameter(new Se$1("Target")),this.addOutput(new Va$1("InputOutput"))}resetStretchRefDist(){const t=this.getParameter("Target").getValue(),e=this.getOutputByIndex(0).getValue(),i=t.tr.subtract(e.tr).length();this.getParameter("Initial Dist").setValue(i)}evaluate(){const t=this.getParameter("Weight").getValue(),e=this.getParameter("Target").getValue(),i=this.getParameter("Axis").getValue(),n=this.getOutputByIndex(0),s=n.getValue(),o=e.tr.subtract(s.tr),r=o.length();if(r<1e-6)return;let a;switch(o.scaleInPlace(1/r),i){case 0:a=s.ori.getXaxis();break;case 1:a=s.ori.getXaxis().negate();break;case 2:a=s.ori.getYaxis();break;case 3:a=s.ori.getYaxis().negate();break;case 4:a=s.ori.getZaxis();break;case 5:a=s.ori.getZaxis().negate()}let l=new R$1;l.setFrom2Vectors(a,o),l.alignWith(new R$1),t<1&&(l=(new R$1).lerp(l,t)),s.ori=l.multiply(s.ori);const c=this.getParameter("Stretch").getValue();if(c>0){const t=1+(r/this.getParameter("Initial Dist").getValue()-1)*c;switch(i){case 0:case 1:s.sc.x=t;break;case 2:case 3:s.sc.y=t;break;case 4:case 5:s.sc.z=t}}n.setClean(s)}}J$1.registerClass("AimOperator",Fa$1);class Ta$1 extends q$1{constructor(t){null==t&&(t="Camera"),super(t),this.__defaultManipulationState="orbit",this.__manipulationState=this.__defaultManipulationState,this.__mouseDown=!1,this.__dragging=!1,this.__mouseDragDelta=new _$1,this.__keyboardMovement=!1,this.__keysPressed=[],this.__maxVel=.002,this.__velocity=new Z$1,this.__ongoingTouches={},this.__orbitRateParam=this.addParameter(new Ze$1("orbitRate",t$1.isMobileDevice?-.3:1)),this.__dollySpeedParam=this.addParameter(new Ze$1("dollySpeed",.02)),this.__mouseWheelDollySpeedParam=this.addParameter(new Ze$1("mouseWheelDollySpeed",5e-4)),this.movementFinished=new C$1}setDefaultManipulationMode(t){this.__defaultManipulationState=t}look(t,e){const{viewport:i}=t,n=i.getCamera(),s=n.getFocalDistance(),o=this.__orbitRateParam.getValue();if(this.__keyboardMovement){const t=n.getGlobalXfo();this.__mouseDownCameraXfo=t.clone(),this.__mouseDownZaxis=t.ori.getZaxis();const e=this.__mouseDownZaxis.scale(-s);this.__mouseDownCameraTarget=t.tr.add(e)}const r=this.__mouseDownCameraXfo.clone(),a=new R$1;a.rotateZ(e.x/i.getWidth()*Math.PI*o),r.ori=a.multiply(r.ori);const l=new R$1;l.rotateX(e.y/i.getHeight()*Math.PI*o),r.ori.multiplyInPlace(l),n.setGlobalXfo(r)}orbit(t,e){const{viewport:i}=t,n=i.getCamera(),s=n.getFocalDistance(),o=this.__orbitRateParam.getValue();if(this.__keyboardMovement){const t=n.getGlobalXfo();this.__mouseDownCameraXfo=t.clone(),this.__mouseDownZaxis=t.ori.getZaxis();const e=this.__mouseDownZaxis.scale(-s);this.__mouseDownCameraTarget=t.tr.add(e)}const r=this.__mouseDownCameraXfo.clone(),a=new R$1;a.rotateZ(e.x/i.getWidth()*2*Math.PI*-o),r.ori=a.multiply(r.ori);const l=new R$1;l.rotateX(e.y/i.getHeight()*Math.PI*-o),r.ori.multiplyInPlace(l),r.tr=this.__mouseDownCameraTarget.add(r.ori.getZaxis().scale(s)),n.setGlobalXfo(r)}pan(t,e){const{viewport:i}=t,n=i.getCamera(),s=n.getFocalDistance(),o=n.getFov(),r=new Z$1(1,0,0),a=new Z$1(0,1,0),l=2*s*Math.tan(.5*o),c=l*(i.getWidth()/i.getHeight()),h=new S$1;h.tr=r.scale(-e.x/i.getWidth()*c),h.tr.addInPlace(a.scale(e.y/i.getHeight()*l)),n.setGlobalXfo(this.__mouseDownCameraXfo.multiply(h))}dolly(t,e){const{viewport:i}=t,n=i.getCamera(),s=e.x*this.__dollySpeedParam.getValue(),o=new S$1;o.tr.set(0,0,s),n.setGlobalXfo(this.__mouseDownCameraXfo.multiply(o))}panAndZoom(t,e,i){const{viewport:n}=t,s=n.getCamera(),o=s.getFocalDistance(),r=s.getFov(),a=new Z$1(1,0,0),l=new Z$1(0,1,0),c=2*o*Math.tan(.5*r),h=c*(n.getWidth()/n.getHeight()),d=new S$1;d.tr=a.scale(-e.x/n.getWidth()*h),d.tr.addInPlace(l.scale(e.y/n.getHeight()*c));const u=i*o;s.setFocalDistance(this.__mouseDownFocalDist+u),d.tr.z+=u,s.setGlobalXfo(this.__mouseDownCameraXfo.multiply(d))}initDrag(t){const{viewport:e}=t,i=e.getCamera(),n=i.getFocalDistance();this.__mouseDown=!0,this.__calculatingDragAction=!1,this.__mouseDownPos=t.mousePos,this.__mouseDownViewport=e,this.__mouseDragDelta.set(0,0),this.__mouseDownCameraXfo=i.getGlobalXfo().clone(),this.__mouseDownZaxis=this.__mouseDownCameraXfo.ori.getZaxis();const s=this.__mouseDownZaxis.scale(-n);this.__mouseDownCameraTarget=i.getGlobalXfo().tr.add(s),this.__mouseDownFocalDist=n,this.__dragListenerId=i.getParameter("GlobalXfo").valueChanged.connect(this.__globalXfoChangedDuringDrag.bind(this))}__globalXfoChangedDuringDrag(t){this.__calculatingDragAction||(this.__mouseDownViewport.getCamera().getParameter("GlobalXfo").valueChanged.disconnectId(this.__dragListenerId),this.initDrag({viewport:this.__mouseDownViewport,mousePos:this.__mouseDownPos}))}endDrag(t){if(this.__dragListenerId){const{viewport:e}=t;e.getCamera().getParameter("GlobalXfo").valueChanged.disconnectId(this.__dragListenerId),this.__dragListenerId=null}this.__mouseDown=!1,this.__dragging=!1}aimFocus(t,e){const{viewport:i}=t,n=i.getCamera();this.__focusIntervalId&&clearInterval(this.__focusIntervalId);let s=0;const o=()=>{const t=n.getGlobalXfo(),i=n.getFocalDistance(),r=e.subtract(t.tr),a=r.normalizeInPlace(),l=new R$1,c=new R$1;{const e=t.ori.getZaxis().clone();e.z=0;const i=r.negate();i.z=0,l.setFrom2Vectors(e,i)}{const e=t.ori.getZaxis().clone(),i=r.negate();e.x=i.x,e.y=i.y,e.normalizeInPlace(),e.cross(i).dot(t.ori.getXaxis())>0?c.rotateX(e.angleTo(i)):c.rotateX(-e.angleTo(i))}const h=t.clone();h.ori=l.multiply(h.ori),h.ori.multiplyInPlace(c);const d=Math.pow(s/20,2),u=t.clone();u.ori=t.ori.lerp(h.ori,d),n.setFocalDistance(i+(a-i)*d),n.setGlobalXfo(u),s++,s<=20?this.__focusIntervalId=setTimeout(o,20):(this.__focusIntervalId=void 0,this.movementFinished.emit())};o(),this.__manipulationState="focussing"}onMouseMove(t){}onDoubleClick(t){if(t.intersectionData){const e=t.viewport.getCamera().getGlobalXfo().tr.add(t.mouseRay.dir.scale(t.intersectionData.dist));this.aimFocus(t,e)}}onMouseDown(t){this.initDrag(t),this.__manipulationState=2==t.button?"pan":t.ctrlKey&&t.altKey?"dolly":t.ctrlKey||2==t.button?"look":this.__defaultManipulationState}onMouseMove(t){if(!this.__mouseDown)return;const e=t.mousePos;switch(this.__calculatingDragAction=!0,this.__mouseDragDelta=this.__keyboardMovement?e:e.subtract(this.__mouseDownPos),this.__manipulationState){case"orbit":this.orbit(t,this.__mouseDragDelta);break;case"look":this.look(t,this.__mouseDragDelta);break;case"pan":this.pan(t,this.__mouseDragDelta);break;case"dolly":this.dolly(t,this.__mouseDragDelta)}this.__dragging=!0,this.__calculatingDragAction=!1,t.stopPropagation()}onMouseUp(t){this.__dragging&&(this.movementFinished.emit(),t.stopPropagation()),this.endDrag(t)}onWheel(t){const{viewport:e}=t,i=e.getCamera(),n=this.__mouseWheelDollySpeedParam.getValue(),s=t.shiftKey?.1:.5,o=i.getGlobalXfo(),r=o.ori.getZaxis();this.__mouseWheelZoomIntervalId&&clearInterval(this.__mouseWheelZoomIntervalId);let a=0;const l=()=>{const e=i.getFocalDistance(),c=t.deltaY*n*e*s;o.tr.addInPlace(r.scale(c)),"orbit"==this.__defaultManipulationState&&i.setFocalDistance(i.getFocalDistance()+c),i.setGlobalXfo(o),a++,a<10?this.__mouseWheelZoomIntervalId=setTimeout(l,10):(this.__mouseWheelZoomIntervalId=void 0,this.movementFinished.emit())};l()}__integrateVelocityChange(t){const{viewport:e}=t,i=e.getCamera(),n=new S$1;n.tr=this.__velocity.normalize().scale(this.__maxVel),i.setGlobalXfo(i.getGlobalXfo().multiply(n))}onKeyPressed(t,e){return!1}onKeyDown(t,e){}onKeyUp(t,e){}__startTouch(t){this.__ongoingTouches[t.identifier]={identifier:t.identifier,pos:new _$1(t.pageX,t.pageY)}}__endTouch(t){delete this.__ongoingTouches[t.identifier]}onTouchStart(t){console.log("onTouchStart"),t.preventDefault(),t.stopPropagation(),0==Object.keys(this.__ongoingTouches).length&&(this.__manipMode=void 0);const e=t.changedTouches;for(let i=0;i<e.length;i++)this.__startTouch(e[i]);1==Object.keys(this.__ongoingTouches).length&&(this.initDrag(t),this.__dragging=!0)}onTouchMove(t){t.preventDefault(),t.stopPropagation(),this.__calculatingDragAction=!0;const e=t.touches;if(1==e.length&&"panAndZoom"!=this.__manipMode){const i=e[0],n=new _$1(i.pageX,i.pageY),s=this.__ongoingTouches[i.identifier].pos.subtract(n);"look"==this.__defaultManipulationState?(s.scaleInPlace(6),this.look(t,s)):this.orbit(t,s)}else if(2==e.length){const i=e[0],n=this.__ongoingTouches[i.identifier],s=e[1],o=this.__ongoingTouches[s.identifier],r=new _$1(i.pageX,i.pageY),a=new _$1(s.pageX,s.pageY),l=o.pos.subtract(n.pos).length()-a.subtract(r).length(),c=r.subtract(n.pos),h=a.subtract(o.pos),d=c.add(h);d.scaleInPlace(.5),this.panAndZoom(t,d,.002*l),this.__manipMode="panAndZoom"}this.__calculatingDragAction=!1}onTouchEnd(t){t.preventDefault(),t.stopPropagation();const e=t.changedTouches;for(let i=0;i<e.length;i++)this.__endTouch(e[i]);0==Object.keys(this.__ongoingTouches).length&&this.endDrag(t)}onTouchCancel(t){t.preventDefault();const e=t.touches;for(let i=0;i<e.length;i++)this.__endTouch(e[i]);0==Object.keys(this.__ongoingTouches).length&&this.endDrag(t)}onDoubleTap(t){if(t.intersectionData){const{viewport:e}=t,i=e.getCamera().getGlobalXfo().tr.add(t.touchRay.dir.scale(t.intersectionData.dist));this.aimFocus(t,i)}t.preventDefault()}}var Ma$1=Object.freeze({__proto__:null,RefCounted:U$1,ParameterOwner:q$1,ItemFlags:$$1,BaseItem:te$1,getFileFolder:ae$1,loadTextfile:se$1,loadJSONfile:ne$1,loadXMLfile:le$1,loadBinfile:re$2,sgFactory:J$1,isObject:me$1,mergeDeep:ue$1,resourceLoader:be$1,Version:pe$1,BinReader:ge$1,BinWriter:_e$1,ParamFlags:H$1,ValueGetMode:P$1,ValueSetMode:E$1,BaseParameter:O$1,Parameter:Q$1,MultiChoiceParameter:Ge$1,BooleanParameter:Xe$1,NumberParameter:Ze$1,Vec2Parameter:ye$1,Vec3Parameter:fe$1,Vec4Parameter:Ve$1,ColorParameter:Ie$1,Mat3Parameter:Re$1,Mat4Parameter:xe$1,XfoParameter:Se$1,ImageParameter:We$1,StringParameter:Le$1,CodeParameter:ve$1,FilePathParameter:Fe$1,ListParameter:Te$1,StructParameter:Me$1,TreeItemParameter:Ce$1,ItemSetParameter:Ne$1,ProxyParameter:Ye$1,GeometryParameter:Ke$1,MaterialParameter:Lt$1,MaterialFloatParam:ze$1,MaterialColorParam:Ue$1,Attribute:vt$1,BaseGeom:Tt,SAVE_FLAG_SKIP_GEOMDATA:1024,VertexAttribute:Mt$1,Points:Ct$1,Lines:Nt$1,Mesh:Yt$1,PointsProxy:wt$1,LinesProxy:zt$1,MeshProxy:Ut$1,PointGrid:Jt$1,Rect:Pt$1,Circle:Et$1,Cross:Ht$1,LinesCuboid:kt$1,Grid:Bt$1,Cone:Dt$1,Cuboid:Ot$1,Cylinder:Qt$1,Disc:At$1,Plane:jt$1,Sphere:qt$1,Torus:$t$1,DataImage:Ee$1,FileImage:ot$1,FileImage2D:dt$1,LDRImage:ct$1,LDRVideo:mt$1,GIFImage:ut$1,EnvMap:Vt$1,Label:Rt$1,VideoStreamImage2D:xt$1,labelManager:It$1,SaveFlags:ea$1,LoadFlags:ta$1,CloneFlags:aa$1,TreeItem:ia$1,InstanceItem:sa$1,AudioItem:na$1,FileAudioItem:la$1,BaseGeomItem:ra$1,GeomItem:oa$1,AssetItem:ua$1,BillboardItem:ba$1,Camera:pa$1,Group:ha$1,GeomLibrary:ma$1,Material:Pe$1,BaseImage:we$1,MaterialLibrary:St$1,Scene:Ga$1,VLAAsset:_a$1,ObjAsset:Xa$1,Operator:ya$1,OperatorOutput:fa$1,XfoOperatorOutput:Va$1,ExplodePartsOperator:Ra$1,GearsOperator:Sa$1,PistonOperator:La$1,RouterOperator:va$1,AimOperator:Fa$1,CameraMouseAndKeyboard:Ta$1});const Ca$1=function(t,e){console.log(t$1);let i=null;if(null!=e.webglContextType)try{i=t.getContext(e.webglContextType,e),i.name=e.webglContextType}catch(t){}else["webgl2","webgl"].some(n=>{try{i=t.getContext(n,e),i.name=n}catch(t){}if(i)return!0});if(i)return i.sizeInBytes=function(t){switch(t){case this.BYTE:case this.UNSIGNED_BYTE:return 1;case this.SHORT:case this.UNSIGNED_SHORT:return 2;case this.INT:case this.UNSIGNED_INT:case this.FLOAT:return 4;default:throw new Error("unknown type")}},"webgl2"==i.name?(i.floatTexturesSupported=!0,i.__ext_float_linear=i.getExtension("OES_texture_float_linear"),i.__ext_texture_half_float_linear=i.getExtension("OES_texture_half_float_linear"),i.__ext_color_buffer_float=i.getExtension("EXT_color_buffer_float")):(i.__ext_float=i.getExtension("OES_texture_float"),i.__ext_float?(i.floatTexturesSupported=!0,i.__ext_float_linear=i.getExtension("OES_texture_float_linear")):console.warn("OES_texture_float is not available"),i.__ext_half_float=i.getExtension("OES_texture_half_float"),i.__ext_half_float&&(i.HALF_FLOAT=i.__ext_half_float.HALF_FLOAT_OES,i.floatTexturesSupported=!0,i.__ext_texture_half_float_linear=i.getExtension("OES_texture_half_float_linear")),i.__ext_color_buffer_float=i.getExtension("EXT_color_buffer_float"),i.__ext_std_derivatives=i.getExtension("OES_standard_derivatives"),i.__ext_Inst=i.getExtension("ANGLE_instanced_arrays"),i.__ext_Inst&&(i.vertexAttribDivisor=i.__ext_Inst.vertexAttribDivisorANGLE.bind(i.__ext_Inst),i.drawArraysInstanced=i.__ext_Inst.drawArraysInstancedANGLE.bind(i.__ext_Inst),i.drawElementsInstanced=i.__ext_Inst.drawElementsInstancedANGLE.bind(i.__ext_Inst)),i.__ext_VAO=i.getExtension("OES_vertex_array_object"),i.__ext_VAO&&(i.createVertexArray=i.__ext_VAO.createVertexArrayOES.bind(i.__ext_VAO),i.deleteVertexArray=i.__ext_VAO.deleteVertexArrayOES.bind(i.__ext_VAO),i.bindVertexArray=i.__ext_VAO.bindVertexArrayOES.bind(i.__ext_VAO)),i.__ext_element_index_uint=i.getExtension("OES_element_index_uint"),i.__ext_WEBGL_depth_texture=i.getExtension("WEBGL_depth_texture"),i.__ext_WEBGL_depth_texture&&(i.UNSIGNED_INT_24_8=i.__ext_WEBGL_depth_texture.UNSIGNED_INT_24_8_WEBGL),i.DRAW_FRAMEBUFFER=i.FRAMEBUFFER),i.__ext_frag_depth=i.getExtension("EXT_frag_depth"),i.setupInstancedQuad=function(){const t=new Float32Array([0,1,2,3]),e=new Uint16Array([0,1,2,2,1,3]);this.__quadVertexIdsBuffer=this.createBuffer(),this.bindBuffer(this.ARRAY_BUFFER,this.__quadVertexIdsBuffer),this.bufferData(this.ARRAY_BUFFER,t,this.STATIC_DRAW),this.__quadIndexBuffer=this.createBuffer(),this.bindBuffer(this.ELEMENT_ARRAY_BUFFER,this.__quadIndexBuffer),this.bufferData(this.ELEMENT_ARRAY_BUFFER,e,this.STATIC_DRAW),this.__quadattrbuffers={vertexIDs:{buffer:this.__quadVertexIdsBuffer,dataType:6,dimension:1,count:t.length,shared:!0}}},i.drawQuad=function(){this.drawElements(this.TRIANGLES,6,this.UNSIGNED_SHORT,0)},i.setupLineSegAttrBuffers=function(){const t=new Float32Array([0,1]),e=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,e),i.bufferData(i.ARRAY_BUFFER,t,i.STATIC_DRAW),i.__linesegattrbuffers={vertexIDs:{buffer:e,dimension:1,count:t.length,shared:!0}}},i};class Na$1 extends U$1{constructor(t,e){if(super(),this.__gl=t,this.ready=new C$1(!0),this.updated=new C$1,this.resized=new C$1,this.width=0,this.height=0,this.textureType=1,this.textureDesc=[0,0,0,0],this.__loaded=!1,this.__bound=!1,null!=e)if(e instanceof we$1){this.__texture=e,this.__texture.setMetadata("gltexture",this);const t=()=>{const t=this.__texture.getParams();this.bufferData(t.data,t.width,t.height)};this.__texture.isLoaded()?(this.configure(this.__texture.getParams()),this.__texture.updated.connect(t)):this.__texture.loaded.connect(()=>{this.configure(this.__texture.getParams()),this.__texture.updated.connect(t)})}else this.configure(e)}isLoaded(){return this.__loaded}getTexture(){return this.__texture}getInternalFormat(){return this.__internalFormat}getType(){return this.__typeParam}getTypeID(){return this.__type}getFormat(){return this.__formatParam}getFormatID(){return this.__format}getFilter(){return this.__filterParam}getWrap(){return this.__wrapParam}getMipMapped(){return this.__mipMapped}configure(t,e=!0){if(!("type"in t&&"format"in t&&"width"in t&&"height"in t))throw new Error("Invalid texture params");const i=this.__gl,n=t.width,s=t.height,o=t.data,r=i.getParameter(i.MAX_TEXTURE_SIZE);if(n<=0||n>r||s<=0||s>r)throw new Error("gl-texture2d: Invalid texture size. width:"+n+" height:"+s+" maxSize:"+r);const a=t.format,l=t.type;let c="minFilter"in t?t.minFilter:"filter"in t?t.filter:"LINEAR",h="magFilter"in t?t.magFilter:"filter"in t?t.filter:"LINEAR";const d="wrap"in t?t.wrap:"CLAMP_TO_EDGE";if("FLOAT"==l)if(this.textureType=3,"webgl2"==i.name)"LINEAR"!=c||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),h="NEAREST");else if(i.__ext_float)"LINEAR"!=c||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_float_linear||(console.warn("Floating point texture filtering not supported on this device"),h="NEAREST");else{if(!i.__ext_half_float)throw new Error("OES_texture_half_float is not available");l="HALF_FLOAT","LINEAR"!=c||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),h="NEAREST")}else if("HALF_FLOAT"==l)if("webgl2"==i.name);else{if(!i.supportUploadingHalfFloat&&null!=o)throw new Error("Safari does not support uploading HALF_FLOAT texture data.");if(!i.__ext_half_float)throw new Error("OES_texture_half_float is not available");if("LINEAR"!=c||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),c="NEAREST"),"LINEAR"!=h||i.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on this device"),h="NEAREST"),"RGB"==a)throw new Error("OES_texture_half_float onlysupports RGBA textures")}else if("sRGB"==l&&!i.__ext_sRGB)throw new Error("EXT_sRGB is not available");this.__formatParam=a,this.__typeParam=l,this.__minFilterParam=c,this.__magFilterParam=h,this.__wrapParam=d,this.__format=i[a],this.__internalFormat="internalFormat"in t?i[t.internalFormat]:this.__format,this.__type=i[l],"webgl2"==i.name&&("internalFormat"in t||(this.__type==i.FLOAT?this.__format==i.RED?this.__internalFormat=i.R32F:this.__format==i.RG?this.__internalFormat=i.RG32F:this.__format==i.RGB?this.__internalFormat=i.RGB32F:this.__format==i.RGBA&&(this.__internalFormat=i.RGBA32F):this.__type==i.HALF_FLOAT?this.__format==i.RED?this.__internalFormat=i.R16F:this.__format==i.RG?this.__internalFormat=i.RG16F:this.__format==i.RGB?this.__internalFormat=i.RGB16F:this.__format==i.RGBA&&(this.__internalFormat=i.RGBA16F):this.__type==i.UNSIGNED_BYTE&&(this.__format==i.RED&&(this.__internalFormat=i.R8),this.__format==i.RG&&(this.__internalFormat=i.RG8),this.__format==i.RGB?this.__internalFormat=i.RGB8:this.__format==i.RGBA&&(this.__internalFormat=i.RGBA8)))),this.__minFilter=i[c],this.__magFilter=i[h],this.__wrap=i[d],this.__flipY="flipY"in t&&t.flipY,this.__mipMapped="mipMapped"in t&&t.mipMapped,this.invert="invert"in t&&t.invert,this.alphaFromLuminance="alphaFromLuminance"in t&&t.alphaFromLuminance,this.textureDesc=[n,s,0,0],this.__gltex&&i.deleteTexture(this.__gltex),this.__gltex=i.createTexture(),this.__updateGLTexParams(),o?this.bufferData(o,n,s,!1,!1):this.resize(n,s,!1,!1),this.__loaded||(this.ready.emit(),this.__loaded=!0)}__updateGLTexParams(){const t=this.__gl;t.bindTexture(t.TEXTURE_2D,this.__gltex),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.__minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.__magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.__wrap),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.__wrap)}bufferData(t,e=-1,i=-1,n=!0,s=!0){const o=this.__gl;if(n&&o.bindTexture(o.TEXTURE_2D,this.__gltex),null!=t){if(t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement)o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,this.__format,this.__type,t),this.width=t.width,this.height=t.height;else{-1==e&&(e=this.width),-1==i&&(i=this.height);const n=e*i;let s;switch(this.__format){case o.RED:case o.RED_INTEGER:case o.ALPHA:case o.LUMINANCE:case o.LUMINANCE_ALPHA:s=1;break;case o.RG:s=2;break;case o.RGB:s=3;break;case o.RGBA:s=4}t.length!=n*s&&console.warn("Invalid data for Image width:"+e+" height:"+i+" format:"+this.__formatParam+" type:"+this.__typeParam+" Data Length:"+t.length+" Expected:"+n*s),this.__type==o.HALF_FLOAT&&t instanceof Float32Array&&(t=Math.convertFloat32ArrayToUInt16Array(t)),"webgl2"==o.name?o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,e,i,0,this.__format,this.__type,t,0):o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,e,i,0,this.__format,this.__type,t),this.width=e,this.height=i}this.__mipMapped&&o.generateMipmap(o.TEXTURE_2D)}else o.texImage2D(o.TEXTURE_2D,0,this.__internalFormat,this.width,this.height,0,this.__format,this.__type,null),this.width=e,this.height=i;s&&this.updated.emit()}clear(){const t=this.__gl,e=this.width*this.height;let i,n;switch(this.__format){case t.RED:case t.RED_INTEGER:case t.ALPHA:case t.LUMINANCE:case t.LUMINANCE_ALPHA:i=1;break;case t.RG:i=2;break;case t.RGB:i=3;break;case t.RGBA:i=4;break;default:throw new Error("Invalid Format")}switch(this.__type){case t.UNSIGNED_BYTE:n=new UInt8Array(e*i);break;case t.HALF_FLOAT:n=new UInt16Array(e*i);break;case t.FLOAT:n=new Float32Array(e*i);break;default:throw new Error("Invalid Type")}"webgl2"==t.name?t.texImage2D(t.TEXTURE_2D,0,this.__internalFormat,this.width,this.height,0,this.__format,this.__type,n,0):t.texImage2D(t.TEXTURE_2D,0,this.__internalFormat,this.width,this.height,0,this.__format,this.__type,n)}resize(t,e,i=!1,n=!0){const s=this.__gl;if(this.width!=t||this.height!=e){const o=s.getParameter(s.MAX_TEXTURE_SIZE);if(t<0||t>o||e<0||e>o)throw new Error("gl-texture2d: Invalid texture size. width:"+t+" height:"+e+" maxSize:"+o);if(i){const i=s.createTexture();s.bindTexture(s.TEXTURE_2D,i),s.texImage2D(s.TEXTURE_2D,0,this.__internalFormat,t,e,0,this.__format,this.__type,null);const n=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,n),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this.__gltex,0),s.bindTexture(s.TEXTURE_2D,i),s.copyTexImage2D(s.TEXTURE_2D,0,this.__internalFormat,0,0,this.width,this.height,0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.deleteFramebuffer(n),this.__gl.deleteTexture(this.__gltex),this.__gltex=i,this.__updateGLTexParams()}else s.bindTexture(s.TEXTURE_2D,this.__gltex),s.texImage2D(s.TEXTURE_2D,0,this.__internalFormat,t,e,0,this.__format,this.__type,null);this.width=t,this.height=e,n&&this.resized.emit(t,e)}}populate(t,e,i,n=0,s=0,o=!0){const r=this.__gl;o&&r.bindTexture(r.TEXTURE_2D,this.__gltex),r.texSubImage2D(r.TEXTURE_2D,0,n,s,e,i,this.__format,this.__type,t)}getSize(){return[this.width,this.height]}get glTex(){return this.__gltex}getTexHdl(){return this.__gltex}bind(t,e){return console.warn("'bind' is deprecated. Please use 'bindToUniform'"),this.bindToUniform(t,e)}preBind(t,e){return{textureTypeUnif:e[t.name+"Type"],textureDescUnif:e[t.name+"Desc"]}}bindToUniform(t,e,i){if(!this.__loaded)return!1;if(!this.__gltex)throw new Error("Unable to bind non-initialized or deleted texture.");const n=t.boundTextures++,s=this.__gl;return s.activeTexture(this.__gl.TEXTURE0+n),s.bindTexture(s.TEXTURE_2D,this.__gltex),s.uniform1i(e.location,n),i&&(i.textureTypeUnif&&s.uniform1i(i.textureTypeUnif.location,this.textureType),i.textureDescUnif&&this.__gl.uniform4fv(i.textureDescUnif.location,this.textureDesc)),!0}destroy(){super.destroy(),this.__texture&&this.__texture.setMetadata("gltexture",void 0),this.__gl.deleteTexture(this.__gltex),this.__gltex=void 0}}class Ya$1{constructor(t,e,i,n){this.__gl=t,this.__shaderAttrs=e,this.__glattrbuffers=i,this.__indexBuffer=n}bind(t){const e=this.__gl;for(const i in this.__shaderAttrs){if("instancedIds"==i)continue;const t=this.__shaderAttrs[i],n=t.location;if(-1==n)continue;const s=this.__glattrbuffers[i];if(!s){e.disableVertexAttribArray(n);continue}let o,r,a;switch(s.dataType){case 0:o=1,r=4,a=e.UNSIGNED_BYTE;break;case 1:o=1,r=4,a=e.BYTE;break;case 2:o=1,r=4,a=e.UNSIGNED_SHORT;break;case 3:o=1,r=4,a=e.SHORT;break;case 4:o=1,r=4,a=e.UNSIGNED_INT;break;case 5:o=1,r=4,a=e.INT;break;case 6:o=1,r=4,a=e.FLOAT;break;case _$1:o=2,r=4,a=e.FLOAT;break;case Z$1:o=3,r=4,a=e.FLOAT;break;case G$1:case y$3:o=4,r=4,a=e.FLOAT;break;case X$1:o=4,r=1,a=e.UNSIGNED_BYTE;break;default:throw"Unhandled Type"}const l=o*r,c=null!=s.offset?s.offset*o*r:0,h=1==s.normalized,d=t.instanced;e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,s.buffer),e.vertexAttribPointer(n,o,a,h,l,c),e.vertexAttribDivisor&&e.vertexAttribDivisor(n,1==d?1:0)}return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),!0}unbind(){const t=this.__gl;for(const e in this.__shaderAttrs){const i=this.__shaderAttrs[e].location;-1!=i&&(t.disableVertexAttribArray(i),t.vertexAttribDivisor(i,0))}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}destroy(){}}class Ka$1{constructor(t,e,i,n){this.__gl=t,this.__vao=t.createVertexArray(),t.bindVertexArray(this.__vao);for(const s in e){if("instancedIds"==s)continue;const n=e[s],o=n.location;if(-1==o)continue;const r=i[s];if(!r){t.disableVertexAttribArray(o);continue}let a,l,c;switch(r.dataType){case 0:a=1,l=4,c=t.UNSIGNED_BYTE;break;case 1:a=1,l=4,c=t.BYTE;break;case 2:a=1,l=4,c=t.UNSIGNED_SHORT;break;case 3:a=1,l=4,c=t.SHORT;break;case 4:a=1,l=4,c=t.UNSIGNED_INT;break;case 5:a=1,l=4,c=t.INT;break;case 6:a=1,l=4,c=t.FLOAT;break;case _$1:a=2,l=4,c=t.FLOAT;break;case Z$1:a=3,l=4,c=t.FLOAT;break;case G$1:case y$3:a=4,l=4,c=t.FLOAT;break;case X$1:a=4,l=1,c=t.UNSIGNED_BYTE;break;default:throw"Unhandled Type"}const h=a*l,d=null!=r.offset?r.offset*a*l:0,u=1==r.normalized,m=n.instanced;t.enableVertexAttribArray(o),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(o,a,c,u,h,d),t.vertexAttribDivisor(o,m?1:0)}this.__indexBuffer=n}bind(t){return this.__gl.bindVertexArray(this.__vao),this.__indexBuffer&&this.__gl.bindBuffer(this.__gl.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),!0}unbind(){const t=this.__gl;for(const e in this.__shaderAttrs){const i=this.__shaderAttrs[e].location;-1!=i&&(t.disableVertexAttribArray(i),t.vertexAttribDivisor(i,0))}this.__gl.bindVertexArray(null),this.__indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}destroy(){this.__gl.deleteVertexArray(this.__vao)}}function wa$1(t,e,i,n){return null==t.createVertexArray?new Ya$1(t,e,i,n):new Ka$1(t,e,i,n)}class za$1 extends U$1{constructor(t,e){super(),this.__gl=t,this.__geom=e,this.__glattrs={},this.__glattrbuffers={},this.__shaderBindings={},this.destructing=new C$1,this.updated=new C$1,this.__geom.geomDataChanged.connect(t=>{this.updateBuffers(t),this.updated.emit()}),this.__geom.geomDataTopologyChanged.connect(t=>{this.clearShaderBindings(),this.updateBuffers(t),this.updated.emit()})}getGeom(){return this.__geom}genBuffers(){}updateBuffers(t){}bind(t){if(this.__destroyed)throw new Error("Error binding a destroyed geom");let e=this.__shaderBindings[t.shaderkey];return e||(e=wa$1(this.__gl,t.attrs,this.__glattrbuffers,this.__indexBuffer),this.__shaderBindings[t.shaderkey]=e),e.bind(t),!0}unbind(t){const e=this.__shaderBindings[t.shaderkey];e&&e.unbind(t)}draw(){throw new Error("Not implemented. Implement this method in a derived class.")}drawInstanced(t){throw new Error("Not implemented. Implement this method in a derived class.")}bindAndDraw(t){this.bind(t),this.draw(t)}clearShaderBindings(){for(const t in this.__shaderBindings)this.__shaderBindings[t].destroy();this.__shaderBindings={}}destroy(){this.__geom.deleteMetadata("glgeom"),this.clearShaderBindings();const t=this.__gl;for(const e in this.__glattrbuffers){const i=this.__glattrbuffers[e];i.shared||t.deleteBuffer(i.buffer)}this.__glattrs={},this.__shaderBindings={},this.__destroyed=!0,this.destructing.emit(this)}}class Ua$1 extends za$1{constructor(t,e){super(t,e),this.genBuffers()}getNumTriangles(){return this.__numTriangles}genBuffers(){super.genBuffers();const t=this.__gl,e=this.__geom.genBuffers(),i=e.indices;this.__numTriIndices=e.indices.length,i instanceof Uint8Array&&(this.__indexDataType=this.__gl.UNSIGNED_BYTE),i instanceof Uint16Array&&(this.__indexDataType=this.__gl.UNSIGNED_SHORT),i instanceof Uint32Array&&(this.__indexDataType=this.__gl.UNSIGNED_INT),this.__numTriangles=i.length/3,this.__numRenderVerts=e.numRenderVerts,this.__indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices,t.STATIC_DRAW);for(const n in e.attrBuffers){const i=e.attrBuffers[n],s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,i.values,t.STATIC_DRAW),this.__glattrbuffers[n]={buffer:s,dataType:i.dataType,normalized:i.normalized},"textureCoords"==n&&(this.__glattrbuffers.texCoords=this.__glattrbuffers.textureCoords)}}updateBuffers(t){const e=this.__gl,i=this.__geom.genBuffers({includeIndices:!1});for(const n in i.attrBuffers){const t=i.attrBuffers[n];e.bindBuffer(e.ARRAY_BUFFER,this.__glattrbuffers[n].buffer),e.bufferData(e.ARRAY_BUFFER,t.values,e.STATIC_DRAW)}}getNumUnSplitVerts(){return this.__geom.vertices.length}getNumSplitVerts(){return this.__numRenderVerts}generateWireframesVAO(){if(!this.__vao)return!1;this.__geom.edgeVerts||this.__geom.genTopologyInfo(),this.__wireframesVao&&this.__ext.deleteVertexArrayOES(this.__wireframesVao),this.__wireframesVao=this.__ext.createVertexArrayOES(),this.__ext.bindVertexArrayOES(this.__wireframesVao);const t=this.__gl,e=t.createBuffer(),i=Uint32Array.from(this.__geom.edgeVerts);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW);const n=this.__glattrbuffers.positions.buffer;t.enableVertexAttribArray(0),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(0,3,t.FLOAT,!1,12,0),this.__numWireIndices=i.length,this.__ext.bindVertexArrayOES(null)}bindWireframeVAO(t){return null!=this.__wireframesVao&&(this.__ext.bindVertexArrayOES(this.__wireframesVao),!0)}unbindWireframeVAO(){this.__ext.bindVertexArrayOES(null)}drawWireframe(){this.__wireframesVao&&this.__gl.drawElements(this.__gl.LINES,this.__numWireIndices,this.__gl.UNSIGNED_INT,0)}generateHardEdgesVAO(){if(!this.__vao)return!1;this.__geom.edgeVerts||this.__geom.generateHardEdgesFlags(),this.__hardEdgesVao&&this.__ext.deleteVertexArrayOES(this.__hardEdgesVao),this.__hardEdgesVao=this.__ext.createVertexArrayOES(),this.__ext.bindVertexArrayOES(this.__hardEdgesVao);const t=this.__gl,e=t.createBuffer(),i=Uint32Array.from(this.__geom.computeHardEdgesIndices());t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW);const n=this.__glattrbuffers.positions.buffer;t.enableVertexAttribArray(0),t.bindBuffer(t.ARRAY_BUFFER,n),t.vertexAttribPointer(0,3,t.FLOAT,!1,12,0),this.__numEdgeIndices=i.length,this.__ext.bindVertexArrayOES(null)}bindHardEdgesVAO(t){return null!=this.__hardEdgesVao&&(this.__ext.bindVertexArrayOES(this.__hardEdgesVao),!0)}unbindHardEdgesVAO(){this.__ext.bindVertexArrayOES(null)}drawHardEdges(){this.__hardEdgesVao&&this.__gl.drawElements(this.__gl.LINES,this.__numEdgeIndices,this.__gl.UNSIGNED_INT,0)}drawPoints(){this.__gl.drawArrays(this.__gl.POINTS,0,this.__geom.numVertices())}draw(){this.__gl.drawElements(this.__gl.TRIANGLES,this.__numTriIndices,this.__indexDataType,0)}drawInstanced(t){this.__gl.drawElementsInstanced(this.__gl.TRIANGLES,this.__numTriIndices,this.__indexDataType,0,t)}destroy(){super.destroy(),this.__gl.deleteBuffer(this.__indexBuffer),this.__indexBuffer=void 0}}class Ja$1 extends za$1{constructor(t,e){super(t,e),this.genBuffers()}genBuffers(){super.genBuffers();const t=this.__gl,e=this.__geom.genBuffers(),i=e.indices;if(this.fatLines=(this.__geom.lineThickness>0||e.attrBuffers.lineThickness)&&t.floatTexturesSupported,this.fatLines){t.__quadVertexIdsBuffer||t.setupInstancedQuad(),this.__glattrbuffers.vertexIDs=t.__quadattrbuffers.vertexIDs,this.__drawCount=i.length/2;const e=this.__geom.getVertexAttributes(),n=e.positions,s=e.lineThickness,o=new Float32Array(4*n.length);for(let t=0;t<n.length;t++)Z$1.createFromFloat32Buffer(o.buffer,4*t).setFromOther(n.getValueRef(t)),o[4*t+3]=s?s.getFloat32Value(t):this.__geom.lineThickness;this.__positionsTexture=new Na$1(t,{format:"RGBA",type:"FLOAT",width:n.length,height:1,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",data:o,mipMapped:!1});const r=new Float32Array(i.length);for(let t=0;t<i.length;t++){let e;e=t%2==0?t>0?i[t]==i[t-1]:i[t]==i[i.length-1]:t<i.length-1?i[t]==i[t+1]:i[t]==i[0],r[t]=(e?1:0)+2*i[t]}const a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),this.__glattrbuffers.segmentIndices={buffer:a,dimension:2}}else{this.__indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW);for(const i in e.attrBuffers){const n=e.attrBuffers[i],s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,n.values,t.STATIC_DRAW),this.__glattrbuffers[i]={buffer:s,dataType:n.dataType,normalized:n.normalized}}this.__numSegIndices=i.length,this.__numVertices=e.numVertices}i instanceof Uint8Array&&(this.__indexDataType=this.__gl.UNSIGNED_BYTE),i instanceof Uint16Array&&(this.__indexDataType=this.__gl.UNSIGNED_SHORT),i instanceof Uint32Array&&(this.__indexDataType=this.__gl.UNSIGNED_INT)}updateBuffers(t){const e=this.__gl,i=this.__geom.genBuffers(),n=i.indices;if(this.fatLines){this.__drawCount=n.length/2;const t=this.__geom.getVertexAttributes(),i=t.positions,s=t.lineThickness,o=new Float32Array(4*i.length);for(let e=0;e<i.length;e++)Z$1.createFromFloat32Buffer(o.buffer,4*e).setFromOther(i.getValueRef(e)),o[4*e+3]=s?s.getFloat32Value(e):this.__geom.lineThickness;this.__positionsTexture.bufferData(o,i.length,1);const r=new Float32Array(n.length);for(let e=0;e<n.length;e++){let t;t=e%2==0?e>0&&n[e]==n[e-1]:e<n.length-1&&n[e]==n[e+1],r[e]=(t?1:0)+2*n[e]}e.bindBuffer(e.ARRAY_BUFFER,this.__glattrbuffers.segmentIndices.buffer),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}else{if(this.__geom.getVertexAttributes(),t&&t.indicesChanged){const t=this.__geom.getIndices();this.__numSegIndices!=t.length&&(e.deleteBuffer(this.__indexBuffer),this.__indexBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.__indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.__numSegIndices=t.length}const s=i.numVertices!=this.__numVertices;for(const t in i.attrBuffers){const n=i.attrBuffers[t],o=this.__glattrbuffers[t];s&&(e.deleteBuffer(o.buffer),o.buffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,o.buffer),e.bufferData(e.ARRAY_BUFFER,n.values,e.STATIC_DRAW)}this.__numVertices=i.numVertices,this.__numSegIndices=n.length}n instanceof Uint8Array&&(this.__indexDataType=this.__gl.UNSIGNED_BYTE),n instanceof Uint16Array&&(this.__indexDataType=this.__gl.UNSIGNED_SHORT),n instanceof Uint32Array&&(this.__indexDataType=this.__gl.UNSIGNED_INT)}bind(t){if(this.fatLines&&"LineThickness"in t.unifs){const e=this.__gl;let i=this.__shaderBindings[t.shaderkey];i||(i=wa$1(e,t.attrs,this.__glattrbuffers,e.__quadIndexBuffer),this.__shaderBindings[t.shaderkey]=i),i.bind(t);{const i=t.unifs;i.positionsTexture&&(this.__positionsTexture.bindToUniform(t,i.positionsTexture),e.uniform1i(i.positionsTextureSize.location,this.__positionsTexture.width))}return e.uniform1f(t.unifs.LineThickness.location,(this.__geom.lineThickness?this.__geom.lineThickness:1)*t.viewScale),!0}return super.bind(t)}drawPoints(){this.__gl.drawArrays(this.__gl.POINTS,0,this.__geom.numVertices())}draw(t){const e=this.__gl;this.fatLines?t.unifs.LineThickness&&e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,this.__drawCount):e.drawElements(this.__gl.LINES,this.__numSegIndices,this.__indexDataType,0)}drawInstanced(t){this.__gl.drawElementsInstanced(this.__gl.LINES,this.__numSegIndices,this.__indexDataType,0,t)}}class Pa$1 extends za$1{constructor(t,e){super(t,e),this.genBuffers()}genBuffers(){super.genBuffers();const t=this.__gl,e=this.__geom.genBuffers();for(const i in e.attrBuffers){const n=e.attrBuffers[i],s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,n.values,t.STATIC_DRAW),this.__glattrbuffers[i]={buffer:s,dataType:n.dataType,normalized:n.normalized}}this.__numVerts=e.numVertices,this.__vboState=2}bind(t){if(t.unifs.PointSize){const e=this.__gl;let i=this.__shaderBindings[t.shaderkey];if(!i){e.__quadVertexIdsBuffer||e.setupInstancedQuad();const n=Object.assign(this.__glattrbuffers,e.__quadattrbuffers);i=wa$1(e,t.attrs,n,e.__quadIndexBuffer),this.__shaderBindings[t.shaderkey]=i}return i.bind(t),!0}return super.bind(t)}draw(t){const e=this.__gl;t.unifs.PointSize?e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,this.__numVerts):e.drawArrays(e.POINTS,0,this.__numVerts)}drawInstanced(t){this.__gl.drawArraysInstanced(this.__gl.POINTS,0,this.__numVerts,t)}}const Ea$1={bool:Boolean,int:5,uint:4,float:6,ivec2:_$1,ivec3:Z$1,ivec4:G$1,vec2:_$1,vec3:Z$1,vec4:G$1,color:y$3,mat3:V$1,mat4:I$1,sampler2D:we$1},Ha$1=new class{constructor(){this.__shaderModules={}}hasShaderModule(t){return t in this.__shaderModules}setShaderModule(t,e){return this.parseShader(t,e)}getShaderModule(t){return this.__shaderModules[t]}getShaderModuleNames(){const t=[];for(const e in this.__shaderModules)t.push(e);return t}parseShader(t,e){const i=t=>t.startsWith("..")?n.substring(0,n.lastIndexOf("/"))+t.substring(2):t.startsWith(".")?n+t.substring(1):t.startsWith("/")?t.substring(1):t,n=(m$3(t),t.substring(0,t.lastIndexOf("/"))),s=e.split("\n"),o={glsl:" //starting:"+t+"\n",lines:s,numLines:0,includeMetaData:[],uniforms:{},attributes:{}},r=/\s+/;for(let a=0;a<s.length;a++){let e=s[a],n=e.trim();if(n.startsWith("//")||n.startsWith("*"))o.glsl=o.glsl+e+"\n",o.numLines++;else if(-1!=n.indexOf("//")&&(n=n.slice(0,n.indexOf("//")).trim()),n.startsWith("<%")||n.startsWith("</%")){const n=function(t){const e=(t=(t=t.startsWith("</%")?t.slice(3):t.slice(2)).endsWith("/>")?t.slice(0,t.length-2):t.slice(0,t.length-1)).split(r),i={tag:e.shift(),attributes:{}};for(const n of e){const t=n.split("=");i.attributes[t[0]]=t[1].replace(/['"]+/g,"")}return i}(s[a].trim());switch(n.tag){case"include":{const e=i(n.attributes.file);if(!this.hasShaderModule(e))throw new Error("Error while parsing :"+t+" \nShader module not found:"+e+"\n in:"+this.getShaderModuleNames());const s=this.getShaderModule(e);m$3(n.attributes.file);let r=s.glsl;r=r.substring(r.indexOf("\n")+1),o.glsl=o.glsl+" //including:"+n.attributes.file+"\n";const l={};for(const t in n.attributes){if("file"==t)continue;const e=n.attributes[t];r=r.replaceAll(t,e),l[t]=e}o.glsl=o.glsl+r,o.includeMetaData.push({src:o.numLines,tgt:a,length:s.numLines,key:e}),o.glsl=o.glsl+" //continuing:"+t+"\n",o.numLines+=s.numLines+1;for(const t in s.attributes){let e=t;for(const t in l)e=e.replaceAll(t,l[t]);o.attributes[e]=s.attributes[t]}for(const t in s.uniforms){let e=t;for(const t in l)e=e.replaceAll(t,l[t]);o.uniforms[e]=s.uniforms[t]}break}default:console.warn("Error while parsing :"+t+" \nUnhandled line:"+e);continue}}else{const i=(i,n)=>{if(!(i[1]in Ea$1))throw new Error("Error while parsing :"+t+" \nType not recognized:"+i[1]);const s=i[2].slice(0,i[2].length-1);o.attributes[s]={type:Ea$1[i[1]],instanced:n},"color"==i[1]&&(i[1]="vec4",e=i.join(" "))};if(n.startsWith("struct")){let t="";if(-1!=n.indexOf("}"))t=n.substring(n.indexOf("{")+1,n.indexOf("}")-1);else for(a++;e+=s[a]+"\n",t+=e.trim(),a++,-1==t.indexOf("}"););const i=t.substring(t.indexOf("{")+1,t.indexOf("}")-1).split(";"),o=[];for(const e of i){if(0==e.length)continue;const t=e.trim().split(r);o.push({name:t[1],type:Ea$1[t[0]]})}const l=n.split(r);Ea$1[l[1]]=o}if(n.startsWith("attribute")&&i(n.split(r),!1),n.startsWith("instancedattribute")){const t=n.split(r);i(t,!0),t[0]="attribute",e=t.join(" ")}else if(n.startsWith("uniform")){const i=n.split(r);let s=1;4==i.length&&(s=2);const a=i[s];if(!(a in Ea$1))throw new Error("Error while parsing :"+t+" \nType not recognized:"+i[1]);const l=i[s+1].slice(0,i[s+1].length-1);o.uniforms[l]=Ea$1[a],"struct"==o.uniforms[l]&&console.log(i),"color"==i[1]&&(i[1]="vec4",e=i.join(" "))}o.glsl=o.glsl+e+"\n",o.numLines++}}return this.__shaderModules[t]=o,o}};let ka$1=0;class Ba$1 extends te$1{constructor(t){if(super(),!t)throw new Error("gl context must be passed to shader constructor");this.__gl=t,this.__shaderStages={VERTEX_SHADER:{glsl:"",lines:0,uniforms:{},attributes:{}},FRAGMENT_SHADER:{glsl:"",lines:0,uniforms:{},attributes:{}}},this.__shaderProgramHdls={},this.__gltextures={},this.updated=new C$1,this.__id=ka$1++,this.invisibleToGeomBuffer=!1}static isTransparent(){return!1}static isOverlay(){return!1}__compileShaderStage(t,e,i,n){const s=this.__gl;if(n||(n=s.shaderopts),n){if(n.repl)for(const e in n.repl)t=t.replaceAll(e,n.repl[e]);n.defines&&(t=n.defines+t)}"webgl2"==s.name&&(t="#version 300 es\n"+(t=(t=(t=t.replaceAll("attribute","in")).replaceAll("varying","vertexShader"==i?"out":"in")).replaceAll("texture2D","texture")));const o=s.createShader(e);if(s.shaderSource(o,t),s.compileShader(o),!s.getShaderParameter(o,s.COMPILE_STATUS)){console.log("Errors in :"+this.constructor.name);const e=s.getShaderInfoLog(o).split("\n"),n={};for(let t in e){if(e[t].startsWith("'")){e[t-1]=e[t-1]+e[t],delete e[t],t--;continue}const i=e[t].split(":");if(i.length>=2){const s=parseInt(i[2]);isNaN(s)||(n[s]?n[s].push(e[t]):n[s]=[e[t]])}}const r=[],a=t.split("\n");for(let t=0;t<a.length;t++)if(r.push((t+1+":").lpad(" ",3)+a[t]),t+1 in n){const e=n[t+1];for(const t of e)r.push(t),r.push("-".lpad("-",t.length))}throw new Error("An error occurred compiling the shader \n=================\n"+this.constructor.name+"."+i+": \n\n"+e.join("\n")+"\n"+r.join("\n"))}return o}__createProgram(t){const e=this.__gl;this.__shaderCompilationAttempted=!0;const i=e.createProgram(),n=this.__shaderStages.VERTEX_SHADER.glsl,s={};if(null!=n){const o=this.__compileShaderStage(n,e.VERTEX_SHADER,"vertexShader",t);if(!o)return!1;e.attachShader(i,o),s[e.VERTEX_SHADER]=o}const o=this.__shaderStages.FRAGMENT_SHADER.glsl;if(null!=o){const n=Object.assign({},e.shaderopts,t);n.frag&&(n.defines=n.frag.defines+n.defines);const r=this.__compileShaderStage(o,e.FRAGMENT_SHADER,"fragmentShader",n);if(!r)return!1;e.attachShader(i,r),s[e.FRAGMENT_SHADER]=r}if(e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);if(t.includes("D3D shader compilation failed")){const t=e.getExtension("WEBGL_debug_shaders");if(t){const i=t.getTranslatedShaderSource(s[e.VERTEX_SHADER]);console.log(i)}}throw console.log("vertexShaderGLSL:"+n),console.log("fragmentShaderGLSL:"+o),new Error("Unable to link the shader program:"+this.constructor.name+"\n==================\n"+t)}const r=this.__extractAttributeAndUniformLocations(i,t);return r.shaderProgramHdl=i,r}__extractAttributeAndUniformLocations(t,e){const i=this.__gl,n=this.getAttributes(),s={attrs:{},unifs:{}};for(const r in n){const e=i.getAttribLocation(t,r);if(null==e){console.warn("Shader attribute not found:"+r);continue}const o=n[r];s.attrs[r]={name:r,location:e,type:o.type,instanced:o.instanced}}const o=this.getUniforms();for(let r in o){const n=o[r];if(n instanceof Array)for(const e of n){const n=r+"."+e.name,o=i.getUniformLocation(t,n);null!=o&&(s.unifs[n]={name:n,location:o,type:e.type})}if(e&&e.repl)for(const t in e.repl)r=r.replace(t,e.repl[t]);const a=i.getUniformLocation(t,r);null!=a&&(s.unifs[r]={name:r,location:a,type:n})}return s}getAttributes(){const t={};for(const e in this.__shaderStages){const i=this.__shaderStages[e];for(const e in i.attributes)t[e]=i.attributes[e]}return t}getUniforms(){const t={};for(const e in this.__shaderStages){const i=this.__shaderStages[e];for(const e in i.uniforms)t[e]=i.uniforms[e]}return t}finalize(){}compileForTarget(t,e){const i=t?this.__id+t:this.__id;let n=this.__shaderProgramHdls[i];return n||!1!==n&&(n=this.__createProgram(e),n.shaderkey=i,this.__shaderProgramHdls[i]=n),n}compile(){this.compileForTarget()}bind(t,e){const i=this.__gl;if(t.glshader!=this){const n=this.compileForTarget(e,t.shaderopts);if(!1===n)return console.warn(this.constructor.name+" is not compiled for "+e),!1;i.useProgram(n.shaderProgramHdl),t.glshader=this,t.shaderkey=n.shaderkey,t.unifs=n.unifs,t.attrs=n.attrs,t.boundTextures=0,t.boundLightmap=void 0,t.glgeom=void 0,t.bindRendererUnifs&&t.bindRendererUnifs(n.unifs)}return t.supportsInstancing=!0,!0}unbind(t){return!0}static getParamDeclarations(){return[]}static getGeomDataShaderName(){}static getSelectedShaderName(){}destroy(){const t=this.__gl;for(const e in this.__shaderProgramHdls)t.deleteProgram(this.__shaderProgramHdls[e].shaderProgramHdl);this.__shaderProgramHdls={}}}Ha$1.setShaderModule("utils/quadVertexFromID.glsl","\n\nattribute float vertexIDs;\n\nvec2 getQuadVertexPositionFromID(){\n    int vertexID = int(vertexIDs);\n    if(vertexID == 0)\n        return vec2(-0.5, -0.5);\n    else if(vertexID == 1)\n        return vec2(0.5, -0.5);\n    else if(vertexID == 2)\n        return vec2(-0.5, 0.5);\n    else if(vertexID == 3)\n        return vec2(0.5, 0.5);\n    return vec2(0,0);\n}\n"),Ha$1.setShaderModule("utils/unpackHDR.glsl","\n\nvec3 decodeHDR(const in vec3 ldrPixel, const in float cdmAlpha) {\n    float avg = (cdmAlpha * 16.0 - 8.0);\n    float scl = 1.0;\n    vec3 color;\n    color.x = (tan((ldrPixel.x-0.5)*1.5)/scl)+avg;\n    color.y = (tan((ldrPixel.y-0.5)*1.5)/scl)+avg;\n    color.z = (tan((ldrPixel.z-0.5)*1.5)/scl)+avg;\n\n    // convert from logarithmic curve to linear curve.\n    // subtract the epsilon that was added during encoding.\n    const float eps = 0.001;\n    color.x = pow(10.0, color.x) - eps;\n    color.y = pow(10.0, color.y) - eps;\n    color.z = pow(10.0, color.z) - eps;\n    return color;\n}\n\nvec3 decodeHDR(sampler2D ldrSampler, sampler2D cdmSampler, vec2 texCoord) {\n#ifdef ENABLE_ES3\n    float cdm = texture2D(cdmSampler, texCoord).r;\n#else\n    float cdm = texture2D(cdmSampler, texCoord).a;\n#endif\n    return decodeHDR(texture2D(ldrSampler, texCoord).rgb, cdm);\n}\n\n");class Da$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("UnpackHDRShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(position*2.0, 0.0, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("UnpackHDRShader.fragmentShader",'\nprecision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D ldrSampler;\nuniform sampler2D cdmSampler;\nuniform float exposure;\nuniform vec4 tint;\n\n<%include file="utils/unpackHDR.glsl"/>\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(decodeHDR(ldrSampler, cdmSampler, v_texCoord) * tint.rgb * exposure, 1.0);\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n\n')}}class Oa$1{constructor(t,e,i=!1){!t$1.isIOSDevice||"FLOAT"!=e.getType()&&"HALF_FLOAT"!=e.getType()||console.error("IOS devices are unable to render to float textures."),this.__gl=t,this.__colorTexture=e,this.__createDepthTexture=i,this.__clearColor=[0,0,0,0],this.__depthTexture=void 0,this.setup=this.setup.bind(this),this.resize=this.resize.bind(this),this.__colorTexture&&this.__colorTexture.resized.connect(this.resize),this.setup()}setClearColor(t){this.__clearColor=t}getWidth(){return this.__colorTexture.width}getHeight(){return this.__colorTexture.height}getSize(){return[this.__colorTexture.width,this.__colorTexture.height]}getColorTexture(){return this.__colorTexture}getDepthTextureGL(){return this.__depthTexture}get width(){return this.__colorTexture.width}get height(){return this.__colorTexture.height}get size(){return[this.__colorTexture.width,this.__colorTexture.height]}get colorTexture(){return this.__colorTexture}setColorTexture(t){this.__colorTexture=t,gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.__colorTexture.glTex,0)}get depthTextureGL(){return this.__depthTexture}setup(){const t=this.__gl;if(this.__fbo=t.createFramebuffer(),t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,this.__fbo),this.__colorTexture&&t.framebufferTexture2D("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.__colorTexture.glTex,0),this.__createDepthTexture)if("webgl2"==t.name||t.__ext_WEBGL_depth_texture)t.activeTexture(t.TEXTURE0),this.__depthTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.__depthTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),"webgl2"==t.name?(t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT24,this.width,this.height,0,t.DEPTH_COMPONENT,t.UNSIGNED_INT,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.__depthTexture,0)):(t.texImage2D(t.TEXTURE_2D,0,t.DEPTH_COMPONENT,this.width,this.height,0,t.DEPTH_COMPONENT,t.UNSIGNED_INT,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.__depthTexture,0));else{const e=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,e),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)}this.__checkFramebuffer(),t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,null)}resize(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,this.__fbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.__colorTexture.glTex,0),this.__depthTexture&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.__depthTexture),t.texImage2D(t.TEXTURE_2D,0,"webgl2"==t.name?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT,this.width,this.height,0,t.DEPTH_COMPONENT,t.UNSIGNED_INT,null)),this.__checkFramebuffer()}__checkFramebuffer(){const t=this.__gl;let e;if(e=t.checkFramebufferStatus("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER),e!==t.FRAMEBUFFER_COMPLETE)switch(t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer("webgl2"==t.name?t.DRAW_FRAMEBUFFER:t.FRAMEBUFFER,null),console.warn("Error creating Fbo width:",this.width,", height:",this.height," Texture Type:",this.__colorTexture.getType()),e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete.");case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("There is no attachment.");case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("Height and width of the attachment are not the same.");case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("The format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer.");case 36061:throw new Error("The framebuffer is unsupported");default:throw new Error("Incomplete Frambuffer")}}bindForWriting(t){t&&(this.__prevBoundFbo=t.boundRendertarget,t.boundRendertarget=this.__fbo);const e=this.__gl;e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.__fbo),e.viewport(0,0,this.width,this.height)}unbindForWriting(t){t&&(t.boundRendertarget=this.__prevBoundFbo);const e=this.__gl;e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.__prevBoundFbo)}bind(t){this.bindForWriting(t)}unbind(t){this.unbindForWriting(t)}bindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,this.__fbo)}unbindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,null)}clear(){const t=this.__gl;t.colorMask(!0,!0,!0,!0),t.clearColor(...this.__clearColor),t.clear(this.__createDepthTexture?t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT:t.COLOR_BUFFER_BIT)}bindAndClear(t){this.bind(t),this.clear(t)}unbind(){const t=this.__gl;t.bindFramebuffer(t.FRAMEBUFFER,null)}destroy(){const t=this.__gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.__fbo),this.__fbo=null,this.__colorTexture.resized.disconnect(this.resize)}}class Qa$1 extends Na$1{constructor(t,e){super(t),this.__hdrImage=e,this.__hdrImage.setMetadata("gltexture",this),this.__hdrImage.updated.connect(()=>{this.__unpackHDRImage(this.__hdrImage.getParams())}),this.__hdrImage.isLoaded()?this.__unpackHDRImage(this.__hdrImage.getParams()):this.__hdrImage.loaded.connect(()=>{this.__unpackHDRImage(this.__hdrImage.getParams())})}__unpackHDRImage(t){const e=this.__gl,i=t.data.ldr,n=t.data.cdm;if(this.__fbo)this.__srcLDRTex.bufferData(i),this.__srcCDMTex.bufferData(n);else{this.configure({format:"RGBA",type:"FLOAT",width:i.width,height:i.height,filter:"LINEAR",wrap:"CLAMP_TO_EDGE"}),this.__fbo=new Oa$1(e,this),this.__fbo.setClearColor([0,0,0,0]),this.__srcLDRTex=new Na$1(e,{format:"RGB",type:"UNSIGNED_BYTE",width:i.width,height:i.height,filter:"NEAREST",mipMapped:!1,wrap:"CLAMP_TO_EDGE",data:i}),this.__srcCDMTex=new Na$1(e,{format:"webgl2"==e.name?"RED":"ALPHA",type:"UNSIGNED_BYTE",width:i.width,height:i.height,filter:"NEAREST",mipMapped:!1,wrap:"CLAMP_TO_EDGE",data:n}),this.__unpackHDRShader=new Da$1(e);const t=this.__unpackHDRShader.compileForTarget("GLHDRImage");this.__shaderBinding=wa$1(e,t.attrs,e.__quadattrbuffers,e.__quadIndexBuffer)}this.__fbo.bindAndClear();const s={};this.__unpackHDRShader.bind(s,"GLHDRImage"),this.__shaderBinding.bind(s);const o=s.unifs;this.__srcLDRTex.bindToUniform(s,o.ldrSampler),this.__srcCDMTex.bindToUniform(s,o.cdmSampler),e.uniform1f(o.exposure.location,1),e.uniform4fv(o.tint.location,this.__hdrImage.getHDRTint().asArray()),e.drawQuad(),this.__fbo.unbind(),this.updated.emit()}bindToUniform(t,e,i){return super.bindToUniform(t,e,i)}destroy(){super.destroy(),this.__fbo&&(this.__fbo.destroy(),this.__srcLDRTex.destroy(),this.__srcCDMTex.destroy()),this.__unpackHDRShader&&this.__unpackHDRShader.destroy(),this.__shaderBinding&&this.__shaderBinding.destroy(),this.__hdrImage.loaded.disconnectScope(this),this.__hdrImage.updated.disconnectScope(this)}}Ha$1.setShaderModule("GLSLUtils.glsl","\n\n\nint ftoi(float val){\n    return int(floor(val + 0.5));\n}\n\n#ifdef ENABLE_ES3\n\nint imod(int x, int y) {\n    return x % y;\n}\n\nvoid setFlag(inout int flags, int flag) {\n    flags |= flag;\n}\n\nvoid clearFlag(inout int flags, int flag) {\n    flags &= ~flag;\n}\n\nbool testFlag(int flags, int flag) {\n    return (flags & flag) != 0;\n}\n\n// private function: Mangle me...\nivec2 _pixelIndexToUV(int index, int textureWidth){\n    return ivec2(index % textureWidth, index / textureWidth);\n}\n\nvec4 fetchTexel(sampler2D texture, int textureWidth, int index) {\n    return texelFetch(texture, _pixelIndexToUV(index, textureWidth), 0);\n}\n\nvec4 fetchTexel(sampler2D texture, ivec2 textureSize, ivec2 texCoord) {\n    return texelFetch(texture, texCoord, 0);\n}\n\n#else\n\n// TODO: integrate: https://gist.github.com/mattatz/70b96f8c57d4ba1ad2cd\n\nint max(int a, int b) {\n    return a > b ? a : b;\n}\nint min(int a, int b) {\n    return a < b ? a : b;\n}\n\n\nfloat round(float val){\n    return floor(val + 0.4);\n}\n\nint imod(int x, int y) {\n    return x-y*(x/y);\n}\n\nvoid setFlag(inout int flags, int flag) {\n    flags += flag;\n}\nvoid clearFlag(inout int flags, int flag) {\n    flags -= flag;\n}\n\nbool testFlag(int flags, int flag) {\n    return imod(flags / flag, 2) != 0;\n}\n\n// private function: Mangle me...\nvec2 _pixelIndexToUV(int index, int textureSize){\n    float flTexSize = float(textureSize);\n    float x = (float(imod(index, textureSize))+0.5)/flTexSize;\n    float y = (floor(float(index / textureSize))+0.5)/flTexSize;\n    return vec2(x, y);\n}\n\nvec4 fetchTexel(sampler2D texture, int textureSize, int index) {\n    vec2 texCoord = _pixelIndexToUV(index, textureSize);\n    return texture2D(texture, texCoord);\n}\n\nvec4 fetchTexel(sampler2D texture, ivec2 textureSize, ivec2 texCoord) {\n    vec2 ftextureSize = vec2(textureSize);\n    return texture2D(texture, (vec2(texCoord) + 0.5) / ftextureSize);\n}\n\n\n#endif\n\nint uvToPixelIndex(vec2 uv, int textureSize){\n    return int(uv.x * float(textureSize)) + (int(floor(uv.y * float(textureSize))) * textureSize);\n}\n\n\n\n"),Ha$1.setShaderModule("utils/ImageStream.glsl","\n\n// Stream Desc looks like the following\n// x : atlas Width in images\n// y : atlas height in images\n// z : image Width\n// w : image Height\n\nvec2 calcFrameImageTexCoords(vec2 texCoord, int index, in vec4 streamDesc){\n\tfloat index_x = floor(mod(float(index), streamDesc.x));\n\tfloat index_y = floor(float(index) / streamDesc.x);\n    return vec2( \n    \t(index_x + texCoord.x) / streamDesc.x, \n    \t(index_y + texCoord.y) / streamDesc.y\n    \t);\n}\n\nvec4 sampleStreamFrame(vec2 texCoord, int index, in sampler2D streamImage, in vec4 streamDesc){\n    return texture2D(streamImage, calcFrameImageTexCoords(texCoord, index, streamDesc));\n}\n\n");class Aa$1{constructor(t,e){this.__gl=t,this.__streamImage=e,this.ready=new C$1(!0),this.updated=new C$1,this.resized=new C$1,this.__descParam=this.__streamImage.getParameter("StreamAtlasDesc"),this.__indexParam=this.__streamImage.getParameter("StreamAtlasIndex"),this.__indexParam.valueChanged.connect(this.updated.emit);const i=()=>{const e=this.__streamImage.getParams();e.data.__atlasTexture||(e.data.__atlasTexture=new Na$1(t,e)),this.__atlasTexture=e.data.__atlasTexture,this.__atlasTexture.textureType=2,this.__atlasTexture.textureDesc=this.__descParam.getValue().asArray()};this.__streamImage.isLoaded()?i():this.__streamImage.loaded.connect(()=>{i()})}preBind(t,e){const i=this.__atlasTexture.preBind(t,e);return i.textureDescUnif=e[t.name+"Desc"],i.textureIndexUnif=e[t.name+"Index"],i}bindToUniform(t,e,i){return!!this.__atlasTexture.bindToUniform(t,e,i)&&(i&&i.textureIndexUnif&&this.__gl.uniform1i(i.textureIndexUnif.location,this.__indexParam.getValue()),!0)}}class ja$1{constructor(t,e,i,n){switch(this.__unif=n,n.type){case Boolean:this.uniformXX=t.uniform1i.bind(t);break;case 4:this.uniformXX="webgl2"==t.name?t.uniform1ui.bind(t):t.uniform1i.bind(t);break;case 5:this.uniformXX=t.uniform1i.bind(t);break;case 6:this.uniformXX=t.uniform1f.bind(t)}this.__val=i.getValue(),i.valueChanged.connect(()=>{this.__val=i.getValue(),e.updated.emit()})}bind(t){this.uniformXX(this.__unif.location,this.__val)}unbind(){}destroy(){}}class qa$1{constructor(t,e,i,n){switch(this.__unif=n,n.type){case _$1:this.uniformXX=t.uniform2fv.bind(t);break;case Z$1:this.uniformXX=t.uniform3fv.bind(t);break;case G$1:this.uniformXX=t.uniform4fv.bind(t)}this.__vals=i.getValue().asArray(),i.valueChanged.connect(()=>{this.__vals=i.getValue().asArray(),e.updated.emit()})}bind(t){this.uniformXX(this.__unif.location,this.__vals)}unbind(){}destroy(){}}class $a$1{constructor(t,e,i,n){switch(this.__unif=n,n.type){case Mat3:this.uniformMatrixXXX=t.uniformMatrix3fv.bind(t);break;case I$1:this.uniformMatrixXXX=t.uniformMatrix4fv.bind(t)}this.__vals=i.getValue().asArray(),i.valueChanged.connect(()=>{this.__val=i.getValue().asArray(),e.updated.emit()})}bind(t){this.uniformMatrixXXX(this.__unif.location,!1,this.__val)}unbind(){}destroy(){}}class ei$1{constructor(t,e,i,n,s){this.__gl=t,this.__unif=n,this.__textureUnif=s[n.name+"Tex"],this.__textureTypeUnif=s[n.name+"TexType"],this.__vals=[0,0,0,0],this.bind=this.bindValue;const o=t=>{let i=t.getMetadata("gltexture");i||(i="FLOAT"===t.type?new Qa$1(this.__gl,t):t.isStreamAtlas()?new Aa$1(this.__gl,t):new Na$1(this.__gl,t)),this.texBinding=i.preBind(this.__textureUnif,s),i.updated.connect(()=>{e.updated.emit()}),this.gltexture=i,this.gltexture.addRef(this),this.textureType=1,this.bind=this.bindTexture,e.updated.emit()};let r,a;const l=()=>{o(r)},c=t=>{t.isLoaded()?o(t):t.loaded.connect(l),r=t},h=()=>{r.getMetadata("gltexture").removeRef(this),this.texBinding=null,this.gltexture=null,this.textureType=null,this.bind=this.bindValue,a&&r.loaded.disconnectId(a),r=null,a=null,e.updated.emit()},d=()=>{const t=i.getValue(!1);if(this.__vals=t.asArray(),this.__textureUnif){let t;i.getImage&&(t=i.getImage()),t&&t!=r?c(t):!t&&r&&h()}e.updated.emit()};d(),i.textureConnected&&i.textureConnected.connect(()=>{c(i.getImage())}),i.valueChanged.connect(d),this.uniform1i=t.uniform1i.bind(t),this.uniform4fv=t.uniform4fv.bind(t)}bindValue(t){this.uniform4fv(this.__unif.location,this.__vals),this.__textureTypeUnif&&this.uniform1i(this.__textureTypeUnif.location,0)}bindTexture(t){this.gltexture.bindToUniform(t,this.__textureUnif,this.texBinding)}}const ti$1={};class ai$1{constructor(t,e,i,n){this.__uniformBindings=[];const s=s=>{const o=s.getName(),r=i[o];if(null!=r)switch(r.type){case Boolean:case 4:case 5:case 6:this.__uniformBindings.push(new ja$1(t,e,s,r));break;case _$1:case Z$1:case G$1:this.__uniformBindings.push(new qa$1(t,e,s,r));break;case y$3:this.__uniformBindings.push(new ei$1(t,e,s,r,i));break;case I$1:this.__uniformBindings.push(new $a$1(t,e,s,r));break;default:return void console.warn("Param :"+o+" has unhandled data type:"+r.type)}else if(n){const t=e.getMaterial().getShaderName();ti$1[t]||(ti$1[t]={}),ti$1[t][o]||(console.warn("Material:"+e.getMaterial().getName(),"with Shader ",t,"Param has no unif",o),ti$1[t][o]=!0)}},o=e.getMaterial().getParameters();for(const r of o)s(r)}bind(t){for(const e of this.__uniformBindings)e.bind(t);return!0}unbind(){for(const t of this.__uniformBindings)t.unbind(renderstate)}destroy(){for(const t of this.__uniformBindings)t.destroy(renderstate)}}class ii$1{constructor(t,e,i){this.__gl=t,this.__material=e,this.__glshader=i,this.updated=new C$1,this.__shaderBindings={}}getMaterial(){return this.__material}getGLShader(){return this.__glshader}generateShaderBinding(){const t=this.__material.getParameters();for(const e of t)bindParam(gl,e)}bind(t,e){this.__boundTexturesBeforeMaterial=t.boundTextures;let i=this.__shaderBindings[t.shaderkey];return i||(i=new ai$1(this.__gl,this,t.unifs,e),this.__shaderBindings[t.shaderkey]=i),i.bind(t)}unbind(t){t.boundTextures=this.__boundTexturesBeforeMaterial}}class si$1{constructor(t,e){this.resized=new C$1,this.updated=new C$1,this.__gl=t,this.textureTargets=[],this.depthTexture=null,e&&this.configure(e)}configure(t){const e=this.__gl,i=function(t,e){if(!e.width||!e.height)throw new Error("Invalid texture params");const i=t.getParameter(t.MAX_TEXTURE_SIZE);if(e.width<=0||e.width>i||e.height<=0||e.height>i)throw new Error("GLTextureParams: Invalid texture size. width:"+e.width+" height:"+e.height+" maxSize:"+i);const n={width:e.width,height:e.height},s=(i,s)=>{i in e?n[i]=isNaN(e[i])?t[e[i]]:e[i]:s&&(n[i]=s)};if(s("format"),s("internalFormat",n.format),s("type",t.UNSIGNED_BYTE),s("minFilter",t.LINEAR),s("magFilter",t.LINEAR),s("wrapS",t.CLAMP_TO_EDGE),s("wrapT",t.CLAMP_TO_EDGE),s("flipY",!1),s("mipMapped",!1),s("depthFormat"),s("depthType"),n.format==t.FLOAT)if("webgl2"==t.name)n.filter!=t.LINEAR||t.__ext_float_linear||(console.warn("Floating point texture filtering not supported on result device"),n.filter=t.NEAREST);else if(t.__ext_float)n.filter!=t.LINEAR||t.__ext_float_linear||(console.warn("Floating point texture filtering not supported on result device"),n.filter=t.NEAREST);else{if(!t.__ext_half_float)throw new Error("OES_texture_half_float is not available");n.format=t.HALF_FLOAT,n.filter!=t.LINEAR||t.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on result device"),n.filter=t.NEAREST)}else if(n.format==t.HALF_FLOAT)if("webgl2"==t.name);else{if(!t.__ext_half_float)throw new Error("OES_texture_half_float is not available");if(n.filter!=t.LINEAR||t.__ext_texture_half_float_linear||(console.warn("Half Float texture filtering not supported on result device"),n.filter=t.NEAREST),n.channels==t.RGB)throw new Error("OES_texture_half_float onlysupports RGBA textures")}else if("sRGB"==n.format&&!t.__ext_sRGB)throw new Error("EXT_sRGB is not available");return null!=n.format&&"webgl2"==t.name&&n.internalFormat==n.format&&(n.type==t.FLOAT?n.format==t.RED||n.format==t.RED?n.internalFormat=t.R32F:n.format==t.RG?n.internalFormat=t.RG32F:n.format==t.RGBA&&(n.internalFormat=t.RGBA32F):n.type==t.HALF_FLOAT?n.format==t.RED?n.internalFormat=t.R16F:n.format==t.RGB?n.internalFormat=t.RGB16F:n.format==t.RGBA&&(n.internalFormat=t.RGBA16F):n.type==t.UNSIGNED_BYTE&&(n.format==t.RED&&(n.internalFormat=t.R8),n.format==t.RGB?n.internalFormat=t.RGB8:n.format==t.RGBA&&(n.internalFormat=t.RGBA8))),null!=n.depthFormat&&("webgl2"==t.name?n.depthType==t.UNSIGNED_SHORT?n.depthInternalFormat=t.DEPTH_COMPONENT16:n.depthType==t.UNSIGNED_INT&&(n.depthInternalFormat=t.UNSIGNED_INT):n.depthInternalFormat=n.depthFormat),n}(e,t);this.textureTargets.forEach(t=>{e.deleteTexture(t)}),this.textureTargets=[],this.depthTexture&&(e.deleteTexture(this.depthTexture),this.depthTexture=null),this.frameBuffer&&e.deleteFramebuffer(this.frameBuffer),this.type=i.type,this.format=i.format,this.internalFormat=i.internalFormat,this.filter=i.filter,this.wrap=i.wrap,this.flipY=i.flipY,this.width=i.width,this.height=i.height,this.clearColor=new y$3(0,0,0,0),this.colorMask=[!0,!0,!0,!0],this.textureType=1,this.textureDesc=[this.width,this.height,0,0];const n=null!=t.numColorChannels?t.numColorChannels:null!=i.format?1:0;for(let o=0;o<n;o++){e.activeTexture(e.TEXTURE0+1);const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapS),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter),e.texImage2D(e.TEXTURE_2D,0,this.internalFormat,i.width,i.height,0,this.format,this.type,null),this.textureTargets.push(t)}if(i.depthFormat){if("webgl"==e.name&&!e.__ext_WEBGL_depth_texture)throw new Error("Depth textures not support on this device");e.activeTexture(e.TEXTURE0),this.depthTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.depthTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapS),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.minFilter),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter),e.texImage2D(e.TEXTURE_2D,0,i.depthInternalFormat,i.width,i.height,0,i.depthFormat,i.depthType,null)}if(this.frameBuffer=e.createFramebuffer(),e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.frameBuffer),this.textureTargets.length>0){if(this.textureTargets.length>1&&"webgl"==e.name&&!e.drawBuffers){e.__ext_draw_buffers=e.getExtension("WEBGL_draw_buffers"),e.drawBuffers=e.__ext_draw_buffers.drawBuffersWEBGL.bind(e.__ext_draw_buffers);for(let t=1;t<14;t++)e["COLOR_ATTACHMENT"+t]=e.__ext_draw_buffers["COLOR_ATTACHMENT"+t+"_WEBGL"];e.MAX_COLOR_ATTACHMENTS=e.__ext_draw_buffers.MAX_COLOR_ATTACHMENTS_WEBGL,e.MAX_DRAW_BUFFERS=e.__ext_draw_buffers.MAX_DRAW_BUFFERS_WEBGL}const t=[];for(let i=0;i<this.textureTargets.length;i++)e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,this.textureTargets[i],0),t.push(e.COLOR_ATTACHMENT0+i);this.textureTargets.length>1&&e.drawBuffers(t)}this.depthTexture&&e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthTexture,0);const s=e.checkFramebufferStatus(e.DRAW_FRAMEBUFFER);if(s!=e.FRAMEBUFFER_COMPLETE)switch(s){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete.");case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("There is no attachment.");case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("Height and width of the attachment are not the same.");case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("The format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer.");case 36061:throw new Error("The framebuffer is unsupported");default:throw new Error("Incomplete Frambuffer")}this.unbind()}bindForWriting(t,e=!1){t&&(this.__prevBoundFbo=t.boundRendertarget,t.boundRendertarget=this.frameBuffer);const i=this.__gl;i.bindFramebuffer("webgl2"==i.name?i.DRAW_FRAMEBUFFER:i.FRAMEBUFFER,this.frameBuffer),i.viewport(0,0,this.width,this.height),e&&this.clear()}unbindForWriting(t){t&&(t.boundRendertarget=this.__prevBoundFbo);const e=this.__gl;e.bindFramebuffer("webgl2"==e.name?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER,this.__prevBoundFbo)}clear(t=!0){const e=this.__gl;e.colorMask(...this.colorMask),e.clearColor(...this.clearColor.asArray());let i=0;this.textureTargets.length>0&&(i|=e.COLOR_BUFFER_BIT),this.depthTexture&&(i|=e.DEPTH_BUFFER_BIT),e.clear(i)}bindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,this.frameBuffer)}unbindForReading(){const t=this.__gl;t.bindFramebuffer("webgl2"==t.name?t.READ_FRAMEBUFFER:t.FRAMEBUFFER,null)}bindColorTexture(t,e,i=0){const n=this.__gl,s=t.boundTextures++;return n.uniform1i(e.location,s),n.activeTexture(n.TEXTURE0+s),n.bindTexture(n.TEXTURE_2D,this.textureTargets[i]),!0}bindDepthTexture(t,e){const i=this.__gl,n=t.boundTextures++;return i.uniform1i(e.location,n),i.activeTexture(i.TEXTURE0+n),i.bindTexture(i.TEXTURE_2D,this.depthTexture),!0}unbind(){const t=this.__gl;t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)}resize(t,e,i=!1){}bindToUniform(t,e,i){const n=t.boundTextures++,s=this.__gl;return s.activeTexture(this.__gl.TEXTURE0+n),s.bindTexture(s.TEXTURE_2D,this.textureTargets[0]),s.uniform1i(e.location,n),i&&(i.textureTypeUnif&&s.uniform1i(i.textureTypeUnif.location,this.textureType),i.textureDescUnif&&this.__gl.uniform4fv(i.textureDescUnif.location,this.textureDesc)),!0}destroy(){const t=this.__gl;this.textureTargets.forEach(e=>{t.deleteTexture(e)}),this.textureTargets=[],this.depthTexture&&(t.deleteTexture(this.depthTexture),this.depthTexture=null),this.frameBuffer&&t.deleteFramebuffer(this.frameBuffer)}}const ni$1=new Uint32Array(1);function li$1(t){return ni$1[0]=t,ni$1[0]=(ni$1[0]<<16|ni$1[0]>>16)>>>0,ni$1[0]=(1431655765&ni$1[0])<<1|(2863311530&ni$1[0])>>>1>>>0,ni$1[0]=(858993459&ni$1[0])<<2|(3435973836&ni$1[0])>>>2>>>0,ni$1[0]=(252645135&ni$1[0])<<4|(4042322160&ni$1[0])>>>4>>>0,ni$1[0]=(16711935&ni$1[0])<<8|(4278255360&ni$1[0])>>>8>>>0,2.3283064365386963e-10*ni$1[0]}function ri$1(t,e){return[t/e,li$1(t)]}Ha$1.setShaderModule("utils/imageAtlas.glsl","\n\n// Note: On mobile, I can't seem to pass around a stuct containing sampler2D.\n// I have to unpack the struct and pass its members. :(\n// struct ImageAtlas {\n//     sampler2D layout;\n//     sampler2D image;\n//     vec4 desc;\n// };\n\n\n\nvec4 getSubImageLayout(int index, in sampler2D atlasLayout, in vec4 atlasDesc){\n    return fetchTexel(atlasLayout, int(floor(atlasDesc.z+0.5)), index);\n}\n\nvec2 calcSubImageTexCoords(vec2 texCoord, int index, in sampler2D atlasLayout, in vec4 atlasDesc){\n    vec4 layoutData = fetchTexel(atlasLayout, int(floor(atlasDesc.z+0.5)), index);\n    // The following line is a hack to fix artifacts in our PBR lighting\n    // We were seeing loads of lighting garbage on some sufaces that were orthogonal\n    // to the world. The UV coordinates would have been landing right on the edges\n    // of our subimages and were often sampling outside the image. This couuld\n    // have been because of filtering, or an error in the uv coords. \n    texCoord = clamp(texCoord, vec2(0.01, 0.01), vec2(0.99, 0.99));\n    vec2 subimageTexel = texCoord * layoutData.zw;\n    // subimageTexel = clamp(subimageTexel, vec2(0.0, 0.0), vec2(1.0, 1.0));\n    return subimageTexel + layoutData.xy;\n}\n\nvec4 sampleSubImage(vec2 texCoord, int index, in sampler2D atlasLayout, in sampler2D atlasImage, in vec4 atlasDesc){\n    vec4 layoutData = fetchTexel(atlasLayout, int(floor(atlasDesc.z+0.5)), index);\n    vec2 atlasCoords = calcSubImageTexCoords(texCoord, index, atlasLayout, atlasDesc);\n    return texture2D(atlasImage, atlasCoords);\n}\n\n");class oi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("AtlasLayoutShader.vertexShader",'\n\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform vec2 pos;\nuniform vec2 size;\nuniform vec2 srctextureDim;\nconst int border = 2;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n  vec2 position = getQuadVertexPositionFromID();\n  v_texCoord = position+0.5;\n  gl_Position = vec4(vec2(-1.0, -1.0) + (pos * 2.0) + (v_texCoord * size * 2.0), 0.0, 1.0);\n\n  vec2 borderVec2 = vec2(float(border), float(border));\n  v_texCoord *= (srctextureDim + (borderVec2 * 2.0)) / srctextureDim;\n  v_texCoord -= borderVec2 / srctextureDim;\n}\n\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("AtlasLayoutShader.fragmentShader","\nprecision highp float;\n\nuniform sampler2D srctexture;\nuniform vec2 srctextureDim;\nuniform bool alphaFromLuminance;\nuniform bool invert;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n\nfloat luminanceFromRGB(vec3 rgb) {\n  return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n  vec2 pixelCoord = v_texCoord*srctextureDim;\n  vec2 uv = v_texCoord;\n\n  // Wrap X coords\n  if(pixelCoord.x < 0.0){\n    uv.x += 1.0/srctextureDim.x;\n    uv.y = 1.0 - uv.y;\n  }\n  else if(pixelCoord.x > srctextureDim.x){\n    uv.x -= 1.0/srctextureDim.x;\n    uv.y = 1.0 - uv.y;\n  }\n\n  // Wrap Y coords\n  if(pixelCoord.y < 0.0){\n    uv.y += 1.0/srctextureDim.y;\n    uv.x = 1.0 - uv.x;\n  }\n  else if(pixelCoord.y > srctextureDim.y){\n    uv.y -= 1.0/srctextureDim.y;\n    uv.x = 1.0 - uv.x;\n  }\n\n  vec4 texel = texture2D(srctexture, uv);\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  // TODO: check why we pre-multiply alphas here.\n  // fragColor = vec4(texel.rgb/texel.a, texel.a);\n\n  if(alphaFromLuminance) {\n    fragColor = vec4(texel.rgb, luminanceFromRGB(texel.rgb));\n  }\n  else {\n    fragColor = texel;\n  }\n  \n  if(invert) {\n    fragColor = vec4(1.0) - fragColor;\n  }\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n\n")}}class di$1 extends si$1{constructor(t,e,i="RGBA",n="FLOAT"){super(t),this.__name=e,this.__formatParam=i,this.__typeParam=n,this.clearColor=new y$3(0,0,0,0),this.__subImages=[],this.__layoutNeedsRegeneration=!1,this.__async=new Y$1,this.loaded=this.__async.ready}isLoaded(){return 0==this.__async.count}getMainImage(){return this.super}addSubImage(t){if(t instanceof we$1){const e=new Na$1(this.__gl,t);t.isLoaded()||(this.__async.incAsyncCount(),t.loaded.connect(()=>{this.__async.decAsyncCount()})),t.setMetadata("ImageAtlas_gltex",e),e.addRef(this),t.updated.connect(()=>{this.__layoutNeedsRegeneration=!0,this.renderAtlas()}),this.__subImages.push(e)}else t.addRef(this),this.__subImages.push(t);return this.__layoutNeedsRegeneration=!0,this.__subImages.length-1}removeSubImage(t){let e;if(t instanceof we$1){const i=t.getMetadata("ImageAtlas_gltex");e=this.__subImages.indexOf(i),t.deleteMetadata("ImageAtlas_gltex")}else e=this.__subImages.indexOf(t);this.__subImages[e].removeRef(this),this.__subImages.splice(e,1),this.__layoutNeedsRegeneration=!0}getSubImage(t){return this.__subImages[t]}numSubImages(){return this.__layout?this.__layout.length:this.__subImages.length}generateAtlasLayout(){if(0==this.__subImages.length)return void(this.__layoutNeedsRegeneration=!1);const t=[];this.__subImages.forEach((e,i)=>{t.push({w:e.width+4,h:e.height+4,area:e.width*e.height,index:i})}),t.sort((t,e)=>t.area>e.area?-1:t.area<e.area?1:0);const e=new N$1;e.fit(t),this.__layout=[],t.forEach(t=>{t.fit?this.__layout[t.index]={pos:new _$1(t.fit.x+2,t.fit.y+2),size:new _$1(t.w,t.h)}:console.warn("Unable to fit image")});const i=e.root.w,n=e.root.h;this.configure({width:i,height:n,format:"FLOAT"==this.__typeParam&&"RGB"==this.__formatParam?"RGBA":this.__formatParam,type:this.__typeParam,filter:"LINEAR"});const s=this.__gl;if(s.__quadVertexIdsBuffer||s.setupInstancedQuad(),!s.__atlasLayoutShader){s.__atlasLayoutShader=new oi$1(s);const t=s.__atlasLayoutShader.compileForTarget("GLImageAtlas");s.__atlasLayoutShaderBinding=wa$1(s,t.attrs,s.__quadattrbuffers,s.__quadIndexBuffer)}let o=Math.round(Math.sqrt(1*this.__layout.length)+.5);if(o=Math.nextPow2(o),o%1!=0&&(o+=1-o%1),s.floatTexturesSupported){const t=new Float32Array(o*o*4);for(let e=0;e<this.__layout.length;e++){const s=this.__layout[e];G$1.createFromFloat32Buffer(t.buffer,4*e).set(s.pos.x/i,s.pos.y/n,s.size.x/i,s.size.y/n)}this.__atlasLayoutTexture&&this.__atlasLayoutTexture.width==o&&this.__atlasLayoutTexture.height==o?this.__atlasLayoutTexture.bufferData(t,o,o):(this.__atlasLayoutTexture&&this.__atlasLayoutTexture.destroy(),this.__atlasLayoutTexture=new Na$1(s,{format:"RGBA",type:"FLOAT",filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1,width:o,height:o,data:t}))}else this.__layoutVec4s=[],this.__layout.forEach((t,e)=>{this.__layoutVec4s[e]=[t.pos.x/i,t.pos.y/n,t.size.x/i,t.size.y/n]});this.__layoutNeedsRegeneration=!1}getLayoutData(t){return this.__layoutVec4s[t]}renderAtlas(t=!1,e=0){if(0==this.__subImages.length)return;this.__layoutNeedsRegeneration&&this.generateAtlasLayout();const i=this.__gl,n={};this.bindForWriting(n,!0),i.__atlasLayoutShader.bind(n,"GLImageAtlas"),i.__atlasLayoutShaderBinding.bind(n);const s=new _$1(1/this.width,1/this.height),o=n.unifs;for(let r=e;r<this.__subImages.length;r++){const t=this.__subImages[r],e=this.__layout[r];t.bindToUniform(n,o.srctexture),i.uniform2fv(o.pos.location,e.pos.multiply(s).asArray()),i.uniform2fv(o.size.location,e.size.multiply(s).asArray()),i.uniform2f(o.srctextureDim.location,t.width,t.height),i.uniform1i(o.alphaFromLuminance.location,t.alphaFromLuminance),i.uniform1i(o.invert.location,t.invert),i.drawQuad(),n.boundTextures--}t&&this.cleanup(),this.unbind(n),this.updated.emit()}isReady(){return null!=this.__atlasLayoutTexture}bindToUniform(t,e){if(!this.__atlasLayoutTexture)return!1;super.bindToUniform(t,e);const i=t.unifs,n=i[e.name+"_layout"];n&&this.__atlasLayoutTexture.bindToUniform(t,n);const s=i[e.name+"_desc"];return s&&this.__gl.uniform4f(s.location,this.width,this.height,this.__atlasLayoutTexture.width,0),!0}cleanup(){for(const t of this.__subImages)t.removeRef(this);this.__subImages=[],this.destroy()}destroy(){this.cleanup(),super.destroy()}}class hi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("ConvolverShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n  vec2 position = getQuadVertexPositionFromID();\n  v_texCoord = position+0.5;\n  gl_Position = vec4(position*2.0, 0.0, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("ConvolverShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="utils/imagePyramid.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n\nuniform float roughness;\nvarying vec2 v_texCoord;\n\nuniform sampler2D hammersleyMap;\nvec2 Hammersley(int i, int N) {\n  vec4 rgba =  texture2D(hammersleyMap, vec2((float(i) + 0.5)/float(N)), 0.5);\n  return rgba.rg;\n}\n\nmat3 matrixFromVector(vec3 n) { // frisvad\n  float a = 1.0 / (1.0 + n.z);\n  float b = -n.x * n.y * a;\n  vec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n  vec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n  return mat3(b1, b2, n);\n}\n\nvec3 ImportanceSampleGGX(vec2 Xi, float a) {\n  float phi = 2.0 * PI * Xi.x;\n  float cos_theta = sqrt((1.0 - Xi.y)/(1.0 + (a*a - 1.0) * Xi.y));\n  float sin_theta = sqrt(1.0 - cos_theta * cos_theta);\n\n  // float phi = Xi.y * 2.0 * PI;\n  // float cos_theta = sqrt(1.0 - Xi.x);\n  // float sin_theta = sqrt(1.0 - cos_theta * cos_theta);\n\n  vec3 H;\n  H.x = sin_theta * cos(phi);\n  H.y = sin_theta * sin(phi);\n  H.z = cos_theta;\n  return H;\n}\n\n// TODO: use tobias\'s code. The guy clearly knows what he\'s doing...\n// https://github.com/thefranke/dirtchamber/blob/master/shader/importance.hlsl\n// Compute a LOD level for filtered importance sampling.\n// From GPU Gems 3: GPU-Based Importance Sampling.\n\n\n#define M_PI       3.14159265358979323846   // pi\n#define M_HALF_PI  1.57079632679489661923   // pi/2\nfloat sqr(float val){ return val*val; }\nfloat saturate(float val) { return clamp(val, 0.0, 1.0); }\nvec3 saturate(vec3 val) { return clamp(val, 0.0, 1.0); }\n\n// Microfacet Models for Refraction through Rough Surfaces\n// Walter et al.\n// http://www.cs.cornell.edu/~srm/publications/EGSR07-btdf.html\n// aka Towbridge-Reitz\nfloat D_ggx(in float alpha, in float NoH)\n{\n  float a2 = alpha*alpha;\n  float cos2 = NoH*NoH;\n\n  return (1.0/M_PI) * sqr(alpha/(cos2 * (a2 - 1.0) + 1.0));\n\n  /*\n  // version from the paper, eq 33\n  float CosSquared = NoH*NoH;\n  float TanSquared = (1.0 - CosSquared)/CosSquared;\n  return (1.0/M_PI) * sqr(alpha/(CosSquared * (alpha*alpha + TanSquared)));\n  */\n}\nfloat compute_lod(in vec3 H, in float pdf, in int num_samples, in int ww, in int hh)\n{\n  return max(0.0, 0.5*log2(float(ww*hh)/float(num_samples)) - 0.5*log2(pdf));\n}\n\nuniform sampler2D   envMapPyramid;\nuniform sampler2D   envMapPyramid_layout;\nuniform vec4        envMapPyramid_desc;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec3 N = sphOctUvToDir(v_texCoord);\n\n  if(false){\n    vec2 uv = dirToSphOctUv(N);\n    // fragColor = vec4(uv.x, uv.y, 0.0, 1.0);\n    fragColor = sampleImagePyramid(uv, 0.5, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc);\n    // fragColor = sampleSubImage(uv, 0, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc);\n    // fragColor = texture2D(envMapPyramid, uv);\n  }\n  else{\n    const int numSamples = NUM_SAMPLES;\n    int w = int(floor(envMapPyramid_desc.x + 0.5));\n    int h = int(floor(envMapPyramid_desc.y + 0.5));\n\n    vec4 color = vec4(0.0,0.0,0.0,0.0);\n    float weight = 0.0;\n    mat3 vecSpace = matrixFromVector(N);\n    float a = roughness*roughness;\n    for(int i=0; i<numSamples; i++) {\n      vec2 Xi = Hammersley(i, numSamples);\n      vec3 H = ImportanceSampleGGX(Xi, a);\n      vec3 V = normalize(vecSpace * H);\n      float VdotN = dot(V, N);\n      float NoH = saturate( dot( N, H ) );\n      float VoH = saturate( dot( V, H ) );\n\n      vec2 uv = dirToSphOctUv(V);\n      // float pdf = D_ggx(a, NoH) * NoH / (4.0 * VoH);\n      // float lod = compute_lod(H, pdf, numSamples, w, h);\n\n      color += sampleImagePyramid(uv, a, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc) * VdotN;\n      weight += VdotN;\n    }\n    color /= float(weight);\n    fragColor = vec4(color.rgb, 1.0);\n  }\n  \n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n\n')}}Ha$1.setShaderModule("utils/imagePyramid.glsl",'\n\n<%include file="utils/imageAtlas.glsl"/>\n\nvec4 sampleImagePyramid(vec2 uv, float lod, in sampler2D atlasLayout, in sampler2D atlasImage, in vec4 atlasDesc){\n  if (lod < 0.00001 || lod > 0.9999) {\n    float imageIndex = lod * (atlasDesc.z-1.0);\n    int imageId0 = int(imageIndex);\n    return sampleSubImage(uv, imageId0, atlasLayout, atlasImage, atlasDesc);\n  } else {\n    float imageIndex = lod * (atlasDesc.z-1.0);\n    int imageId0 = int(floor(imageIndex));\n    int imageId1 = imageId0+1;\n    float blend = fract(imageIndex);\n    vec4 c0 = sampleSubImage(uv, imageId0, atlasLayout, atlasImage, atlasDesc);\n    vec4 c1 = sampleSubImage(uv, imageId1, atlasLayout, atlasImage, atlasDesc);\n    return mix(c0, c1, blend);\n  } \n}\n\n\n');class ci$1 extends di$1{constructor(t,e,i,n=!0,s=16){super(t,e),this.__srcGLTex=i,this.__fbos=[],i.updated.connect(()=>{this.renderAtlas(n)}),this.__srcGLTex.isLoaded()?(this.generateAtlasLayout(s),this.renderAtlas(n)):this.__srcGLTex.updated.connect(()=>{this.generateAtlasLayout(s),this.renderAtlas(n)})}generateAtlasLayout(t){const e=this.__gl;this.size=this.__srcGLTex.height;const i=this.__srcGLTex.width/this.__srcGLTex.height;this.addSubImage(this.__srcGLTex);for(let n=Math.round(function(t){return Math.log2(t)}(this.size))-1;n>=0;--n){const s=Math.pow(2,n);if(s<t)break;const o=new Na$1(e,{format:this.__srcGLTex.getFormat(),type:this.__srcGLTex.getType(),width:s*i,height:s,filter:"LINEAR",wrap:"CLAMP_TO_EDGE"});this.addSubImage(o),this.__fbos.push(new Oa$1(e,o))}super.generateAtlasLayout()}renderAtlas(t=!0){const e=this.__gl,i={};e.screenQuad.bindShader(i);for(let n=0;n<this.__fbos.length;n++)this.__fbos[n].bindAndClear(),e.screenQuad.draw(i,this.getSubImage(n));super.renderAtlas(t)}destroy(){super.destroy();for(const t of this.__fbos)t.destroy()}}class mi$1 extends di$1{constructor(t,e){super(t,e),this.__gl=t,t.__quadVertexIdsBuffer||t.setupInstancedQuad(),this.__convolved=!1,this.__fbos=[]}generateHammersleySamples(t){const e=this.__gl;if(!e["Hammersley"+t]){const i=new Float32Array(3*t);for(let e=0;e<t;e++){const n=ri$1(e,t),s=3*e;i[s+0]=n[0],i[s+1]=n[1]}e["Hammersley"+t]=new Na$1(e,{format:"RGB",type:"FLOAT",filter:"NEAREST",wrap:"CLAMP_TO_EDGE",width:t,height:1,data:i,mipMapped:!1})}return e["Hammersley"+t]}convolveProbe(t){const e=this.__gl,i=this.generateHammersleySamples(1024);if(!this.__convolved){this.__lodPyramid||(this.__lodPyramid=new ci$1(e,"Probe Lods",t,!1),this.__lodPyramid.updated.connect(()=>{this.convolveProbe(t)})),this.addSubImage(t);let i=[t.width/2,t.height/2];const n=6;for(let t=0;t<n;t++){const t=new Na$1(e,{format:"RGBA",type:"FLOAT",filter:"LINEAR",wrap:"CLAMP_TO_EDGE",width:i[0],height:i[1]});this.addSubImage(t);const n=new Oa$1(e,t);n.setClearColor([0,1,0,0]),this.__fbos.push(n),i=[i[0]/2,i[1]/2]}this.generateAtlasLayout(),this.__convolverShader=new hi$1(e);const s=this.__convolverShader.compileForTarget("GLProbe",Object.assign({repl:{NUM_SAMPLES:1024}},e.shaderopts));this.__covolverShaderBinding=wa$1(e,s.attrs,e.__quadattrbuffers,e.__quadIndexBuffer)}const n={};this.__convolverShader.bind(n,"GLProbe"),this.__covolverShaderBinding.bind(n);const s=n.unifs;for(let o=0;o<this.__fbos.length;o++)this.__fbos[o].bindAndClear(),this.__lodPyramid.bindToUniform(n,s.envMapPyramid),"hammersleyMap"in s&&i.bindToUniform(n,s.hammersleyMap),"roughness"in s&&e.uniform1f(s.roughness.location,(o+1)/this.__fbos.length),e.drawQuad();this.__convolved=!0,this.renderAtlas(!1)}bindProbeToUniform(t,e){this.__convolved&&super.bindToUniform(t,e)}destroy(){super.destroy(),this.__convolverShader.destroy();for(const t of this.__fbos)t.destroy()}}Ha$1.setShaderModule("stack-gl/inverse.glsl","\n\n\n#ifndef ENABLE_ES3\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\n#endif\n\n"),Ha$1.setShaderModule("stack-gl/transpose.glsl","\n\n\n#ifndef ENABLE_ES3\n\nfloat transpose(float m) {\n  return m;\n}\n\nmat2 transpose(mat2 m) {\n  return mat2(m[0][0], m[1][0],\n              m[0][1], m[1][1]);\n}\n\nmat3 transpose(mat3 m) {\n  return mat3(m[0][0], m[1][0], m[2][0],\n              m[0][1], m[1][1], m[2][1],\n              m[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose(mat4 m) {\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\n              m[0][1], m[1][1], m[2][1], m[3][1],\n              m[0][2], m[1][2], m[2][2], m[3][2],\n              m[0][3], m[1][3], m[2][3], m[3][3]);\n}\n\n#endif\n\n"),Ha$1.setShaderModule("pragmatic-pbr/envmap-octahedral.glsl","\n\n#define sectorize(value) step(0.0, (value))*2.0-1.0\n#define sum(value) dot(clamp((value), 1.0, 1.0), (value))\n\n\nvec2 dirToSphOctUv(vec3 normal){\n    normal = normalize(normal);\n    vec3 aNorm = abs(normal);\n    vec3 sNorm = sectorize(normal);\n\n    vec2 dir = max(aNorm.xy, 1e-20);\n    float orient = atan(dir.x, dir.y)/HalfPI;\n\n    dir = max(vec2(aNorm.z, length(aNorm.xy)), 1e-20);\n    float pitch = atan(dir.y, dir.x)/HalfPI;\n\n    vec2 uv = vec2(sNorm.x*orient, sNorm.y*(1.0-orient))*pitch;\n\n    if(normal.z < 0.0){\n        uv = sNorm.xy - abs(uv.ts)*sNorm.xy;\n    }\n    return uv*0.5+0.5;\n}\n\n\nvec3 sphOctUvToDir(vec2 uv){\n    uv = uv*2.0-1.0;\n    vec2 suv = sectorize(uv);\n    float sabsuv =  sum(abs(uv));\n    float pitch = sabsuv*HalfPI;\n\n    if (pitch <= 0.0) {\n        return vec3(0.0, 0.0, 1.0);\n    }\n    if (abs(pitch - PI) < 0.000001) {\n        return vec3(0.0, 0.0, -1.0);\n    }\n    if(sabsuv > 1.0){\n        uv = (1.0-abs(uv.ts))*suv;\n    }\n\n    float orient = (abs(uv.s)/sabsuv)*HalfPI;\n    float sOrient = sin(orient);\n    float cOrient = cos(orient);\n    float sPitch = sin(pitch);\n    float cPitch = cos(pitch);\n\n    return vec3(\n        sOrient*suv.s*sPitch,\n        cOrient*suv.t*sPitch,\n        cPitch\n    );\n}\n\n"),Ha$1.setShaderModule("pragmatic-pbr/envmap-equirect.glsl","\n\n\nvec2 latLongUVsFromDir(vec3 dir) {\n  // Math function taken from...\n  // http://gl.ict.usc.edu/Data/HighResProbes/\n  // Note: Scaling from u=[0,2], v=[0,1] to u=[0,1], v=[0,1]\n  float phi = acos(dir.z);\n  float theta = atan(dir.x, dir.y);\n  return vec2((1.0 + theta / PI) / 2.0, phi / PI);\n}\n\n// Note: when u == 0.5 z = 1.0\nvec3 dirFromLatLongUVs(float u, float v) {\n    // http://gl.ict.usc.edu/Data/HighResProbes/\n    float theta = PI*((u * 2.0) - 1.0);\n    float phi = PI*v;\n    return vec3(sin(phi)*sin(theta), sin(phi)*cos(theta), cos(phi));\n}\n\nvec3 dirFromPolar(vec2 polar) {\n    float u = polar.x / (PI * 2.0);\n    float v = polar.y / PI;\n    return dirFromLatLongUVs(u, v);\n}\n\n"),Ha$1.setShaderModule("pragmatic-pbr/envmap-dualfisheye.glsl","\n\n\n\nvec2 dualfisheyeUVsFromDir(vec3 dir) {\n  vec2 result;\n  float angle = 0.465;\n    if(dir.x < 0.0) {\n        result = vec2(((dir.z * -angle) + 0.5) * 0.5, (dir.y * angle) + 0.5);\n    }\n    else {\n        result = vec2( 0.5 + ((dir.z * angle) + 0.5) * 0.5, (dir.y * angle) + 0.5);\n    }\n    return result;\n}\n\n\n");class ui$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("EnvMapShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\n\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="stack-gl/transpose.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n  vec2 position = getQuadVertexPositionFromID() * 2.0;\n  v_texCoord = position * 0.5 + 0.5;\n\n  mat4 inverseProjection = inverse(projectionMatrix);\n  mat3 inverseModelview = transpose(mat3(viewMatrix));\n\n  // transform from the normalized device coordinates back to the view space\n  vec3 unprojected = (inverseProjection * vec4(position, 0, 1)).xyz;\n\n  // transfrom from the view space back to the world space\n  // and use it as a sampling vector\n  v_worldDir = inverseModelview * unprojected;\n\n  gl_Position = vec4(position, 0, 1);\n}\n\n')}}class bi$1 extends ui$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("LatLongEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec4 texel = texture2D(backgroundImage, v_texCoord);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class pi$1 extends ui$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("OctahedralEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n<%include file="utils/imagePyramid.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n\nuniform float focus;\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\n// uniform ImageAtlas envMap;\nuniform sampler2D   envMapPyramid;\nuniform sampler2D   envMapPyramid_layout;\nuniform vec4        envMapPyramid_desc;\n\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = dirToSphOctUv(normalize(v_worldDir));\n  if(false){\n    // Use these lines to debug the src GL image.\n    vec4 texel = texture2D(envMapPyramid, uv);\n    fragColor = vec4(texel.rgb/texel.a, 1.0);\n  }\n  else{\n    fragColor = vec4(sampleImagePyramid(uv, focus, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc).rgb, 1.0);\n  }\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class gi$1 extends ui$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("LatLongEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = latLongUVsFromDir(normalize(v_worldDir));\n\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){return super.getParamDeclarations()}}class _i$1 extends ui$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("SterioLatLongEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform int eye;// L = 0, R = 1;\n\nuniform sampler2D backgroundImage;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = latLongUVsFromDir(normalize(v_worldDir));\n  uv.y *= 0.5;\n  if(eye == 1){\n    uv.y += 0.5;\n  }\n\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class Zi$1 extends ui$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("DualFishEyeEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-dualfisheye.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = dualfisheyeUVsFromDir(normalize(v_worldDir));\n\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class Gi$1 extends ui$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("DualFishEyeEnvMapShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n<%include file="pragmatic-pbr/envmap-dualfisheye.glsl"/>\n\n#define ENABLE_INLINE_GAMMACORRECTION\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\nuniform float exposure;\n#endif\n\nuniform sampler2D backgroundImage;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\n\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 uv = dualfisheyeUVsFromDir(dirFromLatLongUVs(v_texCoord.x, v_texCoord.y));\n  vec4 texel = texture2D(backgroundImage, uv);\n  fragColor = vec4(texel.rgb/texel.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  //fragColor.rgb = toGamma(fragColor.rgb * exposure);\n\n  // Assuming a simple RGB image in gamma space for now.\n  // fragColor.rgb = fragColor.rgb * exposure;\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}class Xi$1 extends mi$1{constructor(t,e,i){super(t.gl,"EnvMap"),this.__renderer=t,this.__envMap=e,this.__backgroundFocus=0;const n=t.gl;n.__quadVertexIdsBuffer||n.setupInstancedQuad();let s=this.__envMap.getMetadata("gltexture");s||(s=new Qa$1(n,this.__envMap)),this.__srcGLTex=s,this.__envMapShader=new pi$1(n);const o=this.__envMapShader.compileForTarget("GLEnvMap",i);this.__envMapShaderBinding=wa$1(n,o.attrs,n.__quadattrbuffers,n.__quadIndexBuffer),this.__envMap.isLoaded()?this.convolveProbe(s):this.__envMap.loaded.connect(()=>{this.convolveProbe(s),this.loaded.emit()})}getEnvMap(){return this.__envMap}getBackgroundFocus(){return this.__backgroundFocus}setBackgroundFocus(t){this.__backgroundFocus=t,this.__renderer.requestRedraw()}draw(t){if(this.__envMap.isLoaded()){const e=this.__gl;{this.__envMapShader.bind(t,"GLEnvMap");const i=t.unifs;this.bindProbeToUniform(t,i.envMapPyramid);{const t=i.focus;t&&e.uniform1f(t.location,this.__backgroundFocus)}{const n=i.exposure;n&&e.uniform1f(n.location,t.exposure)}this.__envMapShaderBinding.bind(t),e.depthMask(!1),t.bindViewports(i,()=>{e.drawQuad()})}}}bindToUniform(t,e,i){return this.__srcGLTex.bindToUniform(t,e,i)}destroy(){super.destroy(),this.__srcGLTex.loaded.disconnectScope(this),this.__srcGLTex.updated.disconnectScope(this),this.__srcGLTex.destroy()}}class yi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("ScreenQuadShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform vec2 pos;\nuniform vec2 size;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(vec2(-1.0, -1.0) + (pos * 2.0) + (v_texCoord * abs(size) * 2.0), 0.0, 1.0);\n    if(size.x < 0.0)\n        v_texCoord.x = 1.0 - v_texCoord.x;\n    if(size.y < 0.0)\n        v_texCoord.y = 1.0 - v_texCoord.y;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("ScreenQuadShader.fragmentShader","\nprecision highp float;\n\nuniform sampler2D image;\n\nvarying vec2 v_texCoord;\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = texture2D(image, v_texCoord);\n    fragColor = vec4(fragColor.rgb/fragColor.a, 1.0);\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n"),this.finalize()}}class fi$1{constructor(t,e){this.__gl=t,this.__pos=[0,0],this.__size=[1,1],this.flipY=!0,this.__glshader=new yi$1(t),t.__quadVertexIdsBuffer||t.setupInstancedQuad();const i=this.__glshader.compileForTarget("GLScreenQuad",e);this.__quadBinding=wa$1(t,i.attrs,t.__quadattrbuffers,t.__quadIndexBuffer),this.ready=!0}bind(t,e,i,n){const s=t.unifs;e.bindToUniform(t,t.unifs.image);const o=this.__gl;{const t=s.pos;t&&o.uniform2fv(t.location,i?i instanceof p$1?i.asArray():i:this.__pos)}{const t=s.size;t&&o.uniform2fv(t.location,n?n instanceof p$1?n.asArray():n:this.__size)}this.__quadBinding.bind(t)}bindShader(t){return this.__glshader.bind(t,"GLScreenQuad")}draw(t,e,i,n){this.bind(t,e,i,n),this.__gl.drawQuad()}destroy(){}}class Vi$1 extends q$1{constructor(t){super(),this.__renderer=t,this.__doubleClickTimeMSParam=this.addParameter(new Ze$1("DoubleClickTimeMS",200)),this.__fbo=void 0,this.updated=new C$1,this.resized=new C$1,this.__renderer.sceneSet.connect(()=>{const e=t.getScene().settings.getParameter("BackgroundColor"),i=()=>{const t=e.getValue();let i=this.__renderer.gl;t instanceof we$1?"FLOAT"===t.type?(this.__backgroundTexture=t,this.__backgroundGLTexture=new Qa$1(i,t)):(this.__backgroundTexture=t,this.__backgroundGLTexture=new Na$1(i,t)):t instanceof y$3?(this.__backgroundGLTexture&&(this.__backgroundGLTexture.destroy(),this.__backgroundGLTexture=void 0,this.__backgroundTexture=void 0),this.__backgroundColor=t):console.warn("Invalid background:"+t),this.updated.emit()};i(e.getValue()),e.valueChanged.connect(i)})}getRenderer(){return this.__renderer}getName(){return this.__name}getBl(){return this.__bl}setBl(t){this.__bl=t,this.resize(this.__canvasWidth,this.__canvasHeight)}getTr(){return this.__tr}setTr(t){this.__tr=t,this.resize(this.__canvasWidth,this.__canvasHeight)}getPosX(){return this.__x}getPosY(){return this.__y}getWidth(){return this.__width}getHeight(){return this.__height}getBackground(){return console.warn("Deprecated Function. Please access the Scene Settings object."),this.__renderer.getScene().settings.getParameter("BackgroundColor").getValue()}setBackground(t){console.warn("Deprecated Function. Please access the Scene Settings object."),this.__renderer.getScene().settings.getParameter("BackgroundColor").setValue(t),this.updated.emit()}resize(t,e){this.__canvasWidth=t,this.__canvasHeight=e,this.__width=t,this.__height=e,this.resized.emit()}onMouseDown(t){return!1}onMouseUp(t){return!1}onMouseMove(t){return!1}onMouseLeave(t){return!1}onKeyPressed(t,e){return!1}onKeyDown(t,e){return!1}onKeyUp(t,e){return!1}}class Ii$1 extends Vi$1{constructor(t,e,i,n){super(t),this.__name=e,this.__projectionMatrix=new I$1,this.__frustumDim=new _$1,this.__bl=new _$1(0,0),this.__tr=new _$1(1,1),this.__exposure=0,this.__exposureRange=[-5,10],this.__tonemap=!0,this.__gamma=2.2,this.__prevDownTime=0,this.__geomDataBuffer=void 0,this.__geomDataBufferFbo=void 0,this.viewChanged=new C$1,this.capturedItem=null,this.keyDown=new C$1,this.keyPressed=new C$1,this.keyUp=new C$1,this.mouseDown=new C$1,this.mouseDoubleClicked=new C$1,this.mouseMove=new C$1,this.mouseUp=new C$1,this.mouseLeave=new C$1,this.mouseDownOnGeom=new C$1,this.mouseWheel=new C$1,this.touchStart=new C$1,this.touchMove=new C$1,this.touchEnd=new C$1,this.touchCancel=new C$1,this.doubleTapped=new C$1,this.setCamera(new pa$1("Default")),this.setManipulator(new Ta$1),this.resize(i,n)}resize(t,e){this.__canvasWidth=t,this.__canvasHeight=e,this.__x=t*this.__bl.x,this.__y=t*this.__bl.y,this.__width=t*this.__tr.x-t*this.__bl.x,this.__height=e*this.__tr.y-e*this.__bl.y,this.region=[this.__x,this.__y,this.__width,this.__height],this.__camera&&this.__updateProjectionMatrix(),this.__geomDataBufferFbo&&(this.__geomDataBuffer.resize(this.__width,this.__height),this.__geomDataBufferFbo.resize()),this.resized.emit()}getCamera(){return this.__camera}setCamera(t){this.__camera=t;const e=t.getParameter("GlobalXfo"),i=()=>{this.__cameraXfo=e.getValue(),this.__cameraMat=this.__cameraXfo.toMat4(),this.__viewMat=this.__cameraMat.inverse()};i(),e.valueChanged.connect(()=>{i(),this.invalidateGeomDataBuffer(),this.updated.emit(),this.viewChanged.emit({interfaceType:"CameraAndPointer",viewXfo:this.__cameraXfo,focalDistance:this.__camera.getFocalDistance()})}),this.__camera.projectionParamChanged.connect(()=>{this.__updateProjectionMatrix(),this.updated.emit()}),this.__updateProjectionMatrix()}getManipulator(){return this.__cameraManipulator}setManipulator(t){this.__cameraManipulator=t}__updateProjectionMatrix(){const t=this.__width/this.__height;this.__camera.updateProjectionMatrix(this.__projectionMatrix,t);const e=Math.tan(this.__camera.getFov()/2)*this.__camera.getNear()*2;this.__frustumDim.set(e*t,e)}getProjectionMatrix(){return this.__projectionMatrix}getViewMatrix(){return this.__viewMat}setActive(t){activeViewport=t?this:void 0}frameView(t){this.__camera.frameView(this,t)}calcRayFromScreenPos(t){let e=(t.x-this.__x)/this.__width,i=(t.y-this.__canvasHeight*(1-this.__tr.y))/this.__height;e=2*e-1,i=2*i-1;const n=this.__cameraMat,s=this.__projectionMatrix.inverse();if(null==s)return null;let o,r;return this.__camera.getIsOrthographic()?(o=n.transformVec3(s.transformVec3(new Z$1(e,-i,-1))),r=new Z$1(0,0,-1)):(o=n.translation,r=s.transformVec3(new Z$1(e,-i,-1))),r=n.rotateVec3(r).normalize(),new x$1(o,r)}createGeomDataFbo(t){const e=this.__renderer.gl;this.__floatGeomBuffer=t,this.__geomDataBuffer=new Na$1(e,this.__floatGeomBuffer?{type:"FLOAT",format:"RGBA",filter:"NEAREST",width:this.__width<=1?1:this.__width,height:this.__height<=1?1:this.__height}:{type:"UNSIGNED_BYTE",format:"RGBA",filter:"NEAREST",width:this.__width<=1?1:this.__width,height:this.__height<=1?1:this.__height}),this.__geomDataBufferFbo=new Oa$1(e,this.__geomDataBuffer,!0),this.__geomDataBufferFbo.setClearColor([0,0,0,0])}getGeomDataFbo(){return this.__geomDataBufferFbo}renderGeomDataFbo(){if(this.__geomDataBufferFbo){this.__geomDataBufferFbo.bindAndClear();const t={};this.__initRenderState(t),this.__renderer.drawSceneGeomData(t),this.__geomDataBufferInvalid=!1}}invalidateGeomDataBuffer(){this.__geomDataBufferInvalid=!0}getGeomDataAtPos(t,e){if(this.__geomDataBufferFbo){if(this.__geomDataBufferInvalid&&(this.renderGeomDataFbo(),this.__screenPos=null),t===this.__screenPos)return this.__intersectionData;this.__screenPos=t,this.__intersectionData=null;const i=this.__renderer.gl;let n,s;if(i.finish(),this.__geomDataBufferFbo.bindForReading(),i.floatGeomBuffer){if(s=new Float32Array(4),i.readPixels(t.x,this.__height-t.y,1,1,i.RGBA,i.FLOAT,s),0==s[3])return;n=63&Math.round(s[0])}else{if(s=new Uint8Array(4),i.readPixels(t.x,this.__height-t.y,1,1,i.RGBA,i.UNSIGNED_BYTE,s),i.bindFramebuffer(i.FRAMEBUFFER,null),0==s[0]&&0==s[1])return;n=0}this.__geomDataBufferFbo.unbind();const o=this.__renderer.getPass(n);if(!o)return void console.warn("Geom data buffer returns invalid pass id:",n);const r=o.getGeomItemAndDist(s);if(r){e||(e=this.calcRayFromScreenPos(t));const i=e.start.add(e.dir.scale(r.dist));this.__intersectionData={screenPos:t,mouseRay:e,intersectionPos:i,geomItem:r.geomItem,dist:r.dist,geomData:s}}return this.__intersectionData}}getGeomItemsInRect(t,e){if(this.__geomDataBufferFbo){const i=this.__renderer.gl;i.finish();const n=Math.round(this.__height-e.y),s=Math.round(t.x),o=Math.round(e.x-t.x),r=Math.round(e.y-t.y),a=o*r;let l;this.__geomDataBufferFbo.bindForReading(),i.floatGeomBuffer?(l=new Float32Array(4*a),i.readPixels(s,n,o,r,i.RGBA,i.FLOAT,l)):(l=new Uint8Array(4*a),i.readPixels(s,n,o,r,i.RGBA,i.UNSIGNED_BYTE,l)),i.bindFramebuffer(i.FRAMEBUFFER,null);const c=new Set;for(let t=0;t<a;t++){let e;const n=l.subarray(4*t,4*(t+1));e=i.floatGeomBuffer?Math.round(n[0]):0;const s=this.__renderer.getPass(e).getGeomItemAndDist(n);s&&c.add(s.geomItem)}return c}}__eventMousePos(t){return new _$1(t.rendererX-this.getPosX(),t.rendererY-this.getPosY())}__prepareEvent(t){if(t.viewport=this,t.propagating=!0,t.stopPropagation(),t.stopPropagation=()=>{t.propagating=!1},t.setCapture=t=>{this.capturedItem=t},t.getCapture=()=>this.capturedItem,t.releaseCapture=()=>{this.capturedItem=null,this.renderGeomDataFbo()},t instanceof MouseEvent){const e=this.__eventMousePos(t);t.mousePos=e,t.mouseRay=this.calcRayFromScreenPos(e);const i=this.getGeomDataAtPos(t.mousePos,t.mouseRay);null!=i&&(t.intersectionData=i)}}setCapture(t){this.capturedItem=t}getCapture(){return this.capturedItem}releaseCapture(){this.capturedItem=null,this.renderGeomDataFbo()}onMouseDown(t){if(this.__prepareEvent(t),this.capturedItem)return void this.capturedItem.onMouseDown(t);if(null!=t.intersectionData){if(t.intersectionData.geomItem.onMouseDown(t),!t.propagating||this.capturedItem)return;if(this.mouseDownOnGeom.emit(t),!t.propagating)return}const e=Date.now();if(e-this.__prevDownTime<this.__doubleClickTimeMSParam.getValue()){if(this.__cameraManipulator&&(this.__cameraManipulator.onDoubleClick(t),!t.propagating))return;this.mouseDoubleClicked.emit(t)}else{if(this.__prevDownTime=e,this.__cameraManipulator&&(this.__cameraManipulator.onMouseDown(t),!t.propagating))return;this.mouseDown.emit(t)}return!1}onMouseMove(t){if(this.__prepareEvent(t),this.capturedItem)this.capturedItem.onMouseMove(t);else{if(null!=t.intersectionData){if(t.intersectionData.geomItem!=this.mouseOverItem&&(this.mouseOverItem&&this.mouseOverItem.onMouseLeave(t),this.mouseOverItem=t.intersectionData.geomItem,this.mouseOverItem.onMouseEnter(t)),t.intersectionData.geomItem.onMouseMove(t),!t.propagating||this.capturedItem)return}else this.mouseOverItem&&(this.mouseOverItem.onMouseLeave(t),this.mouseOverItem=null);this.__cameraManipulator&&(this.__cameraManipulator.onMouseMove(t),!t.propagating)||this.mouseMove.emit(t)}}onMouseUp(t){this.__prepareEvent(t),this.capturedItem?this.capturedItem.onMouseUp(t):(null==t.intersectionData||(t.intersectionData.geomItem.onMouseUp(t),t.propagating))&&(this.__cameraManipulator&&(this.__cameraManipulator.onMouseUp(t),!t.propagating)||this.mouseUp.emit(t))}onMouseLeave(t){this.__prepareEvent(t),this.mouseLeave.emit(t)}onKeyPressed(t,e){this.__prepareEvent(e),this.__cameraManipulator&&this.__cameraManipulator.onKeyPressed(t,e)||this.keyPressed.emit(t,e)}onKeyDown(t,e){this.__prepareEvent(e),this.__cameraManipulator&&this.__cameraManipulator.onKeyDown(t,e)||this.keyDown.emit(t,e)}onKeyUp(t,e){this.__prepareEvent(e),this.__cameraManipulator&&this.__cameraManipulator.onKeyUp(t,e)||this.keyUp.emit(t,e)}onWheel(t){this.__prepareEvent(t),(null==t.intersectionData||(t.intersectionData.geomItem.onWheel(t),t.propagating))&&(this.__cameraManipulator?this.__cameraManipulator.onWheel(t):this.mouseWheel.emit(t))}__eventTouchPos(t){return new _$1(t.rendererX-this.getPosX(),t.rendererY-this.getPosY())}onTouchStart(t){if(this.__prepareEvent(t),1==t.touches.length){const e=this.__eventTouchPos(t.touches[0]);t.touchPos=e,t.touchRay=this.calcRayFromScreenPos(e);const i=this.getGeomDataAtPos(e,t.touchRay);if(null!=i){if(t.intersectionData=i,i.geomItem.onMouseDown(t,i),!t.propagating)return;if(this.capturedItem)return;if(this.mouseDownOnGeom.emit(t),!t.propagating)return}const n=Date.now();if(n-this.__prevDownTime<this.__doubleClickTimeMSParam.getValue()){if(this.__cameraManipulator&&(this.__cameraManipulator.onDoubleTap(t),!t.propagating))return;return void this.doubleTapped.emit(t)}this.__prevDownTime=n}this.__cameraManipulator?this.__cameraManipulator.onTouchStart(t):this.touchStart.emit(t)}onTouchMove(t){if(this.__prepareEvent(t),this.capturedItem){t.touchPos=[],t.touchRay=[];for(let e=0;e<t.touches.length;e++){const i=this.__eventTouchPos(t.touches[e]);t.touchPos[e]=i,t.touchRay[e]=this.calcRayFromScreenPos(i)}return t.mousePos=t.touchPos[0],t.mouseRay=t.touchRay[0],void this.capturedItem.onMouseMove(t)}this.__cameraManipulator?this.__cameraManipulator.onTouchMove(t):this.touchMove.emit(t)}onTouchEnd(t){this.__prepareEvent(t),this.capturedItem?this.capturedItem.onMouseUp(t):this.__cameraManipulator?this.__cameraManipulator.onTouchEnd(t):this.touchEnd.emit(t)}onTouchCancel(t){this.__prepareEvent(t),this.capturedItem?this.capturedItem.onTouchCancel(t):this.__cameraManipulator?this.__cameraManipulator.onTouchCancel(t):this.touchCancel.emit(t)}__initRenderState(t){t.viewXfo=this.__cameraXfo,t.viewScale=1,t.region=this.region,t.cameraMatrix=this.__cameraMat,t.viewports=[{region:this.region,viewMatrix:this.__viewMat,projectionMatrix:this.__projectionMatrix,viewportFrustumSize:this.__frustumDim,isOrthographic:this.__camera.getIsOrthographic(),fovY:this.__camera.getFov()}]}draw(){const t=this.__renderer.gl;t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(...this.region),this.__backgroundColor&&t.clearColor(...this.__backgroundColor.asArray()),t.colorMask(!0,!0,!0,!0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);const e={};this.__initRenderState(e),this.__renderer.drawScene(e)}}class Ri$1{constructor(t,e){this.__vrviewport=t,this.__treeItem=new ia$1("VRHead"),e.addChild(this.__treeItem),this.__mat4=new I$1,this.__localXfo=new S$1}update(t){this.__mat4.setDataArray(t.transform.matrix),this.__localXfo.fromMat4(this.__mat4),this.__treeItem.setLocalXfo(this.__localXfo)}getTreeItem(){return this.__treeItem}getXfo(){return this.__localXfo}}class xi$1{constructor(t,e,i){if(this.__vrviewport=t,this.__inputSource=e,this.__id=i,this.__isDaydramController=t$1.isMobileDevice,this.touchpadTouched=new C$1,this.buttonPressed=new C$1,this.buttonReleased=new C$1,this.__pressedButtons=[],this.__mat4=new I$1,this.__xfo=new S$1,this.__treeItem=new ia$1("VRController:"+e.handedness+i),!this.__isDaydramController){this.__tip=new ia$1("Tip");const e=new S$1;e.tr.set(0,-.05,-.13),this.__tip.setLocalXfo(e),this.__treeItem.addChild(this.__tip,!1),t.getTreeItem().addChild(this.__treeItem),this.__activeVolumeSize=.04,t.loadHMDResources().then(t=>{t.loaded.connect(()=>{let e;0==i?e=t.getChildByName("LeftController"):1==i&&(e=t.getChildByName("RightController")),e||(e=t.getChildByName("Controller"));const n=e.clone();n.setLocalXfo(new S$1(new Z$1(0,-.035,-.085),new R$1({setFromAxisAndAngle:[new Z$1(0,1,0),Math.PI]}),new Z$1(.001,.001,.001))),this.__treeItem.addChild(n,!1)})})}}getHandedness(){return this.__inputSource.handedness}getId(){return this.__id}getTreeItem(){return this.__treeItem}getTipItem(){return this.__tip}getTipXfo(){return this.__tip.getGlobalXfo()}getTouchPadValue(){return this.__touchpadValue}isButtonPressed(){return this.__buttonPressed}getControllerStageLocalXfo(){return this.__xfo}getControllerTipStageLocalXfo(){return this.__xfo.multiply(this.__tip.getLocalXfo())}updatePose(t,e,i){const n=e.getPose(i.gripSpace,t);n&&n.transform&&(this.__mat4.setDataArray(n.transform.matrix),this.__xfo.fromMat4(this.__mat4),this.__treeItem.setLocalXfo(this.__xfo),this.__geomAtTip=void 0,this.__hitTested=!1)}getGeomItemAtTip(){if(this.__hitTested)return this.__intersectionData;this.__hitTested=!0;const t=this.__vrviewport.getRenderer(),e=this.__tip.getGlobalXfo(),i=this.__activeVolumeSize;return this.__intersectionData=t.raycastWithXfo(e,i,i),this.__intersectionData}}class Si$1 extends Vi$1{constructor(t){super(t),this.getParameter("DoubleClickTimeMS").setValue(300),this.__projectionMatriciesUpdated=!1,this.__far=1024,this.__near=.1,this.__stageTreeItem=new ia$1("VRStage"),this.__stageTreeItem.setSelectable(!1),this.__stageTreeItem.setVisible(!1),this.__renderer.addTreeItem(this.__stageTreeItem),this.__vrhead=new Ri$1(this.__renderer.gl,this.__stageTreeItem),this.__vrControllersMap={},this.__vrControllers=[];const e=new S$1;e.ori.setFromAxisAndAngle(new Z$1(1,0,0),.5*Math.PI),this.setXfo(e),this.__leftViewMatrix=new I$1,this.__leftProjectionMatrix=new I$1,this.__rightViewMatrix=new I$1,this.__rightProjectionMatrix=new I$1,this.resized=new C$1,this.viewChanged=new C$1,this.presentingChanged=new C$1,this.controllerAdded=new C$1,this.controllerButtonDown=new C$1,this.controllerButtonUp=new C$1,this.controllerDoubleClicked=new C$1,this.controllerTouchpadTouched=new C$1}getVRDisplay(){return this.__vrDisplay}getAsset(){return this.__vrAsset}getTreeItem(){return this.__stageTreeItem}getVRHead(){return this.__vrhead}getXfo(){return this.__stageXfo}setXfo(t){this.__stageXfo=t,this.__stageTreeItem.setGlobalXfo(t),this.__stageMatrix=t.inverse().toMat4(),this.__stageScale=t.sc.x}getControllers(){return this.__vrControllers}canPresent(){return this.__canPresent}isPresenting(){return this.__session}__startSession(){const t=(e,i)=>{this.__session&&(this.__session.requestAnimationFrame(t),this.draw(i))};this.__session.requestAnimationFrame(t)}loadHMDResources(){const t=localStorage.getItem("hmd");return this.__hmd!=t&&(this.__hmdAssetPromise=void 0),this.__hmdAssetPromise||(this.__hmd=t,this.__hmdAssetPromise=new Promise((e,i)=>{this.__renderer.sceneSet.connect(n=>{const s=n.getResourceLoader();let o;switch(t){case"Vive":o="ZeaEngine/Vive.vla";break;case"Oculus":default:o="ZeaEngine/Oculus.vla"}const r=s.resolveFilePathToId(o);r&&!t$1.isMobileDevice?(this.__vrAsset=this.__renderer.getScene().loadCommonAssetResource(r),this.__vrAsset.loaded.connect(()=>{const t=this.__vrAsset.getMaterialLibrary(),i=t.getMaterialNames();for(const e of i){const i=t.getMaterial(e,!1);i&&(i.visibleInGeomDataBuffer=!1,i.setShaderName("SimpleSurfaceShader"))}e(this.__vrAsset)})):i()})})),this.__hmdAssetPromise}startPresenting(){return new Promise((t,e)=>{const i=this.__renderer.gl,n=()=>{navigator.xr.requestSession("immersive-vr",{requiredFeatures:["local-floor"],optionalFeatures:["bounded-floor"]}).then(n=>{let s;this.__renderer.__xrViewportPresenting=!0,t$1.isMobileDevice||(s=document.createElement("canvas"),s.style.position="relative",s.style.left="0px",s.style.top="0px",s.style.width="100%",s.style.height="100%",this.__renderer.getDiv().replaceChild(s,this.__renderer.getGLCanvas()),n.addEventListener("end",()=>{this.__renderer.getDiv().replaceChild(this.__renderer.getGLCanvas(),s)})),n.addEventListener("end",()=>{this.__stageTreeItem.setVisible(!1),this.__session=null,this.presentingChanged.emit(!1)}),n.addEventListener("selectstart",t=>{const e=this.__vrControllersMap[t.inputSource.handedness];if(e){const i=Date.now();console.log("controller:",t.inputSource.handedness," down",i-e.__prevDownTime),i-e.__prevDownTime<this.__doubleClickTimeMSParam.getValue()?this.controllerDoubleClicked.emit({button:1,controller:e,vleStopPropagation:!1,vrviewport:this},this):(e.__prevDownTime=i,this.controllerButtonDown.emit({button:1,controller:e,vleStopPropagation:!1,vrviewport:this},this))}}),n.addEventListener("selectend",t=>{const e=this.__vrControllersMap[t.inputSource.handedness];e&&(console.log("controller:",t.inputSource.handedness," up"),this.controllerButtonUp.emit({button:1,controller:e,vleStopPropagation:!1,vrviewport:this},this))}),this.__session=n,n.updateRenderState({baseLayer:new XRWebGLLayer(n,i,{compositionDisabled:"inline"==n.mode}),outputContext:s?s.getContext("xrpresent"):null}),n.requestReferenceSpace(t$1.isMobileDevice?"local":"local-floor").catch(()=>(console.log("Falling back to identity reference space"),n.requestReferenceSpace("viewer").then(t=>t.getOffsetReferenceSpace(new XRRigidTransform({y:-1.6}))))).then(e=>{this.__refSpace=e,this.__stageTreeItem.setVisible(!0),this.presentingChanged.emit(!0),this.__startSession(),t()}).catch(t=>{console.warn(t.message),e("Unable to start XR Session:"+t.message)})}).catch(t=>{console.warn(t.message)})};t$1.isMobileDevice?n():this.loadHMDResources().then(n)})}stopPresenting(){this.__session&&this.__session.end()}togglePresenting(){this.__session?this.stopPresenting():this.startPresenting()}getHMDCanvasSize(){return this.__hmdCanvasSize}__createController(t,e){console.log("creating controller:",e.handedness);const i=new xi$1(this,e,t);return this.__vrControllersMap[e.handedness]=i,this.__vrControllers[t]=i,this.controllerAdded.emit(i),i}updateControllers(t){const e=this.__session.inputSources;for(let i=0;i<e.length;i++){const n=e[i];if(""==n.handedness||"none"==n.handedness)return;this.__vrControllers[i]||this.__createController(i,n),this.__vrControllers[i].updatePose(this.__refSpace,t,n)}}draw(t){const e=t.session.renderState.baseLayer,i=t.getViewerPose(this.__refSpace),n=i.views;if(!this.__projectionMatriciesUpdated){this.__projectionMatrices=[],this.__viewMatrices=[],this.__cameraMatrices=[],this.__region=[0,0,0,0];for(let t=0;t<n.length;t++){const i=n[t],s=new I$1;s.setDataArray(i.projectionMatrix),this.__projectionMatrices[t]=s,this.__viewMatrices[t]=new I$1,this.__cameraMatrices[t]=new I$1;const o=e.getViewport(i);this.__region[2]=Math.max(this.__region[2],o.x+o.width),this.__region[3]=Math.max(this.__region[3],o.y+o.height)}this.__renderer.resizeFbos(this.__region[2],this.__region[3]),this.__projectionMatriciesUpdated=!0}const s=this.__renderer.gl;s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer),this.__backgroundColor&&s.clearColor(...this.__backgroundColor.asArray()),s.colorMask(!0,!0,!0,!0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);const o={boundRendertarget:e.framebuffer,region:this.__region,viewports:[]};for(let r=0;r<n.length;r++){const t=n[r];this.__viewMatrices[r].setDataArray(t.transform.inverse.matrix),this.__viewMatrices[r].multiplyInPlace(this.__stageMatrix);const i=e.getViewport(t);o.viewports.push({viewMatrix:this.__viewMatrices[r],projectionMatrix:this.__projectionMatrices[r],region:[i.x,i.y,i.width,i.height]})}this.__vrhead.update(i),this.updateControllers(t),o.viewXfo=this.__vrhead.getTreeItem().getGlobalXfo(),o.viewScale=1/this.__stageScale,o.cameraMatrix=o.viewXfo.toMat4(),o.region=this.__region,this.__renderer.drawScene(o),this.capturedElement&&this.capturedElement.onMouseMove({viewport:this}),this.viewChanged.emit({interfaceType:"VR",hmd:this.__hmd,viewXfo:o.viewXfo,controllers:this.__vrControllers,vrviewport:this},this)}setCapture(t){this.capturedElement=t}getCapture(){return this.capturedElement}releaseCapture(){this.capturedElement=null,this.renderGeomDataFbo()}}let Wi$1=void 0,Li$1=!1,vi$1=!1;const Fi$1={},Ti$1={OPAQUE:1,TRANSPARENT:2,OVERLAY:4};class Mi$1 extends q$1{constructor(){super(),this.updated=new C$1,this.enabled=!0,this.__passIndex=0;const t=this.addParameter(new Xe$1("Enabled",!0));t.valueChanged.connect(()=>this.enabled=t.getValue())}__parameterValueChanged(t,e){super.__parameterValueChanged(t,e),this.__renderer&&this.__renderer.requestRedraw()}init(t,e){if(null==e)throw new Error("Missing constructor argument.");this.__gl=t.gl,this.__renderer=t,this.__passIndex=e}setPassIndex(t){this.__passIndex=t}startPresenting(){}stopPresenting(){}draw(t){}drawHighlightedGeoms(t){}drawGeomData(t){}getGeomItemAndDist(t){}}class Ci$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("OutlinesShader.vertexShader","\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    v_texCoord = positions.xy+0.5;\n    gl_Position = vec4(positions.xy*2.0, 0.0, 1.0);\n}\n\n"),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("OutlinesShader.fragmentShader","\nprecision highp float;\n\nuniform sampler2D highlightDataTexture;\nuniform vec2 highlightDataTextureSize;\n\nvarying vec2 v_texCoord;\n\n\nbool isFilledPixel(vec4 p) {\n    return p.r > 0.01 || p.g > 0.01 || p.b > 0.01;\n}\nvoid accumOutlinePixel(vec2 fragCoord, inout vec4 res) {\n    vec3 p = texture2D(highlightDataTexture, fragCoord/highlightDataTextureSize).rgb;\n    if(p.r > 0.01 || p.g > 0.01 || p.b > 0.01) {\n        res.r += p.r;\n        res.g += p.g;\n        res.b += p.b;\n        res.a += 1.0;\n    }\n}\nvec4 getOutlinePixelColor(vec2 fragCoord) {\n    vec4 M = texture2D(highlightDataTexture, fragCoord/highlightDataTextureSize);\n    \n    /// To display a fill instead of an outline.\n    // return M;\n\n    if( isFilledPixel(M) ) {\n        // Note: the filled pixel has an alpha value\n        // that determines how much fill is applied\n        // The outline is a solid color. \n        return M;\n    }\n    // Search surrounding pixels for selected geoms.\n    vec4 res;\n    accumOutlinePixel(fragCoord+vec2( 1, 1), res); // NW\n    accumOutlinePixel(fragCoord+vec2(-1, 1), res); // NE\n    accumOutlinePixel(fragCoord+vec2( 1,-1), res); // SW\n    accumOutlinePixel(fragCoord+vec2(-1,-1), res); // SE\n    accumOutlinePixel(fragCoord+vec2( 0, 2), res); // NN\n    accumOutlinePixel(fragCoord+vec2(-2, 0), res); // EE\n    accumOutlinePixel(fragCoord+vec2( 2, 0), res); // WW\n    accumOutlinePixel(fragCoord+vec2( 0,-2), res); // SS\n    accumOutlinePixel(fragCoord+vec2( 1, 2), res); // NNW\n    accumOutlinePixel(fragCoord+vec2(-1, 2), res); // NNE\n    accumOutlinePixel(fragCoord+vec2(-2, 1), res); // EEN\n    accumOutlinePixel(fragCoord+vec2(-2,-1), res); // EES\n    accumOutlinePixel(fragCoord+vec2( 2, 1), res); // WWN\n    accumOutlinePixel(fragCoord+vec2( 2,-1), res); // WWS\n    accumOutlinePixel(fragCoord+vec2( 1,-2), res); // SSW\n    accumOutlinePixel(fragCoord+vec2(-1,-2), res); // SSE\n\n    if(isFilledPixel(res))\n        return vec4(res.rgb / res.a, 1.0);\n    else\n        return vec4(0.0, 0.0, 0.0, 0.0);\n}\n\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n    // fragColor = texture2D(highlightDataTexture, v_texCoord);;\n    //can also use gl_FragCoord.xy\n    mediump vec2 fragCoord = v_texCoord * highlightDataTextureSize; \n    /////////////////\n    // Selection Outlines\n    vec4 outlineColor = getOutlinePixelColor(fragCoord);\n    if(outlineColor.a > 0.0001){\n#ifndef ENABLE_ES3\n        gl_FragColor = outlineColor;\n#else\n        fragColor = outlineColor;\n#endif\n    }\n    else {\n        discard;\n    }\n}\n\n")}}const Ni$1=Ti$1.OPAQUE|Ti$1.TRANSPARENT|Ti$1.OVERLAY;class Yi$1 extends class{constructor(t,e={}){if(t$1.gpuDesc){this.__shaders={},this.__passes={},this.__passCallbacks=[],this.addTreeItem=this.addTreeItem.bind(this),this.removeTreeItem=this.removeTreeItem.bind(this),this.__viewports=[],this.__activeViewport=void 0,this.__continuousDrawing=!1,this.__redrawRequested=!1,this.__isMobile=t$1.isMobileDevice,this.__drawSuspensionLevel=1,this.__shaderDirectives={},this.__preproc={},this.__xrViewportPresenting=!1,this.renderGeomDataFbos=this.renderGeomDataFbos.bind(this),this.requestRedraw=this.requestRedraw.bind(this),this.resized=new C$1,this.keyPressed=new C$1,this.sceneSet=new C$1(!0),this.vrViewportSetup=new C$1(!0),this.sessionClientSetup=new C$1(!0),this.viewChanged=new C$1,this.redrawOccured=new C$1,this.setupWebGL(t,e.webglOptions?e.webglOptions:{}),this.bindEventHandlers();for(const t in Fi$1)for(const e of Fi$1[t])this.addPass(new e,t,!1);this.addViewport("main"),this.__supportXR=void 0===e.supportXR||e.supportXR,this.__xrViewport=void 0,this.__xrViewportPromise=new Promise(t=>{if(this.__supportXR&&navigator.xr){const e=()=>{this.__gl.makeXRCompatible().then(()=>{this.__xrViewport=this.__setupXRViewport(),this.vrViewportSetup.emit(this.__xrViewport),t(this.__xrViewport)})};navigator.xr.supportsSessionMode?navigator.xr.supportsSessionMode("immersive-vr").then(e).catch(t=>{console.warn("Unable to setup XR:"+t)}):navigator.xr.isSessionSupported("immersive-vr").then(t=>{t&&e()}).catch(t=>{console.warn("Unable to setup XR:"+t)})}})}else console.warn("Unable to create renderer")}addShaderPreprocessorDirective(t,e){this.__shaderDirectives[t]=e?"#define "+t+" = "+e:"#define "+t;const i=[];for(const n in this.__shaderDirectives)i.push(this.__shaderDirectives[n]);this.__preproc.defines=i.join("\n")+"\n",this.__gl.shaderopts=this.__preproc}getShaderPreproc(){return this.__preproc}getWidth(){return this.__glcanvas.width}getHeight(){return this.__glcanvas.height}addViewport(t){const e=new Ii$1(this,t,this.getWidth(),this.getHeight());return e.updated.connect(()=>{this.requestRedraw()}),e.createGeomDataFbo(this.__floatGeomBuffer),e.viewChanged.connect(t=>{this.__xrViewportPresenting||this.viewChanged.emit(t)}),this.__viewports.push(e),e}getViewport(t=0){return this.__viewports[t]}getViewportAtPos(t,e){for(const i of this.__viewports){const n=i.getPosX(),s=i.getPosY(),o=i.getWidth(),r=i.getHeight();if(t>=n&&e>=s&&t<=o+n&&e<=r+s)return i}}activateViewport(t){this.__activeViewport!=t&&(this.__activeViewport=t)}activateViewportAtPos(t,e){if(this.__xrViewportPresenting)return;const i=this.getViewportAtPos(t,e);i&&i!=this.__activeViewport&&this.activateViewport(i)}getActiveViewport(){return this.__xrViewportPresenting?this.__xrViewport:this.__activeViewport}suspendDrawing(){this.__drawSuspensionLevel++}resumeDrawing(){this.__drawSuspensionLevel--,0==this.__drawSuspensionLevel&&(this.__loadingImg&&this.__glcanvasDiv.removeChild(this.__loadingImg),this.renderGeomDataFbos(),this.requestRedraw())}renderGeomDataFbos(){1!=this.__renderGeomDataFbosRequested&&(this.__renderGeomDataFbosRequested=!0,window.requestAnimationFrame(()=>{for(const t of this.__viewports)t.renderGeomDataFbo();this.__renderGeomDataFbosRequested=!1}))}setupGrid(t,e,i,n){return console.warn("Deprecated Method. Please use scene.setupGrid"),this.__scene.setupGrid(t,i,e)}getScene(){return this.__scene}setScene(t){this.__scene=t,this.addTreeItem(this.__scene.getRoot()),this.__gizmoContext&&this.__gizmoContext.setSelectionManager(t.getSelectionManager()),this.sceneSet.emit(this.__scene)}addTreeItem(t){if(t instanceof ia$1){for(const e of this.__passCallbacks){const i={continueInSubTree:!0};if(e.itemAddedFn(t,i)){if(!i.continueInSubTree)return;break}}for(const e of t.getChildren())e&&this.addTreeItem(e);t.childAdded.connect(this.addTreeItem),t.childRemoved.connect(this.removeTreeItem),this.renderGeomDataFbos()}}removeTreeItem(t){if(t instanceof ia$1){t.childAdded.disconnect(this.addTreeItem),t.childRemoved.disconnect(this.removeTreeItem);for(const e of this.__passCallbacks){if(!e.itemRemovedFn)continue;const i={continueInSubTree:!0};if(e.itemRemovedFn(t,i)){if(!i.continueInSubTree)return;break}}for(const e of t.getChildren())e&&this.removeTreeItem(e);this.renderGeomDataFbos()}}get gl(){return this.__gl}getGL(){return this.__gl}resizeFbos(t,e){}__onResize(){if(!this.__xrViewportPresenting){const t=1;this.__glcanvas.width=this.__glcanvas.clientWidth*t,this.__glcanvas.height=this.__glcanvas.clientHeight*t;for(const e of this.__viewports)e.resize(this.__glcanvas.width,this.__glcanvas.height);this.resizeFbos(this.__glcanvas.width,this.__glcanvas.height),this.resized.emit(this.__glcanvas.width,this.__glcanvas.height),this.requestRedraw()}}getDiv(){return this.__glcanvasDiv}setupWebGL(t,e){this.__glcanvas=document.createElement("canvas"),this.__glcanvas.style.position=e.canvasPosition?e.canvasPosition:"absolute",this.__glcanvas.style.left="0px",this.__glcanvas.style.top="0px",this.__glcanvas.style.width="100%",this.__glcanvas.style.height="100%",this.__glcanvasDiv=t,this.__glcanvasDiv.appendChild(this.__glcanvas),e$1(this.__glcanvas,()=>{this.__onResize()}),this.__onResize(),e.preserveDrawingBuffer=!0,e.stencil=!!e.stencil&&e.stencil,e.alpha=!!e.alpha&&e.alpha,e.xrCompatible=!0,this.__gl=Ca$1(this.__glcanvas,e),this.__gl||alert("Unable to create WebGL context. WebGL not supported."),this.__gl.renderer=this,"webgl2"==this.__gl.name&&this.addShaderPreprocessorDirective("ENABLE_ES3"),this.__gl.floatTexturesSupported&&this.addShaderPreprocessorDirective("ENABLE_FLOAT_TEXTURES"),this.__gl.screenQuad=new fi$1(this.__gl),this.__screenQuad=this.__gl.screenQuad,this.__floatGeomBuffer=this.__gl.floatTexturesSupported&&"Safari"!=t$1.browserName,this.__gl.floatGeomBuffer=this.__floatGeomBuffer}bindEventHandlers(){const t=()=>this.__glcanvas.width>0&&this.__glcanvas.height,e=t=>{const e=this.__glcanvas.getBoundingClientRect();t.rendererX=1*(t.clientX-e.left),t.rendererY=1*(t.clientY-e.top)};this.__glcanvas.addEventListener("mouseenter",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager,Li$1||(Wi$1=this,e(t),Wi$1.activateViewportAtPos(t.rendererX,t.rendererY),vi$1=!1)}),this.__glcanvas.addEventListener("mouseleave",e=>{if(Wi$1==this&&t())if(e.stopPropagation(),e.undoRedoManager=this.undoRedoManager,Li$1)vi$1=!0;else{const t=Wi$1.getActiveViewport();t&&(t.onMouseLeave(e),e.preventDefault()),Wi$1=void 0}}),this.__glcanvas.addEventListener("mousedown",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager,e(t),Li$1=!0,Wi$1=this,Wi$1.activateViewportAtPos(t.rendererX,t.rendererY);const i=Wi$1.getActiveViewport();return i&&i.onMouseDown(t),vi$1=!1,!1}),document.addEventListener("mouseup",i=>{if(Wi$1!=this||!t())return;i.stopPropagation(),i.undoRedoManager=this.undoRedoManager,e(i),Li$1=!1;const n=Wi$1.getActiveViewport();if(n&&n.onMouseUp(i),vi$1){const t=Wi$1.getActiveViewport();t&&(t.onMouseLeave(i),i.preventDefault()),Wi$1=void 0}return!1}),document.addEventListener("mousemove",i=>{if(Wi$1!=this||!t())return;i.preventDefault(),i.stopPropagation(),i.undoRedoManager=this.undoRedoManager,e(i),Li$1||Wi$1.activateViewportAtPos(i.rendererX,i.rendererY);const n=Wi$1.getActiveViewport();return n&&n.onMouseMove(i),!1});const i=e=>{if(Wi$1==this&&t())return Wi$1&&(e.stopPropagation(),e.undoRedoManager=this.undoRedoManager,window.addEventListener||e.preventDefault(),this.onWheel(e)),!1};window.addEventListener?window.addEventListener("wheel",i,{passive:!0}):window.onmousewheel=document.onmousewheel=i,window.oncontextmenu=function(){return!1},document.addEventListener("keypress",e=>{if(Wi$1!=this||!t())return;const i=String.fromCharCode(e.keyCode).toLowerCase(),n=Wi$1.getActiveViewport();n&&n.onKeyPressed(i,e)}),document.addEventListener("keydown",e=>{if(Wi$1!=this||!t())return;const i=String.fromCharCode(e.keyCode).toLowerCase(),n=Wi$1.getActiveViewport();n&&n.onKeyDown(i,e)}),document.addEventListener("keyup",e=>{if(Wi$1!=this||!t())return;const i=String.fromCharCode(e.keyCode).toLowerCase(),n=Wi$1.getActiveViewport();n&&n.onKeyUp(i,e)}),this.__glcanvas.addEventListener("touchstart",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager;for(let i=0;i<t.touches.length;i++)e(t.touches[i]);this.getViewport().onTouchStart(t)},!1),this.__glcanvas.addEventListener("touchmove",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager;for(let i=0;i<t.touches.length;i++)e(t.touches[i]);this.getViewport().onTouchMove(t)},!1),this.__glcanvas.addEventListener("touchend",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager;for(let i=0;i<t.touches.length;i++)e(t.touches[i]);this.getViewport().onTouchEnd(t)},!1),this.__glcanvas.addEventListener("touchcancel",t=>{t.stopPropagation(),t.undoRedoManager=this.undoRedoManager,this.getViewport().onTouchCancel(t)},!1)}setUndoRedoManager(t){this.undoRedoManager=t}getGLCanvas(){return this.__glcanvas}getScreenQuad(){return this.__screenQuad}onWheel(t){this.__viewports[0].onWheel(t)}frameAll(t=0){this.__viewports[t].frameView([this.__scene.getRoot()])}getOrCreateShader(t){let e=this.__shaders[t];return e||(e=J$1.constructClass(t,this.__gl),e||console.error("Shader not registered with the SGFactory:",t),this.__shaders[t]=e),e}addPass(t,e=0,i=!0){this.__passes[e]||(this.__passes[e]=[]);let n=0;for(const s in this.__passes){if(s==e)break;n+=this.__passes[s].length}if(n+=this.__passes[e].length,t.updated.connect(this.requestRedraw.bind(this)),t.init(this,n),this.__passes[e].push(t),i){let t=0;for(const e in this.__passes){const i=this.__passes[e];i.forEach((e,i)=>{e.setPassIndex(t+i)}),t+=i.length}}return this.requestRedraw(),n}registerPass(t,e){this.__passCallbacks.splice(0,0,{itemAddedFn:t,itemRemovedFn:e})}getPass(t){let e=0;for(const i in this.__passes){const n=this.__passes[i];if(t-e<n.length)return n[t-e];e+=n.length}}findPass(t){for(const e in this.__passes){const i=this.__passes[e];for(const e of i)if(e.constructor==t)return e}}getGizmoPass(){return this.__gizmoPass}supportsVR(){return console.warn("Deprecated Method. Please instead connect to the vrViewportSetup signal."),this.__supportXR&&null!=navigator.xr}__setupXRViewport(){const t=new Si$1(this);return t.presentingChanged.connect(e=>{if(this.__xrViewportPresenting=e,e){for(const t in this.__passes){const e=this.__passes[t];for(const t of e)t.startPresenting()}t.viewChanged.connect(this.viewChanged.emit)}else{t.viewChanged.disconnect(this.viewChanged.emit);for(const t in this.__passes){const e=this.__passes[t];for(const t of e)t.stopPresenting()}this.viewChanged.emit({interfaceType:"CameraAndPointer",viewXfo:this.getViewport().getCamera().getGlobalXfo()}),this.resizeFbos(this.__glcanvas.width,this.__glcanvas.height),this.requestRedraw()}}),t}getVRViewport(){return this.__xrViewport}getXRViewport(){return this.__xrViewportPromise}isXRViewportPresenting(){return this.__xrViewportPresenting}isContinuouslyDrawing(){return this.__continuousDrawing}startContinuousDrawing(){if(this.isContinuouslyDrawing()||this.__xrViewportPresenting)return;const t=()=>{this.__continuousDrawing&&!this.__xrViewportPresenting&&window.requestAnimationFrame(t);for(const t of this.__viewports)t.draw()};this.__continuousDrawing=!0,window.requestAnimationFrame(t)}stopContinuousDrawing(){this.__continuousDrawing=!1}toggleContinuousDrawing(){this.__continuousDrawing?this.stopContinuousDrawing():this.startContinuousDrawing()}drawItemChanged(){for(const t of this.__viewports)t.invalidateGeomDataBuffer();this.requestRedraw()}requestRedraw(){return!(this.__redrawRequested||this.__continuousDrawing||this.__xrViewportPresenting||(window.requestAnimationFrame(()=>{this.__redrawRequested=!1;for(const t of this.__viewports)t.draw()}),this.__redrawRequested=!0,0))}bindGLBaseRenderer(t){t.shaderopts=this.__preproc;const e=this.__gl;t.viewports&&1!=t.viewports.length?(t.bindRendererUnifs=i=>{const{cameraMatrix:n}=i;n&&e.uniformMatrix4fv(n.location,!1,t.cameraMatrix.asArray())},t.bindViewports=(i,n)=>{t.viewports.forEach((t,s)=>{e.viewport(...t.region);const{viewMatrix:o,projectionMatrix:r,eye:a}=i;o&&e.uniformMatrix4fv(o.location,!1,t.viewMatrix.asArray()),r&&e.uniformMatrix4fv(r.location,!1,t.projectionMatrix.asArray()),a&&e.uniform1i(a.location,s),n()})}):(t.bindRendererUnifs=i=>{const{cameraMatrix:n,viewMatrix:s,projectionMatrix:o,eye:r}=i;n&&e.uniformMatrix4fv(n.location,!1,t.cameraMatrix.asArray());const a=t.viewports[0];s&&e.uniformMatrix4fv(s.location,!1,a.viewMatrix.asArray()),o&&e.uniformMatrix4fv(o.location,!1,a.projectionMatrix.asArray()),r&&e.uniform1i(r.location,index)},t.bindViewports=(t,e)=>e())}drawScene(t){for(const e in this.__passes){const i=this.__passes[e];for(const e of i)e.enabled&&e.draw(t)}}drawHighlightedGeoms(t){this.bindGLBaseRenderer(t);for(const e in this.__passes){const i=this.__passes[e];for(const e of i)e.enabled&&e.drawHighlightedGeoms(t)}}drawSceneGeomData(t,e=255){this.bindGLBaseRenderer(t);for(const i in this.__passes){if(0==(Number.parseInt(i)&e))continue;const n=this.__passes[i];for(const e of n)e.enabled&&e.drawGeomData(t)}}static registerPass(t,e){Fi$1[e]||(Fi$1[e]=[]),Fi$1[e].push(t)}}{constructor(t,e={}){super(t,e,{antialias:!0,depth:!0}),this.__exposure=1,this.__tonemap=!0,this.__gamma=2.2,this.__glEnvMap=void 0,this.__glBackgroundMap=void 0,this.envMapAssigned=new C$1(!0),this.__glLightmaps={},this.__displayEnvironment=!0,this.__debugMode=0,this.__debugLightmaps=!1,this._planeDist=0,this.__cutPlaneNormal=new Z$1(1,0,0);const i=this.__gl;this.__debugTextures=[void 0],this.addShaderPreprocessorDirective("ENABLE_INLINE_GAMMACORRECTION"),e.disableLightmaps||this.addShaderPreprocessorDirective("ENABLE_LIGHTMAPS"),e.disableTextures||this.addShaderPreprocessorDirective("ENABLE_TEXTURES"),t$1.isMobileDevice||e.disableSpecular||this.addShaderPreprocessorDirective("ENABLE_SPECULAR"),this.__outlineShader=new Ci$1(i),this.quad=new Ua$1(i,new jt$1(1,1)),this.createSelectedGeomsFbo(),this.createRayCastRenderTarget()}__bindEnvMap(t){if(t instanceof Vt$1)this.__glEnvMap=t.getMetadata("gltexture"),this.__glEnvMap||("FLOAT"===t.type?(this.addShaderPreprocessorDirective("ENABLE_SPECULAR"),this.__glEnvMap=new Xi$1(this,t,this.__preproc)):this.__glEnvMap=t.isStreamAtlas()?new GLImageStream(this.__gl,t):new Na$1(this.__gl,t)),this.__glEnvMap.loaded.connect(this.requestRedraw),this.__glEnvMap.updated.connect(this.requestRedraw),this.envMapAssigned.emit(this.__glEnvMap);else{const e=t;if(this.__glBackgroundMap=e.getMetadata("gltexture"),this.__glBackgroundMap||(this.__glBackgroundMap="FLOAT"===e.type?new Qa$1(gl,e):new Na$1(gl,e)),this.__glBackgroundMap.loaded.connect(this.requestRedraw),this.__glBackgroundMap.updated.connect(this.requestRedraw),!this.__backgroundMapShader){switch(gl.__quadVertexIdsBuffer||gl.setupInstancedQuad(),e.getMapping()){case"octahedral":this.__backgroundMapShader=new pi$1(gl);break;case"latlong":this.__backgroundMapShader=new gi$1(gl);break;case"steriolatlong":this.__backgroundMapShader=new _i$1(gl);break;case"dualfisheye":this.__backgroundMapShader=new Gi$1(gl);break;case"uv":default:this.__backgroundMapShader=new bi$1(gl)}const t=this.__backgroundMapShader.compileForTarget();this.__backgroundMapShaderBinding=wa$1(gl,t.attrs,gl.__quadattrbuffers,gl.__quadIndexBuffer)}}}getGLEnvMap(){return this.__glEnvMap}getEnvMapTex(){return console.warn("Deprecated Function"),this.__glEnvMap}setScene(t){const e=t.settings.getParameter("EnvMap");null!=e.getValue()&&this.__bindEnvMap(e.getValue()),e.valueChanged.connect(()=>{this.__bindEnvMap(e.getValue())});const i=t.settings.getParameter("Display EnvMap");this.__displayEnvironment=i.getValue(),i.valueChanged.connect(()=>{this.__displayEnvironment=i.getValue(),this.requestRedraw()}),super.setScene(t)}addTreeItem(t){if(super.addTreeItem(t),t instanceof _a$1){const e=(t,e)=>{let i=e.image.getMetadata("gltexture");i||(i=new Qa$1(this.__gl,e.image)),i.updated.connect(()=>{this.requestRedraw()}),this.__glLightmaps[t]={atlasSize:e.atlasSize,glimage:i}},i=t;i.loaded.connect(()=>{this.__glEnvMap&&i.getLightmap()&&e(i.getName(),i.getLightmap())})}}removeTreeItem(t){super.removeTreeItem(t)}addViewport(t){return super.addViewport(t)}onKeyPressed(t,e){switch(t){case"b":this.__displayEnvironment=!this.__displayEnvironment,this.requestRedraw();break;default:super.onKeyPressed(t,e)}}get exposure(){return this.__exposure}set exposure(t){this.__exposure=t,this.requestRedraw()}get gamma(){return this.__gamma}set gamma(t){this.__gamma=t,this.requestRedraw()}get displayEnvironment(){return this.__displayEnvironment}set displayEnvironment(t){this.__displayEnvironment=t,this.requestRedraw()}get planeDist(){return this._planeDist}set planeDist(t){this._planeDist=t,this.requestRedraw()}get cutPlaneNormal(){return this.__cutPlaneNormal}set cutPlaneNormal(t){this.__cutPlaneNormal=t,this.requestRedraw()}resizeFbos(t,e){super.resizeFbos(),this.__fbo&&this.__fbo.colorTexture.resize(t,e),this.__highlightedGeomsBufferFbo&&this.__highlightedGeomsBuffer.resize(t,e)}createSelectedGeomsFbo(){const t=this.__gl;this.__highlightedGeomsBuffer=new Na$1(t,{type:"UNSIGNED_BYTE",format:"RGBA",filter:"NEAREST",width:this.__glcanvas.width<=1?1:this.__glcanvas.width,height:this.__glcanvas.height<=1?1:this.__glcanvas.height}),this.__highlightedGeomsBufferFbo=new Oa$1(t,this.__highlightedGeomsBuffer,!0),this.__highlightedGeomsBufferFbo.setClearColor([0,0,0,0])}getFbo(){return this.__fbo}createOffscreenFbo(t="RGB"){const e=this.__gl;this.__fwBuffer=new Na$1(e,{type:"FLOAT",format:t,filter:"NEAREST",width:this.__glcanvas.width,height:this.__glcanvas.height}),this.__fbo=new Oa$1(e,this.__fwBuffer,!0),this.__fbo.setClearColor(this.__backgroundColor.asArray())}createRayCastRenderTarget(){this.__rayCastRenderTarget=new si$1(this.__gl,{type:"FLOAT",format:"RGBA",filter:"NEAREST",width:3,height:3,numColorChannels:1}),this.__rayCastRenderTargetProjMatrix=new I$1,this.rayCastDist=0,this.rayCastArea=0}raycastWithRay(t,e,i=.01,n=Ni$1){const s=new S$1;return s.setLookAt(t.start,t.start.add(t.dir)),this.raycast(s,t,e,i,n)}raycastWithXfo(t,e,i=.01,n=Ni$1){const s=new x$1(t.tr,t.ori.getZaxis().negate());return this.raycast(t,s,e,i,n)}raycast(t,e,i,n=.01,s=Ni$1){this.rayCastDist==i&&this.rayCastArea==n||(this.__rayCastRenderTargetProjMatrix.setOrthographicMatrix(-.5*n,.5*n,-.5*n,.5*n,0,i),this.rayCastDist=i,this.rayCastArea=n);const o=this.__gl,r={cameraMatrix:t.toMat4(),viewports:[{region:[0,0,3,3],viewMatrix:t.inverse().toMat4(),projectionMatrix:this.__rayCastRenderTargetProjMatrix,isOrthographic:!0}]};this.__rayCastRenderTarget.bindForWriting(r,!0),o.enable(o.CULL_FACE),o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.depthMask(!0),this.drawSceneGeomData(r,s),o.finish(),this.__rayCastRenderTarget.unbindForWriting(),this.__rayCastRenderTarget.bindForReading();const a=new Float32Array(36);o.readPixels(0,0,3,3,o.RGBA,o.FLOAT,a),this.__rayCastRenderTarget.unbindForReading();const l=[4,3,5,1,7];let c;for(const u of l)if(0!=a[4*u+3]){c=a.subarray(4*u,4*u+4);break}if(!c)return;const h=63&Math.round(c[0]),d=this.getPass(h).getGeomItemAndDist(c);if(d){const t=e.start.add(e.dir.scale(d.dist));return{ray:e,intersectionPos:t,geomItem:d.geomItem,dist:d.dist,geomData:c}}}drawBackground(t){if(this.__glBackgroundMap){if(!this.__glBackgroundMap.isLoaded())return;const e=this.__gl;e.depthMask(!1),this.__backgroundMapShader.bind(t),this.__glBackgroundMap.bindToUniform(t,t.unifs.backgroundImage),this.__backgroundMapShaderBinding.bind(t),e.drawQuad()}else this.__glEnvMap&&this.__glEnvMap.draw&&this.__glEnvMap.draw(t)}bindGLRenderer(t){super.bindGLBaseRenderer(t),t.envMap=this.__glEnvMap,t.exposure=this.__exposure,t.gamma=this.__gamma,t.lightmaps=this.__glLightmaps,t.boundLightmap=void 0;const e=this.__gl,i=t.bindRendererUnifs;t.bindRendererUnifs=n=>{if(i(n),this.__glEnvMap){const e=n.envMapPyramid;if(e&&this.__glEnvMap.bindProbeToUniform)this.__glEnvMap.bindProbeToUniform(t,e);else{const{envMapTex:e,envMapTexType:i}=n;e&&this.__glEnvMap.bindToUniform(t,e,{textureTypeUnif:i})}}{const t=n.exposure;t&&e.uniform1f(t.location,this.__exposure)}{const t=n.gamma;t&&e.uniform1f(t.location,this.__gamma)}}}drawScene(t){if(this.bindGLRenderer(t),this.__displayEnvironment&&this.drawBackground(t),super.drawScene(t),this.__highlightedGeomsBufferFbo){const e=this.__gl;this.__highlightedGeomsBufferFbo.bindForWriting(t),this.__highlightedGeomsBufferFbo.clear(),e.disable(e.BLEND),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0),this.drawHighlightedGeoms(t),this.__highlightedGeomsBufferFbo.unbindForWriting(t),e.viewport(...t.region),this.__outlineShader.bind(t),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);const i=t.unifs;this.__highlightedGeomsBuffer.bindToUniform(t,i.highlightDataTexture),e.uniform2f(i.highlightDataTextureSize.location,t.region[2],t.region[3]),this.quad.bindAndDraw(t),e.disable(e.BLEND)}this.redrawOccured.emit()}}Ha$1.setShaderModule("drawItemId.glsl","\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\nattribute float instancedIds;    // instanced attribute..\nuniform int instancedDraw;\nuniform int transformIndex;\n\nint getDrawItemId() {\n    if(instancedDraw == 0){\n       return transformIndex;\n    }\n    else{\n       return int(instancedIds);\n    }\n}\n\n\n#else\n\nuniform int transformIndex;\n\nint getDrawItemId() {\n    return transformIndex;\n}\n\n#endif\n\n"),Ha$1.setShaderModule("drawItemTexture.glsl",'\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\nuniform sampler2D instancesTexture;\nuniform highp int instancesTextureSize;\n\n<%include file="GLSLUtils.glsl"/>\n\nconst int pixelsPerItem = 6;\n\nvec4 getInstanceData(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 0);\n}\n\n#else\n\nuniform vec4 drawItemData;\n\nvec4 getInstanceData(int id) {\n    return drawItemData;\n}\n\n#endif\n\n\n'),Ha$1.setShaderModule("modelMatrix.glsl","\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\nmat4 getMatrix(sampler2D texture, int textureSize, int index) {\n    // Unpack 3 x 4 matix columns into a 4 x 4 matrix.\n    vec4 col0 = fetchTexel(texture, textureSize, (index * pixelsPerItem) + 1);\n    vec4 col1 = fetchTexel(texture, textureSize, (index * pixelsPerItem) + 2);\n    vec4 col2 = fetchTexel(texture, textureSize, (index * pixelsPerItem) + 3);\n    mat4 result = mat4(col0, col1, col2, vec4(0.0, 0.0, 0.0, 1.0));\n    return transpose(result);\n    // return mat4(1.0);\n}\n\nmat4 getModelMatrix(int id) {\n    return getMatrix(instancesTexture, instancesTextureSize, id);\n}\n\n#else\n\nuniform mat4 modelMatrix;\n\nmat4 getModelMatrix(int id) {\n    return modelMatrix;\n}\n\n#endif\n\n\n"),Ha$1.setShaderModule("materialparams.glsl","\n\n////////////////////////\n// Material Param Helpers.\n\nvec4 getColorParamValue(vec4 value, sampler2D tex, int texType, vec2 texCoord) {\n    if(texType == 0){\n        return toLinear(value);\n    }\n    else if(texType == 1 || texType == 2){\n        // TODO: Use SRGB textures.\n        return toLinear(texture2D(tex, texCoord));\n    }\n    else if(texType == 3){\n        // Float HDR Texture\n        return texture2D(tex, texCoord);\n    }\n    else\n        return value;\n}\n\n\n\nfloat luminanceFromRGB(vec3 rgb) {\n    return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\nfloat getLuminanceParamValue(float value, sampler2D tex, int texType, vec2 texCoord) {\n    if(texType == 0)\n        return value;\n    else\n        return luminanceFromRGB(texture2D(tex, texCoord).rgb);\n}\n"),Ha$1.setShaderModule("debugColors.glsl","\n\nfloat modI(float a, float b) {\n    float m=a-floor((a+0.5)/b)*b;\n    return floor(m+0.5);\n}\n\nvec3 getDebugColor(float id) {\n#ifdef GLSL_ES3\n    const vec3 clusterColors[4] = vec3[4]( vec3(0.0, 0.25, 0.25), vec3(0.0, 0.85, 0.25), vec3(0.0, 0.25, 0.85), vec3(0.0, 0.85, 0.85) );\n#else\n    vec3 clusterColors[8];\n    clusterColors[0] = vec3(0.0, 0.15, 0.15);\n    clusterColors[1] = vec3(0.0, 0.85, 0.15);\n    clusterColors[2] = vec3(0.0, 0.15, 0.85);\n    clusterColors[3] = vec3(0.0, 0.85, 0.85);\n    clusterColors[4] = vec3(0.75, 0.15, 0.15);\n    clusterColors[5] = vec3(0.75, 0.85, 0.15);\n    clusterColors[6] = vec3(0.75, 0.15, 0.85);\n    clusterColors[7] = vec3(0.75, 0.85, 0.85);\n#endif\n\n    if(modI(id, 8.0) == 0.0)\n        return clusterColors[0];\n    else if(modI(id, 8.0) == 1.0)\n        return clusterColors[1];\n    else if(modI(id, 8.0) == 2.0)\n        return clusterColors[2];\n    else if(modI(id, 8.0) == 3.0)\n        return clusterColors[3];\n    else if(modI(id, 8.0) == 4.0)\n        return clusterColors[4];\n    else if(modI(id, 8.0) == 5.0)\n        return clusterColors[5];\n    else if(modI(id, 8.0) == 6.0)\n        return clusterColors[6];\n    else if(modI(id, 8.0) == 7.0)\n        return clusterColors[7];\n\n    return vec3(1,0,0);\n}\n\n\n");class Ki$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("BillboardShader.vertexShader",'\nprecision highp float;\n\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 cameraMatrix;\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\ninstancedattribute float instanceIds;\n\n<%include file="GLSLUtils.glsl"/>\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="utils/imageAtlas.glsl"/>\n\nuniform sampler2D atlasBillboards_layout;\nuniform vec4 atlasBillboards_desc;\n\nuniform sampler2D instancesTexture;\nuniform int instancesTextureSize;\n\n\nconst int cols_per_instance = 5;\n\nmat4 getMatrix(sampler2D texture, int textureSize, int index) {\n  // Unpack 3 x 4 matix columns into a 4 x 4 matrix.\n  vec4 col0 = fetchTexel(texture, textureSize, (index * cols_per_instance) + 0);\n  vec4 col1 = fetchTexel(texture, textureSize, (index * cols_per_instance) + 1);\n  vec4 col2 = fetchTexel(texture, textureSize, (index * cols_per_instance) + 2);\n  mat4 result = mat4(col0, col1, col2, vec4(0.0, 0.0, 0.0, 1.0));\n  return transpose(result);\n  // return mat4(1.0);\n}\n\nmat4 getModelMatrix(int id) {\n  return getMatrix(instancesTexture, instancesTextureSize, id);\n}\nvec4 getInstanceData(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * cols_per_instance) + 3);\n}\nvec4 getTintColor(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * cols_per_instance) + 4);\n}\n\n\n#else\n\nuniform vec4 atlasBillboards_desc;\n\nuniform mat4 modelMatrix;\nuniform vec4 billboardData;\nuniform vec4 tintColor;\nuniform vec4 layoutData;\n\n\n#endif\n\nmat4 calcLookAtMatrix(vec3 origin, vec3 target, float roll) {\n  // vec3 rr = vec3(sin(roll), 0.0, cos(roll));\n  vec3 rr = vec3(0.0, 0.0, 1.0);\n  vec3 ww = normalize(target - origin);\n  vec3 uu = normalize(cross(rr, ww));\n  vec3 vv = normalize(cross(ww, uu));\n\n  return mat4(vec4(uu, 0.0), vec4(vv, 0.0), vec4(ww, 0.0), vec4(origin, 1.0));\n}\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying float v_alpha;\nvarying vec4 v_tint;\n\nvoid main(void) {\n\n#ifdef ENABLE_FLOAT_TEXTURES\n\n  int instanceID = int(instanceIds);\n\n  mat4 modelMatrix = getModelMatrix(instanceID);\n  vec4 billboardData = getInstanceData(instanceID);\n  vec4 layoutData = fetchTexel(atlasBillboards_layout, int(atlasBillboards_desc.z), int(billboardData.z));\n  v_tint = getTintColor(instanceID);\n\n#else\n\n  v_tint = tintColor;\n\n#endif\n\n  vec2 quadVertex = getQuadVertexPositionFromID();\n\n\n  v_texCoord = vec2(quadVertex.x, -quadVertex.y) + 0.5;\n  v_alpha = billboardData.w;\n  v_texCoord *= layoutData.zw;\n  v_texCoord += layoutData.xy;\n\n  float scl = billboardData.x;\n  float width = layoutData.z * atlasBillboards_desc.x * scl;\n  float height = layoutData.w * atlasBillboards_desc.y * scl;\n  int flags = int(billboardData.y);\n  bool alignedToCamera = flags > 0;\n  if(alignedToCamera){\n    vec3 cameraPos = vec3(cameraMatrix[3][0], cameraMatrix[3][1], cameraMatrix[3][2]);\n    vec3 billboardPos = vec3(modelMatrix[3][0], modelMatrix[3][1], modelMatrix[3][2]);\n    mat4 lookAt = calcLookAtMatrix(billboardPos, cameraPos, 0.0);\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * lookAt;\n    gl_Position = modelViewProjectionMatrix * vec4(quadVertex.x * width, (quadVertex.y + 0.5) * height, 0.0, 1.0);\n  }\n  else{\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position = modelViewProjectionMatrix * vec4(quadVertex.x * width, (quadVertex.y + 0.5) * height, 0.0, 1.0);\n  }\n\n  bool overlay = flags > 0;\n  if(overlay){\n    gl_Position.z -= 0.05;\n  }\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("BillboardShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="materialparams.glsl"/>\n<%include file="utils/imageAtlas.glsl"/>\n\nuniform sampler2D atlasBillboards;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying float v_alpha;\nvarying vec4 v_tint;\n\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  fragColor = texture2D(atlasBillboards, v_texCoord) * v_tint;\n  fragColor.a *= v_alpha;\n\n  // fragColor.r = 1.0;\n  // fragColor.a = 1.0;\n  \n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}}class wi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("DepthMapShader.vertexShader","\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\nuniform mat4 modelMatrix;\nuniform mat4 lightViewMatrix;\nuniform mat4 lightProjectionMatrix;\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n\nvoid main(void) {\n  mat4 modelViewMatrix = lightViewMatrix * modelMatrix;\n  v_viewPos = modelViewMatrix * vec4(positions, 1.0);\n  gl_Position = lightProjectionMatrix * v_viewPos;\n}\n\n"),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("DepthMapShader.fragmentShader","\n#extension GL_OES_standard_derivatives : enable\nprecision highp float;\n\nuniform float near;\nuniform float far;\n\nvarying vec3 v_viewPos;\n\nfloat linstep(float edge0, float edge1, float value){\n  return clamp((value-edge0)/(edge1-edge0), 0.0, 1.0);\n}\n\nvoid main(void) {\n  float depth = linstep(near, far, -v_viewPos.z);\n  //gl_FragColor = vec4(depth, depth, depth,  1.0);\n\n  float dx = dFdx(depth);\n  float dy = dFdy(depth);\n  gl_FragColor = vec4(depth, pow(depth, 2.0) + 0.25*(dx*dx + dy*dy), 0.0, 1.0);\n}\n")}}class zi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("EnvProjectionShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform vec3 projectionCenter;\n\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\n \nvoid main()\n{\n  int drawItemId = getDrawItemId();\n  vec4 pos = vec4(positions, 1.);\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n\n  gl_Position = modelViewProjectionMatrix * pos;\n\n  vec4 worldPos = modelMatrix * pos;\n  v_worldDir = worldPos.xyz - projectionCenter;\n}\n\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"projectionCenter",defaultValue:new Z$1(0,0,1.7)}),t}}class Ui$1 extends zi$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("OctahedralEnvProjectionShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\n\nuniform color envMap;\nuniform sampler2D envMapTex;\nuniform int envMapTexType;\n\n\nuniform float exposure;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 texCoord = dirToSphOctUv(normalize(v_worldDir));\n  vec4 env = getColorParamValue(envMap, envMapTex, envMapTexType, texCoord);\n\n  fragColor = vec4(env.rgb/env.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}J$1.registerClass("OctahedralEnvProjectionShader",Ui$1);class Ji$1 extends zi$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("LatLongEnvProjectionShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-equirect.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color envMap;\nuniform sampler2D envMapTex;\nuniform int envMapTexType;\n\nuniform float exposure;\n\n/* VS Outputs */\nvarying vec3 v_worldDir;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  vec2 texCoord = latLongUVsFromDir(normalize(v_worldDir));\n  vec4 env = getColorParamValue(envMap, envMapTex, envMapTexType, texCoord);\n  fragColor = vec4(env.rgb/env.a, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n  fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}}J$1.registerClass("LatLongEnvProjectionShader",Ji$1);class Pi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("FatLinesShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec2 segmentIndices;\nattribute float vertexIDs;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nuniform sampler2D positionsTexture;\nuniform int positionsTextureSize;\n\nuniform float LineThickness;\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\nvarying vec2 v_texCoord;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  int vertexID = int(vertexIDs);\n\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n\n  int seqentialIndex_0 = int(mod(segmentIndices.x, 2.));\n  int seqentialIndex_1 = int(mod(segmentIndices.y, 2.));\n  int index_0 = int(segmentIndices.x) / 2;\n  int index_1 = int(segmentIndices.y) / 2;\n\n  vec3 viewPos;\n  vec4 data_0 = fetchTexel(positionsTexture, positionsTextureSize, index_0);\n  vec4 data_1 = fetchTexel(positionsTexture, positionsTextureSize, index_1);\n\n  vec4 pos_0 = modelViewMatrix * vec4(data_0.xyz, 1.0);\n  vec4 pos_1 = modelViewMatrix * vec4(data_1.xyz, 1.0);\n  // Note: multiply the per-vertex line thickness with the line thickness uniform value;\n  float lineThickness_0 = LineThickness * data_0.w;\n  float lineThickness_1 = LineThickness * data_1.w;\n\n  if(vertexID < 2){\n    viewPos = pos_0.xyz;\n  }\n  else{\n    viewPos = pos_1.xyz;\n  }\n  if(pos_1 != pos_0){\n    vec3 segmentDir = normalize(pos_1.xyz - pos_0.xyz);\n    vec3 viewVector = normalize(viewPos);\n\n    if(vertexID < 2){\n      vec3 segmentStartDir = segmentDir;\n      if(seqentialIndex_0 != 0){\n        //if index_0 == 0, get the last index in the line as previous\n        int index_prev = (index_0 > 0) ? (index_0-1) : (positionsTextureSize-1);\n        vec4 data_prev = fetchTexel(positionsTexture, positionsTextureSize, index_prev);\n        vec4 pos_prev = modelViewMatrix * vec4(data_prev.xyz, 1.0);\n        segmentStartDir = normalize(segmentDir + normalize(pos_0.xyz - pos_prev.xyz));\n      }\n      vec3 startBiTangent = normalize(cross(segmentStartDir, viewVector));\n      v_viewNormal = normalize(cross(segmentStartDir, startBiTangent));\n      // Move the endpoints to overlap a bit more.\n      //viewPos -= vec3(segmentStartDir * lineThickness_0 * 0.25);\n      if(mod(vertexIDs, 2.0) == 0.0){\n        viewPos += vec3(startBiTangent * lineThickness_0);\n        v_texCoord.x = 1.0;\n      }\n      else{\n        viewPos -= vec3(startBiTangent * lineThickness_0);\n        v_texCoord.x = 0.0;\n      }\n      v_texCoord.y = 0.0;\n    }\n    else{\n      vec3 segmentEndDir = segmentDir;\n      if(seqentialIndex_1 != 0){\n        //if index_1 == numPoints-1, get the first index in the line as next\n        int index_next = (index_1 < (positionsTextureSize-1)) ? (index_1+1) : 0;\n        vec4 data_next = fetchTexel(positionsTexture, positionsTextureSize, index_next);\n        vec4 pos_next = modelViewMatrix * vec4(data_next.xyz, 1.0);\n        segmentEndDir = normalize(segmentDir + normalize(pos_next.xyz - pos_1.xyz));\n      }\n      vec3 endBiTangent = normalize(cross(segmentEndDir, viewVector));\n      v_viewNormal = normalize(cross(segmentEndDir, endBiTangent));\n      // Move the endpoints to overlap a bit more.\n      //viewPos += vec3(segmentEndDir * lineThickness_1 * 0.25);\n      if(mod(vertexIDs, 2.0) == 0.0){\n        viewPos += vec3(endBiTangent * lineThickness_1);\n        v_texCoord.x = 1.0;\n      }\n      else{\n        viewPos -= vec3(endBiTangent * lineThickness_1);\n        v_texCoord.x = 0.0;\n      }\n      v_texCoord.y = 1.0;\n    }\n\n    // Move the line towards the viewer by the line thickness.\n    // this is to avoid depth issues when lines are rendered over meshes. \n    viewPos.z -= (lineThickness_0 + lineThickness_1) * 0.25;\n  }\n\n  v_viewPos       = viewPos;\n  gl_Position     = projectionMatrix * vec4(viewPos, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("FatLinesShader.fragmentShader","\nprecision highp float;\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\nvarying vec2 v_texCoord;\n\nuniform color BaseColor;\nuniform mat4 cameraMatrix;\n\n#ifdef ENABLE_ES3\n  out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  int debugLevel = 0;\n  if(debugLevel == 0){\n\n    vec3 viewVector = mat3(cameraMatrix) * normalize(-v_viewPos);\n    vec3 normal = mat3(cameraMatrix) * v_viewNormal;\n    float NdotV = dot(normalize(normal), normalize(viewVector));\n\n    // Modulate the lighting using the texture coord so the line looks round.\n    NdotV *= cos((v_texCoord.x - 0.5) * 2.0);\n\n    vec4 color = BaseColor * NdotV;\n    fragColor = vec4(color.rgb, BaseColor.a);\n  }\n  else{\n    fragColor = vec4(v_texCoord.x, 0.0, 0.0, 1.0);\n  }\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n"),this.finalize()}bind(t){return!!super.bind(t)&&(t.supportsInstancing=!1,!0)}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"Opacity",defaultValue:1}),t}}J$1.registerClass("FatLinesShader",Pi$1),Ha$1.setShaderModule("stack-gl/gamma.glsl","\n\nconst float gamma_const = 2.2;\n\nfloat toLinear(float v) {\n  return pow(v, gamma_const);\n}\n\nvec2 toLinear(vec2 v) {\n  return pow(v, vec2(gamma_const));\n}\n\nvec3 toLinear(vec3 v) {\n  return pow(v, vec3(gamma_const));\n}\n\nvec4 toLinear(vec4 v) {\n  return vec4(toLinear(v.rgb), v.a);\n}\n\n\nfloat toGamma(float v) {\n  return pow(v, 1.0 / gamma_const);\n}\n\nvec2 toGamma(vec2 v) {\n  return pow(v, vec2(1.0 / gamma_const));\n}\n\nvec3 toGamma(vec3 v) {\n  return pow(v, vec3(1.0 / gamma_const));\n}\n\nvec4 toGamma(vec4 v) {\n  return vec4(toGamma(v.rgb), v.a);\n}\n\nfloat toGamma(float v, float gamma) {\n  return pow(v, 1.0 / gamma);\n}\n\nvec2 toGamma(vec2 v, float gamma) {\n  return pow(v, vec2(1.0 / gamma));\n}\n\nvec3 toGamma(vec3 v, float gamma) {\n  return pow(v, vec3(1.0 / gamma));\n}\n\nvec4 toGamma(vec4 v, float gamma) {\n  return vec4(toGamma(v.rgb, gamma), v.a);\n}\n\n\n");class Ei$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("FlatSurfaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n\n    vec4 viewPos = (modelViewMatrix * vec4(positions, 1.0));\n    gl_Position = projectionMatrix * viewPos;\n\n    v_viewPos = viewPos.xyz;\n    v_textureCoord = texCoords;\n    v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("FlatSurfaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color BaseColor;\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n#endif\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor = BaseColor;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = baseColor;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J$1.registerClass("FlatSurfaceShader",Ei$1);class Hi$1 extends Ei$1{static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}J$1.registerClass("FlatAlphaSurfaceShader",Hi$1),Ha$1.setShaderModule("math/constants.glsl","\n\n#define PI 3.141592653589793\n#define TwoPI (2.0 * PI)\n#define HalfPI (0.5 * PI)\n\n"),Ha$1.setShaderModule("GGX_Specular.glsl",'\n\n\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n<%include file="utils/imagePyramid.glsl"/>\n\n// uniform ImageAtlas envMap;\n// see: GLImageAtlas.js: line 460.\nuniform sampler2D   envMapPyramid;\nuniform sampler2D   envMapPyramid_layout;\nuniform vec4        envMapPyramid_desc;\n\n\nvec3 sampleEnvMap(vec3 dir, float roughness) {\n    return sampleImagePyramid(dirToSphOctUv(dir), roughness, envMapPyramid_layout, envMapPyramid, envMapPyramid_desc).rgb;\n}\n\n\n// Borrowed heavily from here: http://www.codinglabs.net/article_physically_based_rendering_cook_torrance.aspx\n\nvec3 Fresnel_Schlick(float cosT, vec3 F0)\n{\n    return F0 + (vec3(1.0)-F0) * vec3(pow( 1.0 - cosT, 5.0));\n\n    // for now we calculate this in the suface shader\n    // float schlick = reflectance + pow((1.0-reflectance)*(1.0-dot(N,V)), 5.0);\n}\n\nfloat chiGGX(float v)\n{\n    return v > 0.0 ? 1.0 : 0.0;\n}\n\nfloat saturate(float v)\n{\n    return clamp(v, 0.0, 1.0);\n}\n\nvec3 saturate(vec3 v)\n{\n    return clamp(v, vec3(0.0), vec3(1.0));\n}\n\nfloat saturatedDot( in vec3 a, in vec3 b )\n{\n    return max( dot( a, b ), 0.0 );   \n}\n\nfloat GGX_PartialGeometryTerm(vec3 v, vec3 n, vec3 h, float alpha)\n{\n    float VoH2 = saturate(dot(v,h));\n    float chi = chiGGX( VoH2 / saturate(dot(v,n)) );\n    VoH2 = VoH2 * VoH2;\n    float tan2 = ( 1.0 - VoH2 ) / VoH2;\n    return (chi * 2.0) / ( 1.0 + sqrt( 1.0 + alpha * alpha * tan2 ) );\n}\n\nvec3 GGX_Specular_PrefilteredEnv(vec3 normal, vec3 viewVector, float roughness, float fresnel)\n{\n    vec3 reflectionVector = reflect(-viewVector, normal);\n    vec3 radiance = vec3(0.0);\n    float NoV = saturate(dot(normal, viewVector));\n\n    vec3 sampleVector = reflectionVector;\n\n    // Calculate the half vector\n    vec3 halfVector = normalize(sampleVector + viewVector);\n    float cosT = saturatedDot(reflectionVector, normal);\n    float sinT = sqrt( 1.0 - cosT * cosT);\n\n    // Calculate fresnel\n    // vec3 fresnel = Fresnel_Schlick( saturate(dot( halfVector, viewVector ) ), F0 );\n    // Geometry term\n    float geometry = GGX_PartialGeometryTerm(viewVector, normal, halfVector, clamp(roughness, 0.01, 1.0)) * GGX_PartialGeometryTerm(reflectionVector, normal, halfVector, clamp(roughness, 0.01, 1.0));\n\n    // Calculate the Cook-Torrance denominator\n    float denominator = clamp( 4.0 * (NoV * saturate(dot(halfVector, normal)) + 0.05), 0.0, 1.0 );\n    // kS += fresnel;\n\n    // Accumulate the radiance\n    vec3 envColor = sampleEnvMap(reflectionVector, roughness);\n    radiance += envColor * geometry * fresnel * sinT / denominator;\n    //radiance += envColor * fresnel; // Removing "geometry" for now until we construct a better geometric shading term\n\n    return radiance;        \n}\n'),Ha$1.setShaderModule("PBRSurfaceRadiance.glsl","\n\nstruct MaterialParams {\n    vec3 baseColor;\n    float metallic;\n    float roughness;\n    float reflectance;\n};\n\nvec4 pbrSpecularReflectance(in MaterialParams materialParams, vec3 normal, in vec3 viewVector) {\n\n    float NdotV = dot(normal, viewVector);\n    \n    // -------------------------- Specular Reflectance --------------------------\n    // vec3 ks = vec3(0.0);\n    // vec3 specular = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, F0, ks );\n    // vec3 kd = (vec3(1.0) - ks) * vec3(1.0 - metallic);    \n\n    float schlickFresnel = materialParams.reflectance + pow((1.0-materialParams.reflectance)*(1.0-NdotV), 5.0);\n\n    vec3 specularReflectance = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, schlickFresnel);\n\n\n    // -------------------------- Specular Occlusion --------------------------\n    // Fast and quick way of reducing specular reflection in areas that are less exposed to the environment\n    // A better approch is to try screen space specular occlusion but need to check performance and feasibility in webGL\n    //float specularOcclusion = clamp(length(irradiance), 0.01, 1.0);    \n    //specularReflectance = (specularReflectance * specularOcclusion); \n\n    return vec4(specularReflectance, schlickFresnel);\n}\n\n\nvec3 pbrSurfaceRadiance(in MaterialParams materialParams, vec3 irradiance, vec3 normal, in vec3 viewVector) {\n\n    float NdotV = dot(normal, viewVector);\n    vec3 specularReflectance;\n\n    // -------------------------- Diffuse Reflectance --------------------------\n\n    vec3 diffuseReflectance = materialParams.baseColor * irradiance;\n\n    // From the Disney dielectric BRDF    \n    // Need to check if this is useful for us but the implementation works based on their paper\n    //diffuseReflectance = (diffuseReflectance / PI); // << [PT 18-08-2018] What did this line do??? (makes everything 3.1x darker.)\n    // diffuseReflectance = vec3(mix(diffuseReflectance, diffuseReflectance * mix(0.5, 2.5, materialParams.roughness), pow(1.0 - NdotV, 5.0)));\n    diffuseReflectance = vec3(mix(diffuseReflectance, diffuseReflectance * mix(0.5, 1.0, materialParams.roughness), pow(1.0 - NdotV, 5.0)));\n\n\n    // -------------------------- Color at normal incidence --------------------------\n    \n    // Need to use 'Reflectance' here instead of 'ior'\n    //vec3 F0 = vec3(abs((1.0 - ior) / (1.0 + ior)));    \n    //F0 = F0 * F0;\n    //F0 = mix(F0, materialParams.baseColor, materialParams.metallic);      \n\n\n    // -------------------------- Specular Reflectance --------------------------\n    // vec3 ks = vec3(0.0);\n    // vec3 specular = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, F0, ks );\n    // vec3 kd = (vec3(1.0) - ks) * vec3(1.0 - metallic);    \n\n    float schlickFresnel = materialParams.reflectance + pow((1.0-materialParams.reflectance)*(1.0-NdotV), 5.0);\n\n    specularReflectance = GGX_Specular_PrefilteredEnv(normal, viewVector, materialParams.roughness, schlickFresnel);\n\n\n    // -------------------------- Specular Occlusion --------------------------\n    // Fast and quick way of reducing specular reflection in areas that are less exposed to the environment\n    // A better approch is to try screen space specular occlusion but need to check performance and feasibility in webGL\n    //float specularOcclusion = clamp(length(irradiance), 0.01, 1.0);    \n    //specularReflectance = (specularReflectance * specularOcclusion);  \n      \n\n    // -------------------------- Metallic --------------------------\n    // We need to do few things given a higher > 0 metallic value\n    //      1. tint specular reflectance by the albedo color (not at grazing angles)\n    //      2. almost elliminate all diffuse reflectance (in reality metals have some diffuse due to layering (i.e. dust, prints, etc.))\n    //      3. set \"specular\" artistic value to metallic range (0.6 - 0.85)\n\n    specularReflectance = mix(specularReflectance, specularReflectance * materialParams.baseColor, materialParams.metallic);\n    diffuseReflectance = mix(diffuseReflectance, vec3(0.0,0.0,0.0), materialParams.metallic); // Leaveing at pure black for now but always need some %3 diffuse left for imperfection of pulished pure metal\n    // Would be best to compute reflectace internally and set here to 0.6-0.85 for metals\n    \n\n    // -------------------------- Final color --------------------------\n    // Energy conservation already taken into account in both the diffuse and specular reflectance\n    vec3 radiance = diffuseReflectance + specularReflectance;\n\n    // radiance = vec4( kd * diffuse + /*ks */ specular, 1);\n    return radiance;\n}\n");class ki$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("LayeredCarPaintShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec3 normals;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\nattribute vec2 lightmapCoords;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nattribute float clusterIDs;\nuniform vec2 lightmapSize;\n\n/* VS Outputs */\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n\n    v_geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n\n#ifdef ENABLE_TEXTURES\n    v_textureCoord  = texCoords;\n#endif\n    // v_lightmapCoord = (lightmapCoords + geomItemData.zw) / lightmapSize;\n\n    // mat4 mvp = projectionMatrix * viewMatrix * modelMatrix;\n    // gl_Position = mvp * vec4((lightmapCoords + geomItemData.xy), 0., 1.);\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n//     v_clusterID = clusterIDs;\n// #endif\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("LayeredCarPaintShader.fragmentShader",'\n#ifndef ENABLE_ES3\n    #extension GL_OES_standard_derivatives : enable\n#endif\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="GGX_Specular.glsl"/>\n<%include file="PBRSurfaceRadiance.glsl"/>\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\n#endif\n<%include file="materialparams.glsl"/>\n\n/* VS Outputs */\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\nuniform sampler2D lightmap;\nuniform vec2 lightmapSize;\n#ifdef ENABLE_DEBUGGING_LIGHTMAPS\n<%include file="debugColors.glsl"/>\nuniform bool debugLightmapTexelSize;\n#endif\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nuniform mat4 cameraMatrix;\n\nuniform color BaseColor;\nuniform color MidColorTint;\nuniform float MidColorTintReflectance;\n\nuniform float MicroflakePerturbation;\nuniform sampler2D FlakesNormalTex;\nuniform float FlakesScale;\n\n#ifdef ENABLE_SPECULAR\n\nuniform float BaseRoughness;\nuniform float BaseMetallic;\nuniform float BaseReflectance;\nuniform float GlossRoughness;\nuniform float GlossMetallic;\nuniform float GlossReflectance;\n\n#endif\n\n#ifdef ENABLE_TEXTURES\n\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n\n#endif\n\n// Followup: Normal Mapping Without Precomputed Tangents\n// http://www.thetenthplanet.de/archives/1180\nmat3 cotangent_frame( vec3 normal, vec3 position, vec2 uv )\n{\n    // get edge vectors of the pixel triangle\n    vec3 dp1 = dFdx( position );\n    vec3 dp2 = dFdy( position );\n    vec2 duv1 = dFdx( uv );\n    vec2 duv2 = dFdy( uv );\n \n    // solve the linear system\n    vec3 dp2perp = cross( dp2, normal );\n    vec3 dp1perp = cross( normal, dp1 );\n    vec3 tangent = dp2perp * duv1.x + dp1perp * duv2.x;\n    vec3 bitangent = dp2perp * duv1.y + dp1perp * duv2.y;\n \n    // construct a scale-invariant frame \n    float invmax = inversesqrt( max( dot(tangent,tangent), dot(bitangent,bitangent) ) );\n    return mat3( tangent * invmax, bitangent * invmax, normal );\n}\n\n#define WITH_NORMALMAP_UNSIGNED 1\n\nvec3 sampleNormalMap( sampler2D normalMap, vec2 texcoord )\n{\n    // assume normal, the interpolated vertex normal and \n    // viewVec, the view vector (vertex to eye)\n    vec3 map = texture2D( normalMap, texcoord ).xyz;\n#ifdef WITH_NORMALMAP_UNSIGNED\n    map = map * 255./127. - 128./127.;\n#endif\n#ifdef WITH_NORMALMAP_2CHANNEL\n    map.z = sqrt( 1. - dot( map.xy, map.xy ) );\n#endif\n#ifdef WITH_NORMALMAP_GREEN_UP\n    map.y = -map.y;\n#endif\n    return map;\n}\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n    MaterialParams material;\n\n#ifndef ENABLE_TEXTURES\n    material.baseColor      = BaseColor.rgb;\n#else\n    vec2 texCoord           = vec2(v_textureCoord.x, 1.0 - v_textureCoord.y);\n    material.baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, texCoord).rgb;\n#endif\n\n#ifdef ENABLE_SPECULAR\n    material.roughness      = BaseRoughness;\n    material.metallic       = BaseMetallic;\n    material.reflectance    = BaseReflectance;\n#endif\n\n    vec3 irradiance = texture2D(lightmap, v_lightmapCoord).rgb;\n \n#ifdef ENABLE_DEBUGGING_LIGHTMAPS\n    if(debugLightmapTexelSize)\n    {\n        vec2 coord_texelSpace = (v_lightmapCoord * lightmapSize) - v_geomItemData.zw;\n        //vec2 coord_texelSpace = (v_textureCoord * lightmapSize);\n        float total = floor(coord_texelSpace.x) +\n                      floor(coord_texelSpace.y);\n                      \n        vec3 clustercolor = getDebugColor(v_clusterID);\n\n        if(mod(total,2.0)==0.0){\n            material.baseColor = clustercolor;\n            irradiance = vec3(1.0);\n        }\n        else{\n            material.baseColor = material.baseColor * 1.5;\n        }\n    }\n#endif\n\n    vec3 viewNormal = normalize(v_viewNormal);\n    vec3 surfacePos = -v_viewPos;\n\n    // The vector from the camera to the surface point.\n    vec3 viewVector = mat3(cameraMatrix) * normalize(v_viewPos);\n    vec3 viewDir = normalize(viewVector);\n    vec3 normal = normalize(mat3(cameraMatrix) * viewNormal);\n\n    float NdotV = dot(normal, viewDir);\n    if(NdotV < 0.0){\n        normal = -normal;\n        NdotV = dot(normal, viewDir);\n    }\n\n#ifndef ENABLE_SPECULAR\n    vec3 radiance = material.baseColor * irradiance;\n#else\n    \n    // Mix the base color to give a multi-layered paint look.\n    material.baseColor      = mix(material.baseColor, material.baseColor * MidColorTint.rgb, (1.0-NdotV));\n\n    mat3 TBN = cotangent_frame( normal, surfacePos, v_lightmapCoord );\n    vec3 flakesNormal = TBN * -sampleNormalMap( FlakesNormalTex, (v_lightmapCoord * lightmapSize) / FlakesScale );\n    flakesNormal = normalize(mix(normal, flakesNormal, MicroflakePerturbation));\n\n    vec3 baseRadiance = pbrSurfaceRadiance(material, irradiance, flakesNormal, viewVector);\n\n    material.roughness      = GlossRoughness;\n    material.reflectance    = GlossReflectance;\n    vec4 gloss = pbrSpecularReflectance(material, normal, viewVector);\n    vec3 radiance = mix(baseRadiance, gloss.rgb, gloss.a);\n    //vec3 radiance = baseRadiance;\n\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(radiance, 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();t.push({name:"BaseColor",defaultValue:new y$3(1,0,0)}),t.push({name:"BaseMetallic",defaultValue:0}),t.push({name:"BaseRoughness",defaultValue:.35}),t.push({name:"BaseReflectance",defaultValue:.03}),t.push({name:"MidColorTint",defaultValue:new y$3(1,1,1)}),t.push({name:"MidColorTintReflectance",defaultValue:.03}),t.push({name:"GlossMetallic",defaultValue:0}),t.push({name:"GlossRoughness",defaultValue:.35}),t.push({name:"GlossReflectance",defaultValue:.03});const e=new ot$1("flakes","ZeaEngine/FlakesNormalMap.png");return e.wrap="REPEAT",e.mipMapped=!0,t.push({name:"FlakesNormal",defaultValue:e}),t.push({name:"FlakesScale",defaultValue:.1}),t.push({name:"MicroflakePerturbation",defaultValue:.1}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J$1.registerClass("LayeredCarPaintShader",ki$1);class Bi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("FlatShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec2 lightmapCoords;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform vec3 ProjectionCenter;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nattribute float clusterIDs;\nuniform vec2 lightmapSize;\n\n/* VS Outputs */\n// varying vec2 v_lightmapCoord;\nvarying vec3 v_worldDir;\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n\n    vec4 geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position     = modelViewProjectionMatrix * pos;\n\n    vec4 worldPos = modelMatrix * pos;\n    v_worldDir = worldPos.xyz - ProjectionCenter;\n\n    v_lightmapCoord = (lightmapCoords + geomItemData.zw) / lightmapSize;\n}\n')}}J$1.registerClass("ShadowCatcherShader",class extends Bi$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("ShadowCatcherShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\n#endif\n\n/* VS Outputs */\nvarying vec2 v_lightmapCoord;\nvarying vec3 v_worldDir;\n\nuniform sampler2D lightmap;\nuniform float ShadowMultiplier;\n\nuniform color envMap;\nuniform sampler2D envMapTex;\nuniform int envMapTexType;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nfloat luminanceFromRGB(vec3 rgb) {\n    return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n    vec4 env = envMap;\n    if(envMapTexType != 0) {\n        vec2 texCoord = dirToSphOctUv(normalize(v_worldDir));\n        env = texture2D(envMapTex, texCoord);\n    }\n\n    vec3 irradiance = texture2D(lightmap, v_lightmapCoord).rgb * ShadowMultiplier;\n    float irradianceLum = clamp(luminanceFromRGB(irradiance), 0.0, 1.0);\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(env.rgb/env.a, 1.0);\n    fragColor.rgb = mix(fragColor.rgb * irradiance, fragColor.rgb, irradianceLum);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"ProjectionCenter",defaultValue:new Z$1(0,0,1.7)}),t.push({name:"ShadowMultiplier",defaultValue:1}),t}static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}),J$1.registerClass("FloatingShadowCatcherShader",class extends Bi$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("FloatingShadowCatcherShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLUtils.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n<%include file="pragmatic-pbr/envmap-octahedral.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_lightmapCoord;\nvarying vec3 v_worldDir;\n\nuniform sampler2D lightmap;\n\nuniform float ShadowMultiplier;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    \n    float shadow = luminanceFromRGB(texture2D(lightmap, v_lightmapCoord).rgb) * ShadowMultiplier;\n\n    // This material works by multiplying the image buffer values by the luminance in the lightmap.\n    fragColor.rgb = vec3(pow(shadow, 1.0/ShadowMultiplier));\n    fragColor.a = 1.0;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n')}bind(t,e){return"MULTIPLY"==t.pass&&super.bind(t,e)}static isTransparent(){return!0}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"ShadowMultiplier",defaultValue:1}),t}});class Di$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("LinesShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position = modelViewProjectionMatrix * vec4(positions, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("LinesShader.fragmentShader","\nprecision highp float;\n\nuniform color BaseColor;\nuniform float Opacity;\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = BaseColor;\n    fragColor.a *= Opacity;\n    \n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n"),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"Opacity",defaultValue:1}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}J$1.registerClass("LinesShader",Di$1);class Oi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("NormalsShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec3 positions;\ninstancedattribute vec3 normals;\nattribute vec2 vertexIDs;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\nuniform float normalLength;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n\n/* VS Outputs */\nvarying float v_weight;\n\nvoid main(void) {\n  mat4 modelMatrix = getModelMatrix(transformIndex);\n  mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n  if(vertexIDs.x == 0.0){\n    gl_Position = modelViewProjectionMatrix * vec4(positions, 1.0);\n    v_weight = 1.0;\n  }\n  else{\n    gl_Position = modelViewProjectionMatrix * vec4(positions+(normals*normalLength), 1.0);\n    v_weight = 0.0;\n  }\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("NormalsShader.fragmentShader","\nprecision highp float;\n\nuniform color normalColor;\n\n/* VS Outputs */\nvarying float v_weight;\n\n\nvoid main(void) {\n  gl_FragColor = normalColor;\n  gl_FragColor.a = v_weight;\n}\n")}}class Qi$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("PointsShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n  gl_Position = modelViewProjectionMatrix * vec4(positions, 1.);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("PointsShader.fragmentShader","\nprecision highp float;\n\nuniform color BaseColor;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  fragColor = BaseColor;\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n")}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t}}J$1.registerClass("PointsShader",Qi$1);class Ai$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("FatPointsShader.vertexShader",'\nprecision highp float;\n\ninstancedattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n<%include file="utils/quadVertexFromID.glsl"/>\n\nuniform float PointSize;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  vec2 quadPointPos = getQuadVertexPositionFromID();\n  v_texCoord = quadPointPos + 0.5;\n\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  \n  vec4 viewPos = modelViewMatrix * vec4(positions, 1.);\n\n  viewPos += vec4(vec3(quadPointPos, 0.0) * PointSize, 0.);\n\n  // Generate a quad which is 0.5 * PointSize closer towards\n  // us. This allows points to be visualized even if snug on \n  // a surface. (else they get fully clipped)\n  viewPos.z += 0.5 * PointSize;\n\n  v_drawItemId = float(getDrawItemId());\n  v_viewPos = -viewPos.xyz;\n  \n  gl_Position = projectionMatrix * viewPos;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("FatPointsShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n\nuniform color BaseColor;\nuniform float Rounded;\nuniform float BorderWidth;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  float dist = length(v_texCoord - 0.5);\n  if(dist > 0.5)\n    discard;\n  if(dist > 0.5 - (BorderWidth * 0.5))\n    fragColor = vec4(0.,0.,0.,1.);\n  else {\n    // Modulate the lighting using the texture coord so the point looks round.\n    float NdotV = cos(dist * PI);\n\n    fragColor = BaseColor * mix(1.0, NdotV, Rounded);\n  }\n  \n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}bind(t){return!!super.bind(t)&&(t.supportsInstancing=!1,!0)}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"PointSize",defaultValue:.05}),t.push({name:"Rounded",defaultValue:1}),t.push({name:"BorderWidth",defaultValue:.2}),t}static getGeomDataShaderName(){return"FatPointsGeomDataShader"}static getSelectedShaderName(){return"FatPointsSelectedShader"}}class ji$1 extends Ai$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("FatPointsGeomDataShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLBits.glsl"/>\n\nuniform int floatGeomBuffer;\nuniform int passId;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  float dist = length(v_texCoord - 0.5);\n  if(dist > 0.5)\n    discard;\n    \n\n  float viewDist = length(v_viewPos);\n\n  if(floatGeomBuffer != 0) {\n    fragColor.r = float(passId); \n    fragColor.g = float(v_drawItemId);\n    fragColor.b = 0.0;// TODO: store poly-id or something.\n    fragColor.a = viewDist;\n  }\n  else {\n    ///////////////////////////////////\n    // UInt8 buffer\n    fragColor.r = (mod(v_drawItemId, 256.) + 0.5) / 255.;\n    fragColor.g = (floor(v_drawItemId / 256.) + 0.5) / 255.;\n\n    // encode the dist as a 16 bit float\n    vec2 float16bits = encode16BitFloatInto2xUInt8(viewDist);\n    fragColor.b = float16bits.x;\n    fragColor.a = float16bits.y;\n  }\n\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}}class qi$1 extends Ai$1{constructor(t){super(t),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("FatPointsSelectedShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="GLSLBits.glsl"/>\n\nuniform int floatGeomBuffer;\nuniform int passId;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\nvarying vec3 v_viewPos;\nvarying float v_drawItemId;\n\n\n<%include file="drawItemTexture.glsl"/>\n\n#ifdef ENABLE_FLOAT_TEXTURES\nvec4 getHighlightColor(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 4);\n}\n#else\n\nuniform vec4 highlightColor;\n\nvec4 getHighlightColor() {\n    return highlightColor;\n}\n\n#endif\n\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n#endif\n\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n  vec4 fragColor;\n#endif\n\n  float dist = length(v_texCoord - 0.5);\n  if(dist > 0.5)\n    discard;\n  \n  int drawItemId = int(v_drawItemId + 0.5);\n  fragColor = getHighlightColor(drawItemId);\n\n#ifndef ENABLE_ES3\n  gl_FragColor = fragColor;\n#endif\n}\n')}}J$1.registerClass("FatPointsShader",Ai$1),J$1.registerClass("FatPointsGeomDataShader",ji$1),J$1.registerClass("FatPointsSelectedShader",qi$1),Ha$1.setShaderModule("pragmatic-pbr/exposure.glsl","\n\n/*\n* Get an exposure using the Saturation-based Speed method.\n*/\nfloat getSaturationBasedExposure(float aperture,\n                                 float shutterSpeed,\n                                 float iso)\n{\n    float l_max = (7800.0 / 65.0) * sqrt(aperture) / (iso * shutterSpeed);\n    return 1.0 / l_max;\n}\n\n//White balance middle grey we are targetting for a good scene exposure\n//https://en.wikipedia.org/wiki/Middle_gray\nconst float MIDDLE_GREY = 0.18;\n\n/*\n* Get an exposure using the Standard Output Sensitivity method.\n* Accepts an additional parameter of the target middle grey.\n*/\nfloat getStandardOutputBasedExposure(float aperture,\n                                     float shutterSpeed,\n                                     float iso)\n{\n    //https://placeholderart.wordpress.com/2014/11/21/implementing-a-physically-based-camera-manual-exposure/\n    //https://en.wikipedia.org/wiki/Film_speed#Standard_output_sensitivity_.28SOS.29\n    //photometric exposure magic\n    //represents the properties of lens\n    float q = 0.65;\n\n    //float l_avg = (1000.0f / 65.0f) * sqrt(aperture) / (iso * shutterSpeed);\n    float l_avg = (1.0 / q) * sqrt(aperture) / (iso * shutterSpeed);\n    //float l_avg = sqrt(aperture) / (iso * shutterSpeed);\n    return MIDDLE_GREY / l_avg;\n}\n\n"),Ha$1.setShaderModule("pragmatic-pbr/tonemap-filmic.glsl","\n\n//Based on Filmic Tonemapping Operators http://filmicgames.com/archives/75\nvec3 tonemapFilmic(vec3 color) {\n    vec3 x = max(vec3(0.0), color - 0.004);\n    return (x * (6.2 * x + 0.5)) / (x * (6.2 * x + 1.7) + 0.06);\n}\n\n"),Ha$1.setShaderModule("mattdesl/fxaa-texcoords.glsl","\n//To save 9 dependent texture reads, you can compute\n//these in the vertex shader and use the optimized\n//frag.glsl function in your frag shader. \n\n//This is best suited for mobile devices, like iOS.\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\n"),Ha$1.setShaderModule("mattdesl/fxaa.glsl",'\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n--\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\nCopyright (c) 2011 by Armin Ronacher.\nSome rights reserved.\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE, \n            vec2 v_rgbSW, vec2 v_rgbSE, \n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n'),Ha$1.setShaderModule("mattdesl/fxaa-apply.glsl",'\n\n<%include file="mattdesl/fxaa.glsl"/>\n\nvec4 apply(sampler2D tex, vec2 fragCoord, vec2 resolution) {\n    mediump vec2 v_rgbNW;\n    mediump vec2 v_rgbNE;\n    mediump vec2 v_rgbSW;\n    mediump vec2 v_rgbSE;\n    mediump vec2 v_rgbM;\n\n    //compute the texture coords\n    texcoords(fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n    \n    //compute FXAA\n    return fxaa(tex, fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n\n');class $i$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("PostProcessing.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n<%include file="mattdesl/fxaa-texcoords.glsl"/>\n\nuniform vec2 textureSize;\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(position*2.0, 0.0, 1.0);\n\n    vec2 fragCoord = v_texCoord * textureSize;\n    texcoords(fragCoord, textureSize, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("PostProcessing.fragmentShader",'\nprecision highp float;\n\n<%include file="pragmatic-pbr/exposure.glsl"/>\n<%include file="pragmatic-pbr/tonemap-filmic.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n\n<%include file="mattdesl/fxaa.glsl"/>\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D texture;\nuniform vec2 textureSize;\n\nuniform bool antialiase;\nuniform bool tonemap;\nuniform float exposure;\nuniform float gamma;\n\nvarying vec2 v_texCoord;\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n    //can also use gl_FragCoord.xy\n    mediump vec2 fragCoord = v_texCoord * textureSize; \n\n    if (antialiase) {\n        fragColor = fxaa(texture, fragCoord, textureSize, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n    } else {\n        fragColor = texture2D(texture, v_texCoord);\n    }\n    \n    //fragColor.rgb *= getStandardOutputBasedExposure(aperture, shutterSpeed, iso);\n    fragColor.rgb *= exposure;\n    \n    if (tonemap) \n        fragColor.rgb = tonemapFilmic(fragColor.rgb);\n    else\n        fragColor.rgb = toGamma(fragColor.rgb, gamma);\n\n    \n    //fragColor.rgb = toGamma(fragColor.rgb, gamma);\n    \n    fragColor.a = 1.0;\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}'),this.finalize()}}class es$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("SimpleSurfaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec3 normals;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\nvarying vec3 v_worldPos;\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    v_drawItemId = float(drawItemId);\n    v_geomItemData  = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n\n#ifdef ENABLE_TEXTURES\n    v_textureCoord  = texCoords;\n    // v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n#endif\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("SimpleSurfaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="drawItemTexture.glsl"/>\n<%include file="cutaways.glsl"/>\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\nvarying vec3 v_worldPos;\n\nuniform mat4 cameraMatrix;\n\nuniform color BaseColor;\nuniform float Opacity;\n\n#ifdef ENABLE_TEXTURES\n\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\nuniform sampler2D OpacityTex;\nuniform int OpacityTexType;\n\nuniform color cutColor;\nvec4 getCutaway(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 5);\n}\n\n#endif\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\n\nvoid main(void) {\n    int drawItemId = int(v_drawItemId + 0.5);\n\n    int flags = int(v_geomItemData.r + 0.5);\n    // Cutaways\n    if(testFlag(flags, GEOMITEM_FLAG_CUTAWAY)) \n    {\n        vec4 cutAwayData   = getCutaway(drawItemId);\n        vec3 planeNormal = cutAwayData.xyz;\n        float planeDist = cutAwayData.w;\n        if(cutaway(v_worldPos, planeNormal, planeDist)){\n            discard;\n            return;\n        }\n        else if(!gl_FrontFacing){\n            fragColor = cutColor;\n#ifndef ENABLE_ES3\n            gl_FragColor = fragColor;\n#endif\n            return;\n        }\n    }\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor      = BaseColor;\n    float opacity       = baseColor.a * Opacity;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n    float opacity       = baseColor.a * getLuminanceParamValue(Opacity, OpacityTex, OpacityTexType, v_textureCoord);\n#endif\n\n    // Hacky simple irradiance. \n    vec3 viewVector = normalize(mat3(cameraMatrix) * normalize(v_viewPos));\n    vec3 normal = normalize(mat3(cameraMatrix) * v_viewNormal);\n    float ndotv = dot(normal, viewVector);\n    if(ndotv < 0.0){\n        normal = -normal;\n        ndotv = dot(normal, viewVector);\n\n        // Note: these 2 lines can be used to debug inverted meshes.\n        //baseColor = vec4(1.0, 0.0, 0.0, 1.0);\n        //ndotv = 1.0;\n    }\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = vec4(ndotv * baseColor.rgb, opacity);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"Opacity",defaultValue:1,range:[0,1]}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J$1.registerClass("SimpleSurfaceShader",es$1),Ha$1.setShaderModule("cutaways.glsl","\n\n\nconst int GEOMITEM_FLAG_CUTAWAY =  1; // 1<<0;\n\n#define RAY_EPS 0.0000001\nstruct Ray {\n    vec3 start;\n    vec3 dir;\n};\n\nfloat intersectRayPlane(Ray ray, Ray plane) {\n    vec3 w = ray.start - plane.start;\n    float D = dot(plane.dir, ray.dir);\n    float N = dot(-plane.dir, w);\n\n    if (abs(D) < RAY_EPS) {\n        // segment is parallel to plane\n        if (N == 0.0)\n            return -1.0; // segment lies in plane\n        else\n            return -1.0; // no intersection\n    }\n    // they are not parallel\n    // compute intersect param\n    float sI = N / D;\n    if (sI < -RAY_EPS) {\n        return -1.0; // no intersection\n    }\n    return sI;\n}\n\n\nbool cutaway(vec3 worldPos, vec3 planeNormal, float planeDist) {\n\n    vec3 planePos = planeNormal * planeDist;\n    vec3 planeDir = worldPos + planePos;\n    float planeOffset = dot(planeDir, planeNormal);\n    if(planeOffset > 0.0){\n        return true;\n    }\n    return  false;\n}\n");class ts$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("StandardSurfaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\nattribute vec3 normals;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\nattribute vec2 lightmapCoords;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n// attribute float clusterIDs;\n// uniform vec2 lightmapSize;\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    v_drawItemId = float(drawItemId);\n    v_geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n\n#ifdef ENABLE_TEXTURES\n    v_textureCoord  = texCoords;\n#endif\n\n    // v_lightmapCoord = (lightmapCoords + v_geomItemData.zw) / lightmapSize;\n\n    // mat4 mvp = projectionMatrix * viewMatrix * modelMatrix;\n    // gl_Position = mvp * vec4((lightmapCoords + v_geomItemData.zw), 0., 1.);\n#ifdef ENABLE_DEBUGGING_LIGHTMAPS\n    v_clusterID = clusterIDs;\n#endif\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("StandardSurfaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="math/constants.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="cutaways.glsl"/>\n\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\n<%include file="GGX_Specular.glsl"/>\n<%include file="PBRSurfaceRadiance.glsl"/>\n\n/* VS Outputs */\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n// varying vec2 v_lightmapCoord;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// varying float v_clusterID;\n// #endif\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\n// uniform sampler2D lightmap;\n// uniform bool lightmapConnected;\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n// <%include file="debugColors.glsl"/>\n// uniform vec2 lightmapSize;\n// uniform bool debugLightmapTexelSize;\n// #endif\n\nuniform color cutColor;\nvec4 getCutaway(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 5);\n}\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nuniform mat4 cameraMatrix;\n\nuniform color BaseColor;\nuniform float EmissiveStrength;\n\n\n#ifdef ENABLE_SPECULAR\nuniform float Roughness;\nuniform float Metallic;\nuniform float Reflectance;\n#endif\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n\n#ifdef ENABLE_SPECULAR\nuniform sampler2D RoughnessTex;\nuniform int RoughnessTexType;\n\nuniform sampler2D MetallicTex;\nuniform int MetallicTexType;\n\nuniform sampler2D ReflectanceTex;\nuniform int ReflectanceTexType;\n\nuniform sampler2D NormalTex;\nuniform int NormalTexType;\n// uniform float NormalScale;\n#endif\n\nuniform sampler2D EmissiveStrengthTex;\nuniform int EmissiveStrengthTexType;\n\n\n#endif\n\n#ifdef ENABLE_ES3\nout vec4 fragColor;\n\n#endif\n\nvoid main(void) {\n    int drawItemId = int(v_drawItemId + 0.5);\n\n    int flags = int(v_geomItemData.r + 0.5);\n    // Cutaways\n    if(testFlag(flags, GEOMITEM_FLAG_CUTAWAY)) {\n        vec4 cutAwayData   = getCutaway(drawItemId);\n        vec3 planeNormal = cutAwayData.xyz;\n        float planeDist = cutAwayData.w;\n        if(cutaway(v_worldPos, planeNormal, planeDist)){\n            discard;\n            return;\n        }\n        else if(!gl_FrontFacing){\n            fragColor = cutColor;\n#ifndef ENABLE_ES3\n            gl_FragColor = fragColor;\n#endif\n            return;\n        }\n    }\n\n\n    MaterialParams material;\n\n#ifndef ENABLE_TEXTURES\n    material.BaseColor     = BaseColor.rgb;\n    float emission         = EmissiveStrength;\n\n#ifdef ENABLE_SPECULAR\n    material.roughness     = Roughness;\n    material.metallic      = Metallic;\n    material.reflectance   = Reflectance;\n#endif\n\n#else\n    // Planar YZ projection for texturing, repeating every meter.\n    // vec2 texCoord       = v_worldPos.xz * 0.2;\n    vec2 texCoord          = vec2(v_textureCoord.x, 1.0 - v_textureCoord.y);\n    material.baseColor     = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, texCoord).rgb;\n\n#ifdef ENABLE_SPECULAR\n    material.roughness     = getLuminanceParamValue(Roughness, RoughnessTex, RoughnessTexType, texCoord);\n    material.metallic      = getLuminanceParamValue(Metallic, MetallicTex, MetallicTexType, texCoord);\n    material.reflectance   = getLuminanceParamValue(Reflectance, ReflectanceTex, ReflectanceTexType, texCoord);\n#endif\n    float emission         = getLuminanceParamValue(EmissiveStrength, EmissiveStrengthTex, EmissiveStrengthTexType, texCoord);\n#endif\n\n    vec3 viewNormal = normalize(v_viewNormal);\n    //vec3 surfacePos = -v_viewPos;\n\n#ifdef ENABLE_TEXTURES\n#ifdef ENABLE_SPECULAR\n    if(NormalTexType != 0){\n        vec3 textureNormal_tangentspace = normalize(texture2D(NormalTex, texCoord).rgb * 2.0 - 1.0);\n        viewNormal = normalize(mix(viewNormal, textureNormal_tangentspace, 0.3));\n    }\n#endif\n#endif\n\n    vec3 viewVector = normalize(mat3(cameraMatrix) * normalize(v_viewPos));\n    vec3 normal = normalize(mat3(cameraMatrix) * viewNormal);\n    if(dot(normal, viewVector) < 0.0){\n        normal = -normal;\n        // Note: this line can be used to debug inverted meshes.\n        //material.baseColor = vec3(1.0, 0.0, 0.0);\n    }\n\n    vec3 irradiance;\n    // if(lightmapConnected){\n    //     irradiance = texture2D(lightmap, v_lightmapCoord).rgb;\n    // }\n    // else{\n#ifndef ENABLE_SPECULAR\n        irradiance = sampleEnvMap(normal, 1.0);\n#else\n        irradiance = vec3(dot(normal, viewVector));\n#endif\n        \n    // }\n\n// #ifdef ENABLE_DEBUGGING_LIGHTMAPS\n//     if(debugLightmapTexelSize)\n//     {\n//         vec2 coord_texelSpace = (v_lightmapCoord * lightmapSize) - v_geomItemData.zw;\n//         //vec2 coord_texelSpace = (v_textureCoord * lightmapSize);\n//         float total = floor(coord_texelSpace.x) +\n//                       floor(coord_texelSpace.y);\n                      \n//         vec3 clustercolor = getDebugColor(v_clusterID);\n\n//         material.metallic = 0.0;\n//         material.reflectance = 0.0;\n//         if(mod(total,2.0)==0.0){\n//             material.baseColor = clustercolor;\n//             irradiance = vec3(1.0);\n//         }\n//         else{\n//             material.baseColor = material.baseColor * 1.5;\n//         }\n//     }\n// #endif\n\n#ifndef ENABLE_SPECULAR\n    vec3 radiance = material.baseColor * irradiance;\n#else\n    vec3 radiance = pbrSurfaceRadiance(material, irradiance, normal, viewVector);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    // fragColor = vec4(material.baseColor, 1.0);\n    // fragColor = vec4(material.baseColor * irradiance, 1.0);\n    fragColor = vec4(radiance + (emission * material.baseColor), 1.0);\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"Metallic",defaultValue:0,range:[0,1]}),t.push({name:"Roughness",defaultValue:.85,range:[0,1]}),t.push({name:"Reflectance",defaultValue:.1,range:[0,1]}),t.push({name:"EmissiveStrength",defaultValue:0,range:[0,1]}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}}J$1.registerClass("StandardSurfaceShader",ts$1),Ha$1.setShaderModule("GLSLBits.glsl",'\n    \n/////////////////////////////////////////////////////////////////\n// http://concord-consortium.github.io/lab/experiments/webgl-gpgpu/script.js\nfloat shift_right(float v, float amt) {\n  v = floor(v) + 0.5;\n  return floor(v / exp2(amt));\n}\nfloat shift_left(float v, float amt) {\n  return floor(v * exp2(amt) + 0.5);\n}\n\nfloat mask_last(float v, float bits) {\n  return mod(v, shift_left(1.0, bits));\n}\nfloat extract_bits(float num, float from, float to) {\n  from = floor(from + 0.5);\n  to = floor(to + 0.5);\n  return mask_last(shift_right(num, from), to - from);\n}\n\n/////////////////////////////////////////////////////////////////\n// https://stackoverflow.com/questions/18453302/how-do-you-pack-one-32bit-int-into-4-8bit-ints-in-glsl-webgl\n\nconst vec4 bitEnc = vec4(1.,255.,65025.,16581375.);\nconst vec4 bitDec = 1./bitEnc;\nvec4 EncodeFloatRGBA (float v) {\n    vec4 enc = bitEnc * v;\n    enc = fract(enc);\n    enc -= enc.yzww * vec2(1./255., 0.).xxxy;\n    return enc;\n}\nfloat DecodeFloatRGBA (vec4 v) {\n    return dot(v, bitDec);\n}\n\n\n\n/////////////////////////////////////////////////////////////////\n// https://gist.github.com/Flexi23/1713774\n// \nvec2 encode16BitFloatInto2xUInt8(float v){\n    vec2 c = vec2(0.);\n\n    int signum = (v >= 0.) ? 128 : 0;\n    v = abs(v);\n    int exponent = 15;\n    float limit = 1024.; // considering the bias from 2^-5 to 2^10 (==1024)\n    for(int exp = 15; exp > 0; exp--){\n        if( v < limit){\n            limit /= 2.;\n            exponent--;\n        }\n    }\n\n    float rest;\n    if(exponent == 0){\n        rest = v / limit / 2.;      // "subnormalize" implicite preceding 0. \n    }else{\n        rest = (v - limit)/limit;   // normalize accordingly to implicite preceding 1.\n    }\n\n    int mantissa = int(rest * 2048.);   // 2048 = 2^11 for the (split) 11 bit mantissa\n    int msb = mantissa / 256;           // the most significant 3 bits go into the lower part of the first byte\n    int lsb = mantissa - msb * 256;     // there go the other 8 bit of the lower significance\n\n    c.x = float(signum + exponent * 8 + msb) / 255.;    // color normalization for texture2D\n    c.y = float(lsb) / 255.;\n\n    if(v >= 2048.){\n        c.y = 1.;\n    }\n\n    return c;\n}\n\nfloat decode16BitFloatFrom2xUInt8(vec2 c){\n    float v = 0.;\n\n    int ix = int(c.x*255.); // 1st byte: 1 bit signum, 4 bits exponent, 3 bits mantissa (MSB)\n    int iy = int(c.y*255.); // 2nd byte: 8 bit mantissa (LSB)\n\n    int s = (c.x >= 0.5) ? 1 : -1;\n    ix = (s > 0) ? ix - 128 : ix;   // remove the signum bit from exponent\n    int iexp = ix / 8;              // cut off the last 3 bits of the mantissa to select the 4 exponent bits\n    int msb = ix - iexp * 8;        // subtract the exponent bits to select the 3 most significant bits of the mantissa\n\n    int norm = (iexp == 0) ? 0 : 2048;          // distinguish between normalized and subnormalized numbers\n    int mantissa = norm + msb * 256 + iy;       // implicite preceding 1 or 0 added here\n    norm = (iexp == 0) ? 1 : 0;                 // normalization toggle\n    float exponent = pow( 2., float(iexp + norm) - 16.); // -5 for the the exponent bias from 2^-5 to 2^10 plus another -11 for the normalized 12 bit mantissa \n    v = float( s * mantissa ) * exponent;\n\n    return v;\n}\n\n\n// TODO : Encoding Float32 to 4x UInt8\n// http://concord-consortium.github.io/lab/experiments/webgl-gpgpu/script.js\n// http://ultraist.hatenablog.com/entry/20110608/1307539319\n\n');class as$1 extends Ba$1{constructor(t,e){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("StandardSurfaceGeomDataShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying float v_drawItemID;\nvarying vec3 v_worldPos;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  v_drawItemId = float(drawItemId);\n  v_geomItemData = getInstanceData(drawItemId);\n\n  vec4 pos = vec4(positions, 1.);\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  vec4 viewPos = modelViewMatrix * pos;\n  gl_Position = projectionMatrix * viewPos;\n\n  v_viewPos = -viewPos.xyz;\n\n  v_drawItemID = float(getDrawItemId());\n  \n  v_worldPos      = (modelMatrix * pos).xyz;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("StandardSurfaceGeomDataShader.fragmentShader",'\nprecision highp float;\n\n<%include file="drawItemTexture.glsl"/>\n<%include file="cutaways.glsl"/>\n<%include file="GLSLBits.glsl"/>\n\nuniform int floatGeomBuffer;\nuniform int passId;\n\nuniform color cutColor;\nvec4 getCutaway(int id) {\n    return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 5);\n}\n\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying float v_drawItemID;\nvarying vec3 v_worldPos;\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n  int drawItemId = int(v_drawItemId + 0.5);\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n  int flags = int(v_geomItemData.r + 0.5);\n  // Cutaways\n  if(testFlag(flags, GEOMITEM_FLAG_CUTAWAY)) {\n      vec4 cutAwayData   = getCutaway(drawItemId);\n      vec3 planeNormal = cutAwayData.xyz;\n      float planeDist = cutAwayData.w;\n      if(cutaway(v_worldPos, planeNormal, planeDist)){\n          discard;\n          return;\n      }\n      else if(!gl_FrontFacing){\n          fragColor = cutColor;\n  #ifndef ENABLE_ES3\n          gl_FragColor = fragColor;\n  #endif\n          return;\n      }\n  }\n\n    float dist = length(v_viewPos);\n\n    if(floatGeomBuffer != 0) {\n        fragColor.r = float(passId); \n        fragColor.g = float(v_drawItemID);\n        fragColor.b = 0.0;// TODO: store poly-id or something.\n        fragColor.a = dist;\n    }\n    else {\n        ///////////////////////////////////\n        // UInt8 buffer\n        fragColor.r = (mod(v_drawItemID, 256.) + 0.5) / 255.;\n        fragColor.g = (floor(v_drawItemID / 256.) + 0.5) / 255.;\n\n\n        // encode the dist as a 16 bit float\n        vec2 float16bits = encode16BitFloatInto2xUInt8(dist);\n        fragColor.b = float16bits.x;\n        fragColor.a = float16bits.y;\n    }\n\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n')}}J$1.registerClass("StandardSurfaceGeomDataShader",as$1);class is$1 extends Ba$1{constructor(t,e){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("StandardSurfaceSelectedGeomsShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\nvarying float v_drawItemId;\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n    v_drawItemId = float(drawItemId);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos = modelViewMatrix * vec4(positions, 1.0);\n    gl_Position = projectionMatrix * viewPos;\n\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("StandardSurfaceSelectedGeomsShader.fragmentShader",'\nprecision highp float;\n\nvarying float v_drawItemId;\n\n\n<%include file="drawItemTexture.glsl"/>\n\n#ifdef ENABLE_FLOAT_TEXTURES\nvec4 getHighlightColor(int id) {\n  return fetchTexel(instancesTexture, instancesTextureSize, (id * pixelsPerItem) + 4);\n}\n#else\n\nuniform vec4 highlightColor;\n\nvec4 getHighlightColor() {\n    return highlightColor;\n}\n\n#endif\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    int drawItemId = int(v_drawItemId + 0.5);\n    fragColor = getHighlightColor(drawItemId);\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n')}}J$1.registerClass("StandardSurfaceSelectedGeomsShader",is$1);class ss$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("HandleShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform int maintainScreenSize;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n\n  if(maintainScreenSize != 0) {\n    float dist = modelViewMatrix[3][2];\n    float sc = dist;\n    mat4 scmat = mat4(\n      sc, 0.0, 0.0, 0.0,\n      0.0, sc, 0.0, 0.0,\n      0.0, 0.0, sc, 0.0,\n      0.0, 0.0, 0.0, 1.0\n    );\n    modelViewMatrix = modelViewMatrix * scmat;\n  }\n\n  vec4 viewPos = modelViewMatrix * vec4(positions, 1.0);\n  gl_Position = projectionMatrix * viewPos;\n\n  v_viewPos = viewPos.xyz;\n  v_textureCoord = texCoords;\n  v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("HandleShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color BaseColor;\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n#endif\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor = BaseColor;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = baseColor;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"maintainScreenSize",defaultValue:0}),t}static isOverlay(){return!0}static getGeomDataShaderName(){return"HandleGeomDataShader"}}J$1.registerClass("HandleShader",ss$1);class ns$1 extends as$1{constructor(t,e){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("HandleGeomDataShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform int maintainScreenSize;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n\nvarying float v_drawItemId;\nvarying vec4 v_geomItemData;\nvarying vec3 v_viewPos;\nvarying float v_drawItemID;\nvarying vec3 v_worldPos;\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n  mat4 modelMatrix = getModelMatrix(drawItemId);\n  mat4 modelViewMatrix = viewMatrix * modelMatrix;\n  \n  if(maintainScreenSize != 0) {\n    float dist = modelViewMatrix[3][2];\n    float sc = dist;\n    mat4 scmat = mat4(\n      sc, 0.0, 0.0, 0.0,\n      0.0, sc, 0.0, 0.0,\n      0.0, 0.0, sc, 0.0,\n      0.0, 0.0, 0.0, 1.0\n    );\n    modelViewMatrix = modelViewMatrix * scmat;\n  }\n\n  vec4 viewPos = modelViewMatrix * vec4(positions, 1.0);\n  gl_Position = projectionMatrix * viewPos;\n\n  v_viewPos = -viewPos.xyz;\n\n  v_drawItemID = float(getDrawItemId());\n}\n')}}J$1.registerClass("HandleGeomDataShader",ns$1);class ls$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("TransparentSurfaceShader.vertexShader",'\nprecision highp float;\n\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="stack-gl/inverse.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\nvoid main(void) {\n    int drawItemId = getDrawItemId();\n\n    vec4 geomItemData = getInstanceData(drawItemId);\n\n    vec4 pos = vec4(positions, 1.);\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n    mat4 modelViewMatrix = viewMatrix * modelMatrix;\n    vec4 viewPos    = modelViewMatrix * pos;\n    gl_Position     = projectionMatrix * viewPos;\n\n    // mat4 mvp = projectionMatrix * viewMatrix * modelMatrix;\n    // gl_Position = mvp * vec4((lightmapCoords + geomItemData.xy), 0., 1.);\n\n    v_worldPos      = (modelMatrix * pos).xyz;\n\n    mat3 normalMatrix = mat3(transpose(inverse(modelViewMatrix)));\n    v_viewPos       = -viewPos.xyz;\n    v_viewNormal    = normalMatrix * normals;\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("TransparentSurfaceShader.fragmentShader",'\nprecision highp float;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n<%include file="stack-gl/gamma.glsl"/>\n#endif\n<%include file="GLSLUtils.glsl"/>\n\n/* VS Outputs */\nvarying vec3 v_viewPos;\nvarying vec3 v_viewNormal;\n\nvarying vec3 v_worldPos;\n/* VS Outputs */\n\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\nuniform float exposure;\n#endif\n\nuniform mat4 cameraMatrix;\nuniform float planeDist;\nuniform float planeAngle;\n\nuniform color BaseColor;\nuniform float Opacity;\n\n#ifdef ENABLE_SPECULAR\n<%include file="math/constants.glsl"/>\n<%include file="GGX_Specular.glsl"/>\n<%include file="PBRSurfaceRadiance.glsl"/>\nuniform float Roughness;\nuniform float Metallic;\nuniform float Reflectance;\n#endif\n\n#ifdef __ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform bool BaseColorTexType;\n\nuniform sampler2D OpacityTex;\nuniform bool OpacityTexType;\n\nuniform sampler2D RoughnessTex;\nuniform bool RoughnessTexType;\n\nuniform sampler2D ReflectanceTex;\nuniform bool ReflectanceTexType;\n\nuniform sampler2D NormalTex;\nuniform bool NormalTexType;\nuniform float NormalScale;\n\n\n#endif\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n    MaterialParams material;\n\n#ifndef __ENABLE_TEXTURES\n    material.baseColor      = BaseColor.rgb;\n    float opacity           = Opacity;\n\n#ifdef ENABLE_SPECULAR\n    material.roughness      = Roughness;\n    material.metallic       = Metallic;\n    material.reflectance    = Reflectance;\n#endif\n\n#else\n    // Planar YZ projection for texturing, repeating every meter.\n    // vec2 texCoord        = v_worldPos.xz * 0.2;\n    vec2 texCoord           = vec2(v_textureCoord.x, 1.0 - v_textureCoord.y);\n    material.baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, texCoord).rgb;\n    material.roughness      = getLuminanceParamValue(Roughness, RoughnessTex, RoughnessTexType, texCoord);\n    material.metallic       = getLuminanceParamValue(Metallic, MetallicTex, MetallicTexType, texCoord);\n    material.reflectance    = Reflectance;//getLuminanceParamValue(Reflectance, ReflectanceTex, ReflectanceTexType, texCoord);\n\n    float opacity           = getLuminanceParamValue(Opacity, OpacityTex, OpacityTexType, texCoords);\n#endif\n\n#ifndef ENABLE_SPECULAR\n    gl_FragColor = vec4(material.baseColor.rgb, opacity);\n#else\n\n    vec3 viewNormal = normalize(v_viewNormal);\n    //vec3 surfacePos = -v_viewPos;\n\n#ifdef __ENABLE_TEXTURES\n    if(NormalTexType != 0){\n        vec3 textureNormal_tangentspace = normalize(texture2D(NormalTex, texCoord).rgb * 2.0 - 1.0);\n        viewNormal = normalize(mix(viewNormal, textureNormal_tangentspace, 0.3));\n    }\n#endif\n\n    vec3 viewVector = normalize(mat3(cameraMatrix) * normalize(v_viewPos));\n    vec3 normal = normalize(mat3(cameraMatrix) * viewNormal);\n    if(dot(normal, viewVector) < 0.0){\n        normal = -normal;\n        // Note: this line can be used to debug inverted meshes.\n        //material.baseColor = vec3(1.0, 0.0, 0.0);\n    }\n\n    vec4 specularReflectance = pbrSpecularReflectance(material, normal, viewVector);\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(specularReflectance.rgb, mix(opacity, 1.0, specularReflectance.a));\n\n#endif\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb * exposure);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t.push({name:"Opacity",defaultValue:1,range:[0,1]}),t.push({name:"Roughness",defaultValue:.85}),t.push({name:"Reflectance",defaultValue:1e-4}),t}static getGeomDataShaderName(){return"StandardSurfaceGeomDataShader"}static getSelectedShaderName(){return"StandardSurfaceSelectedGeomsShader"}static isTransparent(){return!0}bind(t,e){return"ADD"==t.pass&&super.bind(t,e)}}J$1.registerClass("TransparentSurfaceShader",ls$1);class rs$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("ScreenSpaceShader.vertexShader",'\nprecision highp float;\n\nattribute vec3 positions;\n#ifdef ENABLE_TEXTURES\nattribute vec2 texCoords;\n#endif\n\n<%include file="stack-gl/transpose.glsl"/>\n<%include file="drawItemId.glsl"/>\n<%include file="drawItemTexture.glsl"/>\n<%include file="modelMatrix.glsl"/>\n\n/* VS Outputs */\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\nvoid main(void) {\n  int drawItemId = getDrawItemId();\n    mat4 modelMatrix = getModelMatrix(drawItemId);\n\n    gl_Position = (modelMatrix * vec4(positions, 1.0));\n\n    v_textureCoord = texCoords;\n    v_textureCoord.y = 1.0 - v_textureCoord.y;// Flip y\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("ScreenSpaceShader.fragmentShader",'\nprecision highp float;\n\n<%include file="stack-gl/gamma.glsl"/>\n<%include file="materialparams.glsl"/>\n\nuniform color BaseColor;\n\n#ifdef ENABLE_TEXTURES\nuniform sampler2D BaseColorTex;\nuniform int BaseColorTexType;\n#endif\n\n/* VS Outputs */\n#ifdef ENABLE_TEXTURES\nvarying vec2 v_textureCoord;\n#endif\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_TEXTURES\n    vec4 baseColor = BaseColor;\n#else\n    vec4 baseColor      = getColorParamValue(BaseColor, BaseColorTex, BaseColorTexType, v_textureCoord);\n#endif\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n    fragColor = baseColor;\n\n#ifdef ENABLE_INLINE_GAMMACORRECTION\n    fragColor.rgb = toGamma(fragColor.rgb);\n#endif\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n'),this.finalize()}static isOverlay(){return!0}static getParamDeclarations(){const t=super.getParamDeclarations();return t.push({name:"BaseColor",defaultValue:new y$3(1,1,.5)}),t}static getGeomDataShaderName(){return null}static getSelectedShaderName(){return null}}J$1.registerClass("ScreenSpaceShader",rs$1);class os$1 extends Ei$1{constructor(t){super(t),this.invisibleToGeomBuffer=!0}}J$1.registerClass("ToolIconShader",os$1);class ds$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("UnpackLDRAlphaImageShader.vertexShader",'\nprecision highp float;\n\n<%include file="utils/quadVertexFromID.glsl"/>\n\n/* VS Outputs */\nvarying vec2 v_texCoord;\n \nvoid main()\n{\n    vec2 position = getQuadVertexPositionFromID();\n    v_texCoord = position+0.5;\n    gl_Position = vec4(position*2.0, 0.0, 1.0);\n}\n'),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("UnpackLDRAlphaImageShader.fragmentShader","\nprecision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D ldrSampler;\nuniform sampler2D alphaSampler;\n\nfloat luminanceFromRGB(vec3 rgb) {\n    return 0.2126*rgb.r + 0.7152*rgb.g + 0.0722*rgb.b;\n}\n\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n\n#ifndef ENABLE_ES3\n    vec4 fragColor;\n#endif\n\n    fragColor = vec4(texture2D(ldrSampler, v_texCoord).rgb, luminanceFromRGB(texture2D(alphaSampler, v_texCoord).rgb));\n\n#ifndef ENABLE_ES3\n    gl_FragColor = fragColor;\n#endif\n}\n\n")}}class hs$1 extends Ba$1{constructor(t){super(t),this.__shaderStages.VERTEX_SHADER=Ha$1.parseShader("WireShader.vertexShader","\nprecision highp float;\n\nattribute vec3 positions;    //(location = 0)\n\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\n\n/* VS Outputs */\n\nvoid main(void) {\n    mat4 modelViewProjectionMatrix = projectionMatrix * viewMatrix * modelMatrix;\n    gl_Position = modelViewProjectionMatrix * vec4(positions, 1.0);\n\n    // Apply the perspective transform, and then move the vertices\n    //  towards the camera by a tiny little bit...\n    gl_Position.z -= 0.001 / gl_Position.w;\n    //gl_Position.z *= 0.999;\n}\n"),this.__shaderStages.FRAGMENT_SHADER=Ha$1.parseShader("WireShader.fragmentShader","\nprecision highp float;\n\nuniform color wireColor;\n\n#ifdef ENABLE_ES3\n    out vec4 fragColor;\n#endif\nvoid main(void) {\n#ifdef ENABLE_ES3\n    gl_FragColor = color;\n#else\n    fragColor = color;\n#endif  \n}\n")}}const cs$1=0,ms$3=1,us$1=2,bs$1=3;class ps$1{constructor(t,e,i,n,s=null){this.gl=t,this.geomItem=e,this.glGeom=i,this.id=n,this.flags=s,this.visible=this.geomItem.getVisible(),this.culled=!1,this.lightmapName=e.getLightmapName(),this.updated=new C$1,this.visibilityChanged=new C$1,this.highlightChanged=e.highlightChanged,this.updateVisibility=this.updateVisibility.bind(this),this.updateVisibility=this.updateVisibility.bind(this),this.destroy=this.destroy.bind(this),this.updateXfo=t.floatTexturesSupported?()=>{this.updated.emit(cs$1)}:()=>{this.updateGeomMatrix()},this.geomItem.geomXfoChanged.connect(this.updateXfo),this.geomItem.visibilityChanged.connect(this.updateVisibility),this.geomItem.cutAwayChanged.connect(()=>{this.updated.emit(cs$1)}),this.highlightChangedId=this.geomItem.highlightChanged.connect(()=>{this.updated.emit(bs$1)}),this.glGeom.updated.connect(()=>{this.updated.emit(ms$3)});const o=this.geomItem.getLightmapCoordsOffset();this.geomData=[o.x,o.y,0,0]}getGeomItem(){return this.geomItem}getGLGeom(){return this.glGeom}getVisible(){return this.geomItem.getVisible()}getId(){return this.id}getFlags(){return this.flags}updateVisibility(){const t=this.geomItem.getVisible()&&!this.culled;this.visible!=t&&(this.visible=t,this.visibilityChanged.emit(t),this.updated.emit())}setCullState(t){this.culled=t,this.updateVisibility()}updateGeomMatrix(){this.modelMatrixArray=this.geomItem.getGeomMat4().asArray()}getGeomMatrixArray(){return this.modelMatrixArray}bind(t){const e=this.gl,i=t.unifs;if(!e.floatTexturesSupported){const t=i.modelMatrix;t&&e.uniformMatrix4fv(t.location,!1,this.modelMatrixArray);const n=i.drawItemData;n&&e.uniform4f(n.location,this.geomData)}const n=i.transformIndex;if(n&&e.uniform1i(n.location,this.id),t.lightmaps&&i.lightmap&&t.boundLightmap!=this.lightmapName){const n=t.lightmaps[this.lightmapName];n&&n.glimage.isLoaded()?(n.glimage.bindToUniform(t,i.lightmap),e.uniform2fv(i.lightmapSize.location,n.atlasSize.asArray()),i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!0),t.boundLightmap=this.lightmapName):i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!1)}return!0}destroy(){this.geomItem.visibilityChanged.disconnect(this.updateVisibility),this.geomItem.geomXfoChanged.disconnect(this.updateXfo),this.geomItem.highlightChanged.disconnectId(this.highlightChangedId)}}class gs$1 extends Mi$1{constructor(){super(),this.__drawItems=[void 0],this.__drawItemsIndexFreeList=[],this.__dirtyItemIndices=[]}init(t,e){super.init(t,e),this.__renderer.registerPass(t=>{if(t instanceof oa$1){if(t.getMetadata("glgeomItem"))return!1;{const e=e=>!!this.filterGeomItem(e)&&(null==t.getGeometry()?t.geomAssigned.connect(()=>{this.addGeomItem(e)}):this.addGeomItem(e),!0);return null==t.getMaterial()?(console.warn("Scene item :"+t.getPath()+" has no material"),!1):e(t)}}return!1},t=>!!(t instanceof oa$1&&t.getMetadata("glgeomItem"))&&this.removeGeomItem(t))}filterGeomItem(t){return!0}addShader(t){return this.__renderer.getOrCreateShader(t.getShaderName())}constructShaders(t){let e,i;const n=this.__renderer.getOrCreateShader(t);return n.constructor.getGeomDataShaderName()&&(e=this.__renderer.getOrCreateShader(n.constructor.getGeomDataShaderName())),n.constructor.getSelectedShaderName()&&(i=this.__renderer.getOrCreateShader(n.constructor.getSelectedShaderName())),{glshader:n,glgeomdatashader:e,glselectedshader:i}}addMaterial(t){let e=t.getMetadata("glmaterial");if(e)return e;const i=this.__renderer.getOrCreateShader(t.getShaderName());return e=new ii$1(this.__gl,t,i),e.updated.connect(()=>{this.__renderer.requestRedraw()}),t.setMetadata("glmaterial",e),e}addGeom(t){let e=t.getMetadata("glgeom");if(e)return e.addRef(this),e;const i=this.__gl;if(t instanceof Yt$1||t instanceof Ut$1)e=new Ua$1(i,t);else if(t instanceof Nt$1||t instanceof zt$1)e=new Ja$1(i,t);else{if(!(t instanceof Ct$1||t instanceof wt$1))throw new Error("Unsupported geom type:"+t.constructor.name);e=new Pa$1(i,t)}return t.setMetadata("glgeom",e),e.addRef(this),e}removeGeom(t){let e=t.getMetadata("glgeom");if(e)return e.removeRef(this),e}addGeomItem(t){const e=this.addGeom(t.getGeometry());let i;this.__drawItemsIndexFreeList.length>0?i=this.__drawItemsIndexFreeList.pop():(i=this.__drawItems.length,this.__drawItems.push(null)),this.__dirtyItemIndices.push(i);const n=new ps$1(this.__gl,t,e,i,1);return t.setMetadata("glgeomItem",n),n.updated.connect(t=>{switch(t){case cs$1:if(-1!=this.__dirtyItemIndices.indexOf(i))return;this.__dirtyItemIndices.push(i);break;case ms$3:case us$1:break;case bs$1:if(-1!=this.__dirtyItemIndices.indexOf(i))return;return this.__dirtyItemIndices.push(i),void this.__renderer.requestRedraw()}this.__renderer.drawItemChanged()}),this.__drawItems[i]=n,this.__renderer.requestRedraw(),t.setMetadata("glpass",this),n}removeGeomItem(t){if(t.getMetadata("glpass")!=this)return;const e=t.getMetadata("glgeomItem"),i=e.getId();return this.__drawItems[i]=null,this.__drawItemsIndexFreeList.push(i),this.__renderer.requestRedraw(),t.getMetadata("glpass"),t.deleteMetadata("glgeomItem"),e}removeGLGeom(t,e){const i=e.geomItemMappings.indexOf(t);e.geomItemMappings.splice(i,1)}getGeomItem(t){if(!(t>=this.__drawItems.length))return this.__drawItems[t];console.warn("Invalid Draw Item id:"+t+" NumItems:"+(this.__drawItems.length-1))}__populateDrawItemDataArray(t,e,i){const n=24*e;let s=0;t.isCutawayEnabled()&&(s|=1);const o=t.getLightmapCoordsOffset();G$1.createFromFloat32Buffer(i.buffer,n+0).set(s,0,o.x,o.y);const r=t.getGeomMat4(),a=G$1.createFromFloat32Buffer(i.buffer,n+4),l=G$1.createFromFloat32Buffer(i.buffer,n+8),c=G$1.createFromFloat32Buffer(i.buffer,n+12);a.set(r.xAxis.x,r.yAxis.x,r.zAxis.x,r.translation.x),l.set(r.xAxis.y,r.yAxis.y,r.zAxis.y,r.translation.y),c.set(r.xAxis.z,r.yAxis.z,r.zAxis.z,r.translation.z);const h=G$1.createFromFloat32Buffer(i.buffer,n+16);if(t.isHighlighted()){const e=t.getHighlight();h.set(e.r,e.g,e.b,e.a)}const d=G$1.createFromFloat32Buffer(i.buffer,n+20);if(t.isCutawayEnabled()){const e=t.getCutVector(),i=t.getCutDist();d.set(e.x,e.y,e.z,i)}}newItemsReadyForLoading(){return this.__dirtyItemIndices.length>0}uploadGeomItems(){const t=this.__gl;if(!t.floatTexturesSupported){const t=this.__dirtyItemIndices.length;for(let e=0;e<t;e++){const t=this.__drawItems[this.__dirtyItemIndices[e]];t&&t.updateGeomMatrix()}return void(this.__dirtyItemIndices=[])}let e=Math.round(Math.sqrt(6*this.__drawItems.length)+.5);e=Math.nextPow2(e),e%6!=0&&(e+=6-e%6),this.__drawItemsTexture?this.__drawItemsTexture.width!=e&&(this.__drawItemsTexture.resize(e,e),this.__dirtyItemIndices=Array(e*e/6).fill().map((t,e)=>e)):(this.__drawItemsTexture=new Na$1(t,{format:"RGBA",type:"FLOAT",width:e,height:e,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1}),this.__drawItemsTexture.clear()),t.bindTexture(t.TEXTURE_2D,this.__drawItemsTexture.glTex);const i=this.__drawItemsTexture.getTypeID();for(let n=0;n<this.__dirtyItemIndices.length;n++){const s=this.__dirtyItemIndices[n],o=Math.floor(6*s/e);let r=s+1;for(let t=n+1;t<this.__dirtyItemIndices.length;t++){const i=this.__dirtyItemIndices[t];if(Math.floor(6*i/e)!=o)break;if(i!=r)break;r++}const a=r-s,l=6*s%e,c=6*a,h=1,d=new Float32Array(24*a);for(let t=s;t<r;t++){const e=this.__drawItems[t];e&&this.__populateDrawItemDataArray(e.getGeomItem(),t-s,d)}if(i==t.FLOAT)this.__drawItemsTexture.populate(d,c,h,l,o,!1);else{const t=Math.convertFloat32ArrayToUInt16Array(d);this.__drawItemsTexture.populate(t,c,h,l,o,!1)}n+=a-1}this.__dirtyItemIndices=[]}finalize(){0!=this.__dirtyItemIndices.length&&this.uploadGeomItems()}bind(t){const e=this.__gl,i=t.unifs;return this.__drawItemsTexture&&i.instancesTexture&&(this.__drawItemsTexture.bindToUniform(t,i.instancesTexture),e.uniform1i(i.instancesTextureSize.location,this.__drawItemsTexture.width)),!0}bindShader(t,e){return!!e.bind(t)&&!!this.bind(t)}bindMaterial(t,e,i){return e.bind(t,i)}}class _s$1{constructor(t,e){this.gl=t,this.glgeom=e,this.glgeomItems=[],this.glgeomItems_freeIndices=[],this.glgeomItemSignalIds=[],this.drawIdsArray=null,this.drawIdsBuffer=null,this.drawIdsBufferDirty=!0,this.highlightedIdsArray=null,this.highlightedIdsBuffer=null,this.highlightedIdsBufferDirty=!0,this.lightmapName=void 0,this.drawCountChanged=new C$1,this.visibleItems=[],this.highlightedItems=[]}getGLGeom(){return this.glgeom}getLightmapName(){return this.lightmapName}getDrawCount(){return this.visibleItems.length}addGeomItem(t){let e;this.glgeomItems_freeIndices.length>0?e=this.glgeomItems_freeIndices.pop():(e=this.glgeomItems.length,this.glgeomItems.push(null)),t.visible&&(this.visibleItems.push(e),this.drawCountChanged.emit(1)),t.getGeomItem().isHighlighted()&&(this.highlightedItems.push(e),this.highlightedIdsBufferDirty=!0),1==this.glgeomItems.length&&(this.lightmapName=t.getGeomItem().getLightmapName());const i={};i.sel=t.highlightChanged.connect(()=>{if(t.getGeomItem().isHighlighted()){if(-1!=this.highlightedItems.indexOf(e))return;this.highlightedItems.push(e)}else this.highlightedItems.splice(this.highlightedItems.indexOf(e),1);this.highlightedIdsBufferDirty=!0}),i.vis=t.visibilityChanged.connect(t=>{t?(this.visibleItems.push(e),this.drawCountChanged.emit(1)):(this.visibleItems.splice(this.visibleItems.indexOf(e),1),this.drawCountChanged.emit(-1)),this.drawIdsBufferDirty=!0}),this.glgeomItems[e]=t,this.glgeomItemSignalIds[e]=i,this.drawIdsBufferDirty=!0}removeGeomItem(t){const e=this.glgeomItems.indexOf(t),i=this.glgeomItemSignalIds[e];t.highlightChanged.disconnectId(i.sel),t.visibilityChanged.disconnectId(i.vis),this.glgeomItems[e]=null,this.glgeomItemSignalIds[e]=null,this.glgeomItems_freeIndices.push(e),t.visible&&(this.visibleItems.splice(this.visibleItems.indexOf(e),1),this.drawCountChanged.emit(-1)),t.getGeomItem().isHighlighted()&&this.highlightedItems.splice(this.highlightedItems.indexOf(e),1),this.drawIdsBufferDirty=!0,0==this.glgeomItems.length&&this.destroy()}updateDrawIDsBuffer(){const t=this.gl;t.floatTexturesSupported?(this.drawIdsBuffer&&this.glgeomItems.length!=this.drawIdsArray.length&&(this.gl.deleteBuffer(this.drawIdsBuffer),this.drawIdsBuffer=null),this.drawIdsBuffer||(this.drawIdsArray=new Float32Array(this.glgeomItems.length),this.drawIdsBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.drawIdsBuffer)),this.visibleItems.forEach((t,e)=>{this.drawIdsArray[e]=this.glgeomItems[t].getId()}),t.bindBuffer(t.ARRAY_BUFFER,this.drawIdsBuffer),t.bufferData(t.ARRAY_BUFFER,this.drawIdsArray,t.STATIC_DRAW),this.drawIdsBufferDirty=!1):this.drawIdsBufferDirty=!1}updateHighlightedIDsBuffer(){const t=this.gl;t.floatTexturesSupported?(this.highlightedIdsBuffer&&this.glgeomItems.length!=this.highlightedIdsArray.length&&(this.gl.deleteBuffer(this.highlightedIdsBuffer),this.highlightedIdsBuffer=null),(!this.highlightedIdsArray||this.highlightedItems.length>this.highlightedIdsArray.length)&&(this.highlightedIdsArray=new Float32Array(this.highlightedItems.length),this.highlightedIdsBuffer&&(t.deleteBuffer(this.highlightedIdsBuffer),this.highlightedIdsBuffer=null)),this.highlightedItems.forEach((t,e)=>{this.highlightedIdsArray[e]=this.glgeomItems[t].getId()}),this.highlightedIdsBuffer||(this.highlightedIdsBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.highlightedIdsBuffer),t.bufferData(t.ARRAY_BUFFER,this.highlightedIdsArray,t.STATIC_DRAW),this.highlightedIdsBufferDirty=!1):this.highlightedIdsBufferDirty=!1}draw(t){if(0==this.visibleItems.length)return;this.drawIdsBufferDirty&&this.updateDrawIDsBuffer();const e=this.gl,i=t.unifs;if(t.lightmaps&&i.lightmap&&t.boundLightmap!=this.lightmapName){const n=t.lightmaps[this.lightmapName];n&&n.glimage.isLoaded()?(n.glimage.bindToUniform(t,i.lightmap),e.uniform2fv(i.lightmapSize.location,n.atlasSize.asArray()),i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!0),t.boundLightmap=this.lightmapName):i.lightmapConnected&&e.uniform1i(i.lightmapConnected.location,!1)}this.__bindAndRender(t,this.visibleItems,this.drawIdsBuffer)}drawHighlighted(t){0!=this.highlightedItems.length&&(this.highlightedIdsBufferDirty&&this.updateHighlightedIDsBuffer(),this.__bindAndRender(t,this.highlightedItems,this.highlightedIdsBuffer))}__bindAndRender(t,e,i){const n=this.gl,s=t.unifs;if(t.glgeom!=this.glgeom&&(this.glgeom.bind(t),t.glgeom=this.glgeom),n.floatTexturesSupported&&n.drawElementsInstanced&&t.supportsInstancing){n.uniform1i(t.unifs.instancedDraw.location,1);const o=t.attrs.instancedIds.location;n.enableVertexAttribArray(o),n.bindBuffer(n.ARRAY_BUFFER,i),n.vertexAttribPointer(o,1,n.FLOAT,!1,4,0),n.vertexAttribDivisor(o,1),t.bindViewports(s,()=>{this.glgeom.drawInstanced(e.length)})}else t.unifs.instancedDraw&&n.uniform1i(t.unifs.instancedDraw.location,0),e.forEach(e=>{this.glgeomItems[e].bind(t),t.bindViewports(s,()=>{this.glgeom.draw(t)})})}destroy(){}}class Zs$1{constructor(t){this.glshader=t.glshader,this.glgeomdatashader=t.glgeomdatashader,this.glselectedshader=t.glselectedshader,this.glmaterialGeomItemSets=[]}findMaterialGeomItemSets(t){for(const e of this.glmaterialGeomItemSets)if(e.glmaterial==t)return e}addMaterialGeomItemSets(t){this.glmaterialGeomItemSets.push(t)}removeMaterialGeomItemSets(t){const e=this.glmaterialGeomItemSets.indexOf(t);this.glmaterialGeomItemSets.splice(e,1)}getMaterialGeomItemSets(){return this.glmaterialGeomItemSets}}class Gs$1{constructor(t){this.glmaterial=t,this.geomItemSets=[],this.drawCount=0,this.visibleInGeomDataBuffer=t.getMaterial().visibleInGeomDataBuffer,this.__drawCountChanged=this.__drawCountChanged.bind(this)}getGLMaterial(){return this.glmaterial}__drawCountChanged(t){this.drawCount+=t}addGeomItemSet(t){-1==this.geomItemSets.indexOf(t)?(this.geomItemSets.push(t),this.drawCount+=t.drawCount,t.drawCountChanged.connect(this.__drawCountChanged)):console.warn("geomItemSet already added to GLMaterialGeomItemSets")}removeGeomItemSet(t){const e=this.geomItemSets.indexOf(t);this.geomItemSets.splice(e,1),t.drawCountChanged.disconnect(this.__drawCountChanged),t.destroy()}findGeomItemSet(t){for(const e of this.geomItemSets)if(e.getGLGeom()==t)return e;return null}getGeomItemSets(){return this.geomItemSets}}class Xs$1 extends gs$1{constructor(){super(),this.__glshadermaterials={}}init(t,e){super.init(t,e)}filterGeomItem(t){const e=t.getMaterial().getShaderClass();if(e){if(e.isTransparent())return!1;if(e.isOverlay())return!1;const i=t.getMaterial().getParameter("BaseColor");return!(i&&i.getValue().a<1)}return!1}addGeomItem(t){const e=t.getMaterial(),i=e.getShaderName(),n=this.constructShaders(i),s=this.addMaterial(e),o=super.addGeomItem(t);let r=this.__glshadermaterials[i];r||(r=new Zs$1(n),this.__glshadermaterials[i]=r);let a=r.findMaterialGeomItemSets(s);a||(a=new Gs$1(s),r.addMaterialGeomItemSets(a));let l=a.findGeomItemSet(o.glGeom);return l||(l=new _s$1(this.__gl,o.glGeom),a.addGeomItemSet(l)),t.setMetadata("geomItemSet",l),l.addGeomItem(o),!0}removeGeomItem(t){const e=super.removeGeomItem(t);if(!e)return!1;const i=t.getMetadata("geomItemSet");return i&&(i.removeGeomItem(e),t.deleteMetadata("geomItemSet")),!0}removeMaterial(t){const e=this.__glshadermaterials[t.hash];if(!e||e!=t.getMetadata("glshaderMaterials"))return void console.warn("Material not found in pass");const i=t.getMetadata("glmaterialGeomItemSets");e.removeMaterialGeomItemSets(i)}__traverseTreeAndDraw(t){for(const e in this.__glshadermaterials){const i=this.__glshadermaterials[e],n=i.glshader;if(this.bindShader(t,n)){const e=i.getMaterialGeomItemSets();for(const i of e)if(0!=i.drawCount&&this.bindMaterial(t,i.getGLMaterial(),!0)){const e=i.getGeomItemSets();for(const i of e)i.draw(t)}}n.unbind(t)}t.glgeom&&t.glgeom.unbind(t)}draw(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0),this.__traverseTreeAndDraw(t)}drawHighlightedGeoms(t){const e=this.__gl;e.disable(e.CULL_FACE);for(const i in this.__glshadermaterials){const e=this.__glshadermaterials[i];if(!e.glselectedshader)continue;if(!this.bindShader(t,e.glselectedshader))continue;const n=e.getMaterialGeomItemSets();for(const i of n){const e=i.getGeomItemSets();for(const i of e)i.drawHighlighted(t)}}t.glgeom&&t.glgeom.unbind(t)}getGeomItemAndDist(t){let e,i;this.__gl.floatGeomBuffer?(e=Math.round(t[1]),i=t[3]):(e=t[0]+(t[1]<<8),i=Math.decode16BitFloatFrom2xUInt8([t[2],t[3]]));const n=this.__drawItems[e];if(n)return{geomItem:n.getGeomItem(),dist:i}}drawGeomData(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0);for(const i in this.__glshadermaterials){const n=this.__glshadermaterials[i];if(!n.glgeomdatashader)continue;if(!this.bindShader(t,n.glgeomdatashader))continue;{const i=t.unifs.floatGeomBuffer;i&&e.uniform1i(i.location,e.floatGeomBuffer?1:0)}{const i=t.unifs.passId;i&&e.uniform1i(i.location,this.__passIndex)}const s=n.getMaterialGeomItemSets();for(const e of s)if(0!=e.drawCount&&e.visibleInGeomDataBuffer&&this.bindMaterial(t,e.getGLMaterial(),!1)){const i=e.getGeomItemSets();for(const e of i)e.draw(t)}}t.glgeom&&t.glgeom.unbind(t)}}Yi$1.registerPass(Xs$1,Ti$1.OPAQUE);class ys$1 extends gs$1{constructor(){super()}init(t,e){super.init(t,e),this.transparentItems=[],this.freeList=[],this.visibleItems=[],this.prevSortCameraPos=new Z$1(999,999,999),this.resort=!1}filterGeomItem(t){const e=t.getMaterial().getShaderClass();if(e){if(e.isTransparent())return!0;if(e.isOverlay())return!1;const i=t.getMaterial().getParameter("BaseColor");if(i&&i.getValue().a<.999)return!0}return!1}addGeomItem(t){const e=t.getMaterial(),i=e.getShaderName(),n=this.constructShaders(i),s=this.addMaterial(e),o=super.addGeomItem(t),r=t.visibilityChanged.connect(t=>{if(t)this.visibleItems.push(l);else{const t=this.visibleItems.indexOf(l);this.visibleItems.splice(t,1)}}),a=t.geomXfoChanged.connect(()=>{this.resort=!0}),l={geomItem:t,shaders:n,glmaterial:s,glgeomitem:o,visibilityChangedId:r,geomXfoChangedId:a};let c;c=this.freeList.length>0?this.freeList.pop():this.transparentItems.length,this.transparentItems[c]=l,t.setMetadata("itemIndex",c),t.getVisible()&&this.visibleItems.push(l),this.resort=!0}removeGeomItem(t){if(!super.removeGeomItem(t))return;const e=t.getMetadata("itemIndex"),i=this.transparentItems[e];this.transparentItems[e]=null,this.freeList.push(e);const n=this.visibleItems.indexOf(i);-1!=n&&this.visibleItems.splice(n,1)}sortItems(t){for(const e of this.visibleItems){const i=e.glgeomitem.geomItem.getGeomMat4();e.dist=i.translation.distanceTo(t)}this.visibleItems.sort((t,e)=>t.dist>e.dist?-1:t.dist<e.dist?1:0),this.prevSortCameraPos=t,this.resort=!1}_drawItem(t,e,i){if(i.currentglMaterial!=e.glmaterial&&(i.currentglMaterial=e.glmaterial,!i.currentglMaterial.bind(t)))return;const n=e.glgeomitem;if((i.currentglGeom==n.glGeom||(i.currentglGeom=n.glGeom,i.currentglGeom.bind(t)))&&n.bind(t)){if(t.unifs.instancedDraw){const e=this.__gl;e.uniform1i(t.unifs.instancedDraw.location,0),e.disableVertexAttribArray(t.attrs.instancedIds.location)}t.bindViewports(t.unifs,()=>{i.currentglGeom.draw(t)})}}_drawItems(t){const e={currentglShader:null,currentglMaterial:null,currentglGeom:null};for(const i of this.visibleItems){if(e.currentglShader!=i.shaders.glshader){if(!this.bindShader(t,i.shaders.glshader))continue;e.currentglShader=i.shaders.glshader}this._drawItem(t,i,e)}e.currentglGeom&&e.currentglGeom.unbind(t)}draw(t){if(0==this.visibleItems.length)return;this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl,i=t.viewXfo.tr;(this.resort||i.distanceTo(this.prevSortCameraPos)>.3)&&this.sortItems(i),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),t.pass="MULTIPLY",e.blendFunc(e.DST_COLOR,e.ZERO),this._drawItems(t),t.pass="ADD",e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this._drawItems(t),e.disable(e.BLEND)}drawHighlightedGeoms(t){const e=this.__gl;e.disable(e.CULL_FACE);const i={currentglShader:null,currentglMaterial:null,currentglGeom:null};for(const n of this.visibleItems){if(!n.geomItem.isHighlighted())continue;if(!n.shaders.glselectedshader)continue;const e=n.shaders;if(i.currentglShader!=e.glselectedshader){if(!this.bindShader(t,e.glselectedshader))continue;i.currentglShader=e.glselectedshader}this._drawItem(t,n,i)}i.currentglGeom&&i.currentglGeom.unbind(t)}getGeomItemAndDist(t){let e,i;this.__gl.floatGeomBuffer?(e=Math.round(t[1]),i=t[3]):(e=t[0]+(t[1]<<8),i=Math.decode16BitFloatFrom2xUInt8([t[2],t[3]]));const n=this.__drawItems[e];if(n)return{geomItem:n.getGeomItem(),dist:i}}drawGeomData(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.disable(e.BLEND),e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),e.depthMask(!0);const i={currentglShader:null,currentglMaterial:null,currentglGeom:null};for(const n of this.visibleItems){const s=n.shaders;if(i.currentglShader!=s.glgeomdatashader){if(!this.bindShader(t,s.glgeomdatashader))continue;i.currentglShader=s.glgeomdatashader}{const i=t.unifs.floatGeomBuffer;i&&e.uniform1i(i.location,e.floatGeomBuffer?1:0)}{const i=t.unifs.passId;i&&e.uniform1i(i.location,this.__passIndex)}this._drawItem(t,n,i)}i.currentglGeom&&i.currentglGeom.unbind(t)}}Yi$1.registerPass(ys$1,Ti$1.TRANSPARENT);class fs$1 extends Mi$1{constructor(){super()}init(t,e){super.init(t,e),this.__billboards=[],this.__freeIndices=[],this.__drawCount=0,this.__threshold=0,this.__updateRequested=!1,this.__prevSortCameraPos=new Z$1,this.__atlas=new di$1(this.__renderer.gl,"Billboards","RGBA","UNSIGNED_BYTE",[1,1,1,0]),this.__atlas.loaded.connect(this.updated.emit),this.__atlas.updated.connect(this.updated.emit),this.__renderer.registerPass(t=>t instanceof ba$1&&(this.addBillboard(t),!0),t=>t instanceof ba$1&&(this.removeBillboard(t),!0))}filterRenderTree(){}addBillboard(t){const e=t.getParameter("Image"),i=e.getValue();if(!i)return void e.valueChanged.connect(()=>this.addBillboard(t));let n;n=this.__freeIndices.length>0?this.__freeIndices.pop():this.__billboards.length;const s=this.__atlas.addSubImage(i);t.setMetadata("GLBillboardsPass_Index",n);const o=t.visibilityChanged.connect(()=>{t.getVisible()?(this.__drawCount++,this.__updateBillboard(n)):this.__drawCount--,this.__reqUpdateIndexArray()}),r=t.getParameter("GlobalXfo").valueChanged.connect(()=>{t.getVisible()&&(this.__updateBillboard(n),this.updated.emit())}),a=t.getParameter("Alpha").valueChanged.connect(()=>{t.getVisible()&&(this.__updateBillboard(n),this.updated.emit())});t.getVisible()&&this.__drawCount++,this.__billboards[n]={billboard:t,imageIndex:s,visibilityChangedId:o,xfoChangedId:r,alphaChangedId:a},this.indexArrayUpdateNeeded=!0,this.__requestUpdate()}removeBillboard(t){const e=t.getMetadata("GLBillboardsPass_Index");if(-1==e)return void console.warn("Billboard already removed.");const i=this.__billboards[e],n=i.billboard.getParameter("Image").getValue();this.__atlas.removeSubImage(n),t.visibilityChanged.disconnectId(i.visibilityChangedId),t.getParameter("GlobalXfo").valueChanged.disconnectId(i.xfoChangedId),t.getParameter("Alpha").valueChanged.disconnectId(i.alphaChangedId),this.__billboards[e]=null,this.__freeIndices.push(e),t.getVisible()&&this.__drawCount--,this.indexArrayUpdateNeeded=!0,this.__requestUpdate()}__populateBillboardDataArray(t,e,i){const n=t.billboard,s=n.getGlobalXfo().toMat4(),o=1/n.getParameter("PixelsPerMeter").getValue();let r=0;n.getParameter("AlignedToCamera").getValue()&&(r|=4);const a=n.getParameter("Alpha").getValue(),l=n.getParameter("Color").getValue(),c=5*e*4,h=G$1.createFromFloat32Buffer(i.buffer,c),d=G$1.createFromFloat32Buffer(i.buffer,c+4),u=G$1.createFromFloat32Buffer(i.buffer,c+8),m=G$1.createFromFloat32Buffer(i.buffer,c+12);h.set(s.xAxis.x,s.yAxis.x,s.zAxis.x,s.translation.x),d.set(s.xAxis.y,s.yAxis.y,s.zAxis.y,s.translation.y),u.set(s.xAxis.z,s.yAxis.z,s.zAxis.z,s.translation.z),m.set(o,r,t.imageIndex,a),G$1.createFromFloat32Buffer(i.buffer,c+16).set(l.r,l.g,l.b,l.a)}__requestUpdate(){this.__updateRequested||(this.__updateRequested=!0,setTimeout(()=>{this.__updateBillboards()},100))}__reqUpdateIndexArray(){this.indexArrayUpdateNeeded||(this.indexArrayUpdateNeeded=!0,this.updateIndexArrayId=setTimeout(()=>{this.indexArrayUpdateNeeded&&(this.__updateIndexArray(),this.updated.emit())},1))}__updateIndexArray(){const t=this.__gl;this.__indexArray&&this.__indexArray.length!=this.__drawCount&&(t.deleteBuffer(this.__instanceIdsBuffer),this.__instanceIdsBuffer=null),this.__indexArray=new Float32Array(this.__drawCount);let e=0;for(let i=0;i<this.__billboards.length;i++)this.__billboards[i]&&this.__billboards[i].billboard.getVisible()&&(this.__indexArray[e]=i,e++);this.__instanceIdsBuffer||(this.__instanceIdsBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.__instanceIdsBuffer),t.bufferData(t.ARRAY_BUFFER,this.__indexArray,t.STATIC_DRAW),this.indexArrayUpdateNeeded=!1}__updateBillboards(){const t=()=>{this.indexArrayUpdateNeeded&&this.__updateIndexArray();const t=this.__gl;if(!this.__glshader){t.__quadVertexIdsBuffer||t.setupInstancedQuad(),this.__glshader=new Ki$1(t);const e=this.__glshader.compileForTarget("GLBillboardsPass",this.__renderer.getShaderPreproc());this.__shaderBinding=wa$1(t,e.attrs,t.__quadattrbuffers,t.__quadIndexBuffer)}if(this.__atlas.renderAtlas(),!t.floatTexturesSupported||!t.drawElementsInstanced)return this.__modelMatrixArray=[],this.__billboardDataArray=[],this.__tintColorArray=[],this.__indexArray.forEach(t=>{const e=this.__billboards[t],i=e.billboard,n=i.getGlobalXfo().toMat4(),s=1/i.getParameter("PixelsPerMeter").getValue();let o=0;i.getParameter("AlignedToCamera").getValue()&&(o|=4);const r=i.getParameter("Alpha").getValue(),a=i.getParameter("Color").getValue();this.__modelMatrixArray[t]=n.asArray(),this.__billboardDataArray[t]=[s,o,e.imageIndex,r],this.__tintColorArray[t]=[a.r,a.g,a.b,a.a]}),void(this.__updateRequested=!1);let e=Math.round(Math.sqrt(5*(this.__billboards.length-this.__freeIndices.length))+.5);e%5!=0&&(e+=5-e%5),this.__width=e,this.__drawItemsTexture?this.__drawItemsTexture.resize(e,e):(this.__drawItemsTexture=new Na$1(t,{format:"RGBA",type:"FLOAT",width:e,height:e,filter:"NEAREST",wrap:"CLAMP_TO_EDGE",mipMapped:!1}),this.__drawItemsTexture.clear()),this.__indexArray.forEach(t=>{-1!=t&&this.__updateBillboard(t)}),this.__updateRequested=!1};this.__atlas.isLoaded()?t():this.__atlas.loaded.connect(t)}__updateBillboard(t){if(0==this.__drawCount||!this.__drawItemsTexture)return;const e=this.__billboards[t];if(!e.billboard.getVisible())return;const i=this.__gl,n=new Float32Array(20);this.__populateBillboardDataArray(e,0,n),i.bindTexture(i.TEXTURE_2D,this.__drawItemsTexture.glTex);const s=5*t%this.__width,o=Math.floor(5*t/this.__width),r=this.__drawItemsTexture.getType(),a=this.__drawItemsTexture.getFormat();if("FLOAT"==r)i.texSubImage2D(i.TEXTURE_2D,0,s,o,5,1,i[a],i[r],n);else{const t=Math.convertFloat32ArrayToUInt16Array(n);i.texSubImage2D(i.TEXTURE_2D,0,s,o,5,1,i[a],i[r],t)}}sort(t){for(const i of this.__billboards)i&&i.billboard.getVisible()&&(i.dist=i.billboard.getGlobalXfo().tr.distanceTo(t));this.__indexArray.sort((t,e)=>-1==t?1:-1==e||this.__billboards[t].dist>this.__billboards[e].dist?-1:this.__billboards[t].dist<this.__billboards[e].dist?1:0);const e=this.__gl;e.floatTexturesSupported&&this.__instanceIdsBuffer&&(e.bindBuffer(e.ARRAY_BUFFER,this.__instanceIdsBuffer),e.bufferData(e.ARRAY_BUFFER,this.__indexArray,e.STATIC_DRAW))}draw(t){if(0==this.__drawCount||!this.__atlas.isReady()||this.__updateRequested)return;this.indexArrayUpdateNeeded&&this.__updateIndexArray();const e=this.__gl;e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA);const i=t.viewXfo.tr;if(i.distanceTo(this.__prevSortCameraPos)>this.__threshold)if(this.sort(i),this.__prevSortCameraPos=i.clone(),this.__drawCount>1){const t=this.__billboards[this.__indexArray[0]].billboard.getGlobalXfo().tr,e=this.__billboards[this.__indexArray[1]].billboard.getGlobalXfo().tr;this.__threshold=t.distanceTo(e)}else this.__threshold=9999;this.__glshader.bind(t),this.__shaderBinding.bind(t);const n=t.unifs;if(this.__atlas.bindToUniform(t,n.atlasBillboards),e.floatTexturesSupported&&e.drawElementsInstanced){this.__drawItemsTexture.bindToUniform(t,n.instancesTexture),e.uniform1i(n.instancesTextureSize.location,this.__width);{const i=t.attrs.instanceIds.location;e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,this.__instanceIdsBuffer),e.vertexAttribPointer(i,1,e.FLOAT,!1,4,0),e.vertexAttribDivisor(i,1)}t.bindViewports(n,()=>{e.drawElementsInstanced(e.TRIANGLES,6,e.UNSIGNED_SHORT,0,this.__drawCount)})}else{const i=this.__indexArray.length;for(let s=0;s<i;s++)e.uniformMatrix4fv(n.modelMatrix.location,!1,this.__modelMatrixArray[s]),e.uniform4fv(n.billboardData.location,this.__billboardDataArray[s]),e.uniform4fv(n.tintColor.location,this.__tintColorArray[s]),e.uniform4fv(n.layoutData.location,this.__atlas.getLayoutData(this.__billboards[s].imageIndex)),t.bindViewports(n,()=>{e.drawQuad()})}e.disable(e.BLEND)}}Yi$1.registerPass(fs$1,Ti$1.TRANSPARENT);class Vs$1 extends Xs$1{constructor(){super()}init(t,e){super.init(t,e)}filterGeomItem(t){if(t.isOverlay())return!0;const e=t.getMaterial().getShaderClass();return!(!e||!e.isOverlay())}draw(t){this.newItemsReadyForLoading()&&this.finalize();const e=this.__gl;e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),t.pass="ADD",e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.__traverseTreeAndDraw(t),e.disable(e.BLEND)}drawGeomData(t){const e=this.__gl;e.clear(e.DEPTH_BUFFER_BIT),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),t.pass="ADD",e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),super.drawGeomData(t),e.disable(e.BLEND),e.enable(e.DEPTH_TEST)}}Yi$1.registerPass(Vs$1,Ti$1.OVERLAY);const Is$1=window.AudioContext||window.webkitAudioContext||!1;let Rs$1;Is$1?Rs$1=new Is$1:alert("Sorry, but the Web Audio API is not supported by your browser. Please, consider upgrading to the latest version or downloading Google Chrome or Mozilla Firefox");class xs$1 extends Mi$1{constructor(){super(),this.__audioItems=[]}init(t,e){super.init(t,e),Rs$1&&this.__renderer.registerPass(t=>{if(t instanceof na$1)return t.audioSourceCreated.connect(e=>{this.addAudioSource(t,e,t)}),!0;if(t instanceof oa$1){const e=t.getMaterial();if(e){const i=e.getParameter("BaseColor");if(i&&i.getImage&&i.getImage()){const e=i.getImage();e.loaded.connect(()=>{if(e.getAudioSource){const i=e.getAudioSource();(i instanceof HTMLMediaElement||i instanceof AudioBufferSourceNode)&&this.addAudioSource(t,i,e)}})}}return!1}},()=>{})}addAudioSource(t,e,i){if(e.addedToCollector)return;let n;n=e instanceof HTMLMediaElement?Rs$1.createMediaElementSource(e):e instanceof AudioBufferSourceNode?e:Rs$1.createMediaStreamSource(e);const s=Rs$1.createGain(),o=i.getParameter("Gain");var r,a;o&&(a=s.gain,(r=o)&&(a.setValueAtTime(r.getValue(),0),a.setValueAtTime(r.getValue(),5),r.valueChanged.connect(()=>{a.value=r.getValue()}))),n.connect(s);const l=i.getParameter("SpatializeAudio");if(l&&0==l.getValue())n.connect(Rs$1.destination);else{const e=Rs$1.createPanner();e.panningModel="HRTF",e.distanceModel="inverse",n.connect(e),e.connect(Rs$1.destination);const s=t=>{const n=i.getParameter(t);n&&(e[t]=n.getValue(),n.valueChanged.connect(()=>{e[t]=n.getValue()}))};s("coneInnerAngle"),s("coneOuterAngle"),s("coneOuterGain");const o=()=>{let i;i=t instanceof oa$1?t.getGeomMat4():t.getGlobalXfo().toMat4();const n=i.translation;e.setPosition(n.x,n.y,n.z);const s=i.zAxis;e.setOrientation(s.x,s.y,s.z)};o(),t.globalXfoChanged.connect(()=>{o()})}e.addedToCollector=!0,this.__audioItems.push({treeItem:t,audioSource:e,parameterOwner:i}),this.updated.emit()}__updateListenerPosition(t){if(!Rs$1)return;const e=Rs$1.listener;e.setPosition(t.tr.x,t.tr.y,t.tr.z);const i=t.ori.getYaxis(),n=t.ori.getZaxis().negate();e.setOrientation(n.x,n.y,n.z,i.x,i.y,i.z)}draw(t){0!=this.__audioItems.length&&this.__updateListenerPosition(t.viewXfo)}}Yi$1.registerPass(xs$1,Ti$1.OVERLAY),window&&(window.ZeaAudioaudioCtx=Rs$1);var Ss$1=Object.freeze({__proto__:null,create3DContext:Ca$1,GLTexture2D:Na$1,GLMesh:Ua$1,GLLines:Ja$1,GLPoints:Pa$1,GLMaterial:ii$1,GLShader:Ba$1,GLFbo:Oa$1,GLRenderTarget:si$1,GLRenderer:Yi$1,GLBaseViewport:Vi$1,GLViewport:Ii$1,shaderLibrary:Ha$1,generateShaderGeomBinding:wa$1,BillboardShader:Ki$1,ConvolverShader:hi$1,DepthMapShader:wi$1,EnvMapShader:ui$1,BackgroundImageShader:bi$1,OctahedralEnvMapShader:pi$1,LatLongEnvMapShader:gi$1,SterioLatLongEnvMapShader:_i$1,DualFishEyeEnvMapShader:Zi$1,DualFishEyeToLatLongBackgroundShader:Gi$1,EnvProjectionShader:zi$1,OctahedralEnvProjectionShader:Ui$1,LatLongEnvProjectionShader:Ji$1,FatLinesShader:Pi$1,FlatSurfaceShader:Ei$1,FlatAlphaSurfaceShader:Hi$1,LayeredCarPaintShader:ki$1,LinesShader:Di$1,NormalsShader:Oi$1,PointsShader:Qi$1,FatPointsShader:Ai$1,FatPointsGeomDataShader:ji$1,FatPointsSelectedShader:qi$1,PostProcessing:$i$1,ScreenQuadShader:yi$1,SimpleSurfaceShader:es$1,StandardSurfaceShader:ts$1,StandardSurfaceGeomDataShader:as$1,StandardSurfaceSelectedGeomsShader:is$1,HandleShader:ss$1,HandleGeomDataShader:ns$1,TransparentSurfaceShader:ls$1,ScreenSpaceShader:rs$1,ToolIconShader:os$1,UnpackHDRShader:Da$1,UnpackLDRAlphaImageShader:ds$1,WireShader:hs$1,GLPass:Mi$1,PassType:Ti$1,GLStandardGeomsPass:gs$1,GLOpaqueGeomsPass:Xs$1,GLTransparentGeomsPass:ys$1,GLBillboardsPass:fs$1,GLOverlayPass:Vs$1,GLAudioItemsPass:xs$1,get audioCtx(){return Rs$1},VRViewport:Si$1});class Ws$1{constructor(t){this.__name=t||J$1.getClassName(this),this.__stateEvents=[],this.__activationActions=[],this.__deactivationActions=[]}getName(){return this.__name}setName(t){this.__name=t}setStateMachine(t){this.__stateMachine=t}getStateMachine(){return this.__stateMachine}activate(){this.__stateEvents.forEach(t=>{t.activate()}),this.__activationActions.forEach(t=>{t.activate()})}deactivate(){this.__stateEvents.forEach(t=>{t.deactivate()}),this.__deactivationActions.forEach(t=>{t.activate()})}addStateEvent(t){t.setState(this),this.__stateEvents.push(t)}getStateEvent(t){return this.__stateEvents[t]}addActivationAction(t){t.setState(this),this.__activationActions.push(t)}getActivationAction(t){return this.__activationActions[t]}addDeactivationAction(t){t.setState(this),this.__deactivationActions.push(t)}toJSON(t,e){const i={name:this.__name,type:J$1.getClassName(this)},n=[];for(const r of this.__stateEvents)n.push(r.toJSON(t,e));i.stateEvents=n;const s=[];for(const r of this.__activationActions)s.push(r.toJSON(t,e));i.activationActions=s;const o=[];for(const r of this.__deactivationActions)o.push(r.toJSON(t,e));return i.deactivationActions=o,i}fromJSON(t,e,i){this.__name=t.name;for(const n of t.stateEvents){const t=J$1.constructClass(n.type);t.fromJSON(n,e),this.addStateEvent(t)}for(const n of t.activationActions){const t=J$1.constructClass(n.type);t.fromJSON(n,e),this.addActivationAction(t)}for(const n of t.deactivationActions){const t=J$1.constructClass(n.type);t.fromJSON(n,e),this.addDeactivationAction(t)}}}J$1.registerClass("State",Ws$1);class Ls$1 extends q$1{constructor(t){super(),this.__name=t,this.__childActions=[],this.__outputs={}}addOutput(t){return this.__outputs[t.getName()]=t,t}getOutput(t){return this.__outputs[t]}setState(t){this.__state=t,this.__childActions.forEach(e=>{e.setState(t)})}addChild(t){this.__childActions.push(t),t.setState(this.__state)}getChild(t){return this.__childActions[t]}activate(){console.warn("activate must be implmented by each action. this:"+J$1.getClassName(this))}addChild(t){this.__childActions.push(t),t.setState(this.__state)}deactivate(){}__onDone(){this.__childActions.forEach(t=>{t.activate()})}toJSON(t,e){let i=super.toJSON(t,e);i||(i={}),i.type=J$1.getClassName(this);const n=[];for(const o of this.__childActions)n.push(o.toJSON(t,e));i.childActions=n;const s={};for(const o in this.__outputs)s[o]=this.__outputs[o].toJSON(t,e);return i.outputs=s,i}fromJSON(t,e,i){super.fromJSON(t,e,i);for(const n of t.childActions){const t=J$1.constructClass(n.type);if(!t)throw new Error("Invalid type:"+n.type);t.fromJSON(n,e),this.addChild(t)}for(const n in t.outputs)this.__outputs[n].fromJSON(t.outputs[n],e)}destroy(){super.destroy(),this.__outputs=[]}}class vs$1 extends Ls$1{constructor(t){super(),this.__name=t,this.__onEvent=this.__onEvent.bind(this)}__onEvent(){this.__childActions.forEach(t=>{t.activate()})}}class Fs$1 extends te$1{constructor(t){super(t),this.__states={},this.stateChanged=new C$1,this.setFlag($$1.USER_EDITED),J$1.isConstructing()||J$1.invokeCallbacks(this)}addState(t){t.setStateMachine(this),this.__states[t.getName()]=t,1==Object.keys(this.__states).length&&null==this.__initialStateName&&(this.__initialStateName=t.getName())}getState(t){return this.__states[t]}activateState(t){if(!this.__states[t])throw new Error("Invalid state transtion:"+t);this.__currentState!=this.__states[t]&&(this.__currentState&&this.__currentState.deactivate(),this.__currentState=this.__states[t],this.__currentState.activate(),this.stateChanged.emit(t))}getActiveState(){return this.__currentState}getActiveStateName(){return J$1.getClassName(this.__currentState)}getInitialState(){return this.__initialStateName}setInitialState(t){this.__initialStateName=t}toJSON(t,e){const i=super.toJSON(t,e);i.initialStateName=this.__initialStateName;const n={};for(const s in this.__states)n[s]=this.__states[s].toJSON(t,e);return i.states=n,i}fromJSON(t,e,i){super.fromJSON(t,e,i),this.__initialStateName=t.initialStateName,e.stateMachine=this;for(const n in t.states){const i=t.states[n],s=J$1.constructClass(i.type);if(!s)throw new Error("Invalid type:"+i.type);s.fromJSON(i,e),this.addState(s)}e.addPLCB(()=>{})}}J$1.registerClass("StateMachine",Fs$1);class Ts$1 extends Ls$1{constructor(){super(),this.__targetStateParam=this.addParameter(new Le$1("TargetState",""))}activate(){this.__state.getStateMachine().activateState(this.__targetStateParam.getValue())}}J$1.registerClass("SwitchState",Ts$1);class Ms$1 extends Ls$1{constructor(){super(),this.addParameter(new Ce$1("Camera",t=>t instanceof pa$1)),this.addParameter(new fe$1("cameraPos")),this.addParameter(new fe$1("cameraTarget")),this.addParameter(new Ze$1("interpTime",1)),this.addParameter(new Ze$1("updateFrequency",30))}SetCameraPositionAndTarget(t,e){this.getParameter("cameraPos").setValue(t),this.getParameter("cameraTarget").setValue(e)}activate(){const t=this.getParameter("Camera").getValue();if(!t)return void console.warn("Camera not assigned to SetCameraPositionAndTarget state action");const e=this.getParameter("cameraPos").getValue(),i=this.getParameter("cameraTarget").getValue(),n=this.getParameter("interpTime").getValue();if(n>0){const s=t.getGlobalXfo().tr,o=t.getTargetPostion(),r=(s.subtract(o).length(),this.getParameter("updateFrequency").getValue()),a=e.subtract(i).length();let l=!0,c=0,h=0;const d=Math.round(n*r);let u=!1;const m=()=>{u||(l=!1)};t.globalXfoChanged.connect(m);const p=()=>{if(h++,h<d){const n=h/d,s=Math.smoothStep(0,1,n),o=(s-c)/(1-n);c=s;const m=t.getGlobalXfo().tr,b=t.getTargetPostion(),f=m.subtract(b).length();let g=m;const y=b.lerp(i,o);l&&(g=m.lerp(e,o));const v=g.subtract(y),Z=(v.length(),Math.lerp(f,a,o));v.scaleInPlace(Z/v.length()),u=!0,t.setPositionAndTarget(y.add(v),y),u=!1,this.__timeoutId=window.setTimeout(p,1e3/r)}else t.globalXfoChanged.disconnect(m),t.movementFinished.emit(),this.__timeoutId=void 0,this.__onDone()};p()}else t.setPositionAndTarget(e,i)}cancel(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=void 0)}}J$1.registerClass("SetCameraPositionAndTarget",Ms$1);class Cs$1 extends Ls$1{constructor(){super(),this.__interpTimeParam=this.addParameter(new Ze$1("InterpTime",1)),this.__updateFrequencyParam=this.addParameter(new Ze$1("UpdateFrequency",30)),this.__outParam=this.addOutput(new fa$1("Param")),this.__outParam.paramSet.connect(()=>{if(!this.__valueParam||this.__outParam.getParam().getDataType()!=this.__valueParam.getDataType()){const t=this.__outParam.getParam().clone();t.setName("Value"),t.setValue(this.__outParam.getInitialValue?this.__outParam.getInitialValue():this.__outParam.getParam().getValue()),this.__valueParam=this.addParameter(t)}})}activate(){if(this.__outParam.isConnected()){const t=this.__interpTimeParam.getValue();if(t>0){const e=this.__updateFrequencyParam.getValue(),i=this.__outParam.getValue(),n=this.__valueParam.getValue();let s=0;const o=Math.round(t/(1/e)),r=()=>{if(s++,s<o){const t=Math.smoothStep(0,1,s/o),a=Math.lerp(i,n,t);this.__outParam.setValue(a,E$1.GENERATED_VALUE),this.__timeoutId=window.setTimeout(r,1e3/e)}else this.__outParam.setValue(this.__valueParam.getValue(),E$1.GENERATED_VALUE),this.__timeoutId=void 0,this.__onDone()};r()}else this.__outParam.setValue(this.__valueParam.getValue(),E$1.GENERATED_VALUE),this.__onDone()}}cancel(){this.__timeoutId&&(clearTimeout(this.__timeoutId),this.__timeoutId=void 0)}toJSON(t,e){const i=super.toJSON(t,e);return this.__valueParam&&(i.valueParamType=J$1.getClassName(this.__valueParam)),i}fromJSON(t,e,i){if(t.valueParamType){const e=J$1.constructClass(t.valueParamType,"Value");e&&(this.__valueParam=this.addParameter(e))}super.fromJSON(t,e,i)}}J$1.registerClass("SetParameterValue",Cs$1);class Ns$1 extends vs$1{constructor(t){super(t),this.__geomParam=this.addParameter(new Ce$1("TreeItem")),this.__geomParam.valueChanged.connect(()=>{this.__geom=this.__geomParam.getValue()})}__geomClicked(t){t.stopPropagation(),this.__onEvent()}activate(){this.__geom&&this.__geom.mouseDown.connect(this.__geomClicked.bind(this))}deactivate(){this.__geom&&this.__geom.mouseDown.disconnect(this.__geomClicked.bind(this))}}J$1.registerClass("GeomClicked",Ns$1);class Ys$1 extends vs$1{constructor(t){super(t),this.onKeyPressed=this.onKeyPressed.bind(this),this.__keyParam=this.addParameter(new Le$1("Key",""))}onKeyPressed(t){console.log(t.key),t.key==this.__keyParam.getValue()&&this.__onEvent()}activate(){document.addEventListener("keydown",this.onKeyPressed)}deactivate(){document.removeEventListener("keydown",this.onKeyPressed)}}J$1.registerClass("KeyPressedEvent",Ys$1);class Ks$1 extends vs$1{constructor(t){super(t),this.__waitTimeParam=this.addParameter(new Ze$1("WaitTime",1))}activate(){this.__timeoutId=window.setTimeout(()=>{delete this.__timeoutId,this.__onEvent()},1e3*this.__waitTimeParam.getValue())}deactivate(){this.__timeoutId&&window.clearTimeout(this.__timeoutId)}}J$1.registerClass("TimedWait",Ks$1);const ws$1={onResize:e$1,...a$2,...M$1,...w$2,...Ma$1,...Ss$1,...Object.freeze({__proto__:null,State:Ws$1,StateAction:Ls$1,StateEvent:vs$1,StateMachine:Fs$1,SwitchState:Ts$1,SetCameraPositionAndTarget:Ms$1,SetParameterValue:Cs$1,GeomClicked:Ns$1,KeyPressedEvent:Ys$1,TimedWait:Ks$1})},k$2={},E$2={},O$2=[];class A$2{constructor(){this.__undoStack=[],this.__redoStack=[],this.changeAdded=new C$1,this.changeUpdated=new C$1,this.changeUndone=new C$1,this.changeRedone=new C$1,this.__currChangeUpdated=this.__currChangeUpdated.bind(this)}flush(){for(const t of this.__undoStack)t.destroy();this.__undoStack=[];for(const t of this.__redoStack)t.destroy();this.__redoStack=[]}addChange(t){this.getCurrentChange()&&this.getCurrentChange().updated.disconnect(this.__currChangeUpdated),this.__undoStack.push(t),t.updated.connect(this.__currChangeUpdated);for(const e of this.__redoStack)e.destroy();this.__redoStack=[],this.changeAdded.emit(t)}getCurrentChange(){return this.__undoStack[this.__undoStack.length-1]}__currChangeUpdated(t){this.changeUpdated.emit(t)}undo(t=!0){if(this.__undoStack.length>0){const e=this.__undoStack.pop();e.undo(),t&&(this.__redoStack.push(e),this.changeUndone.emit())}}redo(){if(this.__redoStack.length>0){const t=this.__redoStack.pop();t.redo(),this.__undoStack.push(t),this.changeRedone.emit()}}constructChange(t){return new k$2[t]}static getChangeClassName(t){const e=O$2.indexOf(t.constructor);return E$2[e]?E$2[e]:(console.warn("Change not registered:",t.constructor.name),t.constructor.name)}static registerChange(t,e){-1!=O$2.indexOf(e)&&console.warn("Class already registered:",t);const i=O$2.length;O$2.push(e),k$2[t]=e,E$2[i]=t}}class G$2{constructor(t){this.name=t||A$2.getChangeClassName(this),this.updated=new C$1}undo(){throw new Error("Implement me")}redo(){throw new Error("Implement me")}update(t){throw new Error("Implement me")}toJSON(t){return{}}fromJSON(t,e){}changeFromJSON(t){this.update(t)}destroy(){}}class L$2 extends ia$1{constructor(t){super(t),this.captured=!1}highlight(){}unhighlight(){}getManipulationPlane(){const t=this.getGlobalXfo();return new x$1(t.tr,t.ori.getZaxis())}onMouseEnter(t){this.highlight()}onMouseLeave(t){this.unhighlight()}onMouseDown(t){t.setCapture(this),t.stopPropagation(),this.captured=!0,t.viewport?this.handleMouseDown(t):t.vrviewport&&this.onVRControllerButtonDown(t)}onMouseMove(t){this.captured&&(t.stopPropagation(),t.viewport?this.handleMouseMove(t):t.vrviewport&&this.onVRPoseChanged(t))}onMouseUp(t){this.captured&&(t.releaseCapture(),t.stopPropagation(),this.captured=!1,t.viewport?this.handleMouseUp(t):t.vrviewport&&this.onVRControllerButtonUp(t))}onWheel(t){}handleMouseDown(t){this.gizmoRay=this.getManipulationPlane();const e=t.mouseRay.intersectRayPlane(this.gizmoRay);return t.grabPos=t.mouseRay.pointAtDist(e),this.onDragStart(t),!0}handleMouseMove(t){const e=t.mouseRay.intersectRayPlane(this.gizmoRay);return t.holdPos=t.mouseRay.pointAtDist(e),this.onDrag(t),!0}handleMouseUp(t){const e=t.mouseRay.intersectRayPlane(this.gizmoRay);return t.releasePos=t.mouseRay.pointAtDist(e),this.onDragEnd(t),!0}onVRControllerButtonDown(t){this.activeController=t.controller;const e=this.activeController.getTipXfo().clone(),i=this.getManipulationPlane(),n=e.tr.subtract(i.start),s=e.tr.subtract(i.dir.scale(n.dot(i.dir)));return t.grabPos=s,this.onDragStart(t),!0}onVRPoseChanged(t){if(this.activeController){const e=this.activeController.getTipXfo(),i=this.getManipulationPlane(),n=e.tr.subtract(i.start),s=e.tr.subtract(i.dir.scale(n.dot(i.dir)));return t.holdPos=s,this.onDrag(t),!0}}onVRControllerButtonUp(t){if(this.activeController==t.controller){const e=this.activeController.getTipXfo();return this.onDragEnd(t,e.tr),this.activeController=void 0,!0}}onDragStart(t){console.log("onDragStart",t)}onDrag(t){console.log("onDrag",t)}onDragEnd(t){console.log("onDragEnd",t)}}class H$2 extends L$2{constructor(t){super(t)}handleMouseDown(t){this.gizmoRay=this.getManipulationPlane(),this.grabDist=t.mouseRay.intersectRayVector(this.gizmoRay)[1];const e=this.gizmoRay.pointAtDist(this.grabDist);return t.grabDist=this.grabDist,t.grabPos=e,this.onDragStart(t),!0}handleMouseMove(t){const e=t.mouseRay.intersectRayVector(this.gizmoRay)[1],i=this.gizmoRay.pointAtDist(e);t.holdDist=e,t.holdPos=i,t.value=e,t.delta=e-this.grabDist,this.onDrag(t)}handleMouseUp(t){const e=t.mouseRay.intersectRayVector(this.gizmoRay)[1],i=this.gizmoRay.pointAtDist(e);return t.releasePos=i,this.onDragEnd(t),!0}onVRControllerButtonDown(t){this.gizmoRay=this.getManipulationPlane(),this.activeController=t.controller;const e=this.activeController.getTipXfo();this.grabDist=e.tr.subtract(this.gizmoRay.start).dot(this.gizmoRay.dir);const i=this.gizmoRay.start.add(this.gizmoRay.dir.scale(this.grabDist));return t.grabPos=i,this.onDragStart(t),!0}onVRPoseChanged(t){const e=this.activeController.getTipXfo().tr.subtract(this.gizmoRay.start).dot(this.gizmoRay.dir),i=this.gizmoRay.start.add(this.gizmoRay.dir.scale(e));return t.value=e,t.holdPos=i,t.delta=e-this.grabDist,this.onDrag(t),!0}onVRControllerButtonUp(t){if(this.activeController==t.controller)return this.onDragEnd(),this.activeController=void 0,!0}}class N$2 extends G$2{constructor(t,e,i=E$1.USER_SETVALUE){t?(super(t?t.getName()+" Changed":"ParameterValueChange"),this.__prevValue=t.getValue(),this.__param=t,this.__mode=i,null!=e&&(this.__nextValue=e,this.__param.setValue(this.__nextValue,i))):super()}undo(){this.__param&&this.__param.setValue(this.__prevValue,this.__mode)}redo(){this.__param&&this.__param.setValue(this.__nextValue,this.__mode)}update(t){this.__param&&(this.__nextValue=t.value,this.__param.setValue(this.__nextValue,t.mode?t.mode:this.__mode),this.updated.emit(t))}toJSON(t){const e={name:this.name,paramPath:this.__param.getPath()};return null!=this.__nextValue&&(e.value=this.__nextValue.toJSON?this.__nextValue.toJSON():this.__nextValue),e}fromJSON(t,e){const i=e.appData.scene.getRoot().resolvePath(t.paramPath,1);i&&i instanceof Q$1?(this.__param=i,this.__prevValue=this.__param.getValue(),this.__nextValue=this.__prevValue.clone?this.__prevValue.clone():this.__prevValue,this.name=t.name,null!=t.value&&this.changeFromJSON(t)):console.warn("resolvePath is unable to resolve",t.paramPath)}changeFromJSON(t){this.__param&&(this.__nextValue.fromJSON?this.__nextValue.fromJSON(t.value):this.__nextValue=t.value,this.__param.setValue(this.__nextValue,E$1.REMOTEUSER_SETVALUE))}}A$2.registerChange("ParameterValueChange",N$2);class z$2 extends L$2{constructor(t){super(t)}setTargetParam(t,e=!0){if(this.param=t,e){const e=()=>{this.setGlobalXfo(t.getValue())};e(),t.valueChanged.connect(e)}}getTargetParam(){return this.param?this.param:this.getParameter("GlobalXfo")}onDragStart(t){this.baseXfo=this.getGlobalXfo().clone(),this.baseXfo.sc.set(1,1,1),this.deltaXfo=new S$1;const e=this.getTargetParam(),i=e.getValue();this.offsetXfo=this.baseXfo.inverse().multiply(i),this.vec0=t.grabPos.subtract(this.baseXfo.tr),this.grabCircleRadius=this.vec0.length(),this.vec0.normalizeInPlace(),t.undoRedoManager&&(this.change=new N$2(e),t.undoRedoManager.addChange(this.change))}onDrag(t){const e=t.holdPos.subtract(this.baseXfo.tr),i=e.length();e.normalizeInPlace();const n=i/this.grabCircleRadius;let s=this.vec0.angleTo(e)*n;if(this.vec0.cross(e).dot(this.baseXfo.ori.getZaxis())<0&&(s=-s),this.range&&(s=Math.clamp(s,this.range[0],this.range[1])),t.shiftKey){const t=Math.degToRad(22.5);s=Math.floor(s/t)*t}this.deltaXfo.ori.setFromAxisAndAngle(new Z$1(0,0,1),s);const o=this.baseXfo.multiply(this.deltaXfo).multiply(this.offsetXfo);this.change?this.change.update({value:o}):this.getTargetParam().setValue(o)}onDragEnd(t){this.change=null}}class Y$2 extends G$2{constructor(t,e,i){super("SelectionChange"),this.__selectionManager=t,this.__prevSelection=e,this.__newSelection=i}undo(){this.__selectionManager.setSelection(this.__prevSelection,!1)}redo(){this.__selectionManager.setSelection(this.__newSelection,!1)}toJSON(t){const e=super.toJSON(t),i=[];for(const n of this.__newSelection)i.push(n.getPath());return e.itemPaths=i,e}fromJSON(t,e){super.fromJSON(t,e),this.__selectionManager=e.appData.selectionManager,this.__prevSelection=new Set(this.__selectionManager.getSelection());const i=e.appData.scene.getRoot(),n=new Set;for(const s of t.itemPaths)n.add(i.resolvePath(s,1));this.__newSelection=n,this.__selectionManager.setSelection(this.__newSelection,!1)}}A$2.registerChange("SelectionChange",Y$2);class q$2 extends G$2{constructor(t,e){super("Selection Visibility Change"),this.selection=t,this.state=e,this.do(this.state)}undo(){this.do(!this.state)}redo(){this.do(this.state)}do(t){for(const e of this.selection)e.getParameter("Visible").setValue(t)}}A$2.registerChange("ToggleSelectionVisibility",q$2);class ee$2 extends G$2{constructor(t,e,i){t?(super(t.getName()+" Added"),this.treeItem=t,this.owner=e,this.selectionManager=i,this.prevSelection=new Set(this.selectionManager.getSelection()),this.treeItemIndex=this.owner.addChild(this.treeItem),this.selectionManager.setSelection(new Set([this.treeItem]),!1),this.treeItem.addRef(this)):super()}undo(){this.treeItem instanceof ya$1?this.treeItem.detach():this.treeItem instanceof ia$1&&this.treeItem.traverse(t=>{t instanceof ya$1&&t.detach()},!1),this.owner.removeChild(this.treeItemIndex),this.selectionManager&&this.selectionManager.setSelection(this.prevSelection,!1)}redo(){this.treeItem instanceof ya$1?this.treeItem.reattach():subTreeItem instanceof ia$1&&this.treeItem.traverse(t=>{t instanceof ya$1&&t.reattach()},!1),this.owner.addChild(this.treeItem),this.selectionManager&&this.selectionManager.setSelection(new Set([this.treeItem]),!1)}toJSON(t){return{name:this.name,treeItem:this.treeItem.toJSON(t),treeItemPath:this.treeItem.getPath(),treeItemIndex:this.treeItemIndex}}fromJSON(t,e){const i=J$1.constructClass(t.treeItem.type);i?(this.name=t.name,this.treeItem=i,this.treeItem.addRef(this),this.treeItem.fromJSON(t.treeItem,e),this.treeItemIndex=this.owner.addChild(this.treeItem,!1,!1)):console.warn("resolvePath is unable to conostruct",t.treeItem)}destroy(){this.treeItem.removeRef(this)}}A$2.registerChange("TreeItemAddChange",ee$2);class te$2 extends G$2{constructor(t,e){if(super(),this.items=[],this.itemOwners=[],this.itemPaths=[],this.itemIndices=[],t){this.selectionManager=e.selectionManager,this.prevSelection=new Set(this.selectionManager.getSelection()),this.items=t,this.newSelection=new Set(this.prevSelection);const i=[];this.items.forEach(t=>{const e=t.getOwner(),n=e.getChildIndex(t);i.push(t.getName()),t.addRef(this),this.itemOwners.push(e),this.itemPaths.push(t.getPath()),this.itemIndices.push(n),this.selectionManager&&this.newSelection.has(t)&&this.newSelection.delete(t),t instanceof ya$1?t.detach():t instanceof ia$1&&t.traverse(t=>{t instanceof ya$1&&t.detach(),this.selectionManager&&this.newSelection.has(t)&&this.newSelection.delete(t)},!1),e.removeChild(n)}),this.selectionManager.setSelection(this.newSelection,!1),this.name=i+" Deleted"}}undo(){this.items.forEach((t,e)=>{this.itemOwners[e].insertChild(t,this.itemIndices[e],!1,!1),t instanceof ya$1?t.reattach():subTreeItem instanceof ia$1&&t.traverse(t=>{t instanceof ya$1&&t.reattach()},!1)}),this.selectionManager&&this.selectionManager.setSelection(this.prevSelection,!1)}redo(){this.selectionManager&&this.selectionManager.setSelection(this.newSelection,!1),this.items.forEach((t,e)=>{this.itemOwners[e].removeChild(this.itemIndices[e]),t instanceof ya$1?t.detach():subTreeItem instanceof ia$1&&t.traverse(t=>{t instanceof ya$1&&t.detach()},!1)})}toJSON(t){const e={name:this.name,items:[],itemPaths:this.itemPaths,itemIndices:this.itemIndices};return this.items.forEach(t=>{e.items.push(t.toJSON())}),e}fromJSON(t,e){this.name=t.name,t.itemPaths.forEach(t=>{const i=e.scene.getRoot().resolvePath(t,1);if(!i)return void console.warn("resolvePath is unable to resolve",t);const n=i.getOwner();this.itemOwners.push(n),this.itemPaths.push(i.getPath()),this.itemIndices.push(n.getChildIndex(i))})}destroy(){this.items.forEach(t=>t.removeRef(this))}}A$2.registerChange("TreeItemsRemoveChange",te$2);class oe$2 extends G$2{constructor(t,e){t?(console.log("TreeItemMoveChange"),super(t.getName()+" Added"),this.treeItem=t,this.oldOwner=this.treeItem.getOwner(),this.oldOwnerIndex=this.oldOwner.getChildIndex(this.treeItem),this.newOwner=e,this.newOwner.addChild(this.treeItem,!0)):super()}undo(){this.oldOwner.insertChild(this.treeItem,this.oldOwnerIndex,!0)}redo(){this.newOwner.addChild(this.treeItem,!0)}toJSON(t){return{name:this.name,treeItemPath:this.treeItem.getPath(),newOwnerPath:this.newOwner.getPath()}}fromJSON(t,e){const i=appData.scene.getRoot().resolvePath(t.treeItemPath,1);if(!i)return void console.warn("resolvePath is unable to resolve",t.treeItemPath);const n=appData.scene.getRoot().resolvePath(t.newOwnerPath,1);n?(this.name=t.name,this.treeItem=i,this.newOwner=n,this.oldOwner=this.treeItem.getOwner(),this.oldOwnerIndex=this.oldOwner.getChildIndex(this.treeItem),this.newOwner.addChild(this.treeItem,!0)):console.warn("resolvePath is unable to resolve",t.newOwnerPath)}}A$2.registerChange("TreeItemMoveChange",oe$2);class ie$2 extends q$1{constructor(t){super(),t||console.error("App data not provided to tool"),this.appData=t,this.installChanged=new C$1,this.activatedChanged=new C$1,this.actionFinished=new C$1,this.__params=[],this.__installed=!1,this.__activated=!1}getName(){return this.constructor.name}isPrimaryTool(){return!1}installed(){return this.__installed}install(t){if(this.__installed)throw new Error("Tool already installed");this.index=t,this.__installed=!0,this.installChanged.emit(!0)}uninstall(){this.__installed=!1,this.installChanged.emit(!1)}activateTool(){if(this.__activated)throw new Error("Tool already activate");this.__activated=!0,this.activatedChanged.emit(!0)}deactivateTool(){this.__activated=!1,this.activatedChanged.emit(!1)}onMouseDown(t){}onMouseMove(t){}onMouseUp(t){}onDoubleClick(t){}onWheel(t){}onKeyPressed(t,e){}onKeyDown(t,e){}onKeyUp(t,e){}onTouchStart(t){}onTouchMove(t){}onTouchEnd(t){}onTouchCancel(t){}onDoubleTap(t){}onVRControllerButtonDown(t){}onVRControllerButtonUp(t){}onVRControllerDoubleClicked(t){}onVRPoseChanged(t){}}class re$3 extends ie$2{constructor(t){super(t),this.dragging=!1,this.selectionRect=new Pt$1(1,1),this.selectionRectMat=new Pe$1("marker","ScreenSpaceShader"),this.selectionRectMat.getParameter("BaseColor").setValue(new y$3("#03E3AC")),this.selectionRectXfo=new S$1,this.selectionRectXfo.tr.set(.5,.5,0),this.selectionRectXfo.sc.set(0,0,0)}activateTool(){super.activateTool(),this.rectItem||(this.rectItem=new oa$1("selectionRect",this.selectionRect,this.selectionRectMat),this.rectItem.getParameter("Visible").setValue(!1),this.appData.renderer.addTreeItem(this.rectItem))}deactivateTool(){super.deactivateTool(),this.selectionRectXfo.sc.set(0,0,0),this.rectItem.setGlobalXfo(this.selectionRectXfo)}onMouseDown(t){return 0==t.button&&!t.altKey&&(console.log("onMouseDown"),this.mouseDownPos=t.mousePos,this.dragging=!1,!0)}__resizeRect(t,e){const i=new _$1(1/t.getWidth()*2,1/t.getHeight()*2),n=e.multiply(i);this.selectionRectXfo.sc.set(Math.abs(n.x),Math.abs(n.y),1);const s=this.mouseDownPos.subtract(e.scale(.5)).multiply(i).subtract(new _$1(1,1));this.selectionRectXfo.tr.x=s.x,this.selectionRectXfo.tr.y=-s.y,this.rectItem.setGlobalXfo(this.selectionRectXfo)}onMouseMove(t){if(this.mouseDownPos){const e=this.mouseDownPos.subtract(t.mousePos);this.dragging&&this.__resizeRect(t.viewport,e),e.length()>4&&(this.dragging=!0,this.rectItem.getParameter("Visible").setValue(!0),this.__resizeRect(t.viewport,e))}return!0}onMouseUp(t){if(this.mouseDownPos){if(this.dragging){this.rectItem.getParameter("Visible").setValue(!1);const e=t.mousePos,i=new _$1(Math.min(this.mouseDownPos.x,e.x),Math.min(this.mouseDownPos.y,e.y)),n=new _$1(Math.max(this.mouseDownPos.x,e.x),Math.max(this.mouseDownPos.y,e.y)),s=t.viewport.getGeomItemsInRect(i,n);if(this.appData.selectionManager.pickingModeActive())this.appData.selectionManager.pick(s);else{const e=new Set([...s].filter(t=>!(t.getOwner()instanceof L$2)));t.shiftKey?this.appData.selectionManager.deselectItems(e):this.appData.selectionManager.selectItems(e,!t.ctrlKey),this.selectionRectXfo.sc.set(0,0,0),this.rectItem.setGlobalXfo(this.selectionRectXfo)}}else{const e=t.viewport.getGeomDataAtPos(t.mousePos);if(null==e||e.geomItem.getOwner()instanceof L$2)this.appData.selectionManager.clearSelection();else if(this.appData.selectionManager.pickingModeActive())this.appData.selectionManager.pick(e.geomItem);else if(t.shiftKey){const t=new Set;t.add(e.geomItem),this.appData.selectionManager.deselectItems(t)}else this.appData.selectionManager.toggleItemSelection(e.geomItem,!t.ctrlKey)}return this.mouseDownPos=void 0,!0}}onVRControllerButtonDown(t){if(1==t.button){const e=t.controller.getGeomItemAtTip();if(null!=e&&!(e.geomItem.getOwner()instanceof L$2))return this.appData.selectionManager.toggleItemSelection(e.geomItem),!0}}}A$2.registerChange("SelectionTool",re$3);class Ce$2 extends G$2{constructor(t){super("HoldObjectsChange"),this.__selection=[],this.__prevXfos=[],this.__newXfos=[],t&&this.update(t)}undo(){for(let t=0;t<this.__selection.length;t++)this.__selection[t]&&this.__selection[t].setGlobalXfo(this.__prevXfos[t])}redo(){for(let t=0;t<this.__selection.length;t++)this.__selection[t]&&this.__selection[t].setGlobalXfo(this.__newXfos[t])}update(t){if(t.newItem)this.__selection[t.newItemId]=t.newItem,this.__prevXfos[t.newItemId]=t.newItem.getGlobalXfo();else if(t.changeXfos)for(let e=0;e<t.changeXfoIds.length;e++){const i=t.changeXfoIds[e];this.__selection[i]&&(this.__selection[i].setGlobalXfo(t.changeXfos[e]),this.__newXfos[i]=t.changeXfos[e])}this.updated.emit(t)}toJSON(t){const e=super.toJSON(t),i=[];for(let n=0;n<this.__selection.length;n++)this.__selection[n]?i[n]=this.__selection[n].getPath():i.push(null);return e.itemPaths=i,e}fromJSON(t,e){super.fromJSON(t,e);const i=e.appData.scene.getRoot(),n=[];for(let s=0;s<t.itemPaths.length;s++){const e=t.itemPaths[s];e&&(n[s]=i.resolvePath(e,1))}this.__selection=n}}A$2.registerChange("HoldObjectsChange",Ce$2);class Te$2 extends G$2{constructor(t){super(t)}setParentAndXfo(t,e){this.parentItem=t;const i=this.parentItem.generateUniqueName(this.geomItem.getName());this.geomItem.setName(i),this.geomItem.setGlobalXfo(e),this.childIndex=this.parentItem.addChild(this.geomItem,!0),this.geomItem.addRef(this)}undo(){this.parentItem.removeChild(this.childIndex)}redo(){this.parentItem.addChild(this.geomItem,!1,!1)}toJSON(t){const e=super.toJSON(t);return e.parentItemPath=this.parentItem.getPath(),e.geomItemName=this.geomItem.getName(),e.geomItemXfo=this.geomItem.getParameter("LocalXfo").getValue(),e}fromJSON(t,e){const i=e.appData.scene.getRoot();this.parentItem=i.resolvePath(t.parentItemPath,1),this.geomItem.setName(this.parentItem.generateUniqueName(t.geomItemName));const n=new S$1;n.fromJSON(t.geomItemXfo),this.geomItem.setLocalXfo(n),this.childIndex=this.parentItem.addChild(this.geomItem,!1)}destroy(){this.geomItem.removeRef(this)}}class Se$2 extends Te$2{constructor(t,e,i,n){super("Create Line"),this.line=new Nt$1(0),this.line.setNumVertices(2),this.line.setNumSegments(1),this.line.setSegment(0,0,1);const s=new Pe$1("Line","LinesShader");s.getParameter("Color").setValue(new y$3(.7,.2,.2)),this.geomItem=new oa$1("Line"),this.geomItem.setGeometry(this.line),this.geomItem.setMaterial(s),i&&s.getParameter("Color").setValue(i),n&&(this.line.lineThickness=n),t&&e&&this.setParentAndXfo(t,e)}update(t){t.p1&&(this.line.getVertex(1).setFromOther(t.p1),this.line.geomDataChanged.emit()),this.updated.emit(t)}fromJSON(t,e){if(super.fromJSON(t,e),t.color){const e=new y$3;e.fromJSON(t.color),material.getParameter("Color").setValue(e)}t.thickness&&(this.line.lineThickness=t.thickness)}}A$2.registerChange("CreateLineChange",Se$2);class ye$2 extends Te$2{constructor(t,e){super("Create Circle",t),this.circle=new Et$1(0,64),this.circle.lineThickness=.05;const i=new Pe$1("circle","FatLinesShader");i.getParameter("Color").setValue(new y$3(.7,.2,.2)),this.geomItem=new oa$1("Circle"),this.geomItem.setGeometry(this.circle),this.geomItem.setMaterial(i),t&&e&&this.setParentAndXfo(t,e)}update(t){this.circle.getParameter("Radius").setValue(t.radius),this.updated.emit(t)}toJSON(){const t=super.toJSON();return t.radius=this.circle.getParameter("Radius").getValue(),t}changeFromJSON(t){console.log("CreateCircleChange:",t),t.radius&&this.circle.getParameter("Radius").setValue(t.radius)}}A$2.registerChange("CreateCircleChange",ye$2);class Xe$2 extends Te$2{constructor(t,e){super("Create Rect"),this.rect=new Pt$1(0,0),this.rect.lineThickness=.05;const i=new Pe$1("circle","FatLinesShader");i.getParameter("Color").setValue(new y$3(.7,.2,.2)),this.geomItem=new oa$1("Rect"),this.geomItem.setGeometry(this.rect),this.geomItem.setMaterial(i),t&&e&&this.setParentAndXfo(t,e)}update(t){if(t.baseSize&&this.rect.setSize(t.baseSize[0],t.baseSize[1]),t.tr){const e=this.geomItem.getParameter("LocalXfo").getValue();e.tr.fromJSON(t.tr),this.geomItem.getParameter("LocalXfo").setValue(e)}this.updated.emit(t)}}A$2.registerChange("CreateRectChange",Xe$2);class xe$2 extends Te$2{constructor(t,e,i,n){super("Create Freehand Line"),this.used=0,this.vertexCount=100,this.line=new Nt$1,this.line.setNumVertices(this.vertexCount),this.line.setNumSegments(this.vertexCount-1),this.line.vertices.setValue(0,new Z$1);const s=new Pe$1("freeHandLine","FatLinesShader");this.geomItem=new oa$1("freeHandLine"),this.geomItem.setGeometry(this.line),this.geomItem.setMaterial(s),i&&s.getParameter("Color").setValue(i),n&&(this.line.lineThickness=n),t&&e&&this.setParentAndXfo(t,e)}update(t){this.used++;let e=!1;this.used>=this.line.getNumSegments()&&(this.vertexCount=this.vertexCount+100,this.line.setNumVertices(this.vertexCount),this.line.setNumSegments(this.vertexCount-1),e=!0),this.line.vertices.setValue(this.used,t.point),this.line.setSegment(this.used-1,this.used-1,this.used),e?this.line.geomDataTopologyChanged.emit({indicesChanged:!0}):this.line.geomDataChanged.emit({indicesChanged:!0}),this.updated.emit(t)}toJSON(t){const e=super.toJSON(t);return e.lineThickness=this.line.lineThickness,e.color=this.geomItem.getMaterial().getParameter("Color").getValue(),e}fromJSON(t,e){t.lineThickness&&(this.line.lineThickness=t.lineThickness);const i=new y$3(.7,.2,.2);t.color&&i.fromJSON(t.color),this.geomItem.getMaterial().getParameter("Color").setValue(i),super.fromJSON(t,e)}}A$2.registerChange("CreateFreehandLineChange",xe$2);class Ee$2 extends Te$2{constructor(t,e){super("Create Sphere",t),this.sphere=new qt$1(0,64,32);const i=new Pe$1("Sphere","SimpleSurfaceShader");this.geomItem=new oa$1("Sphere"),this.geomItem.setGeometry(this.sphere),this.geomItem.setMaterial(i),t&&e&&this.setParentAndXfo(t,e)}update(t){this.sphere.radius=t.radius,this.updated.emit(t)}toJSON(){const t=super.toJSON();return t.radius=this.geomItem.getGeometry().radius,t}changeFromJSON(t){t.radius&&(this.geomItem.getGeometry().radius=t.radius)}}A$2.registerChange("CreateSphereChange",Ee$2);class Ae$2 extends Te$2{constructor(t,e){super("Create Cuboid"),this.cuboid=new Ot$1(0,0,0,!0);const i=new Pe$1("Cuboid","SimpleSurfaceShader");this.geomItem=new oa$1("Cuboid"),this.geomItem.setGeometry(this.cuboid),this.geomItem.setMaterial(i),t&&e&&this.setParentAndXfo(t,e)}update(t){if(t.baseSize&&this.cuboid.setBaseSize(t.baseSize[0],t.baseSize[1]),t.tr){const e=this.geomItem.getParameter("LocalXfo").getValue();e.tr.fromJSON(t.tr),this.geomItem.getParameter("LocalXfo").setValue(e)}t.height&&(this.cuboid.z=t.height),this.updated.emit(t)}}A$2.registerChange("CreateCuboidChange",Ae$2);class He$2 extends H$2{constructor(t,e=.5,i=.02,n=new y$3(1,1,0)){super(t),this.lengthParam=this.addParameter(new Ze$1("Length",e)),this.handleRadiusParam=this.addParameter(new Ze$1("Handle Radius",i)),this.barRadiusParam=this.addParameter(new Ze$1("Bar Radius",.25*i)),this.colorParam=this.addParameter(new Ie$1("Color",n)),this.hilghlightColorParam=this.addParameter(new Ie$1("Highlight Color",new y$3(1,1,1))),this.handleMat=new Pe$1("handle","FlatSurfaceShader"),this.handleMat.getParameter("BaseColor").setValue(this.colorParam.getValue());const s=new Pe$1("topBar","FlatSurfaceShader");s.getParameter("BaseColor").setValue(new y$3(.5,.5,.5));const o=new Qt$1(.25*i,1,64,2,!0,!0),r=new qt$1(i,64);this.handle=new oa$1("handle",r,this.handleMat),this.baseBar=new oa$1("baseBar",o,this.handleMat),this.topBar=new oa$1("topBar",o,s),this.handleXfo=new S$1,this.baseBarXfo=new S$1,this.topBarXfo=new S$1,this.barRadiusParam.valueChanged.connect(()=>{o.getParameter("radius").setValue(this.barRadiusParam.getValue())}),this.handleRadiusParam.valueChanged.connect(()=>{r.getParameter("radius").setValue(this.handleRadiusParam.getValue())}),this.lengthParam.valueChanged.connect(()=>{this.__updateSlider(this.value)}),this.colorParam.valueChanged.connect(()=>{this.handleMat.getParameter("BaseColor").setValue(this.colorParam.getValue())}),this.addChild(this.handle),this.addChild(this.baseBar),this.addChild(this.topBar),this.__updateSlider(0)}highlight(){this.handleMat.getParameter("BaseColor").setValue(this.hilghlightColorParam.getValue())}unhighlight(){this.handleMat.getParameter("BaseColor").setValue(this.colorParam.getValue())}setTargetParam(t){this.param=t;const e=()=>{this.__updateSlider(t.getValue())};e(),t.valueChanged.connect(e)}__updateSlider(t){this.value=t;const e=this.param&&this.param.getRange()?this.param.getRange():[0,1],i=Math.remap(t,e[0],e[1],0,1),n=this.lengthParam.getValue();this.baseBarXfo.sc.z=i*n,this.handleXfo.tr.z=i*n,this.topBarXfo.tr.z=i*n,this.topBarXfo.sc.z=(1-i)*n,this.handle.setLocalXfo(this.handleXfo,E$1.GENERATED_VALUE),this.baseBar.setLocalXfo(this.baseBarXfo,E$1.GENERATED_VALUE),this.topBar.setLocalXfo(this.topBarXfo,E$1.GENERATED_VALUE)}onDragStart(t){this.handleXfo.sc.x=this.handleXfo.sc.y=this.handleXfo.sc.z=1.2,this.handle.setLocalXfo(this.handleXfo,E$1.GENERATED_VALUE),this.param&&t.undoRedoManager&&(this.change=new N$2(this.param),t.undoRedoManager.addChange(this.change))}onDrag(t){const e=this.lengthParam.getValue(),i=this.param&&this.param.getRange()?this.param.getRange():[0,1],n=Math.clamp(Math.remap(t.value,0,e,i[0],i[1]),i[0],i[1]);if(!this.param)return this.__updateSlider(n),void(this.value=n);this.change?this.change.update({value:n}):this.param.setValue(n)}onDragEnd(t){this.change=null,this.handleXfo.sc.x=this.handleXfo.sc.y=this.handleXfo.sc.z=1,this.handle.setLocalXfo(this.handleXfo,E$1.GENERATED_VALUE)}toJSON(t,e=0){const i=super.toJSON(t,e|SAVE_FLAG_SKIP_CHILDREN);return this.param&&(i.targetParam=this.param.getPath()),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.targetParam&&e.resolvePath(t.targetParam).then(t=>{this.setTargetParam(t)})}}J$1.registerClass("SliderHandle",He$2);class Ne$2 extends z$2{constructor(t,e=1,i=1,n=.02,s=new y$3(1,1,0)){super(t),this.arcRadiusParam=this.addParameter(new Ze$1("Arc Radius",e)),this.arcAngleParam=this.addParameter(new Ze$1("Arc Angle",i)),this.handleRadiusParam=this.addParameter(new Ze$1("Handle Radius",n)),this.colorParam=this.addParameter(new Ie$1("Color",s)),this.hilghlightColorParam=this.addParameter(new Ie$1("Highlight Color",new y$3(1,1,1))),this.handleMat=new Pe$1("handleMat","HandleShader");const o=new Et$1(e,i,64),r=new qt$1(n,64);this.handle=new oa$1("handle",r,this.handleMat),this.arc=new oa$1("arc",o,this.handleMat),this.handleXfo=new S$1,this.handleGeomOffsetXfo=new S$1,this.handleGeomOffsetXfo.tr.x=e,this.handle.getParameter("GeomOffsetXfo").setValue(this.handleGeomOffsetXfo),this.range=[0,i],this.arcAngleParam.valueChanged.connect(()=>{const t=this.arcAngleParam.getValue();o.getParameter("Angle").setValue(t),this.range=[0,t]}),this.arcRadiusParam.valueChanged.connect(()=>{const t=this.arcRadiusParam.getValue();o.getParameter("Radius").setValue(t),this.handleGeomOffsetXfo.tr.x=t,this.handle.getParameter("GeomOffsetXfo").setValue(this.handleGeomOffsetXfo)}),this.handleRadiusParam.valueChanged.connect(()=>{r.getParameter("radius").setValue(this.handleRadiusParam.getValue())}),this.colorParam.valueChanged.connect(()=>{this.handleMat.getParameter("BaseColor").setValue(this.colorParam.getValue())}),this.addChild(this.handle),this.addChild(this.arc),this.setTargetParam(this.handle.getParameter("GlobalXfo"),!1),this.dragStart=new C$1,this.dragEnd=new C$1}onMouseEnter(t){t.intersectionData&&t.intersectionData.geomItem==this.handle&&this.highlight()}onMouseLeave(t){this.unhighlight()}onMouseDown(t){t.intersectionData&&t.intersectionData.geomItem==this.handle&&super.onMouseDown(t)}highlight(){this.handleMat.getParameter("BaseColor").setValue(this.hilghlightColorParam.getValue())}unhighlight(){this.handleMat.getParameter("BaseColor").setValue(this.colorParam.getValue())}getBaseXfo(){return this.handle.getParameter("GlobalXfo").getValue()}onDragStart(t){this.baseXfo=this.getGlobalXfo().clone(),this.baseXfo.sc.set(1,1,1),this.deltaXfo=new S$1,this.vec0=this.getGlobalXfo().ori.getXaxis(),this.vec0.normalizeInPlace(),t.undoRedoManager&&(this.change=new N$2(this.param),t.undoRedoManager.addChange(this.change)),this.handleGeomOffsetXfo.sc.x=this.handleGeomOffsetXfo.sc.y=this.handleGeomOffsetXfo.sc.z=1.2,this.handle.getParameter("GeomOffsetXfo").setValue(this.handleGeomOffsetXfo),this.dragStart.emit()}onDrag(t){const e=t.holdPos.subtract(this.baseXfo.tr);e.normalizeInPlace();let i=this.vec0.angleTo(e);if(this.vec0.cross(e).dot(this.baseXfo.ori.getZaxis())<0&&(i=-i),this.range&&(i=Math.clamp(i,this.range[0],this.range[1])),t.shiftKey){const t=Math.degToRad(22.5);i=Math.floor(i/t)*t}this.deltaXfo.ori.setFromAxisAndAngle(new Vec3(0,0,1),i);const n=this.baseXfo.multiply(this.deltaXfo);this.change?this.change.update({value:n}):(this.param?this.param:this.getParameter("GlobalXfo")).setValue(n)}onDragEnd(t){this.change=null,this.handleGeomOffsetXfo.sc.x=this.handleGeomOffsetXfo.sc.y=this.handleGeomOffsetXfo.sc.z=1,this.handle.getParameter("GeomOffsetXfo").setValue(this.handleGeomOffsetXfo),this.dragEnd.emit()}toJSON(t,e=0){const i=super.toJSON(t,e|SAVE_FLAG_SKIP_CHILDREN);return this.param&&(i.targetParam=this.param.getPath()),i}fromJSON(t,e,i){super.fromJSON(t,e,i),t.targetParam&&e.resolvePath(t.targetParam).then(t=>{this.setTargetParam(t)})}}J$1.registerClass("ArcSlider",Ne$2);class Be$2 extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"}),e=document.createElement("style");e.appendChild(document.createTextNode(Be$2.css)),t.appendChild(e),this.itemContainer=document.createElement("div"),this.itemHeader=document.createElement("div"),this.itemHeader.className="TreeNodeHeader",this.itemContainer.appendChild(this.itemHeader),this.itemChildren=document.createElement("div"),this.itemChildren.className="TreeNodesList",this.itemContainer.appendChild(this.itemChildren),this.expandBtn=document.createElement("button"),this.expandBtn.className="TreeNodesListItem__ToggleExpanded",this.itemHeader.appendChild(this.expandBtn),this.expanded=!1,this.childrenAlreadyCreated=!1,this.expandBtn.addEventListener("click",()=>{this.treeItem.getNumChildren()>0&&(this.expanded?this.collapse():this.expand())}),this.titleElement=document.createElement("span"),this.titleElement.className="TreeNodesListItem__Title",this.titleElement.addEventListener("click",t=>{this.appData&&this.appData.selectionManager?this.appData.selectionManager.pickingModeActive()?this.appData.selectionManager.pick(this.treeItem):this.appData.selectionManager.toggleItemSelection(this.treeItem,!t.ctrlKey):this.treeItem.setSelected(!this.treeItem.getSelected())}),this.itemHeader.appendChild(this.titleElement),t.appendChild(this.itemContainer)}setTreeItem(t,e){this.treeItem=t,this.appData=e,this.titleElement.textContent=t.getName(),this.treeItem.nameChanged.connect(()=>{this.titleElement.textContent=t.getName()}),this.updateSelectedId=this.treeItem.selectedChanged.connect(this.updateSelected.bind(this)),this.updateSelected(),t instanceof ia$1&&(this.toggleVisibilityBtn=document.createElement("button"),this.toggleVisibilityBtn.className="TreeNodesListItem__ToggleVisibility",this.itemHeader.insertBefore(this.toggleVisibilityBtn,this.titleElement),this.toggleVisibilityBtn.innerHTML='<i class="material-icons-outlined md-15">visibility</i>',this.toggleVisibilityBtn.addEventListener("click",()=>{const t=this.treeItem.getParameter("Visible");if(this.appData&&this.appData.undoRedoManager){const e=new ParameterValueChange(t,!t.getValue());this.appData.undoRedoManager.addChange(e)}else t.setValue(!t.getValue())}),this.updateVisibilityId=this.treeItem.visibilityChanged.connect(this.updateVisibility.bind(this)),this.updateVisibility(),this.updateHighlightId=this.treeItem.highlightChanged.connect(this.updateHighlight.bind(this)),this.updateHighlight(),this.treeItem.getChildren().length&&this.collapse(),this.childAddedId=this.treeItem.childAdded.connect(this.childAdded.bind(this)),this.childRemovedId=this.treeItem.childRemoved.connect(this.childRemoved.bind(this)))}updateVisibility(){const t=this.treeItem.getVisible();t?this.itemContainer.classList.remove("TreeNodesListItem--isHidden"):this.itemContainer.classList.add("TreeNodesListItem--isHidden"),this.toggleVisibilityBtn.innerHTML=t?'<i class="material-icons-outlined md-15">visibility</i>':'<i class="material-icons-outlined md-15">visibility_off</i>'}updateSelected(){this.treeItem.getSelected()?this.itemContainer.classList.add("TreeNodesListItem--isSelected"):this.itemContainer.classList.remove("TreeNodesListItem--isSelected")}updateHighlight(){const t=this.treeItem.isHighlighted();if(t?this.itemContainer.classList.add("TreeNodesListItem--isHighlighted"):this.itemContainer.classList.remove("TreeNodesListItem--isHighlighted"),t){const t=this.treeItem.getHighlight(),e=t.lerp(new y$3(.75,.75,.75,0),.5);this.titleElement.style.setProperty("border-color",t.toHex()),this.titleElement.style.setProperty("background-color",e.toHex())}else this.titleElement.style.removeProperty("border-color"),this.titleElement.style.removeProperty("background-color")}expand(){this.expanded=!0,this.itemChildren.classList.remove("TreeNodesList--collapsed"),this.expandBtn.innerHTML='<i class="material-icons md-24">arrow_drop_down</i>',this.childrenAlreadyCreated||(this.treeItem.getChildren().forEach((t,e)=>{this.addChild(t,e)}),this.childrenAlreadyCreated=!0)}collapse(){this.itemChildren.classList.add("TreeNodesList--collapsed"),this.expandBtn.innerHTML='<i class="material-icons md-24">arrow_right</i>',this.expanded=!1}addChild(t,e){if(this.expanded){const i=document.createElement("tree-item-view");i.setTreeItem(t,this.appData),e==this.itemChildren.childElementCount?this.itemChildren.appendChild(i):this.itemChildren.insertBefore(i,this.itemChildren.children[e])}else this.collapse()}childAdded(t,e){this.addChild(t,e)}childRemoved(t,e){this.expanded&&(this.itemChildren.children[e].destroy(),this.itemChildren.removeChild(this.itemChildren.children[e]))}destroy(){this.treeItem.selectedChanged.disconnectId(this.updateSelectedId),this.treeItem instanceof ia$1&&(this.treeItem.highlightChanged.disconnectId(this.updateHighlightId),this.treeItem.visibilityChanged.disconnectId(this.updateVisibilityId),this.treeItem.childAdded.disconnectId(this.childAddedId),this.treeItem.childRemoved.disconnectId(this.childRemovedId))}}Be$2.css="\n  /* tree-view.css */\n\n  ////\n  /// From https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined\n\n  /* fallback */\n  @font-face {\n    font-family: 'Material Icons';\n    font-style: normal;\n    font-weight: 400;\n    src: url(https://fonts.gstatic.com/s/materialicons/v48/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format('woff2');\n  }\n  /* fallback */\n  @font-face {\n    font-family: 'Material Icons Outlined';\n    font-style: normal;\n    font-weight: 400;\n    src: url(https://fonts.gstatic.com/s/materialiconsoutlined/v14/gok-H7zzDkdnRel8-DQ6KAXJ69wP1tGnf4ZGhUce.woff2) format('woff2');\n  }\n\n  .material-icons {\n    font-family: 'Material Icons';\n    font-weight: normal;\n    font-style: normal;\n    font-size: 24px;\n    line-height: 1;\n    letter-spacing: normal;\n    text-transform: none;\n    display: inline-block;\n    white-space: nowrap;\n    word-wrap: normal;\n    direction: ltr;\n    -webkit-font-feature-settings: 'liga';\n    -webkit-font-smoothing: antialiased;\n  }\n\n  .material-icons-outlined {\n    font-family: 'Material Icons Outlined';\n    font-weight: normal;\n    font-style: normal;\n    font-size: 24px;\n    line-height: 1;\n    letter-spacing: normal;\n    text-transform: none;\n    display: inline-block;\n    white-space: nowrap;\n    word-wrap: normal;\n    direction: ltr;\n    -webkit-font-feature-settings: 'liga';\n    -webkit-font-smoothing: antialiased;\n  }\n  .TreeNodesList {\n    border-left: 1px dotted;\n    list-style-type: none;\n    padding: 0 0 0 15px;\n    margin: 0 0 0 10px;\n  }\n\n  .TreeNodesList--collapsed {\n    display: none;\n  }\n\n  .TreeNodesList--root {\n    border: none;\n    margin: 0;\n    padding: 0;\n    width: max-content;\n  }\n\n  .TreeNodesListItem{\n    display: flex;\n  }\n\n  .TreeNodesListItem__ToggleVisibility {\n    border: none;\n    color: #333;\n    height: 24px;\n    padding: 0;\n    width: 25px;\n  }\n\n  .TreeNodesListItem__ToggleVisibility:focus {\n    outline: none;\n  }\n\n  .TreeNodesListItem__ToggleExpanded {\n    border: none;\n    height: 24px;\n    width: 24px;\n    padding: 0;\n    background-color: #0000;\n    outline: none;\n  }\n\n  .TreeNodesListItem::before {\n    border-bottom: 1px dotted;\n    content: '';\n    display: inline-block;\n    left: -15px;\n    position: relative;\n    top: -5px;\n    width: 10px;\n  }\n\n  .TreeNodesListItem__Toggle:focus {\n    outline: none;\n  }\n\n  .TreeNodeHeader{\n    display: flex;\n    margin: 0.4em auto;\n  }\n\n  .TreeNodesListItem__Title {\n    cursor: default;\n    padding: 2px 4px;\n    border-radius: 5px;\n  }\n\n  .TreeNodesListItem__Title:hover {\n    background-color: #e1f5fe;\n  }\n  .TreeNodesListItem__Hover {\n    background-color: #e1f5fe;\n  }\n\n  .TreeNodesListItem__Dragging {\n    background-color: #e1f5fe;\n  }\n\n  .TreeNodesListItem--isSelected > .TreeNodeHeader > .TreeNodesListItem__Title {\n    background-color: #76d2bb;\n    color: #3B3B3B;\n  }\n\n  .TreeNodesListItem--isHidden > .TreeNodeHeader >  .TreeNodesListItem__Title {\n    color: #9e9e9e;\n  }\n\n  .TreeNodesListItem--isHighlighted > .TreeNodeHeader >  .TreeNodesListItem__Title {\n    border-style: solid;\n    border-width: thin;\n  }\n\n  /* Rules for sizing the icon. */\n  .material-icons-outlined.md-15,\n  .material-icons.md-15 {\n    font-size: 15px;\n  }\n  .material-icons.md-18 {\n    font-size: 18px;\n  }\n  .material-icons.md-24 {\n    font-size: 24px;\n  }\n  .material-icons.md-36 {\n    font-size: 36px;\n  }\n  .material-icons.md-48 {\n    font-size: 48px;\n  }\n\n  /* Rules for using icons as black on a light background. */\n  .material-icons.md-dark {\n    color: rgba(0, 0, 0, 0.54);\n  }\n  .material-icons.md-dark.md-inactive {\n    color: rgba(0, 0, 0, 0.26);\n  }\n\n  /* Rules for using icons as white on a dark background. */\n  .material-icons.md-light {\n    color: rgba(255, 255, 255, 1);\n  }\n  .material-icons.md-light.md-inactive {\n    color: rgba(255, 255, 255, 0.3);\n  }\n\n  ",customElements.get("tree-item-view")||customElements.define("tree-item-view",Be$2);class ze$2 extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"});this.treeContainer=document.createElement("div"),t.appendChild(this.treeContainer),this.treeItemView=document.createElement("tree-item-view");const e=new CSSStyleSheet;e.replaceSync("@font-face {\n      font-family: \"Material Icons\";\n      font-style: normal;\n      font-weight: 400;\n      src: url('https://fonts.gstatic.com/s/materialicons/v48/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2') format('woff');\n    }");const i=new CSSStyleSheet;i.replaceSync("@font-face {\n      font-family: \"Material Icons Outlined\";\n      font-style: normal;\n      font-weight: 400;\n      src: url('https://fonts.gstatic.com/s/materialiconsoutlined/v14/gok-H7zzDkdnRel8-DQ6KAXJ69wP1tGnf4ZGhUce.woff2') format('woff');\n    }"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e,i]}setTreeItem(t,e){this.treeItemView.setTreeItem(t,e),this.treeContainer.appendChild(this.treeItemView)}}customElements.get("scene-tree-view")||customElements.define("scene-tree-view",ze$2);const zeaParamWidgetBboxCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-bbox{color:var(--color-foreground-1);background-color:var(--color-background-2);max-width:400px}input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);background-color:var(--color-background-3);text-align:right;color:var(--color-foreground-1)}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}.input-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:0.5em}.input-wrap label{font-size:0.7em;padding:0.3em 1em 0.3em 0.3em;opacity:0.5;width:1.5em;text-align:center}fieldset{border:1px solid var(--color-grey-3)}legend{color:var(--color-foreground-2);font-size:0.8em}",ZeaParamWidgetBbox=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}componentDidLoad(){this.parameter&&(this.setUpInputs(),this.onValueChanged())}setUpInputs(){this.parameter.on("valueChanged",()=>{this.onValueChanged()})}onValueChanged(){if(!this.change){const t=this.parameter.getValue();t.isValid()&&(this.minxField.value=t.p0.x,this.minyField.value=t.p0.y,this.minzField.value=t.p0.z,this.maxxField.value=t.p1.x,this.maxyField.value=t.p1.y,this.maxzField.value=t.p1.z)}}onInput(){const t=new v;t.p0.set(this.minxField.valueAsNumber,this.minyField.valueAsNumber,this.minzField.valueAsNumber),t.p1.set(this.maxxField.valueAsNumber,this.maxyField.valueAsNumber,this.maxzField.valueAsNumber),this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),A$2.getInstance().addChange(this.change))}onChange(){this.onInput(),this.change=void 0}render(){return h("div",{class:"zea-param-widget-bbox",ref:t=>this.container=t},h("fieldset",null,h("legend",null,"Min"),h("div",{class:"input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.minxField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.minyField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.minzField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"}))),h("fieldset",null,h("legend",null,"Max"),h("div",{class:"input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.maxxField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.maxyField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.maxzField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"}))))}static get style(){return zeaParamWidgetBboxCss}};uxFactory.registerWidget("zea-param-widget-bbox",t=>t.getValue()instanceof v);const zeaParamWidgetBooleanCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-boolean{color:var(--color-foreground-1);background-color:var(--color-background-2)}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}",ZeaParamWidgetBoolean=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.checked=!1,this.inputChanged=this.inputChanged.bind(this)}componentDidLoad(){this.parameter&&(this.checked=this.parameter.getValue(),this.parameter.on("valueChanged",()=>{this.checked=this.parameter.getValue()}))}inputChanged(){if(this.appData.undoRedoManager){const t=new N$2(this.parameter,this.cheboxInput.checked);this.appData.undoRedoManager.addChange(t)}else this.parameter.setValue(this.cheboxInput.checked)}render(){return h("div",{class:"zea-param-widget-boolean"},h("input",{onChange:this.inputChanged,ref:t=>this.cheboxInput=t,type:"checkbox",name:this.parameter.getName(),tabindex:"0",checked:this.checked}))}static get style(){return zeaParamWidgetBooleanCss}};uxFactory.registerWidget("zea-param-widget-boolean",t=>t.constructor.name==Xe.name),function(){var t=function(){return this}();t||"undefined"==typeof window||(t=window);var e=function(t,i,n){"string"==typeof t?(2==arguments.length&&(n=i),e.modules[t]||(e.payloads[t]=n,e.modules[t]=null)):e.original?e.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};e.modules={},e.payloads={};var i,n=function(t,e,i){if("string"==typeof e){var n=r(t,e);if(null!=n)return i&&i(),n}else if("[object Array]"===Object.prototype.toString.call(e)){for(var o=[],a=0,l=e.length;a<l;++a){var c=r(t,e[a]);if(null==c&&s.original)return;o.push(c)}return i&&i.apply(null,o)||!0}},s=function(t,e){var i=n("",t,e);return null==i&&s.original?s.original.apply(this,arguments):i},o=function(t,e){if(-1!==e.indexOf("!")){var i=e.split("!");return o(t,i[0])+"!"+o(t,i[1])}if("."==e.charAt(0))for(e=t.split("/").slice(0,-1).join("/")+"/"+e;-1!==e.indexOf(".")&&n!=e;){var n=e;e=e.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return e},r=function(t,i){i=o(t,i);var s=e.modules[i];if(!s){if("function"==typeof(s=e.payloads[i])){var r={},a={id:i,uri:"",exports:r,packaged:!0},l=s((function(t,e){return n(i,t,e)}),r,a);e.modules[i]=r=l||a.exports,delete e.payloads[i]}s=e.modules[i]=r||s}return s};i=t,t.ace||(t.ace={}),(i=t.ace).define&&i.define.packaged||(e.original=i.define,i.define=e,i.define.packaged=!0),i.acequire&&i.acequire.packaged||(s.original=i.acequire,i.acequire=s,i.acequire.packaged=!0)}(),ace.define("ace/lib/regexp",["require","exports","module"],(function(){var t={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},e=void 0===t.exec.call(/()??/,"")[1],i=function(){var e=/^/g;return t.test.call(e,""),!e.lastIndex}();function n(t){return(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":"")}function s(t,e,i){if(Array.prototype.indexOf)return t.indexOf(e,i);for(var n=i||0;n<t.length;n++)if(t[n]===e)return n;return-1}i&&e||(RegExp.prototype.exec=function(o){var r,a,l=t.exec.apply(this,arguments);if("string"==typeof o&&l){if(!e&&l.length>1&&s(l,"")>-1&&(a=RegExp(this.source,t.replace.call(n(this),"g","")),t.replace.call(o.slice(l.index),a,(function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(l[t]=void 0)}))),this._xregexp&&this._xregexp.captureNames)for(var c=1;c<l.length;c++)(r=this._xregexp.captureNames[c-1])&&(l[r]=l[c]);!i&&this.global&&!l[0].length&&this.lastIndex>l.index&&this.lastIndex--}return l},i||(RegExp.prototype.test=function(e){var i=t.exec.call(this,e);return i&&this.global&&!i[0].length&&this.lastIndex>i.index&&this.lastIndex--,!!i}))})),ace.define("ace/lib/es5-shim",["require","exports","module"],(function(){function t(){}Function.prototype.bind||(Function.prototype.bind=function(e){var i=this;if("function"!=typeof i)throw new TypeError("Function.prototype.bind called on incompatible "+i);var n=l.call(arguments,1),s=function(){if(this instanceof s){var t=i.apply(this,n.concat(l.call(arguments)));return Object(t)===t?t:this}return i.apply(e,n.concat(l.call(arguments)))};return i.prototype&&(t.prototype=i.prototype,s.prototype=new t,t.prototype=null),s});var e,i,n,s,o,r=Function.prototype.call,a=Object.prototype,l=Array.prototype.slice,c=r.bind(a.toString),h=r.bind(a.hasOwnProperty);if((o=h(a,"__defineGetter__"))&&(e=r.bind(a.__defineGetter__),i=r.bind(a.__defineSetter__),n=r.bind(a.__lookupGetter__),s=r.bind(a.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function t(t){var e=new Array(t+2);return e[0]=e[1]=0,e}var e,i=[];if(i.splice.apply(i,t(20)),i.splice.apply(i,t(26)),e=i.length,i.splice(5,0,"XXX"),e+1==i.length)return!0}()){var d=Array.prototype.splice;Array.prototype.splice=function(t,e){return arguments.length?d.apply(this,[void 0===t?0:t,void 0===e?this.length-t:e].concat(l.call(arguments,2))):[]}}else Array.prototype.splice=function(t,e){var i=this.length;t>0?t>i&&(t=i):null==t?t=0:t<0&&(t=Math.max(i+t,0)),t+e<i||(e=i-t);var n=this.slice(t,t+e),s=l.call(arguments,2),o=s.length;if(t===i)o&&this.push.apply(this,s);else{var r=Math.min(e,i-t),a=t+r,c=a+o-r,h=i-a,d=i-r;if(c<a)for(var u=0;u<h;++u)this[c+u]=this[a+u];else if(c>a)for(u=h;u--;)this[c+u]=this[a+u];if(o&&t===d)this.length=d,this.push.apply(this,s);else for(this.length=d+o,u=0;u<o;++u)this[t+u]=s[u]}return n};Array.isArray||(Array.isArray=function(t){return"[object Array]"==c(t)});var u,m,p=Object("a"),b="a"!=p[0]||!(0 in p);function f(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(exception){}}if(Array.prototype.forEach||(Array.prototype.forEach=function(t){var e=R(this),i=b&&"[object String]"==c(this)?this.split(""):e,n=arguments[1],s=-1,o=i.length>>>0;if("[object Function]"!=c(t))throw new TypeError;for(;++s<o;)s in i&&t.call(n,i[s],s,e)}),Array.prototype.map||(Array.prototype.map=function(t){var e=R(this),i=b&&"[object String]"==c(this)?this.split(""):e,n=i.length>>>0,s=Array(n),o=arguments[1];if("[object Function]"!=c(t))throw new TypeError(t+" is not a function");for(var r=0;r<n;r++)r in i&&(s[r]=t.call(o,i[r],r,e));return s}),Array.prototype.filter||(Array.prototype.filter=function(t){var e,i=R(this),n=b&&"[object String]"==c(this)?this.split(""):i,s=n.length>>>0,o=[],r=arguments[1];if("[object Function]"!=c(t))throw new TypeError(t+" is not a function");for(var a=0;a<s;a++)a in n&&t.call(r,e=n[a],a,i)&&o.push(e);return o}),Array.prototype.every||(Array.prototype.every=function(t){var e=R(this),i=b&&"[object String]"==c(this)?this.split(""):e,n=i.length>>>0,s=arguments[1];if("[object Function]"!=c(t))throw new TypeError(t+" is not a function");for(var o=0;o<n;o++)if(o in i&&!t.call(s,i[o],o,e))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){var e=R(this),i=b&&"[object String]"==c(this)?this.split(""):e,n=i.length>>>0,s=arguments[1];if("[object Function]"!=c(t))throw new TypeError(t+" is not a function");for(var o=0;o<n;o++)if(o in i&&t.call(s,i[o],o,e))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e=R(this),i=b&&"[object String]"==c(this)?this.split(""):e,n=i.length>>>0;if("[object Function]"!=c(t))throw new TypeError(t+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var s,o=0;if(arguments.length>=2)s=arguments[1];else for(;;){if(o in i){s=i[o++];break}if(++o>=n)throw new TypeError("reduce of empty array with no initial value")}for(;o<n;o++)o in i&&(s=t.call(void 0,s,i[o],o,e));return s}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var e=R(this),i=b&&"[object String]"==c(this)?this.split(""):e,n=i.length>>>0;if("[object Function]"!=c(t))throw new TypeError(t+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var s,o=n-1;if(arguments.length>=2)s=arguments[1];else for(;;){if(o in i){s=i[o--];break}if(--o<0)throw new TypeError("reduceRight of empty array with no initial value")}do{o in this&&(s=t.call(void 0,s,i[o],o,e))}while(o--);return s}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(t){var e=b&&"[object String]"==c(this)?this.split(""):R(this),i=e.length>>>0;if(!i)return-1;var n=0;for(arguments.length>1&&(n=S(arguments[1])),n=n>=0?n:Math.max(0,i+n);n<i;n++)if(n in e&&e[n]===t)return n;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(t){var e=b&&"[object String]"==c(this)?this.split(""):R(this),i=e.length>>>0;if(!i)return-1;var n=i-1;for(arguments.length>1&&(n=Math.min(n,S(arguments[1]))),n=n>=0?n:i-Math.abs(n);n>=0;n--)if(n in e&&t===e[n])return n;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.__proto__||(t.constructor?t.constructor.prototype:a)}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+t);if(h(t,e)){var i;if(i={enumerable:!0,configurable:!0},o){var r=t.__proto__;t.__proto__=a;var l=n(t,e),c=s(t,e);if(t.__proto__=r,l||c)return l&&(i.get=l),c&&(i.set=c),i}return i.value=t[e],i}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),Object.create||(u=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var t={};for(var e in t)t[e]=null;return t.constructor=t.hasOwnProperty=t.propertyIsEnumerable=t.isPrototypeOf=t.toLocaleString=t.toString=t.valueOf=t.__proto__=null,t},Object.create=function(t,e){var i;if(null===t)i=u();else{if("object"!=typeof t)throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var n=function(){};n.prototype=t,(i=new n).__proto__=t}return void 0!==e&&Object.defineProperties(i,e),i}),Object.defineProperty){var g=f({}),y="undefined"==typeof document||f(document.createElement("div"));if(!g||!y)var v=Object.defineProperty}Object.defineProperty&&!v||(Object.defineProperty=function(t,r,l){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.defineProperty called on non-object: "+t);if("object"!=typeof l&&"function"!=typeof l||null===l)throw new TypeError("Property description must be an object: "+l);if(v)try{return v.call(Object,t,r,l)}catch(exception){}if(h(l,"value"))if(o&&(n(t,r)||s(t,r))){var c=t.__proto__;t.__proto__=a,delete t[r],t[r]=l.value,t.__proto__=c}else t[r]=l.value;else{if(!o)throw new TypeError("getters & setters can not be defined on this javascript engine");h(l,"get")&&e(t,r,l.get),h(l,"set")&&i(t,r,l.set)}return t}),Object.defineProperties||(Object.defineProperties=function(t,e){for(var i in e)h(e,i)&&Object.defineProperty(t,i,e[i]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze((function(){}))}catch(exception){Object.freeze=(m=Object.freeze,function(t){return"function"==typeof t?t:m(t)})}if(Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)===t)throw new TypeError;for(var e="";h(t,e);)e+="?";t[e]=!0;var i=h(t,e);return delete t[e],i}),!Object.keys){var Z=!0,x=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],G=x.length;for(var X in{toString:null})Z=!1;Object.keys=function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.keys called on a non-object");var e=[];for(var i in t)h(t,i)&&e.push(i);if(Z)for(var n=0,s=G;n<s;n++){var o=x[n];h(t,o)&&e.push(o)}return e}}Date.now||(Date.now=function(){return(new Date).getTime()});var w="\t\n\v\f\r \u2028\u2029\ufeff";if(!String.prototype.trim||w.trim()){w="["+w+"]";var V=new RegExp("^"+w+w+"*"),I=new RegExp(w+w+"*$");String.prototype.trim=function(){return String(this).replace(V,"").replace(I,"")}}function S(t){return(t=+t)!=t?t=0:0!==t&&t!==1/0&&t!==-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}var R=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)}})),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],(function(t){t("./regexp"),t("./es5-shim")})),ace.define("ace/lib/dom",["require","exports","module"],(function(t,e){e.getDocumentHead=function(t){return t||(t=document),t.head||t.getElementsByTagName("head")[0]||t.documentElement},e.createElement=function(t,e){return document.createElementNS?document.createElementNS(e||"http://www.w3.org/1999/xhtml",t):document.createElement(t)},e.hasCssClass=function(t,e){return-1!==(t.className+"").split(/\s+/g).indexOf(e)},e.addCssClass=function(t,i){e.hasCssClass(t,i)||(t.className+=" "+i)},e.removeCssClass=function(t,e){for(var i=t.className.split(/\s+/g);;){var n=i.indexOf(e);if(-1==n)break;i.splice(n,1)}t.className=i.join(" ")},e.toggleCssClass=function(t,e){for(var i=t.className.split(/\s+/g),n=!0;;){var s=i.indexOf(e);if(-1==s)break;n=!1,i.splice(s,1)}return n&&i.push(e),t.className=i.join(" "),n},e.setCssClass=function(t,i,n){n?e.addCssClass(t,i):e.removeCssClass(t,i)},e.hasCssString=function(t,e){var i,n=0;if((e=e||document).createStyleSheet&&(i=e.styleSheets)){for(;n<i.length;)if(i[n++].owningElement.id===t)return!0}else if(i=e.getElementsByTagName("style"))for(;n<i.length;)if(i[n++].id===t)return!0;return!1},e.importCssString=function(t,i,n){if(n=n||document,i&&e.hasCssString(i,n))return null;var s;i&&(t+="\n/*# sourceURL=ace/css/"+i+" */"),n.createStyleSheet?((s=n.createStyleSheet()).cssText=t,i&&(s.owningElement.id=i)):((s=e.createElement("style")).appendChild(n.createTextNode(t)),i&&(s.id=i),e.getDocumentHead(n).appendChild(s))},e.importCssStylsheet=function(t,i){if(i.createStyleSheet)i.createStyleSheet(t);else{var n=e.createElement("link");n.rel="stylesheet",n.href=t,e.getDocumentHead(i).appendChild(n)}},e.getInnerWidth=function(t){return parseInt(e.computedStyle(t,"paddingLeft"),10)+parseInt(e.computedStyle(t,"paddingRight"),10)+t.clientWidth},e.getInnerHeight=function(t){return parseInt(e.computedStyle(t,"paddingTop"),10)+parseInt(e.computedStyle(t,"paddingBottom"),10)+t.clientHeight},e.scrollbarWidth=function(t){var i=e.createElement("ace_inner");i.style.width="100%",i.style.minWidth="0px",i.style.height="200px",i.style.display="block";var n=e.createElement("ace_outer"),s=n.style;s.position="absolute",s.left="-10000px",s.overflow="hidden",s.width="200px",s.minWidth="0px",s.height="150px",s.display="block",n.appendChild(i);var o=t.documentElement;o.appendChild(n);var r=i.offsetWidth;s.overflow="scroll";var a=i.offsetWidth;return r==a&&(a=n.clientWidth),o.removeChild(n),r-a},"undefined"!=typeof document?(void 0!==window.pageYOffset?(e.getPageScrollTop=function(){return window.pageYOffset},e.getPageScrollLeft=function(){return window.pageXOffset}):(e.getPageScrollTop=function(){return document.body.scrollTop},e.getPageScrollLeft=function(){return document.body.scrollLeft}),e.computedStyle=window.getComputedStyle?function(t,e){return e?(window.getComputedStyle(t,"")||{})[e]||"":window.getComputedStyle(t,"")||{}}:function(t,e){return e?t.currentStyle[e]:t.currentStyle},e.setInnerHtml=function(t,e){var i=t.cloneNode(!1);return i.innerHTML=e,t.parentNode.replaceChild(i,t),i},"textContent"in document.documentElement?(e.setInnerText=function(t,e){t.textContent=e},e.getInnerText=function(t){return t.textContent}):(e.setInnerText=function(t,e){t.innerText=e},e.getInnerText=function(t){return t.innerText}),e.getParentWindow=function(t){return t.defaultView||t.parentWindow}):e.importCssString=function(){}})),ace.define("ace/lib/oop",["require","exports","module"],(function(t,e){e.inherits=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},e.mixin=function(t,e){for(var i in e)t[i]=e[i];return t},e.implement=function(t,i){e.mixin(t,i)}})),ace.define("ace/lib/keys",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop"],(function(t,e){t("./fixoldbrowsers");var i=t("./oop"),n=function(){var t,e,n={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(e in n.FUNCTION_KEYS)t=n.FUNCTION_KEYS[e].toLowerCase(),n[t]=parseInt(e,10);for(e in n.PRINTABLE_KEYS)t=n.PRINTABLE_KEYS[e].toLowerCase(),n[t]=parseInt(e,10);return i.mixin(n,n.MODIFIER_KEYS),i.mixin(n,n.PRINTABLE_KEYS),i.mixin(n,n.FUNCTION_KEYS),n.enter=n.return,n.escape=n.esc,n.del=n.delete,n[173]="-",function(){for(var t=["cmd","ctrl","alt","shift"],e=Math.pow(2,t.length);e--;)n.KEY_MODS[e]=t.filter((function(t){return e&n.KEY_MODS[t]})).join("-")+"-"}(),n.KEY_MODS[0]="",n.KEY_MODS[-1]="input-",n}();i.mixin(e,n),e.keyCodeToString=function(t){var e=n[t];return"string"!=typeof e&&(e=String.fromCharCode(t)),e.toLowerCase()}})),ace.define("ace/lib/useragent",["require","exports","module"],(function(t,e){if(e.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},e.getOS=function(){return e.isMac?e.OS.MAC:e.isLinux?e.OS.LINUX:e.OS.WINDOWS},"object"==typeof navigator){var i=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),n=navigator.userAgent;e.isWin="win"==i,e.isMac="mac"==i,e.isLinux="linux"==i,e.isIE="Microsoft Internet Explorer"==navigator.appName||navigator.appName.indexOf("MSAppHost")>=0?parseFloat((n.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((n.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),e.isOldIE=e.isIE&&e.isIE<9,e.isGecko=e.isMozilla=(window.Controllers||window.controllers)&&"Gecko"===window.navigator.product,e.isOldGecko=e.isGecko&&parseInt((n.match(/rv:(\d+)/)||[])[1],10)<4,e.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),e.isWebKit=parseFloat(n.split("WebKit/")[1])||void 0,e.isChrome=parseFloat(n.split(" Chrome/")[1])||void 0,e.isAIR=n.indexOf("AdobeAIR")>=0,e.isIPad=n.indexOf("iPad")>=0,e.isChromeOS=n.indexOf(" CrOS ")>=0,e.isIOS=/iPad|iPhone|iPod/.test(n)&&!window.MSStream,e.isIOS&&(e.isMac=!0)}})),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(t,e){var i=t("./keys"),n=t("./useragent"),s=null,o=0;e.addListener=function(t,e,i){if(t.addEventListener)return t.addEventListener(e,i,!1);if(t.attachEvent){var n=function(){i.call(t,window.event)};i._wrapper=n,t.attachEvent("on"+e,n)}},e.removeListener=function(t,e,i){if(t.removeEventListener)return t.removeEventListener(e,i,!1);t.detachEvent&&t.detachEvent("on"+e,i._wrapper||i)},e.stopEvent=function(t){return e.stopPropagation(t),e.preventDefault(t),!1},e.stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},e.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},e.getButton=function(t){return"dblclick"==t.type?0:"contextmenu"==t.type||n.isMac&&t.ctrlKey&&!t.altKey&&!t.shiftKey?2:t.preventDefault?t.button:{1:0,2:2,4:1}[t.button]},e.capture=function(t,i,n){function s(t){i&&i(t),n&&n(t),e.removeListener(document,"mousemove",i,!0),e.removeListener(document,"mouseup",s,!0),e.removeListener(document,"dragstart",s,!0)}return e.addListener(document,"mousemove",i,!0),e.addListener(document,"mouseup",s,!0),e.addListener(document,"dragstart",s,!0),s},e.addTouchMoveListener=function(t,i){var n,s;e.addListener(t,"touchstart",(function(t){var e=t.touches[0];n=e.clientX,s=e.clientY})),e.addListener(t,"touchmove",(function(t){var e=t.touches;if(!(e.length>1)){var o=e[0];t.wheelX=n-o.clientX,t.wheelY=s-o.clientY,n=o.clientX,s=o.clientY,i(t)}}))},e.addMouseWheelListener=function(t,i){"onmousewheel"in t?e.addListener(t,"mousewheel",(function(t){void 0!==t.wheelDeltaX?(t.wheelX=-t.wheelDeltaX/8,t.wheelY=-t.wheelDeltaY/8):(t.wheelX=0,t.wheelY=-t.wheelDelta/8),i(t)})):"onwheel"in t?e.addListener(t,"wheel",(function(t){switch(t.deltaMode){case t.DOM_DELTA_PIXEL:t.wheelX=.35*t.deltaX||0,t.wheelY=.35*t.deltaY||0;break;case t.DOM_DELTA_LINE:case t.DOM_DELTA_PAGE:t.wheelX=5*(t.deltaX||0),t.wheelY=5*(t.deltaY||0)}i(t)})):e.addListener(t,"DOMMouseScroll",(function(t){t.axis&&t.axis==t.HORIZONTAL_AXIS?(t.wheelX=5*(t.detail||0),t.wheelY=0):(t.wheelX=0,t.wheelY=5*(t.detail||0)),i(t)}))},e.addMultiMouseDownListener=function(t,i,s,o){var r,a,l,c=0,h={2:"dblclick",3:"tripleclick",4:"quadclick"};function d(t){if(0!==e.getButton(t)?c=0:t.detail>1?++c>4&&(c=1):c=1,n.isIE){var d=Math.abs(t.clientX-r)>5||Math.abs(t.clientY-a)>5;l&&!d||(c=1),l&&clearTimeout(l),l=setTimeout((function(){l=null}),i[c-1]||600),1==c&&(r=t.clientX,a=t.clientY)}if(t._clicks=c,s[o]("mousedown",t),c>4)c=0;else if(c>1)return s[o](h[c],t)}function u(t){c=2,l&&clearTimeout(l),l=setTimeout((function(){l=null}),i[c-1]||600),s[o]("mousedown",t),s[o](h[c],t)}Array.isArray(t)||(t=[t]),t.forEach((function(t){e.addListener(t,"mousedown",d),n.isOldIE&&e.addListener(t,"dblclick",u)}))};var r=n.isMac&&n.isOpera&&!("KeyboardEvent"in window)?function(t){return 0|(t.metaKey?1:0)|(t.altKey?2:0)|(t.shiftKey?4:0)|(t.ctrlKey?8:0)}:function(t){return 0|(t.ctrlKey?1:0)|(t.altKey?2:0)|(t.shiftKey?4:0)|(t.metaKey?8:0)};function a(t,e,a){var l=r(e);if(!n.isMac&&s){if(e.getModifierState&&(e.getModifierState("OS")||e.getModifierState("Win"))&&(l|=8),s.altGr){if(3==(3&l))return;s.altGr=0}if(18===a||17===a){var c="location"in e?e.location:e.keyLocation;17===a&&1===c?1==s[a]&&(o=e.timeStamp):18===a&&3===l&&2===c&&e.timeStamp-o<50&&(s.altGr=!0)}}if(a in i.MODIFIER_KEYS&&(a=-1),8&l&&a>=91&&a<=93&&(a=-1),l||13!==a||3!==(c="location"in e?e.location:e.keyLocation)||(t(e,l,-a),!e.defaultPrevented)){if(n.isChromeOS&&8&l){if(t(e,l,a),e.defaultPrevented)return;l&=-9}return!!(l||a in i.FUNCTION_KEYS||a in i.PRINTABLE_KEYS)&&t(e,l,a)}}function l(){s=Object.create(null)}e.getModifierString=function(t){return i.KEY_MODS[r(t)]},e.addCommandKeyListener=function(t,i){var o=e.addListener;if(n.isOldGecko||n.isOpera&&!("KeyboardEvent"in window)){var r=null;o(t,"keydown",(function(t){r=t.keyCode})),o(t,"keypress",(function(t){return a(i,t,r)}))}else{var c=null;o(t,"keydown",(function(t){s[t.keyCode]=(s[t.keyCode]||0)+1;var e=a(i,t,t.keyCode);return c=t.defaultPrevented,e})),o(t,"keypress",(function(t){c&&(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)&&(e.stopEvent(t),c=null)})),o(t,"keyup",(function(t){s[t.keyCode]=null})),s||(l(),o(window,"focus",l))}},"object"==typeof window&&window.postMessage&&!n.isOldIE&&(e.nextTick=function(t,i){i=i||window,e.addListener(i,"message",(function n(s){"zero-timeout-message-1"==s.data&&(e.stopPropagation(s),e.removeListener(i,"message",n),t())})),i.postMessage("zero-timeout-message-1","*")}),e.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),e.nextFrame=e.nextFrame?e.nextFrame.bind(window):function(t){setTimeout(t,17)}})),ace.define("ace/lib/lang",["require","exports","module"],(function(t,e){e.last=function(t){return t[t.length-1]},e.stringReverse=function(t){return t.split("").reverse().join("")},e.stringRepeat=function(t,e){for(var i="";e>0;)1&e&&(i+=t),(e>>=1)&&(t+=t);return i};var i=/^\s\s*/,n=/\s\s*$/;e.stringTrimLeft=function(t){return t.replace(i,"")},e.stringTrimRight=function(t){return t.replace(n,"")},e.copyObject=function(t){var e={};for(var i in t)e[i]=t[i];return e},e.copyArray=function(t){for(var e=[],i=0,n=t.length;i<n;i++)e[i]=t[i]&&"object"==typeof t[i]?this.copyObject(t[i]):t[i];return e},e.deepCopy=function t(e){if("object"!=typeof e||!e)return e;var i;if(Array.isArray(e)){i=[];for(var n=0;n<e.length;n++)i[n]=t(e[n]);return i}if("[object Object]"!==Object.prototype.toString.call(e))return e;for(var n in i={},e)i[n]=t(e[n]);return i},e.arrayToMap=function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=1;return e},e.createMap=function(t){var e=Object.create(null);for(var i in t)e[i]=t[i];return e},e.arrayRemove=function(t,e){for(var i=0;i<=t.length;i++)e===t[i]&&t.splice(i,1)},e.escapeRegExp=function(t){return t.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},e.escapeHTML=function(t){return t.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},e.getMatchOffsets=function(t,e){var i=[];return t.replace(e,(function(t){i.push({offset:arguments[arguments.length-2],length:t.length})})),i},e.deferredCall=function(t){var e=null,i=function(){e=null,t()},n=function(t){return n.cancel(),e=setTimeout(i,t||0),n};return n.schedule=n,n.call=function(){return this.cancel(),t(),n},n.cancel=function(){return clearTimeout(e),e=null,n},n.isPending=function(){return e},n},e.delayedCall=function(t,e){var i=null,n=function(){i=null,t()},s=function(t){null==i&&(i=setTimeout(n,t||e))};return s.delay=function(t){i&&clearTimeout(i),i=setTimeout(n,t||e)},s.schedule=s,s.call=function(){this.cancel(),t()},s.cancel=function(){i&&clearTimeout(i),i=null},s.isPending=function(){return i},s}})),ace.define("ace/keyboard/textinput_ios",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/lib/keys"],(function(t,i){var n=t("../lib/event"),s=t("../lib/useragent"),o=t("../lib/dom"),r=t("../lib/lang"),a=t("../lib/keys"),l=a.KEY_MODS,c=s.isChrome<18,h=s.isIE;i.TextInput=function(t,i){var d=o.createElement("textarea");d.className=s.isIOS?"ace_text-input ace_text-input-ios":"ace_text-input",s.isTouchPad&&d.setAttribute("x-palm-disable-auto-cap",!0),d.setAttribute("wrap","off"),d.setAttribute("autocorrect","off"),d.setAttribute("autocapitalize","off"),d.setAttribute("spellcheck",!1),d.style.opacity="0",t.insertBefore(d,t.firstChild);var u=!1,m=!1,p=!1,b=!1,f="",g=!0;try{var y=document.activeElement===d}catch(e){}n.addListener(d,"blur",(function(t){i.onBlur(t),y=!1})),n.addListener(d,"focus",(function(t){y=!0,i.onFocus(t),x()})),this.focus=function(){if(f)return d.focus();d.style.position="fixed",d.focus()},this.blur=function(){d.blur()},this.isFocused=function(){return y};var v=r.delayedCall((function(){y&&x(g)})),Z=r.delayedCall((function(){b||(d.value="\n aaaa a\n",y&&x())}));function x(t){if(!b){if(b=!0,X)i=0,n=t?0:d.value.length-1;else var i=4,n=5;try{d.setSelectionRange(i,n)}catch(e){}b=!1}}function G(){b||(d.value="\n aaaa a\n",s.isWebKit&&Z.schedule())}s.isWebKit||i.addEventListener("changeSelection",(function(){i.selection.isEmpty()!=g&&(g=!g,v.schedule())})),G(),y&&i.onFocus();var X=null;this.setInputHandler=function(t){X=t},this.getInputHandler=function(){return X};var w=!1,V=function(t){4===d.selectionStart&&5===d.selectionEnd||(X&&(t=X(t),X=null),p?(x(),t&&i.onPaste(t),p=!1):t=="\n aaaa a\n".substr(0)&&4===d.selectionStart?i.execCommand(w?"del":"backspace",{source:"ace"}):u||("\n aaaa a\n"==t.substring(0,9)&&t.length>"\n aaaa a\n".length?t=t.substr(9):t.substr(0,4)=="\n aaaa a\n".substr(0,4)?t=t.substr(4,t.length-"\n aaaa a\n".length+1):t.charAt(t.length-1)=="\n aaaa a\n".charAt(0)&&(t=t.slice(0,-1)),t=="\n aaaa a\n".charAt(0)||t.charAt(t.length-1)=="\n aaaa a\n".charAt(0)&&(t=t.slice(0,-1)),t&&i.onTextInput(t)),u&&(u=!1),w&&(w=!1))},I=function(){b||(V(d.value),G())},S=function(t,e,i){var n=t.clipboardData||window.clipboardData;if(n&&!c){var s=h||i?"Text":"text/plain";try{return e?!1!==n.setData(s,e):n.getData(s)}catch(t){if(!i)return S(t,e,!0)}}},R=function(t,e){var o=i.getCopyText();if(!o)return n.preventDefault(t);S(t,o)?(s.isIOS&&(m=e,d.value="\n aa"+o+"a a\n",d.setSelectionRange(4,4+o.length),u={value:o}),e?i.onCut():i.onCopy(),s.isIOS||n.preventDefault(t)):(u=!0,d.value=o,d.select(),setTimeout((function(){u=!1,G(),x(),e?i.onCut():i.onCopy()})))};n.addCommandKeyListener(d,i.onCommandKey.bind(i)),n.addListener(d,"select",(function(){!function(t){return 0===t.selectionStart&&t.selectionEnd===t.value.length}(d)?X&&x(i.selection.isEmpty()):(i.selectAll(),x())})),n.addListener(d,"input",I),n.addListener(d,"cut",(function(t){R(t,!0)})),n.addListener(d,"copy",(function(t){R(t,!1)})),n.addListener(d,"paste",(function(t){var e=S(t);"string"==typeof e?(e&&i.onPaste(e,t),s.isIE&&setTimeout(x),n.preventDefault(t)):(d.value="",p=!0)}));var k,C=function(){if(b&&i.onCompositionUpdate&&!i.$readOnly){var t=d.value.replace(/\x01/g,"");if(b.lastValue!==t&&(i.onCompositionUpdate(t),b.lastValue&&i.undo(),b.canUndo&&(b.lastValue=t),b.lastValue)){var e=i.selection.getRange();i.insert(b.lastValue),i.session.markUndoGroup(),b.range=i.selection.getRange(),i.selection.setRange(e),i.selection.clearSelection()}}},W=function(t){if(i.onCompositionEnd&&!i.$readOnly){var e=b;b=!1;var n=setTimeout((function(){n=null;var t=d.value.replace(/\x01/g,"");b||(t==e.lastValue?G():!e.lastValue&&t&&(G(),V(t)))}));X=function(t){return n&&clearTimeout(n),(t=t.replace(/\x01/g,""))==e.lastValue?"":(e.lastValue&&n&&i.undo(),t)},i.onCompositionEnd(),i.removeListener("mousedown",W),"compositionend"==t.type&&e.range&&i.selection.setRange(e.range),(s.isChrome&&s.isChrome>=53||s.isWebKit&&s.isWebKit>=603)&&I()}},L=r.delayedCall(C,50);function F(){clearTimeout(k),k=setTimeout((function(){f&&(d.style.cssText=f,f=""),null==i.renderer.$keepTextAreaAtCursor&&(i.renderer.$keepTextAreaAtCursor=!0,i.renderer.$moveTextAreaToCursor())}),0)}n.addListener(d,"compositionstart",(function(){b||!i.onCompositionStart||i.$readOnly||((b={}).canUndo=i.session.$undoManager,i.onCompositionStart(),setTimeout(C,0),i.on("mousedown",W),b.canUndo&&!i.selection.isEmpty()&&(i.insert(""),i.session.markUndoGroup(),i.selection.clearSelection()),i.session.markUndoGroup())})),s.isGecko?n.addListener(d,"text",(function(){L.schedule()})):(n.addListener(d,"keyup",(function(){L.schedule()})),n.addListener(d,"keydown",(function(){L.schedule()}))),n.addListener(d,"compositionend",W),this.getElement=function(){return d},this.setReadOnly=function(t){d.readOnly=t},this.onContextMenu=function(t){w=!0,x(i.selection.isEmpty()),i._emit("nativecontextmenu",{target:i,domEvent:t}),this.moveToMouse(t,!0)},this.moveToMouse=function(t,e){f||(f=d.style.cssText),d.style.cssText=(e?"z-index:100000;":"")+"height:"+d.style.height+";"+(s.isIE?"opacity:0.1;":"");var r=i.container.getBoundingClientRect(),a=o.computedStyle(i.container),l=r.top+(parseInt(a.borderTopWidth)||0),c=r.left+(parseInt(r.borderLeftWidth)||0),h=r.bottom-l-d.clientHeight-2,u=function(t){d.style.left=t.clientX-c-2+"px",d.style.top=Math.min(t.clientY-l-2,h)+"px"};u(t),"mousedown"==t.type&&(i.renderer.$keepTextAreaAtCursor&&(i.renderer.$keepTextAreaAtCursor=null),clearTimeout(k),s.isWin&&n.capture(i.container,u,F))},this.onContextMenuClose=F;var M=function(t){i.textInput.onContextMenu(t),F()};if(n.addListener(d,"mouseup",M),n.addListener(d,"mousedown",(function(t){t.preventDefault(),F()})),n.addListener(i.renderer.scroller,"contextmenu",M),n.addListener(d,"contextmenu",M),s.isIOS){var T=null,Y=!1;t.addEventListener("keydown",(function(){T&&clearTimeout(T),Y=!0})),t.addEventListener("keyup",(function(){T=setTimeout((function(){Y=!1}),100)}));var z=function(){if(document.activeElement===d&&!Y){if(m)return setTimeout((function(){m=!1}),100);var t=d.selectionStart,e=d.selectionEnd;if(d.setSelectionRange(4,5),t==e)switch(t){case 0:i.onCommandKey(null,0,a.up);break;case 1:i.onCommandKey(null,0,a.home);break;case 2:i.onCommandKey(null,l.option,a.left);break;case 4:i.onCommandKey(null,0,a.left);break;case 5:i.onCommandKey(null,0,a.right);break;case 7:i.onCommandKey(null,l.option,a.right);break;case 8:i.onCommandKey(null,0,a.end);break;case 9:i.onCommandKey(null,0,a.down)}else{switch(e){case 6:i.onCommandKey(null,l.shift,a.right);break;case 7:i.onCommandKey(null,l.shift|l.option,a.right);break;case 8:i.onCommandKey(null,l.shift,a.end);break;case 9:i.onCommandKey(null,l.shift,a.down)}switch(t){case 0:i.onCommandKey(null,l.shift,a.up);break;case 1:i.onCommandKey(null,l.shift,a.home);break;case 2:i.onCommandKey(null,l.shift|l.option,a.left);break;case 3:i.onCommandKey(null,l.shift,a.left)}}}};document.addEventListener("selectionchange",z),i.on("destroy",(function(){document.removeEventListener("selectionchange",z)}))}}})),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/keyboard/textinput_ios"],(function(t,i){var n=t("../lib/event"),s=t("../lib/useragent"),o=t("../lib/dom"),r=t("../lib/lang"),a=s.isChrome<18,l=s.isIE,c=t("./textinput_ios").TextInput;i.TextInput=function(t,i){if(s.isIOS)return c.call(this,t,i);var h=o.createElement("textarea");h.className="ace_text-input",h.setAttribute("wrap","off"),h.setAttribute("autocorrect","off"),h.setAttribute("autocapitalize","off"),h.setAttribute("spellcheck",!1),h.style.opacity="0",t.insertBefore(h,t.firstChild);var d=!1,u=!1,m=!1,p="",b=!0;try{var f=document.activeElement===h}catch(e){}n.addListener(h,"blur",(function(t){i.onBlur(t),f=!1})),n.addListener(h,"focus",(function(t){f=!0,i.onFocus(t),v()})),this.focus=function(){if(p)return h.focus();var t=h.style.top;h.style.position="fixed",h.style.top="0px",h.focus(),setTimeout((function(){h.style.position="","0px"==h.style.top&&(h.style.top=t)}),0)},this.blur=function(){h.blur()},this.isFocused=function(){return f};var g=r.delayedCall((function(){f&&v(b)})),y=r.delayedCall((function(){m||(h.value="\u2028\u2028",f&&v())}));function v(t){if(!m){if(m=!0,x)var i=0,n=t?0:h.value.length-1;else i=t?2:1,n=2;try{h.setSelectionRange(i,n)}catch(e){}m=!1}}function Z(){m||(h.value="\u2028\u2028",s.isWebKit&&y.schedule())}s.isWebKit||i.addEventListener("changeSelection",(function(){i.selection.isEmpty()!=b&&(b=!b,g.schedule())})),Z(),f&&i.onFocus();var x=null;this.setInputHandler=function(t){x=t},this.getInputHandler=function(){return x};var G=!1,X=function(t){x&&(t=x(t),x=null),u?(v(),t&&i.onPaste(t),u=!1):t=="\u2028\u2028".charAt(0)?i.execCommand(G?"del":"backspace",{source:"ace"}):("\u2028\u2028"==t.substring(0,2)?t=t.substr(2):t.charAt(0)=="\u2028\u2028".charAt(0)?t=t.substr(1):t.charAt(t.length-1)=="\u2028\u2028".charAt(0)&&(t=t.slice(0,-1)),t.charAt(t.length-1)=="\u2028\u2028".charAt(0)&&(t=t.slice(0,-1)),t&&i.onTextInput(t)),G&&(G=!1)},w=function(){m||(X(h.value),Z())},V=function(t,e,i){var n=t.clipboardData||window.clipboardData;if(n&&!a){var s=l||i?"Text":"text/plain";try{return e?!1!==n.setData(s,e):n.getData(s)}catch(t){if(!i)return V(t,e,!0)}}},I=function(t,e){var s=i.getCopyText();if(!s)return n.preventDefault(t);V(t,s)?(e?i.onCut():i.onCopy(),n.preventDefault(t)):(d=!0,h.value=s,h.select(),setTimeout((function(){d=!1,Z(),v(),e?i.onCut():i.onCopy()})))},S=function(t){I(t,!0)},R=function(t){I(t,!1)},k=function(t){var e=V(t);"string"==typeof e?(e&&i.onPaste(e,t),s.isIE&&setTimeout(v),n.preventDefault(t)):(h.value="",u=!0)};n.addCommandKeyListener(h,i.onCommandKey.bind(i)),n.addListener(h,"select",(function(){d?d=!1:function(t){return 0===t.selectionStart&&t.selectionEnd===t.value.length}(h)?(i.selectAll(),v()):x&&v(i.selection.isEmpty())})),n.addListener(h,"input",w),n.addListener(h,"cut",S),n.addListener(h,"copy",R),n.addListener(h,"paste",k),"oncut"in h&&"oncopy"in h&&"onpaste"in h||n.addListener(t,"keydown",(function(t){if((!s.isMac||t.metaKey)&&t.ctrlKey)switch(t.keyCode){case 67:R(t);break;case 86:k(t);break;case 88:S(t)}}));var C,W=function(){if(m&&i.onCompositionUpdate&&!i.$readOnly){var t=h.value.replace(/\u2028/g,"");if(m.lastValue!==t&&(i.onCompositionUpdate(t),m.lastValue&&i.undo(),m.canUndo&&(m.lastValue=t),m.lastValue)){var e=i.selection.getRange();i.insert(m.lastValue),i.session.markUndoGroup(),m.range=i.selection.getRange(),i.selection.setRange(e),i.selection.clearSelection()}}},L=function(t){if(i.onCompositionEnd&&!i.$readOnly){var e=m;m=!1;var n=setTimeout((function(){n=null;var t=h.value.replace(/\u2028/g,"");m||(t==e.lastValue?Z():!e.lastValue&&t&&(Z(),X(t)))}));x=function(t){return n&&clearTimeout(n),(t=t.replace(/\u2028/g,""))==e.lastValue?"":(e.lastValue&&n&&i.undo(),t)},i.onCompositionEnd(),i.removeListener("mousedown",L),"compositionend"==t.type&&e.range&&i.selection.setRange(e.range),(s.isChrome&&s.isChrome>=53||s.isWebKit&&s.isWebKit>=603)&&w()}},F=r.delayedCall(W,50);function M(){clearTimeout(C),C=setTimeout((function(){p&&(h.style.cssText=p,p=""),null==i.renderer.$keepTextAreaAtCursor&&(i.renderer.$keepTextAreaAtCursor=!0,i.renderer.$moveTextAreaToCursor())}),0)}n.addListener(h,"compositionstart",(function(){m||!i.onCompositionStart||i.$readOnly||((m={}).canUndo=i.session.$undoManager,i.onCompositionStart(),setTimeout(W,0),i.on("mousedown",L),m.canUndo&&!i.selection.isEmpty()&&(i.insert(""),i.session.markUndoGroup(),i.selection.clearSelection()),i.session.markUndoGroup())})),s.isGecko?n.addListener(h,"text",(function(){F.schedule()})):(n.addListener(h,"keyup",(function(){F.schedule()})),n.addListener(h,"keydown",(function(){F.schedule()}))),n.addListener(h,"compositionend",L),this.getElement=function(){return h},this.setReadOnly=function(t){h.readOnly=t},this.onContextMenu=function(t){G=!0,v(i.selection.isEmpty()),i._emit("nativecontextmenu",{target:i,domEvent:t}),this.moveToMouse(t,!0)},this.moveToMouse=function(t,e){p||(p=h.style.cssText),h.style.cssText=(e?"z-index:100000;":"")+"height:"+h.style.height+";"+(s.isIE?"opacity:0.1;":"");var r=i.container.getBoundingClientRect(),a=o.computedStyle(i.container),l=r.top+(parseInt(a.borderTopWidth)||0),c=r.left+(parseInt(r.borderLeftWidth)||0),d=r.bottom-l-h.clientHeight-2,u=function(t){h.style.left=t.clientX-c-2+"px",h.style.top=Math.min(t.clientY-l-2,d)+"px"};u(t),"mousedown"==t.type&&(i.renderer.$keepTextAreaAtCursor&&(i.renderer.$keepTextAreaAtCursor=null),clearTimeout(C),s.isWin&&n.capture(i.container,u,M))},this.onContextMenuClose=M;var T=function(t){i.textInput.onContextMenu(t),M()};n.addListener(h,"mouseup",T),n.addListener(h,"mousedown",(function(t){t.preventDefault(),M()})),n.addListener(i.renderer.scroller,"contextmenu",T),n.addListener(h,"contextmenu",T)}})),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(t,e){t("../lib/dom"),t("../lib/event");var i=t("../lib/useragent");function n(t){t.$clickSelection=null;var e=t.editor;e.setDefaultHandler("mousedown",this.onMouseDown.bind(t)),e.setDefaultHandler("dblclick",this.onDoubleClick.bind(t)),e.setDefaultHandler("tripleclick",this.onTripleClick.bind(t)),e.setDefaultHandler("quadclick",this.onQuadClick.bind(t)),e.setDefaultHandler("mousewheel",this.onMouseWheel.bind(t)),e.setDefaultHandler("touchmove",this.onTouchMove.bind(t)),["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(e){t[e]=this[e]}),this),t.selectByLines=this.extendSelectionBy.bind(t,"getLineRange"),t.selectByWords=this.extendSelectionBy.bind(t,"getWordRange")}function s(t,e){if(t.start.row==t.end.row)var i=2*e.column-t.start.column-t.end.column;else if(t.start.row!=t.end.row-1||t.start.column||t.end.column)i=2*e.row-t.start.row-t.end.row;else i=e.column-4;return i<0?{cursor:t.start,anchor:t.end}:{cursor:t.end,anchor:t.start}}(function(){this.onMouseDown=function(t){var e=t.inSelection(),n=t.getDocumentPosition();this.mousedownEvent=t;var s=this.editor,o=t.getButton();if(0!==o){var r=s.getSelectionRange().isEmpty();return s.$blockScrolling++,(r||1==o)&&s.selection.moveToPosition(n),s.$blockScrolling--,void(2==o&&(s.textInput.onContextMenu(t.domEvent),i.isMozilla||t.preventDefault()))}return this.mousedownEvent.time=Date.now(),!e||s.isFocused()||(s.focus(),!this.$focusTimout||this.$clickSelection||s.inMultiSelectMode)?(this.captureMouse(t),this.startSelect(n,t.domEvent._clicks>1),t.preventDefault()):(this.setState("focusWait"),void this.captureMouse(t))},this.startSelect=function(t,e){t=t||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var i=this.editor;i.$blockScrolling++,this.mousedownEvent.getShiftKey()?i.selection.selectToPosition(t):e||i.selection.moveToPosition(t),e||this.select(),i.renderer.scroller.setCapture&&i.renderer.scroller.setCapture(),i.setStyle("ace_selecting"),this.setState("select"),i.$blockScrolling--},this.select=function(){var t,e=this.editor,i=e.renderer.screenToTextCoordinates(this.x,this.y);if(e.$blockScrolling++,this.$clickSelection){var n=this.$clickSelection.comparePoint(i);if(-1==n)t=this.$clickSelection.end;else if(1==n)t=this.$clickSelection.start;else{var o=s(this.$clickSelection,i);i=o.cursor,t=o.anchor}e.selection.setSelectionAnchor(t.row,t.column)}e.selection.selectToPosition(i),e.$blockScrolling--,e.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(t){var e,i=this.editor,n=i.renderer.screenToTextCoordinates(this.x,this.y),o=i.selection[t](n.row,n.column);if(i.$blockScrolling++,this.$clickSelection){var r=this.$clickSelection.comparePoint(o.start),a=this.$clickSelection.comparePoint(o.end);if(-1==r&&a<=0)e=this.$clickSelection.end,o.end.row==n.row&&o.end.column==n.column||(n=o.start);else if(1==a&&r>=0)e=this.$clickSelection.start,o.start.row==n.row&&o.start.column==n.column||(n=o.end);else if(-1==r&&1==a)n=o.end,e=o.start;else{var l=s(this.$clickSelection,n);n=l.cursor,e=l.anchor}i.selection.setSelectionAnchor(e.row,e.column)}i.selection.selectToPosition(n),i.$blockScrolling--,i.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var t,e,i=(t=this.mousedownEvent.y,e=this.y,Math.sqrt(Math.pow(this.x-this.mousedownEvent.x,2)+Math.pow(e-t,2))),n=Date.now();(i>0||n-this.mousedownEvent.time>this.$focusTimout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(t){var e=t.getDocumentPosition(),i=this.editor,n=i.session.getBracketRange(e);n?(n.isEmpty()&&(n.start.column--,n.end.column++),this.setState("select")):(n=i.selection.getWordRange(e.row,e.column),this.setState("selectByWords")),this.$clickSelection=n,this.select()},this.onTripleClick=function(t){var e=t.getDocumentPosition(),i=this.editor;this.setState("selectByLines");var n=i.getSelectionRange();n.isMultiLine()&&n.contains(e.row,e.column)?(this.$clickSelection=i.selection.getLineRange(n.start.row),this.$clickSelection.end=i.selection.getLineRange(n.end.row).end):this.$clickSelection=i.selection.getLineRange(e.row),this.select()},this.onQuadClick=function(){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(t){if(!t.getAccelKey()){t.getShiftKey()&&t.wheelY&&!t.wheelX&&(t.wheelX=t.wheelY,t.wheelY=0);var e=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var i=this.$lastScroll,n=t.domEvent.timeStamp,s=n-i.t,o=t.wheelX/s,r=t.wheelY/s;s<250&&(o=(o+i.vx)/2,r=(r+i.vy)/2);var a=Math.abs(o/r),l=!1;return a>=1&&e.renderer.isScrollableBy(t.wheelX*t.speed,0)&&(l=!0),a<=1&&e.renderer.isScrollableBy(0,t.wheelY*t.speed)&&(l=!0),l?i.allowed=n:n-i.allowed<250&&(Math.abs(o)<=1.1*Math.abs(i.vx)&&Math.abs(r)<=1.1*Math.abs(i.vy)?(l=!0,i.allowed=n):i.allowed=0),i.t=n,i.vx=o,i.vy=r,l?(e.renderer.scrollBy(t.wheelX*t.speed,t.wheelY*t.speed),t.stop()):void 0}},this.onTouchMove=function(t){this.editor._emit("mousewheel",t)}}).call(n.prototype),e.DefaultHandlers=n})),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],(function(t,e){t("./lib/oop");var i=t("./lib/dom");function n(t){this.isOpen=!1,this.$element=null,this.$parentNode=t}(function(){this.$init=function(){return this.$element=i.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(t){i.setInnerText(this.getElement(),t)},this.setHtml=function(t){this.getElement().innerHTML=t},this.setPosition=function(t,e){this.getElement().style.left=t+"px",this.getElement().style.top=e+"px"},this.setClassName=function(t){i.addCssClass(this.getElement(),t)},this.show=function(t,e,i){null!=t&&this.setText(t),null!=e&&null!=i&&this.setPosition(e,i),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(n.prototype),e.Tooltip=n})),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],(function(t,e){var i=t("../lib/dom"),n=t("../lib/oop"),s=t("../lib/event"),o=t("../tooltip").Tooltip;function r(t){o.call(this,t)}n.inherits(r,o),function(){this.setPosition=function(t,e){var i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight,s=this.getWidth(),r=this.getHeight();(t+=15)+s>i&&(t-=t+s-i),(e+=15)+r>n&&(e-=20+r),o.prototype.setPosition.call(this,t,e)}}.call(r.prototype),e.GutterHandler=function(t){var e,n,o,a=t.editor,l=a.renderer.$gutterLayer,c=new r(a.container);function h(){e&&(e=clearTimeout(e)),o&&(c.hide(),o=null,a._signal("hideGutterTooltip",c),a.removeEventListener("mousewheel",h))}function d(t){c.setPosition(t.x,t.y)}t.editor.setDefaultHandler("guttermousedown",(function(e){if(a.isFocused()&&0==e.getButton()&&"foldWidgets"!=l.getRegion(e)){var i=e.getDocumentPosition().row,n=a.session.selection;if(e.getShiftKey())n.selectTo(i,0);else{if(2==e.domEvent.detail)return a.selectAll(),e.preventDefault();t.$clickSelection=a.selection.getLineRange(i)}return t.setState("selectByLines"),t.captureMouse(e),e.preventDefault()}})),t.editor.setDefaultHandler("guttermousemove",(function(s){if(i.hasCssClass(s.domEvent.target||s.domEvent.srcElement,"ace_fold-widget"))return h();o&&t.$tooltipFollowsMouse&&d(s),n=s,e||(e=setTimeout((function(){e=null,n&&!t.isMousePressed?function(){var e=n.getDocumentPosition().row,i=l.$annotations[e];if(!i)return h();if(e==a.session.getLength()){var s=a.renderer.pixelToScreenCoordinates(0,n.y).row,r=n.$pos;if(s>a.session.documentToScreenRow(r.row,r.column))return h()}if(o!=i)if(o=i.text.join("<br/>"),c.setHtml(o),c.show(),a._signal("showGutterTooltip",c),a.on("mousewheel",h),t.$tooltipFollowsMouse)d(n);else{var u=n.domEvent.target.getBoundingClientRect(),m=c.getElement().style;m.left=u.right+"px",m.top=u.bottom+"px"}}():h()}),50))})),s.addListener(a.renderer.$gutter,"mouseout",(function(){n=null,o&&!e&&(e=setTimeout((function(){e=null,h()}),50))})),a.on("changeSession",h)}})),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(t,e){var i=t("../lib/event"),n=t("../lib/useragent"),s=e.MouseEvent=function(t,e){this.domEvent=t,this.editor=e,this.x=this.clientX=t.clientX,this.y=this.clientY=t.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){i.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){i.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var t=this.editor.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var e=this.getDocumentPosition();this.$inSelection=t.contains(e.row,e.column)}return this.$inSelection},this.getButton=function(){return i.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=n.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(s.prototype)})),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(t,e){var i=t("../lib/dom"),n=t("../lib/event"),s=t("../lib/useragent");function o(t){var e=t.editor,o=i.createElement("img");o.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",s.isOpera&&(o.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;"),["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(e){t[e]=this[e]}),this),e.addEventListener("mousedown",this.onMouseDown.bind(t));var a,l,c,h,d,u,m,p,b,f,g,y=e.container,v=0;function Z(){var t=u;(function(t,i){var n=Date.now();f&&i&&t.row==i.row&&i&&t.column==i.column?r(g.x,g.y,l,c)>5?f=null:n-f>=200&&(e.renderer.scrollCursorIntoView(),f=null):(e.$blockScrolling+=1,e.moveCursorToPosition(t),e.$blockScrolling-=1,f=n,g={x:l,y:c})})(u=e.renderer.screenToTextCoordinates(l,c),t),function(t,i){var n=Date.now(),s=e.renderer.layerConfig.lineHeight,o=e.renderer.layerConfig.characterWidth,r=e.renderer.scroller.getBoundingClientRect(),a={x:{left:l-r.left,right:r.right-l},y:{top:c-r.top,bottom:r.bottom-c}},h=Math.min(a.x.left,a.x.right),d=Math.min(a.y.top,a.y.bottom),u={row:t.row,column:t.column};h/o<=2&&(u.column+=a.x.left<a.x.right?-3:2),d/s<=1&&(u.row+=a.y.top<a.y.bottom?-1:1),t.row!=u.row||t.column!=u.column&&i&&t.row==i.row?b?n-b>=200&&e.renderer.scrollCursorIntoView(u):b=n:b=null}(u,t)}function x(){d=e.selection.toOrientedRange(),a=e.session.addMarker(d,"ace_selection",e.getSelectionStyle()),e.clearSelection(),e.isFocused()&&e.renderer.$cursorLayer.setBlinking(!1),clearInterval(h),Z(),h=setInterval(Z,20),v=0,n.addListener(document,"mousemove",w)}function G(){clearInterval(h),e.session.removeMarker(a),a=null,e.$blockScrolling+=1,e.selection.fromOrientedRange(d),e.$blockScrolling-=1,e.isFocused()&&!p&&e.renderer.$cursorLayer.setBlinking(!e.getReadOnly()),d=null,u=null,v=0,b=null,f=null,n.removeListener(document,"mousemove",w)}this.onDragStart=function(t){if(this.cancelDrag||!y.draggable){var i=this;return setTimeout((function(){i.startSelect(),i.captureMouse(t)}),0),t.preventDefault()}d=e.getSelectionRange();var n=t.dataTransfer;n.effectAllowed=e.getReadOnly()?"copy":"copyMove",s.isOpera&&(e.container.appendChild(o),o.scrollTop=0),n.setDragImage&&n.setDragImage(o,0,0),s.isOpera&&e.container.removeChild(o),n.clearData(),n.setData("Text",e.session.getTextRange()),p=!0,this.setState("drag")},this.onDragEnd=function(t){y.draggable=!1,p=!1,this.setState(null),e.getReadOnly()||(m||"move"!=t.dataTransfer.dropEffect||e.session.remove(e.getSelectionRange()),e.renderer.$cursorLayer.setBlinking(!0)),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(t){if(!e.getReadOnly()&&V(t.dataTransfer))return l=t.clientX,c=t.clientY,a||x(),v++,t.dataTransfer.dropEffect=m=I(t),n.preventDefault(t)},this.onDragOver=function(t){if(!e.getReadOnly()&&V(t.dataTransfer))return l=t.clientX,c=t.clientY,a||(x(),v++),null!==X&&(X=null),t.dataTransfer.dropEffect=m=I(t),n.preventDefault(t)},this.onDragLeave=function(t){if(--v<=0&&a)return G(),m=null,n.preventDefault(t)},this.onDrop=function(t){if(u){var i=t.dataTransfer;if(p)switch(m){case"move":d=d.contains(u.row,u.column)?{start:u,end:u}:e.moveText(d,u);break;case"copy":d=e.moveText(d,u,!0)}else{var s=i.getData("Text");d={start:u,end:e.session.insert(u,s)},e.focus(),m=null}return G(),n.preventDefault(t)}},n.addListener(y,"dragstart",this.onDragStart.bind(t)),n.addListener(y,"dragend",this.onDragEnd.bind(t)),n.addListener(y,"dragenter",this.onDragEnter.bind(t)),n.addListener(y,"dragover",this.onDragOver.bind(t)),n.addListener(y,"dragleave",this.onDragLeave.bind(t)),n.addListener(y,"drop",this.onDrop.bind(t));var X=null;function w(){null==X&&(X=setTimeout((function(){null!=X&&a&&G()}),20))}function V(t){var e=t.types;return!e||Array.prototype.some.call(e,(function(t){return"text/plain"==t||"Text"==t}))}function I(t){var e=["copy","copymove","all","uninitialized"],i=s.isMac?t.altKey:t.ctrlKey,n="uninitialized";try{n=t.dataTransfer.effectAllowed.toLowerCase()}catch(t){}var o="none";return i&&e.indexOf(n)>=0?o="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(n)>=0?o="move":e.indexOf(n)>=0&&(o="copy"),o}}function r(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly()),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var t=this.editor;t.container.draggable=!0,t.renderer.$cursorLayer.setBlinking(!1),t.setStyle("ace_dragging"),t.renderer.setCursorStyle(s.isWin?"default":"move"),this.setState("dragReady")},this.onMouseDrag=function(){var t=this.editor.container;s.isIE&&"dragReady"==this.state&&r(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&t.dragDrop(),"dragWait"===this.state&&r(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))},this.onMouseDown=function(t){if(this.$dragEnabled){this.mousedownEvent=t;var e=this.editor,i=t.inSelection(),n=t.getButton();if(1===(t.domEvent.detail||1)&&0===n&&i){if(t.editor.inMultiSelectMode&&(t.getAccelKey()||t.getShiftKey()))return;this.mousedownEvent.time=Date.now();var o=t.domEvent.target||t.domEvent.srcElement;"unselectable"in o&&(o.unselectable="on"),e.getDragDelay()?(s.isWebKit&&(this.cancelDrag=!0,e.container.draggable=!0),this.setState("dragWait")):this.startDrag(),this.captureMouse(t,this.onMouseDrag.bind(this)),t.defaultPrevented=!0}}}}).call(o.prototype),e.DragdropHandler=o})),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],(function(t,e){var i=t("./dom");e.get=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.onreadystatechange=function(){4===i.readyState&&e(i.responseText)},i.send(null)},e.loadScript=function(t,e){var n=i.getDocumentHead(),s=document.createElement("script");s.src=t,n.appendChild(s),s.onload=s.onreadystatechange=function(t,i){!i&&s.readyState&&"loaded"!=s.readyState&&"complete"!=s.readyState||(s=s.onload=s.onreadystatechange=null,i||e())}},e.qualifyURL=function(t){var e=document.createElement("a");return e.href=t,e.href}})),ace.define("ace/lib/event_emitter",["require","exports","module"],(function(t,e){var i={},n=function(){this.propagationStopped=!0},s=function(){this.defaultPrevented=!0};i._emit=i._dispatchEvent=function(t,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var i=this._eventRegistry[t]||[],o=this._defaultHandlers[t];if(i.length||o){"object"==typeof e&&e||(e={}),e.type||(e.type=t),e.stopPropagation||(e.stopPropagation=n),e.preventDefault||(e.preventDefault=s),i=i.slice();for(var r=0;r<i.length&&(i[r](e,this),!e.propagationStopped);r++);return o&&!e.defaultPrevented?o(e,this):void 0}},i._signal=function(t,e){var i=(this._eventRegistry||{})[t];if(i){i=i.slice();for(var n=0;n<i.length;n++)i[n](e,this)}},i.once=function(t,e){var i=this;e&&this.addEventListener(t,(function n(){i.removeEventListener(t,n),e.apply(null,arguments)}))},i.setDefaultHandler=function(t,e){var i=this._defaultHandlers;if(i||(i=this._defaultHandlers={_disabled_:{}}),i[t]){var n=i[t],s=i._disabled_[t];s||(i._disabled_[t]=s=[]),s.push(n);var o=s.indexOf(e);-1!=o&&s.splice(o,1)}i[t]=e},i.removeDefaultHandler=function(t,e){var i=this._defaultHandlers;if(i){var n=i._disabled_[t];if(i[t]==e)n&&this.setDefaultHandler(t,n.pop());else if(n){var s=n.indexOf(e);-1!=s&&n.splice(s,1)}}},i.on=i.addEventListener=function(t,e,i){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[t];return n||(n=this._eventRegistry[t]=[]),-1==n.indexOf(e)&&n[i?"unshift":"push"](e),e},i.off=i.removeListener=i.removeEventListener=function(t,e){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[t];if(i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}},i.removeAllListeners=function(t){this._eventRegistry&&(this._eventRegistry[t]=[])},e.EventEmitter=i})),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(t,e){var i=t("./oop"),n=t("./event_emitter").EventEmitter,s={setOptions:function(t){Object.keys(t).forEach((function(e){this.setOption(e,t[e])}),this)},getOptions:function(t){var e={};return t?Array.isArray(t)||(e=t,t=Object.keys(e)):t=Object.keys(this.$options),t.forEach((function(t){e[t]=this.getOption(t)}),this),e},setOption:function(t,e){if(this["$"+t]!==e){var i=this.$options[t];if(!i)return o('misspelled option "'+t+'"');if(i.forwardTo)return this[i.forwardTo]&&this[i.forwardTo].setOption(t,e);i.handlesSet||(this["$"+t]=e),i&&i.set&&i.set.call(this,e)}},getOption:function(t){var e=this.$options[t];return e?e.forwardTo?this[e.forwardTo]&&this[e.forwardTo].getOption(t):e&&e.get?e.get.call(this):this["$"+t]:o('misspelled option "'+t+'"')}};function o(t){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function r(t,e){var i=new Error(t);i.data=e,"object"==typeof console&&console.error&&console.error(i),setTimeout((function(){throw i}))}var a=function(){this.$defaultOptions={}};(function(){i.implement(this,n),this.defineOptions=function(t,e,n){return t.$options||(this.$defaultOptions[e]=t.$options={}),Object.keys(n).forEach((function(e){var i=n[e];"string"==typeof i&&(i={forwardTo:i}),i.name||(i.name=e),t.$options[i.name]=i,"initialValue"in i&&(t["$"+i.name]=i.initialValue)})),i.implement(t,s),this},this.resetOptions=function(t){Object.keys(t.$options).forEach((function(e){var i=t.$options[e];"value"in i&&t.setOption(e,i.value)}))},this.setDefaultValue=function(t,e,i){var n=this.$defaultOptions[t]||(this.$defaultOptions[t]={});n[e]&&(n.forwardTo?this.setDefaultValue(n.forwardTo,e,i):n[e].value=i)},this.setDefaultValues=function(t,e){Object.keys(e).forEach((function(i){this.setDefaultValue(t,i,e[i])}),this)},this.warn=o,this.reportError=r}).call(a.prototype),e.AppConfig=a})),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],(function(t,i,n){var s=t("./lib/lang"),o=(t("./lib/oop"),t("./lib/net")),r=t("./lib/app_config").AppConfig;n.exports=i=new r;var a=function(){return this||"undefined"!=typeof window&&window}(),l={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};function c(e){if(a&&a.document){l.packaged=e||t.packaged||n.packaged||a.define&&(void 0).packaged;for(var s={},o="",r=document.currentScript||document._currentScript,c=(r&&r.ownerDocument||document).getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d],m=u.src||u.getAttribute("src");if(m){for(var p=u.attributes,b=0,f=p.length;b<f;b++){var g=p[b];0===g.name.indexOf("data-ace-")&&(s[h(g.name.replace(/^data-ace-/,""))]=g.value)}var y=m.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);y&&(o=y[1])}}for(var v in o&&(s.base=s.base||o,s.packaged=!0),s.basePath=s.base,s.workerPath=s.workerPath||s.base,s.modePath=s.modePath||s.base,s.themePath=s.themePath||s.base,delete s.base,s)void 0!==s[v]&&i.set(v,s[v])}}function h(t){return t.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))}i.get=function(t){if(!l.hasOwnProperty(t))throw new Error("Unknown config key: "+t);return l[t]},i.set=function(t,e){if(!l.hasOwnProperty(t))throw new Error("Unknown config key: "+t);l[t]=e},i.all=function(){return s.copyObject(l)},i.moduleUrl=function(t,e){if(l.$moduleUrls[t])return l.$moduleUrls[t];var i=t.split("/"),n="snippets"==(e=e||i[i.length-2]||"")?"/":"-",s=i[i.length-1];if("worker"==e&&"-"==n){var o=new RegExp("^"+e+"[\\-_]|[\\-_]"+e+"$","g");s=s.replace(o,"")}(!s||s==e)&&i.length>1&&(s=i[i.length-2]);var r=l[e+"Path"];return null==r?r=l.basePath:"/"==n&&(e=n=""),r&&"/"!=r.slice(-1)&&(r+="/"),r+e+n+s+this.get("suffix")},i.setModuleUrl=function(t,e){return l.$moduleUrls[t]=e},i.$loading={},i.loadModule=function(n,s){var r,a;Array.isArray(n)&&(a=n[0],n=n[1]);try{r=t(n)}catch(e){}if(r&&!i.$loading[n])return s&&s(r);if(i.$loading[n]||(i.$loading[n]=[]),i.$loading[n].push(s),!(i.$loading[n].length>1)){var l=function(){t([n],(function(t){i._emit("load.module",{name:n,module:t});var e=i.$loading[n];i.$loading[n]=null,e.forEach((function(e){e&&e(t)}))}))};if(!i.get("packaged"))return l();o.loadScript(i.moduleUrl(n,a),l)}},c(!0),i.init=c})),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/config"],(function(t,e){var i=t("../lib/event"),n=t("../lib/useragent"),s=t("./default_handlers").DefaultHandlers,o=t("./default_gutter_handler").GutterHandler,r=t("./mouse_event").MouseEvent,a=t("./dragdrop_handler").DragdropHandler,l=t("../config"),c=function(t){var e=this;this.editor=t,new s(this),new o(this),new a(this);var r=function(){(!document.hasFocus||!document.hasFocus()||!t.isFocused()&&document.activeElement==(t.textInput&&t.textInput.getElement()))&&window.focus(),t.focus()},l=t.renderer.getMouseEventTarget();i.addListener(l,"click",this.onMouseEvent.bind(this,"click")),i.addListener(l,"mousemove",this.onMouseMove.bind(this,"mousemove")),i.addMultiMouseDownListener([l,t.renderer.scrollBarV&&t.renderer.scrollBarV.inner,t.renderer.scrollBarH&&t.renderer.scrollBarH.inner,t.textInput&&t.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent"),i.addMouseWheelListener(t.container,this.onMouseWheel.bind(this,"mousewheel")),i.addTouchMoveListener(t.container,this.onTouchMove.bind(this,"touchmove"));var c=t.renderer.$gutter;i.addListener(c,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),i.addListener(c,"click",this.onMouseEvent.bind(this,"gutterclick")),i.addListener(c,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),i.addListener(c,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),i.addListener(l,"mousedown",r),i.addListener(c,"mousedown",r),n.isIE&&t.renderer.scrollBarV&&(i.addListener(t.renderer.scrollBarV.element,"mousedown",r),i.addListener(t.renderer.scrollBarH.element,"mousedown",r)),t.on("mousemove",(function(i){if(!e.state&&!e.$dragDelay&&e.$dragEnabled){var n=t.renderer.screenToTextCoordinates(i.x,i.y),s=t.session.selection.getRange(),o=t.renderer;!s.isEmpty()&&s.insideStart(n.row,n.column)?o.setCursorStyle("default"):o.setCursorStyle("")}}))};(function(){this.onMouseEvent=function(t,e){this.editor._emit(t,new r(e,this.editor))},this.onMouseMove=function(t,e){var i=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;i&&i.length&&this.editor._emit(t,new r(e,this.editor))},this.onMouseWheel=function(t,e){var i=new r(e,this.editor);i.speed=2*this.$scrollSpeed,i.wheelX=e.wheelX,i.wheelY=e.wheelY,this.editor._emit(t,i)},this.onTouchMove=function(t,e){var i=new r(e,this.editor);i.speed=1,i.wheelX=e.wheelX,i.wheelY=e.wheelY,this.editor._emit(t,i)},this.setState=function(t){this.state=t},this.captureMouse=function(t,e){this.x=t.x,this.y=t.y,this.isMousePressed=!0;var s=this.editor.renderer;s.$keepTextAreaAtCursor&&(s.$keepTextAreaAtCursor=null);var o=this,a=function(t){if(t){if(n.isWebKit&&!t.which&&o.releaseMouse)return o.releaseMouse();o.x=t.clientX,o.y=t.clientY,e&&e(t),o.mouseEvent=new r(t,o.editor),o.$mouseMoved=!0}},l=function(t){clearInterval(h),c(),o[o.state+"End"]&&o[o.state+"End"](t),o.state="",null==s.$keepTextAreaAtCursor&&(s.$keepTextAreaAtCursor=!0,s.$moveTextAreaToCursor()),o.isMousePressed=!1,o.$onCaptureMouseMove=o.releaseMouse=null,t&&o.onMouseEvent("mouseup",t)},c=function(){o[o.state]&&o[o.state](),o.$mouseMoved=!1};if(n.isOldIE&&"dblclick"==t.domEvent.type)return setTimeout((function(){l(t)}));o.$onCaptureMouseMove=a,o.releaseMouse=i.capture(this.editor.container,a,l);var h=setInterval(c,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var t=function(e){e&&e.domEvent&&"contextmenu"!=e.domEvent.type||(this.editor.off("nativecontextmenu",t),e&&e.domEvent&&i.stopEvent(e.domEvent))}.bind(this);setTimeout(t,10),this.editor.on("nativecontextmenu",t)}}).call(c.prototype),l.defineOptions(c.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:n.isMac?150:0},dragEnabled:{initialValue:!0},focusTimout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),e.MouseHandler=c})),ace.define("ace/mouse/fold_handler",["require","exports","module"],(function(t,e){e.FoldHandler=function(t){t.on("click",(function(e){var i=e.getDocumentPosition(),n=t.session,s=n.getFoldAt(i.row,i.column,1);s&&(e.getAccelKey()?n.removeFold(s):n.expandFold(s),e.stop())})),t.on("gutterclick",(function(e){if("foldWidgets"==t.renderer.$gutterLayer.getRegion(e)){var i=e.getDocumentPosition().row,n=t.session;n.foldWidgets&&n.foldWidgets[i]&&t.session.onFoldWidgetClick(i,e),t.isFocused()||t.focus(),e.stop()}})),t.on("gutterdblclick",(function(e){if("foldWidgets"==t.renderer.$gutterLayer.getRegion(e)){var i=e.getDocumentPosition().row,n=t.session,s=n.getParentFoldRangeData(i,!0),o=s.range||s.firstRange;if(o){var r=n.getFoldAt(i=o.start.row,n.getLine(i).length,1);r?n.removeFold(r):(n.addFold("...",o),t.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}e.stop()}}))}})),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],(function(t,e){var i=t("../lib/keys"),n=t("../lib/event"),s=function(t){this.$editor=t,this.$data={editor:t},this.$handlers=[],this.setDefaultHandler(t.commands)};(function(){this.setDefaultHandler=function(t){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=t,this.addKeyboardHandler(t,0)},this.setKeyboardHandler=function(t){var e=this.$handlers;if(e[e.length-1]!=t){for(;e[e.length-1]&&e[e.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(e[e.length-1]);this.addKeyboardHandler(t,1)}},this.addKeyboardHandler=function(t,e){if(t){"function"!=typeof t||t.handleKeyboard||(t.handleKeyboard=t);var i=this.$handlers.indexOf(t);-1!=i&&this.$handlers.splice(i,1),null==e?this.$handlers.push(t):this.$handlers.splice(e,0,t),-1==i&&t.attach&&t.attach(this.$editor)}},this.removeKeyboardHandler=function(t){var e=this.$handlers.indexOf(t);return-1!=e&&(this.$handlers.splice(e,1),t.detach&&t.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var t=this.$data,e=t.editor;return this.$handlers.map((function(i){return i.getStatusText&&i.getStatusText(e,t)||""})).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(t,e,i,s){for(var o,r=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&!((o=this.$handlers[l].handleKeyboard(this.$data,t,e,i,s))&&o.command&&((r="null"==o.command||a.exec(o.command,this.$editor,o.args,s))&&s&&-1!=t&&1!=o.passEvent&&1!=o.command.passEvent&&n.stopEvent(s),r)););return r||-1!=t||(o={command:"insertstring"},r=a.exec("insertstring",this.$editor,e)),r&&this.$editor._signal&&this.$editor._signal("keyboardActivity",o),r},this.onCommandKey=function(t,e,n){var s=i.keyCodeToString(n);this.$callKeyboardHandlers(e,s,n,t)},this.onTextInput=function(t){this.$callKeyboardHandlers(-1,t)}}).call(s.prototype),e.KeyBinding=s})),ace.define("ace/lib/bidiutil",["require","exports","module"],(function(t,e){var i=0,n=0,s=!1,o=!1,r=!1,a=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],l=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],c=[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4],h=[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function d(t,e,s){if(!(n<t))if(1!=t||1!=i||o)for(var r,a,l,c,h=s.length,d=0;d<h;){if(e[d]>=t){for(r=d+1;r<h&&e[r]>=t;)r++;for(a=d,l=r-1;a<l;a++,l--)c=s[a],s[a]=s[l],s[l]=c;d=r}d++}else s.reverse()}function u(t,e,n,a){var l,c,h,d,u=e[a];switch(u){case 0:case 1:s=!1;case 4:case 3:return u;case 2:return s?3:2;case 7:return s=!0,1;case 8:return 4;case 9:return a<1||a+1>=e.length||2!=(l=n[a-1])&&3!=l||2!=(c=e[a+1])&&3!=c?4:(s&&(c=3),c==l?c:4);case 10:return 2==(l=a>0?n[a-1]:5)&&a+1<e.length&&2==e[a+1]?2:4;case 11:if(a>0&&2==n[a-1])return 2;if(s)return 4;for(d=a+1,h=e.length;d<h&&11==e[d];)d++;return d<h&&2==e[d]?2:4;case 12:for(h=e.length,d=a+1;d<h&&12==e[d];)d++;if(d<h){var m=t[a];if(l=e[d],(m>=1425&&m<=2303||64286==m)&&(1==l||7==l))return 1}return a<1||5==(l=e[a-1])?4:n[a-1];case 5:return s=!1,o=!0,i;case 6:return r=!0,4;case 13:case 14:case 16:case 17:case 15:s=!1;case 18:return 4}}function m(t){var e=t.charCodeAt(0),i=e>>8;return 0==i?e>191?0:c[e]:5==i?/[\u0591-\u05f4]/.test(t)?1:0:6==i?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(t)?12:/[\u0660-\u0669\u066b-\u066c]/.test(t)?3:1642==e?11:/[\u06f0-\u06f9]/.test(t)?2:7:32==i&&e<=8287?h[255&e]:254==i&&e>=65136?7:4}e.L=0,e.R=1,e.EN=2,e.ON_R=3,e.AN=4,e.R_H=5,e.B=6,e.DOT="",e.doBidiReorder=function(t,c,h){if(t.length<2)return{};var p=t.split(""),b=new Array(p.length),f=new Array(p.length),g=[];i=h?1:0,function(t,e,c,h){var d=i?l:a,p=null,b=null,f=null,g=0,y=null,v=-1,Z=null,x=null,G=[];if(!h)for(Z=0,h=[];Z<c;Z++)h[Z]=m(t[Z]);for(n=i,s=!1,o=!1,r=!1,x=0;x<c;x++){if(p=g,G[x]=b=u(t,h,G,x),y=240&(g=d[p][b]),e[x]=f=d[g&=15][5],y>0)if(16==y){for(Z=v;Z<x;Z++)e[Z]=1;v=-1}else v=-1;if(d[g][6])-1==v&&(v=x);else if(v>-1){for(Z=v;Z<x;Z++)e[Z]=f;v=-1}5==h[x]&&(e[x]=0),n|=f}if(r)for(Z=0;Z<c;Z++)if(6==h[Z]){e[Z]=i;for(var X=Z-1;X>=0&&8==h[X];X--)e[X]=i}}(p,g,p.length,c);for(var y=0;y<b.length;b[y]=y,y++);for(d(2,g,b),d(1,g,b),y=0;y<b.length-1;y++)3===c[y]?g[y]=e.AN:1===g[y]&&(c[y]>7&&c[y]<13||4===c[y]||18===c[y])?g[y]=e.ON_R:y>0&&""===p[y-1]&&/\u0622|\u0623|\u0625|\u0627/.test(p[y])&&(g[y-1]=g[y]=e.R_H,y++);for(p[p.length-1]===e.DOT&&(g[p.length-1]=e.B),y=0;y<b.length;y++)f[y]=g[b[y]];return{logicalFromVisual:b,bidiLevels:f}},e.hasBidiCharacters=function(t,e){for(var i=!1,n=0;n<t.length;n++)e[n]=m(t.charAt(n)),i||1!=e[n]&&7!=e[n]||(i=!0);return i},e.getVisualFromLogicalIdx=function(t,e){for(var i=0;i<e.logicalFromVisual.length;i++)if(e.logicalFromVisual[i]==t)return i;return 0}})),ace.define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang","ace/lib/useragent"],(function(t,e){var i=t("./lib/bidiutil"),n=t("./lib/lang"),s=t("./lib/useragent"),o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=function(t){this.session=t,this.bidiMap={},this.currentRow=null,this.bidiUtil=i,this.charWidths=[],this.EOL="",this.showInvisibles=!0,this.isRtlDir=!1,this.line="",this.wrapIndent=0,this.isLastRow=!1,this.EOF="",this.seenBidi=!1};(function(){this.isBidiRow=function(t,e,i){return!!this.seenBidi&&(t!==this.currentRow&&(this.currentRow=t,this.updateRowLine(e,i),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(t){this.seenBidi?this.currentRow=null:"insert"==t.action&&o.test(t.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var t=0,e=this.session.$screenRowCache;if(e.length){var i=this.session.$getRowCacheIndex(e,this.currentRow);i>=0&&(t=this.session.$docRowCache[i])}return t},this.getSplitIndex=function(){var t=0,e=this.session.$screenRowCache;if(e.length)for(var i,n=this.session.$getRowCacheIndex(e,this.currentRow);this.currentRow-t>0&&(i=this.session.$getRowCacheIndex(e,this.currentRow-t-1))===n;)n=i,t++;return t},this.updateRowLine=function(t,e){if(void 0===t&&(t=this.getDocumentRow()),this.wrapIndent=0,this.isLastRow=t===this.session.getLength()-1,this.line=this.session.getLine(t),this.session.$useWrapMode){var s=this.session.$wrapData[t];s&&(void 0===e&&(e=this.getSplitIndex()),e>0&&s.length?(this.wrapIndent=s.indent,this.line=e<s.length?this.line.substring(s[e-1],s[s.length-1]):this.line.substring(s[s.length-1])):this.line=this.line.substring(0,s[e]))}var o,r=this.session,a=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(t,e){return"\t"===t||r.isFullWidth(t.charCodeAt(0))?(o="\t"===t?r.getScreenTabSize(e+a):2,a+=o-1,n.stringRepeat(i.DOT,o)):t}))},this.updateBidiMap=function(){var t=[],e=this.line+(this.showInvisibles?this.isLastRow?this.EOF:this.EOL:i.DOT);this.bidiMap=i.hasBidiCharacters(e,t)?i.doBidiReorder(e,t,this.isRtlDir):{}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(t){if(this.seenBidi&&this.characterWidth!==t.$characterSize.width){var e=this.characterWidth=t.$characterSize.width,n=t.$measureCharWidth("");this.charWidths[i.L]=this.charWidths[i.EN]=this.charWidths[i.ON_R]=e,this.charWidths[i.R]=this.charWidths[i.AN]=n,this.charWidths[i.R_H]=s.isChrome?n:.45*n,this.charWidths[i.B]=0,this.currentRow=null}},this.getShowInvisibles=function(){return this.showInvisibles},this.setShowInvisibles=function(t){this.showInvisibles=t,this.currentRow=null},this.setEolChar=function(t){this.EOL=t},this.setTextDir=function(t){this.isRtlDir=t},this.getPosLeft=function(t){var e=i.getVisualFromLogicalIdx((t-=this.wrapIndent)>0?t-1:0,this.bidiMap),n=this.bidiMap.bidiLevels,s=0;0===t&&n[e]%2!=0&&e++;for(var o=0;o<e;o++)s+=this.charWidths[n[o]];return 0!==t&&n[e]%2==0&&(s+=this.charWidths[n[e]]),this.wrapIndent&&(s+=this.wrapIndent*this.charWidths[i.L]),s},this.getSelections=function(t,e){for(var n,s,o=this.bidiMap,r=o.bidiLevels,a=this.wrapIndent*this.charWidths[i.L],l=[],c=Math.min(t,e)-this.wrapIndent,h=Math.max(t,e)-this.wrapIndent,d=!1,u=!1,m=0,p=0;p<r.length;p++)n=r[p],(d=(s=o.logicalFromVisual[p])>=c&&s<h)&&!u?m=a:!d&&u&&l.push({left:m,width:a-m}),a+=this.charWidths[n],u=d;return d&&p===r.length&&l.push({left:m,width:a-m}),l},this.offsetToCol=function(t){var e=0,n=(t=Math.max(t,0),0),s=0,o=this.bidiMap.bidiLevels,r=this.charWidths[o[s]];for(this.wrapIndent&&(t-=this.wrapIndent*this.charWidths[i.L]);t>n+r/2;){if(n+=r,s===o.length-1){r=0;break}r=this.charWidths[o[++s]]}return s>0&&o[s-1]%2!=0&&o[s]%2==0?(t<n&&s--,e=this.bidiMap.logicalFromVisual[s]):s>0&&o[s-1]%2==0&&o[s]%2!=0?e=1+(t>n?this.bidiMap.logicalFromVisual[s]:this.bidiMap.logicalFromVisual[s-1]):this.isRtlDir&&s===o.length-1&&0===r&&o[s-1]%2==0||!this.isRtlDir&&0===s&&o[s]%2!=0?e=1+this.bidiMap.logicalFromVisual[s]:(s>0&&o[s-1]%2!=0&&0!==r&&s--,e=this.bidiMap.logicalFromVisual[s]),e+this.wrapIndent}}).call(r.prototype),e.BidiHandler=r})),ace.define("ace/range",["require","exports","module"],(function(t,e){var i=function(t,e,i,n){this.start={row:t,column:e},this.end={row:i,column:n}};(function(){this.isEqual=function(t){return this.start.row===t.start.row&&this.end.row===t.end.row&&this.start.column===t.start.column&&this.end.column===t.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(t,e){return 0==this.compare(t,e)},this.compareRange=function(t){var e,i=t.end,n=t.start;return 1==(e=this.compare(i.row,i.column))?1==(e=this.compare(n.row,n.column))?2:0==e?1:0:-1==e?-2:-1==(e=this.compare(n.row,n.column))?-1:1==e?42:0},this.comparePoint=function(t){return this.compare(t.row,t.column)},this.containsRange=function(t){return 0==this.comparePoint(t.start)&&0==this.comparePoint(t.end)},this.intersects=function(t){var e=this.compareRange(t);return-1==e||0==e||1==e},this.isEnd=function(t,e){return this.end.row==t&&this.end.column==e},this.isStart=function(t,e){return this.start.row==t&&this.start.column==e},this.setStart=function(t,e){"object"==typeof t?(this.start.column=t.column,this.start.row=t.row):(this.start.row=t,this.start.column=e)},this.setEnd=function(t,e){"object"==typeof t?(this.end.column=t.column,this.end.row=t.row):(this.end.row=t,this.end.column=e)},this.inside=function(t,e){return 0==this.compare(t,e)&&!this.isEnd(t,e)&&!this.isStart(t,e)},this.insideStart=function(t,e){return 0==this.compare(t,e)&&!this.isEnd(t,e)},this.insideEnd=function(t,e){return 0==this.compare(t,e)&&!this.isStart(t,e)},this.compare=function(t,e){return this.isMultiLine()||t!==this.start.row?t<this.start.row?-1:t>this.end.row?1:this.start.row===t?e>=this.start.column?0:-1:this.end.row===t?e<=this.end.column?0:1:0:e<this.start.column?-1:e>this.end.column?1:0},this.compareStart=function(t,e){return this.start.row==t&&this.start.column==e?-1:this.compare(t,e)},this.compareEnd=function(t,e){return this.end.row==t&&this.end.column==e?1:this.compare(t,e)},this.compareInside=function(t,e){return this.end.row==t&&this.end.column==e?1:this.start.row==t&&this.start.column==e?-1:this.compare(t,e)},this.clipRows=function(t,e){if(this.end.row>e)var n={row:e+1,column:0};else this.end.row<t&&(n={row:t,column:0});if(this.start.row>e)var s={row:e+1,column:0};else this.start.row<t&&(s={row:t,column:0});return i.fromPoints(s||this.start,n||this.end)},this.extend=function(t,e){var n=this.compare(t,e);if(0==n)return this;if(-1==n)var s={row:t,column:e};else var o={row:t,column:e};return i.fromPoints(s||this.start,o||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return i.fromPoints(this.start,this.end)},this.collapseRows=function(){return new i(this.start.row,0,0==this.end.column?Math.max(this.start.row,this.end.row-1):this.end.row,0)},this.toScreenRange=function(t){var e=t.documentToScreenPosition(this.start),n=t.documentToScreenPosition(this.end);return new i(e.row,e.column,n.row,n.column)},this.moveBy=function(t,e){this.start.row+=t,this.start.column+=e,this.end.row+=t,this.end.column+=e}}).call(i.prototype),i.fromPoints=function(t,e){return new i(t.row,t.column,e.row,e.column)},i.comparePoints=function(t,e){return t.row-e.row||t.column-e.column},i.comparePoints=function(t,e){return t.row-e.row||t.column-e.column},e.Range=i})),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],(function(t,i){var n=t("./lib/oop"),s=t("./lib/lang"),o=t("./lib/event_emitter").EventEmitter,r=t("./range").Range,a=function(t){this.session=t,this.doc=t.getDocument(),this.clearSelection(),this.lead=this.selectionLead=this.doc.createAnchor(0,0),this.anchor=this.selectionAnchor=this.doc.createAnchor(0,0);var e=this;this.lead.on("change",(function(t){e._emit("changeCursor"),e.$isEmpty||e._emit("changeSelection"),e.$keepDesiredColumnOnChange||t.old.column==t.value.column||(e.$desiredColumn=null)})),this.selectionAnchor.on("change",(function(){e.$isEmpty||e._emit("changeSelection")}))};(function(){n.implement(this,o),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.isEmpty()&&this.getRange().isMultiLine()},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(t,e){this.anchor.setPosition(t,e),this.$isEmpty&&(this.$isEmpty=!1,this._emit("changeSelection"))},this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.shiftSelection=function(t){if(this.$isEmpty)this.moveCursorTo(this.lead.row,this.lead.column+t);else{var e=this.getSelectionAnchor(),i=this.getSelectionLead(),n=this.isBackwards();n&&0===e.column||this.setSelectionAnchor(e.row,e.column+t),(n||0!==i.column)&&this.$moveSelection((function(){this.moveCursorTo(i.row,i.column+t)}))}},this.isBackwards=function(){var t=this.anchor,e=this.lead;return t.row>e.row||t.row==e.row&&t.column>e.column},this.getRange=function(){var t=this.anchor,e=this.lead;return this.isEmpty()?r.fromPoints(e,e):this.isBackwards()?r.fromPoints(e,t):r.fromPoints(t,e)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){var t=this.doc.getLength()-1;this.setSelectionAnchor(0,0),this.moveCursorTo(t,this.doc.getLine(t).length)},this.setRange=this.setSelectionRange=function(t,e){e?(this.setSelectionAnchor(t.end.row,t.end.column),this.selectTo(t.start.row,t.start.column)):(this.setSelectionAnchor(t.start.row,t.start.column),this.selectTo(t.end.row,t.end.column)),this.getRange().isEmpty()&&(this.$isEmpty=!0),this.$desiredColumn=null},this.$moveSelection=function(t){var e=this.lead;this.$isEmpty&&this.setSelectionAnchor(e.row,e.column),t.call(this)},this.selectTo=function(t,e){this.$moveSelection((function(){this.moveCursorTo(t,e)}))},this.selectToPosition=function(t){this.$moveSelection((function(){this.moveCursorToPosition(t)}))},this.moveTo=function(t,e){this.clearSelection(),this.moveCursorTo(t,e)},this.moveToPosition=function(t){this.clearSelection(),this.moveCursorToPosition(t)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(t,e){if(void 0===e){var i=t||this.lead;t=i.row,e=i.column}return this.session.getWordRange(t,e)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var t=this.getCursor(),e=this.session.getAWordRange(t.row,t.column);this.setSelectionRange(e)},this.getLineRange=function(t,e){var i,n="number"==typeof t?t:this.lead.row,s=this.session.getFoldLine(n);return s?(n=s.start.row,i=s.end.row):i=n,!0===e?new r(n,0,i,this.session.getLine(i).length):new r(n,0,i+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(t,e,i){var n=t.column,s=t.column+e;return i<0&&(n=t.column-e,s=t.column),this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(n,s).split(" ").length-1==e},this.moveCursorLeft=function(){var t,e=this.lead.getPosition();if(t=this.session.getFoldAt(e.row,e.column,-1))this.moveCursorTo(t.start.row,t.start.column);else if(0===e.column)e.row>0&&this.moveCursorTo(e.row-1,this.doc.getLine(e.row-1).length);else{var i=this.session.getTabSize();this.wouldMoveIntoSoftTab(e,i,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-i):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var t,e=this.lead.getPosition();if(t=this.session.getFoldAt(e.row,e.column,1))this.moveCursorTo(t.end.row,t.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var i=this.session.getTabSize();this.wouldMoveIntoSoftTab(e=this.lead,i,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,i):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var t=this.lead.row,e=this.lead.column,i=this.session.documentToScreenRow(t,e),n=this.session.screenToDocumentPosition(i,0),s=this.session.getDisplayLine(t,null,n.row,n.column).match(/^\s*/);s[0].length==e||this.session.$useEmacsStyleLineStart||(n.column+=s[0].length),this.moveCursorToPosition(n)},this.moveCursorLineEnd=function(){var t=this.lead,e=this.session.getDocumentLastRowColumnPosition(t.row,t.column);if(this.lead.column==e.column){var i=this.session.getLine(e.row);if(e.column==i.length){var n=i.search(/\s+$/);n>0&&(e.column=n)}}this.moveCursorTo(e.row,e.column)},this.moveCursorFileEnd=function(){var t=this.doc.getLength()-1,e=this.doc.getLine(t).length;this.moveCursorTo(t,e)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var t=this.lead.row,e=this.lead.column,i=this.doc.getLine(t),n=i.substring(e);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var s=this.session.getFoldAt(t,e,1);if(s)this.moveCursorTo(s.end.row,s.end.column);else{if(this.session.nonTokenRe.exec(n)&&(e+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,n=i.substring(e)),e>=i.length)return this.moveCursorTo(t,i.length),this.moveCursorRight(),void(t<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(n)&&(e+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,e)}},this.moveCursorLongWordLeft=function(){var t,e=this.lead.row,i=this.lead.column;if(t=this.session.getFoldAt(e,i,-1))this.moveCursorTo(t.start.row,t.start.column);else{var n=this.session.getFoldStringAt(e,i,-1);null==n&&(n=this.doc.getLine(e).substring(0,i));var o=s.stringReverse(n);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(o)&&(i-=this.session.nonTokenRe.lastIndex,o=o.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),i<=0)return this.moveCursorTo(e,0),this.moveCursorLeft(),void(e>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(o)&&(i-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,i)}},this.$shortWordEndIndex=function(t){var e,i=0,n=/\s/,s=this.session.tokenRe;if(s.lastIndex=0,this.session.tokenRe.exec(t))i=this.session.tokenRe.lastIndex;else{for(;(e=t[i])&&n.test(e);)i++;if(i<1)for(s.lastIndex=0;(e=t[i])&&!s.test(e);)if(s.lastIndex=0,i++,n.test(e)){if(i>2){i--;break}for(;(e=t[i])&&n.test(e);)i++;if(i>2)break}}return s.lastIndex=0,i},this.moveCursorShortWordRight=function(){var t=this.lead.row,e=this.lead.column,i=this.doc.getLine(t),n=i.substring(e),s=this.session.getFoldAt(t,e,1);if(s)return this.moveCursorTo(s.end.row,s.end.column);if(e==i.length){var o=this.doc.getLength();do{t++,n=this.doc.getLine(t)}while(t<o&&/^\s*$/.test(n));/^\s+/.test(n)||(n=""),e=0}var r=this.$shortWordEndIndex(n);this.moveCursorTo(t,e+r)},this.moveCursorShortWordLeft=function(){var t,e=this.lead.row,i=this.lead.column;if(t=this.session.getFoldAt(e,i,-1))return this.moveCursorTo(t.start.row,t.start.column);var n=this.session.getLine(e).substring(0,i);if(0===i){do{e--,n=this.doc.getLine(e)}while(e>0&&/^\s*$/.test(n));i=n.length,/\s+$/.test(n)||(n="")}var o=s.stringReverse(n),r=this.$shortWordEndIndex(o);return this.moveCursorTo(e,i-r)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(t,e){var i,n=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===e&&(0!==t&&(this.session.$bidiHandler.isBidiRow(n.row,this.lead.row)?(i=this.session.$bidiHandler.getPosLeft(n.column),n.column=Math.round(i/this.session.$bidiHandler.charWidths[0])):i=n.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?n.column=this.$desiredColumn:this.$desiredColumn=n.column);var s=this.session.screenToDocumentPosition(n.row+t,n.column,i);0!==t&&0===e&&s.row===this.lead.row&&s.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[s.row]&&(s.row>0||t>0)&&s.row++,this.moveCursorTo(s.row,s.column+e,0===e)},this.moveCursorToPosition=function(t){this.moveCursorTo(t.row,t.column)},this.moveCursorTo=function(t,e,i){var n=this.session.getFoldAt(t,e,1);n&&(t=n.start.row,e=n.start.column),this.$keepDesiredColumnOnChange=!0;var s=this.session.getLine(t);/[\uDC00-\uDFFF]/.test(s.charAt(e))&&s.charAt(e-1)&&(this.lead.row==t&&this.lead.column==e+1?e-=1:e+=1),this.lead.setPosition(t,e),this.$keepDesiredColumnOnChange=!1,i||(this.$desiredColumn=null)},this.moveCursorToScreen=function(t,e,i){var n=this.session.screenToDocumentPosition(t,e);this.moveCursorTo(n.row,n.column,i)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(t){this.setSelectionRange(t,t.cursor==t.start),this.$desiredColumn=t.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(t){var e=this.getRange();return t?(t.start.column=e.start.column,t.start.row=e.start.row,t.end.column=e.end.column,t.end.row=e.end.row):t=e,t.cursor=this.isBackwards()?t.start:t.end,t.desiredColumn=this.$desiredColumn,t},this.getRangeOfMovements=function(t){var i=this.getCursor();try{t(this);var n=this.getCursor();return r.fromPoints(i,n)}catch(e){return r.fromPoints(i,i)}finally{this.moveCursorToPosition(i)}},this.toJSON=function(){if(this.rangeCount)var t=this.ranges.map((function(t){var e=t.clone();return e.isBackwards=t.cursor==t.start,e}));else(t=this.getRange()).isBackwards=this.isBackwards();return t},this.fromJSON=function(t){if(null==t.start){if(this.rangeList){this.toSingleRange(t[0]);for(var e=t.length;e--;){var i=r.fromPoints(t[e].start,t[e].end);t[e].isBackwards&&(i.cursor=i.start),this.addRange(i,!0)}return}t=t[0]}this.rangeList&&this.toSingleRange(t),this.setSelectionRange(t,t.isBackwards)},this.isEqual=function(t){if((t.length||this.rangeCount)&&t.length!=this.rangeCount)return!1;if(!t.length||!this.ranges)return this.getRange().isEqual(t);for(var e=this.ranges.length;e--;)if(!this.ranges[e].isEqual(t[e]))return!1;return!0}}).call(a.prototype),i.Selection=a})),ace.define("ace/tokenizer",["require","exports","module","ace/config"],(function(t,e){var i=t("./config"),n=2e3,s=function(t){for(var e in this.states=t,this.regExps={},this.matchMappings={},this.states){for(var i=this.states[e],n=[],s=0,o=this.matchMappings[e]={defaultToken:"text"},r="g",a=[],l=0;l<i.length;l++){var c=i[l];if(c.defaultToken&&(o.defaultToken=c.defaultToken),c.caseInsensitive&&(r="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var h=c.regex,d=new RegExp("(?:("+h+")|(.))").exec("a").length-2;Array.isArray(c.token)?1==c.token.length||1==d?c.token=c.token[0]:d-1!=c.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:c,groupCount:d-1}),c.token=c.token[0]):(c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens):"function"!=typeof c.token||c.onMatch||(c.onMatch=d>1?this.$applyToken:c.token),d>1&&(/\\\d/.test(c.regex)?h=c.regex.replace(/\\([0-9]+)/g,(function(t,e){return"\\"+(parseInt(e,10)+s+1)})):(d=1,h=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),o[s]=l,s+=d,n.push(h),c.onMatch||(c.onMatch=null)}}n.length||(o[0]=0,n.push("$")),a.forEach((function(t){t.splitRegex=this.createSplitterRegexp(t.regex,r)}),this),this.regExps[e]=new RegExp("("+n.join(")|(")+")|($)",r)}};(function(){this.$setMaxTokenCount=function(t){n=0|t},this.$applyToken=function(t){var e=this.splitRegex.exec(t).slice(1),i=this.token.apply(this,e);if("string"==typeof i)return[{type:i,value:t}];for(var n=[],s=0,o=i.length;s<o;s++)e[s]&&(n[n.length]={type:i[s],value:e[s]});return n},this.$arrayTokens=function(t){if(!t)return[];var e=this.splitRegex.exec(t);if(!e)return"text";for(var i=[],n=this.tokenArray,s=0,o=n.length;s<o;s++)e[s+1]&&(i[i.length]={type:n[s],value:e[s+1]});return i},this.removeCapturingGroups=function(t){return t.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,(function(t,e){return e?"(?:":t}))},this.createSplitterRegexp=function(t,e){if(-1!=t.indexOf("(?=")){var i=0,n=!1,s={};t.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(t,e,o,r,a,l){return n?n="]"!=a:a?n=!0:r?(i==s.stack&&(s.end=l+1,s.stack=-1),i--):o&&(i++,1!=o.length&&(s.stack=i,s.start=l)),t})),null!=s.end&&/^\)*$/.test(t.substr(s.end))&&(t=t.substring(0,s.start)+t.substr(s.end))}return"^"!=t.charAt(0)&&(t="^"+t),"$"!=t.charAt(t.length-1)&&(t+="$"),new RegExp(t,(e||"").replace("g",""))},this.getLineTokens=function(t,e){if(e&&"string"!=typeof e){var i=e.slice(0);"#tmp"===(e=i[0])&&(i.shift(),e=i.shift())}else i=[];var s=e||"start",o=this.states[s];o||(o=this.states[s="start"]);var r=this.matchMappings[s],a=this.regExps[s];a.lastIndex=0;for(var l,c=[],h=0,d=0,u={type:null,value:""};l=a.exec(t);){var m=r.defaultToken,p=null,b=l[0],f=a.lastIndex;if(f-b.length>h){var g=t.substring(h,f-b.length);u.type==m?u.value+=g:(u.type&&c.push(u),u={type:m,value:g})}for(var y=0;y<l.length-2;y++)if(void 0!==l[y+1]){m=(p=o[r[y]]).onMatch?p.onMatch(b,s,i,t):p.token,p.next&&(s="string"==typeof p.next?p.next:p.next(s,i),(o=this.states[s])||(this.reportError("state doesn't exist",s),o=this.states[s="start"]),r=this.matchMappings[s],h=f,(a=this.regExps[s]).lastIndex=f),p.consumeLineEnd&&(h=f);break}if(b)if("string"==typeof m)p&&!1===p.merge||u.type!==m?(u.type&&c.push(u),u={type:m,value:b}):u.value+=b;else if(m)for(u.type&&c.push(u),u={type:null,value:""},y=0;y<m.length;y++)c.push(m[y]);if(h==t.length)break;if(h=f,d++>n){for(d>2*t.length&&this.reportError("infinite loop with in ace tokenizer",{startState:e,line:t});h<t.length;)u.type&&c.push(u),u={value:t.substring(h,h+=2e3),type:"overflow"};s="start",i=[];break}}return u.type&&c.push(u),i.length>1&&i[0]!==s&&i.unshift("#tmp",s),{tokens:c,state:i.length?i:s}},this.reportError=i.reportError}).call(s.prototype),e.Tokenizer=s})),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],(function(t,e){var i=t("../lib/lang"),n=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(t,e){if(e)for(var i in t){for(var n=t[i],s=0;s<n.length;s++){var o=n[s];(o.next||o.onMatch)&&("string"==typeof o.next&&0!==o.next.indexOf(e)&&(o.next=e+o.next),o.nextState&&0!==o.nextState.indexOf(e)&&(o.nextState=e+o.nextState))}this.$rules[e+i]=n}else for(var i in t)this.$rules[i]=t[i]},this.getRules=function(){return this.$rules},this.embedRules=function(t,e,n,s,o){var r="function"==typeof t?(new t).getRules():t;if(s)for(var a=0;a<s.length;a++)s[a]=e+s[a];else for(var l in s=[],r)s.push(e+l);if(this.addRules(r,e),n){var c=Array.prototype[o?"push":"unshift"];for(a=0;a<s.length;a++)c.apply(this.$rules[s[a]],i.deepCopy(n))}this.$embeds||(this.$embeds=[]),this.$embeds.push(e)},this.getEmbeds=function(){return this.$embeds};var t=function(t,e){return("start"!=t||e.length)&&e.unshift(this.nextState,t),this.nextState},e=function(t,e){return e.shift(),e.shift()||"start"};this.normalizeRules=function(){var i=0,n=this.$rules;Object.keys(n).forEach((function s(o){var r=n[o];r.processed=!0;for(var a=0;a<r.length;a++){var l=r[a],c=null;Array.isArray(l)&&(c=l,l={}),!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var h=l.next||l.push;if(h&&Array.isArray(h)){var d=l.stateName;d||("string"!=typeof(d=l.token)&&(d=d[0]||""),n[d]&&(d+=i++)),n[d]=h,l.next=d,s(d)}else"pop"==h&&(l.next=e);if(l.push&&(l.nextState=l.next||l.push,l.next=t,delete l.push),l.rules)for(var u in l.rules)n[u]?n[u].push&&n[u].push.apply(n[u],l.rules[u]):n[u]=l.rules[u];var m="string"==typeof l?l:l.include;if(m&&(c=Array.isArray(m)?m.map((function(t){return n[t]})):n[m]),c){var p=[a,1].concat(c);l.noEscape&&(p=p.filter((function(t){return!t.next}))),r.splice.apply(r,p),a--}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}),this)},this.createKeywordMapper=function(t,e,i,n){var s=Object.create(null);return Object.keys(t).forEach((function(e){var o=t[e];i&&(o=o.toLowerCase());for(var r=o.split(n||"|"),a=r.length;a--;)s[r[a]]=e})),Object.getPrototypeOf(s)&&(s.__proto__=null),this.$keywordList=Object.keys(s),t=null,i?function(t){return s[t.toLowerCase()]||e}:function(t){return s[t]||e}},this.getKeywords=function(){return this.$keywords}}).call(n.prototype),e.TextHighlightRules=n})),ace.define("ace/mode/behaviour",["require","exports","module"],(function(t,e){var i=function(){this.$behaviours={}};(function(){this.add=function(t,e,i){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[t]:this.$behaviours[t]={}}this.$behaviours[t][e]=i},this.addBehaviours=function(t){for(var e in t)for(var i in t[e])this.add(e,i,t[e][i])},this.remove=function(t){this.$behaviours&&this.$behaviours[t]&&delete this.$behaviours[t]},this.inherit=function(t,e){if("function"==typeof t)var i=(new t).getBehaviours(e);else i=t.getBehaviours(e);this.addBehaviours(i)},this.getBehaviours=function(t){if(t){for(var e={},i=0;i<t.length;i++)this.$behaviours[t[i]]&&(e[t[i]]=this.$behaviours[t[i]]);return e}return this.$behaviours}}).call(i.prototype),e.Behaviour=i})),ace.define("ace/token_iterator",["require","exports","module","ace/range"],(function(t,e){var i=t("./range").Range,n=function(t,e,i){this.$session=t,this.$row=e,this.$rowTokens=t.getTokens(e);var n=t.getTokenAt(e,i);this.$tokenIndex=n?n.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var t;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,t||(t=this.$session.getLength()),this.$row>=t)return this.$row=t-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var t=this.$rowTokens,e=this.$tokenIndex,i=t[e].start;if(void 0!==i)return i;for(i=0;e>0;)i+=t[e-=1].value.length;return i},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var t=this.$rowTokens[this.$tokenIndex],e=this.getCurrentTokenColumn();return new i(this.$row,e,this.$row,e+t.value.length)}}).call(n.prototype),e.TokenIterator=n})),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],(function(t,e){var i,n=t("../../lib/oop"),s=t("../behaviour").Behaviour,o=t("../../token_iterator").TokenIterator,r=t("../../lib/lang"),a=["text","paren.rparen","punctuation.operator"],l=["text","paren.rparen","punctuation.operator","comment"],c={},h={'"':'"',"'":"'"},d=function(t){var e=-1;if(t.multiSelect&&(e=t.selection.index,c.rangeCount!=t.multiSelect.rangeCount&&(c={rangeCount:t.multiSelect.rangeCount})),c[e])return i=c[e];i=c[e]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},u=function(t,e,i,n){var s=t.end.row-t.start.row;return{text:i+e+n,selection:[0,t.start.column+1,s,t.end.column+(s?0:1)]}},m=function(t){this.add("braces","insertion",(function(e,n,s,o,a){var l=s.getCursorPosition(),c=o.doc.getLine(l.row);if("{"==a){d(s);var h=s.getSelectionRange(),p=o.doc.getTextRange(h);if(""!==p&&"{"!==p&&s.getWrapBehavioursEnabled())return u(h,p,"{","}");if(m.isSaneInsertion(s,o))return/[\]\}\)]/.test(c[l.column])||s.inMultiSelectMode||t&&t.braces?(m.recordAutoInsert(s,o,"}"),{text:"{}",selection:[1,1]}):(m.recordMaybeInsert(s,o,"{"),{text:"{",selection:[1,1]})}else if("}"==a){if(d(s),"}"==c.substring(l.column,l.column+1)&&null!==o.$findOpeningBracket("}",{column:l.column+1,row:l.row})&&m.isAutoInsertedClosing(l,c,a))return m.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==a||"\r\n"==a){d(s);var b="";if(m.isMaybeInsertedClosing(l,c)&&(b=r.stringRepeat("}",i.maybeInsertedBrackets),m.clearMaybeInsertedClosing()),"}"===c.substring(l.column,l.column+1)){var f=o.findMatchingBracket({row:l.row,column:l.column+1},"}");if(!f)return null;var g=this.$getIndent(o.getLine(f.row))}else{if(!b)return void m.clearMaybeInsertedClosing();g=this.$getIndent(c)}var y=g+o.getTabString();return{text:"\n"+y+"\n"+g+b,selection:[1,y.length,1,y.length]}}m.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(t,e,n,s,o){var r=s.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==r){if(d(n),"}"==s.doc.getLine(o.start.row).substring(o.end.column,o.end.column+1))return o.end.column++,o;i.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(t,e,i,n,s){if("("==s){d(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return u(o,r,"(",")");if(m.isSaneInsertion(i,n))return m.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==s){d(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row);if(")"==l.substring(a.column,a.column+1)&&null!==n.$findOpeningBracket(")",{column:a.column+1,row:a.row})&&m.isAutoInsertedClosing(a,l,s))return m.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(t,e,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"("==o&&(d(i),")"==n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)))return s.end.column++,s})),this.add("brackets","insertion",(function(t,e,i,n,s){if("["==s){d(i);var o=i.getSelectionRange(),r=n.doc.getTextRange(o);if(""!==r&&i.getWrapBehavioursEnabled())return u(o,r,"[","]");if(m.isSaneInsertion(i,n))return m.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==s){d(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row);if("]"==l.substring(a.column,a.column+1)&&null!==n.$findOpeningBracket("]",{column:a.column+1,row:a.row})&&m.isAutoInsertedClosing(a,l,s))return m.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(t,e,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&"["==o&&(d(i),"]"==n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)))return s.end.column++,s})),this.add("string_dquotes","insertion",(function(t,e,i,n,s){var o=n.$mode.$quotes||h;if(1==s.length&&o[s]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(s))return;d(i);var r=s,a=i.getSelectionRange(),l=n.doc.getTextRange(a);if(!(""===l||1==l.length&&o[l])&&i.getWrapBehavioursEnabled())return u(a,l,r,r);if(!l){var c=i.getCursorPosition(),m=n.doc.getLine(c.row),p=m.substring(c.column-1,c.column),b=m.substring(c.column,c.column+1),f=n.getTokenAt(c.row,c.column),g=n.getTokenAt(c.row,c.column+1);if("\\"==p&&f&&/escape/.test(f.type))return null;var y,v=f&&/string|escape/.test(f.type),Z=!g||/string|escape/.test(g.type);if(b==r)(y=v!==Z)&&/string\.end/.test(g.type)&&(y=!1);else{if(v&&!Z)return null;if(v&&Z)return null;var x=n.$mode.tokenRe;x.lastIndex=0;var G=x.test(p);x.lastIndex=0;var X=x.test(p);if(G||X)return null;if(b&&!/[\s;,.})\]\\]/.test(b))return null;y=!0}return{text:y?r+r:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(t,e,i,n,s){var o=n.doc.getTextRange(s);if(!s.isMultiLine()&&('"'==o||"'"==o)&&(d(i),n.doc.getLine(s.start.row).substring(s.start.column+1,s.start.column+2)==o))return s.end.column++,s}))};m.isSaneInsertion=function(t,e){var i=t.getCursorPosition(),n=new o(e,i.row,i.column);if(!this.$matchTokenType(n.getCurrentToken()||"text",a)){var s=new o(e,i.row,i.column+1);if(!this.$matchTokenType(s.getCurrentToken()||"text",a))return!1}return n.stepForward(),n.getCurrentTokenRow()!==i.row||this.$matchTokenType(n.getCurrentToken()||"text",l)},m.$matchTokenType=function(t,e){return e.indexOf(t.type||t)>-1},m.recordAutoInsert=function(t,e,n){var s=t.getCursorPosition(),o=e.doc.getLine(s.row);this.isAutoInsertedClosing(s,o,i.autoInsertedLineEnd[0])||(i.autoInsertedBrackets=0),i.autoInsertedRow=s.row,i.autoInsertedLineEnd=n+o.substr(s.column),i.autoInsertedBrackets++},m.recordMaybeInsert=function(t,e,n){var s=t.getCursorPosition(),o=e.doc.getLine(s.row);this.isMaybeInsertedClosing(s,o)||(i.maybeInsertedBrackets=0),i.maybeInsertedRow=s.row,i.maybeInsertedLineStart=o.substr(0,s.column)+n,i.maybeInsertedLineEnd=o.substr(s.column),i.maybeInsertedBrackets++},m.isAutoInsertedClosing=function(t,e,n){return i.autoInsertedBrackets>0&&t.row===i.autoInsertedRow&&n===i.autoInsertedLineEnd[0]&&e.substr(t.column)===i.autoInsertedLineEnd},m.isMaybeInsertedClosing=function(t,e){return i.maybeInsertedBrackets>0&&t.row===i.maybeInsertedRow&&e.substr(t.column)===i.maybeInsertedLineEnd&&e.substr(0,t.column)==i.maybeInsertedLineStart},m.popAutoInsertedClosing=function(){i.autoInsertedLineEnd=i.autoInsertedLineEnd.substr(1),i.autoInsertedBrackets--},m.clearMaybeInsertedClosing=function(){i&&(i.maybeInsertedBrackets=0,i.maybeInsertedRow=-1)},n.inherits(m,s),e.CstyleBehaviour=m})),ace.define("ace/unicode",["require","exports","module"],(function(t,e){e.packages={},function(t){var i=/\w{4}/g;for(var n in t)e.packages[n]=t[n].replace(i,"\\u$&")}({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05250531-055605590561-058705D0-05EA05F0-05F20621-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280904-0939093D09500958-0961097109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510D0-10FA10FC1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209421022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2D00-2D252D30-2D652D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A65FA662-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78BA78CA7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Ll:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F0521052305250561-05871D00-1D2B1D62-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7C2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2D00-2D25A641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CFB00-FB06FB13-FB17FF41-FF5A",Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E0520052205240531-055610A0-10C51E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CEDA640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D611D781D9B-1DBF2071207F2090-20942C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A9CFAA70AADDFF70FF9EFF9F",Lo:"01BB01C0-01C3029405D0-05EA05F0-05F20621-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150904-0939093D09500958-096109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF12135-21382D30-2D652D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DE-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0903093C093E-094E0951-0955096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F90-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135F1712-17141732-1734175217531772177317B6-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAA1C24-1C371CD0-1CD21CD4-1CE81CED1CF21DC0-1DE61DFD-1DFF20D0-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66F-A672A67CA67DA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0902093C0941-0948094D0951-095509620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F90-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135F1712-17141732-1734175217531772177317B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1DC0-1DE61DFD-1DFF20D0-20DC20E120E5-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66FA67CA67DA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093E-09400949-094C094E0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1C24-1C2B1C341C351CE11CF2A823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048906DE20DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F920702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100AB00B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F3A-0F3D0F850FD0-0FD4104A-104F10FB1361-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2E00-2E2E2E302E313001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F850FD0-0FD4104A-104F10FB1361-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E302E313001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A900AC00AE-00B100B400B600B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F604820606-0608060B060E060F06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0CF10CF20D790E3F0F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-139917DB194019E0-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B8210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23E82400-24262440-244A249C-24E92500-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE27C0-27C427C7-27CA27CC27D0-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C2140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27CA27CC27D0-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5060B09F209F309FB0AF10BF90E3F17DB20A0-20B8A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFF3EFF40FFE3",So:"00A600A700A900AE00B000B60482060E060F06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0CF10CF20D790F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-1399194019E0-19FF1B61-1B6A1B74-1B7C210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23E82400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-0605061C061D0620065F06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17B417B517DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060306DD070F17B417B5200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-05FF06040605061C061D0620065F070E074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"})})),ace.define("ace/mode/text",["require","exports","module","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],(function(t,e){var i=t("../tokenizer").Tokenizer,n=t("./text_highlight_rules").TextHighlightRules,s=t("./behaviour/cstyle").CstyleBehaviour,o=t("../unicode"),r=t("../lib/lang"),a=t("../token_iterator").TokenIterator,l=t("../range").Range,c=function(){this.HighlightRules=n};(function(){this.$defaultBehaviour=new s,this.tokenRe=new RegExp("^["+o.packages.L+o.packages.Mn+o.packages.Mc+o.packages.Nd+o.packages.Pc+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+o.packages.L+o.packages.Mn+o.packages.Mc+o.packages.Nd+o.packages.Pc+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new i(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(t,e,i,n){var s=e.doc,o=!0,a=!0,l=1/0,c=e.getTabSize(),h=!1;if(this.lineCommentStart){Array.isArray(this.lineCommentStart)?(b=this.lineCommentStart.map(r.escapeRegExp).join("|"),m=this.lineCommentStart[0]):(b=r.escapeRegExp(this.lineCommentStart),m=this.lineCommentStart),b=new RegExp("^(\\s*)(?:"+b+") ?"),h=e.getUseSoftTabs(),y=function(t,e){var i=t.match(b);if(i){var n=i[1].length,o=i[0].length;u(t,n,o)||" "!=i[0][o-1]||o--,s.removeInLine(e,n,o)}};var d=m+" ",u=(g=function(t,e){o&&!/\S/.test(t)||(u(t,l,l)?s.insertInLine({row:e,column:l},d):s.insertInLine({row:e,column:l},m))},v=function(t){return b.test(t)},function(t,e,i){for(var n=0;e--&&" "==t.charAt(e);)n++;if(n%c!=0)return!1;for(n=0;" "==t.charAt(i++);)n++;return c>2?n%c!=c-1:n%c==0})}else{if(!this.blockComment)return!1;var m=this.blockComment.start,p=this.blockComment.end,b=new RegExp("^(\\s*)(?:"+r.escapeRegExp(m)+")"),f=new RegExp("(?:"+r.escapeRegExp(p)+")\\s*$"),g=function(t,e){v(t,e)||o&&!/\S/.test(t)||(s.insertInLine({row:e,column:t.length},p),s.insertInLine({row:e,column:l},m))},y=function(t,e){var i;(i=t.match(f))&&s.removeInLine(e,t.length-i[0].length,t.length),(i=t.match(b))&&s.removeInLine(e,i[1].length,i[0].length)},v=function(t,i){if(b.test(t))return!0;for(var n=e.getTokens(i),s=0;s<n.length;s++)if("comment"===n[s].type)return!0}}function Z(t){for(var e=i;e<=n;e++)t(s.getLine(e),e)}var x=1/0;Z((function(t,e){var i=t.search(/\S/);-1!==i?(i<l&&(l=i),a&&!v(t,e)&&(a=!1)):x>t.length&&(x=t.length)})),l==1/0&&(l=x,o=!1,a=!1),h&&l%c!=0&&(l=Math.floor(l/c)*c),Z(a?y:g)},this.toggleBlockComment=function(t,e,i,n){var s=this.blockComment;if(s){!s.start&&s[0]&&(s=s[0]);var o,r,c=(b=new a(e,n.row,n.column)).getCurrentToken(),h=e.selection.toOrientedRange();if(c&&/comment/.test(c.type)){for(var d,u;c&&/comment/.test(c.type);){if(-1!=(f=c.value.indexOf(s.start))){var m=b.getCurrentTokenRow(),p=b.getCurrentTokenColumn()+f;d=new l(m,p,m,p+s.start.length);break}c=b.stepBackward()}var b;for(c=(b=new a(e,n.row,n.column)).getCurrentToken();c&&/comment/.test(c.type);){var f;if(-1!=(f=c.value.indexOf(s.end))){m=b.getCurrentTokenRow(),p=b.getCurrentTokenColumn()+f,u=new l(m,p,m,p+s.end.length);break}c=b.stepForward()}u&&e.remove(u),d&&(e.remove(d),o=d.start.row,r=-s.start.length)}else r=s.start.length,o=i.start.row,e.insert(i.end,s.end),e.insert(i.start,s.start);h.start.row==o&&(h.start.column+=r),h.end.row==o&&(h.end.column+=r),e.selection.fromOrientedRange(h)}},this.getNextLineIndent=function(t,e){return this.$getIndent(e)},this.checkOutdent=function(){return!1},this.autoOutdent=function(){},this.$getIndent=function(t){return t.match(/^\s*/)[0]},this.createWorker=function(){return null},this.createModeDelegates=function(t){for(var e in this.$embeds=[],this.$modes={},t)t[e]&&(this.$embeds.push(e),this.$modes[e]=new t[e]);var i=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(e=0;e<i.length;e++)!function(t){var n=i[e],s=t[n];t[i[e]]=function(){return this.$delegator(n,arguments,s)}}(this)},this.$delegator=function(t,e,i){var n=e[0];"string"!=typeof n&&(n=n[0]);for(var s=0;s<this.$embeds.length;s++)if(this.$modes[this.$embeds[s]]){var o=n.split(this.$embeds[s]);if(!o[0]&&o[1]){e[0]=o[1];var r=this.$modes[this.$embeds[s]];return r[t].apply(r,e)}}var a=i.apply(this,e);return i?a:void 0},this.transformAction=function(t,e,i,n,s){if(this.$behaviour){var o=this.$behaviour.getBehaviours();for(var r in o)if(o[r][e]){var a=o[r][e].apply(this,arguments);if(a)return a}}},this.getKeywords=function(t){if(!this.completionKeywords){var e=this.$tokenizer.rules,i=[];for(var n in e)for(var s=e[n],o=0,r=s.length;o<r;o++)if("string"==typeof s[o].token)/keyword|support|storage/.test(s[o].token)&&i.push(s[o].regex);else if("object"==typeof s[o].token)for(var a=0,l=s[o].token.length;a<l;a++)/keyword|support|storage/.test(s[o].token[a])&&(n=s[o].regex.match(/\(.+?\)/g)[a],i.push(n.substr(1,n.length-2)));this.completionKeywords=i}return t?i.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(){return(this.$keywordList||this.$createKeywordList()).map((function(t){return{name:t,value:t,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call(c.prototype),e.Mode=c})),ace.define("ace/apply_delta",["require","exports","module"],(function(t,e){e.applyDelta=function(t,e){var i=e.start.row,n=e.start.column,s=t[i]||"";switch(e.action){case"insert":if(1===e.lines.length)t[i]=s.substring(0,n)+e.lines[0]+s.substring(n);else{var o=[i,1].concat(e.lines);t.splice.apply(t,o),t[i]=s.substring(0,n)+t[i],t[i+e.lines.length-1]+=s.substring(n)}break;case"remove":var r=e.end.column,a=e.end.row;i===a?t[i]=s.substring(0,n)+s.substring(r):t.splice(i,a-i+1,s.substring(0,n)+t[a].substring(r))}}})),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(t,e){var i=t("./lib/oop"),n=t("./lib/event_emitter").EventEmitter,s=e.Anchor=function(t,e,i){this.$onChange=this.onChange.bind(this),this.attach(t),void 0===i?this.setPosition(e.row,e.column):this.setPosition(e,i)};(function(){function t(t,e,i){return t.row<e.row||t.row==e.row&&(i?t.column<=e.column:t.column<e.column)}i.implement(this,n),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){if(!(e.start.row==e.end.row&&e.start.row!=this.row||e.start.row>this.row)){var i=function(e,i,n){var s="insert"==e.action,o=(s?1:-1)*(e.end.row-e.start.row),r=(s?1:-1)*(e.end.column-e.start.column),a=e.start,l=s?a:e.end;return t(i,a,n)?{row:i.row,column:i.column}:t(l,i,!n)?{row:i.row+o,column:i.column+(i.row==l.row?r:0)}:{row:a.row,column:a.column}}(e,{row:this.row,column:this.column},this.$insertRight);this.setPosition(i.row,i.column,!0)}},this.setPosition=function(t,e,i){var n;if(n=i?{row:t,column:e}:this.$clipPositionToDocument(t,e),this.row!=n.row||this.column!=n.column){var s={row:this.row,column:this.column};this.row=n.row,this.column=n.column,this._signal("change",{old:s,value:n})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(t){this.document=t||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(t,e){var i={};return t>=this.document.getLength()?(i.row=Math.max(0,this.document.getLength()-1),i.column=this.document.getLine(i.row).length):t<0?(i.row=0,i.column=0):(i.row=t,i.column=Math.min(this.document.getLine(i.row).length,Math.max(0,e))),e<0&&(i.column=0),i}}).call(s.prototype)})),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],(function(t,e){var i=t("./lib/oop"),n=t("./apply_delta").applyDelta,s=t("./lib/event_emitter").EventEmitter,o=t("./range").Range,r=t("./anchor").Anchor,a=function(t){this.$lines=[""],0===t.length?this.$lines=[""]:Array.isArray(t)?this.insertMergedLines({row:0,column:0},t):this.insert({row:0,column:0},t)};(function(){i.implement(this,s),this.setValue=function(t){var e=this.getLength()-1;this.remove(new o(0,0,e,this.getLine(e).length)),this.insert({row:0,column:0},t)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(t,e){return new r(this,t,e)},this.$split=0==="aaa".split(/a/).length?function(t){return t.replace(/\r\n|\r/g,"\n").split("\n")}:function(t){return t.split(/\r\n|\r|\n/)},this.$detectNewLine=function(t){var e=t.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=e?e[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(t){this.$newLineMode!==t&&(this.$newLineMode=t,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(t){return"\r\n"==t||"\r"==t||"\n"==t},this.getLine=function(t){return this.$lines[t]||""},this.getLines=function(t,e){return this.$lines.slice(t,e+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(t){return this.getLinesForRange(t).join(this.getNewLineCharacter())},this.getLinesForRange=function(t){var e;if(t.start.row===t.end.row)e=[this.getLine(t.start.row).substring(t.start.column,t.end.column)];else{(e=this.getLines(t.start.row,t.end.row))[0]=(e[0]||"").substring(t.start.column);var i=e.length-1;t.end.row-t.start.row==i&&(e[i]=e[i].substring(0,t.end.column))}return e},this.insertLines=function(t,e){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(t,e)},this.removeLines=function(t,e){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(t,e)},this.insertNewLine=function(t){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(t,["",""])},this.insert=function(t,e){return this.getLength()<=1&&this.$detectNewLine(e),this.insertMergedLines(t,this.$split(e))},this.insertInLine=function(t,e){var i=this.clippedPos(t.row,t.column),n=this.pos(t.row,t.column+e.length);return this.applyDelta({start:i,end:n,action:"insert",lines:[e]},!0),this.clonePos(n)},this.clippedPos=function(t,e){var i=this.getLength();void 0===t?t=i:t<0?t=0:t>=i&&(t=i-1,e=void 0);var n=this.getLine(t);return null==e&&(e=n.length),{row:t,column:e=Math.min(Math.max(e,0),n.length)}},this.clonePos=function(t){return{row:t.row,column:t.column}},this.pos=function(t,e){return{row:t,column:e}},this.$clipPosition=function(t){var e=this.getLength();return t.row>=e?(t.row=Math.max(0,e-1),t.column=this.getLine(e-1).length):(t.row=Math.max(0,t.row),t.column=Math.min(Math.max(t.column,0),this.getLine(t.row).length)),t},this.insertFullLines=function(t,e){var i=0;(t=Math.min(Math.max(t,0),this.getLength()))<this.getLength()?(e=e.concat([""]),i=0):(e=[""].concat(e),t--,i=this.$lines[t].length),this.insertMergedLines({row:t,column:i},e)},this.insertMergedLines=function(t,e){var i=this.clippedPos(t.row,t.column),n={row:i.row+e.length-1,column:(1==e.length?i.column:0)+e[e.length-1].length};return this.applyDelta({start:i,end:n,action:"insert",lines:e}),this.clonePos(n)},this.remove=function(t){var e=this.clippedPos(t.start.row,t.start.column),i=this.clippedPos(t.end.row,t.end.column);return this.applyDelta({start:e,end:i,action:"remove",lines:this.getLinesForRange({start:e,end:i})}),this.clonePos(e)},this.removeInLine=function(t,e,i){var n=this.clippedPos(t,e),s=this.clippedPos(t,i);return this.applyDelta({start:n,end:s,action:"remove",lines:this.getLinesForRange({start:n,end:s})},!0),this.clonePos(n)},this.removeFullLines=function(t,e){t=Math.min(Math.max(0,t),this.getLength()-1);var i=(e=Math.min(Math.max(0,e),this.getLength()-1))==this.getLength()-1&&t>0,n=e<this.getLength()-1,s=i?t-1:t,r=i?this.getLine(s).length:0,a=n?e+1:e,l=n?0:this.getLine(a).length,c=new o(s,r,a,l),h=this.$lines.slice(t,e+1);return this.applyDelta({start:c.start,end:c.end,action:"remove",lines:this.getLinesForRange(c)}),h},this.removeNewLine=function(t){t<this.getLength()-1&&t>=0&&this.applyDelta({start:this.pos(t,this.getLine(t).length),end:this.pos(t+1,0),action:"remove",lines:["",""]})},this.replace=function(t,e){return t instanceof o||(t=o.fromPoints(t.start,t.end)),0===e.length&&t.isEmpty()?t.start:e==this.getTextRange(t)?t.end:(this.remove(t),e?this.insert(t.start,e):t.start)},this.applyDeltas=function(t){for(var e=0;e<t.length;e++)this.applyDelta(t[e])},this.revertDeltas=function(t){for(var e=t.length-1;e>=0;e--)this.revertDelta(t[e])},this.applyDelta=function(t,e){var i="insert"==t.action;(i?t.lines.length<=1&&!t.lines[0]:!o.comparePoints(t.start,t.end))||(i&&t.lines.length>2e4&&this.$splitAndapplyLargeDelta(t,2e4),n(this.$lines,t,e),this._signal("change",t))},this.$splitAndapplyLargeDelta=function(t,e){for(var i=t.lines,n=i.length,s=t.start.row,o=t.start.column,r=0,a=0;;){var l=i.slice(r=a,a+=e-1);if(a>n){t.lines=l,t.start.row=s+r,t.start.column=o;break}l.push(""),this.applyDelta({start:this.pos(s+r,o),end:this.pos(s+a,o=0),action:t.action,lines:l},!0)}},this.revertDelta=function(t){this.applyDelta({start:this.clonePos(t.start),end:this.clonePos(t.end),action:"insert"==t.action?"remove":"insert",lines:t.lines.slice()})},this.indexToPosition=function(t,e){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=e||0,o=i.length;s<o;s++)if((t-=i[s].length+n)<0)return{row:s,column:t+i[s].length+n};return{row:o-1,column:i[o-1].length}},this.positionToIndex=function(t,e){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=0,o=Math.min(t.row,i.length),r=e||0;r<o;++r)s+=i[r].length+n;return s+t.column}}).call(a.prototype),e.Document=a})),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(t,e){var i=t("./lib/oop"),n=t("./lib/event_emitter").EventEmitter,s=function(t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=t;var e=this;this.$worker=function(){if(e.running){for(var t=new Date,i=e.currentLine,n=-1,s=e.doc,o=i;e.lines[i];)i++;var r=s.getLength(),a=0;for(e.running=!1;i<r;){e.$tokenizeRow(i),n=i;do{i++}while(e.lines[i]);if(++a%5==0&&new Date-t>20){e.running=setTimeout(e.$worker,20);break}}e.currentLine=i,-1==n&&(n=i),o<=n&&e.fireUpdateEvent(o,n)}}};(function(){i.implement(this,n),this.setTokenizer=function(t){this.tokenizer=t,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(t){this.doc=t,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(t,e){this._signal("update",{data:{first:t,last:e}})},this.start=function(t){this.currentLine=Math.min(t||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(t){var e=t.start.row,i=t.end.row-e;if(0===i)this.lines[e]=null;else if("remove"==t.action)this.lines.splice(e,i+1,null),this.states.splice(e,i+1,null);else{var n=Array(i+1);n.unshift(e,1),this.lines.splice.apply(this.lines,n),this.states.splice.apply(this.states,n)}this.currentLine=Math.min(e,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(t){return this.lines[t]||this.$tokenizeRow(t)},this.getState=function(t){return this.currentLine==t&&this.$tokenizeRow(t),this.states[t]||"start"},this.$tokenizeRow=function(t){var e=this.doc.getLine(t),i=this.tokenizer.getLineTokens(e,this.states[t-1],t);return this.states[t]+""!=i.state+""?(this.states[t]=i.state,this.lines[t+1]=null,this.currentLine>t+1&&(this.currentLine=t+1)):this.currentLine==t&&(this.currentLine=t+1),this.lines[t]=i.tokens}}).call(s.prototype),e.BackgroundTokenizer=s})),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(t,e){var i=t("./lib/lang"),n=(t("./lib/oop"),t("./range").Range),s=function(t,e,i){this.setRegexp(t),this.clazz=e,this.type=i||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(t){this.regExp+""!=t+""&&(this.regExp=t,this.cache=[])},this.update=function(t,e,s,o){if(this.regExp)for(var r=o.lastRow,a=o.firstRow;a<=r;a++){var l=this.cache[a];null==l&&((l=i.getMatchOffsets(s.getLine(a),this.regExp)).length>this.MAX_RANGES&&(l=l.slice(0,this.MAX_RANGES)),l=l.map((function(t){return new n(a,t.offset,a,t.offset+t.length)})),this.cache[a]=l.length?l:"");for(var c=l.length;c--;)e.drawSingleLineMarker(t,l[c].toScreenRange(s),this.clazz,o)}}}).call(s.prototype),e.SearchHighlight=s})),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],(function(t,e){var i=t("../range").Range;function n(t,e){this.foldData=t,Array.isArray(e)?this.folds=e:e=this.folds=[e];var n=e[e.length-1];this.range=new i(e[0].start.row,e[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(t){t.setFoldLine(this)}),this)}(function(){this.shiftRow=function(t){this.start.row+=t,this.end.row+=t,this.folds.forEach((function(e){e.start.row+=t,e.end.row+=t}))},this.addFold=function(t){if(t.sameRow){if(t.start.row<this.startRow||t.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(t),this.folds.sort((function(t,e){return-t.range.compareEnd(e.start.row,e.start.column)})),this.range.compareEnd(t.start.row,t.start.column)>0?(this.end.row=t.end.row,this.end.column=t.end.column):this.range.compareStart(t.end.row,t.end.column)<0&&(this.start.row=t.start.row,this.start.column=t.start.column)}else if(t.start.row==this.end.row)this.folds.push(t),this.end.row=t.end.row,this.end.column=t.end.column;else{if(t.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(t),this.start.row=t.start.row,this.start.column=t.start.column}t.foldLine=this},this.containsRow=function(t){return t>=this.start.row&&t<=this.end.row},this.walk=function(t,e,i){var n,s,o=0,r=this.folds,a=!0;null==e&&(e=this.end.row,i=this.end.column);for(var l=0;l<r.length;l++){if(-1==(s=(n=r[l]).range.compareStart(e,i)))return void t(null,e,i,o,a);if(!t(null,n.start.row,n.start.column,o,a)&&t(n.placeholder,n.start.row,n.start.column,o)||0===s)return;a=!n.sameRow,o=n.end.column}t(null,e,i,o,a)},this.getNextFoldTo=function(t,e){for(var i,n,s=0;s<this.folds.length;s++){if(-1==(n=(i=this.folds[s]).range.compareEnd(t,e)))return{fold:i,kind:"after"};if(0===n)return{fold:i,kind:"inside"}}return null},this.addRemoveChars=function(t,e,i){var n,s,o=this.getNextFoldTo(t,e);if(o)if(n=o.fold,"inside"==o.kind&&n.start.column!=e&&n.start.row!=t)window.console&&window.console.log(t,e,n);else if(n.start.row==t){var r=(s=this.folds).indexOf(n);for(0===r&&(this.start.column+=i);r<s.length;r++){if((n=s[r]).start.column+=i,!n.sameRow)return;n.end.column+=i}this.end.column+=i}},this.split=function(t,e){var i=this.getNextFoldTo(t,e);if(!i||"inside"==i.kind)return null;var s=this.folds,o=this.foldData,r=s.indexOf(i.fold),a=s[r-1];this.end.row=a.end.row,this.end.column=a.end.column;var l=new n(o,s=s.splice(r,s.length-r));return o.splice(o.indexOf(this)+1,0,l),l},this.merge=function(t){for(var e=t.folds,i=0;i<e.length;i++)this.addFold(e[i]);var n=this.foldData;n.splice(n.indexOf(t),1)},this.toString=function(){var t=[this.range.toString()+": ["];return this.folds.forEach((function(e){t.push("  "+e.toString())})),t.push("]"),t.join("\n")},this.idxToPosition=function(t){for(var e=0,i=0;i<this.folds.length;i++){var n=this.folds[i];if((t-=n.start.column-e)<0)return{row:n.start.row,column:n.start.column+t};if((t-=n.placeholder.length)<0)return n.start;e=n.end.column}return{row:this.end.row,column:this.end.column+t}}}).call(n.prototype),e.FoldLine=n})),ace.define("ace/range_list",["require","exports","module","ace/range"],(function(t,e){var i=t("./range").Range.comparePoints,n=function(){this.ranges=[]};(function(){this.comparePoints=i,this.pointIndex=function(t,e,n){for(var s=this.ranges,o=n||0;o<s.length;o++){var r=s[o],a=i(t,r.end);if(!(a>0)){var l=i(t,r.start);return 0===a?e&&0!==l?-o-2:o:l>0||0===l&&!e?o:-o-1}}return-o-1},this.add=function(t){var e=!t.isEmpty(),i=this.pointIndex(t.start,e);i<0&&(i=-i-1);var n=this.pointIndex(t.end,e,i);return n<0?n=-n-1:n++,this.ranges.splice(i,n-i,t)},this.addList=function(t){for(var e=[],i=t.length;i--;)e.push.apply(e,this.add(t[i]));return e},this.substractPoint=function(t){var e=this.pointIndex(t);if(e>=0)return this.ranges.splice(e,1)},this.merge=function(){for(var t,e=[],n=this.ranges,s=(n=n.sort((function(t,e){return i(t.start,e.start)})))[0],o=1;o<n.length;o++){var r=i((t=s).end,(s=n[o]).start);r<0||(0!=r||t.isEmpty()||s.isEmpty())&&(i(t.end,s.end)<0&&(t.end.row=s.end.row,t.end.column=s.end.column),n.splice(o,1),e.push(s),s=t,o--)}return this.ranges=n,e},this.contains=function(t,e){return this.pointIndex({row:t,column:e})>=0},this.containsPoint=function(t){return this.pointIndex(t)>=0},this.rangeAtPoint=function(t){var e=this.pointIndex(t);if(e>=0)return this.ranges[e]},this.clipRows=function(t,e){var i=this.ranges;if(i[0].start.row>e||i[i.length-1].start.row<t)return[];var n=this.pointIndex({row:t,column:0});n<0&&(n=-n-1);var s=this.pointIndex({row:e,column:0},n);s<0&&(s=-s-1);for(var o=[],r=n;r<s;r++)o.push(i[r]);return o},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(t){this.session&&this.detach(),this.session=t,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(t){if("insert"==t.action)var e=t.start,i=t.end;else i=t.start,e=t.end;for(var n=e.row,s=i.row-n,o=-e.column+i.column,r=this.ranges,a=0,l=r.length;a<l;a++)if(!((c=r[a]).end.row<n)){if(c.start.row>n)break;if(c.start.row==n&&c.start.column>=e.column&&(c.start.column==e.column&&this.$insertRight||(c.start.column+=o,c.start.row+=s)),c.end.row==n&&c.end.column>=e.column){if(c.end.column==e.column&&this.$insertRight)continue;c.end.column==e.column&&o>0&&a<l-1&&c.end.column>c.start.column&&c.end.column==r[a+1].start.column&&(c.end.column-=o),c.end.column+=o,c.end.row+=s}}if(0!=s&&a<l)for(;a<l;a++){var c;(c=r[a]).start.row+=s,c.end.row+=s}}}).call(n.prototype),e.RangeList=n})),ace.define("ace/edit_session/fold",["require","exports","module","ace/range","ace/range_list","ace/lib/oop"],(function(t,e){t("../range");var i=t("../range_list").RangeList,n=t("../lib/oop"),s=e.Fold=function(t,e){this.foldLine=null,this.placeholder=e,this.range=t,this.start=t.start,this.end=t.end,this.sameRow=t.start.row==t.end.row,this.subFolds=this.ranges=[]};function o(t,e){t.row-=e.row,0==t.row&&(t.column-=e.column)}function r(t,e){0==t.row&&(t.column+=e.column),t.row+=e.row}n.inherits(s,i),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(t){this.foldLine=t,this.subFolds.forEach((function(e){e.setFoldLine(t)}))},this.clone=function(){var t=this.range.clone(),e=new s(t,this.placeholder);return this.subFolds.forEach((function(t){e.subFolds.push(t.clone())})),e.collapseChildren=this.collapseChildren,e},this.addSubFold=function(t){if(!this.range.isEqual(t)){if(!this.range.containsRange(t))throw new Error("A fold can't intersect already existing fold"+t.range+this.range);var e,i;o((e=t).start,i=this.start),o(e.end,i);for(var n=t.start.row,s=t.start.column,r=0,a=-1;r<this.subFolds.length&&1==(a=this.subFolds[r].range.compare(n,s));r++);if(0==a)return this.subFolds[r].addSubFold(t);n=t.range.end.row,s=t.range.end.column;var l=r;for(a=-1;l<this.subFolds.length&&1==(a=this.subFolds[l].range.compare(n,s));l++);if(0==a)throw new Error("A fold can't intersect already existing fold"+t.range+this.range);return this.subFolds.splice(r,l-r,t),t.setFoldLine(this.foldLine),t}},this.restoreRange=function(t){return function(t,e){r(t.start,e),r(t.end,e)}(t,this.start)}}.call(s.prototype)})),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],(function(t,i){var n=t("../range").Range,s=t("./fold_line").FoldLine,o=t("./fold").Fold,r=t("../token_iterator").TokenIterator;i.Folding=function(){this.getFoldAt=function(t,e,i){var n=this.getFoldLine(t);if(!n)return null;for(var s=n.folds,o=0;o<s.length;o++){var r=s[o];if(r.range.contains(t,e)){if(1==i&&r.range.isEnd(t,e))continue;if(-1==i&&r.range.isStart(t,e))continue;return r}}},this.getFoldsInRange=function(t){var e=t.start,i=t.end,n=this.$foldData,s=[];e.column+=1,i.column-=1;for(var o=0;o<n.length;o++){var r=n[o].range.compareRange(t);if(2!=r){if(-2==r)break;for(var a=n[o].folds,l=0;l<a.length;l++){var c=a[l];if(-2==(r=c.range.compareRange(t)))break;if(2!=r){if(42==r)break;s.push(c)}}}}return e.column-=1,i.column+=1,s},this.getFoldsInRangeList=function(t){if(Array.isArray(t)){var e=[];t.forEach((function(t){e=e.concat(this.getFoldsInRange(t))}),this)}else e=this.getFoldsInRange(t);return e},this.getAllFolds=function(){for(var t=[],e=this.$foldData,i=0;i<e.length;i++)for(var n=0;n<e[i].folds.length;n++)t.push(e[i].folds[n]);return t},this.getFoldStringAt=function(t,e,i,n){if(!(n=n||this.getFoldLine(t)))return null;for(var s,o,r={end:{column:0}},a=0;a<n.folds.length;a++){var l=(o=n.folds[a]).range.compareEnd(t,e);if(-1==l){s=this.getLine(o.start.row).substring(r.end.column,o.start.column);break}if(0===l)return null;r=o}return s||(s=this.getLine(o.start.row).substring(r.end.column)),-1==i?s.substring(0,e-r.end.column):1==i?s.substring(e-r.end.column):s},this.getFoldLine=function(t,e){var i=this.$foldData,n=0;for(e&&(n=i.indexOf(e)),-1==n&&(n=0);n<i.length;n++){var s=i[n];if(s.start.row<=t&&s.end.row>=t)return s;if(s.end.row>t)return null}return null},this.getNextFoldLine=function(t,e){var i=this.$foldData,n=0;for(e&&(n=i.indexOf(e)),-1==n&&(n=0);n<i.length;n++){var s=i[n];if(s.end.row>=t)return s}return null},this.getFoldedRowCount=function(t,e){for(var i=this.$foldData,n=e-t+1,s=0;s<i.length;s++){var o=i[s],r=o.end.row,a=o.start.row;if(r>=e){a<e&&(a>=t?n-=e-a:n=0);break}r>=t&&(n-=a>=t?r-a:r-t+1)}return n},this.$addFoldLine=function(t){return this.$foldData.push(t),this.$foldData.sort((function(t,e){return t.start.row-e.start.row})),t},this.addFold=function(t,e){var i,n=this.$foldData,r=!1;t instanceof o?i=t:(i=new o(e,t)).collapseChildren=e.collapseChildren,this.$clipRangeToDocument(i.range);var a=i.start.row,l=i.start.column,c=i.end.row,h=i.end.column;if(!(a<c||a==c&&l<=h-2))throw new Error("The range has to be at least 2 characters width");var d=this.getFoldAt(a,l,1),u=this.getFoldAt(c,h,-1);if(d&&u==d)return d.addSubFold(i);d&&!d.range.isStart(a,l)&&this.removeFold(d),u&&!u.range.isEnd(c,h)&&this.removeFold(u);var m=this.getFoldsInRange(i.range);m.length>0&&(this.removeFolds(m),m.forEach((function(t){i.addSubFold(t)})));for(var p=0;p<n.length;p++){var b=n[p];if(c==b.start.row){b.addFold(i),r=!0;break}if(a==b.end.row){if(b.addFold(i),r=!0,!i.sameRow){var f=n[p+1];if(f&&f.start.row==c){b.merge(f);break}}break}if(c<=b.start.row)break}return r||(b=this.$addFoldLine(new s(this.$foldData,i))),this.$useWrapMode?this.$updateWrapData(b.start.row,b.start.row):this.$updateRowLengthCache(b.start.row,b.start.row),this.$modified=!0,this._signal("changeFold",{data:i,action:"add"}),i},this.addFolds=function(t){t.forEach((function(t){this.addFold(t)}),this)},this.removeFold=function(t){var e=t.foldLine,i=e.start.row,n=e.end.row,s=this.$foldData,o=e.folds;if(1==o.length)s.splice(s.indexOf(e),1);else if(e.range.isEnd(t.end.row,t.end.column))o.pop(),e.end.row=o[o.length-1].end.row,e.end.column=o[o.length-1].end.column;else if(e.range.isStart(t.start.row,t.start.column))o.shift(),e.start.row=o[0].start.row,e.start.column=o[0].start.column;else if(t.sameRow)o.splice(o.indexOf(t),1);else{var r=e.split(t.start.row,t.start.column);(o=r.folds).shift(),r.start.row=o[0].start.row,r.start.column=o[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(i,n):this.$updateRowLengthCache(i,n)),this.$modified=!0,this._signal("changeFold",{data:t,action:"remove"})},this.removeFolds=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);e.forEach((function(t){this.removeFold(t)}),this),this.$modified=!0},this.expandFold=function(t){this.removeFold(t),t.subFolds.forEach((function(e){t.restoreRange(e),this.addFold(e)}),this),t.collapseChildren>0&&this.foldAll(t.start.row+1,t.end.row,t.collapseChildren-1),t.subFolds=[]},this.expandFolds=function(t){t.forEach((function(t){this.expandFold(t)}),this)},this.unfold=function(t,e){var i,s;if(null==t?(i=new n(0,0,this.getLength(),0),e=!0):i="number"==typeof t?new n(t,0,t,this.getLine(t).length):"row"in t?n.fromPoints(t,t):t,s=this.getFoldsInRangeList(i),e)this.removeFolds(s);else for(var o=s;o.length;)this.expandFolds(o),o=this.getFoldsInRangeList(i);if(s.length)return s},this.isRowFolded=function(t,e){return!!this.getFoldLine(t,e)},this.getRowFoldEnd=function(t,e){var i=this.getFoldLine(t,e);return i?i.end.row:t},this.getRowFoldStart=function(t,e){var i=this.getFoldLine(t,e);return i?i.start.row:t},this.getFoldDisplayLine=function(t,e,i,n,s){null==n&&(n=t.start.row),null==s&&(s=0),null==e&&(e=t.end.row),null==i&&(i=this.getLine(e).length);var o=this.doc,r="";return t.walk((function(t,e,i,a){if(!(e<n)){if(e==n){if(i<s)return;a=Math.max(s,a)}r+=null!=t?t:o.getLine(e).substring(a,i)}}),e,i),r},this.getDisplayLine=function(t,e,i,n){var s,o=this.getFoldLine(t);return o?this.getFoldDisplayLine(o,t,e,i,n):(s=this.doc.getLine(t)).substring(n||0,e||s.length)},this.$cloneFoldData=function(){var t=[];return t=this.$foldData.map((function(e){var i=e.folds.map((function(t){return t.clone()}));return new s(t,i)}))},this.toggleFold=function(t){var e,i,n=this.selection.getRange();if(n.isEmpty()){var s=n.start;if(e=this.getFoldAt(s.row,s.column))return void this.expandFold(e);(i=this.findMatchingBracket(s))?1==n.comparePoint(i)?n.end=i:(n.start=i,n.start.column++,n.end.column--):(i=this.findMatchingBracket({row:s.row,column:s.column+1}))?(1==n.comparePoint(i)?n.end=i:n.start=i,n.start.column++):n=this.getCommentFoldRange(s.row,s.column)||n}else{var o=this.getFoldsInRange(n);if(t&&o.length)return void this.expandFolds(o);1==o.length&&(e=o[0])}if(e||(e=this.getFoldAt(n.start.row,n.start.column)),e&&e.range.toString()==n.toString())this.expandFold(e);else{var r="...";if(!n.isMultiLine()){if((r=this.getTextRange(n)).length<4)return;r=r.trim().substring(0,2)+".."}this.addFold(r,n)}},this.getCommentFoldRange=function(t,e,i){var s=new r(this,t,e),o=s.getCurrentToken(),a=o.type;if(o&&/^comment|string/.test(a)){"comment"==(a=a.match(/comment|string/)[0])&&(a+="|doc-start");var l=new RegExp(a),c=new n;if(1!=i){do{o=s.stepBackward()}while(o&&l.test(o.type));s.stepForward()}if(c.start.row=s.getCurrentTokenRow(),c.start.column=s.getCurrentTokenColumn()+2,s=new r(this,t,e),-1!=i){var h=-1;do{if(o=s.stepForward(),-1==h){var d=this.getState(s.$row);l.test(d)||(h=s.$row)}else if(s.$row>h)break}while(o&&l.test(o.type));o=s.stepBackward()}else o=s.getCurrentToken();return c.end.row=s.getCurrentTokenRow(),c.end.column=s.getCurrentTokenColumn()+o.value.length-2,c}},this.foldAll=function(t,i,n){null==n&&(n=1e5);var s=this.foldWidgets;if(s){i=i||this.getLength();for(var o=t=t||0;o<i;o++)if(null==s[o]&&(s[o]=this.getFoldWidget(o)),"start"==s[o]){var r=this.getFoldWidgetRange(o);if(r&&r.isMultiLine()&&r.end.row<=i&&r.start.row>=t){o=r.end.row;try{var a=this.addFold("...",r);a&&(a.collapseChildren=n)}catch(e){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(t){if(!this.$foldStyles[t])throw new Error("invalid fold style: "+t+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=t){this.$foldStyle=t,"manual"==t&&this.unfold();var e=this.$foldMode;this.$setFolding(null),this.$setFolding(e)}},this.$setFolding=function(t){this.$foldMode!=t&&(this.$foldMode=t,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),t&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=t.getFoldWidget.bind(t,this,this.$foldStyle),this.getFoldWidgetRange=t.getFoldWidgetRange.bind(t,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(t,e){var i=this.foldWidgets;if(!i||e&&i[t])return{};for(var n,s=t-1;s>=0;){var o=i[s];if(null==o&&(o=i[s]=this.getFoldWidget(s)),"start"==o){var r=this.getFoldWidgetRange(s);if(n||(n=r),r&&r.end.row>=t)break}s--}return{range:-1!==s&&r,firstRange:n}},this.onFoldWidgetClick=function(t,e){if(!this.$toggleFoldWidget(t,{children:(e=e.domEvent).shiftKey,all:e.ctrlKey||e.metaKey,siblings:e.altKey})){var i=e.target||e.srcElement;i&&/ace_fold-widget/.test(i.className)&&(i.className+=" ace_invalid")}},this.$toggleFoldWidget=function(t,e){if(this.getFoldWidget){var i=this.getFoldWidget(t),n=this.getLine(t),s="end"===i?-1:1,o=this.getFoldAt(t,-1===s?0:n.length,s);if(o)return e.children||e.all?this.removeFold(o):this.expandFold(o),o;var r=this.getFoldWidgetRange(t,!0);if(r&&!r.isMultiLine()&&(o=this.getFoldAt(r.start.row,r.start.column,1))&&r.isEqual(o.range))return this.removeFold(o),o;if(e.siblings){var a=this.getParentFoldRangeData(t);if(a.range)var l=a.range.start.row+1,c=a.range.end.row;this.foldAll(l,c,e.all?1e4:0)}else e.children?(c=r?r.end.row:this.getLength(),this.foldAll(t+1,c,e.all?1e4:0)):r&&(e.all&&(r.collapseChildren=1e4),this.addFold("...",r));return r}},this.toggleFoldWidget=function(){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var e=this.$toggleFoldWidget(t,{});if(!e){var i=this.getParentFoldRangeData(t,!0);if(e=i.range||i.firstRange){var n=this.getFoldAt(t=e.start.row,this.getLine(t).length,1);n?this.removeFold(n):this.addFold("...",e)}}},this.updateFoldWidgets=function(t){var e=t.start.row,i=t.end.row-e;if(0===i)this.foldWidgets[e]=null;else if("remove"==t.action)this.foldWidgets.splice(e,i+1,null);else{var n=Array(i+1);n.unshift(e,1),this.foldWidgets.splice.apply(this.foldWidgets,n)}},this.tokenizerUpdateFoldWidgets=function(t){var e=t.data;e.first!=e.last&&this.foldWidgets.length>e.first&&this.foldWidgets.splice(e.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],(function(t,e){var i=t("../token_iterator").TokenIterator,n=t("../range").Range;e.BracketMatch=function(){this.findMatchingBracket=function(t,e){if(0==t.column)return null;var i=e||this.getLine(t.row).charAt(t.column-1);if(""==i)return null;var n=i.match(/([\(\[\{])|([\)\]\}])/);return n?n[1]?this.$findClosingBracket(n[1],t):this.$findOpeningBracket(n[2],t):null},this.getBracketRange=function(t){var e,i=this.getLine(t.row),s=!0,o=i.charAt(t.column-1),r=o&&o.match(/([\(\[\{])|([\)\]\}])/);if(r||(o=i.charAt(t.column),t={row:t.row,column:t.column+1},r=o&&o.match(/([\(\[\{])|([\)\]\}])/),s=!1),!r)return null;if(r[1]){if(!(a=this.$findClosingBracket(r[1],t)))return null;e=n.fromPoints(t,a),s||(e.end.column++,e.start.column--),e.cursor=e.end}else{var a;if(!(a=this.$findOpeningBracket(r[2],t)))return null;e=n.fromPoints(a,t),s||(e.start.column++,e.end.column--),e.cursor=e.start}return e},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"},this.$findOpeningBracket=function(t,e,n){var s=this.$brackets[t],o=1,r=new i(this,e.row,e.column),a=r.getCurrentToken();if(a||(a=r.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var l=e.column-r.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var h=c.charAt(l);if(h==s){if(0==(o-=1))return{row:r.getCurrentTokenRow(),column:l+r.getCurrentTokenColumn()}}else h==t&&(o+=1);l-=1}do{a=r.stepBackward()}while(a&&!n.test(a.type));if(null==a)break;l=(c=a.value).length-1}return null}},this.$findClosingBracket=function(t,e,n){var s=this.$brackets[t],o=1,r=new i(this,e.row,e.column),a=r.getCurrentToken();if(a||(a=r.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var l=e.column-r.getCurrentTokenColumn();;){for(var c=a.value,h=c.length;l<h;){var d=c.charAt(l);if(d==s){if(0==(o-=1))return{row:r.getCurrentTokenRow(),column:l+r.getCurrentTokenColumn()}}else d==t&&(o+=1);l+=1}do{a=r.stepForward()}while(a&&!n.test(a.type));if(null==a)break;l=0}return null}}}})),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],(function(t,i){var n=t("./lib/oop"),s=t("./lib/lang"),o=t("./bidihandler").BidiHandler,r=t("./config"),a=t("./lib/event_emitter").EventEmitter,l=t("./selection").Selection,c=t("./mode/text").Mode,h=t("./range").Range,d=t("./document").Document,u=t("./background_tokenizer").BackgroundTokenizer,m=t("./search_highlight").SearchHighlight,p=function(t,e){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++p.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof t&&t.getLine||(t=new d(t)),this.$bidiHandler=new o(this),this.setDocument(t),this.selection=new l(this),r.resetOptions(this),this.setMode(e),r._signal("session",this)};p.$uid=0,function(){n.implement(this,a),this.setDocument=function(t){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=t,t.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(t){if(!t)return this.$docRowCache=[],void(this.$screenRowCache=[]);var e=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,t)+1;e>i&&(this.$docRowCache.splice(i,e),this.$screenRowCache.splice(i,e))},this.$getRowCacheIndex=function(t,e){for(var i=0,n=t.length-1;i<=n;){var s=i+n>>1,o=t[s];if(e>o)i=s+1;else{if(!(e<o))return s;n=s-1}}return i-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(t){this.$resetRowCache(t.data.start.row)},this.onChange=function(t){this.$modified=!0,this.$bidiHandler.onChange(t),this.$resetRowCache(t.start.row);var e=this.$updateInternalDataOnChange(t);this.$fromUndo||!this.$undoManager||t.ignore||(this.$deltasDoc.push(t),e&&0!=e.length&&this.$deltasFold.push({action:"removeFolds",folds:e}),this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(t),this._signal("change",t)},this.setValue=function(t){this.doc.setValue(t),this.selection.moveTo(0,0),this.$resetRowCache(0),this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(t){return this.bgTokenizer.getState(t)},this.getTokens=function(t){return this.bgTokenizer.getTokens(t)},this.getTokenAt=function(t,e){var i,n=this.bgTokenizer.getTokens(t),s=0;if(null==e){var o=n.length-1;s=this.getLine(t).length}else for(o=0;o<n.length&&!((s+=n[o].value.length)>=e);o++);return(i=n[o])?(i.index=o,i.start=s-i.value.length,i):null},this.setUndoManager=function(t){if(this.$undoManager=t,this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.$informUndoManager&&this.$informUndoManager.cancel(),t){var e=this;this.$syncInformUndoManager=function(){e.$informUndoManager.cancel(),e.$deltasFold.length&&(e.$deltas.push({group:"fold",deltas:e.$deltasFold}),e.$deltasFold=[]),e.$deltasDoc.length&&(e.$deltas.push({group:"doc",deltas:e.$deltasDoc}),e.$deltasDoc=[]),e.$deltas.length>0&&t.execute({action:"aceupdate",args:[e.$deltas,e],merge:e.mergeUndoDeltas}),e.mergeUndoDeltas=!1,e.$deltas=[]},this.$informUndoManager=s.delayedCall(this.$syncInformUndoManager)}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?s.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(t){this.setOption("useSoftTabs",t)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(t){this.setOption("tabSize",t)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(t){return this.$useSoftTabs&&t.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(t){this.setOption("navigateWithinSoftTabs",t)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(t){this.setOption("overwrite",t)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(t,e){this.$decorations[t]||(this.$decorations[t]=""),this.$decorations[t]+=" "+e,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(t,e){this.$decorations[t]=(this.$decorations[t]||"").replace(" "+e,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(t){this.$breakpoints=[];for(var e=0;e<t.length;e++)this.$breakpoints[t[e]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(t,e){void 0===e&&(e="ace_breakpoint"),e?this.$breakpoints[t]=e:delete this.$breakpoints[t],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(t){delete this.$breakpoints[t],this._signal("changeBreakpoint",{})},this.addMarker=function(t,e,i,n){var s=this.$markerId++,o={range:t,type:i||"line",renderer:"function"==typeof i?i:null,clazz:e,inFront:!!n,id:s};return n?(this.$frontMarkers[s]=o,this._signal("changeFrontMarker")):(this.$backMarkers[s]=o,this._signal("changeBackMarker")),s},this.addDynamicMarker=function(t,e){if(t.update){var i=this.$markerId++;return t.id=i,t.inFront=!!e,e?(this.$frontMarkers[i]=t,this._signal("changeFrontMarker")):(this.$backMarkers[i]=t,this._signal("changeBackMarker")),t}},this.removeMarker=function(t){var e=this.$frontMarkers[t]||this.$backMarkers[t];e&&e&&(delete(e.inFront?this.$frontMarkers:this.$backMarkers)[t],this._signal(e.inFront?"changeFrontMarker":"changeBackMarker"))},this.getMarkers=function(t){return t?this.$frontMarkers:this.$backMarkers},this.highlight=function(t){if(!this.$searchHighlight){var e=new m(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(e)}this.$searchHighlight.setRegexp(t)},this.highlightLines=function(t,e,i,n){"number"!=typeof e&&(i=e,e=t),i||(i="ace_step");var s=new h(t,0,e,1/0);return s.id=this.addMarker(s,i,"fullLine",n),s},this.setAnnotations=function(t){this.$annotations=t,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(t){var e=t.match(/^.*?(\r?\n)/m);this.$autoNewLine=e?e[1]:"\n"},this.getWordRange=function(t,e){var i=this.getLine(t),n=!1;if(e>0&&(n=!!i.charAt(e-1).match(this.tokenRe)),n||(n=!!i.charAt(e).match(this.tokenRe)),n)var s=this.tokenRe;else s=/^\s+$/.test(i.slice(e-1,e+1))?/\s/:this.nonTokenRe;var o=e;if(o>0){do{o--}while(o>=0&&i.charAt(o).match(s));o++}for(var r=e;r<i.length&&i.charAt(r).match(s);)r++;return new h(t,o,t,r)},this.getAWordRange=function(t,e){for(var i=this.getWordRange(t,e),n=this.getLine(i.end.row);n.charAt(i.end.column).match(/[ \t]/);)i.end.column+=1;return i},this.setNewLineMode=function(t){this.doc.setNewLineMode(t)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(t){this.setOption("useWorker",t)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(t){this.bgTokenizer.start(t.data.first),this._signal("tokenizerUpdate",t)},this.$modes={},this.$mode=null,this.$modeId=null,this.setMode=function(t,e){if(t&&"object"==typeof t){if(t.getTokenizer)return this.$onChangeMode(t);var i=t,n=t.path}else n=t||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new c),this.$modes[n]&&!i)return this.$onChangeMode(this.$modes[n]),void(e&&e());this.$modeId=n,r.loadModule(["mode",n],function(t){if(this.$modeId!==n)return e&&e();this.$modes[n]&&!i?this.$onChangeMode(this.$modes[n]):t&&t.Mode&&(t=new t.Mode(i),i||(this.$modes[n]=t,t.$id=n),this.$onChangeMode(t)),e&&e()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(t,e){if(e||(this.$modeId=t.$id),this.$mode!==t){this.$mode=t,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=t.getTokenizer();if(void 0!==i.addEventListener){var n=this.onReloadTokenizer.bind(this);i.addEventListener("update",n)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(i);else{this.bgTokenizer=new u(i);var s=this;this.bgTokenizer.addEventListener("update",(function(t){s._signal("tokenizerUpdate",t)}))}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=t.tokenRe,this.nonTokenRe=t.nonTokenRe,e||(t.attachToSession&&t.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(t.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){r.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(t){this.$scrollTop===t||isNaN(t)||(this.$scrollTop=t,this._signal("changeScrollTop",t))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(t){this.$scrollLeft===t||isNaN(t)||(this.$scrollLeft=t,this._signal("changeScrollLeft",t))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var t=0;return this.lineWidgets.forEach((function(e){e&&e.screenWidth>t&&(t=e.screenWidth)})),this.lineWidgetWidth=t},this.$computeWidth=function(t){if(this.$modified||t){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var e=this.doc.getAllLines(),i=this.$rowLengthCache,n=0,s=0,o=this.$foldData[s],r=o?o.start.row:1/0,a=e.length,l=0;l<a;l++){if(l>r){if((l=o.end.row+1)>=a)break;r=(o=this.$foldData[s++])?o.start.row:1/0}null==i[l]&&(i[l]=this.$getStringScreenWidth(e[l])[0]),i[l]>n&&(n=i[l])}this.screenWidth=n}},this.getLine=function(t){return this.doc.getLine(t)},this.getLines=function(t,e){return this.doc.getLines(t,e)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(t){return this.doc.getTextRange(t||this.selection.getRange())},this.insert=function(t,e){return this.doc.insert(t,e)},this.remove=function(t){return this.doc.remove(t)},this.removeFullLines=function(t,e){return this.doc.removeFullLines(t,e)},this.undoChanges=function(t,e){if(t.length){this.$fromUndo=!0;for(var i=null,n=t.length-1;-1!=n;n--){var s=t[n];"doc"==s.group?(this.doc.revertDeltas(s.deltas),i=this.$getUndoSelection(s.deltas,!0,i)):s.deltas.forEach((function(t){this.addFolds(t.folds)}),this)}return this.$fromUndo=!1,i&&this.$undoSelect&&!e&&this.selection.setSelectionRange(i),i}},this.redoChanges=function(t,e){if(t.length){this.$fromUndo=!0;for(var i=null,n=0;n<t.length;n++){var s=t[n];"doc"==s.group&&(this.doc.applyDeltas(s.deltas),i=this.$getUndoSelection(s.deltas,!1,i))}return this.$fromUndo=!1,i&&this.$undoSelect&&!e&&this.selection.setSelectionRange(i),i}},this.setUndoSelect=function(t){this.$undoSelect=t},this.$getUndoSelection=function(t,e,i){function n(t){return e?"insert"!==t.action:"insert"===t.action}var s,o,r=t[0];s=n(r)?h.fromPoints(r.start,r.end):h.fromPoints(r.start,r.start);for(var a=1;a<t.length;a++)n(r=t[a])?(-1==s.compare((o=r.start).row,o.column)&&s.setStart(o),1==s.compare((o=r.end).row,o.column)&&s.setEnd(o)):-1==s.compare((o=r.start).row,o.column)&&(s=h.fromPoints(r.start,r.start));if(null!=i){0===h.comparePoints(i.start,s.start)&&(i.start.column+=s.end.column-s.start.column,i.end.column+=s.end.column-s.start.column);var l=i.compareRange(s);1==l?s.setStart(i.start):-1==l&&s.setEnd(i.end)}return s},this.replace=function(t,e){return this.doc.replace(t,e)},this.moveText=function(t,e,i){var n=this.getTextRange(t),s=this.getFoldsInRange(t),o=h.fromPoints(e,e);if(i||(this.remove(t),(c=(l=t.start.row-t.end.row)?-t.end.column:t.start.column-t.end.column)&&(o.start.row==t.end.row&&o.start.column>t.end.column&&(o.start.column+=c),o.end.row==t.end.row&&o.end.column>t.end.column&&(o.end.column+=c)),l&&o.start.row>=t.end.row&&(o.start.row+=l,o.end.row+=l)),o.end=this.insert(o.start,n),s.length){var r=t.start,a=o.start,l=a.row-r.row,c=a.column-r.column;this.addFolds(s.map((function(t){return(t=t.clone()).start.row==r.row&&(t.start.column+=c),t.end.row==r.row&&(t.end.column+=c),t.start.row+=l,t.end.row+=l,t})))}return o},this.indentRows=function(t,e,i){i=i.replace(/\t/g,this.getTabString());for(var n=t;n<=e;n++)this.doc.insertInLine({row:n,column:0},i)},this.outdentRows=function(t){for(var e=t.collapseRows(),i=new h(0,0,0,0),n=this.getTabSize(),s=e.start.row;s<=e.end.row;++s){var o=this.getLine(s);i.start.row=s,i.end.row=s;for(var r=0;r<n&&" "==o.charAt(r);++r);r<n&&"\t"==o.charAt(r)?(i.start.column=r,i.end.column=r+1):(i.start.column=0,i.end.column=r),this.remove(i)}},this.$moveLines=function(t,e,i){if(t=this.getRowFoldStart(t),e=this.getRowFoldEnd(e),i<0){if((s=this.getRowFoldStart(t+i))<0)return 0;var n=s-t}else if(i>0){var s;if((s=this.getRowFoldEnd(e+i))>this.doc.getLength()-1)return 0;n=s-e}else t=this.$clipRowToDocument(t),n=(e=this.$clipRowToDocument(e))-t+1;var o=new h(t,0,e,Number.MAX_VALUE),r=this.getFoldsInRange(o).map((function(t){return(t=t.clone()).start.row+=n,t.end.row+=n,t})),a=0==i?this.doc.getLines(t,e):this.doc.removeFullLines(t,e);return this.doc.insertFullLines(t+n,a),r.length&&this.addFolds(r),n},this.moveLinesUp=function(t,e){return this.$moveLines(t,e,-1)},this.moveLinesDown=function(t,e){return this.$moveLines(t,e,1)},this.duplicateLines=function(t,e){return this.$moveLines(t,e,0)},this.$clipRowToDocument=function(t){return Math.max(0,Math.min(t,this.doc.getLength()-1))},this.$clipColumnToRow=function(t,e){return e<0?0:Math.min(this.doc.getLine(t).length,e)},this.$clipPositionToDocument=function(t,e){if(e=Math.max(0,e),t<0)t=0,e=0;else{var i=this.doc.getLength();t>=i?(t=i-1,e=this.doc.getLine(i-1).length):e=Math.min(this.doc.getLine(t).length,e)}return{row:t,column:e}},this.$clipRangeToDocument=function(t){t.start.row<0?(t.start.row=0,t.start.column=0):t.start.column=this.$clipColumnToRow(t.start.row,t.start.column);var e=this.doc.getLength()-1;return t.end.row>e?(t.end.row=e,t.end.column=this.doc.getLine(e).length):t.end.column=this.$clipColumnToRow(t.end.row,t.end.column),t},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(t){if(t!=this.$useWrapMode){if(this.$useWrapMode=t,this.$modified=!0,this.$resetRowCache(0),t){var e=this.getLength();this.$wrapData=Array(e),this.$updateWrapData(0,e-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(t,e){this.$wrapLimitRange.min===t&&this.$wrapLimitRange.max===e||(this.$wrapLimitRange={min:t,max:e},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(t,e){var i=this.$wrapLimitRange;i.max<0&&(i={min:e,max:e});var n=this.$constrainWrapLimit(t,i.min,i.max);return n!=this.$wrapLimit&&n>1&&(this.$wrapLimit=n,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(t,e,i){return e&&(t=Math.max(e,t)),i&&(t=Math.min(i,t)),t},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(t){this.setWrapLimitRange(t,t)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(t){var e=this.$useWrapMode,i=t.action,n=t.start,s=t.end,o=n.row,r=s.row,a=r-o,l=null;if(this.$updating=!0,0!=a)if("remove"===i){this[e?"$wrapData":"$rowLengthCache"].splice(o,a);var c=this.$foldData;l=this.getFoldsInRange(t),this.removeFolds(l);var h=0;if(b=this.getFoldLine(s.row)){b.addRemoveChars(s.row,s.column,n.column-s.column),b.shiftRow(-a);var d=this.getFoldLine(o);d&&d!==b&&(d.merge(b),b=d),h=c.indexOf(b)+1}for(;h<c.length;h++)(b=c[h]).start.row>=s.row&&b.shiftRow(-a);r=o}else{var u=Array(a);u.unshift(o,0);var m=e?this.$wrapData:this.$rowLengthCache;if(m.splice.apply(m,u),c=this.$foldData,h=0,b=this.getFoldLine(o)){var p=b.range.compareInside(n.row,n.column);0==p?(b=b.split(n.row,n.column))&&(b.shiftRow(a),b.addRemoveChars(r,0,s.column-n.column)):-1==p&&(b.addRemoveChars(o,0,s.column-n.column),b.shiftRow(a)),h=c.indexOf(b)+1}for(;h<c.length;h++){var b;(b=c[h]).start.row>=o&&b.shiftRow(a)}}else a=Math.abs(t.start.column-t.end.column),"remove"===i&&(l=this.getFoldsInRange(t),this.removeFolds(l),a=-a),(b=this.getFoldLine(o))&&b.addRemoveChars(o,n.column,a);return e&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,e?this.$updateWrapData(o,r):this.$updateRowLengthCache(o,r),l},this.$updateRowLengthCache=function(t,e){this.$rowLengthCache[t]=null,this.$rowLengthCache[e]=null},this.$updateWrapData=function(e,n){var s,o,r=this.doc.getAllLines(),a=this.getTabSize(),l=this.$wrapData,c=this.$wrapLimit,h=e;for(n=Math.min(n,r.length-1);h<=n;)(o=this.getFoldLine(h,o))?(s=[],o.walk(function(e,n,o,a){var l;if(null!=e){(l=this.$getDisplayTokens(e,s.length))[0]=t;for(var c=1;c<l.length;c++)l[c]=i}else l=this.$getDisplayTokens(r[n].substring(a,o),s.length);s=s.concat(l)}.bind(this),o.end.row,r[o.end.row].length+1),l[o.start.row]=this.$computeWrapSplits(s,c,a),h=o.end.row+1):(s=this.$getDisplayTokens(r[h]),l[h]=this.$computeWrapSplits(s,c,a),h++)};var t=3,i=4;function o(t){return!(t<4352)&&(t>=4352&&t<=4447||t>=4515&&t<=4519||t>=4602&&t<=4607||t>=9001&&t<=9002||t>=11904&&t<=11929||t>=11931&&t<=12019||t>=12032&&t<=12245||t>=12272&&t<=12283||t>=12288&&t<=12350||t>=12353&&t<=12438||t>=12441&&t<=12543||t>=12549&&t<=12589||t>=12593&&t<=12686||t>=12688&&t<=12730||t>=12736&&t<=12771||t>=12784&&t<=12830||t>=12832&&t<=12871||t>=12880&&t<=13054||t>=13056&&t<=19903||t>=19968&&t<=42124||t>=42128&&t<=42182||t>=43360&&t<=43388||t>=44032&&t<=55203||t>=55216&&t<=55238||t>=55243&&t<=55291||t>=63744&&t<=64255||t>=65040&&t<=65049||t>=65072&&t<=65106||t>=65108&&t<=65126||t>=65128&&t<=65131||t>=65281&&t<=65376||t>=65504&&t<=65510)}this.$computeWrapSplits=function(e,n,s){if(0==e.length)return[];var o=[],r=e.length,a=0,l=0,c=this.$wrapAsCode,h=this.$indentedSoftWrap,d=n<=Math.max(2*s,8)||!1===h?0:Math.floor(n/2);function u(t){var i=e.slice(a,t),n=i.length;i.join("").replace(/12/g,(function(){n-=1})).replace(/2/g,(function(){n-=1})),o.length||(m=function(){var t=0;if(0===d)return t;if(h)for(var i=0;i<e.length;i++){var n=e[i];if(10==n)t+=1;else{if(11!=n){if(12==n)continue;break}t+=s}}return c&&!1!==h&&(t+=s),Math.min(t,d)}(),o.indent=m),o.push(l+=n),a=t}for(var m=0;r-a>n-m;){var p=a+n-m;if(e[p-1]>=10&&e[p]>=10)u(p);else if(e[p]!=t&&e[p]!=i){for(var b=Math.max(p-(n-(n>>2)),a-1);p>b&&e[p]<t;)p--;if(c){for(;p>b&&e[p]<t;)p--;for(;p>b&&9==e[p];)p--}else for(;p>b&&e[p]<10;)p--;p>b?u(++p):(2==e[p=a+n]&&p--,u(p-m))}else{for(;p!=a-1&&e[p]!=t;p--);if(p>a){u(p);continue}for(p=a+n;p<e.length&&e[p]==i;p++);if(p==e.length)break;u(p)}}return o},this.$getDisplayTokens=function(t,e){var i,n=[];e=e||0;for(var s=0;s<t.length;s++){var r=t.charCodeAt(s);if(9==r){i=this.getScreenTabSize(n.length+e),n.push(11);for(var a=1;a<i;a++)n.push(12)}else 32==r?n.push(10):r>39&&r<48||r>57&&r<64?n.push(9):r>=4352&&o(r)?n.push(1,2):n.push(1)}return n},this.$getStringScreenWidth=function(t,e,i){if(0==e)return[0,0];var n,s;for(null==e&&(e=1/0),i=i||0,s=0;s<t.length&&(9==(n=t.charCodeAt(s))?i+=this.getScreenTabSize(i):n>=4352&&o(n)?i+=2:i+=1,!(i>e));s++);return[i,s]},this.lineWidgets=null,this.getRowLength=function(t){if(this.lineWidgets)var e=this.lineWidgets[t]&&this.lineWidgets[t].rowCount||0;else e=0;return this.$useWrapMode&&this.$wrapData[t]?this.$wrapData[t].length+1+e:1+e},this.getRowLineCount=function(t){return this.$useWrapMode&&this.$wrapData[t]?this.$wrapData[t].length+1:1},this.getRowWrapIndent=function(t){if(this.$useWrapMode){var e=this.screenToDocumentPosition(t,Number.MAX_VALUE),i=this.$wrapData[e.row];return i.length&&i[0]<e.column?i.indent:0}return 0},this.getScreenLastRowColumn=function(t){var e=this.screenToDocumentPosition(t,Number.MAX_VALUE);return this.documentToScreenColumn(e.row,e.column)},this.getDocumentLastRowColumn=function(t,e){var i=this.documentToScreenRow(t,e);return this.getScreenLastRowColumn(i)},this.getDocumentLastRowColumnPosition=function(t,e){var i=this.documentToScreenRow(t,e);return this.screenToDocumentPosition(i,Number.MAX_VALUE/10)},this.getRowSplitData=function(t){return this.$useWrapMode?this.$wrapData[t]:void 0},this.getScreenTabSize=function(t){return this.$tabSize-t%this.$tabSize},this.screenToDocumentRow=function(t,e){return this.screenToDocumentPosition(t,e).row},this.screenToDocumentColumn=function(t,e){return this.screenToDocumentPosition(t,e).column},this.screenToDocumentPosition=function(t,e,i){if(t<0)return{row:0,column:0};var n,s,o=0,r=0,a=0,l=0,c=this.$screenRowCache,h=this.$getRowCacheIndex(c,t),d=c.length;if(d&&h>=0){a=c[h],o=this.$docRowCache[h];var u=t>c[d-1]}else u=!d;for(var m=this.getLength()-1,p=this.getNextFoldLine(o),b=p?p.start.row:1/0;a<=t&&!(a+(l=this.getRowLength(o))>t||o>=m);)a+=l,++o>b&&(b=(p=this.getNextFoldLine(o=p.end.row+1,p))?p.start.row:1/0),u&&(this.$docRowCache.push(o),this.$screenRowCache.push(a));if(p&&p.start.row<=o)n=this.getFoldDisplayLine(p),o=p.start.row;else{if(a+l<=t||o>m)return{row:m,column:this.getLine(m).length};n=this.getLine(o),p=null}var f=0,g=Math.floor(t-a);if(this.$useWrapMode){var y=this.$wrapData[o];y&&(s=y[g],g>0&&y.length&&(f=y.indent,n=n.substring(r=y[g-1]||y[y.length-1])))}return void 0!==i&&this.$bidiHandler.isBidiRow(a+g,o,g)&&(e=this.$bidiHandler.offsetToCol(i)),r+=this.$getStringScreenWidth(n,e-f)[1],this.$useWrapMode&&r>=s&&(r=s-1),p?p.idxToPosition(r):{row:o,column:r}},this.documentToScreenPosition=function(t,e){if(void 0===e)var i=this.$clipPositionToDocument(t.row,t.column);else i=this.$clipPositionToDocument(t,e);var n,s=0,o=null;(n=this.getFoldAt(t=i.row,e=i.column,1))&&(t=n.start.row,e=n.start.column);var r,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,t),h=l.length;if(h&&c>=0){a=l[c],s=this.$screenRowCache[c];var d=t>l[h-1]}else d=!h;for(var u=this.getNextFoldLine(a),m=u?u.start.row:1/0;a<t;){if(a>=m){if((r=u.end.row+1)>t)break;m=(u=this.getNextFoldLine(r,u))?u.start.row:1/0}else r=a+1;s+=this.getRowLength(a),a=r,d&&(this.$docRowCache.push(a),this.$screenRowCache.push(s))}var p="";u&&a>=m?(p=this.getFoldDisplayLine(u,t,e),o=u.start.row):(p=this.getLine(t).substring(0,e),o=t);var b=0;if(this.$useWrapMode){var f=this.$wrapData[o];if(f){for(var g=0;p.length>=f[g];)s++,g++;p=p.substring(f[g-1]||0,p.length),b=g>0?f.indent:0}}return{row:s,column:b+this.$getStringScreenWidth(p)[0]}},this.documentToScreenColumn=function(t,e){return this.documentToScreenPosition(t,e).column},this.documentToScreenRow=function(t,e){return this.documentToScreenPosition(t,e).row},this.getScreenLength=function(){var t=0,e=null;if(this.$useWrapMode)for(var i=this.$wrapData.length,n=0,s=(a=0,(e=this.$foldData[a++])?e.start.row:1/0);n<i;){var o=this.$wrapData[n];t+=o?o.length+1:1,++n>s&&(n=e.end.row+1,s=(e=this.$foldData[a++])?e.start.row:1/0)}else{t=this.getLength();for(var r=this.$foldData,a=0;a<r.length;a++)t-=(e=r[a]).end.row-e.start.row}return this.lineWidgets&&(t+=this.$getWidgetScreenLength()),t},this.$setFontMetrics=function(t){this.$enableVarChar&&(this.$getStringScreenWidth=function(e,i,n){if(0===i)return[0,0];var s,o;for(i||(i=1/0),n=n||0,o=0;o<e.length&&!((n+="\t"===(s=e.charAt(o))?this.getScreenTabSize(n):t.getCharacterWidth(s))>i);o++);return[n,o]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()},this.isFullWidth=o}.call(p.prototype),t("./edit_session/folding").Folding.call(p.prototype),t("./edit_session/bracket_match").BracketMatch.call(p.prototype),r.defineOptions(p.prototype,"session",{wrap:{set:function(t){if(t&&"off"!=t?"free"==t?t=!0:"printMargin"==t?t=-1:"string"==typeof t&&(t=parseInt(t,10)||!1):t=!1,this.$wrap!=t)if(this.$wrap=t,t){var e="number"==typeof t?t:null;this.setWrapLimitRange(e,e),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(t){(t="auto"==t?"text"!=this.$mode.type:"text"!=t)!=this.$wrapAsCode&&(this.$wrapAsCode=t,this.$useWrapMode&&(this.$modified=!0,this.$resetRowCache(0),this.$updateWrapData(0,this.getLength()-1)))},initialValue:"auto"},indentedSoftWrap:{initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(t){this.$useWorker=t,this.$stopWorker(),t&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(t){isNaN(t)||this.$tabSize===t||(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=t,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},overwrite:{set:function(){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(t){this.doc.setNewLineMode(t)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(t){this.setMode(t)},get:function(){return this.$modeId}}}),i.EditSession=p})),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(t,i){var n=t("./lib/lang"),s=t("./lib/oop"),o=t("./range").Range,r=function(){this.$options={}};(function(){this.set=function(t){return s.mixin(this.$options,t),this},this.getOptions=function(){return n.copyObject(this.$options)},this.setOptions=function(t){this.$options=t},this.find=function(t){var e=this.$options,i=this.$matchIterator(t,e);if(!i)return!1;var n=null;return i.forEach((function(t,i,s,r){return n=new o(t,i,s,r),!(i==r&&e.start&&e.start.start&&0!=e.skipCurrent&&n.isEqual(e.start)&&(n=null,1))})),n},this.findAll=function(t){var e=this.$options;if(!e.needle)return[];this.$assembleRegExp(e);var i=e.range,s=i?t.getLines(i.start.row,i.end.row):t.doc.getAllLines(),r=[],a=e.re;if(e.$isMultiLine){var l,c=a.length,h=s.length-c;t:for(var d=a.offset||0;d<=h;d++){for(var u=0;u<c;u++)if(-1==s[d+u].search(a[u]))continue t;var m=s[d],p=s[d+c-1],b=m.length-m.match(a[0])[0].length,f=p.match(a[c-1])[0].length;l&&l.end.row===d&&l.end.column>b||(r.push(l=new o(d,b,d+c-1,f)),c>2&&(d=d+c-2))}}else for(var g=0;g<s.length;g++){var y=n.getMatchOffsets(s[g],a);for(u=0;u<y.length;u++){var v=y[u];r.push(new o(g,v.offset,g,v.offset+v.length))}}if(i){var Z=i.start.column,x=i.start.column;for(g=0,u=r.length-1;g<u&&r[g].start.column<Z&&r[g].start.row==i.start.row;)g++;for(;g<u&&r[u].end.column>x&&r[u].end.row==i.end.row;)u--;for(r=r.slice(g,u+1),g=0,u=r.length;g<u;g++)r[g].start.row+=i.start.row,r[g].end.row+=i.start.row}return r},this.replace=function(t,e){var i=this.$options,n=this.$assembleRegExp(i);if(i.$isMultiLine)return e;if(n){var s=n.exec(t);if(!s||s[0].length!=t.length)return null;if(e=t.replace(n,e),i.preserveCase){e=e.split("");for(var o=Math.min(t.length,t.length);o--;){var r=t[o];e[o]=r&&r.toLowerCase()!=r?e[o].toUpperCase():e[o].toLowerCase()}e=e.join("")}return e}},this.$assembleRegExp=function(t,i){if(t.needle instanceof RegExp)return t.re=t.needle;var s=t.needle;if(!t.needle)return t.re=!1;t.regExp||(s=n.escapeRegExp(s)),t.wholeWord&&(s=function(t,e){function i(t){return/\w/.test(t)||e.regExp?"\\b":""}return i(t[0])+t+i(t[t.length-1])}(s,t));var o=t.caseSensitive?"gm":"gmi";if(t.$isMultiLine=!i&&/[\n\r]/.test(s),t.$isMultiLine)return t.re=this.$assembleMultilineRegExp(s,o);try{var r=new RegExp(s,o)}catch(e){r=!1}return t.re=r},this.$assembleMultilineRegExp=function(t,i){for(var n=t.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),s=[],o=0;o<n.length;o++)try{s.push(new RegExp(n[o],i))}catch(e){return!1}return s},this.$matchIterator=function(t,e){var i=this.$assembleRegExp(e);if(!i)return!1;var n=1==e.backwards,s=0!=e.skipCurrent,o=e.range,r=e.start;r||(r=o?o[n?"end":"start"]:t.selection.getRange()),r.start&&(r=r[s!=n?"end":"start"]);var a=o?o.start.row:0,l=o?o.end.row:t.getLength()-1;if(n)var c=function(t){var i=r.row;if(!d(i,r.column,t)){for(i--;i>=a;i--)if(d(i,Number.MAX_VALUE,t))return;if(0!=e.wrap)for(i=l,a=r.row;i>=a;i--)if(d(i,Number.MAX_VALUE,t))return}};else c=function(t){var i=r.row;if(!d(i,r.column,t)){for(i+=1;i<=l;i++)if(d(i,0,t))return;if(0!=e.wrap)for(i=a,l=r.row;i<=l;i++)if(d(i,0,t))return}};if(e.$isMultiLine)var h=i.length,d=function(e,s,o){var r=n?e-h+1:e;if(!(r<0)){var a=t.getLine(r),l=a.search(i[0]);if(!(!n&&l<s||-1===l)){for(var c=1;c<h;c++)if(-1==(a=t.getLine(r+c)).search(i[c]))return;var d=a.match(i[h-1])[0].length;if(!(n&&d>s))return!!o(r,l,r+h-1,d)||void 0}}};else d=n?function(e,n,s){var o,r=t.getLine(e),a=[],l=0;for(i.lastIndex=0;o=i.exec(r);){if(l=o.index,!(h=o[0].length)){if(l>=r.length)break;i.lastIndex=l+=1}if(o.index+h>n)break;a.push(o.index,h)}for(var c=a.length-1;c>=0;c-=2){var h,d=a[c-1];if(s(e,d,e,d+(h=a[c])))return!0}}:function(e,n,s){var o,r=t.getLine(e),a=n;for(i.lastIndex=n;o=i.exec(r);){var l=o[0].length;if(s(e,a=o.index,e,a+l))return!0;if(!l&&(i.lastIndex=a+=1,a>=r.length))return!1}};return{forEach:c}}}).call(r.prototype),i.Search=r})),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(t,e){var i=t("../lib/keys"),n=t("../lib/useragent"),s=i.KEY_MODS;function o(t,e){this.platform=e||(n.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(t),this.$singleCommand=!0}function r(t,e){o.call(this,t,e),this.$singleCommand=!1}r.prototype=o.prototype,function(){function t(t){return"object"==typeof t&&t.bindKey&&t.bindKey.position||(t.isDefault?-100:0)}this.addCommand=function(t){this.commands[t.name]&&this.removeCommand(t),this.commands[t.name]=t,t.bindKey&&this._buildKeyHash(t)},this.removeCommand=function(t,e){var i=t&&("string"==typeof t?t:t.name);t=this.commands[i],e||delete this.commands[i];var n=this.commandKeyBinding;for(var s in n){var o=n[s];if(o==t)delete n[s];else if(Array.isArray(o)){var r=o.indexOf(t);-1!=r&&(o.splice(r,1),1==o.length&&(n[s]=o[0]))}}},this.bindKey=function(t,e,i){if("object"==typeof t&&t&&(null==i&&(i=t.position),t=t[this.platform]),t)return"function"==typeof e?this.addCommand({exec:e,bindKey:t,name:e.name||t}):void t.split("|").forEach((function(t){var n="";if(-1!=t.indexOf(" ")){var o=t.split(/\s+/);t=o.pop(),o.forEach((function(t){var e=this.parseKeys(t);this._addCommandToBinding(n+=(n?" ":"")+(s[e.hashId]+e.key),"chainKeys")}),this),n+=" "}var r=this.parseKeys(t);this._addCommandToBinding(n+(s[r.hashId]+r.key),e,i)}),this)},this._addCommandToBinding=function(e,i,n){var s,o=this.commandKeyBinding;if(i)if(!o[e]||this.$singleCommand)o[e]=i;else{Array.isArray(o[e])?-1!=(s=o[e].indexOf(i))&&o[e].splice(s,1):o[e]=[o[e]],"number"!=typeof n&&(n=t(i));var r=o[e];for(s=0;s<r.length&&!(t(r[s])>n);s++);r.splice(s,0,i)}else delete o[e]},this.addCommands=function(t){t&&Object.keys(t).forEach((function(e){var i=t[e];if(i){if("string"==typeof i)return this.bindKey(i,e);"function"==typeof i&&(i={exec:i}),"object"==typeof i&&(i.name||(i.name=e),this.addCommand(i))}}),this)},this.removeCommands=function(t){Object.keys(t).forEach((function(e){this.removeCommand(t[e])}),this)},this.bindKeys=function(t){Object.keys(t).forEach((function(e){this.bindKey(e,t[e])}),this)},this._buildKeyHash=function(t){this.bindKey(t.bindKey,t)},this.parseKeys=function(t){var e=t.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(t){return t})),n=e.pop(),s=i[n];if(i.FUNCTION_KEYS[s])n=i.FUNCTION_KEYS[s].toLowerCase();else{if(!e.length)return{key:n,hashId:-1};if(1==e.length&&"shift"==e[0])return{key:n.toUpperCase(),hashId:-1}}for(var o=0,r=e.length;r--;){var a=i.KEY_MODS[e[r]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+e[r]+" in "+t),!1;o|=a}return{key:n,hashId:o}},this.findKeyCommand=function(t,e){return this.commandKeyBinding[s[t]+e]},this.handleKeyboard=function(t,e,i,n){if(!(n<0)){var o=s[e]+i,r=this.commandKeyBinding[o];return t.$keyChain&&(t.$keyChain+=" "+o,r=this.commandKeyBinding[t.$keyChain]||r),!r||"chainKeys"!=r&&"chainKeys"!=r[r.length-1]?(t.$keyChain&&(e&&4!=e||1!=i.length?(-1==e||n>0)&&(t.$keyChain=""):t.$keyChain=t.$keyChain.slice(0,-o.length-1)),{command:r}):(t.$keyChain=t.$keyChain||o,{command:"null"})}},this.getStatusText=function(t,e){return e.$keyChain||""}}.call(o.prototype),e.HashHandler=o,e.MultiHashHandler=r})),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],(function(t,e){var i=t("../lib/oop"),n=t("../keyboard/hash_handler").MultiHashHandler,s=t("../lib/event_emitter").EventEmitter,o=function(t,e){n.call(this,e,t),this.byName=this.commands,this.setDefaultHandler("exec",(function(t){return t.command.exec(t.editor,t.args||{})}))};i.inherits(o,n),function(){i.implement(this,s),this.exec=function(t,e,i){if(Array.isArray(t)){for(var n=t.length;n--;)if(this.exec(t[n],e,i))return!0;return!1}if("string"==typeof t&&(t=this.commands[t]),!t)return!1;if(e&&e.$readOnly&&!t.readOnly)return!1;if(t.isAvailable&&!t.isAvailable(e))return!1;var s={editor:e,command:t,args:i};return s.returnValue=this._emit("exec",s),this._signal("afterExec",s),!1!==s.returnValue},this.toggleRecording=function(t){if(!this.$inReplay)return t&&t._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(t){this.macro.push([t.command,t.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(t){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(t);try{this.$inReplay=!0,this.macro.forEach((function(e){"string"==typeof e?this.exec(e,t):this.exec(e[0],t,e[1])}),this)}finally{this.$inReplay=!1}}},this.trimMacro=function(t){return t.map((function(t){return"string"!=typeof t[0]&&(t[0]=t[0].name),t[1]||(t=t[0]),t}))}}.call(o.prototype),e.CommandManager=o})),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],(function(t,e){var i=t("../lib/lang"),n=t("../config"),s=t("../range").Range;function o(t,e){return{win:t,mac:e}}e.commands=[{name:"showSettingsMenu",bindKey:o("Ctrl-,","Command-,"),exec:function(t){n.loadModule("ace/ext/settings_menu",(function(e){e.init(t),t.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",bindKey:o("Alt-E","F4"),exec:function(t){n.loadModule("ace/ext/error_marker",(function(e){e.showErrorMarker(t,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:o("Alt-Shift-E","Shift-F4"),exec:function(t){n.loadModule("ace/ext/error_marker",(function(e){e.showErrorMarker(t,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",bindKey:o("Ctrl-A","Command-A"),exec:function(t){t.selectAll()},readOnly:!0},{name:"centerselection",bindKey:o(null,"Ctrl-L"),exec:function(t){t.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:o("Ctrl-L","Command-L"),exec:function(t){var e=parseInt(prompt("Enter line number:"),10);isNaN(e)||t.gotoLine(e)},readOnly:!0},{name:"fold",bindKey:o("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(t){t.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:o("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(t){t.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:o("F2","F2"),exec:function(t){t.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:o("Alt-F2","Alt-F2"),exec:function(t){t.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:o(null,"Ctrl-Command-Option-0"),exec:function(t){t.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:o("Alt-0","Command-Option-0"),exec:function(t){t.session.foldAll(),t.session.unfold(t.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:o("Alt-Shift-0","Command-Option-Shift-0"),exec:function(t){t.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:o("Ctrl-K","Command-G"),exec:function(t){t.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",bindKey:o("Ctrl-Shift-K","Command-Shift-G"),exec:function(t){t.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",bindKey:o("Alt-K","Ctrl-G"),exec:function(t){t.selection.isEmpty()?t.selection.selectWord():t.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:o("Alt-Shift-K","Ctrl-Shift-G"),exec:function(t){t.selection.isEmpty()?t.selection.selectWord():t.findPrevious()},readOnly:!0},{name:"find",bindKey:o("Ctrl-F","Command-F"),exec:function(t){n.loadModule("ace/ext/searchbox",(function(e){e.Search(t)}))},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(t){t.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:o("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(t){t.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:o("Ctrl-Home","Command-Home|Command-Up"),exec:function(t){t.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:o("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(t){t.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",bindKey:o("Up","Up|Ctrl-P"),exec:function(t,e){t.navigateUp(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",bindKey:o("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(t){t.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:o("Ctrl-End","Command-End|Command-Down"),exec:function(t){t.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:o("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(t){t.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:o("Down","Down|Ctrl-N"),exec:function(t,e){t.navigateDown(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:o("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(t){t.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:o("Ctrl-Left","Option-Left"),exec:function(t){t.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:o("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(t){t.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:o("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(t){t.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:o("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(t){t.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:o("Left","Left|Ctrl-B"),exec:function(t,e){t.navigateLeft(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:o("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(t){t.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:o("Ctrl-Right","Option-Right"),exec:function(t){t.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:o("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(t){t.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:o("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(t){t.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:o("Shift-Right","Shift-Right"),exec:function(t){t.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:o("Right","Right|Ctrl-F"),exec:function(t,e){t.navigateRight(e.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(t){t.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:o(null,"Option-PageDown"),exec:function(t){t.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:o("PageDown","PageDown|Ctrl-V"),exec:function(t){t.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(t){t.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:o(null,"Option-PageUp"),exec:function(t){t.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(t){t.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:o("Ctrl-Up",null),exec:function(t){t.renderer.scrollBy(0,-2*t.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:o("Ctrl-Down",null),exec:function(t){t.renderer.scrollBy(0,2*t.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(t){t.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(t){t.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",bindKey:o("Ctrl-Alt-E","Command-Option-E"),exec:function(t){t.commands.toggleRecording(t)},readOnly:!0},{name:"replaymacro",bindKey:o("Ctrl-Shift-E","Command-Shift-E"),exec:function(t){t.commands.replay(t)},readOnly:!0},{name:"jumptomatching",bindKey:o("Ctrl-P","Ctrl-P"),exec:function(t){t.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",bindKey:o("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(t){t.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",bindKey:o("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(t){t.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",bindKey:o(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",exec:function(){},readOnly:!0},{name:"cut",exec:function(t){var e=t.getSelectionRange();t._emit("cut",e),t.selection.isEmpty()||(t.session.remove(e),t.clearSelection())},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",exec:function(t,e){t.$handlePaste(e)},scrollIntoView:"cursor"},{name:"removeline",bindKey:o("Ctrl-D","Command-D"),exec:function(t){t.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:o("Ctrl-Shift-D","Command-Shift-D"),exec:function(t){t.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:o("Ctrl-Alt-S","Command-Alt-S"),exec:function(t){t.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:o("Ctrl-/","Command-/"),exec:function(t){t.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:o("Ctrl-Shift-/","Command-Shift-/"),exec:function(t){t.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:o("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(t){t.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:o("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(t){t.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",bindKey:o("Ctrl-H","Command-Option-F"),exec:function(t){n.loadModule("ace/ext/searchbox",(function(e){e.Search(t,!0)}))}},{name:"undo",bindKey:o("Ctrl-Z","Command-Z"),exec:function(t){t.undo()}},{name:"redo",bindKey:o("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(t){t.redo()}},{name:"copylinesup",bindKey:o("Alt-Shift-Up","Command-Option-Up"),exec:function(t){t.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:o("Alt-Up","Option-Up"),exec:function(t){t.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:o("Alt-Shift-Down","Command-Option-Down"),exec:function(t){t.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:o("Alt-Down","Option-Down"),exec:function(t){t.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",bindKey:o("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(t){t.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:o("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(t){t.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:o("Shift-Delete",null),exec:function(t){if(!t.selection.isEmpty())return!1;t.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:o("Alt-Backspace","Command-Backspace"),exec:function(t){t.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:o("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(t){t.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",bindKey:o("Ctrl-Shift-Backspace",null),exec:function(t){var e=t.selection.getRange();e.start.column=0,t.session.remove(e)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",bindKey:o("Ctrl-Shift-Delete",null),exec:function(t){var e=t.selection.getRange();e.end.column=Number.MAX_VALUE,t.session.remove(e)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:o("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(t){t.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:o("Ctrl-Delete","Alt-Delete"),exec:function(t){t.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:o("Shift-Tab","Shift-Tab"),exec:function(t){t.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:o("Tab","Tab"),exec:function(t){t.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:o("Ctrl-[","Ctrl-["),exec:function(t){t.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:o("Ctrl-]","Ctrl-]"),exec:function(t){t.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(t,e){t.insert(e)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(t,e){t.insert(i.stringRepeat(e.text||"",e.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:o(null,"Ctrl-O"),exec:function(t){t.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:o("Alt-Shift-X","Ctrl-T"),exec:function(t){t.transposeLetters()},multiSelectAction:function(t){t.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",bindKey:o("Ctrl-U","Ctrl-U"),exec:function(t){t.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:o("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(t){t.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:o("Ctrl-Shift-L","Command-Shift-L"),exec:function(t){var e=t.selection.getRange();e.start.column=e.end.column=0,e.end.row++,t.selection.setRange(e,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",bindKey:o(null,null),exec:function(t){for(var e=t.selection.isBackwards(),n=e?t.selection.getSelectionLead():t.selection.getSelectionAnchor(),o=e?t.selection.getSelectionAnchor():t.selection.getSelectionLead(),r=t.session.doc.getLine(n.row).length,a=t.session.doc.getTextRange(t.selection.getRange()).replace(/\n\s*/," ").length,l=t.session.doc.getLine(n.row),c=n.row+1;c<=o.row+1;c++){var h=i.stringTrimLeft(i.stringTrimRight(t.session.doc.getLine(c)));0!==h.length&&(h=" "+h),l+=h}o.row+1<t.session.doc.getLength()-1&&(l+=t.session.doc.getNewLineCharacter()),t.clearSelection(),t.session.doc.replace(new s(n.row,0,o.row+2,0),l),a>0?(t.selection.moveCursorTo(n.row,n.column),t.selection.selectTo(n.row,n.column+a)):(r=t.session.doc.getLine(n.row).length>r?r+1:r,t.selection.moveCursorTo(n.row,r))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",bindKey:o(null,null),exec:function(t){var e=t.session.doc.getLength()-1,i=t.session.doc.getLine(e).length,n=t.selection.rangeList.ranges,o=[];n.length<1&&(n=[t.selection.getRange()]);for(var r=0;r<n.length;r++)r==n.length-1&&(n[r].end.row===e&&n[r].end.column===i||o.push(new s(n[r].end.row,n[r].end.column,e,i))),0===r?0===n[r].start.row&&0===n[r].start.column||o.push(new s(0,0,n[r].start.row,n[r].start.column)):o.push(new s(n[r-1].end.row,n[r-1].end.column,n[r].start.row,n[r].start.column));for(t.exitMultiSelectMode(),t.clearSelection(),r=0;r<o.length;r++)t.selection.addRange(o[r],!1)},readOnly:!0,scrollIntoView:"none"}]})),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator"],(function(t,e){t("./lib/fixoldbrowsers");var i=t("./lib/oop"),n=t("./lib/dom"),s=t("./lib/lang"),o=t("./lib/useragent"),r=t("./keyboard/textinput").TextInput,a=t("./mouse/mouse_handler").MouseHandler,l=t("./mouse/fold_handler").FoldHandler,c=t("./keyboard/keybinding").KeyBinding,h=t("./edit_session").EditSession,d=t("./search").Search,u=t("./range").Range,m=t("./lib/event_emitter").EventEmitter,p=t("./commands/command_manager").CommandManager,b=t("./commands/default_commands").commands,f=t("./config"),g=t("./token_iterator").TokenIterator,y=function(t,e){var i=t.getContainerElement();this.container=i,this.renderer=t,this.id="editor"+ ++y.$uid,this.commands=new p(o.isMac?"mac":"win",b),"object"==typeof document&&(this.textInput=new r(t.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new a(this),new l(this)),this.keyBinding=new c(this),this.$blockScrolling=0,this.$search=(new d).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=s.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(t,e){e._$emitInputEvent.schedule(31)})),this.setSession(e||new h("")),f.resetOptions(this),f._signal("editor",this)};y.$uid=0,function(){i.implement(this,m),this.$initOperationListeners=function(){this.selections=[],this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=s.delayedCall(this.endOperation.bind(this)),this.on("change",function(){this.curOp||this.startOperation(),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||this.startOperation(),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(t){if(this.curOp){if(!t||this.curOp.command)return;this.prevOp=this.curOp}t||(this.previousCommand=null,t={}),this.$opResetTimer.schedule(),this.curOp={command:t.command||{},args:t.args,scrollTop:this.renderer.scrollTop},this.curOp.command.name&&void 0!==this.curOp.command.scrollIntoView&&this.$blockScrolling++},this.endOperation=function(t){if(this.curOp){if(t&&!1===t.returnValue)return this.curOp=null;this._signal("beforeEndOperation");var e=this.curOp.command;e.name&&this.$blockScrolling>0&&this.$blockScrolling--;var i=e&&e.scrollIntoView;if(i){switch(i){case"center-animate":i="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var n=this.selection.getRange(),s=this.renderer.layerConfig;(n.start.row>=s.lastRow||n.end.row<=s.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==i&&this.renderer.animateScrolling(this.curOp.scrollTop)}this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(t){if(this.$mergeUndoDeltas){var e=this.prevOp,i=this.$mergeableCommands,n=e.command&&t.command.name==e.command.name;if("insertstring"==t.command.name){var s=t.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),n=n&&this.mergeNextCommand&&(!/\s/.test(s)||/\s/.test(e.args)),this.mergeNextCommand=!0}else n=n&&-1!==i.indexOf(t.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(n=!1),n?this.session.mergeUndoDeltas=!0:-1!==i.indexOf(t.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(t,e){if(t&&"string"==typeof t){this.$keybindingId=t;var i=this;f.loadModule(["keybinding",t],(function(n){i.$keybindingId==t&&i.keyBinding.setKeyboardHandler(n&&n.handler),e&&e()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(t),e&&e()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(t){if(this.session!=t){this.curOp&&this.endOperation(),this.curOp={};var e=this.session;if(e){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var i=this.session.getSelection();i.off("changeCursor",this.$onCursorChange),i.off("changeSelection",this.$onSelectionChange)}this.session=t,t?(this.$onDocumentChange=this.onDocumentChange.bind(this),t.on("change",this.$onDocumentChange),this.renderer.setSession(t),this.$onChangeMode=this.onChangeMode.bind(this),t.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),t.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),t.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),t.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),t.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),t.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=t.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.$blockScrolling+=1,this.onCursorChange(),this.$blockScrolling-=1,this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(t)),this._signal("changeSession",{session:t,oldSession:e}),this.curOp=null,e&&e._signal("changeEditor",{oldEditor:this}),t&&t._signal("changeEditor",{editor:this}),t&&t.bgTokenizer&&t.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(t,e){return this.session.doc.setValue(t),e?1==e?this.navigateFileEnd():-1==e&&this.navigateFileStart():this.selectAll(),t},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(t){this.renderer.onResize(t)},this.setTheme=function(t,e){this.renderer.setTheme(t,e)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(t){this.renderer.setStyle(t)},this.unsetStyle=function(t){this.renderer.unsetStyle(t)},this.getFontSize=function(){return this.getOption("fontSize")||n.computedStyle(this.container,"fontSize")},this.setFontSize=function(t){this.setOption("fontSize",t)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var t=this;this.$highlightPending=!0,setTimeout((function(){t.$highlightPending=!1;var e=t.session;if(e&&e.bgTokenizer){var i=e.findMatchingBracket(t.getCursorPosition());if(i)var n=new u(i.row,i.column,i.row,i.column+1);else e.$mode.getMatching&&(n=e.$mode.getMatching(t.session));n&&(e.$bracketHighlight=e.addMarker(n,"ace_bracket","text"))}}),50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var t=this;this.$highlightTagPending=!0,setTimeout((function(){t.$highlightTagPending=!1;var e=t.session;if(e&&e.bgTokenizer){var i=t.getCursorPosition(),n=new g(t.session,i.row,i.column),s=n.getCurrentToken();if(!s||!/\b(?:tag-open|tag-name)/.test(s.type))return e.removeMarker(e.$tagHighlight),void(e.$tagHighlight=null);if(-1==s.type.indexOf("tag-open")||(s=n.stepForward())){var o=s.value,r=0,a=n.stepBackward();if("<"==a.value)do{a=s,(s=n.stepForward())&&s.value===o&&-1!==s.type.indexOf("tag-name")&&("<"===a.value?r++:"</"===a.value&&r--)}while(s&&r>=0);else{do{s=a,a=n.stepBackward(),s&&s.value===o&&-1!==s.type.indexOf("tag-name")&&("<"===a.value?r++:"</"===a.value&&r--)}while(a&&r<=0);n.stepForward()}if(!s)return e.removeMarker(e.$tagHighlight),void(e.$tagHighlight=null);var l=n.getCurrentTokenRow(),c=n.getCurrentTokenColumn(),h=new u(l,c,l,c+s.value.length),d=e.$backMarkers[e.$tagHighlight];e.$tagHighlight&&null!=d&&0!==h.compareRange(d.range)&&(e.removeMarker(e.$tagHighlight),e.$tagHighlight=null),h&&!e.$tagHighlight&&(e.$tagHighlight=e.addMarker(h,"ace_bracket","text"))}}}),50)}},this.focus=function(){var t=this;setTimeout((function(){t.textInput.focus()})),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(t){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",t))},this.onBlur=function(t){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",t))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(t){this.renderer.updateLines(t.start.row,t.start.row==t.end.row?t.end.row:1/0,this.session.$useWrapMode),this._signal("change",t),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(t){var e=t.data;this.renderer.updateLines(e.first,e.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$blockScrolling||(f.warn("Automatically scrolling cursor into view after selection change","this will be disabled in the next version","set editor.$blockScrolling = Infinity to disable this message"),this.renderer.scrollCursorIntoView()),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var t,e=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(t=this.getCursorPosition()),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(t=!1)),e.$highlightLineMarker&&!t)e.removeMarker(e.$highlightLineMarker.id),e.$highlightLineMarker=null;else if(!e.$highlightLineMarker&&t){var i=new u(t.row,t.column,t.row,1/0);i.id=e.addMarker(i,"ace_active-line","screenLine"),e.$highlightLineMarker=i}else t&&(e.$highlightLineMarker.start.row=t.row,e.$highlightLineMarker.end.row=t.row,e.$highlightLineMarker.start.column=t.column,e._signal("changeBackMarker"))},this.onSelectionChange=function(){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var e=this.selection.getRange(),i=this.getSelectionStyle();t.$selectionMarker=t.addMarker(e,"ace_selection",i)}var n=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(n),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var t=this.session,e=this.getSelectionRange();if(!e.isEmpty()&&!e.isMultiLine()){var i=e.start.column-1,n=e.end.column+1,s=t.getLine(e.start.row),o=s.length,r=s.substring(Math.max(i,0),Math.min(n,o));if(!(i>=0&&/^[\w\d]/.test(r)||n<=o&&/[\w\d]$/.test(r))&&(r=s.substring(e.start.column,e.end.column),/^[\w\d]+$/.test(r)))return this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:r})}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(t){this.renderer.updateText(),this._emit("changeMode",t)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var t=this.getSelectedText();return this._signal("copy",t),t},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(t,e){this.commands.exec("paste",this,{text:t,event:e})},this.$handlePaste=function(t){"string"==typeof t&&(t={text:t}),this._signal("paste",t);var e=t.text;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)this.insert(e);else{var i=e.split(/\r\n|\r|\n/),n=this.selection.rangeList.ranges;if(i.length>n.length||i.length<2||!i[1])return this.commands.exec("insertstring",this,e);for(var s=n.length;s--;){var o=n[s];o.isEmpty()||this.session.remove(o),this.session.insert(o.start,i[s])}}},this.execCommand=function(t,e){return this.commands.exec(t,this,e)},this.insert=function(t,e){var i=this.session,n=i.getMode(),s=this.getCursorPosition();if(this.getBehavioursEnabled()&&!e){var o=n.transformAction(i.getState(s.row),"insertion",this,i,t);o&&(t!==o.text&&(this.session.mergeUndoDeltas=!1,this.$mergeNextCommand=!1),t=o.text)}if("\t"==t&&(t=this.session.getTabString()),this.selection.isEmpty())this.session.getOverwrite()&&-1==t.indexOf("\n")&&((r=new u.fromPoints(s,s)).end.column+=t.length,this.session.remove(r));else{var r=this.getSelectionRange();s=this.session.remove(r),this.clearSelection()}if("\n"==t||"\r\n"==t){var a=i.getLine(s.row);if(s.column>a.search(/\S|$/)){var l=a.substr(s.column).search(/\S|$/);i.doc.removeInLine(s.row,s.column,s.column+l)}}this.clearSelection();var c=s.column,h=i.getState(s.row),d=(a=i.getLine(s.row),n.checkOutdent(h,a,t));if(i.insert(s,t),o&&o.selection&&this.selection.setSelectionRange(2==o.selection.length?new u(s.row,c+o.selection[0],s.row,c+o.selection[1]):new u(s.row+o.selection[0],o.selection[1],s.row+o.selection[2],o.selection[3])),i.getDocument().isNewLine(t)){var m=n.getNextLineIndent(h,a.slice(0,s.column),i.getTabString());i.insert({row:s.row+1,column:0},m)}d&&n.autoOutdent(h,i,s.row)},this.onTextInput=function(t){this.keyBinding.onTextInput(t)},this.onCommandKey=function(t,e,i){this.keyBinding.onCommandKey(t,e,i)},this.setOverwrite=function(t){this.session.setOverwrite(t)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(t){this.setOption("scrollSpeed",t)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(t){this.setOption("dragDelay",t)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(t){this.setOption("selectionStyle",t)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(t){this.setOption("highlightActiveLine",t)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(t){this.setOption("highlightGutterLine",t)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(t){this.setOption("highlightSelectedWord",t)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(t){this.renderer.setAnimatedScroll(t)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(t){this.renderer.setShowInvisibles(t)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(t){this.renderer.setDisplayIndentGuides(t)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(t){this.renderer.setShowPrintMargin(t)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(t){this.renderer.setPrintMarginColumn(t)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(t){this.setOption("readOnly",t)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(t){this.setOption("behavioursEnabled",t)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(t){this.setOption("wrapBehavioursEnabled",t)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(t){this.setOption("showFoldWidgets",t)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(t){this.setOption("fadeFoldWidgets",t)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(t){this.selection.isEmpty()&&("left"==t?this.selection.selectLeft():this.selection.selectRight());var e=this.getSelectionRange();if(this.getBehavioursEnabled()){var i=this.session,n=i.getState(e.start.row),s=i.getMode().transformAction(n,"deletion",this,i,e);if(0===e.end.column){var o=i.getTextRange(e);if("\n"==o[o.length-1]){var r=i.getLine(e.end.row);/^\s+$/.test(r)&&(e.end.column=r.length)}}s&&(e=s)}this.session.remove(e),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var t=this.getSelectionRange();t.start.column==t.end.column&&t.start.row==t.end.row&&(t.end.column=0,t.end.row++),this.session.remove(t),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var t=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(t)},this.transposeLetters=function(){if(this.selection.isEmpty()){var t=this.getCursorPosition(),e=t.column;if(0!==e){var i,n,s=this.session.getLine(t.row);e<s.length?(i=s.charAt(e)+s.charAt(e-1),n=new u(t.row,e-1,t.row,e+1)):(i=s.charAt(e-1)+s.charAt(e-2),n=new u(t.row,e-2,t.row,e)),this.session.replace(n,i),this.session.selection.moveToPosition(n.end)}}},this.toLowerCase=function(){var t=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var e=this.getSelectionRange(),i=this.session.getTextRange(e);this.session.replace(e,i.toLowerCase()),this.selection.setSelectionRange(t)},this.toUpperCase=function(){var t=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var e=this.getSelectionRange(),i=this.session.getTextRange(e);this.session.replace(e,i.toUpperCase()),this.selection.setSelectionRange(t)},this.indent=function(){var t=this.session,e=this.getSelectionRange();if(!(e.start.row<e.end.row)){if(e.start.column<e.end.column){var i=t.getTextRange(e);if(!/^\s+$/.test(i))return h=this.$getSelectedRows(),void t.indentRows(h.first,h.last,"\t")}var n=t.getLine(e.start.row),o=e.start,r=t.getTabSize(),a=t.documentToScreenColumn(o.row,o.column);if(this.session.getUseSoftTabs())var l=s.stringRepeat(" ",c=r-a%r);else{for(var c=a%r;" "==n[e.start.column-1]&&c;)e.start.column--,c--;this.selection.setSelectionRange(e),l="\t"}return this.insert(l)}var h=this.$getSelectedRows();t.indentRows(h.first,h.last,"\t")},this.blockIndent=function(){var t=this.$getSelectedRows();this.session.indentRows(t.first,t.last,"\t")},this.blockOutdent=function(){var t=this.session.getSelection();this.session.outdentRows(t.getRange())},this.sortLines=function(){for(var t=this.$getSelectedRows(),e=this.session,i=[],n=t.first;n<=t.last;n++)i.push(e.getLine(n));i.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}));var s=new u(0,0,0,0);for(n=t.first;n<=t.last;n++){var o=e.getLine(n);s.start.row=n,s.end.row=n,s.end.column=o.length,e.replace(s,i[n-t.first])}},this.toggleCommentLines=function(){var t=this.session.getState(this.getCursorPosition().row),e=this.$getSelectedRows();this.session.getMode().toggleCommentLines(t,this.session,e.first,e.last)},this.toggleBlockComment=function(){var t=this.getCursorPosition(),e=this.session.getState(t.row),i=this.getSelectionRange();this.session.getMode().toggleBlockComment(e,this.session,i,t)},this.getNumberAt=function(t,e){var i=/[\-]?[0-9]+(?:\.[0-9]+)?/g;i.lastIndex=0;for(var n=this.session.getLine(t);i.lastIndex<e;){var s=i.exec(n);if(s.index<=e&&s.index+s[0].length>=e)return{value:s[0],start:s.index,end:s.index+s[0].length}}return null},this.modifyNumber=function(t){var e=this.selection.getCursor().row,i=this.selection.getCursor().column,n=new u(e,i-1,e,i),s=this.session.getTextRange(n);if(!isNaN(parseFloat(s))&&isFinite(s)){var o=this.getNumberAt(e,i);if(o){var r=o.value.indexOf(".")>=0?o.start+o.value.indexOf(".")+1:o.end,a=o.start+o.value.length-r,l=parseFloat(o.value);l*=Math.pow(10,a),l+=t*=r!==o.end&&i<r?Math.pow(10,o.end-i-1):Math.pow(10,o.end-i);var c=(l/=Math.pow(10,a)).toFixed(a),h=new u(e,o.start,e,o.end);this.session.replace(h,c),this.moveCursorTo(e,Math.max(o.start+1,i+c.length-o.value.length))}}},this.removeLines=function(){var t=this.$getSelectedRows();this.session.removeFullLines(t.first,t.last),this.clearSelection()},this.duplicateSelection=function(){var t=this.selection,e=this.session,i=t.getRange(),n=t.isBackwards();if(i.isEmpty()){var s=i.start.row;e.duplicateLines(s,s)}else{var o=n?i.start:i.end,r=e.insert(o,e.getTextRange(i),!1);i.start=o,i.end=r,t.setSelectionRange(i,n)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(t,e,i){return this.session.moveText(t,e,i)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(t,e){var i,n,s=this.selection;if(!s.inMultiSelectMode||this.inVirtualSelectionMode){var o=s.toOrientedRange();i=this.$getSelectedRows(o),n=this.session.$moveLines(i.first,i.last,e?0:t),e&&-1==t&&(n=0),o.moveBy(n,0),s.fromOrientedRange(o)}else{var r=s.rangeList.ranges;s.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var a=0,l=0,c=r.length,h=0;h<c;h++){var d=h;r[h].moveBy(a,0);for(var u=(i=this.$getSelectedRows(r[h])).first,m=i.last;++h<c;){l&&r[h].moveBy(l,0);var p=this.$getSelectedRows(r[h]);if(e&&p.first!=m)break;if(!e&&p.first>m+1)break;m=p.last}for(h--,a=this.session.$moveLines(u,m,e?0:t),e&&-1==t&&(d=h+1);d<=h;)r[d].moveBy(a,0),d++;e||(a=0),l+=a}s.fromOrientedRange(s.ranges[0]),s.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(t){return t=(t||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(t.start.row),last:this.session.getRowFoldEnd(t.end.row)}},this.onCompositionStart=function(){this.renderer.showComposition(this.getCursorPosition())},this.onCompositionUpdate=function(t){this.renderer.setCompositionText(t)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(t){return t>=this.getFirstVisibleRow()&&t<=this.getLastVisibleRow()},this.isRowFullyVisible=function(t){return t>=this.renderer.getFirstFullyVisibleRow()&&t<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(t,e){var i=this.renderer,n=this.renderer.layerConfig,s=t*Math.floor(n.height/n.lineHeight);this.$blockScrolling++,!0===e?this.selection.$moveSelection((function(){this.moveCursorBy(s,0)})):!1===e&&(this.selection.moveCursorBy(s,0),this.selection.clearSelection()),this.$blockScrolling--;var o=i.scrollTop;i.scrollBy(0,s*n.lineHeight),null!=e&&i.scrollCursorIntoView(null,.5),i.animateScrolling(o)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(t){this.renderer.scrollToRow(t)},this.scrollToLine=function(t,e,i,n){this.renderer.scrollToLine(t,e,i,n)},this.centerSelection=function(){var t=this.getSelectionRange(),e={row:Math.floor(t.start.row+(t.end.row-t.start.row)/2),column:Math.floor(t.start.column+(t.end.column-t.start.column)/2)};this.renderer.alignCursor(e,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.$blockScrolling+=1,this.selection.selectAll(),this.$blockScrolling-=1},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(t,e){this.selection.moveCursorTo(t,e)},this.moveCursorToPosition=function(t){this.selection.moveCursorToPosition(t)},this.jumpToMatching=function(t,e){var i=this.getCursorPosition(),n=new g(this.session,i.row,i.column),s=n.getCurrentToken(),o=s||n.stepForward();if(o){var r,a,l=!1,c={},h=i.column-o.start,d={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(o.value.match(/[{}()\[\]]/g)){for(;h<o.value.length&&!l;h++)if(d[o.value[h]])switch(a=d[o.value[h]]+"."+o.type.replace("rparen","lparen"),isNaN(c[a])&&(c[a]=0),o.value[h]){case"(":case"[":case"{":c[a]++;break;case")":case"]":case"}":c[a]--,-1===c[a]&&(r="bracket",l=!0)}}else o&&-1!==o.type.indexOf("tag-name")&&(isNaN(c[o.value])&&(c[o.value]=0),"<"===s.value?c[o.value]++:"</"===s.value&&c[o.value]--,-1===c[o.value]&&(r="tag",l=!0));l||(s=o,o=n.stepForward(),h=0)}while(o&&!l);if(r){var m,p;if("bracket"===r)(m=this.session.getBracketRange(i))||(p=(m=new u(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+h-1,n.getCurrentTokenRow(),n.getCurrentTokenColumn()+h-1)).start,(e||p.row===i.row&&Math.abs(p.column-i.column)<2)&&(m=this.session.getBracketRange(p)));else if("tag"===r){if(!o||-1===o.type.indexOf("tag-name"))return;var b=o.value;if(0===(m=new u(n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2,n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2)).compare(i.row,i.column)){l=!1;do{o=s,(s=n.stepBackward())&&(-1!==s.type.indexOf("tag-close")&&m.setEnd(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+1),o.value===b&&-1!==o.type.indexOf("tag-name")&&("<"===s.value?c[b]++:"</"===s.value&&c[b]--,0===c[b]&&(l=!0)))}while(s&&!l)}o&&o.type.indexOf("tag-name")&&(p=m.start).row==i.row&&Math.abs(p.column-i.column)<2&&(p=m.end)}(p=m&&m.cursor||p)&&(t?m&&e?this.selection.setRange(m):m&&m.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(p.row,p.column):this.selection.moveTo(p.row,p.column))}}},this.gotoLine=function(t,e,i){this.selection.clearSelection(),this.session.unfold({row:t-1,column:e||0}),this.$blockScrolling+=1,this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(t-1,e||0),this.$blockScrolling-=1,this.isRowFullyVisible(t-1)||this.scrollToLine(t-1,!0,i)},this.navigateTo=function(t,e){this.selection.moveTo(t,e)},this.navigateUp=function(t){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var e=this.selection.anchor.getPosition();return this.moveCursorToPosition(e)}this.selection.clearSelection(),this.selection.moveCursorBy(-t||-1,0)},this.navigateDown=function(t){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var e=this.selection.anchor.getPosition();return this.moveCursorToPosition(e)}this.selection.clearSelection(),this.selection.moveCursorBy(t||1,0)},this.navigateLeft=function(t){if(this.selection.isEmpty())for(t=t||1;t--;)this.selection.moveCursorLeft();else{var e=this.getSelectionRange().start;this.moveCursorToPosition(e)}this.clearSelection()},this.navigateRight=function(t){if(this.selection.isEmpty())for(t=t||1;t--;)this.selection.moveCursorRight();else{var e=this.getSelectionRange().end;this.moveCursorToPosition(e)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(t,e){e&&this.$search.set(e);var i=this.$search.find(this.session),n=0;return i?(this.$tryReplace(i,t)&&(n=1),null!==i&&(this.selection.setSelectionRange(i),this.renderer.scrollSelectionIntoView(i.start,i.end)),n):n},this.replaceAll=function(t,e){e&&this.$search.set(e);var i=this.$search.findAll(this.session),n=0;if(!i.length)return n;this.$blockScrolling+=1;var s=this.getSelectionRange();this.selection.moveTo(0,0);for(var o=i.length-1;o>=0;--o)this.$tryReplace(i[o],t)&&n++;return this.selection.setSelectionRange(s),this.$blockScrolling-=1,n},this.$tryReplace=function(t,e){var i=this.session.getTextRange(t);return null!==(e=this.$search.replace(i,e))?(t.end=this.session.replace(t,e),t):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(t,e,n){e||(e={}),"string"==typeof t||t instanceof RegExp?e.needle=t:"object"==typeof t&&i.mixin(e,t);var s=this.selection.getRange();null==e.needle&&((t=this.session.getTextRange(s)||this.$search.$options.needle)||(s=this.session.getWordRange(s.start.row,s.start.column),t=this.session.getTextRange(s)),this.$search.set({needle:t})),this.$search.set(e),e.start||this.$search.set({start:s});var o=this.$search.find(this.session);return e.preventScroll?o:o?(this.revealRange(o,n),o):(e.backwards?s.start=s.end:s.end=s.start,void this.selection.setRange(s))},this.findNext=function(t,e){this.find({skipCurrent:!0,backwards:!1},t,e)},this.findPrevious=function(t,e){this.find(t,{skipCurrent:!0,backwards:!0},e)},this.revealRange=function(t,e){this.$blockScrolling+=1,this.session.unfold(t),this.selection.setSelectionRange(t),this.$blockScrolling-=1;var i=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(t.start,t.end,.5),!1!==e&&this.renderer.animateScrolling(i)},this.undo=function(){this.$blockScrolling++,this.session.getUndoManager().undo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.$blockScrolling++,this.session.getUndoManager().redo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(t){if(t){var e,i=this,n=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var s=this.$scrollAnchor;s.style.cssText="position:absolute",this.container.insertBefore(s,this.container.firstChild);var o=this.on("changeSelection",(function(){n=!0})),r=this.renderer.on("beforeRender",(function(){n&&(e=i.renderer.container.getBoundingClientRect())})),a=this.renderer.on("afterRender",(function(){if(n&&e&&(i.isFocused()||i.searchBox&&i.searchBox.isFocused())){var t=i.renderer,o=t.$cursorLayer.$pixelPos,r=t.layerConfig,a=o.top-r.offset;null!=(n=o.top>=0&&a+e.top<0||!(o.top<r.height&&o.top+e.top+r.lineHeight>window.innerHeight)&&null)&&(s.style.top=a+"px",s.style.left=o.left+"px",s.style.height=r.lineHeight+"px",s.scrollIntoView(n)),n=e=null}}));this.setAutoScrollEditorIntoView=function(t){t||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",o),this.renderer.off("afterRender",a),this.renderer.off("beforeRender",r))}}},this.$resetCursorStyle=function(){var t=this.$cursorStyle||"ace",e=this.renderer.$cursorLayer;e&&(e.setSmoothBlinking(/smooth/.test(t)),e.isBlinking=!this.$readOnly&&"wide"!=t,n.setCssClass(e.element,"ace_slim-cursors",/slim/.test(t)))}}.call(y.prototype),f.defineOptions(y.prototype,"editor",{selectionStyle:{set:function(t){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:t})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(){this.$resetCursorStyle()},initialValue:!1},cursorStyle:{set:function(){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(t){this.setAutoScrollEditorIntoView(t)}},keyboardHandler:{set:function(t){this.setKeyboardHandler(t)},get:function(){return this.keybindingId},handlesSet:!0},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showLineNumbers:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"}),e.Editor=y})),ace.define("ace/undomanager",["require","exports","module"],(function(t,e){var i=function(){this.reset()};(function(){function t(t){return{action:t.action,start:t.start,end:t.end,lines:1==t.lines.length?null:t.lines,text:1==t.lines.length?t.lines[0]:null}}function e(t){return{action:t.action,start:t.start,end:t.end,lines:t.lines||[t.text]}}function i(t,e){for(var i=new Array(t.length),n=0;n<t.length;n++){for(var s=t[n],o={group:s.group,deltas:new Array(s.length)},r=0;r<s.deltas.length;r++)o.deltas[r]=e(s.deltas[r]);i[n]=o}return i}this.execute=function(t){var e=t.args[0];this.$doc=t.args[1],t.merge&&this.hasUndo()&&(this.dirtyCounter--,e=this.$undoStack.pop().concat(e)),this.$undoStack.push(e),this.$redoStack=[],this.dirtyCounter<0&&(this.dirtyCounter=NaN),this.dirtyCounter++},this.undo=function(t){var e=this.$undoStack.pop(),i=null;return e&&(i=this.$doc.undoChanges(e,t),this.$redoStack.push(e),this.dirtyCounter--),i},this.redo=function(t){var e=this.$redoStack.pop(),i=null;return e&&(i=this.$doc.redoChanges(this.$deserializeDeltas(e),t),this.$undoStack.push(e),this.dirtyCounter++),i},this.reset=function(){this.$undoStack=[],this.$redoStack=[],this.dirtyCounter=0},this.hasUndo=function(){return this.$undoStack.length>0},this.hasRedo=function(){return this.$redoStack.length>0},this.markClean=function(){this.dirtyCounter=0},this.isClean=function(){return 0===this.dirtyCounter},this.$serializeDeltas=function(e){return i(e,t)},this.$deserializeDeltas=function(t){return i(t,e)}}).call(i.prototype),e.UndoManager=i})),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter"],(function(t,e){var i=t("../lib/dom"),n=t("../lib/oop"),s=t("../lib/lang"),o=t("../lib/event_emitter").EventEmitter,r=function(t){this.element=i.createElement("div"),this.element.className="ace_layer ace_gutter-layer",t.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$cells=[]};(function(){n.implement(this,o),this.setSession=function(t){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=t,t&&t.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(t,e){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(t,e)},this.removeGutterDecoration=function(t,e){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(t,e)},this.setAnnotations=function(t){this.$annotations=[];for(var e=0;e<t.length;e++){var i=t[e],n=i.row,o=this.$annotations[n];o||(o=this.$annotations[n]={text:[]});var r=i.text;r=r?s.escapeHTML(r):i.html||"",-1===o.text.indexOf(r)&&o.text.push(r);var a=i.type;"error"==a?o.className=" ace_error":"warning"==a&&" ace_error"!=o.className?o.className=" ace_warning":"info"!=a||o.className||(o.className=" ace_info")}},this.$updateAnnotations=function(t){if(this.$annotations.length){var e=t.start.row,i=t.end.row-e;if(0===i);else if("remove"==t.action)this.$annotations.splice(e,i+1,null);else{var n=new Array(i+1);n.unshift(e,1),this.$annotations.splice.apply(this.$annotations,n)}}},this.update=function(t){for(var e=this.session,n=t.firstRow,s=Math.min(t.lastRow+t.gutterOffset,e.getLength()-1),o=e.getNextFoldLine(n),r=o?o.start.row:1/0,a=this.$showFoldWidgets&&e.foldWidgets,l=e.$breakpoints,c=e.$decorations,h=e.$firstLineNumber,d=0,u=e.gutterRenderer||this.$renderer,m=null,p=-1,b=n;;){if(b>r&&(r=(o=e.getNextFoldLine(b=o.end.row+1,o))?o.start.row:1/0),b>s){for(;this.$cells.length>p+1;)m=this.$cells.pop(),this.element.removeChild(m.element);break}(m=this.$cells[++p])||((m={element:null,textNode:null,foldWidget:null}).element=i.createElement("div"),m.textNode=document.createTextNode(""),m.element.appendChild(m.textNode),this.element.appendChild(m.element),this.$cells[p]=m);var f,g="ace_gutter-cell ";if(l[b]&&(g+=l[b]),c[b]&&(g+=c[b]),this.$annotations[b]&&(g+=this.$annotations[b].className),m.element.className!=g&&(m.element.className=g),(f=e.getRowLength(b)*t.lineHeight+"px")!=m.element.style.height&&(m.element.style.height=f),a){var y=a[b];null==y&&(y=a[b]=e.getFoldWidget(b))}if(y)m.foldWidget||(m.foldWidget=i.createElement("span"),m.element.appendChild(m.foldWidget)),g="ace_fold-widget ace_"+y,m.foldWidget.className!=(g+="start"==y&&b==r&&b<o.end.row?" ace_closed":" ace_open")&&(m.foldWidget.className=g),m.foldWidget.style.height!=(f=t.lineHeight+"px")&&(m.foldWidget.style.height=f);else m.foldWidget&&(m.element.removeChild(m.foldWidget),m.foldWidget=null);var v=d=u?u.getText(e,b):b+h;v!==m.textNode.data&&(m.textNode.data=v),b++}this.element.style.height=t.minHeight+"px",(this.$fixedWidth||e.$useWrapMode)&&(d=e.getLength()+h);var Z=u?u.getWidth(e,d,t):d.toString().length*t.characterWidth,x=this.$padding||this.$computePadding();(Z+=x.left+x.right)===this.gutterWidth||isNaN(Z)||(this.gutterWidth=Z,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",Z))},this.$fixedWidth=!1,this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(t){this.$renderer=!t&&{getWidth:function(){return""},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(t){t?i.addCssClass(this.element,"ace_folding-enabled"):i.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=t,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var t=i.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(t.paddingLeft)+1||0,this.$padding.right=parseInt(t.paddingRight)||0,this.$padding},this.getRegion=function(t){var e=this.$padding||this.$computePadding(),i=this.element.getBoundingClientRect();return t.x<e.left+i.left?"markers":this.$showFoldWidgets&&t.x>i.right-e.right?"foldWidgets":void 0}}).call(r.prototype),e.Gutter=r})),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],(function(t,e){var i=t("../range").Range,n=t("../lib/dom"),s=function(t){this.element=n.createElement("div"),this.element.className="ace_layer ace_marker-layer",t.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(t){this.$padding=t},this.setSession=function(t){this.session=t},this.setMarkers=function(t){this.markers=t},this.update=function(t){if(t){this.config=t;var e=[];for(var i in this.markers){var n=this.markers[i];if(n.range){var s=n.range.clipRows(t.firstRow,t.lastRow);if(!s.isEmpty())if(s=s.toScreenRange(this.session),n.renderer){var o=this.$getTop(s.start.row,t),r=this.$padding+(this.session.$bidiHandler.isBidiRow(s.start.row)?this.session.$bidiHandler.getPosLeft(s.start.column):s.start.column*t.characterWidth);n.renderer(e,s,r,o,t)}else"fullLine"==n.type?this.drawFullLineMarker(e,s,n.clazz,t):"screenLine"==n.type?this.drawScreenLineMarker(e,s,n.clazz,t):s.isMultiLine()?"text"==n.type?this.drawTextMarker(e,s,n.clazz,t):this.drawMultiLineMarker(e,s,n.clazz,t):this.session.$bidiHandler.isBidiRow(s.start.row)?this.drawBidiSingleLineMarker(e,s,n.clazz+" ace_start ace_br15",t):this.drawSingleLineMarker(e,s,n.clazz+" ace_start ace_br15",t)}else n.update(e,this,this.session,t)}this.element.innerHTML=e.join("")}},this.$getTop=function(t,e){return(t-e.firstRowScreen)*e.lineHeight},this.drawTextMarker=function(t,e,n,s,o){for(var r=this.session,a=e.start.row,l=e.end.row,c=a,h=0,d=0,u=r.getScreenLastRowColumn(c),m=null,p=new i(c,e.start.column,c,d);c<=l;c++)p.start.row=p.end.row=c,p.start.column=c==a?e.start.column:r.getRowWrapIndent(c),p.end.column=u,h=d,d=u,u=c+1<l?r.getScreenLastRowColumn(c+1):c==l?0:e.end.column,m=n+(c==a?" ace_start":"")+" ace_br"+((c==a||c==a+1&&e.start.column?1:0)|(h<d?2:0)|(d>u?4:0)|(c==l?8:0)),this.session.$bidiHandler.isBidiRow(c)?this.drawBidiSingleLineMarker(t,p,m,s,c==l?0:1,o):this.drawSingleLineMarker(t,p,m,s,c==l?0:1,o)},this.drawMultiLineMarker=function(t,e,i,n,s){var o,r,a=this.$padding;if(s=s||"",this.session.$bidiHandler.isBidiRow(e.start.row)?((l=e.clone()).end.row=l.start.row,l.end.column=this.session.getLine(l.start.row).length,this.drawBidiSingleLineMarker(t,l,i+" ace_br1 ace_start",n,null,s)):(o=n.lineHeight,r=this.$getTop(e.start.row,n),t.push("<div class='",i," ace_br1 ace_start' style='","height:",o,"px;","right:0;","top:",r,"px;","left:",a+e.start.column*n.characterWidth,"px;",s,"'></div>")),this.session.$bidiHandler.isBidiRow(e.end.row)){var l;(l=e.clone()).start.row=l.end.row,l.start.column=0,this.drawBidiSingleLineMarker(t,l,i+" ace_br12",n,null,s)}else{var c=e.end.column*n.characterWidth;o=n.lineHeight,r=this.$getTop(e.end.row,n),t.push("<div class='",i," ace_br12' style='","height:",o,"px;","width:",c,"px;","top:",r,"px;","left:",a,"px;",s,"'></div>")}if(!((o=(e.end.row-e.start.row-1)*n.lineHeight)<=0)){r=this.$getTop(e.start.row+1,n);var h=(e.start.column?1:0)|(e.end.column?0:8);t.push("<div class='",i,h?" ace_br"+h:"","' style='","height:",o,"px;","right:0;","top:",r,"px;","left:",a,"px;",s,"'></div>")}},this.drawSingleLineMarker=function(t,e,i,n,s,o){var r=n.lineHeight,a=(e.end.column+(s||0)-e.start.column)*n.characterWidth,l=this.$getTop(e.start.row,n);t.push("<div class='",i,"' style='","height:",r,"px;","width:",a,"px;","top:",l,"px;","left:",this.$padding+e.start.column*n.characterWidth,"px;",o||"","'></div>")},this.drawBidiSingleLineMarker=function(t,e,i,n,s,o){var r=n.lineHeight,a=this.$getTop(e.start.row,n),l=this.$padding;this.session.$bidiHandler.getSelections(e.start.column,e.end.column).forEach((function(e){t.push("<div class='",i,"' style='","height:",r,"px;","width:",e.width+(s||0),"px;","top:",a,"px;","left:",l+e.left,"px;",o||"","'></div>")}))},this.drawFullLineMarker=function(t,e,i,n,s){var o=this.$getTop(e.start.row,n),r=n.lineHeight;e.start.row!=e.end.row&&(r+=this.$getTop(e.end.row,n)-o),t.push("<div class='",i,"' style='","height:",r,"px;","top:",o,"px;","left:0;right:0;",s||"","'></div>")},this.drawScreenLineMarker=function(t,e,i,n,s){var o=this.$getTop(e.start.row,n);t.push("<div class='",i,"' style='","height:",n.lineHeight,"px;","top:",o,"px;","left:0;right:0;",s||"","'></div>")}}).call(s.prototype),e.Marker=s})),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],(function(t,e){var i=t("../lib/oop"),n=t("../lib/dom"),s=t("../lib/lang"),o=(t("../lib/useragent"),t("../lib/event_emitter").EventEmitter),r=function(t){this.element=n.createElement("div"),this.element.className="ace_layer ace_text-layer",t.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this)};(function(){i.implement(this,o),this.EOF_CHAR="",this.EOL_CHAR_LF="",this.EOL_CHAR_CRLF="",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="",this.SPACE_CHAR="",this.$padding=0,this.$updateEolChar=function(){var t="\n"==this.session.doc.getNewLineCharacter()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=t)return this.EOL_CHAR=t,!0},this.setPadding=function(t){this.$padding=t,this.element.style.padding="0 "+t+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(t){this.$fontMetrics=t,this.$fontMetrics.on("changeCharacterSize",function(t){this._signal("changeCharacterSize",t)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(t){this.session=t,t&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(t){return this.showInvisibles!=t&&(this.showInvisibles=t,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(t){return this.displayIndentGuides!=t&&(this.displayIndentGuides=t,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var t=this.session.getTabSize();this.tabSize=t;for(var e=this.$tabStrings=[0],i=1;i<t+1;i++)e.push(this.showInvisibles?"<span class='ace_invisible ace_invisible_tab'>"+s.stringRepeat(this.TAB_CHAR,i)+"</span>":s.stringRepeat(" ",i));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var n="ace_indent-guide",o="",r="";if(this.showInvisibles){n+=" ace_invisible",o=" ace_invisible_space",r=" ace_invisible_tab";var a=s.stringRepeat(this.SPACE_CHAR,this.tabSize),l=s.stringRepeat(this.TAB_CHAR,this.tabSize)}else l=a=s.stringRepeat(" ",this.tabSize);this.$tabStrings[" "]="<span class='"+n+o+"'>"+a+"</span>",this.$tabStrings["\t"]="<span class='"+n+r+"'>"+l+"</span>"}},this.updateLines=function(t,e,i){this.config.lastRow==t.lastRow&&this.config.firstRow==t.firstRow||this.scrollLines(t),this.config=t;for(var n=Math.max(e,t.firstRow),s=Math.min(i,t.lastRow),o=this.element.childNodes,r=0,a=t.firstRow;a<n;a++){if(l=this.session.getFoldLine(a)){if(l.containsRow(n)){n=l.start.row;break}a=l.end.row}r++}for(var l,c=(l=this.session.getNextFoldLine(a=n))?l.start.row:1/0;a>c&&(c=(l=this.session.getNextFoldLine(a=l.end.row+1,l))?l.start.row:1/0),!(a>s);){var h=o[r++];if(h){var d=[];this.$renderLine(d,a,!this.$useLineGroups(),a==c&&l),h.style.height=t.lineHeight*this.session.getRowLength(a)+"px",h.innerHTML=d.join("")}a++}},this.scrollLines=function(t){var e=this.config;if(this.config=t,!e||e.lastRow<t.firstRow)return this.update(t);if(t.lastRow<e.firstRow)return this.update(t);var i=this.element;if(e.firstRow<t.firstRow)for(var n=this.session.getFoldedRowCount(e.firstRow,t.firstRow-1);n>0;n--)i.removeChild(i.firstChild);if(e.lastRow>t.lastRow)for(n=this.session.getFoldedRowCount(t.lastRow+1,e.lastRow);n>0;n--)i.removeChild(i.lastChild);if(t.firstRow<e.firstRow){var s=this.$renderLinesFragment(t,t.firstRow,e.firstRow-1);i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s)}t.lastRow>e.lastRow&&(s=this.$renderLinesFragment(t,e.lastRow+1,t.lastRow),i.appendChild(s))},this.$renderLinesFragment=function(t,e,i){for(var s=this.element.ownerDocument.createDocumentFragment(),o=e,r=this.session.getNextFoldLine(o),a=r?r.start.row:1/0;o>a&&(a=(r=this.session.getNextFoldLine(o=r.end.row+1,r))?r.start.row:1/0),!(o>i);){var l=n.createElement("div"),c=[];if(this.$renderLine(c,o,!1,o==a&&r),l.innerHTML=c.join(""),this.$useLineGroups())l.className="ace_line_group",s.appendChild(l),l.style.height=t.lineHeight*this.session.getRowLength(o)+"px";else for(;l.firstChild;)s.appendChild(l.firstChild);o++}return s},this.update=function(t){this.config=t;for(var e=[],i=t.lastRow,n=t.firstRow,s=this.session.getNextFoldLine(n),o=s?s.start.row:1/0;n>o&&(o=(s=this.session.getNextFoldLine(n=s.end.row+1,s))?s.start.row:1/0),!(n>i);)this.$useLineGroups()&&e.push("<div class='ace_line_group' style='height:",t.lineHeight*this.session.getRowLength(n),"px'>"),this.$renderLine(e,n,!1,n==o&&s),this.$useLineGroups()&&e.push("</div>"),n++;this.element.innerHTML=e.join("")},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(t,e,i,n){var o=this,r=n.replace(/\t|&|<|>|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,(function(t,i,n,r){if(i)return o.showInvisibles?"<span class='ace_invisible ace_invisible_space'>"+s.stringRepeat(o.SPACE_CHAR,t.length)+"</span>":t;if("&"==t)return"&#38;";if("<"==t)return"&#60;";if(">"==t)return"&#62;";if("\t"==t){var a=o.session.getScreenTabSize(e+r);return e+=a-1,o.$tabStrings[a]}return""==t?(e+=1,"<span class='"+(o.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk")+"' style='width:"+2*o.config.characterWidth+"px'>"+(o.showInvisibles?o.SPACE_CHAR:"")+"</span>"):n?"<span class='ace_invisible ace_invisible_space ace_invalid'>"+o.SPACE_CHAR+"</span>":(e+=1,"<span class='ace_cjk' style='width:"+2*o.config.characterWidth+"px'>"+t+"</span>")}));if(this.$textToken[i.type])t.push(r);else{var a="ace_"+i.type.replace(/\./g," ace_"),l="";"fold"==i.type&&(l=" style='width:"+i.value.length*this.config.characterWidth+"px;' "),t.push("<span class='",a,"'",l,">",r,"</span>")}return e+n.length},this.renderIndentGuide=function(t,e,i){var n=e.search(this.$indentGuideRe);return n<=0||n>=i?e:" "==e[0]?(t.push(s.stringRepeat(this.$tabStrings[" "],(n-=n%this.tabSize)/this.tabSize)),e.substr(n)):"\t"==e[0]?(t.push(s.stringRepeat(this.$tabStrings["\t"],n)),e.substr(n)):e},this.$renderWrappedLine=function(t,e,i,n){for(var o=0,r=0,a=i[0],l=0,c=0;c<e.length;c++){var h=e[c],d=h.value;if(0==c&&this.displayIndentGuides){if(o=d.length,!(d=this.renderIndentGuide(t,d,a)))continue;o-=d.length}if(o+d.length<a)l=this.$renderToken(t,l,h,d),o+=d.length;else{for(;o+d.length>=a;)l=this.$renderToken(t,l,h,d.substring(0,a-o)),d=d.substring(a-o),o=a,n||t.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),t.push(s.stringRepeat("",i.indent)),l=0,a=i[++r]||Number.MAX_VALUE;0!=d.length&&(o+=d.length,l=this.$renderToken(t,l,h,d))}}},this.$renderSimpleLine=function(t,e){var i=0,n=e[0],s=n.value;this.displayIndentGuides&&(s=this.renderIndentGuide(t,s)),s&&(i=this.$renderToken(t,i,n,s));for(var o=1;o<e.length;o++)i=this.$renderToken(t,i,n=e[o],s=n.value)},this.$renderLine=function(t,e,i,n){if(n||0==n||(n=this.session.getFoldLine(e)),n)var s=this.$getFoldLineTokens(e,n);else s=this.session.getTokens(e);if(i||t.push("<div class='ace_line' style='height:",this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(e)),"px'>"),s.length){var o=this.session.getRowSplitData(e);o&&o.length?this.$renderWrappedLine(t,s,o,i):this.$renderSimpleLine(t,s)}this.showInvisibles&&(n&&(e=n.end.row),t.push("<span class='ace_invisible ace_invisible_eol'>",e==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>")),i||t.push("</div>")},this.$getFoldLineTokens=function(t,e){var i=this.session,n=[],s=i.getTokens(t);return e.walk((function(t,e,o,r,a){null!=t?n.push({type:"fold",value:t}):(a&&(s=i.getTokens(e)),s.length&&function(t,e,i){for(var s=0,o=0;o+t[s].value.length<e;)if(o+=t[s].value.length,++s==t.length)return;for(o!=e&&((r=t[s].value.substring(e-o)).length>i-e&&(r=r.substring(0,i-e)),n.push({type:t[s].type,value:r}),o=e+r.length,s+=1);o<i&&s<t.length;){var r;n.push((r=t[s].value).length+o>i?{type:t[s].type,value:r.substring(0,i-o)}:t[s]),o+=r.length,s+=1}}(s,r,o))}),e.end.row,this.session.getLine(e.end.row).length),n},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode),delete this.$measureNode}}).call(r.prototype),e.Text=r})),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],(function(t,e){var i,n=t("../lib/dom"),s=function(t){this.element=n.createElement("div"),this.element.className="ace_layer ace_cursor-layer",t.appendChild(this.element),void 0===i&&(i=!("opacity"in this.element.style)),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),n.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=(i?this.$updateVisibility:this.$updateOpacity).bind(this)};(function(){this.$updateVisibility=function(t){for(var e=this.cursors,i=e.length;i--;)e[i].style.visibility=t?"":"hidden"},this.$updateOpacity=function(t){for(var e=this.cursors,i=e.length;i--;)e[i].style.opacity=t?"":"0"},this.$padding=0,this.setPadding=function(t){this.$padding=t},this.setSession=function(t){this.session=t},this.setBlinking=function(t){t!=this.isBlinking&&(this.isBlinking=t,this.restartTimer())},this.setBlinkInterval=function(t){t!=this.blinkInterval&&(this.blinkInterval=t,this.restartTimer())},this.setSmoothBlinking=function(t){t==this.smoothBlinking||i||(this.smoothBlinking=t,n.setCssClass(this.element,"ace_smooth-blinking",t),this.$updateCursors(!0),this.$updateCursors=this.$updateOpacity.bind(this),this.restartTimer())},this.addCursor=function(){var t=n.createElement("div");return t.className="ace_cursor",this.element.appendChild(t),this.cursors.push(t),t},this.removeCursor=function(){if(this.cursors.length>1){var t=this.cursors.pop();return t.parentNode.removeChild(t),t}},this.hideCursor=function(){this.isVisible=!1,n.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,n.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var t=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.smoothBlinking&&n.removeCssClass(this.element,"ace_smooth-blinking"),t(!0),this.isBlinking&&this.blinkInterval&&this.isVisible){this.smoothBlinking&&setTimeout(function(){n.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var e=function(){this.timeoutId=setTimeout((function(){t(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){t(!0),e()}),this.blinkInterval),e()}},this.getPixelPosition=function(t,e){if(!this.config||!this.session)return{left:0,top:0};t||(t=this.session.selection.getCursor());var i=this.session.documentToScreenPosition(t);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(i.row,t.row)?this.session.$bidiHandler.getPosLeft(i.column):i.column*this.config.characterWidth),top:(i.row-(e?this.config.firstRowScreen:0))*this.config.lineHeight}},this.update=function(t){this.config=t;var e=this.session.$selectionMarkers,i=0,n=0;void 0!==e&&0!==e.length||(e=[{cursor:null}]),i=0;for(var s=e.length;i<s;i++){var o=this.getPixelPosition(e[i].cursor,!0);if(!((o.top>t.height+t.offset||o.top<0)&&i>1)){var r=(this.cursors[n++]||this.addCursor()).style;this.drawCursor?this.drawCursor(r,o,t,e[i],this.session):(r.left=o.left+"px",r.top=o.top+"px",r.width=t.characterWidth+"px",r.height=t.lineHeight+"px")}}for(;this.cursors.length>n;)this.removeCursor();var a=this.session.getOverwrite();this.$setOverwrite(a),this.$pixelPos=o,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(t){t!=this.overwrite&&(this.overwrite=t,t?n.addCssClass(this.element,"ace_overwrite-cursors"):n.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(s.prototype),e.Cursor=s})),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],(function(t,e){var i=t("./lib/oop"),n=t("./lib/dom"),s=t("./lib/event"),o=t("./lib/event_emitter").EventEmitter,r=function(t){this.element=n.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=n.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),t.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,s.addListener(this.element,"scroll",this.onScroll.bind(this)),s.addListener(this.element,"mousedown",s.preventDefault)};(function(){i.implement(this,o),this.setVisible=function(t){this.element.style.display=t?"":"none",this.isVisible=t,this.coeff=1}}).call(r.prototype);var a=function(t,e){r.call(this,t),this.scrollTop=0,this.scrollHeight=0,e.$scrollbarWidth=this.width=n.scrollbarWidth(t.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};i.inherits(a,r),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var t=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-t)/(this.coeff-t)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(t){this.element.style.height=t+"px"},this.setInnerHeight=this.setScrollHeight=function(t){this.scrollHeight=t,t>32768?(this.coeff=32768/t,t=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=t+"px"},this.setScrollTop=function(t){this.scrollTop!=t&&(this.skipEvent=!0,this.scrollTop=t,this.element.scrollTop=t*this.coeff)}}.call(a.prototype);var l=function(t,e){r.call(this,t),this.scrollLeft=0,this.height=e.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};i.inherits(l,r),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(t){this.element.style.width=t+"px"},this.setInnerWidth=function(t){this.inner.style.width=t+"px"},this.setScrollWidth=function(t){this.inner.style.width=t+"px"},this.setScrollLeft=function(t){this.scrollLeft!=t&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=t)}}.call(l.prototype),e.ScrollBar=a,e.ScrollBarV=a,e.ScrollBarH=l,e.VScrollBar=a,e.HScrollBar=l})),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],(function(t,e){var i=t("./lib/event"),n=function(t,e){this.onRender=t,this.pending=!1,this.changes=0,this.window=e||window};(function(){this.schedule=function(t){if(this.changes=this.changes|t,!this.pending&&this.changes){this.pending=!0;var e=this;i.nextFrame((function(){var t;for(e.pending=!1;t=e.changes;)e.changes=0,e.onRender(t)}),this.window)}}}).call(n.prototype),e.RenderLoop=n})),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],(function(t,i){var n=t("../lib/oop"),s=t("../lib/dom"),o=t("../lib/lang"),r=t("../lib/useragent"),a=t("../lib/event_emitter").EventEmitter,l=0,c=i.FontMetrics=function(t){this.el=s.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=s.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=s.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),t.appendChild(this.el),l||this.$testFractionalRect(),this.$measureNode.innerHTML=o.stringRepeat("X",l),this.$characterSize={width:0,height:0},this.checkForSizeChanges()};(function(){n.implement(this,a),this.$characterSize={width:0,height:0},this.$testFractionalRect=function(){var t=s.createElement("div");this.$setMeasureNodeStyles(t.style),t.style.width="0.2px",document.documentElement.appendChild(t);var e=t.getBoundingClientRect().width;l=e>0&&e<1?50:100,t.parentNode.removeChild(t)},this.$setMeasureNodeStyles=function(t,e){t.width=t.height="auto",t.left=t.top="0px",t.visibility="hidden",t.position="absolute",t.whiteSpace="pre",r.isIE<8?t["font-family"]="inherit":t.font="inherit",t.overflow=e?"hidden":"visible"},this.checkForSizeChanges=function(){var t=this.$measureSizes();if(t&&(this.$characterSize.width!==t.width||this.$characterSize.height!==t.height)){this.$measureNode.style.fontWeight="bold";var e=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=t,this.charSizes=Object.create(null),this.allowBoldFonts=e&&e.width===t.width&&e.height===t.height,this._emit("changeCharacterSize",{data:t})}},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer)return this.$pollSizeChangesTimer;var t=this;return this.$pollSizeChangesTimer=setInterval((function(){t.checkForSizeChanges()}),500)},this.setPolling=function(t){t?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(){if(50===l){var t=null;try{t=this.$measureNode.getBoundingClientRect()}catch(e){t={width:0,height:0}}var i={height:t.height,width:t.width/l}}else i={height:this.$measureNode.clientHeight,width:this.$measureNode.clientWidth/l};return 0===i.width||0===i.height?null:i},this.$measureCharWidth=function(t){return this.$main.innerHTML=o.stringRepeat(t,l),this.$main.getBoundingClientRect().width/l},this.getCharacterWidth=function(t){var e=this.charSizes[t];return void 0===e&&(e=this.charSizes[t]=this.$measureCharWidth(t)/this.$characterSize.width),e},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}).call(c.prototype)})),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],(function(t,e){var i=t("./lib/oop"),n=t("./lib/dom"),s=t("./config"),o=t("./lib/useragent"),r=t("./layer/gutter").Gutter,a=t("./layer/marker").Marker,l=t("./layer/text").Text,c=t("./layer/cursor").Cursor,h=t("./scrollbar").HScrollBar,d=t("./scrollbar").VScrollBar,u=t("./renderloop").RenderLoop,m=t("./layer/font_metrics").FontMetrics,p=t("./lib/event_emitter").EventEmitter;n.importCssString('.ace_editor {position: relative;overflow: hidden;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_text-input-ios {position: absolute !important;top: -100000px !important;left: -100000px !important;}',"ace_editor.css");var b=function(t,e){var i=this;this.container=t||n.createElement("div"),this.$keepTextAreaAtCursor=!o.isOldIE,n.addCssClass(this.container,"ace_editor"),this.setTheme(e),this.$gutter=n.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=n.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=n.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new r(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new a(this.content);var p=this.$textLayer=new l(this.content);this.canvas=p.element,this.$markerFront=new a(this.content),this.$cursorLayer=new c(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new d(this.container,this),this.scrollBarH=new h(this.container,this),this.scrollBarV.addEventListener("scroll",(function(t){i.$scrollAnimation||i.session.setScrollTop(t.data-i.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(t){i.$scrollAnimation||i.session.setScrollLeft(t.data-i.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new m(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",(function(t){i.updateCharacterSize(),i.onResize(!0,i.gutterWidth,i.$size.width,i.$size.height),i._signal("changeCharacterSize",t)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$loop=new u(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),s.resetOptions(this),s._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,i.implement(this,p),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(t){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=t,t&&this.scrollMargin.top&&t.getScrollTop()<=0&&t.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(t),this.$markerBack.setSession(t),this.$markerFront.setSession(t),this.$gutterLayer.setSession(t),this.$textLayer.setSession(t),t&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(t,e,i){if(void 0===e&&(e=1/0),this.$changedLines?(this.$changedLines.firstRow>t&&(this.$changedLines.firstRow=t),this.$changedLines.lastRow<e&&(this.$changedLines.lastRow=e)):this.$changedLines={firstRow:t,lastRow:e},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!i)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(t){t?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(t,e,i,n){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=t?1:0;var s=this.container;n||(n=s.clientHeight||s.scrollHeight),i||(i=s.clientWidth||s.scrollWidth);var o=this.$updateCachedSize(t,e,i,n);if(!this.$size.scrollerHeight||!i&&!n)return this.resizing=0;t&&(this.$gutterLayer.$padding=null),t?this.$renderChanges(o|this.$changes,!0):this.$loop.schedule(o|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(t,e,i,n){var s=0,o=this.$size,r={width:o.width,height:o.height,scrollerHeight:o.scrollerHeight,scrollerWidth:o.scrollerWidth};return(n-=this.$extraHeight||0)&&(t||o.height!=n)&&(o.height=n,s|=this.CHANGE_SIZE,o.scrollerHeight=o.height,this.$horizScroll&&(o.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",s|=this.CHANGE_SCROLL),i&&(t||o.width!=i)&&(s|=this.CHANGE_SIZE,o.width=i,null==e&&(e=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=e,this.scrollBarH.element.style.left=this.scroller.style.left=e+"px",o.scrollerWidth=Math.max(0,i-e-this.scrollBarV.getWidth()),this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px",this.scroller.style.bottom=this.scrollBarH.getHeight()+"px",(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||t)&&(s|=this.CHANGE_FULL)),o.$dirty=!i||!n,s&&this._signal("resize",r),s},this.onGutterResize=function(){var t=this.$showGutter?this.$gutter.offsetWidth:0;t!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,t,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):(this.$computeLayerConfig(),this.$loop.schedule(this.CHANGE_MARKER))},this.adjustWrapLimit=function(){var t=Math.floor((this.$size.scrollerWidth-2*this.$padding)/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(t){this.setOption("animatedScroll",t)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(t){this.setOption("showInvisibles",t),this.session.$bidiHandler.setShowInvisibles(t)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(t){this.setOption("displayIndentGuides",t)},this.setShowPrintMargin=function(t){this.setOption("showPrintMargin",t)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(t){this.setOption("printMarginColumn",t)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(t){return this.setOption("showGutter",t)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(t){this.setOption("fadeFoldWidgets",t)},this.setHighlightGutterLine=function(t){this.setOption("highlightGutterLine",t)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updateGutterLineHighlight=function(){var t=this.$cursorLayer.$pixelPos,e=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var i=this.session.selection.getCursor();i.column=0,t=this.$cursorLayer.getPixelPosition(i,!0),e*=this.session.getRowLength(i.row)}this.$gutterLineHighlight.style.top=t.top-this.layerConfig.offset+"px",this.$gutterLineHighlight.style.height=e+"px"},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var t=n.createElement("div");t.className="ace_layer ace_print-margin-layer",this.$printMarginEl=n.createElement("div"),this.$printMarginEl.className="ace_print-margin",t.appendChild(this.$printMarginEl),this.content.insertBefore(t,this.content.firstChild)}var e=this.$printMarginEl.style;e.left=this.characterWidth*this.$printMarginColumn+this.$padding+"px",e.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(this.$keepTextAreaAtCursor){var t=this.layerConfig,e=this.$cursorLayer.$pixelPos.top,i=this.$cursorLayer.$pixelPos.left,n=this.textarea.style,s=this.lineHeight;if((e-=t.offset)<0||e>t.height-s)n.top=n.left="0";else{var o=this.characterWidth;if(this.$composition){var r=this.textarea.value.replace(/^\x01+/,"");o*=this.session.$getStringScreenWidth(r)[0]+2,s+=2}(i-=this.scrollLeft)>this.$size.scrollerWidth-o&&(i=this.$size.scrollerWidth-o),i+=this.gutterWidth,n.height=s+"px",n.width=o+"px",n.left=Math.min(i,this.$size.scrollerWidth-o)+"px",n.top=Math.min(e,this.$size.height-s)+"px"}}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var t=this.layerConfig,e=t.lastRow;return this.session.documentToScreenRow(e,0)*t.lineHeight-this.session.getScrollTop()>t.height-t.lineHeight?e-1:e},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(t){this.$padding=t,this.$textLayer.setPadding(t),this.$cursorLayer.setPadding(t),this.$markerFront.setPadding(t),this.$markerBack.setPadding(t),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(t,e,i,n){var s=this.scrollMargin;s.top=0|t,s.bottom=0|e,s.right=0|n,s.left=0|i,s.v=s.top+s.bottom,s.h=s.left+s.right,s.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-s.top),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(t){this.setOption("hScrollBarAlwaysVisible",t)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(t){this.setOption("vScrollBarAlwaysVisible",t)},this.$updateScrollBarV=function(){var t=this.layerConfig.maxHeight,e=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&this.scrollTop>(t-=(e-this.lineHeight)*this.$scrollPastEnd)-e&&(t=this.scrollTop+e,this.scrollBarV.scrollTop=null),this.scrollBarV.setScrollHeight(t+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(t,e){if(this.$changes&&(t|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(t||e)){if(this.$size.$dirty)return this.$changes|=t,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender"),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var i=this.layerConfig;if(t&this.CHANGE_FULL||t&this.CHANGE_SIZE||t&this.CHANGE_TEXT||t&this.CHANGE_LINES||t&this.CHANGE_SCROLL||t&this.CHANGE_H_SCROLL){if(t|=this.$computeLayerConfig(),i.firstRow!=this.layerConfig.firstRow&&i.firstRowScreen==this.layerConfig.firstRowScreen){var n=this.scrollTop+(i.firstRow-this.layerConfig.firstRow)*this.lineHeight;n>0&&(this.scrollTop=n,t|=this.CHANGE_SCROLL,t|=this.$computeLayerConfig())}i=this.layerConfig,this.$updateScrollBarV(),t&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),this.$gutterLayer.element.style.marginTop=-i.offset+"px",this.content.style.marginTop=-i.offset+"px",this.content.style.width=i.width+2*this.$padding+"px",this.content.style.height=i.minHeight+"px"}if(t&this.CHANGE_H_SCROLL&&(this.content.style.marginLeft=-this.scrollLeft+"px",this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),t&this.CHANGE_FULL)return this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),void this._signal("afterRender");if(t&this.CHANGE_SCROLL)return t&this.CHANGE_TEXT||t&this.CHANGE_LINES?this.$textLayer.update(i):this.$textLayer.scrollLines(i),this.$showGutter&&this.$gutterLayer.update(i),this.$markerBack.update(i),this.$markerFront.update(i),this.$cursorLayer.update(i),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this.$moveTextAreaToCursor(),void this._signal("afterRender");t&this.CHANGE_TEXT?(this.$textLayer.update(i),this.$showGutter&&this.$gutterLayer.update(i)):t&this.CHANGE_LINES?(this.$updateLines()||t&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(i):(t&this.CHANGE_TEXT||t&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(i),t&this.CHANGE_CURSOR&&(this.$cursorLayer.update(i),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight()),t&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(i),t&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(i),this._signal("afterRender")}else this.$changes|=t},this.$autosize=function(){var t=this.session.getScreenLength()*this.lineHeight,e=this.$maxLines*this.lineHeight,i=Math.min(e,Math.max((this.$minLines||1)*this.lineHeight,t))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(i+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&i>this.$maxPixelHeight&&(i=this.$maxPixelHeight);var n=t>e;if(i!=this.desiredHeight||this.$size.height!=this.desiredHeight||n!=this.$vScroll){n!=this.$vScroll&&(this.$vScroll=n,this.scrollBarV.setVisible(n));var s=this.container.clientWidth;this.container.style.height=i+"px",this.$updateCachedSize(!0,this.$gutterWidth,s,i),this.desiredHeight=i,this._signal("autosize")}},this.$computeLayerConfig=function(){var t=this.session,e=this.$size,i=e.height<=2*this.lineHeight,n=this.session.getScreenLength()*this.lineHeight,s=this.$getLongestLine(),o=!i&&(this.$hScrollBarAlwaysVisible||e.scrollerWidth-s-2*this.$padding<0),r=this.$horizScroll!==o;r&&(this.$horizScroll=o,this.scrollBarH.setVisible(o));var a=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var l=this.scrollTop%this.lineHeight,c=e.scrollerHeight+this.lineHeight,h=!this.$maxLines&&this.$scrollPastEnd?(e.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;n+=h;var d=this.scrollMargin;this.session.setScrollTop(Math.max(-d.top,Math.min(this.scrollTop,n-e.scrollerHeight+d.bottom))),this.session.setScrollLeft(Math.max(-d.left,Math.min(this.scrollLeft,s+2*this.$padding-e.scrollerWidth+d.right)));var u=!i&&(this.$vScrollBarAlwaysVisible||e.scrollerHeight-n+h<0||this.scrollTop>d.top),m=a!==u;m&&(this.$vScroll=u,this.scrollBarV.setVisible(u));var p,b,f=Math.ceil(c/this.lineHeight)-1,g=Math.max(0,Math.round((this.scrollTop-l)/this.lineHeight)),y=g+f,v=this.lineHeight;g=t.screenToDocumentRow(g,0);var Z=t.getFoldLine(g);Z&&(g=Z.start.row),p=t.documentToScreenRow(g,0),b=t.getRowLength(g)*v,y=Math.min(t.screenToDocumentRow(y,0),t.getLength()-1),c=e.scrollerHeight+t.getRowLength(y)*v+b,l=this.scrollTop-p*v;var x=0;return this.layerConfig.width!=s&&(x=this.CHANGE_H_SCROLL),(r||m)&&(x=this.$updateCachedSize(!0,this.gutterWidth,e.width,e.height),this._signal("scrollbarVisibilityChanged"),m&&(s=this.$getLongestLine())),this.layerConfig={width:s,padding:this.$padding,firstRow:g,firstRowScreen:p,lastRow:y,lineHeight:v,characterWidth:this.characterWidth,minHeight:c,maxHeight:n,offset:l,gutterOffset:v?Math.max(0,Math.ceil((l+e.height-e.scrollerHeight)/v)):0,height:this.$size.scrollerHeight},x},this.$updateLines=function(){if(this.$changedLines){var t=this.$changedLines.firstRow,e=this.$changedLines.lastRow;this.$changedLines=null;var i=this.layerConfig;if(!(t>i.lastRow+1||e<i.firstRow))return e===1/0?(this.$showGutter&&this.$gutterLayer.update(i),void this.$textLayer.update(i)):(this.$textLayer.updateLines(i,t,e),!0)}},this.$getLongestLine=function(){var t=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(t+=1),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(t*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(t,e){this.$gutterLayer.addGutterDecoration(t,e)},this.removeGutterDecoration=function(t,e){this.$gutterLayer.removeGutterDecoration(t,e)},this.updateBreakpoints=function(){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(t){this.$gutterLayer.setAnnotations(t),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(t,e,i){this.scrollCursorIntoView(t,i),this.scrollCursorIntoView(e,i)},this.scrollCursorIntoView=function(t,e,i){if(0!==this.$size.scrollerHeight){var n=this.$cursorLayer.getPixelPosition(t),s=n.left,o=n.top,r=i&&i.top||0,a=i&&i.bottom||0,l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+r>o?(e&&l+r>o+this.lineHeight&&(o-=e*this.$size.scrollerHeight),0===o&&(o=-this.scrollMargin.top),this.session.setScrollTop(o)):l+this.$size.scrollerHeight-a<o+this.lineHeight&&(e&&l+this.$size.scrollerHeight-a<o-this.lineHeight&&(o+=e*this.$size.scrollerHeight),this.session.setScrollTop(o+this.lineHeight-this.$size.scrollerHeight));var c=this.scrollLeft;c>s?(s<this.$padding+2*this.layerConfig.characterWidth&&(s=-this.scrollMargin.left),this.session.setScrollLeft(s)):c+this.$size.scrollerWidth<s+this.characterWidth?this.session.setScrollLeft(Math.round(s+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&s-c<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(t){this.session.setScrollTop(t*this.lineHeight)},this.alignCursor=function(t,e){"number"==typeof t&&(t={row:t,column:0});var i=this.$cursorLayer.getPixelPosition(t).top-(this.$size.scrollerHeight-this.lineHeight)*(e||0);return this.session.setScrollTop(i),i},this.STEPS=8,this.$calcSteps=function(t,e){var i=0,n=this.STEPS,s=[],o=function(t,e,i){return i*(Math.pow(t-1,3)+1)+e};for(i=0;i<n;++i)s.push(o(i/this.STEPS,t,e-t));return s},this.scrollToLine=function(t,e,i,n){var s=this.$cursorLayer.getPixelPosition({row:t,column:0}).top;e&&(s-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(s),!1!==i&&this.animateScrolling(o,n)},this.animateScrolling=function(t,e){var i=this.scrollTop;if(this.$animatedScroll){var n=this;if(t!=i){if(this.$scrollAnimation){var s=this.$scrollAnimation.steps;if(s.length&&(t=s[0])==i)return}var o=n.$calcSteps(t,i);this.$scrollAnimation={from:t,to:i,steps:o},clearInterval(this.$timer),n.session.setScrollTop(o.shift()),n.session.$scrollTop=i,this.$timer=setInterval((function(){o.length?(n.session.setScrollTop(o.shift()),n.session.$scrollTop=i):null!=i?(n.session.$scrollTop=-1,n.session.setScrollTop(i),i=null):(n.$timer=clearInterval(n.$timer),n.$scrollAnimation=null,e&&e())}),10)}}},this.scrollToY=function(t){this.scrollTop!==t&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=t)},this.scrollToX=function(t){this.scrollLeft!==t&&(this.scrollLeft=t),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(t,e){this.session.setScrollTop(e),this.session.setScrollLeft(e)},this.scrollBy=function(t,e){e&&this.session.setScrollTop(this.session.getScrollTop()+e),t&&this.session.setScrollLeft(this.session.getScrollLeft()+t)},this.isScrollableBy=function(t,e){return e<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||e>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||t<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||t>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0},this.pixelToScreenCoordinates=function(t,e){var i=this.scroller.getBoundingClientRect(),n=t+this.scrollLeft-i.left-this.$padding,s=n/this.characterWidth,o=Math.floor((e+this.scrollTop-i.top)/this.lineHeight),r=Math.round(s);return{row:o,column:r,side:s-r>0?1:-1,offsetX:n}},this.screenToTextCoordinates=function(t,e){var i=this.scroller.getBoundingClientRect(),n=t+this.scrollLeft-i.left-this.$padding,s=Math.round(n/this.characterWidth);return this.session.screenToDocumentPosition((e+this.scrollTop-i.top)/this.lineHeight,Math.max(s,0),n)},this.textToScreenCoordinates=function(t,e){var i=this.scroller.getBoundingClientRect(),n=this.session.documentToScreenPosition(t,e),s=this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,t)?this.session.$bidiHandler.getPosLeft(n.column):Math.round(n.column*this.characterWidth));return{pageX:i.left+s-this.scrollLeft,pageY:i.top+n.row*this.lineHeight-this.scrollTop}},this.visualizeFocus=function(){n.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){n.removeCssClass(this.container,"ace_focus")},this.showComposition=function(){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText}),this.$keepTextAreaAtCursor=!0,n.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor()},this.setCompositionText=function(){this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(n.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null)},this.setTheme=function(t,e){var i=this;function o(s){if(i.$themeId!=t)return e&&e();if(!s||!s.cssClass)throw new Error("couldn't load module "+t+" or it didn't call define");n.importCssString(s.cssText,s.cssClass,i.container.ownerDocument),i.theme&&n.removeCssClass(i.container,i.theme.cssClass);var o="padding"in s?s.padding:"padding"in(i.theme||{})?4:i.$padding;i.$padding&&o!=i.$padding&&i.setPadding(o),i.$theme=s.cssClass,i.theme=s,n.addCssClass(i.container,s.cssClass),n.setCssClass(i.container,"ace_dark",s.isDark),i.$size&&(i.$size.width=0,i.$updateSizeAsync()),i._dispatchEvent("themeLoaded",{theme:s}),e&&e()}this.$themeId=t,i._dispatchEvent("themeChange",{theme:t}),t&&"string"!=typeof t?o(t):s.loadModule(["theme",t||this.$options.theme.initialValue],o)},this.getTheme=function(){return this.$themeId},this.setStyle=function(t,e){n.setCssClass(this.container,t,!1!==e)},this.unsetStyle=function(t){n.removeCssClass(this.container,t)},this.setCursorStyle=function(t){this.scroller.style.cursor!=t&&(this.scroller.style.cursor=t)},this.setMouseCursor=function(t){this.scroller.style.cursor=t},this.destroy=function(){this.$textLayer.destroy(),this.$cursorLayer.destroy()}}).call(b.prototype),s.defineOptions(b.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(t){this.$textLayer.setShowInvisibles(t)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(t){"number"==typeof t&&(this.$printMarginColumn=t),this.$showPrintMargin=!!t,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(t){this.$gutter.style.display=t?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(t){n.setCssClass(this.$gutter,"ace_fade-fold-widgets",t)},initialValue:!1},showFoldWidgets:{set:function(t){this.$gutterLayer.setShowFoldWidgets(t)},initialValue:!0},showLineNumbers:{set:function(t){this.$gutterLayer.setShowLineNumbers(t),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(t){this.$textLayer.setDisplayIndentGuides(t)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(t){if(!this.$gutterLineHighlight)return this.$gutterLineHighlight=n.createElement("div"),this.$gutterLineHighlight.className="ace_gutter-active-line",void this.$gutter.appendChild(this.$gutterLineHighlight);this.$gutterLineHighlight.style.display=t?"":"none",this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight()},initialValue:!1,value:!0},hScrollBarAlwaysVisible:{set:function(){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(t){"number"==typeof t&&(t+="px"),this.container.style.fontSize=t,this.updateFontSize()},initialValue:12},fontFamily:{set:function(t){this.container.style.fontFamily=t,this.updateFontSize()}},maxLines:{set:function(){this.updateFull()}},minLines:{set:function(){this.updateFull()}},maxPixelHeight:{set:function(){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(t){this.$scrollPastEnd!=(t=+t||0)&&(this.$scrollPastEnd=t,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(t){this.$gutterLayer.$fixedWidth=!!t,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(t){this.setTheme(t)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0}}),e.VirtualRenderer=b})),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],(function(t,i){var n=t("../lib/oop"),s=t("../lib/net"),o=t("../lib/event_emitter").EventEmitter,r=t("../config");function a(t,i){var n=function(t,i){var n=i.src;s.qualifyURL(t);try{return new Blob([n],{type:"application/javascript"})}catch(e){var o=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return o.append(n),o.getBlob("application/javascript")}}(t,i),o=(window.URL||window.webkitURL).createObjectURL(n);return new Worker(o)}var l=function(e,i,n,s,o){if(this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),t.nameToUrl&&!t.toUrl&&(t.toUrl=t.nameToUrl),r.get("packaged")||!t.toUrl)s=s||r.moduleUrl(i.id,"worker");else{var l=this.$normalizePath;s=s||l(t.toUrl("ace/worker/worker.js",null,"_"));var c={};e.forEach((function(e){c[e]=l(t.toUrl(e,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}this.$worker=a(s,i),o&&this.send("importScripts",o),this.$worker.postMessage({init:!0,tlns:c,module:i.id,classname:n}),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){n.implement(this,o),this.onMessage=function(t){var e=t.data;switch(e.type){case"event":this._signal(e.name,{data:e.data});break;case"call":var i=this.callbacks[e.id];i&&(i(e.data),delete this.callbacks[e.id]);break;case"error":this.reportError(e.data);break;case"log":window.console&&console.log&&console.log.apply(console,e.data)}},this.reportError=function(t){window.console&&console.error&&console.error(t)},this.$normalizePath=function(t){return s.qualifyURL(t)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(t,e){this.$worker.postMessage({command:t,args:e})},this.call=function(t,e,i){if(i){var n=this.callbackId++;this.callbacks[n]=i,e.push(n)}this.send(t,e)},this.emit=function(t,e){try{this.$worker.postMessage({event:t,data:{data:e.data}})}catch(i){console.error(i.stack)}},this.attachToDocument=function(t){this.$doc&&this.terminate(),this.$doc=t,this.call("setValue",[t.getValue()]),t.on("change",this.changeListener)},this.changeListener=function(t){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),this.deltaQueue.push(t.start,"insert"==t.action?t.lines:t.end)},this.$sendDeltaQueue=function(){var t=this.deltaQueue;t&&(this.deltaQueue=null,t.length>50&&t.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:t}))}}).call(l.prototype);var c=function(t,e,i){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var n=null,s=!1,a=Object.create(o),l=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(t){l.messageBuffer.push(t),n&&(s?setTimeout(c):c())},this.setEmitSync=function(t){s=t};var c=function(){var t=l.messageBuffer.shift();t.command?n[t.command].apply(n,t.args):t.event&&a._signal(t.event,t.data)};a.postMessage=function(t){l.onMessage({data:t})},a.callback=function(t,e){this.postMessage({type:"call",id:e,data:t})},a.emit=function(t,e){this.postMessage({type:"event",name:t,data:e})},r.loadModule(["worker",e],(function(t){for(n=new t[i](a);l.messageBuffer.length;)c()}))};c.prototype=l.prototype,i.UIWorkerClient=c,i.WorkerClient=l,i.createWorker=a})),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],(function(t,e){var i=t("./range").Range,n=t("./lib/event_emitter").EventEmitter,s=t("./lib/oop"),o=function(t,e,i,n,s,o){var r=this;this.length=e,this.session=t,this.doc=t.getDocument(),this.mainClass=s,this.othersClass=o,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=n,this.$onCursorChange=function(){setTimeout((function(){r.onCursorChange()}))},this.$pos=i;var a=t.getUndoManager().$undoStack||t.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),t.selection.on("changeCursor",this.$onCursorChange)};(function(){s.implement(this,n),this.setup=function(){var t=this,e=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=e.createAnchor(this.$pos.row,this.$pos.column);var s=this.pos;s.$insertRight=!0,s.detach(),s.markerId=n.addMarker(new i(s.row,s.column,s.row,s.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(i){var n=e.createAnchor(i.row,i.column);n.$insertRight=!0,n.detach(),t.others.push(n)})),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var t=this.session,e=this;this.othersActive=!0,this.others.forEach((function(n){n.markerId=t.addMarker(new i(n.row,n.column,n.row,n.column+e.length),e.othersClass,null,!1)}))}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var t=0;t<this.others.length;t++)this.session.removeMarker(this.others[t].markerId)}},this.onUpdate=function(t){if(this.$updating)return this.updateAnchors(t);var e=t;if(e.start.row===e.end.row&&e.start.row===this.pos.row){this.$updating=!0;var n="insert"===t.action?e.end.column-e.start.column:e.start.column-e.end.column,s=e.start.column>=this.pos.column&&e.start.column<=this.pos.column+this.length+1,o=e.start.column-this.pos.column;if(this.updateAnchors(t),s&&(this.length+=n),s&&!this.session.$fromUndo)if("insert"===t.action)for(var r=this.others.length-1;r>=0;r--)this.doc.insertMergedLines(l={row:(a=this.others[r]).row,column:a.column+o},t.lines);else if("remove"===t.action)for(r=this.others.length-1;r>=0;r--){var a,l;this.doc.remove(new i((l={row:(a=this.others[r]).row,column:a.column+o}).row,l.column,l.row,l.column-n))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(t){this.pos.onChange(t);for(var e=this.others.length;e--;)this.others[e].onChange(t);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var t=this,e=this.session,n=function(n,s){e.removeMarker(n.markerId),n.markerId=e.addMarker(new i(n.row,n.column,n.row,n.column+t.length),s,null,!1)};n(this.pos,this.mainClass);for(var s=this.others.length;s--;)n(this.others[s],this.othersClass)}},this.onCursorChange=function(t){if(!this.$updating&&this.session){var e=this.session.selection.getCursor();e.row===this.pos.row&&e.column>=this.pos.column&&e.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",t)):(this.hideOtherMarkers(),this._emit("cursorLeave",t))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var t=this.session.getUndoManager(),e=(t.$undoStack||t.$undostack).length-this.$undoStackDepth,i=0;i<e;i++)t.undo(!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(o.prototype),e.PlaceHolder=o})),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(t,e){var i=t("../lib/event"),n=t("../lib/useragent");function s(t,e){return t.row==e.row&&t.column==e.column}e.onMouseDown=function(t){var e=t.domEvent,o=e.altKey,r=e.shiftKey,a=e.ctrlKey,l=t.getAccelKey(),c=t.getButton();if(a&&n.isMac&&(c=e.button),t.editor.inMultiSelectMode&&2==c)t.editor.textInput.onContextMenu(t.domEvent);else if(a||o||l){if(0===c){var h,d=t.editor,u=d.selection,m=d.inMultiSelectMode,p=t.getDocumentPosition(),b=u.getCursor(),f=t.inSelection()||u.isEmpty()&&s(p,b),g=t.x,y=t.y,v=d.session,Z=d.renderer.pixelToScreenCoordinates(g,y),x=Z;if(d.$mouseHandler.$enableJumpToDef)a&&o||l&&o?h=r?"block":"add":o&&d.$blockSelectEnabled&&(h="block");else if(l&&!o){if(h="add",!m&&r)return}else o&&d.$blockSelectEnabled&&(h="block");if(h&&n.isMac&&e.ctrlKey&&d.$mouseHandler.cancelContextMenu(),"add"==h){if(!m&&f)return;if(!m){var G=u.toOrientedRange();d.addSelectionMarker(G)}var X=u.rangeList.rangeAtPoint(p);d.$blockScrolling++,d.inVirtualSelectionMode=!0,r&&(X=null,d.removeSelectionMarker(G=u.ranges[0]||G)),d.once("mouseup",(function(){var t=u.toOrientedRange();X&&t.isEmpty()&&s(X.cursor,t.cursor)?u.substractPoint(t.cursor):(r?u.substractPoint(G.cursor):G&&(d.removeSelectionMarker(G),u.addRange(G)),u.addRange(t)),d.$blockScrolling--,d.inVirtualSelectionMode=!1}))}else if("block"==h){var w;t.stop(),d.inVirtualSelectionMode=!0;var V=[];d.$blockScrolling++,m&&!l?u.toSingleRange():!m&&l&&(w=u.toOrientedRange(),d.addSelectionMarker(w)),r?Z=v.documentToScreenPosition(u.lead):u.moveToPosition(p),d.$blockScrolling--,x={row:-1,column:-1};i.capture(d.container,(function(t){g=t.clientX,y=t.clientY}),(function(){clearInterval(I),d.removeSelectionMarkers(V),V.length||(V=[u.toOrientedRange()]),d.$blockScrolling++,w&&(d.removeSelectionMarker(w),u.toSingleRange(w));for(var t=0;t<V.length;t++)u.addRange(V[t]);d.inVirtualSelectionMode=!1,d.$mouseHandler.$clickSelection=null,d.$blockScrolling--}));var I=setInterval((function(){!function(){var t=d.renderer.pixelToScreenCoordinates(g,y),e=v.screenToDocumentPosition(t.row,t.column,t.offsetX);s(x,t)&&s(e,u.lead)||(x=t,d.$blockScrolling++,d.selection.moveToPosition(e),d.renderer.scrollCursorIntoView(),d.removeSelectionMarkers(V),V=u.rectangularRangeBlock(x,Z),d.$mouseHandler.$clickSelection&&1==V.length&&V[0].isEmpty()&&(V[0]=d.$mouseHandler.$clickSelection.clone()),V.forEach(d.addSelectionMarker,d),d.updateSelectionMarkers(),d.$blockScrolling--)}()}),20);return t.preventDefault()}}}else 0===c&&t.editor.inMultiSelectMode&&t.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],(function(t,e){e.defaultCommands=[{name:"addCursorAbove",exec:function(t){t.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",exec:function(t){t.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",exec:function(t){t.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",exec:function(t){t.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",exec:function(t){t.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",exec:function(t){t.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",exec:function(t){t.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",exec:function(t){t.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"splitIntoLines",exec:function(t){t.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"alignCursors",exec:function(t){t.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",exec:function(t){t.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],e.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(t){t.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(t){return t&&t.inMultiSelectMode}}];var i=t("../keyboard/hash_handler").HashHandler;e.keyboardHandler=new i(e.multiSelectCommands)})),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],(function(t,e){var i=t("./range_list").RangeList,n=t("./range").Range,s=t("./selection").Selection,o=t("./mouse/multi_select_handler").onMouseDown,r=t("./lib/event"),a=t("./lib/lang"),l=t("./commands/multi_select_commands");e.commands=l.defaultCommands.concat(l.multiSelectCommands);var c=new(0,t("./search").Search),h=t("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(h.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(t,e){if(t){if(!this.inMultiSelectMode&&0===this.rangeCount){var i=this.toOrientedRange();if(this.rangeList.add(i),this.rangeList.add(t),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),e||this.fromOrientedRange(t);this.rangeList.removeAll(),this.rangeList.add(i),this.$onAddRange(i)}t.cursor||(t.cursor=t.end);var n=this.rangeList.add(t);return this.$onAddRange(t),n.length&&this.$onRemoveRange(n),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),e||this.fromOrientedRange(t)}},this.toSingleRange=function(t){t=t||this.ranges[0];var e=this.rangeList.removeAll();e.length&&this.$onRemoveRange(e),t&&this.fromOrientedRange(t)},this.substractPoint=function(t){var e=this.rangeList.substractPoint(t);if(e)return this.$onRemoveRange(e),e[0]},this.mergeOverlappingRanges=function(){var t=this.rangeList.merge();t.length?this.$onRemoveRange(t):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])},this.$onAddRange=function(t){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(t),this._signal("addRange",{range:t})},this.$onRemoveRange=function(t){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var e=this.rangeList.ranges.pop();t.push(e),this.rangeCount=0}for(var i=t.length;i--;){var n=this.ranges.indexOf(t[i]);this.ranges.splice(n,1)}this._signal("removeRange",{ranges:t}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(e=e||this.ranges[0])&&!e.isEqual(this.getRange())&&this.fromOrientedRange(e)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new i,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var t=this.rangeList.ranges,e=t[t.length-1],i=n.fromPoints(t[0].start,e.end);this.toSingleRange(),this.setSelectionRange(i,e.cursor==e.start)}else{i=this.getRange();var s=this.isBackwards(),o=i.start.row,r=i.end.row;if(o==r){if(s)var a=i.end,l=i.start;else a=i.start,l=i.end;return this.addRange(n.fromPoints(l,l)),void this.addRange(n.fromPoints(a,a))}var c=[],h=this.getLineRange(o,!0);h.start.column=i.start.column,c.push(h);for(var d=o+1;d<r;d++)c.push(this.getLineRange(d,!0));(h=this.getLineRange(r,!0)).end.column=i.end.column,c.push(h),c.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var t=this.rangeList.ranges,e=t[t.length-1],i=n.fromPoints(t[0].start,e.end);this.toSingleRange(),this.setSelectionRange(i,e.cursor==e.start)}else{var s=this.session.documentToScreenPosition(this.selectionLead),o=this.session.documentToScreenPosition(this.selectionAnchor);this.rectangularRangeBlock(s,o).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(t,e,i){var s=[],o=t.column<e.column;if(o)var r=t.column,a=e.column,l=t.offsetX,c=e.offsetX;else r=e.column,a=t.column,l=e.offsetX,c=t.offsetX;var h,d,u=t.row<e.row;if(u)var m=t.row,p=e.row;else m=e.row,p=t.row;r<0&&(r=0),m<0&&(m=0),m==p&&(i=!0);for(var b=m;b<=p;b++){var f=n.fromPoints(this.session.screenToDocumentPosition(b,r,l),this.session.screenToDocumentPosition(b,a,c));if(f.isEmpty()){if(g&&(h=f.end).row==(d=g).row&&h.column==d.column)break;var g=f.end}f.cursor=o?f.start:f.end,s.push(f)}if(u&&s.reverse(),!i){for(var y=s.length-1;s[y].isEmpty()&&y>0;)y--;if(y>0)for(var v=0;s[v].isEmpty();)v++;for(var Z=y;Z>=v;Z--)s[Z].isEmpty()&&s.splice(Z,1)}return s}}.call(s.prototype);var d=t("./editor").Editor;function u(t){t.$multiselectOnSessionChange||(t.$onAddRange=t.$onAddRange.bind(t),t.$onRemoveRange=t.$onRemoveRange.bind(t),t.$onMultiSelect=t.$onMultiSelect.bind(t),t.$onSingleSelect=t.$onSingleSelect.bind(t),t.$multiselectOnSessionChange=e.onSessionChange.bind(t),t.$checkMultiselectChange=t.$checkMultiselectChange.bind(t),t.$multiselectOnSessionChange(t),t.on("changeSession",t.$multiselectOnSessionChange),t.on("mousedown",o),t.commands.addCommands(l.defaultCommands),function(t){var e=t.textInput.getElement(),i=!1;function n(){i&&(t.renderer.setMouseCursor(""),i=!1)}r.addListener(e,"keydown",(function(e){t.$blockSelectEnabled&&18==e.keyCode&&!(e.ctrlKey||e.shiftKey||e.metaKey)?i||(t.renderer.setMouseCursor("crosshair"),i=!0):i&&n()})),r.addListener(e,"keyup",n),r.addListener(e,"blur",n)}(t))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(t){t.cursor||(t.cursor=t.end);var e=this.getSelectionStyle();return t.marker=this.session.addMarker(t,"ace_selection",e),this.session.$selectionMarkers.push(t),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,t},this.removeSelectionMarker=function(t){if(t.marker){this.session.removeMarker(t.marker);var e=this.session.$selectionMarkers.indexOf(t);-1!=e&&this.session.$selectionMarkers.splice(e,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(t){for(var e=this.session.$selectionMarkers,i=t.length;i--;){var n=t[i];if(n.marker){this.session.removeMarker(n.marker);var s=e.indexOf(n);-1!=s&&e.splice(s,1)}}this.session.selectionMarkerCount=e.length},this.$onAddRange=function(t){this.addSelectionMarker(t.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(t){this.removeSelectionMarkers(t.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(l.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(l.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(t){var e=t.command,i=t.editor;if(i.multiSelect){if(e.multiSelectAction)"forEach"==e.multiSelectAction?n=i.forEachSelection(e,t.args):"forEachLine"==e.multiSelectAction?n=i.forEachSelection(e,t.args,!0):"single"==e.multiSelectAction?(i.exitMultiSelectMode(),n=e.exec(i,t.args||{})):n=e.multiSelectAction(i,t.args||{});else{var n=e.exec(i,t.args||{});i.multiSelect.addRange(i.multiSelect.toOrientedRange()),i.multiSelect.mergeOverlappingRanges()}return n}},this.forEachSelection=function(t,e,i){if(!this.inVirtualSelectionMode){var n,o=1==i||i&&i.$byLines,r=this.session,a=this.selection,l=(i&&i.keepOrder?a:a.rangeList).ranges;if(!l.length)return t.exec?t.exec(this,e||{}):t(this,e||{});var c=a._eventRegistry;a._eventRegistry={};var h=new s(r);this.inVirtualSelectionMode=!0;for(var d=l.length;d--;){if(o)for(;d>0&&l[d].start.row==l[d-1].end.row;)d--;h.fromOrientedRange(l[d]),h.index=d,this.selection=r.selection=h;var u=t.exec?t.exec(this,e||{}):t(this,e||{});n||void 0===u||(n=u),h.toOrientedRange(l[d])}h.detach(),this.selection=r.selection=a,this.inVirtualSelectionMode=!1,a._eventRegistry=c,a.mergeOverlappingRanges();var m=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),m&&m.from==m.to&&this.renderer.animateScrolling(m.from),n}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var t="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var e=this.multiSelect.rangeList.ranges,i=[],n=0;n<e.length;n++)i.push(this.session.getTextRange(e[n]));var s=this.session.getDocument().getNewLineCharacter();(t=i.join(s)).length==(i.length-1)*s.length&&(t="")}else this.selection.isEmpty()||(t=this.session.getTextRange(this.getSelectionRange()));return t},this.$checkMultiselectChange=function(t,e){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var i=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&e==this.multiSelect.anchor)return;var n=e==this.multiSelect.anchor?i.cursor==i.start?i.end:i.start:i.cursor;n.row==e.row&&this.session.$clipPositionToDocument(n.row,n.column).column==e.column||this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange())}},this.findAll=function(t,e,i){if((e=e||{}).needle=t||e.needle,null==e.needle){var n=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();e.needle=this.session.getTextRange(n)}this.$search.set(e);var s=this.$search.findAll(this.session);if(!s.length)return 0;this.$blockScrolling+=1;var o=this.multiSelect;i||o.toSingleRange(s[0]);for(var r=s.length;r--;)o.addRange(s[r],!0);return n&&o.rangeList.rangeAtPoint(n.start)&&o.addRange(n,!0),this.$blockScrolling-=1,s.length},this.selectMoreLines=function(t,e){var i=this.selection.toOrientedRange(),s=i.cursor==i.end,o=this.session.documentToScreenPosition(i.cursor);this.selection.$desiredColumn&&(o.column=this.selection.$desiredColumn);var r,a=this.session.screenToDocumentPosition(o.row+t,o.column);if(i.isEmpty())c=a;else var l=this.session.documentToScreenPosition(s?i.end:i.start),c=this.session.screenToDocumentPosition(l.row+t,l.column);if(s?(r=n.fromPoints(a,c)).cursor=r.start:(r=n.fromPoints(c,a)).cursor=r.end,r.desiredColumn=o.column,this.selection.inMultiSelectMode){if(e)var h=i.cursor}else this.selection.addRange(i);this.selection.addRange(r),h&&this.selection.substractPoint(h)},this.transposeSelections=function(t){for(var e=this.session,i=e.multiSelect,n=i.ranges,s=n.length;s--;)if((a=n[s]).isEmpty()){var o=e.getWordRange(a.start.row,a.start.column);a.start.row=o.start.row,a.start.column=o.start.column,a.end.row=o.end.row,a.end.column=o.end.column}i.mergeOverlappingRanges();var r=[];for(s=n.length;s--;)r.unshift(e.getTextRange(a=n[s]));for(t<0?r.unshift(r.pop()):r.push(r.shift()),s=n.length;s--;){var a;o=(a=n[s]).clone(),e.replace(a,r[s]),a.start.row=o.start.row,a.start.column=o.start.column}},this.selectMore=function(t,e,i){var n=this.session,s=n.multiSelect.toOrientedRange();if(!s.isEmpty()||((s=n.getWordRange(s.start.row,s.start.column)).cursor=-1==t?s.start:s.end,this.multiSelect.addRange(s),!i)){var o=n.getTextRange(s),r=function(t,e,i){return c.$options.wrap=!0,c.$options.needle=e,c.$options.backwards=-1==i,c.find(t)}(n,o,t);r&&(r.cursor=-1==t?r.start:r.end,this.$blockScrolling+=1,this.session.unfold(r),this.multiSelect.addRange(r),this.$blockScrolling-=1,this.renderer.scrollCursorIntoView(null,.5)),e&&this.multiSelect.substractPoint(s.cursor)}},this.alignCursors=function(){var t=this.session,e=t.multiSelect,i=e.ranges,s=-1,o=i.filter((function(t){if(t.cursor.row==s)return!0;s=t.cursor.row}));if(i.length&&o.length!=i.length-1){o.forEach((function(t){e.substractPoint(t.cursor)}));var r=0,l=1/0,c=i.map((function(e){var i=e.cursor,n=t.getLine(i.row).substr(i.column).search(/\S/g);return-1==n&&(n=0),i.column>r&&(r=i.column),n<l&&(l=n),n}));i.forEach((function(e,i){var s=e.cursor,o=r-s.column,h=c[i]-l;o>h?t.insert(s,a.stringRepeat(" ",o-h)):t.remove(new n(s.row,s.column,s.row,s.column-o+h)),e.start.column=e.end.column=r,e.start.row=e.end.row=s.row,e.cursor=e.end})),e.fromOrientedRange(i[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var h=this.selection.getRange(),d=h.start.row,u=h.end.row,m=d==u;if(m){var p,b=this.session.getLength();do{p=this.session.getLine(u)}while(/[=:]/.test(p)&&++u<b);do{p=this.session.getLine(d)}while(/[=:]/.test(p)&&--d>0);d<0&&(d=0),u>=b&&(u=b-1)}var f=this.session.removeFullLines(d,u);f=this.$reAlignText(f,m),this.session.insert({row:d,column:0},f.join("\n")+"\n"),m||(h.start.column=0,h.end.column=f[f.length-1].length),this.selection.setRange(h)}},this.$reAlignText=function(t,e){var i,n,s,o=!0,r=!0;return t.map((function(t){var e=t.match(/(\s*)(.*?)(\s*)([=:].*)/);return e?null==i?(i=e[1].length,n=e[2].length,s=e[3].length,e):(i+n+s!=e[1].length+e[2].length+e[3].length&&(r=!1),i!=e[1].length&&(o=!1),i>e[1].length&&(i=e[1].length),n<e[2].length&&(n=e[2].length),s>e[3].length&&(s=e[3].length),e):[t]})).map(e?c:o?r?function(t){return t[2]?l(i+n-t[2].length)+t[2]+l(s)+t[4].replace(/^([=:])\s+/,"$1 "):t[0]}:c:function(t){return t[2]?l(i)+t[2]+l(s)+t[4].replace(/^([=:])\s+/,"$1 "):t[0]});function l(t){return a.stringRepeat(" ",t)}function c(t){return t[2]?l(i)+t[2]+l(n-t[2].length+s)+t[4].replace(/^([=:])\s+/,"$1 "):t[0]}}}).call(d.prototype),e.onSessionChange=function(t){var e=t.session;e&&!e.multiSelect&&(e.$selectionMarkers=[],e.selection.$initRangeList(),e.multiSelect=e.selection),this.multiSelect=e&&e.multiSelect;var i=t.oldSession;i&&(i.multiSelect.off("addRange",this.$onAddRange),i.multiSelect.off("removeRange",this.$onRemoveRange),i.multiSelect.off("multiSelect",this.$onMultiSelect),i.multiSelect.off("singleSelect",this.$onSingleSelect),i.multiSelect.lead.off("change",this.$checkMultiselectChange),i.multiSelect.anchor.off("change",this.$checkMultiselectChange)),e&&(e.multiSelect.on("addRange",this.$onAddRange),e.multiSelect.on("removeRange",this.$onRemoveRange),e.multiSelect.on("multiSelect",this.$onMultiSelect),e.multiSelect.on("singleSelect",this.$onSingleSelect),e.multiSelect.lead.on("change",this.$checkMultiselectChange),e.multiSelect.anchor.on("change",this.$checkMultiselectChange)),e&&this.inMultiSelectMode!=e.selection.inMultiSelectMode&&(e.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},e.MultiSelect=u,t("./config").defineOptions(d.prototype,"editor",{enableMultiselect:{set:function(t){u(this),t?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",o)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",o))},value:!0},enableBlockSelect:{set:function(t){this.$blockSelectEnabled=t},value:!0}})})),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],(function(t,e){var i=t("../../range").Range,n=e.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(t,e,i){var n=t.getLine(i);return this.foldingStartMarker.test(n)?"start":"markbeginend"==e&&this.foldingStopMarker&&this.foldingStopMarker.test(n)?"end":""},this.getFoldWidgetRange=function(){return null},this.indentationBlock=function(t,e,n){var s=/\S/,o=t.getLine(e),r=o.search(s);if(-1!=r){for(var a=n||o.length,l=t.getLength(),c=e,h=e;++e<l;){var d=t.getLine(e).search(s);if(-1!=d){if(d<=r)break;h=e}}if(h>c){var u=t.getLine(h).length;return new i(c,a,h,u)}}},this.openingBracketBlock=function(t,e,n,s,o){var r={row:n,column:s+1},a=t.$findClosingBracket(e,r,o);if(a){var l=t.foldWidgets[a.row];return null==l&&(l=t.getFoldWidget(a.row)),"start"==l&&a.row>r.row&&(a.row--,a.column=t.getLine(a.row).length),i.fromPoints(r,a)}},this.closingBracketBlock=function(t,e,n,s){var o={row:n,column:s},r=t.$findOpeningBracket(e,o);if(r)return r.column++,o.column--,i.fromPoints(r,o)}}).call(n.prototype)})),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(t,e){e.isDark=!1,e.cssClass="ace-tm",e.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t("../lib/dom").importCssString(e.cssText,e.cssClass)})),ace.define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],(function(t,i){t("./lib/oop");var n=t("./lib/dom");function s(t){this.session=t,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}t("./range"),function(){this.getRowLength=function(t){var e;return e=this.lineWidgets&&this.lineWidgets[t]&&this.lineWidgets[t].rowCount||0,this.$useWrapMode&&this.$wrapData[t]?this.$wrapData[t].length+1+e:1+e},this.$getWidgetScreenLength=function(){var t=0;return this.lineWidgets.forEach((function(e){e&&e.rowCount&&!e.hidden&&(t+=e.rowCount)})),t},this.$onChangeEditor=function(t){this.attach(t.editor)},this.attach=function(t){t&&t.widgetManager&&t.widgetManager!=this&&t.widgetManager.detach(),this.editor!=t&&(this.detach(),this.editor=t,t&&(t.widgetManager=this,t.renderer.on("beforeRender",this.measureWidgets),t.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var e=this.session.lineWidgets;e&&e.forEach((function(t){t&&t.el&&t.el.parentNode&&(t._inDocument=!1,t.el.parentNode.removeChild(t.el))}))}},this.updateOnFold=function(t,e){var i=e.lineWidgets;if(i&&t.action){for(var n=t.data,s=n.start.row,o=n.end.row,r="add"==t.action,a=s+1;a<o;a++)i[a]&&(i[a].hidden=r);i[o]&&(r?i[s]?i[o].hidden=r:i[s]=i[o]:(i[s]==i[o]&&(i[s]=void 0),i[o].hidden=r))}},this.updateOnChange=function(t){var e=this.session.lineWidgets;if(e){var i=t.start.row,n=t.end.row-i;if(0===n);else if("remove"==t.action)e.splice(i+1,n).forEach((function(t){t&&this.removeLineWidget(t)}),this),this.$updateRows();else{var s=new Array(n);s.unshift(i,0),e.splice.apply(e,s),this.$updateRows()}}},this.$updateRows=function(){var t=this.session.lineWidgets;if(t){var e=!0;t.forEach((function(t,i){if(t)for(e=!1,t.row=i;t.$oldWidget;)t.$oldWidget.row=i,t=t.$oldWidget})),e&&(this.session.lineWidgets=null)}},this.addLineWidget=function(t){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var e=this.session.lineWidgets[t.row];e&&(t.$oldWidget=e,e.el&&e.el.parentNode&&(e.el.parentNode.removeChild(e.el),e._inDocument=!1)),this.session.lineWidgets[t.row]=t,t.session=this.session;var i=this.editor.renderer;t.html&&!t.el&&(t.el=n.createElement("div"),t.el.innerHTML=t.html),t.el&&(n.addCssClass(t.el,"ace_lineWidgetContainer"),t.el.style.position="absolute",t.el.style.zIndex=5,i.container.appendChild(t.el),t._inDocument=!0),t.coverGutter||(t.el.style.zIndex=3),null==t.pixelHeight&&(t.pixelHeight=t.el.offsetHeight),null==t.rowCount&&(t.rowCount=t.pixelHeight/i.layerConfig.lineHeight);var s=this.session.getFoldAt(t.row,0);if(t.$fold=s,s){var o=this.session.lineWidgets;t.row!=s.end.row||o[s.start.row]?t.hidden=!0:o[s.start.row]=t}return this.session._emit("changeFold",{data:{start:{row:t.row}}}),this.$updateRows(),this.renderWidgets(null,i),this.onWidgetChanged(t),t},this.removeLineWidget=function(t){if(t._inDocument=!1,t.session=null,t.el&&t.el.parentNode&&t.el.parentNode.removeChild(t.el),t.editor&&t.editor.destroy)try{t.editor.destroy()}catch(e){}if(this.session.lineWidgets){var i=this.session.lineWidgets[t.row];if(i==t)this.session.lineWidgets[t.row]=t.$oldWidget,t.$oldWidget&&this.onWidgetChanged(t.$oldWidget);else for(;i;){if(i.$oldWidget==t){i.$oldWidget=t.$oldWidget;break}i=i.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:t.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(t){for(var e=this.session.lineWidgets,i=e&&e[t],n=[];i;)n.push(i),i=i.$oldWidget;return n},this.onWidgetChanged=function(t){this.session._changedWidgets.push(t),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(t,e){var i=this.session._changedWidgets,n=e.layerConfig;if(i&&i.length){for(var s=1/0,o=0;o<i.length;o++){var r=i[o];if(r&&r.el&&r.session==this.session){if(!r._inDocument){if(this.session.lineWidgets[r.row]!=r)continue;r._inDocument=!0,e.container.appendChild(r.el)}r.h=r.el.offsetHeight,r.fixedWidth||(r.w=r.el.offsetWidth,r.screenWidth=Math.ceil(r.w/n.characterWidth));var a=r.h/n.lineHeight;r.coverLine&&(a-=this.session.getRowLineCount(r.row))<0&&(a=0),r.rowCount!=a&&(r.rowCount=a,r.row<s&&(s=r.row))}}s!=1/0&&(this.session._emit("changeFold",{data:{start:{row:s}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(t,e){var i=e.layerConfig,n=this.session.lineWidgets;if(n){for(var s=Math.min(this.firstRow,i.firstRow),o=Math.max(this.lastRow,i.lastRow,n.length);s>0&&!n[s];)s--;this.firstRow=i.firstRow,this.lastRow=i.lastRow,e.$cursorLayer.config=i;for(var r=s;r<=o;r++){var a=n[r];if(a&&a.el)if(a.hidden)a.el.style.top=-100-(a.pixelHeight||0)+"px";else{a._inDocument||(a._inDocument=!0,e.container.appendChild(a.el));var l=e.$cursorLayer.getPixelPosition({row:r,column:0},!0).top;a.coverLine||(l+=i.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-i.offset+"px";var c=a.coverGutter?0:e.gutterWidth;a.fixedWidth||(c-=e.scrollLeft),a.el.style.left=c+"px",a.fullWidth&&a.screenWidth&&(a.el.style.minWidth=i.width+2*i.padding+"px"),a.el.style.right=a.fixedWidth?e.scrollBar.getWidth()+"px":""}}}}}.call(s.prototype),i.LineWidgets=s})),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],(function(t,e){var i=t("../line_widgets").LineWidgets,n=t("../lib/dom"),s=t("../range").Range;e.showErrorMarker=function(t,e){var o=t.session;o.widgetManager||(o.widgetManager=new i(o),o.widgetManager.attach(t));var r=t.getCursorPosition(),a=r.row,l=o.widgetManager.getWidgetsAtRow(a).filter((function(t){return"errorMarker"==t.type}))[0];l?l.destroy():a-=e;var c,h=function(t,e,i){var n=t.getAnnotations().sort(s.comparePoints);if(n.length){var o=function(t,e,i){for(var n=0,s=t.length-1;n<=s;){var o=n+s>>1,r=i(e,t[o]);if(r>0)n=o+1;else{if(!(r<0))return o;s=o-1}}return-(n+1)}(n,{row:e,column:-1},s.comparePoints);o<0&&(o=-o-1),o>=n.length?o=i>0?0:n.length-1:0===o&&i<0&&(o=n.length-1);var r=n[o];if(r&&i){if(r.row===e){do{r=n[o+=i]}while(r&&r.row===e);if(!r)return n.slice()}var a=[];e=r.row;do{a[i<0?"unshift":"push"](r),r=n[o+=i]}while(r&&r.row==e);return a.length&&a}}}(o,a,e);if(h){var d=h[0];r.column=(d.pos&&"number"!=typeof d.column?d.pos.sc:d.column)||0,r.row=d.row,c=t.renderer.$gutterLayer.$annotations[r.row]}else{if(l)return;c={text:["Looks good!"],className:"ace_ok"}}t.session.unfold(r.row),t.selection.moveToPosition(r);var u={row:r.row,fixedWidth:!0,coverGutter:!0,el:n.createElement("div"),type:"errorMarker"},m=u.el.appendChild(n.createElement("div")),p=u.el.appendChild(n.createElement("div"));p.className="error_widget_arrow "+c.className;var b=t.renderer.$cursorLayer.getPixelPosition(r).left;p.style.left=b+t.renderer.gutterWidth-5+"px",u.el.className="error_widget_wrapper",m.className="error_widget "+c.className,m.innerHTML=c.text.join("<br>"),m.appendChild(n.createElement("div"));var f=function(t,e,i){if(0===e&&("esc"===i||"return"===i))return u.destroy(),{command:"null"}};u.destroy=function(){t.$mouseHandler.isMousePressed||(t.keyBinding.removeKeyboardHandler(f),o.widgetManager.removeLineWidget(u),t.off("changeSelection",u.destroy),t.off("changeSession",u.destroy),t.off("mouseup",u.destroy),t.off("change",u.destroy))},t.keyBinding.addKeyboardHandler(f),t.on("changeSelection",u.destroy),t.on("changeSession",u.destroy),t.on("mouseup",u.destroy),t.on("change",u.destroy),t.session.widgetManager.addLineWidget(u),u.el.onmousedown=t.focus.bind(t),t.renderer.scrollCursorIntoView(null,.5,{bottom:u.el.offsetHeight})},n.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")})),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],(function(t,e){t("./lib/fixoldbrowsers");var i=t("./lib/dom"),n=t("./lib/event"),s=t("./editor").Editor,o=t("./edit_session").EditSession,r=t("./undomanager").UndoManager,a=t("./virtual_renderer").VirtualRenderer;t("./worker/worker_client"),t("./keyboard/hash_handler"),t("./placeholder"),t("./multi_select"),t("./mode/folding/fold_mode"),t("./theme/textmate"),t("./ext/error_marker"),e.config=t("./config"),e.acequire=t,e.edit=function(t){if("string"==typeof t){var o=t;if(!(t=document.getElementById(o)))throw new Error("ace.edit can't find div #"+o)}if(t&&t.env&&t.env.editor instanceof s)return t.env.editor;var r="";if(t&&/input|textarea/i.test(t.tagName)){var l=t;r=l.value,t=i.createElement("pre"),l.parentNode.replaceChild(t,l)}else t&&(r=i.getInnerText(t),t.innerHTML="");var c=e.createEditSession(r),h=new s(new a(t));h.setSession(c);var d={document:c,editor:h,onResize:h.resize.bind(h,null)};return l&&(d.textarea=l),n.addListener(window,"resize",d.onResize),h.on("destroy",(function(){n.removeListener(window,"resize",d.onResize),d.editor.container.env=null})),h.container.env=h.env=d,h},e.createEditSession=function(t,e){var i=new o(t,e);return i.setUndoManager(new r),i},e.EditSession=o,e.UndoManager=r,e.version="1.2.9"})),ace.acequire(["ace/ace"],(function(t){for(var e in t&&(t.config.init(!0),t.define=ace.define),window.ace||(window.ace=t),t)t.hasOwnProperty(e)&&(window.ace[e]=t[e])}));var brace=window.ace.acequire("ace/ace");const zeaParamWidgetCodeCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-code{color:var(--color-foreground-1)}.editor-container{min-width:150px;min-height:100px}",ZeaParamWidgetCode=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}keydownHandler(t){t.ctrlKey&&"s"==t.key?(this.onInput(),t.preventDefault()):"Enter"!=t.key&&46!=t.keyCode||this.resetEditorHeight(),t.stopPropagation()}componentDidLoad(){this.setUpInputs(),this.onValueChanged()}async setUpInputs(){this.editor=ace.edit(this.editorContainer),await import("./p-c0c1b0c3.mjs"),this.editor.setTheme("ace/theme/chrome"),await import("./p-83b73927.mjs"),this.editor.session.setMode("ace/mode/javascript"),this.parameter.on("valueChanged",()=>{this.onValueChanged()})}onInput(){const t=this.editor.getValue();this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change)),this.resetEditorHeight()}onChange(){this.onInput(),this.change=void 0}resetEditorHeight(){}componentDidRender(){this.editor&&this.editor.resize()}onValueChanged(){this.change||this.editor.session.setValue(this.parameter.getValue()),this.resetEditorHeight()}render(){return console.log("rendering",this.editorHeight),h("div",{class:"zea-param-widget-code",ref:t=>this.container=t},h("div",{style:{height:this.editorHeight+"px"},class:"editor-container",ref:t=>this.editorContainer=t}))}static get style(){return zeaParamWidgetCodeCss}};uxFactory.registerWidget("zea-param-widget-code",t=>t.constructor.name==ve.name);
/*!
 * iro.js v5.1.8
 * 2016-2020 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */
var n,u$2,t$2,i$7,r$1,o$1,f$3={},e$2=[],c$1=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function s$2(t,e){for(var i in e)t[i]=e[i];return t}function a$3(t){var e=t.parentNode;e&&e.removeChild(t)}function h$5(t,e,i){var n,s,o,r,a=arguments;if(e=s$2({},e),arguments.length>3)for(i=[i],n=3;n<arguments.length;n++)i.push(a[n]);if(null!=i&&(e.children=i),null!=t&&null!=t.defaultProps)for(s in t.defaultProps)void 0===e[s]&&(e[s]=t.defaultProps[s]);return r=e.key,null!=(o=e.ref)&&delete e.ref,null!=r&&delete e.key,v$2(t,e,r,o)}function v$2(t,e,i,s){var o={type:t,props:e,key:i,ref:s,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return n.vnode&&n.vnode(o),o}function d$2(t){return t.children}function y$4(t){if(null==t||"boolean"==typeof t)return null;if("string"==typeof t||"number"==typeof t)return v$2(null,t,null,null);if(null!=t.__e||null!=t.__c){var e=v$2(t.type,t.props,t.key,null);return e.__e=t.__e,e}return t}function m$4(t,e){this.props=t,this.context=e}function w$3(t,e){if(null==e)return t.__p?w$3(t.__p,t.__p.__k.indexOf(t)+1):null;for(var i;e<t.__k.length;e++)if(null!=(i=t.__k[e])&&null!=i.__e)return i.__e;return"function"==typeof t.type?w$3(t):null}function g$2(t){var e,i;if(null!=(t=t.__p)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(i=t.__k[e])&&null!=i.__e){t.__e=t.__c.base=i.__e;break}return g$2(t)}}function k$3(t){(!t.__d&&(t.__d=!0)&&1===u$2.push(t)||i$7!==n.debounceRendering)&&(i$7=n.debounceRendering,(n.debounceRendering||t$2)(_$2))}function _$2(){var t,e,i,n,s,o,r,a;for(u$2.sort((function(t,e){return e.__v.__b-t.__v.__b}));t=u$2.pop();)t.__d&&(i=void 0,n=void 0,o=(s=(e=t).__v).__e,r=e.__P,a=e.u,e.u=!1,r&&(i=[],n=$$2(r,s,s$2({},s),e.__n,void 0!==r.ownerSVGElement,null,i,a,null==o?w$3(s):o),j$1(i,s),n!=o&&g$2(s)))}function b$1(t,e,i,n,s,o,r,a,l){var c,h,d,u,m,p,b,f=i&&i.__k||e$2,g=f.length;if(a==f$3&&(a=null!=o?o[0]:g?w$3(i,0):null),c=0,e.__k=x$2(e.__k,(function(i){if(null!=i){if(i.__p=e,i.__b=e.__b+1,null===(d=f[c])||d&&i.key==d.key&&i.type===d.type)f[c]=void 0;else for(h=0;h<g;h++){if((d=f[h])&&i.key==d.key&&i.type===d.type){f[h]=void 0;break}d=null}if(u=$$2(t,i,d=d||f$3,n,s,o,r,null,a,l),(h=i.ref)&&d.ref!=h&&(b||(b=[])).push(h,i.__c||u,i),null!=u){if(null==p&&(p=u),null!=i.l)u=i.l,i.l=null;else if(o==d||u!=a||null==u.parentNode){t:if(null==a||a.parentNode!==t)t.appendChild(u);else{for(m=a,h=0;(m=m.nextSibling)&&h<g;h+=2)if(m==u)break t;t.insertBefore(u,a)}"option"==e.type&&(t.value="")}a=u.nextSibling,"function"==typeof e.type&&(e.l=u)}}return c++,i})),e.__e=p,null!=o&&"function"!=typeof e.type)for(c=o.length;c--;)null!=o[c]&&a$3(o[c]);for(c=g;c--;)null!=f[c]&&D$2(f[c],f[c]);if(b)for(c=0;c<b.length;c++)A$3(b[c],b[++c],b[++c])}function x$2(t,e,i){if(null==i&&(i=[]),null==t||"boolean"==typeof t)e&&i.push(e(null));else if(Array.isArray(t))for(var n=0;n<t.length;n++)x$2(t[n],e,i);else i.push(e?e(y$4(t)):t);return i}function C$2(t,e,i,n,s){var o;for(o in i)o in e||N$3(t,o,null,i[o],n);for(o in e)s&&"function"!=typeof e[o]||"value"===o||"checked"===o||i[o]===e[o]||N$3(t,o,e[o],i[o],n)}function P$2(t,e,i){"-"===e[0]?t.setProperty(e,i):t[e]="number"==typeof i&&!1===c$1.test(e)?i+"px":null==i?"":i}function N$3(t,e,i,n,s){var o,r,a,l,c;if("key"===(e=s?"className"===e?"class":e:"class"===e?"className":e)||"children"===e);else if("style"===e)if(o=t.style,"string"==typeof i)o.cssText=i;else{if("string"==typeof n&&(o.cssText="",n=null),n)for(r in n)i&&r in i||P$2(o,r,"");if(i)for(a in i)n&&i[a]===n[a]||P$2(o,a,i[a])}else"o"===e[0]&&"n"===e[1]?(l=e!==(e=e.replace(/Capture$/,"")),c=e.toLowerCase(),e=(c in t?c:e).slice(2),i?(n||t.addEventListener(e,T$2,l),(t.t||(t.t={}))[e]=i):t.removeEventListener(e,T$2,l)):"list"!==e&&"tagName"!==e&&"form"!==e&&!s&&e in t?t[e]=null==i?"":i:"function"!=typeof i&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==i||!1===i?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),i):null==i||!1===i?t.removeAttribute(e):t.setAttribute(e,i))}function T$2(t){return this.t[t.type](n.event?n.event(t):t)}function $$2(t,e,i,s,o,r,a,l,c,h){var d,u,m,p,b,f,g,y,v,Z,x=e.type;if(void 0!==e.constructor)return null;(d=n.__b)&&d(e);try{t:if("function"==typeof x){if(y=e.props,v=(d=x.contextType)&&s[d.__c],Z=d?v?v.props.value:d.__p:s,i.__c?g=(u=e.__c=i.__c).__p=u.__E:("prototype"in x&&x.prototype.render?e.__c=u=new x(y,Z):(e.__c=u=new m$4(y,Z),u.constructor=x,u.render=H$3),v&&v.sub(u),u.props=y,u.state||(u.state={}),u.context=Z,u.__n=s,m=u.__d=!0,u.__h=[]),null==u.__s&&(u.__s=u.state),null!=x.getDerivedStateFromProps&&s$2(u.__s==u.state?u.__s=s$2({},u.__s):u.__s,x.getDerivedStateFromProps(y,u.__s)),m)null==x.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&a.push(u);else{if(null==x.getDerivedStateFromProps&&null==l&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(y,Z),!l&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(y,u.__s,Z)){for(u.props=y,u.state=u.__s,u.__d=!1,u.__v=e,e.__e=null!=c?c!==i.__e?c:i.__e:null,e.__k=i.__k,d=0;d<e.__k.length;d++)e.__k[d]&&(e.__k[d].__p=e);break t}null!=u.componentWillUpdate&&u.componentWillUpdate(y,u.__s,Z)}for(p=u.props,b=u.state,u.context=Z,u.props=y,u.state=u.__s,(d=n.__r)&&d(e),u.__d=!1,u.__v=e,u.__P=t,d=u.render(u.props,u.state,u.context),e.__k=x$2(null!=d&&d.type==d$2&&null==d.key?d.props.children:d),null!=u.getChildContext&&(s=s$2(s$2({},s),u.getChildContext())),m||null==u.getSnapshotBeforeUpdate||(f=u.getSnapshotBeforeUpdate(p,b)),b$1(t,e,i,s,o,r,a,c,h),u.base=e.__e;d=u.__h.pop();)u.__s&&(u.state=u.__s),d.call(u);m||null==p||null==u.componentDidUpdate||u.componentDidUpdate(p,b,f),g&&(u.__E=u.__p=null)}else e.__e=z$3(i.__e,e,i,s,o,r,a,h);(d=n.diffed)&&d(e)}catch(t){n.__e(t,e,i)}return e.__e}function j$1(t,e){for(var i;i=t.pop();)try{i.componentDidMount()}catch(t){n.__e(t,i.__v)}n.__c&&n.__c(e)}function z$3(t,e,i,n,s,o,r,a){var l,c,h,d,u=i.props,m=e.props;if(s="svg"===e.type||s,null==t&&null!=o)for(l=0;l<o.length;l++)if(null!=(c=o[l])&&(null===e.type?3===c.nodeType:c.localName===e.type)){t=c,o[l]=null;break}if(null==t){if(null===e.type)return document.createTextNode(m);t=s?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),o=null}return null===e.type?u!==m&&(null!=o&&(o[o.indexOf(t)]=null),t.data=m):e!==i&&(null!=o&&(o=e$2.slice.call(t.childNodes)),h=(u=i.props||f$3).dangerouslySetInnerHTML,d=m.dangerouslySetInnerHTML,a||(d||h)&&(d&&h&&d.__html==h.__html||(t.innerHTML=d&&d.__html||"")),C$2(t,m,u,s,a),e.__k=e.props.children,d||b$1(t,e,i,n,"foreignObject"!==e.type&&s,o,r,f$3,a),a||("value"in m&&void 0!==m.value&&m.value!==t.value&&(t.value=null==m.value?"":m.value),"checked"in m&&void 0!==m.checked&&m.checked!==t.checked&&(t.checked=m.checked))),t}function A$3(t,e,i){try{"function"==typeof t?t(e):t.current=e}catch(t){n.__e(t,i)}}function D$2(t,e,i){var s,o,r;if(n.unmount&&n.unmount(t),(s=t.ref)&&A$3(s,null,e),i||"function"==typeof t.type||(i=null!=(o=t.__e)),t.__e=t.l=null,null!=(s=t.__c)){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(t){n.__e(t,e)}s.base=s.__P=null}if(s=t.__k)for(r=0;r<s.length;r++)s[r]&&D$2(s[r],e,i);null!=o&&a$3(o)}function H$3(t,e,i){return this.constructor(t,i)}function I$2(t,e,i){var s,o,r;n.__p&&n.__p(t,e),o=(s=i===r$1)?null:i&&i.__k||e.__k,t=h$5(d$2,null,[t]),r=[],$$2(e,s?e.__k=t:(i||e).__k=t,o||f$3,f$3,void 0!==e.ownerSVGElement,i&&!s?[i]:o?null:e$2.slice.call(e.childNodes),r,!1,i||f$3,s),j$1(r,t)}n={},m$4.prototype.setState=function(t,e){var i=this.__s!==this.state&&this.__s||(this.__s=s$2({},this.state));("function"!=typeof t||(t=t(i,this.props)))&&s$2(i,t),null!=t&&this.__v&&(this.u=!1,e&&this.__h.push(e),k$3(this))},m$4.prototype.forceUpdate=function(t){this.__v&&(t&&this.__h.push(t),this.u=!0,k$3(this))},m$4.prototype.render=d$2,u$2=[],t$2="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,i$7=n.debounceRendering,n.__e=function(t,e){for(var i;e=e.__p;)if((i=e.__c)&&!i.__p)try{if(i.constructor&&null!=i.constructor.getDerivedStateFromError)i.setState(i.constructor.getDerivedStateFromError(t));else{if(null==i.componentDidCatch)continue;i.componentDidCatch(t)}return k$3(i.__E=i)}catch(e){t=e}throw t},r$1=f$3,o$1=0;var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH_3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH_4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",REGEX_FUNCTIONAL_RGB=new RegExp("rgb"+PERMISSIVE_MATCH_3),REGEX_FUNCTIONAL_RGBA=new RegExp("rgba"+PERMISSIVE_MATCH_4),REGEX_FUNCTIONAL_HSL=new RegExp("hsl"+PERMISSIVE_MATCH_3),REGEX_FUNCTIONAL_HSLA=new RegExp("hsla"+PERMISSIVE_MATCH_4),HEX_START="^(?:#?|0x?)",HEX_INT_SINGLE="([0-9a-fA-F]{1})",HEX_INT_DOUBLE="([0-9a-fA-F]{2})",REGEX_HEX_3=new RegExp(HEX_START+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+"$"),REGEX_HEX_4=new RegExp(HEX_START+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+HEX_INT_SINGLE+"$"),REGEX_HEX_6=new RegExp(HEX_START+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+"$"),REGEX_HEX_8=new RegExp(HEX_START+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+HEX_INT_DOUBLE+"$"),KELVIN_MIN=1e3,KELVIN_MAX=4e4,log$1=Math.log,round=Math.round,floor=Math.floor;function parseUnit(t,e){var i=t.indexOf("%")>-1,n=parseFloat(t);return i?e/100*n:n}function parseHexInt(t){return parseInt(t,16)}function intToHex(t){return t.toString(16).padStart(2,"0")}var IroColor=function(t,e){this.$={h:0,s:0,v:0,a:1},t&&this.set(t),this.onChange=e,this.initialValue=Object.assign({},this.$)},prototypeAccessors={hsv:{configurable:!0},hsva:{configurable:!0},hue:{configurable:!0},saturation:{configurable:!0},value:{configurable:!0},alpha:{configurable:!0},kelvin:{configurable:!0},rgb:{configurable:!0},rgba:{configurable:!0},hsl:{configurable:!0},hsla:{configurable:!0},rgbString:{configurable:!0},rgbaString:{configurable:!0},hexString:{configurable:!0},hex8String:{configurable:!0},hslString:{configurable:!0},hslaString:{configurable:!0}};IroColor.prototype.set=function(t){if("string"==typeof t)/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(t)?this.hexString=t:/^rgba?/.test(t)?this.rgbString=t:/^hsla?/.test(t)&&(this.hslString=t);else{if("object"!=typeof t)throw new Error("Invalid color value");t instanceof IroColor?this.hsv=t.hsv:"object"==typeof t&&"r"in t&&"g"in t&&"b"in t?this.rgb=t:"object"==typeof t&&"h"in t&&"s"in t&&"v"in t?this.hsv=t:"object"==typeof t&&"h"in t&&"s"in t&&"l"in t&&(this.hsl=t)}},IroColor.prototype.setChannel=function(t,e,i){var n;this[t]=Object.assign({},this[t],((n={})[e]=i,n))},IroColor.prototype.reset=function(){this.hsva=this.initialValue},IroColor.prototype.clone=function(){return new IroColor(this)},IroColor.prototype.unbind=function(){this.onChange=void 0},IroColor.hsvToRgb=function(t){var e=t.h/60,i=t.s/100,n=t.v/100,s=floor(e),o=e-s,r=n*(1-i),a=n*(1-o*i),l=n*(1-(1-o)*i),c=s%6;return{r:255*[n,a,r,r,l,n][c],g:255*[l,n,n,a,r,r][c],b:255*[r,r,l,n,n,a][c]}},IroColor.rgbToHsv=function(t){var e=t.r/255,i=t.g/255,n=t.b/255,s=Math.max(e,i,n),o=Math.min(e,i,n),r=s-o,a=0,l=s,c=0===s?0:r/s;switch(s){case o:a=0;break;case e:a=(i-n)/r+(i<n?6:0);break;case i:a=(n-e)/r+2;break;case n:a=(e-i)/r+4}return{h:60*a,s:100*c,v:100*l}},IroColor.hsvToHsl=function(t){var e=t.s/100,i=t.v/100,n=(2-e)*i,s=n<=1?n:2-n;return{h:t.h,s:100*(s<1e-9?0:e*i/s),l:50*n}},IroColor.hslToHsv=function(t){var e=2*t.l,i=t.s*(e<=100?e:200-e)/100;return{h:t.h,s:100*(e+i<1e-9?0:2*i/(e+i)),v:(e+i)/2}},IroColor.kelvinToRgb=function(t){var e,i,n,s=t/100;return s<66?(e=255,i=-155.25485562709179-.44596950469579133*(i=s-2)+104.49216199393888*log$1(i),n=s<20?0:.8274096064007395*(n=s-10)-254.76935184120902+115.67994401066147*log$1(n)):(e=351.97690566805693+.114206453784165*(e=s-55)-40.25366309332127*log$1(e),i=325.4494125711974+.07943456536662342*(i=s-50)-28.0852963507957*log$1(i),n=255),{r:floor(e),g:floor(i),b:floor(n)}},IroColor.rgbToKelvin=function(t){for(var e,i=t.r,n=t.b,s=KELVIN_MIN,o=KELVIN_MAX;o-s>.4;){var r=IroColor.kelvinToRgb(e=.5*(o+s));r.b/r.r>=n/i?o=e:s=e}return e},prototypeAccessors.hsv.get=function(){var t=this.$;return{h:t.h,s:t.s,v:t.v}},prototypeAccessors.hsv.set=function(t){var e=this.$;if(t=Object.assign({},e,t),this.onChange){var i={h:!1,v:!1,s:!1,a:!1};for(var n in e)i[n]=t[n]!=e[n];this.$=t,(i.h||i.s||i.v||i.a)&&this.onChange(this,i)}else this.$=t},prototypeAccessors.hsva.get=function(){return Object.assign({},this.$)},prototypeAccessors.hsva.set=function(t){this.hsv=t},prototypeAccessors.hue.get=function(){return this.$.h},prototypeAccessors.hue.set=function(t){this.hsv={h:t}},prototypeAccessors.saturation.get=function(){return this.$.s},prototypeAccessors.saturation.set=function(t){this.hsv={s:t}},prototypeAccessors.value.get=function(){return this.$.v},prototypeAccessors.value.set=function(t){this.hsv={v:t}},prototypeAccessors.alpha.get=function(){return this.$.a},prototypeAccessors.alpha.set=function(t){this.hsv=Object.assign({},this.hsv,{a:t})},prototypeAccessors.kelvin.get=function(){return IroColor.rgbToKelvin(this.rgb)},prototypeAccessors.kelvin.set=function(t){this.rgb=IroColor.kelvinToRgb(t)},prototypeAccessors.rgb.get=function(){var t=IroColor.hsvToRgb(this.$),e=t.g,i=t.b;return{r:round(t.r),g:round(e),b:round(i)}},prototypeAccessors.rgb.set=function(t){this.hsv=Object.assign({},IroColor.rgbToHsv(t),{a:void 0===t.a?1:t.a})},prototypeAccessors.rgba.get=function(){return Object.assign({},this.rgb,{a:this.alpha})},prototypeAccessors.rgba.set=function(t){this.rgb=t},prototypeAccessors.hsl.get=function(){var t=IroColor.hsvToHsl(this.$),e=t.s,i=t.l;return{h:round(t.h),s:round(e),l:round(i)}},prototypeAccessors.hsl.set=function(t){this.hsv=Object.assign({},IroColor.hslToHsv(t),{a:void 0===t.a?1:t.a})},prototypeAccessors.hsla.get=function(){return Object.assign({},this.hsl,{a:this.alpha})},prototypeAccessors.hsla.set=function(t){this.hsl=t},prototypeAccessors.rgbString.get=function(){var t=this.rgb;return"rgb("+t.r+", "+t.g+", "+t.b+")"},prototypeAccessors.rgbString.set=function(t){var e,i,n,s,o=1;if((e=REGEX_FUNCTIONAL_RGB.exec(t))?(i=parseUnit(e[1],255),n=parseUnit(e[2],255),s=parseUnit(e[3],255)):(e=REGEX_FUNCTIONAL_RGBA.exec(t))&&(i=parseUnit(e[1],255),n=parseUnit(e[2],255),s=parseUnit(e[3],255),o=parseUnit(e[4],1)),!e)throw new Error("Invalid rgb string");this.rgb={r:i,g:n,b:s,a:o}},prototypeAccessors.rgbaString.get=function(){var t=this.rgba;return"rgba("+t.r+", "+t.g+", "+t.b+", "+t.a+")"},prototypeAccessors.rgbaString.set=function(t){this.rgbString=t},prototypeAccessors.hexString.get=function(){var t=this.rgb;return"#"+intToHex(t.r)+intToHex(t.g)+intToHex(t.b)},prototypeAccessors.hexString.set=function(t){var e,i,n,s,o=255;if((e=REGEX_HEX_3.exec(t))?(i=17*parseHexInt(e[1]),n=17*parseHexInt(e[2]),s=17*parseHexInt(e[3])):(e=REGEX_HEX_4.exec(t))?(i=17*parseHexInt(e[1]),n=17*parseHexInt(e[2]),s=17*parseHexInt(e[3]),o=17*parseHexInt(e[4])):(e=REGEX_HEX_6.exec(t))?(i=parseHexInt(e[1]),n=parseHexInt(e[2]),s=parseHexInt(e[3])):(e=REGEX_HEX_8.exec(t))&&(i=parseHexInt(e[1]),n=parseHexInt(e[2]),s=parseHexInt(e[3]),o=parseHexInt(e[4])),!e)throw new Error("Invalid hex string");this.rgb={r:i,g:n,b:s,a:o/255}},prototypeAccessors.hex8String.get=function(){var t=this.rgba;return"#"+intToHex(t.r)+intToHex(t.g)+intToHex(t.b)+intToHex(floor(255*t.a))},prototypeAccessors.hex8String.set=function(t){this.hexString=t},prototypeAccessors.hslString.get=function(){var t=this.hsl;return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},prototypeAccessors.hslString.set=function(t){var e,i,n,s,o=1;if((e=REGEX_FUNCTIONAL_HSL.exec(t))?(i=parseUnit(e[1],360),n=parseUnit(e[2],100),s=parseUnit(e[3],100)):(e=REGEX_FUNCTIONAL_HSLA.exec(t))&&(i=parseUnit(e[1],360),n=parseUnit(e[2],100),s=parseUnit(e[3],100),o=parseUnit(e[4],1)),!e)throw new Error("Invalid hsl string");this.hsl={h:i,s:n,l:s,a:o}},prototypeAccessors.hslaString.get=function(){var t=this.hsla;return"hsl("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},prototypeAccessors.hslaString.set=function(t){this.hslString=t},Object.defineProperties(IroColor.prototype,prototypeAccessors);var sliderDefaultOptions={sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3};function getSliderDimensions(t){var e=t.width,i=t.sliderSize,n=t.borderWidth,s=t.handleRadius,o=t.padding,r="horizontal"===t.layoutDirection;return i=i||2*o+2*s+2*n,"circle"===t.sliderShape?{handleStart:t.padding+t.handleRadius,handleRange:e-2*o-2*s-2*n,width:e,height:e,cx:e/2,cy:e/2,radius:e/2-n/2}:{handleStart:i/2,handleRange:e-i,radius:i/2,x:0,y:0,width:r?i:e,height:r?e:i}}function getCurrentSliderValue(t,e){var i=e.hsva;switch(t.sliderType){case"alpha":return 100*i.a;case"kelvin":var n=t.minTemperature;return Math.max(0,Math.min((e.kelvin-n)/(t.maxTemperature-n)*100,100));case"hue":return i.h/=3.6;case"saturation":return i.s;case"value":default:return i.v}}function getSliderValueFromInput(t,e,i){var n,s=getSliderDimensions(t),o=s.handleRange,r=s.handleStart;n="horizontal"===t.layoutDirection?-1*i+o+r:e-r,n=Math.max(Math.min(n,o),0);var a=Math.round(100/o*n);switch(t.sliderType){case"kelvin":var l=t.minTemperature;return l+a/100*(t.maxTemperature-l);case"alpha":return a/100;case"hue":return 3.6*a;default:return a}}function getSliderHandlePosition(t,e){var i=getSliderDimensions(t),n=i.handleRange,s=i.handleStart,o="horizontal"===t.layoutDirection,r=o?i.width/2:i.height/2,a=s+getCurrentSliderValue(t,e)/100*n;return o&&(a=-1*a+n+2*s),{x:o?r:a,y:o?a:r}}function getSliderGradient(t,e){var i=e.hsv;switch(t.sliderType){case"alpha":var n=e.rgb;return[[0,"rgba("+n.r+","+n.g+","+n.b+",0)"],[100,"rgb("+n.r+","+n.g+","+n.b+")"]];case"kelvin":for(var s=[],o=t.minTemperature,r=t.maxTemperature,a=r-o,l=o,c=0;l<r;l+=a/8,c+=1){var h=IroColor.kelvinToRgb(l);s.push([12.5*c,"rgb("+h.r+","+h.g+","+h.b+")"])}return s;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var d=IroColor.hsvToHsl({h:i.h,s:0,v:i.v}),u=IroColor.hsvToHsl({h:i.h,s:100,v:i.v});return[[0,"hsl("+d.h+","+d.s+"%,"+d.l+"%)"],[100,"hsl("+u.h+","+u.s+"%,"+u.l+"%)"]];case"value":default:var m=IroColor.hsvToHsl({h:i.h,s:i.s,v:100});return[[0,"#000"],[100,"hsl("+m.h+","+m.s+"%,"+m.l+"%)"]]}}function getSliderGradientCoords(t){var e="horizontal"===t.layoutDirection;return{x1:"0%",y1:e?"100%":"0%",x2:e?"0%":"100%",y2:"0%"}}function getWheelDimensions(t){var e=t.width/2;return{width:t.width,radius:e-t.borderWidth,cx:e,cy:e}}function translateWheelAngle(t,e,i){var n=t.wheelAngle,s=t.wheelDirection;return((e=!i&&"clockwise"===s||i&&"anticlockwise"===s?(i?180:360)-(n-e):n+e)%360+360)%360}function getWheelHandlePosition(t,e){var i=e.hsv,n=getWheelDimensions(t),s=n.cx,o=n.cy,r=t.width/2-t.padding-t.handleRadius-t.borderWidth,a=(180+translateWheelAngle(t,i.h,!0))*(Math.PI/180),l=i.s/100*r,c="clockwise"===t.wheelDirection?-1:1;return{x:s+l*Math.cos(a)*c,y:o+l*Math.sin(a)*c}}function getWheelValueFromInput(t,e,i){var n=getWheelDimensions(t),s=t.width/2-t.padding-t.handleRadius-t.borderWidth;e=n.cx-e,i=n.cy-i;var o=translateWheelAngle(t,Math.atan2(-i,-e)*(180/Math.PI)),r=Math.min(Math.sqrt(e*e+i*i),s);return{h:Math.round(o),s:Math.round(100/s*r)}}function getBoxDimensions(t){var e=t.width;return{width:e,height:e,radius:t.padding+t.handleRadius}}function getBoxValueFromInput(t,e,i){var n=getBoxDimensions(t),s=n.radius,o=(i-s)/(n.height-2*s)*100;return{s:Math.max(0,Math.min((e-s)/(n.width-2*s)*100,100)),v:Math.max(0,Math.min(100-o,100))}}function getBoxHandlePosition(t,e){var i=getBoxDimensions(t),n=i.radius,s=e.hsv,o=i.height-2*n;return{x:n+s.s/100*(i.width-2*n),y:n+(o-s.v/100*o)}}function getBoxGradients(t,e){return[[[0,"#fff"],[100,"hsl("+e.hue+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]]}var BASE_ELEMENTS=document.getElementsByTagName("base");function resolveSvgUrl(t){var e=window.navigator.userAgent,i=/^((?!chrome|android).)*safari/i.test(e),n=/iPhone|iPod|iPad/i.test(e),s=window.location;return(i||n)&&BASE_ELEMENTS.length>0?s.protocol+"//"+s.host+s.pathname+s.search+t:t}function getSvgArcPath(t,e,i,n,s){var o=s-n<=180?0:1;return n*=Math.PI/180,s*=Math.PI/180,"M "+(t+i*Math.cos(s))+" "+(e+i*Math.sin(s))+" A "+i+" "+i+" 0 "+o+" 0 "+(t+i*Math.cos(n))+" "+(e+i*Math.sin(n))}function getHandleAtPoint(t,e,i,n){for(var s=0;s<n.length;s++){var o=n[s].x-e,r=n[s].y-i;if(Math.sqrt(o*o+r*r)<t.handleRadius)return s}return null}var iroColorPickerOptionDefaults={width:300,height:300,handleRadius:8,handleSvg:null,handleProps:{x:0,y:0},color:"#fff",colors:[],borderColor:"#fff",borderWidth:0,wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",layoutDirection:"vertical",sliderSize:null,sliderMargin:12,padding:6},SECONDARY_EVENTS=["mousemove","touchmove","mouseup","touchend"],IroComponentBase=function(t){function e(e){t.call(this,e),this.uid=(Math.random()+1).toString(36).substring(5)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.render=function(t){var e=this.handleEvent.bind(this),i={onMouseDown:e,onTouchStart:e},n="horizontal"===t.layoutDirection,s={overflow:"visible",display:n?"inline-block":"block"};return t.index>0&&(s[n?"marginLeft":"marginTop"]=null===t.margin?t.sliderMargin:t.margin),h$5(d$2,null,t.children(this.uid,i,s))},e.prototype.handleEvent=function(t){var e=this,i=this.props.onInput,n=this.base.getBoundingClientRect();t.preventDefault();var s=t.touches?t.changedTouches[0]:t,o=s.clientX-n.left,r=s.clientY-n.top;switch(t.type){case"mousedown":case"touchstart":SECONDARY_EVENTS.forEach((function(t){document.addEventListener(t,e,{passive:!1})})),i(o,r,0);break;case"mousemove":case"touchmove":i(o,r,1);break;case"mouseup":case"touchend":i(o,r,2),SECONDARY_EVENTS.forEach((function(t){document.removeEventListener(t,e)}))}},e}(m$4);function IroHandle(t){var e=t.r,i=t.url;return h$5("svg",{className:"IroHandle IroHandle--"+t.index+" "+(t.isActive?"IroHandle--isActive":""),x:t.x,y:t.y,style:{overflow:"visible"}},i&&h$5("use",Object.assign({xlinkHref:resolveSvgUrl(i)},t.props)),!i&&h$5("circle",{r:e,fill:"none","stroke-width":2,stroke:"#000"}),!i&&h$5("circle",{r:e-2,fill:t.fill,"stroke-width":2,stroke:"#fff"}))}function IroSlider(t){var e=t.color,i=getSliderDimensions(t),n=i.width,s=i.height,o=i.radius,r=getSliderHandlePosition(t,e),a=getSliderGradient(t,e),l="alpha"===t.sliderType;return h$5(IroComponentBase,Object.assign({},t,{onInput:function(i,n,s){var o=getSliderValueFromInput(t,i,n);t.parent.inputActive=!0,e[t.sliderType]=o,t.onInput(s)}}),(function(i,c,h){return h$5("svg",Object.assign({},c,{className:"IroSlider",width:n,height:s,style:h}),h$5("defs",null,h$5("linearGradient",Object.assign({id:"g"+i},getSliderGradientCoords(t)),a.map((function(t){return h$5("stop",{offset:t[0]+"%","stop-color":t[1]})}))),l&&h$5("pattern",{id:"b"+i,width:"8",height:"8",patternUnits:"userSpaceOnUse"},h$5("rect",{x:"0",y:"0",width:"8",height:"8",fill:"#fff"}),h$5("rect",{x:"0",y:"0",width:"4",height:"4",fill:"#ccc"}),h$5("rect",{x:"4",y:"4",width:"4",height:"4",fill:"#ccc"})),l&&h$5("pattern",{id:"f"+i,width:"100%",height:"100%"},h$5("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+resolveSvgUrl("#b"+i)+")"})," }",h$5("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+resolveSvgUrl("#g"+i)+")"}))),h$5("rect",{className:"IroSliderBg",rx:o,ry:o,x:t.borderWidth/2,y:t.borderWidth/2,width:n-t.borderWidth,height:s-t.borderWidth,"stroke-width":t.borderWidth,stroke:t.borderColor,fill:"url("+resolveSvgUrl((l?"#f":"#g")+i)+")"}),h$5(IroHandle,{isActive:!0,index:e.index,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:r.x,y:r.y}))}))}function IroBox(t){var e=getBoxDimensions(t),i=e.width,n=e.height,s=e.radius,o=t.colors,r=t.parent,a=t.color,l=getBoxGradients(t,a),c=o.map((function(e){return getBoxHandlePosition(t,e)}));return h$5(IroComponentBase,Object.assign({},t,{onInput:function(e,i,n){if(0===n){var s=getHandleAtPoint(t,e,i,c);null!==s?r.setActiveColor(s):(r.inputActive=!0,a.hsv=getBoxValueFromInput(t,e,i),t.onInput(n))}else 1===n&&(r.inputActive=!0,a.hsv=getBoxValueFromInput(t,e,i));t.onInput(n)}}),(function(e,r,h){return h$5("svg",Object.assign({},r,{className:"IroBox",width:i,height:n,style:h}),h$5("defs",null,h$5("linearGradient",{id:"s"+e,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},l[0].map((function(t){return h$5("stop",{offset:t[0]+"%","stop-color":t[1]})}))),h$5("linearGradient",{id:"l"+e,x1:"0%",y1:"0%",x2:"0%",y2:"100%"},l[1].map((function(t){return h$5("stop",{offset:t[0]+"%","stop-color":t[1]})}))),h$5("pattern",{id:"f"+e,width:"100%",height:"100%"},h$5("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+resolveSvgUrl("#s"+e)+")"})," }",h$5("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+resolveSvgUrl("#l"+e)+")"}))),h$5("rect",{rx:s,ry:s,x:t.borderWidth/2,y:t.borderWidth/2,width:i-t.borderWidth,height:n-t.borderWidth,"stroke-width":t.borderWidth,stroke:t.borderColor,fill:"url("+resolveSvgUrl("#f"+e)+")"}),o.filter((function(t){return t!==a})).map((function(e){return h$5(IroHandle,{isActive:!1,index:e.index,fill:e.hslString,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:c[e.index].x,y:c[e.index].y})})),h$5(IroHandle,{isActive:!0,index:a.index,fill:a.hslString,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:c[a.index].x,y:c[a.index].y}))}))}IroHandle.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}},IroSlider.defaultProps=Object.assign({},sliderDefaultOptions);var HUE_STEPS=Array.apply(null,{length:360}).map((function(t,e){return e}));function IroWheel(t){var e=getWheelDimensions(t),i=e.width,n=e.radius,s=e.cx,o=e.cy,r=t.colors,a=t.borderWidth,l=t.parent,c=t.color,h=c.hsv,d=r.map((function(e){return getWheelHandlePosition(t,e)}));return h$5(IroComponentBase,Object.assign({},t,{onInput:function(e,i,n){if(0===n){var s=getHandleAtPoint(t,e,i,d);null!==s?l.setActiveColor(s):(l.inputActive=!0,c.hsv=getWheelValueFromInput(t,e,i),t.onInput(n))}else 1===n&&(l.inputActive=!0,c.hsv=getWheelValueFromInput(t,e,i));t.onInput(n)}}),(function(e,l,u){return h$5("svg",Object.assign({},l,{className:"IroWheel",width:i,height:i,style:u}),h$5("defs",null,h$5("radialGradient",{id:e},h$5("stop",{offset:"0%","stop-color":"#fff"}),h$5("stop",{offset:"100%","stop-color":"#fff","stop-opacity":"0"}))),h$5("g",{className:"IroWheelHue","stroke-width":n,fill:"none"},HUE_STEPS.map((function(e){return h$5("path",{key:e,d:getSvgArcPath(s,o,n/2,e,e+1.5),stroke:"hsl("+translateWheelAngle(t,e)+", 100%, 50%)"})}))),h$5("circle",{className:"IroWheelSaturation",cx:s,cy:o,r:n,fill:"url("+resolveSvgUrl("#"+e)+")"}),t.wheelLightness&&h$5("circle",{className:"IroWheelLightness",cx:s,cy:o,r:n,fill:"#000",opacity:1-h.v/100}),h$5("circle",{className:"IroWheelBorder",cx:s,cy:o,r:n,fill:"none",stroke:t.borderColor,"stroke-width":a}),r.filter((function(t){return t!==c})).map((function(e){return h$5(IroHandle,{isActive:!1,index:e.index,fill:e.hslString,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:d[e.index].x,y:d[e.index].y})})),h$5(IroHandle,{isActive:!0,index:c.index,fill:c.hslString,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:d[c.index].x,y:d[c.index].y}))}))}function createWidget(t){var e=function(e,i){var n,s=document.createElement("div");function o(){var t=e instanceof Element?e:document.querySelector(e);t.appendChild(n.base),n.onMount(t)}return I$2(h$5(t,Object.assign({},{ref:function(t){return n=t}},i)),s),"loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o),n};return e.prototype=t.prototype,Object.assign(e,t),e.__component=t,e}var IroColorPicker=function(t){function e(e){var i=this;t.call(this,e),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=e.id,(e.colors.length>0?e.colors:[e.color]).forEach((function(t){return i.addColor(t)})),this.setActiveColor(0),this.state=Object.assign({},e,{color:this.color,colors:this.colors,layout:e.layout})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.addColor=function(t,e){void 0===e&&(e=this.colors.length);var i=new IroColor(t,this.onColorChange.bind(this));this.colors.splice(e,0,i),this.colors.forEach((function(t,e){return t.index=e})),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",i)},e.prototype.removeColor=function(t){var e=this.colors.splice(t,1)[0];e.unbind(),this.colors.forEach((function(t,e){return t.index=e})),this.state&&this.setState({colors:this.colors}),e.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",e)},e.prototype.setActiveColor=function(t){this.color=this.colors[t],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},e.prototype.setColors=function(t){var e=this;this.colors.forEach((function(t){return t.unbind()})),this.colors=[],t.forEach((function(t){return e.addColor(t)})),this.setActiveColor(0),this.emit("color:setAll",this.colors)},e.prototype.on=function(t,e){var i=this,n=this.events;(Array.isArray(t)?t:[t]).forEach((function(t){(n[t]||(n[t]=[])).push(e),i.deferredEvents[t]&&(i.deferredEvents[t].forEach((function(t){e.apply(null,t)})),i.deferredEvents[t]=[])}))},e.prototype.off=function(t,e){var i=this;(Array.isArray(t)?t:[t]).forEach((function(t){var n=i.events[t];n&&n.splice(n.indexOf(e),1)}))},e.prototype.emit=function(t){for(var e=this,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];var s=this.activeEvents,o=!!s.hasOwnProperty(t)&&s[t];if(!o){s[t]=!0;var r=this.events[t]||[];r.forEach((function(t){return t.apply(e,i)})),s[t]=!1}},e.prototype.deferredEmit=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];var s=this.deferredEvents;(e=this).emit.apply(e,[t].concat(i)),(s[t]||(s[t]=[])).push(i)},e.prototype.setOptions=function(t){this.setState(Object.assign({},this.state,t))},e.prototype.resize=function(t){this.setOptions({width:t})},e.prototype.reset=function(){this.colors.forEach((function(t){return t.reset()})),this.setState({colors:this.colors})},e.prototype.onMount=function(t){this.el=t,this.deferredEmit("mount",this)},e.prototype.onColorChange=function(t,e){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",t,e)),this.emit("color:change",t,e)},e.prototype.emitInputEvent=function(t){0===t?this.emit("input:start",this.color):1===t?this.emit("input:move",this.color):2===t&&this.emit("input:end",this.color)},e.prototype.render=function(t,e){var i=this,n=e.layout;return Array.isArray(n)||(n=[{component:IroWheel},{component:IroSlider}],e.transparency&&n.push({component:IroSlider,options:{sliderType:"alpha"}})),h$5("div",{class:"IroColorPicker",id:e.id,style:{display:e.display}},n.map((function(t,n){return h$5(t.component,Object.assign({},e,t.options,{ref:void 0,onInput:i.emitInputEvent.bind(i),parent:i,index:n}))})))},e}(m$4);IroColorPicker.defaultProps=Object.assign({},iroColorPickerOptionDefaults,{colors:[],display:"block",id:null,layout:"default",margin:null});var IroColorPickerWidget=createWidget(IroColorPicker),iro;!function(t){t.version="5.1.8",t.Color=IroColor,t.ColorPicker=IroColorPickerWidget,function(t){t.h=h$5,t.ComponentBase=IroComponentBase,t.Handle=IroHandle,t.Slider=IroSlider,t.Wheel=IroWheel,t.Box=IroBox}(t.ui||(t.ui={}))}(iro||(iro={}));var iro$1=iro;const zeaParamWidgetColorCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-color{color:var(--color-foreground-1)}.color-sample{height:30px;line-height:30px;border:1px solid var(--color-foreground-1);margin-bottom:0.5em;text-align:center;font-size:0.8em}",ZeaParamWidgetColor=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.colorPickerHeight=200}handlewindowResize(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>this.resizeColorPicker(),500)}resizeColorPicker(){this.colorPicker.resize(this.container.offsetWidth,this.colorPickerHeight)}componentDidLoad(){this.setUpColorPicker(),this.parameter&&(this.parameter.on("valueChanged",()=>{this.onValueChange()}),this.onValueChange()),setTimeout(()=>window.dispatchEvent(new Event("resize")),1e3)}onValueChange(){this.change||(this.undoing=!0,this.colorPicker.color.rgb=this.parameter.getValue().getAsRGBDict(),this.undoing=!1,this.sampleColor=this.colorPicker.color.hslString,this.setSampleTextColor())}setSampleTextColor(){this.sampleTextColor=`hsl(1, 0%, ${100-this.colorPicker.color.hsl.l}%)`}setUpColorPicker(){this.colorPicker=iro$1.ColorPicker(this.colorPickerContainer,{width:this.container.offsetWidth,height:this.colorPickerHeight,anticlockwise:!0,borderWidth:0,borderColor:"#fff",sliderHeight:"10px",padding:1,sliderMargin:4,handleRadius:4,layout:[{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"saturation"}},{component:iro$1.ui.Slider,options:{}}]}),this.colorPicker.on("input:start",()=>{this.change=new N$2(this.parameter),this.appData.undoRedoManager.addChange(this.change)}),this.colorPicker.on("input:end",()=>{this.change=void 0}),this.colorPicker.on("color:change",()=>{if(this.undoing)return;const t=new y$2;t.setFromRGBDict(this.colorPicker.color.rgb),this.sampleColor=this.colorPicker.color.hslString,this.setSampleTextColor(),this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))})}render(){return h("div",{ref:t=>this.container=t,class:"zea-param-widget-color"},h("div",{style:{color:this.sampleTextColor,backgroundColor:this.sampleColor},class:"color-sample"},this.sampleColor),h("div",{ref:t=>this.colorPickerContainer=t,class:"color-picker"}))}static get style(){return zeaParamWidgetColorCss}};uxFactory.registerWidget("zea-param-widget-color",t=>t.constructor.name==Ie.name);const zeaParamWidgetMaterialColorCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-material-color{color:var(--color-foreground-1)}.color-sample{height:30px;line-height:30px;border:1px solid var(--color-foreground-1);margin-bottom:0.5em;text-align:center;font-size:0.8em}",ZeaParamWidgetMaterialColor=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.colorPickerHeight=200}handlewindowResize(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>this.resizeColorPicker(),500)}resizeColorPicker(){this.colorPicker.resize(this.container.offsetWidth,this.colorPickerHeight)}componentDidLoad(){this.setUpColorPicker(),this.parameter&&(this.parameter.on("valueChanged",()=>{this.onValueChange()}),this.onValueChange())}onValueChange(){this.change||(this.undoing=!0,this.colorPicker.color.rgb=this.parameter.getValue().getAsRGBDict(),this.undoing=!1,this.sampleColor=this.colorPicker.color.hslString,this.setSampleTextColor())}setSampleTextColor(){this.sampleTextColor=`hsl(1, 0%, ${100-this.colorPicker.color.hsl.l}%)`}setUpColorPicker(){this.colorPicker=iro$1.ColorPicker(this.colorPickerContainer,{width:this.container.offsetWidth,height:this.colorPickerHeight,anticlockwise:!0,borderWidth:0,borderColor:"#fff",sliderHeight:"10px",padding:1,sliderMargin:4,handleRadius:4,layout:[{component:iro$1.ui.Slider,options:{sliderType:"hue"}},{component:iro$1.ui.Slider,options:{sliderType:"saturation"}},{component:iro$1.ui.Slider,options:{}}]}),this.colorPicker.on("input:start",()=>{this.change=new N$2(this.parameter),this.appData.undoRedoManager.addChange(this.change)}),this.colorPicker.on("input:end",()=>{this.change=void 0}),this.colorPicker.on("color:change",()=>{if(this.undoing)return;const t=new y$2;t.setFromRGBDict(this.colorPicker.color.rgb),this.sampleColor=this.colorPicker.color.hslString,this.setSampleTextColor(),this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))})}render(){return clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>this.resizeColorPicker(),500),h("div",{ref:t=>this.container=t,class:"zea-param-widget-material-color"},h("div",{style:{color:this.sampleTextColor,backgroundColor:this.sampleColor},class:"color-sample"},this.sampleColor),h("div",{ref:t=>this.colorPickerContainer=t,class:"color-picker"}))}static get style(){return zeaParamWidgetMaterialColorCss}};uxFactory.registerWidget("zea-param-widget-material-color",t=>t.constructor.name==Ue.name);const zeaParamWidgetNumberCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-number{color:var(--color-foreground-1);background-color:var(--color-background-2);max-width:400px}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}.zea-param-widget-number input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;color:var(--color-foreground-1);background-color:var(--color-background-3)}input[type='number']{padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);text-align:right}",ZeaParamWidgetNumber=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.inputChanged=this.inputChanged.bind(this)}parameterChangeHandler(){this.setUpInput()}componentDidLoad(){this.parameter&&this.setUpInput()}setUpInput(){this.range=this.parameter.getRange(),this.step=this.parameter.getStep(),this.setInputValue(),this.parameter.on("valueChanged",()=>{console.log("value changed"),this.setInputValue()})}setInputValue(){this.value=this.range?(this.parameter.getValue()-this.range[0])/(this.range[1]-this.range[0])*200:this.parameter.getValue()}inputChanged(){let t=this.round(this.inputField.valueAsNumber);if(this.range&&(t=this.range[0]+t/200*(this.range[1]-this.range[0]),t=this.clamp(t,this.range[0],this.range[1])),this.appData.undoRedoManager){const e=new N$2(this.parameter,t);this.appData.undoRedoManager.addChange(e)}else this.parameter.setValue(t)}round(t,e=6){return Number(Math.round(Number(t+"e"+e))+"e-"+e)}clamp(t,e,i){return Math.max(Math.min(t,Math.max(e,i)),Math.min(e,i))}render(){return h("div",{class:"zea-param-widget-number"},h("input",this.range?{onChange:this.inputChanged,ref:t=>this.inputField=t,class:"mdl-slider mdl-js-slider",type:"range",min:"0",max:"200",step:this.step?this.step:1,id:this.parameter.getName(),value:this.value,tabindex:"0"}:{onChange:this.inputChanged,ref:t=>this.inputField=t,type:"number",pattern:"-?[0-9]*(.[0-9]+)?",id:this.parameter.getName(),value:this.value,tabindex:"0"}))}static get watchers(){return{parameter:["parameterChangeHandler"]}}static get style(){return zeaParamWidgetNumberCss}};uxFactory.registerWidget("zea-param-widget-number",t=>t.constructor.name==Ze.name);const zeaParamWidgetStringCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-string{color:var(--color-foreground-1);background-color:var(--color-background-2)}input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);color:var(--color-foreground-1);background-color:var(--color-background-3)}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}",ZeaParamWidgetString=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}componentDidLoad(){this.parameter&&(this.setUpInputs(),this.onValueChanged())}setUpInputs(){this.parameter.on("valueChanged",()=>{this.onValueChanged()})}onValueChanged(){this.change||(this.txtField.value=this.parameter.getValue())}onInput(){const t=this.txtField.value;this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))}onChange(){this.onInput(),this.change=void 0}render(){return h("div",{class:"zea-param-widget-string",ref:t=>this.widgetContainer=t},h("input",{onInput:this.onInput,onChange:this.onChange,onKeyUp:t=>{t.stopPropagation()},onKeyDown:t=>{t.stopPropagation()},ref:t=>this.txtField=t,id:this.parameter.getName(),type:"text",tabindex:"0"}))}static get style(){return zeaParamWidgetStringCss}};uxFactory.registerWidget("zea-param-widget-string",t=>t.constructor.name==We.name);const zeaParamWidgetVec2Css=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-vec2{color:var(--color-foreground-1);background-color:var(--color-background-2);max-width:400px}.zea-param-widget-vec2 input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;color:var(--color-foreground-1);background-color:var(--color-background-3)}.zea-param-widget-vec2 input:first-child{margin-bottom:0.5em}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}.vector-input-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:0.5em}.vector-input-wrap label{font-size:0.7em;padding:0.3em 1em 0.3em 0.3em;opacity:0.5}input[type='number']{padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);text-align:right}",ZeaParamWidgetVec2=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}parameterChangeHandler(){this.setUpInputs()}componentDidLoad(){this.parameter&&(this.setUpInputs(),this.onValueChanged())}setUpInputs(){this.parameter.on("valueChanged",()=>{this.onValueChanged()})}onValueChanged(){if(!this.change){const t=this.parameter.getValue();this.xField.value=""+this.round(t.x),this.yField.value=""+this.round(t.y)}}onInput(){const t=new _(this.xField.valueAsNumber,this.yField.valueAsNumber);this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))}onChange(){this.onInput(),this.change=void 0}round(t,e=6){return Number(Math.round(Number(t+"e"+e))+"e-"+e)}render(){return h("div",{class:"zea-param-widget-vec2",ref:t=>this.container=t},h("div",{class:"vector-input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.xField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.xValue})),h("div",{class:"vector-input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.yField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.yValue})))}static get watchers(){return{parameter:["parameterChangeHandler"]}}static get style(){return zeaParamWidgetVec2Css}};uxFactory.registerWidget("zea-param-widget-vec2",t=>t.constructor.name==ye.name);const zeaParamWidgetVec3Css=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-vec3{color:var(--color-foreground-1);background-color:var(--color-background-2);max-width:400px}.zea-param-widget-vec3 input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;margin-bottom:0.5em;color:var(--color-foreground-1);background-color:var(--color-background-3)}.zea-param-widget-vec3 input:last-child{margin-bottom:0}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}.vector-input-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:0.5em}.vector-input-wrap label{font-size:0.7em;padding:0.3em 1em 0.3em 0.3em;opacity:0.5}input[type='number']{padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);text-align:right}",ZeaParamWidgetVec3=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}parameterChangeHandler(){this.setUpInputs()}componentDidLoad(){this.parameter&&(this.setUpInputs(),this.onValueChanged())}setUpInputs(){this.parameter.on("valueChanged",()=>{this.onValueChanged()})}onValueChanged(){if(!this.change){const t=this.parameter.getValue();this.xField.value=""+this.round(t.x),this.yField.value=""+this.round(t.y),this.zField.value=""+this.round(t.z)}}onInput(){const t=new Z(this.xField.valueAsNumber,this.yField.valueAsNumber,this.zField.valueAsNumber);this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))}onChange(){this.onInput(),this.change=void 0}round(t,e=6){return Number(Math.round(Number(t+"e"+e))+"e-"+e)}render(){return h("div",{class:"zea-param-widget-vec3",ref:t=>this.container=t},h("div",{class:"vector-input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.xField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.xValue})),h("div",{class:"vector-input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.yField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.yValue})),h("div",{class:"vector-input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.zField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.zValue})))}static get watchers(){return{parameter:["parameterChangeHandler"]}}static get style(){return zeaParamWidgetVec3Css}};uxFactory.registerWidget("zea-param-widget-vec3",t=>t.constructor.name==fe.name);const zeaParamWidgetVec4Css=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-vec4{color:var(--color-foreground-1);background-color:var(--color-background-2);max-width:400px}.zea-param-widget-vec4 input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;margin-bottom:0.5em;color:var(--color-foreground-1);background-color:var(--color-background-3)}.zea-param-widget-vec4 input:last-child{margin-bottom:0}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}.vector-input-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:0.5em}.vector-input-wrap label{font-size:0.7em;padding:0.3em 1em 0.3em 0.3em;opacity:0.5}input[type='number']{padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);text-align:right}",ZeaParamWidgetVec4=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}parameterChangeHandler(){this.setUpInputs()}componentDidLoad(){this.parameter&&(this.setUpInputs(),this.onValueChanged())}setUpInputs(){this.parameter.on("valueChanged",()=>{this.onValueChanged()})}onValueChanged(){if(!this.change){const t=this.parameter.getValue();this.xField.value=""+this.round(t.x),this.yField.value=""+this.round(t.y),this.zField.value=""+this.round(t.z),this.tField.value=""+this.round(t.t)}}onInput(){const t=new G(this.xField.valueAsNumber,this.yField.valueAsNumber,this.zField.valueAsNumber,this.tField.valueAsNumber);this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))}onChange(){this.onInput(),this.change=void 0}round(t,e=6){return Number(Math.round(Number(t+"e"+e))+"e-"+e)}render(){return h("div",{class:"zea-param-widget-vec4",ref:t=>this.container=t},h("div",{class:"vector-input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.xField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.xValue})),h("div",{class:"vector-input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.yField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.yValue})),h("div",{class:"vector-input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.zField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.zValue})),h("div",{class:"vector-input-wrap"},h("label",null,"T"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.tField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0",value:this.tValue})))}static get watchers(){return{parameter:["parameterChangeHandler"]}}static get style(){return zeaParamWidgetVec4Css}};uxFactory.registerWidget("zea-param-widget-vec4",t=>t.constructor.name==Ve.name);const zeaParamWidgetXfoCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-xfo{color:var(--color-foreground-1);background-color:var(--color-background-2);max-width:400px}.zea-param-widget-xfo input{width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;color:var(--color-foreground-1);background-color:var(--color-background-3)}.user-edited{-webkit-box-shadow:0 0 8px var(--color-success-1);box-shadow:0 0 8px var(--color-success-1);margin:0px}.input-wrap{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:0.5em}.input-wrap label{font-size:0.7em;padding:0.3em 1em 0.3em 0.3em;opacity:0.5;width:1.5em;text-align:center}input[type='number']{padding:0.3em;font-size:0.9em;border:1px solid var(--color-grey-3);text-align:right}fieldset{border:1px solid var(--color-grey-3)}legend{color:var(--color-foreground-2);font-size:0.8em}",ZeaParamWidgetXfo=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.settingValue=!1,this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this)}componentDidLoad(){this.parameter&&(this.setUpInputs(),this.updateDisplayedValue())}updateDisplayedValue(){if(!this.settingValue){const t=this.parameter.getValue();this.trxField.value=""+this.round(t.tr.x),this.tryField.value=""+this.round(t.tr.y),this.trzField.value=""+this.round(t.tr.z),this.orxField.value=""+this.round(t.ori.x),this.oryField.value=""+this.round(t.ori.y),this.orzField.value=""+this.round(t.ori.z),this.orwField.value=""+this.round(t.ori.w),this.scxField.value=""+this.round(t.sc.x),this.scyField.value=""+this.round(t.sc.y),this.sczField.value=""+this.round(t.sc.z)}}setUpInputs(){this.parameter.on("valueChanged",()=>{this.updateDisplayedValue()})}onInput(){this.settingValue=!0;const t=new S;t.tr.set(this.trxField.valueAsNumber,this.tryField.valueAsNumber,this.trzField.valueAsNumber),t.ori.set(this.orxField.valueAsNumber,this.oryField.valueAsNumber,this.orzField.valueAsNumber,this.orwField.valueAsNumber),t.ori.normalizeInPlace(),t.sc.set(this.scxField.valueAsNumber,this.scyField.valueAsNumber,this.sczField.valueAsNumber),this.change?this.change.update({value:t}):(this.change=new N$2(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))}onChange(){this.onInput(),this.settingValue=!1,this.change=void 0}round(t,e=6){return Math.abs(t)<Number("1e-6")?0:Number(Math.round(Number(t+"e"+e))+"e-"+e)}render(){return h("div",{class:"zea-param-widget-xfo",ref:t=>this.widgetContainer=t},h("fieldset",null,h("legend",null,"Translation"),h("div",{class:"input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.trxField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.tryField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.trzField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"}))),h("fieldset",null,h("legend",null,"Rotation"),h("div",{class:"input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.orxField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.oryField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.orzField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"W"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.orwField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"}))),h("fieldset",null,h("legend",null,"Scale"),h("div",{class:"input-wrap"},h("label",null,"X"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.scxField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Y"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.scyField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"})),h("div",{class:"input-wrap"},h("label",null,"Z"),h("input",{onInput:this.onInput,onChange:this.onChange,ref:t=>this.sczField=t,id:this.parameter.getName(),type:"number",pattern:"-?[0-9]*(.[0-9]+)?",tabindex:"0"}))))}static get style(){return zeaParamWidgetXfoCss}};uxFactory.registerWidget("zea-param-widget-xfo",t=>t.constructor.name==Se.name);const zeaParameterContainerCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-parameter-container{color:var(--color-foreground-1);background-color:var(--color-background-2);padding:0.5em}.zea-param-widget-wrap{margin-bottom:1.2em}.zea-param-widget-boolean-wrap{display:-ms-flexbox;display:flex;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-align:center;align-items:center}label{font-size:0.8em;padding-bottom:0.4em;padding:0.5em 0 0.5em;display:block}",ZeaParameterContainer=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}render(){return h("div",{class:"zea-parameter-container"},this.parameterOwner.getParameters().map((t,e)=>{const i=t.getName(),n=uxFactory.findWidgetReg(t);return n?h("div",{class:`zea-param-widget-wrap ${n.widget}-wrap`},h("label",{htmlFor:i},i),h("div",{class:"zea-parameter-input-wrap"},h(n.widget,{id:i,key:e,appData:this.appData,parameter:t}))):h("div",null,"Unable to display parameter '",i,"', value:",t.getValue(),", index: ",e)}))}static get style(){return zeaParameterContainerCss}},zeaPopupMenuCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-popup-menu{color:var(--color-foreground-1);display:none;position:absolute;z-index:10000;background-color:var(--color-background-2);-webkit-box-shadow:0px 5px 10px var(--color-shadow);box-shadow:0px 5px 10px var(--color-shadow);padding:0.5em 0}.zea-popup-menu.shown{display:block}",ZeaPopupMenu=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.shown=!1,this.twinkleElement=t=>{t.classList.toggle("twinkled");const e=setInterval(()=>{t.classList.toggle("twinkled")},70);setTimeout(()=>{clearTimeout(e),t.classList.remove("twinkled")},100)}}handleClick(t){if(t.target==this.anchorElement)return this.bbox=t.target.getBoundingClientRect(),this.leftOffset=this.bbox.left+"px",this.topOffset=this.bbox.top+"px",void(this.shown=!this.shown);if(this.hostElement.contains(t.target)){const e=t.target.shadowRoot.querySelector(".zea-popup-menu-item");this.twinkleElement(e),setTimeout(()=>{this.shown=!1},300)}else this.anchorElement&&(this.shown=!1)}render(){return h("div",{ref:t=>this.node=t,class:"zea-popup-menu "+(this.shown?"shown":"hidden"),style:{top:this.topOffset,left:this.leftOffset}},h("slot",null))}get hostElement(){return this}static get style(){return zeaPopupMenuCss}},zeaPopupMenuItemCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-popup-menu-item{color:var(--color-foreground-1);font-family:sans-serif;padding:0.3em 0.6em;cursor:pointer;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:left;justify-content:left}.zea-popup-menu-item:hover{background-color:var(--color-grey-3)}.zea-popup-menu-item.twinkled{background-color:var(--color-secondary-3)}.start-icon{margin-right:0.5em;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.end-icon{margin-left:0.5em;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}",ZeaPopupMenuItem=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.handleItemClick=t=>{this.clickHandler&&this.clickHandler(t)}}render(){let t,e;return this.startIcon&&(t=h("span",{class:"start-icon"},h("zea-icon",{name:this.startIcon}))),this.endIcon&&(e=h("span",{class:"end-icon"},h("zea-icon",{name:this.endIcon}))),h("div",{onClick:t=>this.handleItemClick(t),class:"zea-popup-menu-item"},t,h("span",null,h("slot",null)),e)}static get style(){return zeaPopupMenuItemCss}},zeaProgressBarCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-progress-bar{position:absolute;bottom:0;left:0;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}.progress{overflow:hidden;max-width:100%;-webkit-transition:width 0.4s;transition:width 0.4s}.indeterminate .progress{position:absolute;-webkit-animation-name:indeterminate_progress_continuous;animation-name:indeterminate_progress_continuous;-webkit-animation-duration:1.4s;animation-duration:1.4s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear}.indeterminate.pulsating .progress{position:absolute;width:20% !important;-webkit-animation-name:indeterminate_progress_pulsating;animation-name:indeterminate_progress_pulsating;-webkit-animation-duration:1.4s;animation-duration:1.4s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:linear;animation-timing-function:linear}@-webkit-keyframes indeterminate_progress_continuous{0%{width:0;left:0}50%{width:100%;left:0}100%{width:0%;left:100%}}@keyframes indeterminate_progress_continuous{0%{width:0;left:0}50%{width:100%;left:0}100%{width:0%;left:100%}}@-webkit-keyframes indeterminate_progress_pulsating{0%{width:0;left:0}25%{width:30%;left:0}50%{width:50%;left:25%}75%{width:30%;left:75%}100%{width:0%;left:100%}}@keyframes indeterminate_progress_pulsating{0%{width:0;left:0}25%{width:30%;left:0}50%{width:50%;left:25%}75%{width:30%;left:75%}100%{width:0%;left:100%}}",ZeaProgressBar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.type="determinate",this.percent=50,this.size=3,this.color="var(--color-primary-1)",this.backgroundColor="var(--color-primary-3)",this.indeterminateAnimation="continuous"}render(){return h("div",{class:`zea-progress-bar ${this.type} ${this.indeterminateAnimation}`,style:{backgroundColor:this.backgroundColor,height:this.size+"px"}},h("div",{class:"progress",style:{width:this.percent+"%",height:this.size+"px",backgroundColor:this.color}}))}static get style(){return zeaProgressBarCss}};var canPromise=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},toString$5={}.toString,isarray$2=Array.isArray||function(t){return"[object Array]"==toString$5.call(t)};function typedArraySupport(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}Buffer$1.TYPED_ARRAY_SUPPORT=typedArraySupport();var K_MAX_LENGTH=Buffer$1.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function Buffer$1(t,e,i){return Buffer$1.TYPED_ARRAY_SUPPORT||this instanceof Buffer$1?"number"==typeof t?allocUnsafe$1(this,t):from$1(this,t,e,i):new Buffer$1(t,e,i)}function checked$1(t){if(t>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|t}function isnan$1(t){return t!=t}function createBuffer$1(t,e){var i;return Buffer$1.TYPED_ARRAY_SUPPORT?(i=new Uint8Array(e)).__proto__=Buffer$1.prototype:(null===(i=t)&&(i=new Buffer$1(e)),i.length=e),i}function allocUnsafe$1(t,e){var i=createBuffer$1(t,e<0?0:0|checked$1(e));if(!Buffer$1.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)i[n]=0;return i}function fromString$1(t,e){var i=0|byteLength$1(e),n=createBuffer$1(t,i),s=n.write(e);return s!==i&&(n=n.slice(0,s)),n}function fromArrayLike$1(t,e){for(var i=e.length<0?0:0|checked$1(e.length),n=createBuffer$1(t,i),s=0;s<i;s+=1)n[s]=255&e[s];return n}function fromArrayBuffer$1(t,e,i,n){if(i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");var s;return s=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n),Buffer$1.TYPED_ARRAY_SUPPORT?s.__proto__=Buffer$1.prototype:s=fromArrayLike$1(t,s),s}function fromObject$1(t,e){if(Buffer$1.isBuffer(e)){var i=0|checked$1(e.length),n=createBuffer$1(t,i);return 0===n.length||e.copy(n,0,0,i),n}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan$1(e.length)?createBuffer$1(t,0):fromArrayLike$1(t,e);if("Buffer"===e.type&&Array.isArray(e.data))return fromArrayLike$1(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function utf8ToBytes$1(t,e){var i;e=e||1/0;for(var n=t.length,s=null,o=[],r=0;r<n;++r){if((i=t.charCodeAt(r))>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(r+1===n){(e-=3)>-1&&o.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(e-=3)>-1&&o.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function byteLength$1(t){return Buffer$1.isBuffer(t)?t.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)?t.byteLength:("string"!=typeof t&&(t=""+t),0===t.length?0:utf8ToBytes$1(t).length)}function blitBuffer$1(t,e,i,n){for(var s=0;s<n&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}function utf8Write$1(t,e,i,n){return blitBuffer$1(utf8ToBytes$1(e,t.length-i),t,i,n)}function from$1(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer$1(t,e,i,n):"string"==typeof e?fromString$1(t,e):fromObject$1(t,e)}Buffer$1.TYPED_ARRAY_SUPPORT&&(Buffer$1.prototype.__proto__=Uint8Array.prototype,Buffer$1.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer$1[Symbol.species]===Buffer$1&&Object.defineProperty(Buffer$1,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),Buffer$1.prototype.write=function(t,e,i){void 0===e||void 0===i&&"string"==typeof e?(i=this.length,e=0):isFinite(e)&&(e|=0,isFinite(i)?i|=0:i=void 0);var n=this.length-e;if((void 0===i||i>n)&&(i=n),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return utf8Write$1(this,t,e,i)},Buffer$1.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),Buffer$1.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=Buffer$1.prototype;else{var s=e-t;i=new Buffer$1(s,void 0);for(var o=0;o<s;++o)i[o]=this[o+t]}return i},Buffer$1.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var s,o=n-i;if(this===t&&i<e&&e<n)for(s=o-1;s>=0;--s)t[s+e]=this[s+i];else if(o<1e3||!Buffer$1.TYPED_ARRAY_SUPPORT)for(s=0;s<o;++s)t[s+e]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},Buffer$1.prototype.fill=function(t,e,i){if("string"==typeof t){if("string"==typeof e?(e=0,i=this.length):"string"==typeof i&&(i=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var s;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(s=e;s<i;++s)this[s]=t;else{var o=Buffer$1.isBuffer(t)?t:new Buffer$1(t),r=o.length;for(s=0;s<i-e;++s)this[s+e]=o[s%r]}return this},Buffer$1.concat=function(t,e){if(!isarray$2(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return createBuffer$1(null,0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=allocUnsafe$1(null,e),s=0;for(i=0;i<t.length;++i){var o=t[i];if(!Buffer$1.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,s),s+=o.length}return n},Buffer$1.byteLength=byteLength$1,Buffer$1.prototype._isBuffer=!0,Buffer$1.isBuffer=function(t){return!(null==t||!t._isBuffer)};var alloc$1=function(t){var e=new Buffer$1(t);return e.fill(0),e},from_1=function(t){return new Buffer$1(t)},typedarrayBuffer={alloc:alloc$1,from:from_1},toSJISFunction,CODEWORDS_COUNT=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},getSymbolTotalCodewords=function(t){return CODEWORDS_COUNT[t]},getBCHDigit=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');toSJISFunction=t},isKanjiModeEnabled=function(){return void 0!==toSJISFunction},toSJIS=function(t){return toSJISFunction(t)},utils$1={getSymbolSize,getSymbolTotalCodewords,getBCHDigit,setToSJISFunction,isKanjiModeEnabled,toSJIS},errorCorrectionLevel=createCommonjsModule((function(t,i){i.L={bit:1},i.M={bit:0},i.Q={bit:3},i.H={bit:2},i.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},i.from=function(t,n){if(i.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return i.L;case"m":case"medium":return i.M;case"q":case"quartile":return i.Q;case"h":case"high":return i.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(e){return n}}}));function BitBuffer(){this.buffer=[],this.length=0}BitBuffer.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var bitBuffer=BitBuffer;function BitMatrix(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=typedarrayBuffer.alloc(t*t),this.reservedBit=typedarrayBuffer.alloc(t*t)}BitMatrix.prototype.set=function(t,e,i,n){var s=t*this.size+e;this.data[s]=i,n&&(this.reservedBit[s]=!0)},BitMatrix.prototype.get=function(t,e){return this.data[t*this.size+e]},BitMatrix.prototype.xor=function(t,e,i){this.data[t*this.size+e]^=i},BitMatrix.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var bitMatrix=BitMatrix,alignmentPattern=createCommonjsModule((function(t,e){var i=utils$1.getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,n=i(t),s=145===n?26:2*Math.ceil((n-13)/(2*e-2)),o=[n-7],r=1;r<e-1;r++)o[r]=o[r-1]-s;return o.push(6),o.reverse()},e.getPositions=function(t){for(var i=[],n=e.getRowColCoords(t),s=n.length,o=0;o<s;o++)for(var r=0;r<s;r++)0===o&&0===r||0===o&&r===s-1||o===s-1&&0===r||i.push([n[o],n[r]]);return i}})),getSymbolSize$1=utils$1.getSymbolSize,FINDER_PATTERN_SIZE=7,getPositions=function(t){var e=getSymbolSize$1(t);return[[0,0],[e-FINDER_PATTERN_SIZE,0],[0,e-FINDER_PATTERN_SIZE]]},finderPattern={getPositions},maskPattern=createCommonjsModule((function(t,e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function i(t,i,n){switch(t){case e.Patterns.PATTERN000:return(i+n)%2==0;case e.Patterns.PATTERN001:return i%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(i+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return i*n%2+i*n%3==0;case e.Patterns.PATTERN110:return(i*n%2+i*n%3)%2==0;case e.Patterns.PATTERN111:return(i*n%3+(i+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){for(var e=t.size,i=0,n=0,s=0,o=null,r=null,a=0;a<e;a++){n=s=0,o=r=null;for(var l=0;l<e;l++){var c=t.get(a,l);c===o?n++:(n>=5&&(i+=n-5+3),o=c,n=1),(c=t.get(l,a))===r?s++:(s>=5&&(i+=s-5+3),r=c,s=1)}n>=5&&(i+=n-5+3),s>=5&&(i+=s-5+3)}return i},e.getPenaltyN2=function(t){for(var e=t.size,i=0,n=0;n<e-1;n++)for(var s=0;s<e-1;s++){var o=t.get(n,s)+t.get(n,s+1)+t.get(n+1,s)+t.get(n+1,s+1);4!==o&&0!==o||i++}return 3*i},e.getPenaltyN3=function(t){for(var e=t.size,i=0,n=0,s=0,o=0;o<e;o++){n=s=0;for(var r=0;r<e;r++)n=n<<1&2047|t.get(o,r),r>=10&&(1488===n||93===n)&&i++,s=s<<1&2047|t.get(r,o),r>=10&&(1488===s||93===s)&&i++}return 40*i},e.getPenaltyN4=function(t){for(var e=0,i=t.data.length,n=0;n<i;n++)e+=t.data[n];return 10*Math.abs(Math.ceil(100*e/i/5)-10)},e.applyMask=function(t,e){for(var n=e.size,s=0;s<n;s++)for(var o=0;o<n;o++)e.isReserved(o,s)||e.xor(o,s,i(t,o,s))},e.getBestMask=function(t,i){for(var n=Object.keys(e.Patterns).length,s=0,o=1/0,r=0;r<n;r++){i(r),e.applyMask(r,t);var a=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(r,t),a<o&&(o=a,s=r)}return s}})),EC_BLOCKS_TABLE=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],EC_CODEWORDS_TABLE=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],getBlocksCount=function(t,e){switch(e){case errorCorrectionLevel.L:return EC_BLOCKS_TABLE[4*(t-1)+0];case errorCorrectionLevel.M:return EC_BLOCKS_TABLE[4*(t-1)+1];case errorCorrectionLevel.Q:return EC_BLOCKS_TABLE[4*(t-1)+2];case errorCorrectionLevel.H:return EC_BLOCKS_TABLE[4*(t-1)+3];default:return}},getTotalCodewordsCount=function(t,e){switch(e){case errorCorrectionLevel.L:return EC_CODEWORDS_TABLE[4*(t-1)+0];case errorCorrectionLevel.M:return EC_CODEWORDS_TABLE[4*(t-1)+1];case errorCorrectionLevel.Q:return EC_CODEWORDS_TABLE[4*(t-1)+2];case errorCorrectionLevel.H:return EC_CODEWORDS_TABLE[4*(t-1)+3];default:return}},errorCorrectionCode={getBlocksCount,getTotalCodewordsCount},EXP_TABLE=typedarrayBuffer.alloc(512),LOG_TABLE=typedarrayBuffer.alloc(256);!function(){for(var t=1,e=0;e<255;e++)EXP_TABLE[e]=t,LOG_TABLE[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)EXP_TABLE[e]=EXP_TABLE[e-255]}();var log$2=function(t){if(t<1)throw new Error("log("+t+")");return LOG_TABLE[t]},exp=function(t){return EXP_TABLE[t]},mul=function(t,e){return 0===t||0===e?0:EXP_TABLE[LOG_TABLE[t]+LOG_TABLE[e]]},galoisField={log:log$2,exp,mul},polynomial=createCommonjsModule((function(t,e){e.mul=function(t,e){for(var i=typedarrayBuffer.alloc(t.length+e.length-1),n=0;n<t.length;n++)for(var s=0;s<e.length;s++)i[n+s]^=galoisField.mul(t[n],e[s]);return i},e.mod=function(t,e){for(var i=typedarrayBuffer.from(t);i.length-e.length>=0;){for(var n=i[0],s=0;s<e.length;s++)i[s]^=galoisField.mul(e[s],n);for(var o=0;o<i.length&&0===i[o];)o++;i=i.slice(o)}return i},e.generateECPolynomial=function(t){for(var i=typedarrayBuffer.from([1]),n=0;n<t;n++)i=e.mul(i,[1,galoisField.exp(n)]);return i}})),Buffer$2=bufferEs6.Buffer;function ReedSolomonEncoder(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}ReedSolomonEncoder.prototype.initialize=function(t){this.degree=t,this.genPoly=polynomial.generateECPolynomial(this.degree)},ReedSolomonEncoder.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=typedarrayBuffer.alloc(this.degree),i=Buffer$2.concat([t,e],t.length+this.degree),n=polynomial.mod(i,this.genPoly),s=this.degree-n.length;if(s>0){var o=typedarrayBuffer.alloc(this.degree);return n.copy(o,s),o}return n};var reedSolomonEncoder=ReedSolomonEncoder,isValid$1=function(t){return!isNaN(t)&&t>=1&&t<=40},versionCheck={isValid:isValid$1},numeric="[0-9]+",alphanumeric="[A-Z $%*+\\-./:]+",kanji="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";kanji=kanji.replace(/u/g,"\\u");var byte="(?:(?![A-Z0-9 $%*+\\-./:]|"+kanji+")(?:.|[\r\n]))+",KANJI=new RegExp(kanji,"g"),BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),BYTE=new RegExp(byte,"g"),NUMERIC=new RegExp(numeric,"g"),ALPHANUMERIC=new RegExp(alphanumeric,"g"),TEST_KANJI=new RegExp("^"+kanji+"$"),TEST_NUMERIC=new RegExp("^"+numeric+"$"),TEST_ALPHANUMERIC=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),testKanji=function(t){return TEST_KANJI.test(t)},testNumeric=function(t){return TEST_NUMERIC.test(t)},testAlphanumeric=function(t){return TEST_ALPHANUMERIC.test(t)},regex={KANJI,BYTE_KANJI,BYTE,NUMERIC,ALPHANUMERIC,testKanji,testNumeric,testAlphanumeric},mode$1=createCommonjsModule((function(t,i){i.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},i.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},i.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},i.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},i.MIXED={bit:-1},i.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!versionCheck.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},i.getBestModeForData=function(t){return regex.testNumeric(t)?i.NUMERIC:regex.testAlphanumeric(t)?i.ALPHANUMERIC:regex.testKanji(t)?i.KANJI:i.BYTE},i.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},i.isValid=function(t){return t&&t.bit&&t.ccBits},i.from=function(t,n){if(i.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return i.NUMERIC;case"alphanumeric":return i.ALPHANUMERIC;case"kanji":return i.KANJI;case"byte":return i.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(e){return n}}})),version$1=createCommonjsModule((function(t,e){var i=utils$1.getBCHDigit(7973);function n(t,e){return mode$1.getCharCountIndicator(t,e)+4}function s(t,e){var i=0;return t.forEach((function(t){var s=n(t.mode,e);i+=s+t.getBitsLength()})),i}e.from=function(t,e){return versionCheck.isValid(t)?parseInt(t,10):e},e.getCapacity=function(t,e,i){if(!versionCheck.isValid(t))throw new Error("Invalid QR Code version");void 0===i&&(i=mode$1.BYTE);var s=8*(utils$1.getSymbolTotalCodewords(t)-errorCorrectionCode.getTotalCodewordsCount(t,e));if(i===mode$1.MIXED)return s;var o=s-n(i,t);switch(i){case mode$1.NUMERIC:return Math.floor(o/10*3);case mode$1.ALPHANUMERIC:return Math.floor(o/11*2);case mode$1.KANJI:return Math.floor(o/13);case mode$1.BYTE:default:return Math.floor(o/8)}},e.getBestVersionForData=function(t,i){var n,o=errorCorrectionLevel.from(i,errorCorrectionLevel.M);if(isarray$2(t)){if(t.length>1)return function(t,i){for(var n=1;n<=40;n++)if(s(t,n)<=e.getCapacity(n,i,mode$1.MIXED))return n}(t,o);if(0===t.length)return 1;n=t[0]}else n=t;return function(t,i,n){for(var s=1;s<=40;s++)if(i<=e.getCapacity(s,n,t))return s}(n.mode,n.getLength(),o)},e.getEncodedBits=function(t){if(!versionCheck.isValid(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;utils$1.getBCHDigit(e)-i>=0;)e^=7973<<utils$1.getBCHDigit(e)-i;return t<<12|e}})),G15=1335,G15_MASK=21522,G15_BCH=utils$1.getBCHDigit(G15),getEncodedBits=function(t,e){for(var i=t.bit<<3|e,n=i<<10;utils$1.getBCHDigit(n)-G15_BCH>=0;)n^=G15<<utils$1.getBCHDigit(n)-G15_BCH;return(i<<10|n)^G15_MASK},formatInfo={getEncodedBits};function NumericData(t){this.mode=mode$1.NUMERIC,this.data=t.toString()}NumericData.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},NumericData.prototype.getLength=function(){return this.data.length},NumericData.prototype.getBitsLength=function(){return NumericData.getBitsLength(this.data.length)},NumericData.prototype.write=function(t){var e,i,n;for(e=0;e+3<=this.data.length;e+=3)i=this.data.substr(e,3),n=parseInt(i,10),t.put(n,10);var s=this.data.length-e;s>0&&(i=this.data.substr(e),n=parseInt(i,10),t.put(n,3*s+1))};var numericData=NumericData,ALPHA_NUM_CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function AlphanumericData(t){this.mode=mode$1.ALPHANUMERIC,this.data=t}AlphanumericData.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},AlphanumericData.prototype.getLength=function(){return this.data.length},AlphanumericData.prototype.getBitsLength=function(){return AlphanumericData.getBitsLength(this.data.length)},AlphanumericData.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var i=45*ALPHA_NUM_CHARS.indexOf(this.data[e]);i+=ALPHA_NUM_CHARS.indexOf(this.data[e+1]),t.put(i,11)}this.data.length%2&&t.put(ALPHA_NUM_CHARS.indexOf(this.data[e]),6)};var alphanumericData=AlphanumericData;function ByteData(t){this.mode=mode$1.BYTE,this.data=typedarrayBuffer.from(t)}ByteData.getBitsLength=function(t){return 8*t},ByteData.prototype.getLength=function(){return this.data.length},ByteData.prototype.getBitsLength=function(){return ByteData.getBitsLength(this.data.length)},ByteData.prototype.write=function(t){for(var e=0,i=this.data.length;e<i;e++)t.put(this.data[e],8)};var byteData=ByteData;function KanjiData(t){this.mode=mode$1.KANJI,this.data=t}KanjiData.getBitsLength=function(t){return 13*t},KanjiData.prototype.getLength=function(){return this.data.length},KanjiData.prototype.getBitsLength=function(){return KanjiData.getBitsLength(this.data.length)},KanjiData.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var i=utils$1.toSJIS(this.data[e]);if(i>=33088&&i<=40956)i-=33088;else{if(!(i>=57408&&i<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");i-=49472}t.put(i=192*(i>>>8&255)+(255&i),13)}};var kanjiData=KanjiData,dijkstra_1=createCommonjsModule((function(t){var e={single_source_shortest_paths:function(t,i,n){var s={},o={};o[i]=0;var r,a,l,c,h,d,u=e.PriorityQueue.make();for(u.push(i,0);!u.empty();)for(l in c=(r=u.pop()).cost,h=t[a=r.value]||{})h.hasOwnProperty(l)&&(d=c+h[l],(void 0===o[l]||o[l]>d)&&(o[l]=d,u.push(l,d),s[l]=a));if(void 0!==n&&void 0===o[n]){var m=["Could not find a path from ",i," to ",n,"."].join("");throw new Error(m)}return s},extract_shortest_path_from_predecessor_list:function(t,e){for(var i=[],n=e;n;)i.push(n),n=t[n];return i.reverse(),i},find_path:function(t,i,n){var s=e.single_source_shortest_paths(t,i,n);return e.extract_shortest_path_from_predecessor_list(s,n)},PriorityQueue:{make:function(t){var i,n=e.PriorityQueue,s={};for(i in t=t||{},n)n.hasOwnProperty(i)&&(s[i]=n[i]);return s.queue=[],s.sorter=t.sorter||n.default_sorter,s},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){this.queue.push({value:t,cost:e}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e})),segments=createCommonjsModule((function(t,e){function i(t){return unescape(encodeURIComponent(t)).length}function n(t,e,i){for(var n,s=[];null!==(n=t.exec(i));)s.push({data:n[0],index:n.index,mode:e,length:n[0].length});return s}function s(t){var e,i,s=n(regex.NUMERIC,mode$1.NUMERIC,t),o=n(regex.ALPHANUMERIC,mode$1.ALPHANUMERIC,t);return utils$1.isKanjiModeEnabled()?(e=n(regex.BYTE,mode$1.BYTE,t),i=n(regex.KANJI,mode$1.KANJI,t)):(e=n(regex.BYTE_KANJI,mode$1.BYTE,t),i=[]),s.concat(o,e,i).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function o(t,e){switch(e){case mode$1.NUMERIC:return numericData.getBitsLength(t);case mode$1.ALPHANUMERIC:return alphanumericData.getBitsLength(t);case mode$1.KANJI:return kanjiData.getBitsLength(t);case mode$1.BYTE:return byteData.getBitsLength(t)}}function r(t,e){var i,n=mode$1.getBestModeForData(t);if((i=mode$1.from(e,n))!==mode$1.BYTE&&i.bit<n.bit)throw new Error('"'+t+'" cannot be encoded with mode '+mode$1.toString(i)+".\n Suggested mode is: "+mode$1.toString(n));switch(i!==mode$1.KANJI||utils$1.isKanjiModeEnabled()||(i=mode$1.BYTE),i){case mode$1.NUMERIC:return new numericData(t);case mode$1.ALPHANUMERIC:return new alphanumericData(t);case mode$1.KANJI:return new kanjiData(t);case mode$1.BYTE:return new byteData(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(r(e,null)):e.data&&t.push(r(e.data,e.mode)),t}),[])},e.fromString=function(t,n){for(var r=function(t,e){for(var i={},n={start:{}},s=["start"],r=0;r<t.length;r++){for(var a=t[r],l=[],c=0;c<a.length;c++){var h=a[c],d=""+r+c;l.push(d),i[d]={node:h,lastCount:0},n[d]={};for(var u=0;u<s.length;u++){var m=s[u];i[m]&&i[m].node.mode===h.mode?(n[m][d]=o(i[m].lastCount+h.length,h.mode)-o(i[m].lastCount,h.mode),i[m].lastCount+=h.length):(i[m]&&(i[m].lastCount=h.length),n[m][d]=o(h.length,h.mode)+4+mode$1.getCharCountIndicator(h.mode,e))}}s=l}for(u=0;u<s.length;u++)n[s[u]].end=0;return{map:n,table:i}}(function(t){for(var e=[],n=0;n<t.length;n++){var s=t[n];switch(s.mode){case mode$1.NUMERIC:e.push([s,{data:s.data,mode:mode$1.ALPHANUMERIC,length:s.length},{data:s.data,mode:mode$1.BYTE,length:s.length}]);break;case mode$1.ALPHANUMERIC:e.push([s,{data:s.data,mode:mode$1.BYTE,length:s.length}]);break;case mode$1.KANJI:e.push([s,{data:s.data,mode:mode$1.BYTE,length:i(s.data)}]);break;case mode$1.BYTE:e.push([{data:s.data,mode:mode$1.BYTE,length:i(s.data)}])}}return e}(s(t,utils$1.isKanjiModeEnabled())),n),a=dijkstra_1.find_path(r.map,"start","end"),l=[],c=1;c<a.length-1;c++)l.push(r.table[a[c]].node);return e.fromArray(l.reduce((function(t,e){var i=t.length-1>=0?t[t.length-1]:null;return i&&i.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[]))},e.rawSplit=function(t){return e.fromArray(s(t,utils$1.isKanjiModeEnabled()))}}));function setupFinderPattern(t,e){for(var i=t.size,n=finderPattern.getPositions(e),s=0;s<n.length;s++)for(var o=n[s][0],r=n[s][1],a=-1;a<=7;a++)if(!(o+a<=-1||i<=o+a))for(var l=-1;l<=7;l++)r+l<=-1||i<=r+l||t.set(o+a,r+l,a>=0&&a<=6&&(0===l||6===l)||l>=0&&l<=6&&(0===a||6===a)||a>=2&&a<=4&&l>=2&&l<=4,!0)}function setupTimingPattern(t){for(var e=t.size,i=8;i<e-8;i++){var n=i%2==0;t.set(i,6,n,!0),t.set(6,i,n,!0)}}function setupAlignmentPattern(t,e){for(var i=alignmentPattern.getPositions(e),n=0;n<i.length;n++)for(var s=i[n][0],o=i[n][1],r=-2;r<=2;r++)for(var a=-2;a<=2;a++)t.set(s+r,o+a,-2===r||2===r||-2===a||2===a||0===r&&0===a,!0)}function setupVersionInfo(t,e){for(var i,n,s,o=t.size,r=version$1.getEncodedBits(e),a=0;a<18;a++)i=Math.floor(a/3),t.set(i,n=a%3+o-8-3,s=1==(r>>a&1),!0),t.set(n,i,s,!0)}function setupFormatInfo(t,e,i){var n,s,o=t.size,r=formatInfo.getEncodedBits(e,i);for(n=0;n<15;n++)t.set(n<6?n:n<8?n+1:o-15+n,8,s=1==(r>>n&1),!0),t.set(8,n<8?o-n-1:n<9?15-n-1+1:15-n-1,s,!0);t.set(o-8,8,1,!0)}function setupData(t,e){for(var i=t.size,n=-1,s=i-1,o=7,r=0,a=i-1;a>0;a-=2)for(6===a&&a--;;){for(var l=0;l<2;l++)if(!t.isReserved(s,a-l)){var c=!1;r<e.length&&(c=1==(e[r]>>>o&1)),t.set(s,a-l,c),-1==--o&&(r++,o=7)}if((s+=n)<0||i<=s){s-=n,n=-n;break}}}function createData(t,e,i){var n=new bitBuffer;i.forEach((function(e){n.put(e.mode.bit,4),n.put(e.getLength(),mode$1.getCharCountIndicator(e.mode,t)),e.write(n)}));var s=8*(utils$1.getSymbolTotalCodewords(t)-errorCorrectionCode.getTotalCodewordsCount(t,e));for(n.getLengthInBits()+4<=s&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);for(var o=(s-n.getLengthInBits())/8,r=0;r<o;r++)n.put(r%2?17:236,8);return createCodewords(n,t,e)}function createCodewords(t,e,i){for(var n=utils$1.getSymbolTotalCodewords(e),s=n-errorCorrectionCode.getTotalCodewordsCount(e,i),o=errorCorrectionCode.getBlocksCount(e,i),r=o-n%o,a=Math.floor(n/o),l=Math.floor(s/o),c=l+1,h=a-l,d=new reedSolomonEncoder(h),u=0,m=new Array(o),p=new Array(o),b=0,f=typedarrayBuffer.from(t.buffer),g=0;g<o;g++){var y=g<r?l:c;m[g]=f.slice(u,u+y),p[g]=d.encode(m[g]),u+=y,b=Math.max(b,y)}var v,Z,x=typedarrayBuffer.alloc(n),G=0;for(v=0;v<b;v++)for(Z=0;Z<o;Z++)v<m[Z].length&&(x[G++]=m[Z][v]);for(v=0;v<h;v++)for(Z=0;Z<o;Z++)x[G++]=p[Z][v];return x}function createSymbol(t,e,i,n){var s;if(isarray$2(t))s=segments.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var o=e;if(!o){var r=segments.rawSplit(t);o=version$1.getBestVersionForData(r,i)}s=segments.fromString(t,o||40)}var a=version$1.getBestVersionForData(s,i);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<a)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+a+".\n")}else e=a;var l=createData(e,i,s),c=utils$1.getSymbolSize(e),h=new bitMatrix(c);return setupFinderPattern(h,e),setupTimingPattern(h),setupAlignmentPattern(h,e),setupFormatInfo(h,i,0),e>=7&&setupVersionInfo(h,e),setupData(h,l),isNaN(n)&&(n=maskPattern.getBestMask(h,setupFormatInfo.bind(null,h,i))),maskPattern.applyMask(n,h),setupFormatInfo(h,i,n),{modules:h,version:e,errorCorrectionLevel:i,maskPattern:n,segments:s}}var create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var i,n,s=errorCorrectionLevel.M;return void 0!==e&&(s=errorCorrectionLevel.from(e.errorCorrectionLevel,errorCorrectionLevel.M),i=version$1.from(e.version),n=maskPattern.from(e.maskPattern),e.toSJISFunc&&utils$1.setToSJISFunction(e.toSJISFunc)),createSymbol(t,i,s,n)},qrcode={create},utils$2=createCommonjsModule((function(t,e){function i(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");var i=parseInt(e.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:255&i,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});var e=t.width&&t.width>=21?t.width:void 0;return{width:e,scale:e?4:t.scale||4,margin:null==t.margin||t.margin<0?4:t.margin,color:{dark:i(t.color.dark||"#000000ff"),light:i(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,i){var n=e.getScale(t,i);return Math.floor((t+2*i.margin)*n)},e.qrToImageData=function(t,i,n){for(var s=i.modules.size,o=i.modules.data,r=e.getScale(s,n),a=Math.floor((s+2*n.margin)*r),l=n.margin*r,c=[n.color.light,n.color.dark],h=0;h<a;h++)for(var d=0;d<a;d++){var u=4*(h*a+d),m=n.color.light;h>=l&&d>=l&&h<a-l&&d<a-l&&(m=c[o[Math.floor((h-l)/r)*s+Math.floor((d-l)/r)]?1:0]),t[u++]=m.r,t[u++]=m.g,t[u++]=m.b,t[u]=m.a}}})),canvas=createCommonjsModule((function(t,i){i.render=function(t,i,n){var s=n,o=i;void 0!==s||i&&i.getContext||(s=i,i=void 0),i||(o=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),s=utils$2.getOptions(s);var r=utils$2.getImageWidth(t.modules.size,s),a=o.getContext("2d"),l=a.createImageData(r,r);return utils$2.qrToImageData(l.data,t,s),function(t,e,i){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=i,e.width=i,e.style.height=i+"px",e.style.width=i+"px"}(a,o,r),a.putImageData(l,0,0),o},i.renderToDataURL=function(t,e,n){var s=n;return void 0!==s||e&&e.getContext||(s=e,e=void 0),s||(s={}),i.render(t,e,s).toDataURL(s.type||"image/png",(s.rendererOpts||{}).quality)}}));function getColorAttrib(t,e){var i=t.a/255,n=e+'="'+t.hex+'"';return i<1?n+" "+e+'-opacity="'+i.toFixed(2).slice(1)+'"':n}function svgCmd(t,e,i){var n=t+e;return void 0!==i&&(n+=" "+i),n}function qrToPath(t,e,i){for(var n="",s=0,o=!1,r=0,a=0;a<t.length;a++){var l=Math.floor(a%e),c=Math.floor(a/e);l||o||(o=!0),t[a]?(r++,a>0&&l>0&&t[a-1]||(n+=o?svgCmd("M",l+i,.5+c+i):svgCmd("m",s,0),s=0,o=!1),l+1<e&&t[a+1]||(n+=svgCmd("h",r),r=0)):s++}return n}var render=function(t,e,i){var n=utils$2.getOptions(e),s=t.modules.size,o=t.modules.data,r=s+2*n.margin,a=n.color.light.a?"<path "+getColorAttrib(n.color.light,"fill")+' d="M0 0h'+r+"v"+r+'H0z"/>':"",l="<path "+getColorAttrib(n.color.dark,"stroke")+' d="'+qrToPath(o,s,n.margin)+'"/>',c='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+'viewBox="0 0 '+r+" "+r+'" shape-rendering="crispEdges">'+a+l+"</svg>\n";return"function"==typeof i&&i(null,c),c},svgTag={render};function renderCanvas(t,i,n,s,o){var r=[].slice.call(arguments,1),a=r.length,l="function"==typeof r[a-1];if(!l&&!canPromise())throw new Error("Callback required as last argument");if(!l){if(a<1)throw new Error("Too few arguments provided");return 1===a?(n=i,i=s=void 0):2!==a||i.getContext||(s=n,n=i,i=void 0),new Promise((function(o,r){try{var a=qrcode.create(n,s);o(t(a,i,s))}catch(e){r(e)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(o=n,n=i,i=s=void 0):3===a&&(i.getContext&&void 0===o?(o=s,s=void 0):(o=s,s=n,n=i,i=void 0));try{var c=qrcode.create(n,s);o(null,t(c,i,s))}catch(e){o(e)}}var create$1=qrcode.create,toCanvas=renderCanvas.bind(null,canvas.render),toDataURL=renderCanvas.bind(null,canvas.renderToDataURL),toString_1=renderCanvas.bind(null,(function(t,e,i){return svgTag.render(t,i)})),browser$4={create:create$1,toCanvas,toDataURL,toString:toString_1};const zeaQrCodeCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-qr-code{--zea-qr-code-color:var(--theme-color);color:var(--zea-qr-code-color);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.zea-qr-code canvas{width:auto !important;height:auto !important;max-width:100%;padding:1em 0;-webkit-box-sizing:border-box;box-sizing:border-box}",ZeaQrCode=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.content=window.location.href,this.scale=4}onContentChanged(){this.makeQR()}componentDidLoad(){this.makeQR()}makeQR(){this.canvas&&this.canvas.remove(),browser$4.toCanvas(this.content,{scale:this.scale}).then(t=>{this.canvas=t,this.container.appendChild(this.canvas)})}render(){return h("div",{class:"zea-qr-code",ref:t=>this.container=t})}static get watchers(){return{content:["onContentChanged"]}}static get style(){return zeaQrCodeCss}};var resizeObservers=[],hasActiveObservations=function(){return resizeObservers.some((function(t){return t.activeTargets.length>0}))},hasSkippedObservations=function(){return resizeObservers.some((function(t){return t.skippedTargets.length>0}))},msg="ResizeObserver loop completed with undelivered notifications.",deliverResizeLoopError=function(){var t;"function"==typeof ErrorEvent?t=new ErrorEvent("error",{message:msg}):((t=document.createEvent("Event")).initEvent("error",!1,!1),t.message=msg),window.dispatchEvent(t)},ResizeObserverBoxOptions;!function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(ResizeObserverBoxOptions||(ResizeObserverBoxOptions={}));var DOMRectReadOnly=function(){function t(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return t.prototype.toJSON=function(){var t=this;return{x:t.x,y:t.y,top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),isSVG=function(t){return t instanceof SVGElement&&"getBBox"in t},isHidden=function(t){if(isSVG(t)){var e=t.getBBox();return!e.width&&!e.height}return!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},isElement=function(t){var e,i,n=null===(i=null===(e=t)||void 0===e?void 0:e.ownerDocument)||void 0===i?void 0:i.defaultView;return!!(n&&t instanceof n.Element)},isReplacedElement=function(t){switch(t.tagName){case"INPUT":if("image"!==t.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},global$2="undefined"!=typeof window?window:{},cache=new Map,scrollRegexp=/auto|scroll/,verticalRegexp=/^tb|vertical/,IE=/msie|trident/i.test(global$2.navigator&&global$2.navigator.userAgent),parseDimension=function(t){return parseFloat(t||"0")},size=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!1),Object.freeze({inlineSize:(i?e:t)||0,blockSize:(i?t:e)||0})},zeroBoxes=Object.freeze({devicePixelContentBoxSize:size(),borderBoxSize:size(),contentBoxSize:size(),contentRect:new DOMRectReadOnly(0,0,0,0)}),calculateBoxSizes=function(t){if(cache.has(t))return cache.get(t);if(isHidden(t))return cache.set(t,zeroBoxes),zeroBoxes;var e=getComputedStyle(t),i=isSVG(t)&&t.ownerSVGElement&&t.getBBox(),n=!IE&&"border-box"===e.boxSizing,s=verticalRegexp.test(e.writingMode||""),o=!i&&scrollRegexp.test(e.overflowY||""),r=!i&&scrollRegexp.test(e.overflowX||""),a=i?0:parseDimension(e.paddingTop),l=i?0:parseDimension(e.paddingRight),c=i?0:parseDimension(e.paddingBottom),h=i?0:parseDimension(e.paddingLeft),d=i?0:parseDimension(e.borderTopWidth),u=i?0:parseDimension(e.borderRightWidth),m=i?0:parseDimension(e.borderBottomWidth),p=h+l,b=a+c,f=(i?0:parseDimension(e.borderLeftWidth))+u,g=d+m,y=r?t.offsetHeight-g-t.clientHeight:0,v=o?t.offsetWidth-f-t.clientWidth:0,Z=n?p+f:0,x=n?b+g:0,G=i?i.width:parseDimension(e.width)-Z-v,X=i?i.height:parseDimension(e.height)-x-y,w=G+p+v+f,V=X+b+y+g,I=Object.freeze({devicePixelContentBoxSize:size(Math.round(G*devicePixelRatio),Math.round(X*devicePixelRatio),s),borderBoxSize:size(w,V,s),contentBoxSize:size(G,X,s),contentRect:new DOMRectReadOnly(h,a,G,X)});return cache.set(t,I),I},calculateBoxSize=function(t,e){var i=calculateBoxSizes(t),n=i.borderBoxSize,s=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(e){case ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:return o;case ResizeObserverBoxOptions.BORDER_BOX:return n;default:return s}},ResizeObserverEntry=function(t){var e=calculateBoxSizes(t);this.target=t,this.contentRect=e.contentRect,this.borderBoxSize=[e.borderBoxSize],this.contentBoxSize=[e.contentBoxSize],this.devicePixelContentBoxSize=[e.devicePixelContentBoxSize]},calculateDepthForNode=function(t){if(isHidden(t))return 1/0;for(var e=0,i=t.parentNode;i;)e+=1,i=i.parentNode;return e},broadcastActiveObservations=function(){var t=1/0,e=[];resizeObservers.forEach((function(i){if(0!==i.activeTargets.length){var n=[];i.activeTargets.forEach((function(e){var i=new ResizeObserverEntry(e.target),s=calculateDepthForNode(e.target);n.push(i),e.lastReportedSize=calculateBoxSize(e.target,e.observedBox),s<t&&(t=s)})),e.push((function(){i.callback.call(i.observer,n,i.observer)})),i.activeTargets.splice(0,i.activeTargets.length)}}));for(var i=0,n=e;i<n.length;i++)(0,n[i])();return t},gatherActiveObservationsAtDepth=function(t){cache.clear(),resizeObservers.forEach((function(e){e.activeTargets.splice(0,e.activeTargets.length),e.skippedTargets.splice(0,e.skippedTargets.length),e.observationTargets.forEach((function(i){i.isActive()&&(calculateDepthForNode(i.target)>t?e.activeTargets.push(i):e.skippedTargets.push(i))}))}))},process=function(){var t=0;for(gatherActiveObservationsAtDepth(t);hasActiveObservations();)t=broadcastActiveObservations(),gatherActiveObservationsAtDepth(t);return hasSkippedObservations()&&deliverResizeLoopError(),t>0},trigger,callbacks$1=[],notify=function(){return callbacks$1.splice(0).forEach((function(t){return t()}))},queueMicroTask=function(t){if(!trigger){var e=0,i=document.createTextNode("");new MutationObserver((function(){return notify()})).observe(i,{characterData:!0}),trigger=function(){i.textContent=""+(e?e--:e++)}}callbacks$1.push(t),trigger()},queueResizeObserver=function(t){queueMicroTask((function(){requestAnimationFrame(t)}))},watching=0,isWatching=function(){return!!watching},CATCH_FRAMES=12,observerConfig={attributes:!0,characterData:!0,childList:!0,subtree:!0},events$1=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],scheduled=!1,Scheduler=function(){function t(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return t.prototype.run=function(t){var e=this;scheduled||(scheduled=!0,queueResizeObserver((function(){var i=!1;try{i=process()}finally{if(scheduled=!1,!isWatching())return;i?e.run(60):t?e.run(t-1):e.start()}})))},t.prototype.schedule=function(){this.stop(),this.run(CATCH_FRAMES)},t.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,observerConfig)};document.body?e():global$2.addEventListener("DOMContentLoaded",e)},t.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),events$1.forEach((function(e){return global$2.addEventListener(e,t.listener,!0)})))},t.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),events$1.forEach((function(e){return global$2.removeEventListener(e,t.listener,!0)})),this.stopped=!0)},t}(),scheduler=new Scheduler,updateCount=function(t){!watching&&t>0&&scheduler.start(),!(watching+=t)&&scheduler.stop()},skipNotifyOnElement=function(t){return!isSVG(t)&&!isReplacedElement(t)&&"inline"===getComputedStyle(t).display},ResizeObservation=function(){function t(t,e){this.target=t,this.observedBox=e||ResizeObserverBoxOptions.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var t=calculateBoxSize(this.target,this.observedBox);return skipNotifyOnElement(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},t}(),ResizeObserverDetail=function(t,e){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=e},observerMap=new Map,getObservationIndex=function(t,e){for(var i=0;i<t.length;i+=1)if(t[i].target===e)return i;return-1},ResizeObserverController=function(){function t(){}return t.connect=function(t,e){var i=new ResizeObserverDetail(t,e);resizeObservers.push(i),observerMap.set(t,i)},t.observe=function(t,e,i){if(observerMap.has(t)){var n=observerMap.get(t);getObservationIndex(n.observationTargets,e)<0&&(n.observationTargets.push(new ResizeObservation(e,i&&i.box)),updateCount(1),scheduler.schedule())}},t.unobserve=function(t,e){if(observerMap.has(t)){var i=observerMap.get(t),n=getObservationIndex(i.observationTargets,e);n>=0&&(i.observationTargets.splice(n,1),updateCount(-1))}},t.disconnect=function(t){if(observerMap.has(t)){var e=observerMap.get(t);resizeObservers.splice(resizeObservers.indexOf(e),1),observerMap.delete(t),updateCount(-e.observationTargets.length)}},t}(),ResizeObserver=function(){function t(t){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof t)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");ResizeObserverController.connect(this,t)}return t.prototype.observe=function(t,e){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!isElement(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");ResizeObserverController.observe(this,t,e)},t.prototype.unobserve=function(t){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!isElement(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");ResizeObserverController.unobserve(this,t)},t.prototype.disconnect=function(){ResizeObserverController.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();const zeaScrollPaneCss=":host{max-height:100%;width:100%;display:block;position:relative;height:100%}:host(.disabled){height:auto}.zea-scroll-pane{pointer-events:auto;max-height:100%;overflow:auto;scrollbar-width:none;-ms-overflow-style:none;}.zea-scroll-pane::-webkit-scrollbar{width:0px;background:transparent;}.v-scroll-track{position:absolute;right:0;top:0;bottom:0;width:10px;background-color:var(--color-background-4);z-index:1000}.v-scroll-bar{position:absolute;right:0px;width:10px;top:0;background-color:var(--color-grey-3);z-index:10000;-webkit-box-shadow:-2px 4px 7px -3px var(--color-background-1);box-shadow:-2px 4px 7px -3px var(--color-background-1)}:host(.disabled) .v-scroll-track,:host(.disabled) .v-scroll-bar{display:none}",ZeaScrollPane=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.vMouseDown=!1}onResize(){this.refreshScrollbar()}onOrientationchange(){this.refreshScrollbar()}onMouseUp(){this.vMouseDown=!1,this.scrollPane.style.userSelect="initial"}onMouseMove(t){this.vMouseDown&&(this.scrollPane.scrollTop=this.scrollPane.scrollTop+(this.vBarTop-this.vTrackTop+(t.clientY-this.prevClientY))/this.scrollRatio,this.prevClientY=t.clientY)}componentDidLoad(){this.refreshScrollbar(),this.scrollPane.addEventListener("scroll",()=>{this.vScrollBar.style.top=this.scrollPane.scrollTop*this.scrollRatio+"px"}),this.vScrollBar.addEventListener("mousedown",t=>{this.vMouseDown=!0,this.vMouseOffet=t.clientY,this.vCurrentScroll=this.scrollPane.scrollTop;const e=this.vScrollBar.getBoundingClientRect();this.vBarTop=e.top,this.vBarHeight=e.height,this.prevClientY=t.clientY;const i=this.vScrollBar.getBoundingClientRect();this.vTrackTop=i.top,this.scrollPane.style.userSelect="none"}),new ResizeObserver(()=>{this.refreshScrollbar()}).observe(this.scrollContent),new MutationObserver(t=>{console.log(t),this.refreshScrollbar()}).observe(this.scrollContent,{attributes:!0})}async refreshScrollbar(){if(this.scrollRatio=Math.ceil(this.rootElement.offsetHeight/this.scrollContent.offsetHeight*1e3)/1e3,this.scrollRatio<.999){this.rootElement.classList.remove("disabled");const t=this.rootElement.offsetHeight*this.scrollRatio;this.scrollDelta=this.rootElement.offsetHeight-t,this.vScrollBar.style.height=t+"px"}else this.rootElement.classList.add("disabled")}render(){return h(Host,null,h("div",{ref:t=>this.vScrollTrack=t,draggable:!1,class:"v-scroll-track"}),h("div",{draggable:!1,class:"v-scroll-bar",ref:t=>this.vScrollBar=t}),h("div",{class:"zea-scroll-pane",ref:t=>this.scrollPane=t},h("div",{class:"scroll-content",ref:t=>this.scrollContent=t},h("slot",null))))}get rootElement(){return this}static get style(){return zeaScrollPaneCss}},zeaSwitchCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-switch{display:inline-block;overflow:hidden;width:45px;height:16px;position:relative;color:var(--color-foreground-1)}.zea-switch-wrap{width:100%;height:100%}.zea-switch-track{width:25px;height:10px;border-radius:5px;position:absolute;top:3px;left:2px;background-color:var(--color-foreground-3)}.zea-switch-button{width:16px;height:16px;border-radius:8px;position:absolute;background-color:var(--color-foreground-1)}.zea-switch.checked .zea-switch-button{background-color:var(--color-primary-1);left:13px}.zea-switch.disabled .zea-switch-button{background-color:var(--color-foreground-3)}.zea-switch.checked.disabled .zea-switch-button{background-color:var(--color-foreground-3)}.zea-switch.checked .zea-switch-track{background-color:var(--color-primary-3)}.zea-switch.disabled .zea-switch-track{background-color:var(--color-disabled-2)}.zea-switch.checked.disabled .zea-switch-track{background-color:var(--color-disabled-2)}input[type='checkbox']{position:relative;left:-50000px}.zea-switch-label{position:absolute;left:32px;top:2px;font-size:10px}.zea-switch.disabled .zea-switch-label{color:var(--color-foreground-3)}",ZeaSwitch=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.disabled=!1,this.checked=!1}onCheckedChanged(t){this.element.shadowRoot.querySelector("input").checked=t,this.updateElementClass(),this.stateLabel=t?"On":"Off"}onDisabledChanged(t){this.element.shadowRoot.querySelector("input").disabled=t,this.updateElementClass()}updateElementClass(){this.elementClass=this.checked?"checked":"",this.elementClass+=this.disabled?" disabled ":""}toggleCheck(){this.disabled||(this.checked=!this.checked)}componentDidLoad(){this.onCheckedChanged(this.checked),this.onDisabledChanged(this.disabled)}render(){return h("div",{class:"zea-switch "+this.elementClass,onClick:()=>{this.toggleCheck()}},h("span",{class:"zea-switch-wrap"},h("span",{class:"zea-switch-track"}),h("span",{class:"zea-switch-button"}),h("span",{class:"zea-switch-label"},this.stateLabel)),h("input",{type:"checkbox",name:this.name}))}get element(){return this}static get watchers(){return{checked:["onCheckedChanged"],disabled:["onDisabledChanged"]}}static get style(){return zeaSwitchCss}},zeaTabsCss="@import url('https://unpkg.com/tachyons@4/css/tachyons.min.css');:host{display:block;height:100%}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-tabs{color:var(--color-foreground-1);display:-ms-flexbox;display:flex;width:100%;height:100%}.zea-tabs *{-webkit-box-sizing:border-box;box-sizing:border-box}.zea-tabs.small{font-size:11px}.zea-tabs{-ms-flex-direction:column;flex-direction:column}.zea-tabs.vertical{-ms-flex-direction:row;flex-direction:row}.zea-tabs .zea-tabs-bar{-ms-flex-negative:0;flex-shrink:0;border-bottom:1px solid var(--color-grey-3)}.zea-tabs.vertical .zea-tabs-bar{width:10em;-ms-flex-negative:0;flex-shrink:0;height:auto;border-bottom:none;border-right:1px solid var(--color-grey-3)}.zea-tabs-content{-ms-flex-positive:1;flex-grow:1;padding-top:1em;height:calc(100% - 30px)}::slotted(:not([slot='tab-bar'])){display:none}::slotted(.active:not([slot='tab-bar'])){display:block;max-height:100%;}::slotted([slot='tab-bar']){font-weight:bold;color:var(--color-foreground-1);cursor:pointer;display:inline-block;padding:1em 1em 0.5em}.small ::slotted([slot='tab-bar']){padding:0.5em 1em 0.5em}::slotted([slot='tab-bar']:hover){color:var(--color-secondary-1)}::slotted(.active[slot='tab-bar']){border-bottom:0.2em solid var(--color-secondary-1);color:var(--color-secondary-1)}.vertical ::slotted([slot='tab-bar']){border-bottom:none;border-left:0.3em solid transparent;padding:1.4em 1em}.vertical ::slotted(.active[slot='tab-bar']){border-bottom:none;border-left:0.3em solid var(--color-secondary-1)}.vertical .zea-tabs-bar{padding-top:2em;padding-left:0}",ZeaTabs=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.orientation="horizontal",this.density="medium"}clickHandler(t){if("tab-bar"==t.target.getAttribute("slot")){let e=this.getTabIndex(t.target);this.showPanelByIndex(e),this.resetActiveTab(),t.target.classList.add("active")}}showPanelByIndex(t){const e=this.mainElement.shadowRoot.querySelector("slot:not([name])").assignedElements(),i=Array.prototype.slice.call(e);for(const n in e)e.hasOwnProperty(n)&&e[n].classList.remove("active");i[t].classList.add("active")}getTabIndex(t){const e=this.mainElement.shadowRoot.querySelector('slot[name="tab-bar"]').assignedElements();return Array.prototype.slice.call(e).indexOf(t)}resetActiveTab(){const t=this.mainElement.shadowRoot.querySelector('slot[name="tab-bar"]').assignedElements();for(const e in t)t.hasOwnProperty(e)&&t[e].classList.remove("active")}componentDidLoad(){const t=this.mainElement.shadowRoot.querySelector('slot[name="tab-bar"]').assignedElements()[0],e=document.createEvent("Events");e.initEvent("click",!0,!1),t.dispatchEvent(e)}render(){return h("div",{class:`zea-tabs ${this.orientation} ${this.density}`},h("div",{class:"zea-tabs-bar"},h("slot",{name:"tab-bar"})),h("div",{class:"zea-tabs-content"},h("slot",null)))}get mainElement(){return this}static get style(){return zeaTabsCss}},zeaThumbnailCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.ZeaThumbnail{border-radius:4px;border:1px solid #cbcbcb;width:216px}.ZeaThumbnail--selected{-webkit-box-shadow:0 0 0.5rem var(--color-foreground-1);box-shadow:0 0 0.5rem var(--color-foreground-1)}.ZeaThumbnail__icon{color:var(--color-foreground-3);font-size:24px}.ZeaThumbnail__name{color:var(--color-foreground-1);font-size:14px;margin-left:0.5rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ZeaThumbnail__thumbnail{border-radius:4px 4px 0 0;display:block;height:122px;background-size:cover;background-repeat:no-repeat;background-position:50%;width:100%}.ZeaThumbnail__footer{-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;height:56px;padding:0.5rem}.ZeaThumbnail__progress{height:6px;border-radius:4px}",ZeaThumbnail=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.handleClick=this.handleClick.bind(this),this.handleDblClick=this.handleDblClick.bind(this),this.clickThumbnail=createEvent(this,"clickThumbnail",7),this.dblClickThumbnail=createEvent(this,"dblClickThumbnail",7)}componentWillLoad(){this.subToFileProgress()}componentWillUpdate(){this.subToFileProgress()}subToFileProgress(){this.zeaSession&&this.zeaSession.sub(o.actions.FILE_WITH_PROGRESS,t=>{const e=t.file;e.id===this.zeaModelInstance.id&&(this.fileProgress=e.progress)})}handleClick(){this.clickThumbnail.emit(this.zeaModelInstance),this.isSelected=!this.isSelected}handleDblClick(){this.dblClickThumbnail.emit(this.zeaModelInstance)}render(){return h("div",{class:{ZeaThumbnail:!0,"ZeaThumbnail--selected":this.isSelected},title:this.zeaModelInstance.name,onClick:this.handleClick,onDblClick:this.handleDblClick},this.zeaModelInstance.thumbnail&&h("div",{class:"ZeaThumbnail__thumbnail",style:{backgroundImage:`url("${this.zeaModelInstance.thumbnail}")`}}),h("div",{class:"ZeaThumbnail__footer"},h("span",{class:"ZeaThumbnail__icon"},this.icon),h("span",{class:"ZeaThumbnail__name"},this.zeaModelInstance.name)),this.fileProgress&&h("div",{class:"ZeaThumbnail__progress",style:{backgroundColor:this.fileProgress.indicatorColor,width:this.fileProgress.percentageCompleted+"%"}}))}static get style(){return zeaThumbnailCss}},zeaToolbarCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}:root{--toolbar-active-color:var(--color-primary-2)}.zea-toolbar{color:var(--color-foreground-1);background-color:var(--color-background-2);position:fixed;border-radius:30px}",ZeaToolbar=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.offset=[0,0],this.tools={}}mousedownHandler(t){"ZEA-TOOLBAR"==t.currentTarget.tagName&&(this.mouseIsDown=!0,this.offset=[this.toolbarElement.offsetLeft-t.clientX,this.toolbarElement.offsetTop-t.clientY])}mouseupHandler(){this.mouseIsDown=!1}mousemoveHandler(t){this.mouseIsDown&&(this.toolbarElement.style.left=t.clientX+this.offset[0]+"px",this.toolbarElement.style.top=t.clientY+this.offset[1]+"px")}render(){const t=Object.keys(this.tools);return h("div",{class:"zea-toolbar",ref:t=>this.toolbarElement=t},t&&t.map(t=>{const e=this.tools[t];return h(e.tag,{data:e.data,key:t})}))}static get style(){return zeaToolbarCss}},zeaToolbarColorpickerCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-colopicker{background-repeat:no-repeat;background-position:37px 20px;background-size:5px;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAxQzcxOEE3NjJFQjExRUFBQzdFRTU5MkM3MEIwNjY1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAxQzcxOEE4NjJFQjExRUFBQzdFRTU5MkM3MEIwNjY1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDFDNzE4QTU2MkVCMTFFQUFDN0VFNTkyQzcwQjA2NjUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDFDNzE4QTY2MkVCMTFFQUFDN0VFNTkyQzcwQjA2NjUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz59SANnAAAAN0lEQVR42qTMwQ0AIAwDsTI5oxt1Be6kPJ2DCd3Zg89dFatYxSpWsYpVrGIVq1jFKlaxircnwACIPE/UtxKEdgAAAABJRU5ErkJggg==')}.children{position:absolute;margin-left:56px;margin-top:-42px;background-color:var(--color-background-2);border-radius:20px;display:grid;grid-gap:10px;padding:10px;grid-template-columns:1fr 1fr 1fr}.colorpicker-color{width:26px;height:26px;border-radius:15px;margin:11px}.children .colorpicker-color{margin:0px}",ZeaToolbarColorpicker=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.children=[],this.mouseIsdown=!1}componentDidLoad(){this.setActiveTool({})}setActiveTool(t){this.currentTool||(this.currentTool=this.children.shift()),this.currentContainer.appendChild(this.currentTool),this.displayChildren=!1,document.documentElement.style.setProperty("--toolbar-active-fg-color",this.currentTool.style.color),document.documentElement.style.setProperty("--toolbar-active-bg-color",this.currentTool.style.backgroundColor);const e=this.currentTool.getAttribute("data-key");"callback"in this.data.colors[e]&&this.data.colors[e].callback(t)}handleChildrenClick(t){this.childrenContainer.style.display="none";const e=t.currentTarget;e==this.currentTool?this.displayChildren?this.displayChildren=!1:(this.displayChildren=!0,this.currentTool=e):this.children.includes(e)&&(this.childrenContainer.appendChild(this.currentTool),this.children.push(this.currentTool),this.currentTool=e,this.setActiveTool(t))}render(){const t=Object.keys(this.data.colors);return h("div",{class:"zea-colopicker",ref:t=>this.colopickerElement=t},h("div",{class:"current",ref:t=>this.currentContainer=t}),h("div",{class:"children",style:{display:this.displayChildren?"grid":"none"},ref:t=>this.childrenContainer=t},t&&t.map(t=>{const e=this.data.colors[t];return h("div",{class:"colorpicker-color",style:{backgroundColor:e.background,color:e.foreground},"data-key":t,key:t,onClick:this.handleChildrenClick.bind(this),ref:t=>this.children.push(t)})})))}static get style(){return zeaToolbarColorpickerCss}},zeaToolbarToolCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.tool-wrap{padding:8px;margin:4px;border-radius:20px;color:var(--color-foreground-1)}.tool-wrap:hover{background-color:var(--color-grey-3)}.tool-wrap.active,.tool-wrap.active:hover{background-color:var(--toolbar-active-bg-color, var(--color-primary-1));color:var(--toolbar-active-fg-color, var(--color-background-1))}",ZeaToolbarTool=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.zeaToolbarToolClick=createEvent(this,"zeaToolbarToolClick",7)}zeaToolbarToolClickHandler(){this.isActive=!1}toolClickHandler(t){this.zeaToolbarToolClick.emit(this.hostElement),this.isActive=!0,"callback"in this.data&&this.data.callback(t)}render(){return h("div",{ref:t=>this.outerWrap=t,class:"tool-wrap "+(this.isActive?"active":""),title:this.data.toolName,onClick:this.toolClickHandler.bind(this)},h("zea-icon",{name:this.data.iconName,type:this.data.iconType}))}get hostElement(){return this}static get style(){return zeaToolbarToolCss}},zeaToolbarToolsetCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-toolset{background-repeat:no-repeat;background-position:38px 34px;background-size:5px;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAxQzcxOEE3NjJFQjExRUFBQzdFRTU5MkM3MEIwNjY1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAxQzcxOEE4NjJFQjExRUFBQzdFRTU5MkM3MEIwNjY1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDFDNzE4QTU2MkVCMTFFQUFDN0VFNTkyQzcwQjA2NjUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDFDNzE4QTY2MkVCMTFFQUFDN0VFNTkyQzcwQjA2NjUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz59SANnAAAAN0lEQVR42qTMwQ0AIAwDsTI5oxt1Be6kPJ2DCd3Zg89dFatYxSpWsYpVrGIVq1jFKlaxircnwACIPE/UtxKEdgAAAABJRU5ErkJggg==')}.children{position:absolute;margin-left:56px;margin-top:-48px;background-color:var(--color-background-2);border-radius:30px;display:-ms-flexbox;display:flex}",ZeaToolbar$1=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.children=[],this.mouseIsdown=!1}zeaToolbarToolClickHandler(t){this.childrenContainer.style.display="none";const e=t.detail;this.currentTool!=e?this.children.includes(e)&&(this.children.push(this.currentTool),this.childrenContainer.appendChild(this.currentTool),this.currentTool=e,this.setActiveTool()):e.isActive&&(this.childrenContainer.style.display="flex")}componentDidLoad(){this.setActiveTool()}setActiveTool(){this.currentTool||(this.currentTool=this.children.shift()),this.currentContainer.appendChild(this.currentTool),this.childrenContainer.style.display="none"}render(){const t=Object.keys(this.data.tools);return h("div",{class:"zea-toolset",ref:t=>this.toolsetElement=t},h("div",{class:"current",ref:t=>this.currentContainer=t}),h("div",{class:"children",ref:t=>this.childrenContainer=t},t&&t.map(t=>{const e=this.data.tools[t];return h(e.tag,{key:t,data:e.data,ref:t=>this.children.push(t)})})))}get hostElement(){return this}static get style(){return zeaToolbarToolsetCss}},zeaTreeItemElementCss=":host{display:block;font-size:14px}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.wrap{opacity:0.7;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.wrap.visible{opacity:1}.header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin:4px 0;position:relative;left:-7px}.arrow{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;cursor:pointer;padding:2px}.label{white-space:nowrap}.toggle{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;font-size:1.2em;margin:0 1px 0 4px}.children{padding-left:19px;border-left:1px dotted gray}zea-tree-item-element{margin-left:16px}zea-tree-item-element.has-children{margin-left:0}.zea-tree-item-label{padding:3px 5px;border-radius:4px;border:1px solid transparent;margin-left:22px;white-space:nowrap}.is-tree-item .zea-tree-item-label{margin-left:0}.highlighted .zea-tree-item-label{background-color:var(\n    --treeview-highlight-bg-color,\n    var(--color-secondary-3)\n  );border:1px solid var(--treeview-highlight-color, var(--color-secondary-1))}.selected .zea-tree-item-label{background-color:var(--treeview-highlight-color, var(--color-secondary-1));border:1px solid var(--treeview-highlight-color, var(--color-secondary-1))}",ZeaTreeItemElement=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.label="Loading...",this.isRoot=!1,this.isTreeItem=!1,this.isSelected=!1,this.isVisible=!1,this.isHighlighted=!1,this.isExpanded=!1,this.childItems=[]}treeItemChanged(){this.treeItem&&this.initTreeItem()}componentWillLoad(){this.treeItem&&(this.initTreeItem(),this.updateSelected(),this.updateVisibility(),this.updateHighlight(),this.childItems.length?this.rootElement.classList.add("has-children"):this.rootElement.classList.remove("has-children"),this.treeItem.titleElement=this.rootElement)}initTreeItem(){this.label=this.treeItem.getName(),this.nameChangedId=this.treeItem.on("nameChanged",()=>{this.label=this.treeItem.getName()}),this.updateSelectedId=this.treeItem.on("selectedChanged",this.updateSelected.bind(this)),"function"==typeof this.treeItem.getChildren?(this.isTreeItem=!0,this.childItems=[...this.treeItem.getChildren()],this.childAddedId=this.treeItem.on("childAdded",()=>{this.childItems=[...this.treeItem.getChildren()]}),this.childRemovedId=this.treeItem.on("childRemoved",()=>{this.childItems=[...this.treeItem.getChildren()]}),this.updateVisibilityId=this.treeItem.on("visibilityChanged",this.updateVisibility.bind(this))):(this.isTreeItem=!1,this.isVisible=!0),this.updateHighlightId=this.treeItem.on("highlightChanged",this.updateHighlight.bind(this))}updateSelected(){this.treeItem&&"isSelected"in this.treeItem&&(this.isSelected=this.treeItem.isSelected())}updateVisibility(){this.treeItem&&"isVisible"in this.treeItem&&(this.isVisible=this.treeItem.isVisible())}updateHighlight(){var t,e;if(this.treeItem&&"isHighlighted"in this.treeItem&&(this.isHighlighted=this.treeItem.isHighlighted(),this.isHighlighted&&"getHighlight"in this.treeItem)){const i=this.treeItem.getHighlight(),n=i.lerp(new y$2(.75,.75,.75,0),.5);console.log("this.itemContainer",this.itemContainer),null===(t=this.itemContainer)||void 0===t||t.style.setProperty("--treeview-highlight-bg-color",n.toHex()+"60"),null===(e=this.itemContainer)||void 0===e||e.style.setProperty("--treeview-highlight-color",i.toHex())}}toggleChildren(){this.isExpanded=!this.isExpanded}onVisibilityToggleClick(){const t=this.treeItem.getParameter("Visible");if(this.appData&&this.appData.undoRedoManager){const e=new N$2(t,!t.getValue());this.appData.undoRedoManager.addChange(e)}else t.setValue(!t.getValue())}onLabelClick(t){this.appData&&this.appData.selectionManager?this.appData.selectionManager.pickingModeActive()?this.appData.selectionManager.pick(this.treeItem):this.appData.selectionManager.toggleItemSelection(this.treeItem,!t.ctrlKey):this.treeItem.setSelected(!this.treeItem.getSelected())}render(){return h("div",{class:{wrap:!0,"has-children":this.childItems.length,selected:this.isSelected,visible:this.isVisible,highlighted:this.isHighlighted,"is-tree-item":this.isTreeItem},style:{display:"block"},ref:t=>this.itemContainer=t},h("div",{class:"header"},h("div",{class:"arrow",style:{display:this.childItems.length>0?"block":"none"},onClick:()=>this.toggleChildren()},h("span",null,h("zea-icon",this.isExpanded?{name:"caret-down",size:12}:{name:"caret-forward",size:12}))),this.isTreeItem&&h("div",{class:"toggle",onClick:this.onVisibilityToggleClick.bind(this)},h("zea-icon",{name:this.isVisible?"eye-outline":"eye-off-outline",ref:t=>this.visibilityIcon=t,size:16})),h("div",{class:"zea-tree-item-label",onClick:this.onLabelClick.bind(this)},this.label)),this.isTreeItem&&h("div",{class:"children",style:{display:this.isExpanded?"block":"none"}},this.isExpanded&&this.childItems.map(t=>h("zea-tree-item-element",{treeItem:t,appData:this.appData}))))}get rootElement(){return this}static get watchers(){return{treeItem:["treeItemChanged"]}}static get style(){return zeaTreeItemElementCss}},zeaTreeViewCss=":host{display:block;height:100%}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.wrap{height:100%;padding:0.5em;overflow:auto;-webkit-box-sizing:border-box;box-sizing:border-box;color:var(--color-foreground-1)}",ZeaTreeView=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this)}onKeyDown(t){if(!this.mouseIsOver)return;const{selectionManager:e}=this.appData;if(e){if("ArrowLeft"==t.key){const i=Array.from(e.getSelection())[0];return this.collapseSelection(i),t.preventDefault(),void t.stopPropagation()}if("ArrowRight"==t.key){const i=Array.from(e.getSelection())[0];return this.expandSelection(i),t.preventDefault(),void t.stopPropagation()}if("ArrowUp"==t.key){const i=Array.from(e.getSelection())[0],n=new Set,s=i.getOwner();if(s){const t=s.getChildIndex(i),e=s.getChild(t-1);n.add(0==t?s:e&&e.getNumChildren&&e.titleElement.isExpanded?e.getChild(e.getNumChildren()-1):i.getOwner().getChild(t-1))}return n.size>0&&e.setSelection(n),t.preventDefault(),void t.stopPropagation()}if("ArrowDown"==t.key){const i=Array.from(e.getSelection())[0],n=new Set;if(i&&i.getChild&&i.titleElement.isExpanded)n.add(i.getChild(0));else if(i.getOwner){const t=i.getOwner().getChildIndex(i);if(t==i.getOwner().getNumChildren()-1){const t=i.getOwner(),e=t.getOwner();if(t&&e){const i=e.getChildIndex(t);i==e.getNumChildren()-1||n.add(e.getChild(i+1))}}else n.add(i.getOwner().getChild(t+1))}return n.size>0&&e.setSelection(n),t.preventDefault(),void t.stopPropagation()}}}expandSelection(t,e=!0){t.getNumChildren()&&t.titleElement&&!t.titleElement.isExpanded&&(t.titleElement.isExpanded=!0),e&&this.scrollItemIntoView(t)}collapseSelection(t,e=!0){t.getNumChildren()&&t.titleElement.isExpanded&&(t.titleElement.isExpanded=!1),e&&this.scrollItemIntoView(t)}scrollItemIntoView(t){t&&t.titleElement&&t.titleElement.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}onMouseEnter(){this.mouseIsOver=!0}onMouseLeave(){this.mouseIsOver=!1}render(){return h(Host,null,h("div",{class:"wrap",onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},h("zea-tree-item-element",{ref:t=>{this.rootItem&&(this.rootItem.titleElement=t)},"is-root":"true","expand-on-load":"true",treeItem:this.rootItem,appData:this.appData,isExpanded:!0})))}static get style(){return zeaTreeViewCss}},zeaUserCardCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-user-card{color:var(--color-foreground-1);font-size:13px}.zea-user-card{min-width:290px;background-color:var(--color-background-2);display:grid;grid-template-columns:-webkit-min-content auto -webkit-min-content;grid-template-columns:min-content auto min-content;-ms-flex-align:start;align-items:flex-start;position:relative;z-index:10000000}.zea-user-card.small{min-width:280px}.user-chip-container,.user-focuser-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.user-focuser-container zea-icon{}.user-focuser{padding:8px}.zea-user-card .user-info{padding-left:0}.user-name{padding-top:5px;padding-bottom:4px}.user-company{color:var(--color-foreground-3)}.zea-user-card>*{padding:10px}.additional-data{grid-column-start:1;grid-column-end:4;grid-gap:1em;padding:1em;border-top:1px solid var(--color-grey-3);display:none}.additional-data.shown{display:grid}.user-phone,.user-email{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.user-phone zea-icon,.user-email zea-icon{-ms-flex-positive:0;flex-grow:0;width:32px}.profile-link{font-size:13px;color:var(--color-secondary-1);margin-top:3px;cursor:pointer}.additional-data-collapser{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;grid-column-start:span 3;padding-left:15px;padding-top:5px}.collapser-label{-ms-flex-positive:1;flex-grow:1}.small{font-size:12px}.small .additional-data{display:none !important}.small .user-company{display:none}.small .user-chip-container{padding:5px}.small .user-focuser-container{padding:0}:host-context(.overflow-entry.shown){-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid var(--color-grey-3);margin-right:10px}zea-dialog-profile{z-index:100000000}@media only screen and (max-width: 667px){.zea-user-card{width:100%;position:fixed;left:0}}",ZeaUserCard=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.isCurrentUser=!1,this.collapsible=!0,this.density="normal"}componentWillLoad(){this.additionalDataShown=!this.collapsible}onProfileLinkClick(){this.profileDialog.shown=!0}render(){const t=this.userData.firstName||this.userData.given_name,e=this.userData.lastName||this.userData.family_name,i=this.userData.company,n=this.userData.phone,s=this.userData.email;return h("div",{class:"zea-user-card "+this.density},h("div",{class:"user-chip-container"},h("zea-user-chip",{showProfileCard:!1,showTooltip:!1,userData:this.userData,density:"normal"==this.density?"large":this.density})),h("div",{class:"user-info"},h("div",{class:"user-name"},t," ",e),h("div",{class:"user-company"},i),this.isCurrentUser&&h("div",{onClick:this.onProfileLinkClick.bind(this),class:"profile-link"},"My Profile")),!this.isCurrentUser&&h("div",{class:"user-focuser-container"},h("div",{class:"user-focuser"},h("zea-icon",{name:"find-user",size:28}))),!this.isCurrentUser&&this.collapsible&&(n||s)&&h("div",{class:"additional-data-collapser",onClick:()=>this.additionalDataShown=!this.additionalDataShown},h("span",{class:"collapser-label"},this.additionalDataShown?"Less":"More"),h("span",{class:"collapser-icon"},h("zea-icon",{name:this.additionalDataShown?"chevron-up-outline":"chevron-down-outline",size:14}))),!this.isCurrentUser&&(n||s)&&h("div",{class:{"additional-data":!0,shown:this.additionalDataShown}},n&&h("div",{class:"user-phone"},h("zea-icon",{name:"phone-portrait-outline"}),h("span",null,n)),s&&h("div",{class:"user-email"},h("zea-icon",{name:"mail-outline"}),h("span",null,s))),this.isCurrentUser&&h("zea-dialog-profile",{ref:t=>this.profileDialog=t,userData:this.userData}))}static get style(){return zeaUserCardCss}},zeaUserChipCss=":host{z-index:100000000}:host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-chip{color:var(--color-foreground-1);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.zea-chip-avatar{border:2px solid var(--color-background-2);width:32px;height:32px;border-radius:18px;color:white;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;position:relative;font-size:13px}.active .zea-chip-avatar{-webkit-box-shadow:0px 0px 1px 2px var(--color-primary-1);box-shadow:0px 0px 1px 2px var(--color-primary-1)}.avatar-image{position:absolute;top:0;left:0;bottom:0;right:0;border-radius:18px;background-size:cover;background-position:center center}.empty-user-chip{display:none}.small .zea-chip-avatar{width:28px;height:28px;border-radius:36px;font-size:13px}.small .avatar-image{border-radius:36px}.large .zea-chip-avatar{width:60px;height:60px;border-radius:36px;font-size:18px}.large .avatar-image{border-radius:36px}zea-user-card{position:absolute;margin-top:3px}zea-user-card.align-right{margin-left:-256px}.tooltip{position:absolute;padding:4px 7px;border-radius:4px;font-size:12px;color:var(--color-foreground-1);background-color:var(--color-grey-3);z-index:100000000;white-space:nowrap;margin-left:18px;-webkit-transform:translateX(-50%);transform:translateX(-50%);display:none}.zea-chip:hover .tooltip{display:block}.tooltip.bleeded-right{right:0;-webkit-transform:none;transform:none}.tooltip.bleeded-left{left:0;margin-left:0;-webkit-transform:none;transform:none}@media only screen and (max-width: 667px){zea-user-card{position:fixed;width:100%;left:0}}@media only screen and (max-width: 667px), only screen and (max-height: 667px){.tooltip{display:none !important}}",ZeaUserChip=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.isCurrentUser=!1,this.isActive=!1,this.showImages=!0,this.density="normal",this.showTooltip=!0,this.showProfileCard=!0,this.profileCardShown=!1,this.profileCardAlign="left",this.randomColor="#000000".replace(/0/g,()=>(~~(5+7*Math.random())).toString(16)),this.zeaUserClicked=createEvent(this,"zeaUserClicked",7)}handleClick(t){t.composedPath().includes(this.chipElement)?t.composedPath().includes(this.profileCardElement)||(this.profileCardShown=!this.profileCardShown):this.profileCardShown=!1}onChipClick(t){this.zeaUserClicked.emit(this.userData),t.stopPropagation()}onAvatarOver(){this.fixTooltipPosition()}componentDidRender(){this.fixTooltipPosition()}fixTooltipPosition(){if(!this.tooltipElement)return;const t=this.tooltipElement.getBoundingClientRect();t.x+t.width>window.innerWidth?this.tooltipElement.classList.add("bleeded-right"):this.tooltipElement.classList.remove("bleeded-right"),t.x<0?this.tooltipElement.classList.add("bleeded-left"):this.tooltipElement.classList.remove("bleeded-left")}render(){if(!this.userData)return h("span",{class:"empty-user-chip"});const t=this.userData.firstName||this.userData.given_name,e=this.userData.lastName||this.userData.family_name,i=this.userData.avatar||this.userData.picture;let n="",s=this.userData.color;{let i="",s="";t&&(i=t.charAt(0)),e?s=e.charAt(0):i&&(s=t.charAt(1)),n=String(i+s).toUpperCase()}s||(s=this.randomColor,this.userData.color=this.randomColor);const o={active:this.isActive,"zea-chip":!0};return o[this.density]=!0,h("div",{ref:t=>this.chipElement=t,class:o,onClick:this.onChipClick.bind(this)},h("div",{class:"zea-chip-avatar",onMouseOver:this.onAvatarOver.bind(this),style:{backgroundColor:s}},h("span",null,n),this.showImages&&!!i&&h("div",{class:"avatar-image",style:{backgroundImage:`url(${i})`}})),this.showTooltip&&!this.profileCardShown&&h("div",{ref:t=>this.tooltipElement=t,class:"tooltip"},`${t} ${e||""}`),this.showProfileCard&&h("zea-user-card",{collapsible:!0,isCurrentUser:this.isCurrentUser,ref:t=>this.profileCardElement=t,class:"align-"+this.profileCardAlign,style:{display:this.profileCardShown?"block":"none"},userData:this.userData}))}static get style(){return zeaUserChipCss}},zeaUserChipSetCss=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-chip-set{color:var(--color-foreground-1);display:-ms-flexbox;display:flex;position:relative}zea-user-chip{margin-left:-8px;width:36px;height:36px;border:1px solid transparent;border-radius:19px}.overflow-thumb{border:2px solid var(--color-background-3);background-color:var(--color-background-3);width:36px;height:36px;color:var(--color-foreground-2);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;position:relative;font-size:13px;margin-left:-8px;border-radius:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.overflow-tooltip{position:absolute;top:35px;padding:4px 7px;border-radius:4px;font-size:12px;color:var(--color-foreground-1);background-color:var(--color-grey-3);z-index:10000;white-space:nowrap;display:none}.overflow-thumb:hover .overflow-tooltip{display:block}.overflow-list{max-height:calc(100vh - 60px);width:-webkit-min-content;width:-moz-min-content;width:min-content;overflow-y:auto;background-color:var(--color-background-2);display:none}.overflow-list.shown{display:block;position:absolute}.overflow-list zea-user-card{display:block;}.overflow-entry{display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch}.overflow-entry-collapser{padding-left:8px;padding-top:14px;padding-right:8px}",ZeaUserChipSet=class extends HTMLElement{constructor(){super(),this.__registerHost(),attachShadow(this),this.showImages=!0,this.initialZIndex=1e3,this.overflowLimit=5,this.overflowShown=!1,this.shownOverflowEntry=null}sessionChanged(){this.setupSession()}componentWillLoad(){setTimeout(()=>{this.setupSession()},500)}setupSession(){if(this.session&&"sub"in this.session){const t=[];for(let e in this.session.users)this.session.users.hasOwnProperty(e)&&t.push(this.session.users[e]);this.userDatas=t,this.session.sub("user-joined",t=>{this.userDatas.find(e=>e.id==t.id)||(this.userDatas=[t,...this.userDatas])}),this.session.sub("user-left",t=>{const e=this.userDatas.findIndex(e=>e.id==t.id);if(-1==e)return void console.warn("User id not in session:",t.id);const i=[...this.userDatas];i.splice(e,1),this.userDatas=i}),this.session.sub("userChanged",t=>{this.session.users[t.id]=t;const e=[];for(let i in this.session.users)this.session.users.hasOwnProperty(i)&&e.push(this.session.users[i]);this.userDatas=e})}else this.userDatas=[]}onChipClick(t){t.stopPropagation()}render(){if(!this.userDatas)return;const t=this.userDatas.slice(0,this.overflowLimit),e=this.userDatas.slice(this.overflowLimit);return h("div",{class:"zea-chip-set"},t&&t.map(t=>h("zea-user-chip",{showImages:this.showImages,key:t.id,userData:t,onClick:this.onChipClick.bind(this)})),e.length>0&&h("div",{class:"overflow"},h("div",{class:"overflow-thumb",onClick:t=>{this.overflowShown=!this.overflowShown,t.stopPropagation()}},["+"+(this.userDatas.length-this.overflowLimit),!this.overflowShown&&h("div",{class:"overflow-tooltip"},"Show All")]),h("div",{class:{"overflow-list":!0,shown:this.overflowShown}},e.map(t=>h("div",{key:t.id,class:{"overflow-entry":!0,shown:this.shownOverflowEntry==t.id}},h("div",{class:"overflow-entry-collapser",onClick:e=>{this.shownOverflowEntry=this.shownOverflowEntry==t.id?null:t.id,e.currentTarget.scrollIntoView()}},h("zea-icon",{name:this.shownOverflowEntry==t.id?"chevron-up-outline":"chevron-down-outline",size:14})),h("zea-user-card",{userData:t,collapsible:!1,density:this.shownOverflowEntry==t.id?"normal":"small"}))))))}static get watchers(){return{session:["sessionChanged"]}}static get style(){return zeaUserChipSetCss}};globalScripts();const IonActionSheet=proxyCustomElement(ActionSheet,[2,"ion-action-sheet",{overlayIndex:[2,"overlay-index"],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],buttons:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],header:[1],subHeader:[1,"sub-header"],translucent:[4],animated:[4]}]),IonAlert=proxyCustomElement(Alert,[2,"ion-alert",{overlayIndex:[2,"overlay-index"],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],cssClass:[1,"css-class"],header:[1],subHeader:[1,"sub-header"],message:[1],buttons:[16],inputs:[1040],backdropDismiss:[4,"backdrop-dismiss"],translucent:[4],animated:[4]}]),IonApp=proxyCustomElement(App,[0,"ion-app"]),IonAvatar=proxyCustomElement(Avatar,[1,"ion-avatar"]),IonBackButton=proxyCustomElement(BackButton,[1,"ion-back-button",{color:[1],defaultHref:[1,"default-href"],disabled:[516],icon:[1],text:[1],type:[1]}]),IonBackdrop=proxyCustomElement(Backdrop,[1,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"touchstart","onTouchStart"],[2,"click","onMouseDown"],[2,"mousedown","onMouseDown"]]]),IonBadge=proxyCustomElement(Badge,[1,"ion-badge",{color:[1]}]),IonButton=proxyCustomElement(Button,[1,"ion-button",{color:[1],buttonType:[1025,"button-type"],disabled:[516],expand:[513],fill:[1537],routerDirection:[1,"router-direction"],download:[1],href:[1],rel:[1],shape:[513],size:[513],strong:[4],target:[1],type:[1]}]),IonButtons=proxyCustomElement(Buttons,[2,"ion-buttons",{collapse:[4]}]),IonCard=proxyCustomElement(Card,[1,"ion-card",{color:[1],button:[4],type:[1],disabled:[4],download:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],target:[1]}]),IonCardContent=proxyCustomElement(CardContent,[0,"ion-card-content"]),IonCardHeader=proxyCustomElement(CardHeader,[1,"ion-card-header",{color:[1],translucent:[4]}]),IonCardSubtitle=proxyCustomElement(CardSubtitle,[1,"ion-card-subtitle",{color:[1]}]),IonCardTitle=proxyCustomElement(CardTitle,[1,"ion-card-title",{color:[1]}]),IonCheckbox=proxyCustomElement(Checkbox,[1,"ion-checkbox",{color:[1],name:[1],checked:[1028],indeterminate:[1028],disabled:[4],value:[1]}]),IonChip=proxyCustomElement(Chip,[1,"ion-chip",{color:[1],outline:[4]}]),IonCol=proxyCustomElement(Col,[1,"ion-col",{offset:[1],offsetXs:[1,"offset-xs"],offsetSm:[1,"offset-sm"],offsetMd:[1,"offset-md"],offsetLg:[1,"offset-lg"],offsetXl:[1,"offset-xl"],pull:[1],pullXs:[1,"pull-xs"],pullSm:[1,"pull-sm"],pullMd:[1,"pull-md"],pullLg:[1,"pull-lg"],pullXl:[1,"pull-xl"],push:[1],pushXs:[1,"push-xs"],pushSm:[1,"push-sm"],pushMd:[1,"push-md"],pushLg:[1,"push-lg"],pushXl:[1,"push-xl"],size:[1],sizeXs:[1,"size-xs"],sizeSm:[1,"size-sm"],sizeMd:[1,"size-md"],sizeLg:[1,"size-lg"],sizeXl:[1,"size-xl"]},[[9,"resize","onResize"]]]),IonContent=proxyCustomElement(Content,[1,"ion-content",{color:[1],fullscreen:[4],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"]},[[8,"appload","onAppLoad"],[2,"click","onClick"]]]),IonDatetime=proxyCustomElement(Datetime,[1,"ion-datetime",{name:[1],disabled:[4],readonly:[4],min:[1025],max:[1025],displayFormat:[1,"display-format"],displayTimezone:[1,"display-timezone"],pickerFormat:[1,"picker-format"],cancelText:[1,"cancel-text"],doneText:[1,"done-text"],yearValues:[8,"year-values"],monthValues:[8,"month-values"],dayValues:[8,"day-values"],hourValues:[8,"hour-values"],minuteValues:[8,"minute-values"],monthNames:[1,"month-names"],monthShortNames:[1,"month-short-names"],dayNames:[1,"day-names"],dayShortNames:[1,"day-short-names"],pickerOptions:[16],placeholder:[1],value:[1025],isExpanded:[32]}]),IonFab=proxyCustomElement(Fab,[1,"ion-fab",{horizontal:[1],vertical:[1],edge:[4],activated:[1028]}]),IonFabButton=proxyCustomElement(FabButton,[1,"ion-fab-button",{color:[1],activated:[4],disabled:[4],download:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],target:[1],show:[4],translucent:[4],type:[1],size:[1]}]),IonFabList=proxyCustomElement(FabList,[1,"ion-fab-list",{activated:[4],side:[1]}]),IonFooter=proxyCustomElement(Footer,[4,"ion-footer",{translucent:[4]}]),IonGrid=proxyCustomElement(Grid,[1,"ion-grid",{fixed:[4]}]),IonHeader=proxyCustomElement(Header,[4,"ion-header",{collapse:[1],translucent:[4]}]),IonIcon=proxyCustomElement(Icon,[1,"ion-icon",{mode:[1025],color:[1],ariaLabel:[1537,"aria-label"],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[1],src:[1],icon:[8],size:[1],lazy:[4],svgContent:[32],isVisible:[32]}]),IonImg=proxyCustomElement(Img,[1,"ion-img",{alt:[1],src:[1],loadSrc:[32],loadError:[32]}]),IonInfiniteScroll=proxyCustomElement(InfiniteScroll,[0,"ion-infinite-scroll",{threshold:[1],disabled:[4],position:[1],isLoading:[32]}]),IonInfiniteScrollContent=proxyCustomElement(InfiniteScrollContent,[0,"ion-infinite-scroll-content",{loadingSpinner:[1025,"loading-spinner"],loadingText:[1,"loading-text"]}]),IonInput=proxyCustomElement(Input,[2,"ion-input",{color:[1],accept:[1],autocapitalize:[1],autocomplete:[1],autocorrect:[1],autofocus:[4],clearInput:[4,"clear-input"],clearOnEdit:[4,"clear-on-edit"],debounce:[2],disabled:[4],inputmode:[1],max:[1],maxlength:[2],min:[1],minlength:[2],multiple:[4],name:[1],pattern:[1],placeholder:[1],readonly:[4],required:[4],spellcheck:[4],step:[1],size:[2],type:[1],value:[1032],hasFocus:[32]}]),IonItem=proxyCustomElement(Item,[1,"ion-item",{color:[1],button:[4],detail:[4],detailIcon:[1,"detail-icon"],disabled:[4],download:[1],href:[1],rel:[1],lines:[1],routerDirection:[1,"router-direction"],target:[1],type:[1],multipleInputs:[32]},[[0,"ionStyle","itemStyle"]]]),IonItemDivider=proxyCustomElement(ItemDivider,[1,"ion-item-divider",{color:[1],sticky:[4]}]),IonItemGroup=proxyCustomElement(ItemGroup,[0,"ion-item-group"]),IonItemOption=proxyCustomElement(ItemOption,[1,"ion-item-option",{color:[1],disabled:[4],download:[1],expandable:[4],href:[1],rel:[1],target:[1],type:[1]}]),IonItemOptions=proxyCustomElement(ItemOptions,[0,"ion-item-options",{side:[1]}]),IonItemSliding=proxyCustomElement(ItemSliding,[0,"ion-item-sliding",{disabled:[4],state:[32]}]),IonLabel=proxyCustomElement(Label,[2,"ion-label",{color:[1],position:[1],noAnimate:[32]}]),IonList=proxyCustomElement(List,[0,"ion-list",{lines:[1],inset:[4]}]),IonListHeader=proxyCustomElement(ListHeader,[1,"ion-list-header",{color:[1],lines:[1]}]),IonLoading=proxyCustomElement(Loading,[2,"ion-loading",{overlayIndex:[2,"overlay-index"],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],message:[1],cssClass:[1,"css-class"],duration:[2],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],spinner:[1025],translucent:[4],animated:[4]}]),IonMenu=proxyCustomElement(Menu,[1,"ion-menu",{contentId:[513,"content-id"],menuId:[513,"menu-id"],type:[1025],disabled:[1028],side:[513],swipeGesture:[4,"swipe-gesture"],maxEdgeStart:[2,"max-edge-start"],isPaneVisible:[32],isEndSide:[32]},[[32,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"]]]),IonMenuButton=proxyCustomElement(MenuButton,[1,"ion-menu-button",{color:[1],disabled:[4],menu:[1],autoHide:[4,"auto-hide"],type:[1],visible:[32]},[[32,"ionMenuChange","visibilityChanged"],[32,"ionSplitPaneVisible","visibilityChanged"]]]),IonMenuToggle=proxyCustomElement(MenuToggle,[1,"ion-menu-toggle",{menu:[1],autoHide:[4,"auto-hide"],visible:[32]},[[32,"ionMenuChange","visibilityChanged"],[32,"ionSplitPaneVisible","visibilityChanged"]]]),IonModal=proxyCustomElement(Modal,[2,"ion-modal",{overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],swipeToClose:[4,"swipe-to-close"],presentingElement:[16]}]),IonNav=proxyCustomElement(Nav,[1,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1]}]),IonNavLink=proxyCustomElement(NavLink,[0,"ion-nav-link",{component:[1],componentProps:[16],routerDirection:[1,"router-direction"]}]),IonNote=proxyCustomElement(Note,[1,"ion-note",{color:[1]}]),IonPicker=proxyCustomElement(Picker,[2,"ion-picker",{overlayIndex:[2,"overlay-index"],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],buttons:[16],columns:[16],cssClass:[1,"css-class"],duration:[2],showBackdrop:[4,"show-backdrop"],backdropDismiss:[4,"backdrop-dismiss"],animated:[4],presented:[32]}]),IonPickerColumn=proxyCustomElement(PickerColumnCmp,[0,"ion-picker-column",{col:[16]}]),IonPopover=proxyCustomElement(Popover,[2,"ion-popover",{delegate:[16],overlayIndex:[2,"overlay-index"],enterAnimation:[16],leaveAnimation:[16],component:[1],componentProps:[16],keyboardClose:[4,"keyboard-close"],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],event:[8],showBackdrop:[4,"show-backdrop"],translucent:[4],animated:[4]}]),IonProgressBar=proxyCustomElement(ProgressBar,[1,"ion-progress-bar",{type:[1],reversed:[4],value:[2],buffer:[2],color:[1]}]),IonRadio=proxyCustomElement(Radio,[1,"ion-radio",{color:[1],name:[1],disabled:[4],value:[8],checked:[32]}]),IonRadioGroup=proxyCustomElement(RadioGroup,[0,"ion-radio-group",{allowEmptySelection:[4,"allow-empty-selection"],name:[1],value:[1032]}]),IonRange=proxyCustomElement(Range,[1,"ion-range",{color:[1],debounce:[2],name:[1],dualKnobs:[4,"dual-knobs"],min:[2],max:[2],pin:[4],snaps:[4],step:[2],ticks:[4],disabled:[4],value:[1026],ratioA:[32],ratioB:[32],pressedKnob:[32]}]),IonRefresher=proxyCustomElement(Refresher,[0,"ion-refresher",{pullMin:[2,"pull-min"],pullMax:[2,"pull-max"],closeDuration:[1,"close-duration"],snapbackDuration:[1,"snapback-duration"],pullFactor:[2,"pull-factor"],disabled:[4],nativeRefresher:[32],state:[32]}]),IonRefresherContent=proxyCustomElement(RefresherContent,[0,"ion-refresher-content",{pullingIcon:[1025,"pulling-icon"],pullingText:[1,"pulling-text"],refreshingSpinner:[1025,"refreshing-spinner"],refreshingText:[1,"refreshing-text"]}]),IonReorder=proxyCustomElement(Reorder,[1,"ion-reorder",null,[[2,"click","onClick"]]]),IonReorderGroup=proxyCustomElement(ReorderGroup,[0,"ion-reorder-group",{disabled:[4],state:[32]}]),IonRippleEffect=proxyCustomElement(RippleEffect,[1,"ion-ripple-effect",{type:[1]}]),IonRoute=proxyCustomElement(Route,[0,"ion-route",{url:[1],component:[1],componentProps:[16]}]),IonRouteRedirect=proxyCustomElement(RouteRedirect,[0,"ion-route-redirect",{from:[1],to:[1]}]),IonRouter=proxyCustomElement(Router,[0,"ion-router",{root:[1],useHash:[4,"use-hash"]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]]),IonRouterLink=proxyCustomElement(RouterLink,[1,"ion-router-link",{color:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],target:[1]}]),IonRouterOutlet=proxyCustomElement(RouterOutlet,[1,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16]}]),IonRow=proxyCustomElement(Row,[1,"ion-row"]),IonSearchbar=proxyCustomElement(Searchbar,[2,"ion-searchbar",{color:[1],animated:[4],autocomplete:[1],autocorrect:[1],cancelButtonIcon:[1,"cancel-button-icon"],cancelButtonText:[1,"cancel-button-text"],clearIcon:[1,"clear-icon"],debounce:[2],disabled:[4],inputmode:[1],placeholder:[1],searchIcon:[1,"search-icon"],showCancelButton:[1,"show-cancel-button"],spellcheck:[4],type:[1],value:[1025],focused:[32],noAnimate:[32]}]),IonSegment=proxyCustomElement(Segment,[1,"ion-segment",{color:[1],disabled:[4],scrollable:[4],value:[1025],activated:[32]}]),IonSegmentButton=proxyCustomElement(SegmentButton,[1,"ion-segment-button",{disabled:[4],layout:[1],type:[1],value:[1],checked:[32]}]),IonSelect=proxyCustomElement(Select,[1,"ion-select",{disabled:[4],cancelText:[1,"cancel-text"],okText:[1,"ok-text"],placeholder:[1],name:[1],selectedText:[1,"selected-text"],multiple:[4],interface:[1],interfaceOptions:[8,"interface-options"],compareWith:[1,"compare-with"],value:[1032],isExpanded:[32]}]),IonSelectOption=proxyCustomElement(SelectOption,[1,"ion-select-option",{disabled:[4],value:[8]}]),IonSelectPopover=proxyCustomElement(SelectPopover,[2,"ion-select-popover",{header:[1],subHeader:[1,"sub-header"],message:[1],options:[16]},[[0,"ionChange","onSelect"]]]),IonSkeletonText=proxyCustomElement(SkeletonText,[1,"ion-skeleton-text",{animated:[4]}]),IonSlide=proxyCustomElement(Slide,[0,"ion-slide"]),IonSlides=proxyCustomElement(Slides,[4,"ion-slides",{options:[8],pager:[4],scrollbar:[4]}]),IonSpinner=proxyCustomElement(Spinner,[1,"ion-spinner",{color:[1],duration:[2],name:[1],paused:[4]}]),IonSplitPane=proxyCustomElement(SplitPane,[1,"ion-split-pane",{contentId:[513,"content-id"],disabled:[4],when:[8],visible:[32]}]),IonTab=proxyCustomElement(Tab,[1,"ion-tab",{active:[1028],delegate:[16],tab:[1],component:[1]}]),IonTabBar=proxyCustomElement(TabBar,[1,"ion-tab-bar",{color:[1],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]},[[8,"keyboardWillHide","onKeyboardWillHide"],[8,"keyboardWillShow","onKeyboardWillShow"]]]),IonTabButton=proxyCustomElement(TabButton,[1,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[16,"ionTabBarChanged","onTabBarChanged"]]]),IonTabs=proxyCustomElement(Tabs,[1,"ion-tabs",{useRouter:[1028,"use-router"],selectedTab:[32]}]),IonText=proxyCustomElement(Text,[1,"ion-text",{color:[1]}]),IonTextarea=proxyCustomElement(Textarea,[2,"ion-textarea",{color:[1],autocapitalize:[1],autofocus:[4],clearOnEdit:[1028,"clear-on-edit"],debounce:[2],disabled:[4],maxlength:[2],minlength:[2],name:[1],placeholder:[1],readonly:[4],required:[4],spellcheck:[4],cols:[2],rows:[2],wrap:[1],autoGrow:[4,"auto-grow"],value:[1025],hasFocus:[32]}]),IonThumbnail=proxyCustomElement(Thumbnail,[1,"ion-thumbnail"]),IonTitle=proxyCustomElement(ToolbarTitle,[1,"ion-title",{color:[1],size:[1]}]),IonToast=proxyCustomElement(Toast,[1,"ion-toast",{overlayIndex:[2,"overlay-index"],color:[1],enterAnimation:[16],leaveAnimation:[16],cssClass:[1,"css-class"],duration:[2],header:[1],message:[1],keyboardClose:[4,"keyboard-close"],position:[1],buttons:[16],translucent:[4],animated:[4]}]),IonToggle=proxyCustomElement(Toggle,[1,"ion-toggle",{color:[1],name:[1],checked:[1028],disabled:[4],value:[1],activated:[32]}]),IonToolbar=proxyCustomElement(Toolbar,[1,"ion-toolbar",{color:[1]},[[0,"ionStyle","childrenStyle"]]]),IonVirtualScroll=proxyCustomElement(VirtualScroll,[0,"ion-virtual-scroll",{approxItemHeight:[2,"approx-item-height"],approxHeaderHeight:[2,"approx-header-height"],approxFooterHeight:[2,"approx-footer-height"],headerFn:[16],footerFn:[16],items:[16],itemHeight:[16],headerHeight:[16],footerHeight:[16],renderItem:[16],renderHeader:[16],renderFooter:[16],nodeRender:[16],domRender:[16],totalHeight:[32]},[[9,"resize","onResize"]]]),ZeaAppShell$1=proxyCustomElement(ZeaAppShell,[1,"zea-app-shell",{logoUrl:[1,"logo-url"],userData:[8,"user-data"],session:[8],leftPanelWidth:[1,"left-panel-width"],rightPanelWidth:[1,"right-panel-width"],leftProgressMessage:[1,"left-progress-message"],centerProgressMessage:[1,"center-progress-message"],rightProgressMessage:[1,"right-progress-message"],centerProgressBar:[8,"center-progress-bar"],leftProgressBar:[8,"left-progress-bar"],rightProgressBar:[8,"right-progress-bar"]},[[0,"userRegistered","userRegisteredHandler"],[0,"navDrawerOpen","navDrawerOpenHandler"],[0,"navDrawerClosed","navDrawerClosedHandler"]]]),ZeaBreadcrumbs$1=proxyCustomElement(ZeaBreadcrumbs,[1,"zea-breadcrumbs",{project:[8],folder:[8]}]),ZeaButton$1=proxyCustomElement(ZeaButton,[1,"zea-button",{htmlContent:[1,"html-content"],variant:[1],disabled:[4],color:[4],density:[1]}]),ZeaCheckbox$1=proxyCustomElement(ZeaCheckbox,[1,"zea-checkbox",{name:[1],disabled:[4],checked:[4],isRadio:[4,"is-radio"],elementClass:[32]}]),ZeaCopyLink$1=proxyCustomElement(ZeaCopyLink,[1,"zea-copy-link",{link:[1],tooltipIsVisible:[4,"tooltip-is-visible"],tooltipText:[1,"tooltip-text"]}]),ZeaDialog$1=proxyCustomElement(ZeaDialog,[1,"zea-dialog",{shown:[4],width:[1],allowClose:[4,"allow-close"],showBackdrop:[4,"show-backdrop"],addPadding:[4,"add-padding"],showTitle:[4,"show-title"],fullScreenMobile:[4,"full-screen-mobile"]}]),ZeaDialogDrawingSettings$1=proxyCustomElement(ZeaDialogDrawingSettings,[1,"zea-dialog-drawing-settings",{allowClose:[4,"allow-close"],shown:[4],showLabels:[4,"show-labels"],userData:[8,"user-data"]},[[0,"dialogClose","todoCompletedHandler"]]]),ZeaDialogProfile=proxyCustomElement(ZeaProfileDialog,[1,"zea-dialog-profile",{allowClose:[4,"allow-close"],shown:[4],showLabels:[4,"show-labels"],userData:[8,"user-data"]},[[0,"dialogClose","todoCompletedHandler"],[0,"userRegistered","userRegisteredHandler"]]]),ZeaDialogShare$1=proxyCustomElement(ZeaDialogShare,[1,"zea-dialog-share",{shown:[4]},[[0,"dialogClose","dialogCloseHandler"]]]),ZeaDropdownMenu$1=proxyCustomElement(ZeaDropdownMenu,[1,"zea-dropdown-menu",{appData:[8,"app-data"],actions:[32],menuItems:[32]},[[4,"keydown","keydownHandler"]]]),ZeaFabButton$1=proxyCustomElement(ZeaFabButton,[1,"zea-fab-button",{disabled:[4]}]),ZeaFileSystemBrowser$1=proxyCustomElement(ZeaFileSystemBrowser,[1,"zea-file-system-browser",{project:[8],folderId:[1,"folder-id"],filter:[1],folder:[32],galleryFolder:[32],isHighlighted:[32],showProjectSettingsDialog:[32],showAppStoreDialog:[32],currentApp:[32],currentAppReadmeTextContent:[32],availableApps:[32],readmeTextContent:[32],fileAssociations:[32]}]),ZeaForm$1=proxyCustomElement(ZeaForm,[1,"zea-form",{submitText:[1,"submit-text"],validate:[4],isValid:[4,"is-valid"],formValue:[8,"form-value"],submitCallback:[8,"submit-callback"]}]),ZeaFormDisciplinesSettings$1=proxyCustomElement(ZeaFormDisciplinesSettings,[1,"zea-form-disciplines-settings",{contentId:[1,"content-id"],disciplines:[8]}]),ZeaFormDrawingSetup$1=proxyCustomElement(ZeaFormDrawingSetup,[1,"zea-form-drawing-setup",{disciplines:[16],scales:[16]}]),ZeaFormMeasurementsSettings$1=proxyCustomElement(ZeaFormMeasurementsSettings,[1,"zea-form-measurements-settings",{test:[1]}]),ZeaFormProfile=proxyCustomElement(ZeaProfileForm,[1,"zea-form-profile",{welcomeHtml:[1,"welcome-html"],submitButtonText:[1,"submit-button-text"],showLabels:[4,"show-labels"],userData:[8,"user-data"]}]),ZeaIcon$1=proxyCustomElement(ZeaIcon,[1,"zea-icon",{type:[1],name:[1],size:[2]}]),ZeaImagesGallery$1=proxyCustomElement(ZeaImagesGallery,[1,"zea-images-gallery",{featured:[2],columns:[2],folder:[16],zoomedImageClass:[32],zoomedImageUrl:[32],zoomedTop:[32],zoomedLeft:[32],zoomedWidth:[32],zoomedHeight:[32],zoomedOpacity:[32],bbox:[32]}]),ZeaInput$1=proxyCustomElement(ZeaInput,[1,"zea-input",{name:[1],type:[1],value:[8],label:[1],invalidMessage:[1,"invalid-message"],required:[4],isValid:[4,"is-valid"],autoValidate:[4,"auto-validate"],invalidMessageShown:[4,"invalid-message-shown"],showLabel:[4,"show-label"],photoBase64:[1,"photo-base-6-4"],colorPopupShown:[4,"color-popup-shown"],colorPopupAlign:[1,"color-popup-align"],colorOptions:[16],selectedColor:[8,"selected-color"]},[[6,"click","handleClick"]]]),ZeaInputColor$1=proxyCustomElement(ZeaInputColor,[1,"zea-input-color",{showLabel:[4,"show-label"],selectedColor:[8,"selected-color"],invalidMessage:[1,"invalid-message"],invalidMessageShown:[4,"invalid-message-shown"],required:[4],isValid:[4,"is-valid"],colorPopupShown:[4,"color-popup-shown"],colorPopupAlign:[1,"color-popup-align"],label:[1],value:[8],name:[1],colorOptions:[16]},[[6,"click","handleClick"]]]),ZeaInputDate$1=proxyCustomElement(ZeaInputDate,[1,"zea-input-date",{test:[1]}]),ZeaInputPhoto$1=proxyCustomElement(ZeaInputPhoto,[1,"zea-input-photo",{test:[1]}]),ZeaInputSearch$1=proxyCustomElement(ZeaInputSearch,[1,"zea-input-search",{placeholder:[1]}]),ZeaInputSelect$1=proxyCustomElement(ZeaInputSelect,[1,"zea-input-select",{name:[1],value:[8],label:[1],invalidMessage:[1,"invalid-message"],required:[4],isValid:[4,"is-valid"],autoValidate:[4,"auto-validate"],invalidMessageShown:[4,"invalid-message-shown"],showLabel:[4,"show-label"],optionsShown:[4,"options-shown"],selectCallback:[8,"select-callback"]},[[6,"click","handleClick"]]]),ZeaInputSelectItem$1=proxyCustomElement(ZeaInputSelectItem,[1,"zea-input-select-item",{value:[8]}]),ZeaInputText$1=proxyCustomElement(ZeaInputText,[1,"zea-input-text",{name:[1],value:[8],label:[1],invalidMessage:[1,"invalid-message"],required:[4],disabled:[4],isValid:[4,"is-valid"],autoValidate:[4,"auto-validate"],invalidMessageShown:[4,"invalid-message-shown"],showLabel:[4,"show-label"],hidden:[4]}]),ZeaLayout$1=proxyCustomElement(ZeaLayout,[1,"zea-layout",{cellCount:[2,"cell-count"],orientation:[1],resizeCellA:[4,"resize-cell-a"],resizeCellC:[4,"resize-cell-c"],cellASize:[2,"cell-a-size"],cellCSize:[2,"cell-c-size"],resizeInterval:[2,"resize-interval"],showBorders:[4,"show-borders"],error:[32],prevOffset:[32],minimumGap:[32],maximunGap:[32],activeHandle:[32]},[[5,"mouseup","onMouseUp"],[5,"touchend","onTouchEnd"],[5,"mousemove","onMouseMove"],[5,"touchmove","onTouchMove"]]]),ZeaMarkdownViewer$1=proxyCustomElement(ZeaMarkdownViewer,[1,"zea-markdown-viewer",{mdText:[1,"md-text"]}]),ZeaMenu$1=proxyCustomElement(ZeaMenu,[1,"zea-menu",{leftOffset:[1,"left-offset"],topOffset:[1,"top-offset"],type:[1],orientation:[1],shown:[4],showAnchor:[4,"show-anchor"],anchorIcon:[1,"anchor-icon"],contextualAlign:[1,"contextual-align"]},[[1,"mouseup","handleClick"],[8,"zeaMenuItemClick","handleItemClick"],[1,"mousedown","mousedownHandler"],[5,"mousemove","mousemoveHandler"]]]),ZeaMenuColor$1=proxyCustomElement(ZeaMenuColor,[1,"zea-menu-color",{color:[1],fgColor:[1,"fg-color"]}]),ZeaMenuColorpicker$1=proxyCustomElement(ZeaMenuColorpicker,[1,"zea-menu-colorpicker",{shown:[4]}]),ZeaMenuItem$1=proxyCustomElement(ZeaMenuItem,[1,"zea-menu-item",{switch:[4],active:[4],hasCheckbox:[4,"has-checkbox"],hasRadio:[4,"has-radio"],checked:[4],callback:[8],shown:[4],allowHover:[4,"allow-hover"],hotkey:[1],type:[1],hasSubitems:[4,"has-subitems"],rootMenu:[16],isPushButton:[4,"is-push-button"]},[[8,"zeaMenuItemClick","windowClickHandler"],[9,"mouseup","handleWindowMouseup"],[9,"touchend","handleWindowTouchend"],[4,"keydown","keydownHandler"]]]),ZeaMenuSeparator$1=proxyCustomElement(ZeaMenuSeparator,[1,"zea-menu-separator",{class:[1],orientation:[1]}]),ZeaMenuSubitems$1=proxyCustomElement(ZeaMenuSubitems,[1,"zea-menu-subitems",{shown:[4],type:[1],parentItem:[8,"parent-item"],radioSelect:[4,"radio-select"],rootMenu:[16]},[[8,"zeaMenuItemClick","windowClickHandler"],[8,"zeaMenuItemPressed","windowItemPressHandler"],[9,"mouseup","handleWindowMouseup"]]]),ZeaNavigationDrawer$1=proxyCustomElement(ZeaNavigationDrawer,[1,"zea-navigation-drawer",{shown:[4]},[[4,"click","handleClick"]]]),ZeaPanelProgressBar$1=proxyCustomElement(ZeaPanelProgressBar,[1,"zea-panel-progress-bar",{progressBar:[8,"progress-bar"]}]),ZeaParamWidgetBbox$1=proxyCustomElement(ZeaParamWidgetBbox,[1,"zea-param-widget-bbox",{parameter:[8],appData:[8,"app-data"]}]),ZeaParamWidgetBoolean$1=proxyCustomElement(ZeaParamWidgetBoolean,[1,"zea-param-widget-boolean",{parameter:[8],checked:[4],appData:[8,"app-data"]}]),ZeaParamWidgetCode$1=proxyCustomElement(ZeaParamWidgetCode,[0,"zea-param-widget-code",{parameter:[8],appData:[8,"app-data"],editorHeight:[32]},[[0,"keydown","keydownHandler"]]]),ZeaParamWidgetColor$1=proxyCustomElement(ZeaParamWidgetColor,[1,"zea-param-widget-color",{parameter:[8],appData:[8,"app-data"],sampleColor:[32]},[[9,"resize","handlewindowResize"]]]),ZeaParamWidgetMaterialColor$1=proxyCustomElement(ZeaParamWidgetMaterialColor,[1,"zea-param-widget-material-color",{parameter:[8],appData:[8,"app-data"],sampleColor:[32]},[[9,"resize","handlewindowResize"]]]),ZeaParamWidgetNumber$1=proxyCustomElement(ZeaParamWidgetNumber,[1,"zea-param-widget-number",{parameter:[8],inputType:[1,"input-type"],appData:[8,"app-data"],value:[8],range:[32],step:[32]}]),ZeaParamWidgetString$1=proxyCustomElement(ZeaParamWidgetString,[1,"zea-param-widget-string",{parameter:[8],appData:[8,"app-data"]}]),ZeaParamWidgetVec2$1=proxyCustomElement(ZeaParamWidgetVec2,[1,"zea-param-widget-vec2",{parameter:[8],appData:[8,"app-data"],xValue:[32],yValue:[32]}]),ZeaParamWidgetVec3$1=proxyCustomElement(ZeaParamWidgetVec3,[1,"zea-param-widget-vec3",{parameter:[8],appData:[8,"app-data"],xValue:[32],yValue:[32],zValue:[32]}]),ZeaParamWidgetVec4$1=proxyCustomElement(ZeaParamWidgetVec4,[1,"zea-param-widget-vec4",{parameter:[8],appData:[8,"app-data"],xValue:[32],yValue:[32],zValue:[32],tValue:[32]}]),ZeaParamWidgetXfo$1=proxyCustomElement(ZeaParamWidgetXfo,[1,"zea-param-widget-xfo",{parameter:[8],appData:[8,"app-data"]}]),ZeaParameterContainer$1=proxyCustomElement(ZeaParameterContainer,[1,"zea-parameter-container",{parameterOwner:[8,"parameter-owner"],appData:[8,"app-data"]}]),ZeaPopupMenu$1=proxyCustomElement(ZeaPopupMenu,[1,"zea-popup-menu",{anchorElement:[16],shown:[4],topOffset:[1,"top-offset"],leftOffset:[1,"left-offset"],bbox:[32],node:[32]},[[8,"click","handleClick"]]]),ZeaPopupMenuItem$1=proxyCustomElement(ZeaPopupMenuItem,[1,"zea-popup-menu-item",{clickHandler:[16],startIcon:[1,"start-icon"],endIcon:[1,"end-icon"]}]),ZeaProgressBar$1=proxyCustomElement(ZeaProgressBar,[1,"zea-progress-bar",{type:[1],percent:[8],size:[8],color:[8],backgroundColor:[8,"background-color"],indeterminateAnimation:[8,"indeterminate-animation"]}]),ZeaQrCode$1=proxyCustomElement(ZeaQrCode,[1,"zea-qr-code",{content:[1],scale:[2]}]),ZeaScrollPane$1=proxyCustomElement(ZeaScrollPane,[1,"zea-scroll-pane",null,[[9,"resize","onResize"],[8,"orientationchange","onOrientationchange"],[9,"mouseup","onMouseUp"],[9,"mousemove","onMouseMove"]]]),ZeaSwitch$1=proxyCustomElement(ZeaSwitch,[1,"zea-switch",{name:[1],disabled:[4],checked:[4],stateLabel:[1,"state-label"],elementClass:[32]}]),ZeaTabs$1=proxyCustomElement(ZeaTabs,[1,"zea-tabs",{orientation:[1],density:[1]},[[0,"click","clickHandler"]]]),ZeaThumbnail$1=proxyCustomElement(ZeaThumbnail,[1,"zea-thumbnail",{zeaModelInstance:[8,"zea-model-instance"],icon:[8],zeaSession:[8,"zea-session"],isSelected:[32],fileProgress:[32]}]),ZeaToolbar$2=proxyCustomElement(ZeaToolbar,[1,"zea-toolbar",{tools:[8]},[[1,"mousedown","mousedownHandler"],[5,"mouseup","mouseupHandler"],[5,"mousemove","mousemoveHandler"]]]),ZeaToolbarColorpicker$1=proxyCustomElement(ZeaToolbarColorpicker,[1,"zea-toolbar-colorpicker",{data:[8],displayChildren:[4,"display-children"]}]),ZeaToolbarTool$1=proxyCustomElement(ZeaToolbarTool,[1,"zea-toolbar-tool",{data:[8],isActive:[4,"is-active"]},[[8,"zeaToolbarToolClick","zeaToolbarToolClickHandler"]]]),ZeaToolbarToolset=proxyCustomElement(ZeaToolbar$1,[1,"zea-toolbar-toolset",{data:[8]},[[8,"zeaToolbarToolClick","zeaToolbarToolClickHandler"]]]),ZeaTreeItemElement$1=proxyCustomElement(ZeaTreeItemElement,[1,"zea-tree-item-element",{label:[1],isRoot:[4,"is-root"],isTreeItem:[4,"is-tree-item"],isSelected:[4,"is-selected"],isVisible:[4,"is-visible"],isHighlighted:[4,"is-highlighted"],treeItem:[8,"tree-item"],appData:[8,"app-data"],isExpanded:[4,"is-expanded"],childItems:[32]}]),ZeaTreeView$1=proxyCustomElement(ZeaTreeView,[1,"zea-tree-view",{rootItem:[8,"root-item"],appData:[8,"app-data"],mouseIsOver:[32]},[[8,"keydown","onKeyDown"]]]),ZeaUserCard$1=proxyCustomElement(ZeaUserCard,[1,"zea-user-card",{userData:[8,"user-data"],isCurrentUser:[4,"is-current-user"],collapsible:[4],additionalDataShown:[4,"additional-data-shown"],density:[1]}]),ZeaUserChip$1=proxyCustomElement(ZeaUserChip,[1,"zea-user-chip",{isCurrentUser:[4,"is-current-user"],isActive:[4,"is-active"],showImages:[4,"show-images"],userData:[8,"user-data"],density:[1],showTooltip:[4,"show-tooltip"],showProfileCard:[4,"show-profile-card"],profileCardShown:[4,"profile-card-shown"],profileCardAlign:[1,"profile-card-align"]},[[6,"click","handleClick"]]]),ZeaUserChipSet$1=proxyCustomElement(ZeaUserChipSet,[1,"zea-user-chip-set",{showImages:[4,"show-images"],initialZIndex:[2,"initial-z-index"],session:[8],overflowLimit:[8,"overflow-limit"],overflowShown:[32],userDatas:[32],shownOverflowEntry:[32]}]),defineCustomElements=()=>{[IonActionSheet,IonAlert,IonApp,IonAvatar,IonBackButton,IonBackdrop,IonBadge,IonButton,IonButtons,IonCard,IonCardContent,IonCardHeader,IonCardSubtitle,IonCardTitle,IonCheckbox,IonChip,IonCol,IonContent,IonDatetime,IonFab,IonFabButton,IonFabList,IonFooter,IonGrid,IonHeader,IonIcon,IonImg,IonInfiniteScroll,IonInfiniteScrollContent,IonInput,IonItem,IonItemDivider,IonItemGroup,IonItemOption,IonItemOptions,IonItemSliding,IonLabel,IonList,IonListHeader,IonLoading,IonMenu,IonMenuButton,IonMenuToggle,IonModal,IonNav,IonNavLink,IonNote,IonPicker,IonPickerColumn,IonPopover,IonProgressBar,IonRadio,IonRadioGroup,IonRange,IonRefresher,IonRefresherContent,IonReorder,IonReorderGroup,IonRippleEffect,IonRoute,IonRouteRedirect,IonRouter,IonRouterLink,IonRouterOutlet,IonRow,IonSearchbar,IonSegment,IonSegmentButton,IonSelect,IonSelectOption,IonSelectPopover,IonSkeletonText,IonSlide,IonSlides,IonSpinner,IonSplitPane,IonTab,IonTabBar,IonTabButton,IonTabs,IonText,IonTextarea,IonThumbnail,IonTitle,IonToast,IonToggle,IonToolbar,IonVirtualScroll,ZeaAppShell$1,ZeaBreadcrumbs$1,ZeaButton$1,ZeaCheckbox$1,ZeaCopyLink$1,ZeaDialog$1,ZeaDialogDrawingSettings$1,ZeaDialogProfile,ZeaDialogShare$1,ZeaDropdownMenu$1,ZeaFabButton$1,ZeaFileSystemBrowser$1,ZeaForm$1,ZeaFormDisciplinesSettings$1,ZeaFormDrawingSetup$1,ZeaFormMeasurementsSettings$1,ZeaFormProfile,ZeaIcon$1,ZeaImagesGallery$1,ZeaInput$1,ZeaInputColor$1,ZeaInputDate$1,ZeaInputPhoto$1,ZeaInputSearch$1,ZeaInputSelect$1,ZeaInputSelectItem$1,ZeaInputText$1,ZeaLayout$1,ZeaMarkdownViewer$1,ZeaMenu$1,ZeaMenuColor$1,ZeaMenuColorpicker$1,ZeaMenuItem$1,ZeaMenuSeparator$1,ZeaMenuSubitems$1,ZeaNavigationDrawer$1,ZeaPanelProgressBar$1,ZeaParamWidgetBbox$1,ZeaParamWidgetBoolean$1,ZeaParamWidgetCode$1,ZeaParamWidgetColor$1,ZeaParamWidgetMaterialColor$1,ZeaParamWidgetNumber$1,ZeaParamWidgetString$1,ZeaParamWidgetVec2$1,ZeaParamWidgetVec3$1,ZeaParamWidgetVec4$1,ZeaParamWidgetXfo$1,ZeaParameterContainer$1,ZeaPopupMenu$1,ZeaPopupMenuItem$1,ZeaProgressBar$1,ZeaQrCode$1,ZeaScrollPane$1,ZeaSwitch$1,ZeaTabs$1,ZeaThumbnail$1,ZeaToolbar$2,ZeaToolbarColorpicker$1,ZeaToolbarTool$1,ZeaToolbarToolset,ZeaTreeItemElement$1,ZeaTreeView$1,ZeaUserCard$1,ZeaUserChip$1,ZeaUserChipSet$1].forEach(t=>customElements.define(t.is,t))};export{IonRange as $,IonInfiniteScroll as A,IonInfiniteScrollContent as B,IonInput as C,IonItem as D,IonItemDivider as E,IonItemGroup as F,IonItemOption as G,IonItemOptions as H,IonActionSheet as I,IonItemSliding as J,IonLabel as K,IonList as L,IonListHeader as M,IonLoading as N,IonMenu as O,IonMenuButton as P,IonMenuToggle as Q,IonModal as R,IonNav as S,IonNavLink as T,IonNote as U,IonPicker as V,IonPickerColumn as W,IonPopover as X,IonProgressBar as Y,IonRadio as Z,IonRadioGroup as _,IonAlert as a,ZeaMenu$1 as a$,IonRefresher as a0,IonRefresherContent as a1,IonReorder as a2,IonReorderGroup as a3,IonRippleEffect as a4,IonRoute as a5,IonRouteRedirect as a6,IonRouter as a7,IonRouterLink as a8,IonRouterOutlet as a9,ZeaButton$1 as aA,ZeaCheckbox$1 as aB,ZeaCopyLink$1 as aC,ZeaDialog$1 as aD,ZeaDialogDrawingSettings$1 as aE,ZeaDialogProfile as aF,ZeaDialogShare$1 as aG,ZeaDropdownMenu$1 as aH,ZeaFabButton$1 as aI,ZeaFileSystemBrowser$1 as aJ,ZeaForm$1 as aK,ZeaFormDisciplinesSettings$1 as aL,ZeaFormDrawingSetup$1 as aM,ZeaFormMeasurementsSettings$1 as aN,ZeaFormProfile as aO,ZeaIcon$1 as aP,ZeaImagesGallery$1 as aQ,ZeaInput$1 as aR,ZeaInputColor$1 as aS,ZeaInputDate$1 as aT,ZeaInputPhoto$1 as aU,ZeaInputSearch$1 as aV,ZeaInputSelect$1 as aW,ZeaInputSelectItem$1 as aX,ZeaInputText$1 as aY,ZeaLayout$1 as aZ,ZeaMarkdownViewer$1 as a_,IonRow as aa,IonSearchbar as ab,IonSegment as ac,IonSegmentButton as ad,IonSelect as ae,IonSelectOption as af,IonSelectPopover as ag,IonSkeletonText as ah,IonSlide as ai,IonSlides as aj,IonSpinner as ak,IonSplitPane as al,IonTab as am,IonTabBar as an,IonTabButton as ao,IonTabs as ap,IonText as aq,IonTextarea as ar,IonThumbnail as as,IonTitle as at,IonToast as au,IonToggle as av,IonToolbar as aw,IonVirtualScroll as ax,ZeaAppShell$1 as ay,ZeaBreadcrumbs$1 as az,IonApp as b,ZeaMenuColor$1 as b0,ZeaMenuColorpicker$1 as b1,ZeaMenuItem$1 as b2,ZeaMenuSeparator$1 as b3,ZeaMenuSubitems$1 as b4,ZeaNavigationDrawer$1 as b5,ZeaPanelProgressBar$1 as b6,ZeaParamWidgetBbox$1 as b7,ZeaParamWidgetBoolean$1 as b8,ZeaParamWidgetCode$1 as b9,defineCustomElements as bA,now as bB,pointerCoord as bC,readTask as bD,writeTask as bE,createGesture as bF,clamp as bG,ZeaParamWidgetColor$1 as ba,ZeaParamWidgetMaterialColor$1 as bb,ZeaParamWidgetNumber$1 as bc,ZeaParamWidgetString$1 as bd,ZeaParamWidgetVec2$1 as be,ZeaParamWidgetVec3$1 as bf,ZeaParamWidgetVec4$1 as bg,ZeaParamWidgetXfo$1 as bh,ZeaParameterContainer$1 as bi,ZeaPopupMenu$1 as bj,ZeaPopupMenuItem$1 as bk,ZeaProgressBar$1 as bl,ZeaQrCode$1 as bm,ZeaScrollPane$1 as bn,ZeaSwitch$1 as bo,ZeaTabs$1 as bp,ZeaThumbnail$1 as bq,ZeaToolbar$2 as br,ZeaToolbarColorpicker$1 as bs,ZeaToolbarTool$1 as bt,ZeaToolbarToolset as bu,ZeaTreeItemElement$1 as bv,ZeaTreeView$1 as bw,ZeaUserCard$1 as bx,ZeaUserChip$1 as by,ZeaUserChipSet$1 as bz,IonAvatar as c,IonBackButton as d,IonBackdrop as e,IonBadge as f,IonButton as g,IonButtons as h,IonCard as i,IonCardContent as j,IonCardHeader as k,IonCardSubtitle as l,IonCardTitle as m,IonCheckbox as n,IonChip as o,IonCol as p,IonContent as q,IonDatetime as r,IonFab as s,IonFabButton as t,IonFabList as u,IonFooter as v,IonGrid as w,IonHeader as x,IonIcon as y,IonImg as z}